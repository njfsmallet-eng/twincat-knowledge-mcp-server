---
title: "TF5200_encryption_of_ncprogr_en"
product: "TF5200"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_encryption_of_ncprogr_en.pdf"
release_date: "2025-06-10"
---
Functional description | EN TF5200 | Twin CAT 3 CNC CNC Program encryption 6/10/2025 | Version: 1.2
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5200 | Twin CAT 3 CNC Version: 1.2 3 CNC Program encryption
## Page 4

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. 4 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 5

Table of contents Table of contents Notes on the documentation.................................................................................................................... 3 General and safety instructions.............................................................................................................. 4 1 Overview.................................................................................................................................................... 8 2 Description................................................................................................................................................ 9 3 Encryption groups and configuration................................................................................................... 10 3.1 Channel parameter list.................................................................................................................... 10 3.2 Setting keys via CNC objects.......................................................................................................... 11 4 Library methods...................................................................................................................................... 12 4.1 Encryption....................................................................................................................................... 12 4.2 Version number............................................................................................................................... 12 5 Use of the dll in a test GUI...................................................................................................................... 14 5.1 Encryption example......................................................................................................................... 15 6 Parameter................................................................................................................................................. 17 6.1 Channel parameters........................................................................................................................ 17 6.2 CNC objects.................................................................................................................................... 18 7 Support and Service............................................................................................................................... 19 Index......................................................................................................................................................... 20 TF5200 | Twin CAT 3 CNC Version: 5 CNC Program encryption
## Page 6

Table of contents 6 Version: TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 7

List of figures List of figures Fig. 1 Encryption/decryption flow chart of an NC program..................................................................... 9 Fig. 2 Determining the dll file version..................................................................................................... 13 Fig. 3 Overview of how to apply the ISG Encypter................................................................................. 14 Fig. 4 View of the source file with readable code................................................................................... 15 Fig. 5 Encrypted file with encrypted code.............................................................................................. 15 TF5200 | Twin CAT 3 CNC Version: 1.2 7 CNC Program encryption
## Page 8

Overview 1 Overview Task Controller/machine manufacturers supply encrypted NC programs that end-users are not allowed to modify and cannot view. The NC kernel processes encrypted NC programs. Characteristics An encrypted NC program is recognised by its file extension. A key used for encryption and decryption must be defined for every file extension. Every file extension and the associated key define an encryption group. A file is recognised as encrypted if its extension matches one of the encryption group file extensions. The CNC uses the associated key to decrypt the file automatically during NC program decoding. The program ISG Encrypter is used. Parameterisation The user can define 3 different encryption groups. The keys are transmitted by CNC objects [} 18] to the NC kernel at controller start-up or before program start. The file extensions assigned to the keys are configured by P-CHAN-00283 [} 17]. Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 8 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 9

Description 2 Description Initialisation The following steps are required to use an encrypted NC program: 1. An NC program is encrypted with an individual key and saved to a folder. 2. The file extension is entered in the channel parameter list as an encrypted file type for the correspond- ing channel. 3. In parallel to the file extension, the associated key used to encrypt the file is entered in the NC kernel. The entry is made by using a write operation to a CNC object. This can be executed by the PLC. Process When an NC program is invoked, the NC kernel detects from the file extension whether it is encrypted. If the NC program is detected as encrypted, the kernel decrypts it using the specified key. If the file extension is defined as not encrypted, the program is processed as a normal NC program. NOTICE If the key is incorrect, the file is still decrypted. The NC kernel attempts to process the file and normally this then results in a syntax error. CNC diagnosis Entries of NC program parts in the CNC diagnostic data "diag_data.txt" are encrypted by a key from the controller manufacturer, i.e. they are not visible to users. Flow chart program.nc encryption program.enc "encryption_key" decryption "encryption_extension" ADS < encryption_key; channel parameter encryption_extension > decode CNC Fig. 1: Encryption/decryption flow chart of an NC program TF5200 | Twin CAT 3 CNC Version: 1.2 9 CNC Program encryption
## Page 10

Encryption groups and configuration 3 Encryption groups and configuration Groups The user can define 3 different encryption groups for the NC kernel. Each of these groups consists of a pair comprising a key and a file extension. A key can contain a maximum of 56 characters plus '\0'. A file extension must consist of 1 to 3 characters. When the NC kernel loads an NC program, it checks whether the extension of the NC program is entered in one of these 3 groups. If this is the case, the NC kernel decrypts the NC program with the key belonging to the associated group. Default configuration Users can use the groups as they wish. The pair assignment of key and file extension is depicted in the table below: Group Key Channel parameters 1 mc_encryption_key_0 encryption_extension[0] P-CHAN-00283 2 mc_encryption_key_1 encryption_extension[1] P-CHAN-00283 3 mc_encryption_key_2 encryption_extension[2] P-CHAN-00283 3.1 Channel parameter list Parameterisation options for file extensions in the channel parameter list The table below shows an example of a setting for the extensions in the channel parameter list. The file extensions for groups 1 to 3 (index 0, 1, 2) can be set. Channel parameters Value encryption_extension[0] enc encryption_extension[1] od encryption_extension[2] e A further group also exists. This group is permanently specified by the controller or machine manufacturer and is used for the encryption of user-created NC programs (e.g. CNC cycles). These NC programs have the extension “ecy”. It is strongly recommended that you do not re-assign the file extension “ecy” for your own definitions. If you define the file extension “ecy”, it is not possible to use CNC cycles since NC programs en- crypted by controller/machine manufacturers cannot be decrypted. 10 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 11

Encryption groups and configuration 3.2 Setting keys via CNC objects The keys for encryption groups must be set via CNC objects. Refer to the example below on how to address objects via the index group and index offset. You can also set them online using the ISG Object Browser of the CNC. As a security measure, all keys are only displayed hidden. Access to encryption All groups are accessible as shown below. The arrays can only be written via CNC objects. Channel 1 Task: COM IDXGRP :=16#00120101 ( Channel 1 ) IDXOFFS :=16#00000094 ( mc_encryption_key_0 [} 18]) IDXGRP :=16#00120101 ( Channel 1 ) IDXOFFS :=16#00000095 ( mc_encryption_key_1 [} 18]) IDXGRP :=16#00120101 ( Channel 1 ) IDXOFFS :=16#00000096 ( mc_encryption_key_2 [} 18]) ADS function block Transfer takes place using the function block ADSWRITE(). The following applies to the example above: fb_Ads Write( NETID :='', PORT :=553, IDXGRP :=16#00120101, IDXOFFS :=16#00000094, SRCADDR := ADR(mc_encryption_key_0), LEN := SIZEOF (mc_encryption_key_0), WRITE := TRUE ); NOTICE When writing CNC objects, note that it may be necessary to insert a "\0" at the string end. TF5200 | Twin CAT 3 CNC Version: 1.2 11 CNC Program encryption
## Page 12

Library methods 4 Library methods isg-encrypt-x*.dll This auxiliary DLL includes the methods for encrypting NC programs. • encrypt_file() • get_version() The auxiliary DLL is available in both a 64-bit version (isg-encrypt-x64.dll) and a 32-bit version (isg-encrypt- x86.dll). The library is designed for the European/Western character set. If different character sets are used, it may result in unforeseen side effects. 4.1 Encryption The specified input file is fully encrypted with the specified key and is saved as the output file. long encrypt_file (char *p In, char *p Out, char* encryption_key, char* err_buffer, unsigned long err_buffer_size) Parameter Name Type Meaning p In char* Name for input file p Out char* Name for output encryption_key char* Key err_buffer char* Buffer for error messages: "Key is longer than 56 characters" "No key defined" "Could not open input file" "Could not open output file" If a blank string is entered, no error occurred. A maximum of 256 characters can be transmitted. err_buffer_size unsigned Size of the buffer err_buffer long Return values Value Meaning -4 Output file cannot be opened -3 Input file cannot be opened -2 Maximum key length exceeded. -1 Key missing. 0<x Encryption of x characters successful. 4.2 Version number The file version of the dll can be determined with the library method get_version(). This is the same version that is obtainable by right-clicking File => Properties => Details (see the figure below). 12 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 13

Library methods Fig. 2: Determining the dll file version Parameter Name Type Meaning buffer char* Buffer for version string size unsigned Size of buffer long Return values Value Meaning TRUE Version string successfully copied to the buffer. FALSE Version string could not be written to the buffer. TF5200 | Twin CAT 3 CNC Version: 1.2 13 CNC Program encryption
## Page 14

Use of the dll in a test GUI 5 Use of the dll in a test GUI isg-encrypt-x*.dll in the application of the ISG Encypter Fig. 3: Overview of how to apply the ISG Encypter Description of highlighted elements index Meaning Description 1 File list This lists all the files to be encrypted. The first column contains the file name of the source; the second column specifies the target file name. 2 Add files Opens a dialog to add one or more files to the file list. 3 Add folder Opens a dialog to add all the files in a folder (and all subfolders) to the file list. 4 Load file lists Opens a dialog to load one or more file lists previously saved. 5 Save file list Saves the current file list. 6 Remove selected Removes selected entries from the file list. 7 Remove all Removes all entries from the file list. 8 Key The secret key used for encryption. The identical key must then be transferred to the CNC later, e.g. via the associated CNC object. 9 Output folder This lets you specify a folder to save the encrypted files in. If this field remains empty, each encrypted file is stored in the folder of the associated source file. 10 File extension Specifies the file extension used for encrypted files. 11 ENCRYPT Starts encryption. 12 Log output Displays information, warnings and errors. 13 Language Changes the language of GUI elements. 14 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 15

Use of the dll in a test GUI 5.1 Encryption example Fig. 4: View of the source file with readable code Fig. 5: Encrypted file with encrypted code Procedure to encrypt a file The file in the figure “View of the source file with readable code” is encrypted. The isg-encypt-x*.dll must be in the same folder as the example application. 1. In this case, choose "asdf" as the password. 2. Select "Encrypt_Example.enc" (in the same folder as the input file) as the output file. TF5200 | Twin CAT 3 CNC Version: 1.2 15 CNC Program encryption
## Page 16

Use of the dll in a test GUI 3. The result should be similar to the figure “Encrypted files”. 16 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 17

Parameter 6 Parameter 6.1 Channel parameters P-CHAN-00283 Define file extensions to encrypt NC programs Description The NC channel can process encrypted NC programs. Encryption is recognised by the file extension. A maximum of 3 self-defined file extensions are available in the channel parameter 'encryption_extension[...]’ to configure file extensions. A file extension can consist of one to maximum 3 characters. No distinction is made between uppercase and lowercase letters in the file extension. A check is made whether the extension is entered in one of the 3 groups before opening an NC program. If the check is positive, the NC kernel decrypts the NC program with the key belonging to the related group. Both main programs and global subroutines can be encrypted. For more information about encryption see [FCT-C12 [} 8]]. Parameter encryption_extension[i] where i = 0 2 Data type STRING Data range Maximum of 3 characters Dimension ---- Default value encryption_extension[0] ---- encryption_extension[1] ---- encryption_extension[2] ---- encryption_extension[3] ecy * Remarks * File extensions can be set for the groups 1 to 3 (Index 0, 1, 2). A further group also exists. This group especially is pre-defined by the controller or machine manufacturer and is used for the encryption of self-created NC programs (e.g. cycles). The extension is 'ecy'. It is recommended not to re-use this extension for new user-defined definitions Parameterisation example: encryption_extension[0] enc (1st group) encryption_extension[1] od (2nd group) encryption_extension[2] d (3rd group) TF5200 | Twin CAT 3 CNC Version: 1.2 17 CNC Program encryption
## Page 18

Parameter 6.2 CNC objects Notes on addressing <C > Channel or channel ID starting with 1 ID For further information on addressing CNC objects, see [FCT-C13//Description]. Name mc_encryption_key_0 Description This object specifies the key for the first encryption group. The encryption group is defined by the parameter P-CHAN-00283 [} 17] and refers to the specified file extension. This key acts on encryption_extension[0] Task COM (Port 553) Indexgruppe 0x12010<C > Index offset 0x94 ID Data type STRING Length/byte 57 Attributes write Unit - Remarks Name mc_encryption_key_1 Description This object specifies the key for the second encryption group. The encryption group is defined by the parameter P-CHAN-00283 and refers to the specified file extension. This key acts on encryption_extension[1] Task COM (Port 553) Indexgruppe 0x12010<C > Indexoffset 0x95 ID Data type STRING Length/byte 57 Attributes write Unit - Remarks Name mc_encryption_key_2 Description This object specifies the key for the third encryption group. The encryption group is defined by the parameter P-CHAN-00283 [} 17] and refers to the specified file extension. This key acts on encryption_extension[2] Task COM (Port 553) Indexgruppe 0x12010<C > Indexoffset 0x96 ID Data type STRING Length/byte 57 Attributes write Unit - Remarks 18 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 19

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5200 | Twin CAT 3 CNC Version: 1.2 19 CNC Program encryption
## Page 20

Index Index P P-CHAN-00283 17 20 Version: 1.2 TF5200 | Twin CAT 3 CNC CNC Program encryption
## Page 22

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
