---
title: "TF5200_ads_access_to_cnc_en"
product: "TF5200"
category: "Motion_Control"
tags: ["ADS", "NC"]
language: "EN"
document_type: "Manual"
version: "1.051"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_ads_access_to_cnc_en.pdf"
release_date: "2025-06-10"
---
Functional description | EN TF5200 | Twin CAT 3 CNC ADS Access on CNC 6/10/2025 | Version: 1.051
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5200 | Twin CAT 3 CNC Version: 1.051 3 ADS Access on CNC
## Page 4

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. 4 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 5

Table of contents Table of contents Notes on the documentation.................................................................................................................... 3 General and safety instructions.............................................................................................................. 4 1 Introduction............................................................................................................................................... 8 2 Description.............................................................................................................................................. 12 2.1 COM task........................................................................................................................................ 13 2.1.1 Requesting object description.......................................................................................... 13 2.1.2 Data content..................................................................................................................... 15 2.2 Task SDA, Task GEO..................................................................................................................... 15 2.2.1 Classes............................................................................................................................ 15 2.2.2 Administration, Index Group/Offset address..................................................................... 16 3 Dynamic access to variables................................................................................................................. 19 3.1 P parameter.................................................................................................................................... 20 3.2 V. L variables................................................................................................................................... 20 3.3 V. P variables................................................................................................................................... 20 3.4 V. S variables................................................................................................................................... 20 4 Interface for variables with a flexible data type................................................................................... 22 4.1 General properties.......................................................................................................................... 22 4.2 Interfaces........................................................................................................................................ 23 4.2.1 Channel-specific interface................................................................................................ 23 4.2.2 Axis-specific interface (e.g. for V. A variables).................................................................. 23 4.3 Transfer parameters and return values........................................................................................... 25 4.3.1 “Number of variable elements” function........................................................................... 25 4.3.2 “Variable description by index” function........................................................................... 27 4.3.3 “Variable handle by name” function................................................................................. 30 4.3.4 “Read variable value by handle” function......................................................................... 32 4.3.5 “Read variable value by name” function........................................................................... 34 4.3.6 “Write variable value by handle” function......................................................................... 36 4.3.7 “Write variable value by name” function........................................................................... 38 4.3.8 “Extended description by index” function......................................................................... 40 4.3.9 “Variable handle by name” axis-specific function............................................................. 42 4.3.10 “Read variable value by name” axis-specific function...................................................... 44 4.3.11 “Write variable value by name” axis-specific function...................................................... 45 5 ADS services........................................................................................................................................... 46 6 Support and Service............................................................................................................................... 47 Index......................................................................................................................................................... 48 TF5200 | Twin CAT 3 CNC Version: 5 ADS Access on CNC
## Page 6

Table of contents 6 Version: TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 7

List of figures List of figures Fig. 1 Overview of CNC architecture...................................................................................................... 9 Fig. 2 Overview - addressing the number of parameters....................................................................... 19 TF5200 | Twin CAT 3 CNC Version: 1.051 7 ADS Access on CNC
## Page 8

Introduction 1 Introduction Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. Access to CNC data is by means of CNC objects which are addressed by the index group and index offset. The following tasks are provided and must be addressed via separate ports: • SDA, • COM • GEO Code page CP1252 is used. CNC architecture CNC objects can be accessed via ADS. The element is then defined via the ADS Net Id address, Index Group and Index Offset. CNC objects can be accessed via Index Group and Index Offset. 8 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 9

Introduction [0]=X=1 [0]=X=4 [1]=Y=2 [1]=Y=5 [2]=Z=3 channel 1 channel n Task COM BF BF HMI HMI BF BF Task SDA DEC DEC F F BF BF TRC TRC F F BF BF BAVO BAVO F F Task GEO BF BF BF BF BAHN CHANNEL BAHN CHANNEL BBBB BBBB BF LR 1 2 3 4 5 Fig. 1: Overview of CNC architecture The figure above lists the following CNC classes as an example: • Decoding (BF DEC) • Path preparation (BF BAVO) • Interpolator (BF BAHN) • Position control (BF LR) • Spindle (BF SPINDEL) Access attributes CNC class instances provide objects that have different attributes. Depending on the CNC configuration, each CNC class creates instances and links them to a CNC architecture. Access can then be made to these object attributes via services. Either: • read • write • read/write TF5200 | Twin CAT 3 CNC Version: 1.051 9 ADS Access on CNC
## Page 10

Introduction Platform, channel and axis Depending on the CNC class, the instance can be global throughout the platform (channel number = 0, e.g. position controller) or can be created as a channel-specific instance (channel number > 0). In addition, an instance can provide both its own elements and also axis-specific elements. Platform axes The user creates all controller system axes for the control platform. This produces a sequence of axes. The calculation of the object address used to address the individual axes is derived from the axis placement in this axis sequence. It corresponds to the placement index in this sequence. The first axis in this sequence has the index 1. This address can be used at any time to access the axis. Channel axes The channel axes are addressed via the index in the channel. Assigning an axis in the channel can be modified or defined to suit requirements or defined by the channel parameters and axis exchange. If a channel axis index is currently not occupied by an axis, it can be viewed by reading "blank" data content. In this particular case, the logical axis number = 0. Spindles In analogy to a CNC channel which is responsible for the coordinated motion of several axes, the BF SPINDEL is responsible for moving a single independent axis (single axis interpolator). You can also access generated spindles via CNC objects.. HLD The high-level driver (HLD, BF CHANNEL) is a special case here. The HLD of the first channel drives all platform-global axes in the interface to the PLC in addition to channel-specific elements. Therefore, the addresses of the axes are not changed by an axis exchange but are fixed by the start-up description. COM task base address Index Group = 0x20100 and 0x20200 are used as the basic address to access internal CNC data of the COM task. Individual channels or axes can be queried via different values that are additive to this base address (Index Group). GEO task basic address Index Group = 0x20300 is defined as the basic address to access internal CNC data of the SDA and GEO tasks. Individual attributes of an element can be queried via different values that are additive to this base address (Index Group). Static CNC objects available The available static CNC objects are dependent on the CNC Build used. A list of all available objects can be created using the ISG object browser. Requirements: ISG object browser is installed Configuration is active in Twin CAT and Twin CAT is in RUNNING mode Execute the following steps: • Start ISG object browser 10 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 11

Introduction • Confirm the Export button • Define the storage location and the filename of the list generated. The generated list contains all the static objects available in the CNC version. TF5200 | Twin CAT 3 CNC Version: 1.051 11 ADS Access on CNC
## Page 12

Description 2 Description Notes on addressing <C > Channel or channel ID starting with 1 ID <A > Axis ID starting with 1 ID <S > Spindle index starting with 0. The spindle index is a component part of the index group. ID Addressing modes of "Index Group" The index group can be specified for the CNC objects of channels and axes both with “logical” and “index- based” addressing. “Logical” addressing is selected by the additional bit 0x100000. If this bit is missing, access to the objects is index-based. The example below shows the significance of this bit. Spindles are generally accessed index-based and the index entry is a component part of the index group. For example, 0x25302 for the index group of the third spindle. Example: There are only two channels with logical numbers 1 and 5. Channel “1” Channel “6” Logical access Idx Grp = 0x121301 Idx Grp = 0x121306 Index-based access Idx Grp = 0x21301 Idx Grp = 0x21302 It is advisable to use the logical access. The advantage here is that access to channel 6 remains unchanged if channel 1 is deactivated. With index-based access, the index group of channel 6 changes from 0x21302 to 0x21301 in this case and it becomes the ‘first’ channel. It is advisable to use the logical access. All the examples of addressing in the sections below are executed using logical addressing. 12 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 13

Description 2.1 COM task Only one instance exists in the COM task and it administers all elements (platform, channels and axes). Instance classes Addressing Platform data Index Group = 0x120101, Index Offset = <Element> Platform axes Index Group = 0x120200 +<axis>, Index Offset = <element> Channel data Index Group = 0x120100 +<channel>, Index Offset = <element> Channel axes 0x120100 +<channel>, Index Offset = 0x1000 * <axis> + <element> The first channel (Index Group = 0x120101) drives platform data. 2.1.1 Requesting object description The description of a TASK COM object can be requested by accessing the object with bit identifier 0x30000. An object is described by the following 84 bytes. -The description of an object of the task COM can be requested by the bit identifier Object Access (ISGADS_IGR_OBJECT_ACCESS = 0x30000) in the index group- Data type Bit Date Description DWORD 0-3 ID Internal unique ID of an object DWORD 4-7 Size Size of object in bytes WORD 8-9 Write access TRUE is object is describable. WORD 10-11 - Not assigned DWORD 12-15 Index group for direct object access to the content DWORD 16-19 Index offset for direct object access to the content STRING(32) 20-51 Name Name of object STRING(32) 52-83 Type Object data type BOOL, BYTE, SINT, WORD, INT, DWORD, DINT, LWORD, LINT, REAL, LREAL, STRING TF5200 | Twin CAT 3 CNC Version: 1.051 13 ADS Access on CNC
## Page 14

Description The index group = 0x13010<ch> is used for objects of the first channel (<ch> = 1). If several channels are configured, the required channel can be selected accordingly via the logic channel ID [1; max]. The platform data can optionally be addressed under channel ID = 0 or 1. • Total number of all objects is requested via index offset = 0. • Reading an object description Index offset > 0 supplies object description with index [1; number of objects]; the return memory must be a total of 84 bytes per object. Reading several object descriptions with one access • If exactly a multiple of 84 bytes is provided as return memory, object descriptions are returned in sequence starting from the transferred index. Example Index group = 0x130101, index offset = 0 returns the number of objects in the first channel Index group = 0x130101, index offset = 1 returns the object description in the first object (channel=1) Requesting a single object description Index group = 0x130101, index offset = 0x10 supplies a single object description with 84 bytes. Example listing • ID= 82 (4 bytes) • Size = 1 (4 bytes) • Write access = 0, i.e. read only (2 bytes) • Free (2 bytes) • Index group = 0x00120101 (4 bytes) • Index offset = 0x00000003 (4 bytes) • Name = mc_active_single_block_r (32Byte) • Type = BOOL (32 bytes) 14 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 15

Description 2.1.2 Data content The actual read/write access to the data content of the objects takes place via the bit identifier ISGADS_IGR_ELEMENT_ACCESS = 0x20000 in the Index Group. • Platform 0x120100, 0x251 • Axis 0x120200, 0x10001 • Channel 0x120101, 0x1 • Channel axis 0x120101, 0x10001 Later access to object data can then take place via index Group = 0x120101, index Offset = 0x1 "mc_command_single_block_w". 2.2 Task SDA, Task GEO 2.2.1 Classes Index Group base of CNC Index Group = 0x120300 Index Group of classes The following classes of the CNC instances can currently be addressed by the corresponding Index Group: • 0x120300 : position controller (once per CNC, channel-independent with platform-global axes) • 0x121300 : interpolator (channel-specific with channel axes) • 0x122300 : decoder (channel-specific with channel axes) • 0x123300 : HLD (channel-specific, HLD of the first channel additionally contains axes that are platform- global) • 0x124300 : Path preparation (channel-specific) • 0x25300 : Spindle The individual classes have the following additive values on the CNC Index Group: • 0x0000 : position controller (once per CNC, channel-independent with platform-global axes) • 0x1000 : interpolator (channel-specific with channel axes) • 0x2000 : decoder (channel-specific with channel axes) • 0x3000 : HLD (channel-specific, HLD of the first channel additionally contains axes that are platform- global) • 0x4000 : Path preparation (channel-specific) • 0x5000 : Spindle element attributes The following attributes of an element can be queried (additive values to the Index Group): • 0x000 : data content (depending on data type) • 0x100 : name as string • 0x200 : type as string [UNS08;SGN08; ... ;SGN32; REAL32, REAL64] • 0x300 : length of data in bytes • 0x400 : unit as string • 0x500 : BOOLEAN flag indicating whether write access is permitted • 0x600 : Object address: In (channel, axis), Out (Index Group, Index Offset) TF5200 | Twin CAT 3 CNC Version: 1.051 15 ADS Access on CNC
## Page 16

Description 2.2.2 Administration, Index Group/Offset address To determine which instances of a class exist, you can query the object address of the first element (Index Offset = 0x0) by means of a READ&WRITE access. The Index Group and the Index Offset are returned. No instance of the class exists if (0, 0) is returned as the address. If an instance exists, all further existing elements of the instance can be determined by incrementing the Index Offset. Object query Query of object address of the 1st channel Index Group =0x123900 comprising <CNC-Basis> + <Class = HLD> + <Attribute=Address> 0x20300 + 0x3000 + 0x600 Input : Channel = 1, Axis = 0 Output :Index Group = 0x123301, Index Offset = 0x0 Query of object address of the 2nd channel <CNC-Basis> + <Class = HLD> + <Attribute=Address> 0x20300 + 0x3000 + 0x600 Input : Channel = 2, Axis = 0 Output :Index Group = 0x123302, Index Offset = 0x0 Query of 1st platform axis <CNC-Basis> + <Class = HLD> + <Attribute=Address> 0x120300 + 0x3000 + 0x600 Input : Channel = 0, Axis = 1 Output :Index Group = 0x123300, Index Offset = 0x1000 Query of 2nd decoder axis in 1st channel <CNC-Basis> + <Class = HLD> + <Attribute=Address> 0x120300 + 0x2000 + 0x600 Input : Channel = 1, Axis = 2 Output :Index Group = 0x122301, Index Offset = 0x20000 Number of element types of a class The number of existing element types of an instance can be queried by the value content of the first element (Index Offset = 0). The name of this element also describes the instance itself. Position controller The position controller is not channel-specific, i.e. channel = 0 always applies. The axes are numbered from 1 up to the number of the configured axes. 16 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 17

Description Interpolator, decoder, path preparation The channel number must be specified within the range [ 1; number of configured channels ]. Axes are channel-specific and must lie within the range [0; <BAHN_BAVO_AXMAX>]. Channel, HLI driver The channel number must be specified within the range [ 1; <number of configured channels> ]. If axes are referenced, they must lie within the range [ 1; <number of configured axes>]. Spindle The spindle index for spindles must be specified as “channel” entry. The spindle index is numbered from 0 up to the number of the configured axes - 1. Querying element attributes The query function is illustrated by the example of the element feedhold.enable in Channel 1. The element Index Offset is 0x01. The composition of the Index Group is shown; the element Index Offset remains unchanged. Data content attribute: <CNC-Basis> + <Class = HLD> + <Attribute=Address> <Channel> 0x120300 + 0x3000 + 0x0 + 1 Input : Index Group = 0x123301, Index Offset = 0x01 Output : 0/1 (dependent on element data type) Name attribute: <CNC-Basis> + <Class = HLD> + <Attribute=Address> <Channel> 0x120300 + 0x3000 + 0x100 + 1 Input : Index Group = 0x123401, Index Offset = 0x01 Output : feedhold.enable TF5200 | Twin CAT 3 CNC Version: 1.051 17 ADS Access on CNC
## Page 18

Description Type attribute: <CNC-Basis> + <Class = HLD> + <Attribute=Address> <Channel> 0x20300 + 0x3000 + 0x200 + 1 Input : Index Group = 0x123501, Index Offset = 0x01 Output : BOOLEAN Length attribute in bytes: <CNC-Basis> + <Class = HLD> + <Attribute=Address> <Channel> 0x120300 + 0x3000 + 0x300 + 1 Input : Index Group = 0x123601, Index Offset = 0x01 Output : 1 Unit attribute: <CNC-Basis> + <Class = HLD> + <Attribute=Address> <Channel> 0x120300 + 0x3000 + 0x400 + 1 Input : Index Group = 0x123701, Index Offset = 0x01 Output : - Write protection attribute: <CNC-Basis> + <Class = HLD> + <Attribute=Address> <Channel> 0x120300 + 0x3000 + 0x500 + 1 Input : Index Group = 0x123801, Index Offset = 0x01 Output : 0 18 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 19

Dynamic access to variables 3 Dynamic access to variables CNC objects are principally static and unambiguously identifiable by their Index Group and Index Offset. Exceptions to this are the following groupings; these variables or parameters are read dynamically. GEO task • AEP parameters SDA task • V. A variables • V. E variables • V. CYC variables • V. G variables • P parameter [} 20] • V. L variables [} 20] • V. P variables [} 20] • V. S variables [} 20] Dynamic elements While the NC program is in the decoding process, variables can be created dynamically and then deleted. It is also possible to access these variables. Fig. 2: Overview - addressing the number of parameters This affects the following: • P parameter [} 20] • V. L variables [} 20] • V. P variables [} 20] • V. S variables [} 20] The following process applies to connecting these variables: 1. Read the current number of parameters n_max 2. Read the name of each parameter [ 1;n_max] 3. Read the current parameter content TF5200 | Twin CAT 3 CNC Version: 1.051 19 ADS Access on CNC
## Page 20

Dynamic access to variables The value of a parameter should always be read by its name. It is not recommended to read a parameter by the index since the index of a parameter can change when elements are created dynamically and deleted. The maximum length of a variable name is 96 bytes. This applied to all V. variables and P paramet- ers. 3.1 P parameter Group Offset Identifier Type Length 0x122301 0x2 Number of P UNS32 4 parameters 0x122301 0x1B P-name by index UNS32/STRING 96 0x122301 0x1C P-value by name STRING/REAL64 8 0x122301 0x1D P-value by index UNS32/REAL64 8 Read a P parameter after previously querying the number of parameters 1. Read the number of P parameters in 1st channel Input :: Index Group = 0x122301, Index Offset = 0x02 Output : 1 2. Read the name of the P parameter by the parameter index Input : Index Group = 0x122301, Index Offset = 0x1b , Parameter = 1 Output : P1 3. Read the value of a P parameter by its name Input : Index Group = 0x122301, Index Offset = 0x1c , Parameter : P1 Output : 4711 3.2 V. L variables Group Offset Identifier Type Length 0x122301 0x3 V. L parameter number UNS32 4 0x122301 0x1E V. L-name by index UNS32/STRING 96 0x122301 0x1F V. L-value by name STRING/REAL64 8 0x122301 0x20 V. L-value by index UNS32/REAL64 8 3.3 V. P variables Group Offset Identifier Type Length 0x122301 0x4 V. P parameter number UNS32 4 0x122301 0x21 V. P-name by index UNS32/STRING 96 0x122301 0x22 V. P-value by name STRING/REAL64 8 0x122301 0x23 V. P-value by index UNS32/REAL64 8 3.4 V. S variables Group Offset Identifier Type Length 0x122301 0x5 V. S parameter number UNS32 4 0x122301 0x24 V. S-name by index UNS32/STRING 96 20 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 21

Dynamic access to variables 0x122301 0x25 V. S-value by name STRING/REAL64 8 0x122301 0x26 V. S-value by index UNS32/REAL64 8 TF5200 | Twin CAT 3 CNC Version: 1.051 21 ADS Access on CNC
## Page 22

Interface for variables with a flexible data type 4 Interface for variables with a flexible data type Variables with flexible data types: • V. E. variables • V. G. variables • V. A. variables • V. CYC. variables • V. P. variables • V. L. variables • V. S. variables 4.1 General properties V. P., V. L. and V. S. variables are accessible over the channel-specific interface with restrictions as of CNC Builds V.2.11.2077, V2.11.2847, V3.1.3081.07, V3.1.3115 and V4.18.0. • There is a common channel-specific interface to read and write V.*. variables. This applies to the following V.*. variables: ◦ V. E. variables ◦ V. G. variables ◦ V. A. variables ◦ V. CYC.variables (*) ◦ V. P. variables (*) ◦ V. L. variables (*) ◦ V. S. variables (*) • In addition, there is an axis-specific interface for axis-specific variables (V. A.). In the channel-specific interface, the axis name for axis-specific variables must be affixed to the variable names to address the required axis. In the axis-specific interface on the other hand, the variable value of the axis currently assigned to this position is read implicitly. Example: Axis-specific interface: V. A. ACT_POS Channel-specific interface: V. A. ACT_POS. X • The variable value can be accessed by name or handle, whereby the handle is faster. Variables marked by (*) are an exception since they are only accessible by name. The handle of the variable is variable (depending on the configuration). For this reason, a request can be sent by variable name. • In order to access the variable without “pre-knowledge”, the number of existing variable entries can be determined and the variable descriptions can be polled (by index). • Variable arrays with an elementary data type (including multi-dimensional arrays and “end nodes” of variable structures) can be treated as a single unit. Example: V. E.array_sgn32, V. E.struct.array_uns32, V. G. NP[0]. V, V. G. NP[1]. V When an array variable is read or written, either a single element or a complete array can be accessed. Example: V. G. NP[0]. V[1] -> single element V. G. NP[0]. V -> complete array V. G. NP[0]. V[0] ... V. G. NP[0]. V[n] • Variable structures are resolved into their single elements, i.e. the variable name is composed of structure names, element name and array indices. Examples: V. G. WZ_AKT. SPDL_AX_NR V. E.trajectory.vector.x, V. E.trajectory.vector.y, V. E.trajectory.vector.z V. E.struct1[0].struct2[0].array_sgn32, ..., V. E.struct1.struct1[5].struct2[8].array_sgn32 (end node “array_sgn32” is treated as a single unit). 22 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 23

Interface for variables with a flexible data type 4.2 Interfaces Only V. CYC variables can be used n-dimensionally. 4.2.1 Channel-specific interface Index Group: Idx Grp = 0x122300 + Channel_No, e.g. for Channel 1: 0x122301: Idx Grp Idx Offs Function Description Input Output 0x122301 0x44 Number of Number of existing variable entries STRING max. UNS32 of selected variable type. 255 characters variable elements [} 25] If no variable type is specified → total number of all available variables V. E. + V. G. + V. A. (Largest index = number of elements – 1) 0x122301 0x45 Variable Variable description BYTE[2048] BYTE[2048] variable length variable length description by (name, handle, variable type, index [} 27] access, size, array dimensions, largest indices) 0x122301 0x46 Variable handle Handle for access to the variable STRING max. Handle 255 characters (UNS32) by name [} 30] 0x122301 0x47 Read variable Read variable value by variable BYTE[2048] BYTE[2048] handle variable length variable length value by handle [} 32] 0x122301 0x48 Read variable Read variable value by variable STRING max. BYTE[2048] name 255 characters variable length value by name [} 34] 0x122301 0x49 Write variable Write variable value by variable BYTE[2048] - handle variable length value by handle [} 36] 0x122301 0x4A Write variable Write variable value by variable BYTE[2048] - name variable length value by name [} 38] 0x122301 0x4B Extended variable Extended variable description, e.g. BYTE[2048] BYTE[2048] for V. E variable synchronisation variable length variable length description by and validity range index [} 40] 0x122301 0x4C-0x4E reserved Reserved - - NOTICE The following functions are not available for V. CYC., V. P., V. L. and V. S. variables: "Variable handle by name" "Read variable value by handle" "Write variable value by handle" 4.2.2 Axis-specific interface (e.g. for V. A variables) Index Group: Idx Grp = 0x122300 + Channel ID TF5200 | Twin CAT 3 CNC Version: 1.051 23 ADS Access on CNC
## Page 24

Interface for variables with a flexible data type Index offset of other axes: Idx Offs += 0x10000 * axis index Example Channel 1, Axis 1: Idx Grp = 0x122301 Idx Grp Idx Offs Function Description Input Output 0x122301 0x10004 Variable handle by Handle for access to the STRING max. Handle variable 255 characters (UNS32) name [} 42] 0x122301 0x10005 Read variable value Read variable value by STRING max. BYTE[2048] variable name 255 characters variable length by name [} 44] 0x122301 0x10006 Write variable Write variable value by BYTE[2048] - variable name variable length value by name [} 45] 0x122301 0x10007-0x reserved Reserved - - 10009 Instance identifier In the axis-specific interface, the variable names contain no instance identifier. Example: V. A. ACT_POS The axis-specific interface always supplies the variable value of the current axis currently assigned to this position. In case of axis exchange the variable value displayed therefore changes. 24 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 25

Interface for variables with a flexible data type 4.3 Transfer parameters and return values Transfer parameters and return values are treated as streams. 4.3.1 “Number of variable elements” function Index group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x44 Number of This function supplies the number of existing variable entries for the selected variable entries variable type. If no variable type is specified, the total number of all available variables V. E + V. G + V. A is returned. The “Variable description by index” function requests the variable description in each case. Transfer parameter (here with stream offset specified): 0 Variable type identifier where Contents Type Size Variable type identifier STRING variable, max. 256 bytes with zero termination “V. G” - Global variables “V. E“ - External Variable “V. A“ - Axis-specific Variables => stream length max. 256 bytes Return value (here with stream offset specified): 0 Number of existing variable entries where Contents Type Size Number of existing variable entries UNS32 fixed, max. 4 bytes => streaming length max. 4 bytes The variable type identifier, e.g. V. E, may not be followed by a dot. Application examples Transfer parameters: V. E 0 V. E identifier of variable type: V. E 0 zero termination Return values: TF5200 | Twin CAT 3 CNC Version: 1.051 25 ADS Access on CNC
## Page 26

Interface for variables with a flexible data type 123 123 V. E. variables are parameterised in Channel 1. 26 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 27

Interface for variables with a flexible data type 4.3.2 “Variable description by index” function Index Group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x45 Variable description This function supplies the associated variable description for specified index and variable type. The total number of existing variable entries can be queried by the “Variable element number” function. The valid range of the index is from 0 to (number of elements – 1). Transfer parameter (here with stream offset specified): 0 4 Variable index Identifier for variable type with zero termination where Contents Type Size Variable index UNS32 fixed, 4 bytes Variable type identifier STRING variable, max. 256 bytes “V. G” - Global variables “V. E“ - External Variable “V. A” - Axis-specific variables TF5200 | Twin CAT 3 CNC Version: 1.051 27 ADS Access on CNC
## Page 28

Interface for variables with a flexible data type => stream length max. 260 bytes Return value (here with stream offset specified): 0 4 8 12 16 (20) (24) ... 20 + 4 *m Handle Variable Access Size Number Number Number ... Variable name on the type of array of of variable dimensio elements elements ns m in in dimensio dimensio n 1 n 2 where Contents Variable type Size Handle on the variable UNS32 fixed, 4 bytes Variable type Enumeration (UNS32) (*) fixed, 4 bytes Access Enumeration (UNS32) fixed, 4 bytes 1 = READ_ONLY 2 = READ_WRITE Size UNS32 fixed, 4 bytes Number of array dimensions m UNS32 fixed, 4 bytes (= 0, elementary variable) Number of elements UNS32 variable, 4 bytes * m Index: 0 – (n-1) per array dimension Variable name String variable, max. 256 bytes => stream length 276 bytes + number of array dimensions n * 4 bytes, max. 2048 bytes (*) Enumeration for variable type: 1 = BOOLEAN 4 = SGN16 7 = UNS32 2 = SGN08 5 = UNS16 8 = REAL64 3 = UNS08 6 = SGN32 9 = STRING The variable type identifier, e.g. V. E, may not be followed by a dot. 28 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 29

Interface for variables with a flexible data type Application examples The example below reads the description of the V. E variable with index 2. Index Grp: 0x122301 for the first channel Index Offs: 0x45 Transfer parameters: 2 V. E 0 2 for the variable with index entry 2 V. E identifier of variable type: V. E 0 zero termination Return values: 0x2000002 1 1 2 1 2 V. E. Variable_3 0x2000002 Handle 1 type of variable: Boolean 1 access rights: Read-Only 2 total size in bytes 1 array dimension 2 number of array elements V. E. Variable_3 Variable name TF5200 | Twin CAT 3 CNC Version: 1.051 29 ADS Access on CNC
## Page 30

Interface for variables with a flexible data type 4.3.3 “Variable handle by name” function Index Group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x46 Handle by name Transfers the handle belonging to the variable name for access to the variable. With axis-specific variables the handle is dependent on the position (axis index) of the axis to which it is currently assigned in the channel. Therefore, if the axis is assigned to a different axis index by exchange, the handle must again be determined. With structures such as user-defined V. E variables, the structure element name must be specified. The structure is resolved into its single elements. The handle is only valid during controller runtime. It must be read again when the controller is restarted. Transfer parameter (here with stream offset specified): 0 Variable name with zero termination where Contents Type Size Variable name (with instance STRING variable, max. 256 bytes identifier for axis-specific variables) => stream length max. 256 bytes Return value (here with stream offset specified): 0 Handle on the variable where Contents Type Size Handle on the variable UNS32 fixed, max. 4 bytes => streaming length max. 4 bytes 30 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 31

Interface for variables with a flexible data type Application examples Transfer parameters: V. E.vartest 0 V. E.vartest variable name 0 zero termination Return value: 0x2000004 0x2000004 Handle of requested V. E variable TF5200 | Twin CAT 3 CNC Version: 1.051 31 ADS Access on CNC
## Page 32

Interface for variables with a flexible data type 4.3.4 “Read variable value by handle” function Index group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x47 Read by handle This function reads the value of a variable by its handle. Transfer parameter (here with stream offset specified): 0 4 8 12 8 + 4 Byte * n Handle on the Number n 1. index 2nd index ... variable Array dimensions where Contents Type Size Handle on the variable UNS32 fixed, 4 bytes Number n of array dimensions UNS32 fixed, 4 bytes 1. – n. array index UNS32 variable, n * 4 bytes => stream length 8 bytes + number of array dimensions n * 4 bytes, max. 2048 bytes Return value (here with stream offset specified): 0 variable value where Contents Type Size variable value String, REAL64, SGN32, REAL64[ ], variable, max. 2048 bytes SGN32[ ][ ], ... => stream length max. 2048 bytes With an array variable, a single value as well as the complete field in which no array indices are transferred can be read. 32 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 33

Interface for variables with a flexible data type Application examples 1. Example of reading an array element of a unidimensional array: Transfer parameters: Handle on the variable Number of array 1. index Return value dimensions Handle on the array 1 4 Value of 5th element V. G.array[4] 0x20012341 0x20012341 Handle on the variable 1 number of array dimensions 4 for Index 4 therefore the value of the 5th Element of the variable V. E.test[] → V. E.test[4] Return value: 333 333 variable value 2nd Example of reading a complete array with 5 elements: Handle on the variable Number of array 1. index Return value dimensions Handle on the array 0 Value of all array elements 0 to (n-1) 0x2001234 0x2001234 Handle on the variable 0 number of array dimensions Return values: 123 234 345 456 567 123 value of 1st element 234 value of 2nd element 345 value of 3rd element 456 value of 4th element 567 value of 5th element TF5200 | Twin CAT 3 CNC Version: 1.051 33 ADS Access on CNC
## Page 34

Interface for variables with a flexible data type 4.3.5 “Read variable value by name” function Index Group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x48 Read by name This function reads the value of a variable by its name. Transfer parameters: (here with stream offset specified):: 0 Variable name with zero termination where Contents Type Size Variable name (with instance STRING variable, max. 256 bytes identifier for axis-specific variables) => stream length max. 256 bytes Return value: (here with stream offset specified):: 0 variable value where Contents Type Size variable value String, REAL64, SGN32, REAL64[ ], variable, max. 2048 bytes SGN32[ ][ ], ... => stream length max. 2048 bytes With an array variable, a single value as well as the complete field in which no indices are specified in the variable name can be read. Example of variable V. G.array[0 .. 9]: Variable name Return value V. G.array[4] Value of 5th element V. G.array[4] V. G.array Value or array elements 0 - 9 34 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 35

Interface for variables with a flexible data type Application examples Example of reading an array element of a 1-dimensional array: Transfer parameters: V. E. Testvar[3] 0 V. E. Testvar[3] Variable name 0 zero termination Return value: 333 333 variable value of the element Example of reading a complete array with 5 elements: Transfer parameters: V. E. Testvar 0 V. E. Testvar Name of the variable 0 zero termination Return values: 123 234 345 456 567 123 value of 1st element 234 value of 2nd element 345 value of 3rd element 456 value of 4th element 567 value of 5th element TF5200 | Twin CAT 3 CNC Version: 1.051 35 ADS Access on CNC
## Page 36

Interface for variables with a flexible data type 4.3.6 “Write variable value by handle” function Index Group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x49 Write by This function changes the value of a variable by its handle. handle Transfer parameters: (here with stream offset specified):: 0 4 8 12 ... 8 + 4 * n Handle on the Number n 1st index 2nd index ... variable value variable Array indices where Contents Type Size Handle on the variable UNS32 fixed, 4 bytes Number n of transferred array UNS32 fixed, 4 bytes indices 1st – nth array index UNS32 variable, n * 4 bytes variable value String, REAL64, SGN32, REAL64[ ], variable, max. 2040 bytes SGN32[ ][ ], ... => stream length max. 2048 bytes This function has no return value. With an array variable, a single value as well as the complete field in which no array indices are transferred can be written. Example of variable V. G.array[0 .. 9]: Handle on the variable Number of array 1st index variable value indices Handle on the array 1 4 Value of 5th element V. G.array[4] Handle on the array 0 Value or array elements 0 - 9 36 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 37

Interface for variables with a flexible data type Application examples 1. Example of writing an array element of a unidimensional array: Transfer parameters: 0x2001234 1 4 123 0x2001234 Handle of variable 1 number of array dimensions 4 for the index 4 therefore the 5th element of the V. E.test[] → V. E.test4[] 123 new value of 5th element of the variable Return value: - 2nd Example of writing a complete array with 5 elements: 0x2001234 0 123 234 345 456 567 0x2001234 Handle of variable 0 number of array dimensions 123 new value of 1st element of the variable 234 new value of 2nd element of the variable 345 new value of 3rd element of the variable 456 new value of 4th element of the variable 567 new value of 5th element of the variable Return value: - TF5200 | Twin CAT 3 CNC Version: 1.051 37 ADS Access on CNC
## Page 38

Interface for variables with a flexible data type 4.3.7 “Write variable value by name” function Index Group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x4A Write via This function changes the value of a variable by its name. With axis-specific Name variables the axis name must contain the instance identifier (e.g. axis name V. A. ACT_POS. X). Transfer parameter (here with stream offset specified): 0 1...256 Variable name with variable value zero termination where Contents Type Size Variable name (with instance String variable, max. 256 bytes identifier for axis-specific variables) variable value String, REAL64, SGN32, REAL64[ ], variable, max. 2047 bytes SGN32[ ][ ], ... => stream length max. 2048 bytes This function has no return value. With an array variable, a single value as well as the complete field in which no indices are specified in the variable name can be written. Example of variable V. G.array[0 .. 9]: Variable name variable value V. G.array[4] Value of 5th element V. G.array[4] V. G.array Value or array elements 0 - 9 Application examples 1. Example of writing an array element of a unidimensional array: Transfer parameters: V. E.test[4] 0 123 V. E. Testvar[4] Variable name 0 zero termination 123 new value of 5th element of the variable Return value: - 38 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 39

Interface for variables with a flexible data type 2nd Example of writing a complete array with 5 elements: V. E.test 0 123 234 345 456 567 V. E. Testvar[4] Variable name 0 zero termination 123 new value of 1st element of the variable 234 new value of 2nd element of the variable 345 new value of 3rd element of the variable 456 new value of 4th element of the variable 567 new value of 5th element of the variable Return values: - TF5200 | Twin CAT 3 CNC Version: 1.051 39 ADS Access on CNC
## Page 40

Interface for variables with a flexible data type 4.3.8 “Extended description by index” function Index group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x4B Extended This function supplies extended information about the variable. The transferred data information: is dependent on the variable type. The valid range of the index is from 0 to (number of elements – 1) Transfer parameter (here with stream offset specified): 0 4 Variable index Variable type identifier where Contents Type Size Variable index UNS32 fixed, 4 bytes Variable type identifier STRING variable, max. 256 bytes “V. G” - Global variables “V. E“ - External Variable “V. A” - Axis-specific variables => stream length max. 260 bytes Return value: (here with stream offset specified): The return value is dependent on the variable type: ) V. G, V. A variables -> no return value since no extended description exists. b.) V. E. variables: 0 4 Synchronisation Validity range where Contents Type Size Synchronisation Enumeration (UNS32) fixed, 4 bytes 1 = NO_SYNC 2 = SYNCHRONISED Validity range Enumeration (UNS32) fixed, 4 bytes 1 = CHANNEL 2 = GLOBAL => stream length of V. E. Variable 8 bytes max. 2048 bytes The variable type identifier, e.g. V. E, may not be followed by a dot. Application examples Example of reading the extended properties of a V. E. Variable: Transfer parameters: 3 V. E 0 40 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 41

Interface for variables with a flexible data type 3 for the variable with index entry 3 V. E identifier of variable type: V. E 0 zero termination Return values: 2 2 2 Synchronisation: SYNCHRONIZED 2 Validity range: GLOBAL TF5200 | Twin CAT 3 CNC Version: 1.051 41 ADS Access on CNC
## Page 42

Interface for variables with a flexible data type 4.3.9 “Variable handle by name” axis-specific function Index group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x10004 for axis 1 = 0x20004 for axis 2 Handle by name This function returns the handle for the specified variable name which belong to an axis assigned to this position (axis index). For this reason an exchange can change the variable value read by the handle. Transfer parameter (here with stream offset specified):: 0 Variable name where Contents Type Size Variable name (without instance STRING variable, max. 256 bytes identifier) with zero termination. => stream length max. 256 bytes Return value (here with stream offset specified): 0 4 Handle on the variable where Contents Type Size Handle on the variable UNS32 fixed, max. 4 bytes => streaming length max. 4 bytes 42 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 43

Interface for variables with a flexible data type Application examples Example of reading a handle of an axis-specific variable. The index offset is important here. Transfer parameters: Index offset: 0x20004 V. A. WCS 0 V. A. WCS name of the variable (without instance identifier V. A. WCS. Y) 0 zero termination Return values: 0x0102001b 0x0102001b Handle of the variable, here the 2nd axis TF5200 | Twin CAT 3 CNC Version: 1.051 43 ADS Access on CNC
## Page 44

Interface for variables with a flexible data type 4.3.10 “Read variable value by name” axis-specific function Index Group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x10005 for axis 1 = 0x20005 for axis 2 Read by name This function reads the value of a variable by its variable name. The variable that belongs to the axis assigned to this position (axis index) is then always accessed. Transfer parameter (here with stream offset specified): 0 Variable name with zero termination where Contents Type Size Variable name (without instance STRING variable, max. 256 bytes identifier) => stream length max. 256 bytes Return value (here with stream offset specified): 0 variable value where Contents Type Size variable value String, REAL64, SGN32, REAL64[ ], variable, max. 2048 bytes SGN32[ ][ ], ... => stream length max. 2048 bytes Application examples Example of reading an axis-specific variable. The variable V. A. WCS. Y, i.e. the 2nd axis is read by the index offset 0x20005 Transfer parameters: V. A. WCS 0 V. A. WCS name of the variable (without instance identifier V. A. WCS. Y) 0 zero termination Return values: 1234.2 1234.2 Value of the variable of the 2nd axis 44 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 45

Interface for variables with a flexible data type 4.3.11 “Write variable value by name” axis-specific function Index group: Idx Grp = 0x122300 + Channel ID Index offset: Idx Offs = 0x10006 for axis 1 = 0x20006 for axis 2 Writing by name This function changes the value of a variable by its variable name. The variable that belongs to the axis assigned to this position (axis index) is then always accessed. Transfer parameter (here with stream offset specified): 0 1- 256 Variable name with variable value zero termination where Contents Type Size Variable name String variable, max. 256 bytes e.g. V. A. WCS (without instance identifier V. A. WCS. Y) variable value String, REAL64, SGN32, REAL64[ ], variable, max. 2047 bytes SGN32[ ][ ], ... => stream length max. 2048 bytes This function has no return value. Application examples Example of writing an axis-specific variable. The variable V. A. WCS. Y, i.e. the 2nd axis is written: Index offset: 0x20006 Transfer parameters: V. A. WCS 0 123,456 V. A. WCS name of the variable (without instance identifier V. A. WCS. Y ) 0 zero termination 123.456 New value of the variable Return value: - TF5200 | Twin CAT 3 CNC Version: 1.051 45 ADS Access on CNC
## Page 46

ADS services 5 ADS services Interface for ADS services The CNC instances offer an interface for access to the internal elements by the following ADS services: Data is addressed by the Index Group and the Index Offset. ADS Read The ADS Read function read data from an ADS unit. In Index Group, 4 bytes, index group of the data to be read. Index Offset, 4 bytes, index offset of the data to be read. Length, 4 bytes, length in bytes of the data to be read. Out Result, 4 bytes, ADS error number Length, 4 bytes, length in bytes of the data returned. Data, n bytes, data returned ADS Write Data is written to an ADS unit with ADS Write. In Index Group, 4 bytes, index group of the data to be read. Index Offset, 4 bytes, index offset of the data to be read. Read Length, 4 bytes, length in bytes of the data to be read. Write Length, 4 bytes, length in bytes of the data to be written. Data, n bytes, data to be written Out Result, 4 bytes, ADS error number ADS Read & Write The ADS Read Write function writes data to an ADS unit. Data can also be read out of the ADS unit. In Index Group, 4 bytes, index group of the data to be read. Index Offset, 4 bytes, index offset of the data to be read. Read Length, 4 bytes, length in bytes of the data to be read. Write Length, 4 bytes, length in bytes of the data to be written. Data, n bytes, data to be written Out Result, 4 bytes, ADS error number Length, 4 bytes, length in bytes of the data returned. Data, n bytes, data returned ADS – Automation Device Specification (source: Beckhoff Help) 46 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 47

Support and Service 6 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5200 | Twin CAT 3 CNC Version: 1.051 47 ADS Access on CNC
## Page 48

Index Index 48 Version: 1.051 TF5200 | Twin CAT 3 CNC ADS Access on CNC
## Page 50

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
