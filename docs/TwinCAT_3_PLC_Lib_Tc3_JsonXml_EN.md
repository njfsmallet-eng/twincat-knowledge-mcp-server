---
title: "TE1000 Twin CAT 3"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.14.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc3_JsonXml_EN.pdf"
release_date: "2024-11-13"
---
Manual | EN TE1000 Twin CAT 3 | PLC Lib: Tc3_Json Xml 2024-11-13 | Version: 1.14.2
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................. 11 1.1 Notes on the documentation........................................................................................................... 11 1.2 For your safety................................................................................................................................ 12 1.3 Notes on information security.......................................................................................................... 13 1.4 Documentation issue status............................................................................................................ 13 2 Overview.................................................................................................................................................. 14 3 Getting started......................................................................................................................................... 16 4 Function blocks....................................................................................................................................... 19 4.1 FB_Json Dom Parser........................................................................................................................ 19 4.1.1 Load Document From File................................................................................................... 23 4.1.2 Add Array Member............................................................................................................. 24 4.1.3 Add Base64Member......................................................................................................... 25 4.1.4 Add Bool Member.............................................................................................................. 26 4.1.5 Add Date Time Member...................................................................................................... 27 4.1.6 Add Dc Time Member......................................................................................................... 27 4.1.7 Add Double Member.......................................................................................................... 28 4.1.8 Add File Time Member........................................................................................................ 29 4.1.9 Add Hex Binary Member..................................................................................................... 29 4.1.10 Add Int64Member.............................................................................................................. 30 4.1.11 Add Int Member.................................................................................................................. 31 4.1.12 Add Json Member.............................................................................................................. 31 4.1.13 Add Null Member............................................................................................................... 32 4.1.14 Add Object Member........................................................................................................... 33 4.1.15 Add String Member............................................................................................................ 33 4.1.16 Add Uint64Member........................................................................................................... 34 4.1.17 Add Uint Member............................................................................................................... 35 4.1.18 Array Begin....................................................................................................................... 35 4.1.19 Array End.......................................................................................................................... 36 4.1.20 Clear Array........................................................................................................................ 37 4.1.21 Copy Document................................................................................................................ 37 4.1.22 Copy From........................................................................................................................ 38 4.1.23 Copy Json......................................................................................................................... 38 4.1.24 Copy String....................................................................................................................... 39 4.1.25 Exception Raised.............................................................................................................. 40 4.1.26 Find Member..................................................................................................................... 41 4.1.27 Find Member Path.............................................................................................................. 41 4.1.28 Get Array Size.................................................................................................................... 43 4.1.29 Get Array Value.................................................................................................................. 43 4.1.30 Get Array Value By Idx......................................................................................................... 44 4.1.31 Get Base64....................................................................................................................... 44 4.1.32 Get Bool............................................................................................................................ 45 4.1.33 Get Date Time.................................................................................................................... 45 4.1.34 Get Dc Time....................................................................................................................... 46 TE1000 Version: 1.14.2 3
## Page 4

Table of contents 4.1.35 Get Document................................................................................................................... 46 4.1.36 Get Document Length........................................................................................................ 47 4.1.37 Get Document Root........................................................................................................... 47 4.1.38 Get Double........................................................................................................................ 47 4.1.39 Get File Time...................................................................................................................... 48 4.1.40 Get Hex Binary................................................................................................................... 48 4.1.41 Get Int............................................................................................................................... 49 4.1.42 Get Int64........................................................................................................................... 49 4.1.43 Get Json............................................................................................................................ 50 4.1.44 Get Json Length................................................................................................................. 50 4.1.45 Get Max Decimal Places..................................................................................................... 51 4.1.46 Get Member Name............................................................................................................. 51 4.1.47 Get Member Value............................................................................................................. 52 4.1.48 Get String.......................................................................................................................... 52 4.1.49 Get String Length............................................................................................................... 53 4.1.50 Get Type........................................................................................................................... 53 4.1.51 Get Uint............................................................................................................................. 54 4.1.52 Get Uint64......................................................................................................................... 55 4.1.53 Has Member...................................................................................................................... 55 4.1.54 Is Array.............................................................................................................................. 56 4.1.55 Is Base64.......................................................................................................................... 56 4.1.56 Is Bool............................................................................................................................... 57 4.1.57 Is Double........................................................................................................................... 57 4.1.58 Is False.............................................................................................................................. 57 4.1.59 Is Hex Binary...................................................................................................................... 58 4.1.60 Is Int.................................................................................................................................. 58 4.1.61 Is Int64.............................................................................................................................. 59 4.1.62 Is ISO8601Time Format..................................................................................................... 59 4.1.63 Is Null................................................................................................................................ 60 4.1.64 Is Number.......................................................................................................................... 60 4.1.65 Is Object............................................................................................................................ 61 4.1.66 Is String............................................................................................................................. 61 4.1.67 Is True............................................................................................................................... 62 4.1.68 Is Uint................................................................................................................................ 62 4.1.69 Is Uint64............................................................................................................................ 62 4.1.70 Member Begin................................................................................................................... 63 4.1.71 Member End...................................................................................................................... 64 4.1.72 New Document.................................................................................................................. 64 4.1.73 Next Array......................................................................................................................... 65 4.1.74 Next Member..................................................................................................................... 65 4.1.75 Parse Document............................................................................................................... 65 4.1.76 Pushback Base64Value.................................................................................................... 66 4.1.77 Pushback Bool Value......................................................................................................... 67 4.1.78 Pushback Copy Value........................................................................................................ 67 4.1.79 Pushback Date Time Value................................................................................................. 68 4.1.80 Pushback Dc Time Value.................................................................................................... 68 4 Version: 1.14.2 TE1000
## Page 5

Table of contents 4.1.81 Pushback Double Value..................................................................................................... 69 4.1.82 Pushback File Time Value.................................................................................................. 69 4.1.83 Pushback Hex Binary Value................................................................................................ 70 4.1.84 Pushback Int64Value........................................................................................................ 70 4.1.85 Pushback Int Value............................................................................................................ 71 4.1.86 Pushback Json Value......................................................................................................... 72 4.1.87 Pushback Null Value.......................................................................................................... 72 4.1.88 Pushback String Value....................................................................................................... 73 4.1.89 Pushback Uint64Value...................................................................................................... 73 4.1.90 Pushback Uint Value.......................................................................................................... 74 4.1.91 Remove All Members......................................................................................................... 75 4.1.92 Remove Array................................................................................................................... 75 4.1.93 Remove Member............................................................................................................... 76 4.1.94 Remove Member By Name................................................................................................. 77 4.1.95 Save Document To File....................................................................................................... 77 4.1.96 Set Ads Provider................................................................................................................ 78 4.1.97 Set Array........................................................................................................................... 79 4.1.98 Set Base64........................................................................................................................ 79 4.1.99 Set Bool............................................................................................................................. 80 4.1.100 Set Date Time.................................................................................................................... 80 4.1.101 Set Dc Time....................................................................................................................... 81 4.1.102 Set Double........................................................................................................................ 81 4.1.103 Set File Time...................................................................................................................... 82 4.1.104 Set Hex Binary................................................................................................................... 83 4.1.105 Set Int................................................................................................................................ 83 4.1.106 Set Int64............................................................................................................................ 84 4.1.107 Set Json............................................................................................................................ 84 4.1.108 Set Max Decimal Places..................................................................................................... 85 4.1.109 Set Null.............................................................................................................................. 85 4.1.110 Set Object......................................................................................................................... 86 4.1.111 Set String.......................................................................................................................... 86 4.1.112 Set Uint............................................................................................................................. 87 4.1.113 Set Uint64......................................................................................................................... 88 4.1.114 Swap................................................................................................................................ 88 4.2 FB_Json Dyn Dom Parser................................................................................................................. 89 4.3 FB_Json Sax Reader........................................................................................................................ 89 4.3.1 Decode Base64................................................................................................................. 90 4.3.2 Decode Date Time............................................................................................................. 91 4.3.3 Decode Dc Time................................................................................................................ 92 4.3.4 Decode File Time............................................................................................................... 92 4.3.5 Decode Hex Binary............................................................................................................ 93 4.3.6 Is Base64.......................................................................................................................... 94 4.3.7 Is Hex Binary...................................................................................................................... 94 4.3.8 Is ISO8601Time Format..................................................................................................... 95 4.3.9 Parse................................................................................................................................ 95 4.3.10 Parse Values..................................................................................................................... 96 TE1000 Version: 1.14.2 5
## Page 6

Table of contents 4.4 FB_Json Sax Writer.......................................................................................................................... 97 4.4.1 Add Base64..................................................................................................................... 100 4.4.2 Add Bool.......................................................................................................................... 100 4.4.3 Add Date Time................................................................................................................. 101 4.4.4 Add Dc Time.................................................................................................................... 101 4.4.5 Add Dint.......................................................................................................................... 101 4.4.6 Add File Time................................................................................................................... 102 4.4.7 Add Hex Binary................................................................................................................ 102 4.4.8 Add Key........................................................................................................................... 103 4.4.9 Add Key Bool................................................................................................................... 103 4.4.10 Add Key Date Time........................................................................................................... 104 4.4.11 Add Key Dc Time.............................................................................................................. 104 4.4.12 Add Key File Time............................................................................................................. 105 4.4.13 Add Key Lreal................................................................................................................... 105 4.4.14 Add Key Null.................................................................................................................... 106 4.4.15 Add Key Number.............................................................................................................. 106 4.4.16 Add Key String................................................................................................................. 107 4.4.17 Add Lint........................................................................................................................... 107 4.4.18 Add Lreal......................................................................................................................... 108 4.4.19 Add Null........................................................................................................................... 108 4.4.20 Add Raw Array................................................................................................................. 108 4.4.21 Add Raw Object............................................................................................................... 109 4.4.22 Add Real......................................................................................................................... 109 4.4.23 Add String....................................................................................................................... 110 4.4.24 Add Udint........................................................................................................................ 110 4.4.25 Add Ulint.......................................................................................................................... 111 4.4.26 Copy Document.............................................................................................................. 111 4.4.27 End Array........................................................................................................................ 112 4.4.28 End Object...................................................................................................................... 112 4.4.29 Get Document................................................................................................................. 113 4.4.30 Get Document Length...................................................................................................... 113 4.4.31 Get Max Decimal Places................................................................................................... 114 4.4.32 Reset Document............................................................................................................. 114 4.4.33 Set Max Decimal Places................................................................................................... 114 4.4.34 Start Array....................................................................................................................... 115 4.4.35 Start Object..................................................................................................................... 115 4.5 FB_Json Sax Pretty Writer............................................................................................................... 115 4.5.1 Add Base64..................................................................................................................... 116 4.5.2 Add Bool.......................................................................................................................... 117 4.5.3 Add Date Time................................................................................................................. 117 4.5.4 Add Dc Time.................................................................................................................... 118 4.5.5 Add Dint.......................................................................................................................... 118 4.5.6 Add File Time................................................................................................................... 118 4.5.7 Add Hex Binary................................................................................................................ 119 4.5.8 Add Key........................................................................................................................... 119 4.5.9 Add Key Bool................................................................................................................... 120 6 Version: 1.14.2 TE1000
## Page 7

Table of contents 4.5.10 Add Key Date Time........................................................................................................... 120 4.5.11 Add Key Dc Time.............................................................................................................. 121 4.5.12 Add Key File Time............................................................................................................. 121 4.5.13 Add Key Lreal................................................................................................................... 122 4.5.14 Add Key Null.................................................................................................................... 122 4.5.15 Add Key Number.............................................................................................................. 123 4.5.16 Add Key String................................................................................................................. 123 4.5.17 Add Lint........................................................................................................................... 124 4.5.18 Add Lreal......................................................................................................................... 124 4.5.19 Add Null........................................................................................................................... 124 4.5.20 Add Raw Array................................................................................................................. 125 4.5.21 Add Raw Object............................................................................................................... 125 4.5.22 Add Real......................................................................................................................... 126 4.5.23 Add String....................................................................................................................... 126 4.5.24 Add Udint........................................................................................................................ 127 4.5.25 Add Ulint.......................................................................................................................... 127 4.5.26 Copy Document.............................................................................................................. 127 4.5.27 End Array........................................................................................................................ 128 4.5.28 End Object...................................................................................................................... 129 4.5.29 Get Document................................................................................................................. 129 4.5.30 Get Document Length...................................................................................................... 129 4.5.31 Get Max Decimal Places................................................................................................... 130 4.5.32 Reset Document............................................................................................................. 130 4.5.33 Set Format Options.......................................................................................................... 131 4.5.34 Set Indent........................................................................................................................ 131 4.5.35 Set Max Decimal Places................................................................................................... 132 4.5.36 Start Array....................................................................................................................... 132 4.5.37 Start Object..................................................................................................................... 133 4.6 FB_Json Read Write Data Type....................................................................................................... 133 4.6.1 Add Json Key Properties From Symbol.............................................................................. 135 4.6.2 Add Json Key Value From Symbol..................................................................................... 136 4.6.3 Add Json Value From Symbol............................................................................................ 137 4.6.4 Copy Json String From Symbol......................................................................................... 138 4.6.5 Copy Json String From Symbol Properties......................................................................... 139 4.6.6 Copy Symbol Name By Address........................................................................................ 140 4.6.7 Get Data Type Name By Address....................................................................................... 141 4.6.8 Get Json From Symbol..................................................................................................... 141 4.6.9 Get Json String From Symbol............................................................................................ 142 4.6.10 Get Json String From Symbol Properties............................................................................ 143 4.6.11 Get Size Json String From Symbol..................................................................................... 144 4.6.12 Get Size Json String From Symbol Properties..................................................................... 145 4.6.13 Get Symbol Name By Address.......................................................................................... 146 4.6.14 Set Symbol From Json...................................................................................................... 146 4.7 FB_Xml Dom Parser....................................................................................................................... 147 4.7.1 Append Attribute............................................................................................................. 151 4.7.2 Append Attribute As Bool.................................................................................................. 152 TE1000 Version: 1.14.2 7
## Page 8

Table of contents 4.7.3 Append Attribute As Double.............................................................................................. 153 4.7.4 Append Attribute As Float................................................................................................. 153 4.7.5 Append Attribute As Int..................................................................................................... 154 4.7.6 Append Attribute As Lint................................................................................................... 155 4.7.7 Append Attribute As Uint................................................................................................... 156 4.7.8 Append Attribute As Ulint.................................................................................................. 156 4.7.9 Append Attribute Copy..................................................................................................... 157 4.7.10 Append Child................................................................................................................... 158 4.7.11 Append Child As Bool....................................................................................................... 158 4.7.12 Append Child As Double................................................................................................... 159 4.7.13 Append Child As Float...................................................................................................... 160 4.7.14 Append Child As Int.......................................................................................................... 161 4.7.15 Append Child As Lint......................................................................................................... 161 4.7.16 Append Child As Uint........................................................................................................ 162 4.7.17 Append Child As Ulint....................................................................................................... 163 4.7.18 Append Copy.................................................................................................................. 163 4.7.19 Append Node.................................................................................................................. 164 4.7.20 Attributes........................................................................................................................ 165 4.7.21 Attribute As Bool.............................................................................................................. 165 4.7.22 Attribute As Double.......................................................................................................... 166 4.7.23 Attribute As Float.............................................................................................................. 166 4.7.24 Attribute As Int.................................................................................................................. 167 4.7.25 Attribute As Lint................................................................................................................ 167 4.7.26 Attribute As Uint............................................................................................................... 168 4.7.27 Attribute As Ulint.............................................................................................................. 168 4.7.28 Attribute Begin................................................................................................................. 169 4.7.29 Attribute From Iterator...................................................................................................... 169 4.7.30 Attribute Name................................................................................................................ 170 4.7.31 Attributes........................................................................................................................ 171 4.7.32 Attribute Text................................................................................................................... 171 4.7.33 Begin.............................................................................................................................. 172 4.7.34 Begin By Name................................................................................................................ 172 4.7.35 Child............................................................................................................................... 173 4.7.36 Child By Attribute............................................................................................................. 173 4.7.37 Child By Attribute And Name............................................................................................. 174 4.7.38 Child By Name................................................................................................................. 175 4.7.39 Children.......................................................................................................................... 176 4.7.40 Children By Name............................................................................................................ 176 4.7.41 Clear Iterator................................................................................................................... 177 4.7.42 Compare........................................................................................................................ 178 4.7.43 Copy Attribute Text.......................................................................................................... 178 4.7.44 Copy Document.............................................................................................................. 179 4.7.45 Copy Node Text............................................................................................................... 180 4.7.46 Copy Node Xml................................................................................................................ 180 4.7.47 First Node By Path............................................................................................................ 181 4.7.48 Get Attribute Text Length.................................................................................................. 182 8 Version: 1.14.2 TE1000
## Page 9

Table of contents 4.7.49 Get Document Length...................................................................................................... 182 4.7.50 Get Document Node........................................................................................................ 182 4.7.51 Get Node Text Length....................................................................................................... 183 4.7.52 Get Node Xml Length........................................................................................................ 183 4.7.53 Get Root Node................................................................................................................. 184 4.7.54 Insert Attribute Copy........................................................................................................ 184 4.7.55 Insert Attribute................................................................................................................. 185 4.7.56 Insert Child...................................................................................................................... 185 4.7.57 Insert Copy...................................................................................................................... 186 4.7.58 Is End.............................................................................................................................. 187 4.7.59 Load Document From File................................................................................................. 187 4.7.60 New Document................................................................................................................ 188 4.7.61 Next................................................................................................................................ 189 4.7.62 Next Attribute.................................................................................................................. 189 4.7.63 Next By Name.................................................................................................................. 190 4.7.64 Next Sibling..................................................................................................................... 190 4.7.65 Next Sibling By Name....................................................................................................... 191 4.7.66 Node............................................................................................................................... 192 4.7.67 Node As Bool................................................................................................................... 192 4.7.68 Node As Double............................................................................................................... 193 4.7.69 Node As Float.................................................................................................................. 193 4.7.70 Node As Int...................................................................................................................... 194 4.7.71 Node As Lint..................................................................................................................... 194 4.7.72 Node As Uint.................................................................................................................... 195 4.7.73 Node As Ulint................................................................................................................... 195 4.7.74 Node Name..................................................................................................................... 196 4.7.75 Node Text........................................................................................................................ 196 4.7.76 Parse Document............................................................................................................. 197 4.7.77 Remove Child.................................................................................................................. 197 4.7.78 Remove Child By Name.................................................................................................... 198 4.7.79 Save Document To File..................................................................................................... 198 4.7.80 Set Ads Provider.............................................................................................................. 199 4.7.81 Set Attribute.................................................................................................................... 199 4.7.82 Set Attribute As Bool......................................................................................................... 200 4.7.83 Set Attribute As Double..................................................................................................... 201 4.7.84 Set Attribute As Float........................................................................................................ 201 4.7.85 Set Attribute As Int............................................................................................................ 202 4.7.86 Set Attribute As Lint.......................................................................................................... 202 4.7.87 Set Attribute As Uint.......................................................................................................... 203 4.7.88 Set Attribute As Ulint......................................................................................................... 203 4.7.89 Set Child.......................................................................................................................... 204 4.7.90 Set Child As Bool.............................................................................................................. 204 4.7.91 Set Child As Double.......................................................................................................... 205 4.7.92 Set Child As Float............................................................................................................. 205 4.7.93 Set Child As Int................................................................................................................. 206 4.7.94 Set Child As Lint................................................................................................................ 207 TE1000 Version: 1.14.2 9
## Page 10

Table of contents 4.7.95 Set Child As Uint............................................................................................................... 207 4.7.96 Set Child As Ulint.............................................................................................................. 208 4.8 FB_Jwt Encode.............................................................................................................................. 208 5 Interfaces............................................................................................................................................... 210 5.1 ITc Json Sax Handler....................................................................................................................... 210 5.1.1 On Bool........................................................................................................................... 210 5.1.2 On Dint............................................................................................................................ 210 5.1.3 On End Array................................................................................................................... 210 5.1.4 On End Object.................................................................................................................. 210 5.1.5 On Key............................................................................................................................ 210 5.1.6 On Lint............................................................................................................................. 211 5.1.7 On Lreal.......................................................................................................................... 211 5.1.8 On Null............................................................................................................................ 211 5.1.9 On Start Array.................................................................................................................. 211 5.1.10 On Start Object................................................................................................................ 211 5.1.11 On String......................................................................................................................... 212 5.1.12 On Udint.......................................................................................................................... 212 5.1.13 On Ulint........................................................................................................................... 212 5.2 ITc Json Sax Values........................................................................................................................ 212 5.2.1 On Bool Value.................................................................................................................. 212 5.2.2 On Dint Value................................................................................................................... 212 5.2.3 On Lint Value................................................................................................................... 213 5.2.4 On Lreal Value................................................................................................................. 213 5.2.5 On Null Value................................................................................................................... 213 5.2.6 On String Value................................................................................................................ 213 5.2.7 On Udint Value................................................................................................................. 214 5.2.8 On Ulint Value.................................................................................................................. 214 6 Samples................................................................................................................................................. 215 6.1 Tc3Json Xml Sample Json Data Type............................................................................................... 215 6.2 Tc3Json Xml Sample Json Sax Reader............................................................................................. 217 6.3 Tc3Json Xml Sample Json Sax Writer............................................................................................... 217 6.4 Tc3Json Xml Sample Json Dom Reader........................................................................................... 218 6.5 Tc3Json Xml Sample Xml Dom Reader............................................................................................. 219 6.6 Tc3Json Xml Sample Xml Dom Writer............................................................................................... 220 7 Error Codes........................................................................................................................................... 222 7.1 ADS Return Codes........................................................................................................................ 222 8 Support and Service............................................................................................................................. 227 10 Version: 1.14.2 TE1000
## Page 11

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. For installation and commissioning of the components, it is absolutely necessary to observe the documentation and the following notes and explanations. The qualified personnel is obliged to always use the currently valid documentation. The responsible staff must ensure that the application or use of the products described satisfies all requirements for safety, including all the relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. No claims to modify products that have already been supplied may be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff, Twin CAT, Twin CAT/BSD, TC/BSD, Ether CAT, Ether CAT G, Ether CAT G10, Ether CAT P, Safety over Ether CAT, Twin SAFE, XFC, XTS and XPlanar are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of designations or trademarks used in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Patents The Ether CAT Technology is covered, including but not limited to the following patent applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 and similar applications and registrations in several other countries. Ether CAT is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright  Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document as well as the use and communication of its contents without express authorization are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. TE1000 Version: 1.14.2 11
## Page 12

Foreword 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 12 Version: 1.14.2 TE1000
## Page 13

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. 1.4 Documentation issue status Version Change 1.14.x New: Next Member [} 65] Note on reference to changed handling of SJson Value added Adaptation of the paths to Twin CAT 3.1.4026 1.13.x Samples/Tc3Json Xml Sample Xml Dom Reader [} 219]: Change in the code New: Pushback Copy Value [} 67], and Clear Iterator [} 177] TE1000 Version: 1.14.2 13
## Page 14

Overview 2 Overview With the aid of the PLC library Tc3_Json Xml, SAX and DOM parser technologies can be used to create and navigate through JSON and XML documents. System requirements Target System Win7, WES7, WEC7, Win10 IPC or CX, (x86, x64, ARM) Min. Twin CAT version 3.1.4022.0 Min. Twin CAT level TC1200 TC3 PLC SAX (simple API for XML) SAX was originally developed for handling XML documents, but can also be used for other data formats such as JSON. A SAX parser treats the data to be read or written as a sequential data stream. When reading a data stream, defined callback methods are called, which then return the corresponding contents of the data stream. A SAX parser is therefore also referred to as an event-based parser. The events occurring (callback methods) are stateless, i.e. they are not dependent on the preceding events. The advantage of this is that the XML document never has to be completely contained in the memory and the application can react "on the fly" via the callbacks. DOM (Document Object Model) DOM is a specification for accessing XML documents, but can also be used for other data formats such as HTML or JSON. The interface is based on a defined object model, whose validity is a prerequisite for correct use. This object model represents a document, e.g. a JSON document, in the form of a tree structure in the memory, which can then be used to navigate through the document. DOM allows navigation between the individual nodes, the creation, moving and deletion of nodes, and the reading, changing and deletion of node contents. When editing is finished a new JSON or XML document is generated from the finalized tree structure. The advantage here is that no own data housekeeping needs to be created with the read-in data, since the data exist in the DOM and can be continuously accessed. JSON document The following section shows a JSON document as an example: { "Variable Name X": 0.0, "Variable Name Y": 0.0, "Variable Name Z": 0.0 } SJson Value When using SJson Value, please note that these are temporary pointers. Permanent use through storage and reuse is not intended. In particular, note that updating the pointer of a "parent node" always invalidates the pointers of the following "child nodes". Metadata The Tc3_Json Xml library contains the function block FB_Json Read Write Data Type [} 133], which enables automatic generation of metadata by means of PLC attributes. { "Values": { "Variable Name X": 0.0, "Variable Name Y": 0.0, "Variable Name Z": 0.0 }, "Meta Data": { "Variable Name X": { "Unit": "A" }, "Variable Name Y": { 14 Version: 1.14.2 TE1000
## Page 15

Overview "Unit": "V" }, "Variable Name Z": { "Unit": "m A" } } } See also: Samples > Tc3Json Xml Sample Json Data Type [} 215]. In order to use UTF-8 characters, e.g. in the automatic generation of metadata via the function block FB_Json Read Write Data Type [} 133], the check box for the support of UTF-8 in the symbolism must be activated in the Twin CAT project. To do this, double-click on SYSTEM in the project tree, open the Settings tab and activate the corresponding check box. JSON Web Token (JWT) JSON Web Token (JWT) is an open standard (based on RFC 7519) that defines a compact and self- describing format for securely transmitting information between communication devices in the form of a JSON object. The authenticity of the transmitted information can be verified and ensured, since a JWT is provided with a digital signature. The signature can involve a shared secret (via an HMAC algorithm) or a public/private key (via RSA). The most common application example for JWT is the authorization of a device or user for a service. Once a user has logged into the service, all further requests to the service include the JWT. Based on the JWT, the service can then decide which additional services or resources the user may access. This means, for example, that single sign-on solutions can be implemented in cloud services. The Tc3_Json Xml library provides a function for creating a JWT via the FB_Jwt Encode [} 208] method. TE1000 Version: 1.14.2 15
## Page 16

Getting started 3 Getting started This documentation article is intended as a quick-start guide to using the Tc3_Json Xml PLC library. The article is based on the following use case:  A JSON document exists that is to be processed further.  The JSON document is in the form of a file on the local file system.  The article describes the steps to parse the JSON document. For more code samples, please refer to our samples [} 215]. File contents The file my Json Content.json is located in the local file system under the following path: c: \temp\my Json Content.json and has the following content: { "Timestamp":"2017-04-04T12:42:42", "Values": { "Sensor1": 42.41999816894531, "Sensor2": [1,2,3,4,5], "Sensor3": 10 } } Declarations The following variable declarations are required for the further procedure: fb Json : FB_Json Dom Parser; json Root : SJson Value; json Prop : SJson Value; json Iterator : SJson Value; json Iterator End : SJson Value; b Load Json File : BOOL; s Timestamp : STRING; f Sensor1 : LREAL; a Sensor2 : ARRAY[0..4] OF DINT; n Sensor3 : DINT; i : UINT; Furthermore, please make sure that you have added a reference to the PLC library Tc3_Json Xml in your PLC project. Reading the file The method Load Document From File [} 23] from the function block FB_Json Dom Parser [} 19] is used to read the file. The execution of the method is controlled by a rising edge at input b Exec. IF b Load Json File = TRUE THEN fb Json. Load Document From File('C:\Temp\my Json Content.json', b Load Json File); END_IF Source of the JSON document If in your use case the JSON document already exists in the PLC, e.g. in a variable of data type STRING, you can use the method Parse Document [} 65] to load the document into memory and for further processing. Parsing the JSON document The Get Document Root [} 47] method can be used to reference the beginning of the JSON document in memory. The return value of the method is an interface pointer. json Root := fb Json. Get Document Root(); From here, the other keys on the first level can be read, e.g. the 'Timestamp' key via the method Get String [} 52]: 16 Version: 1.14.2 TE1000
## Page 17

Getting started json Prop := fb Json. Find Member(json Root, 'Timestamp'); IF (json Prop <> 0) THEN s Timestamp := fb Json. Get String(json Prop); END_IF The next key ('Values') is a nested JSON object. The child elements of this object can be read directly via the method Find Member Path [} 41], for example for the element 'Values/Sensor1': json Prop := fb Json. Find Member Path(json Root, 'Values/Sensor1'); IF (json Prop <> 0) THEN f Sensor1 := fb Json. Get Double(json Prop); END_IF The next child element ('Values/Sensor2') is an array. This can be read by using the methods Array Begin [} 35] and Array End [} 36]. json Prop := fb Json. Find Member Path(json Root, 'Values/Sensor2'); IF (json Prop <> 0) THEN json Iterator := fb Json. Array Begin(json Prop); json Iterator End := fb Json. Array End(json Prop); WHILE json Iterator <> json Iterator End DO IF (json Prop <> 0) THEN a Sensor2[i] := fb Json. Get Int(json Iterator); END_IF json Iterator := fb Json. Next Array(json Iterator); i := i + 1; END_WHILE i := 0; END_IF Handling of the next child element ('Values/Sensor3') is similar to the element 'Values/Sensor1'. Instead of the method Get Double [} 47] the method Get Int [} 49] is used to read the value of the key. json Prop := fb Json. Find Member Path(json Root, 'Values/Sensor3'); IF (json Prop <> 0) THEN n Sensor3 := fb Json. Get Int(json Prop); END_IF Complete code sample Below you will find the above code snippets as a complete sample. Declaration part PROGRAM MAIN fb Json : FB_Json Dom Parser; json Root : SJson Value; json Prop : SJson Value; json Iterator : SJson Value; json Iterator End : SJson Value; b Load Json File : BOOL; s Timestamp : STRING; f Sensor1 : LREAL; a Sensor2 : ARRAY[0..4] OF DINT; n Sensor3 : DINT; i : UINT; END_VAR Implementation part IF b Load Json File = TRUE THEN fb Json. Load Document From File('C:\Temp\my Json Content.json', b Load Json File); json Root := fb Json. Get Document Root(); json Prop := fb Json. Find Member(json Root, 'Timestamp'); IF (json Prop <> 0) THEN s Timestamp := fb Json. Get String(json Prop); END_IF json Prop := fb Json. Find Member Path(json Root, 'Values/Sensor1'); IF (json Prop <> 0) THEN f Sensor1 := fb Json. Get Double(json Prop); END_IF json Prop := fb Json. Find Member Path(json Root, 'Values/Sensor2'); IF (json Prop <> 0) THEN json Iterator := fb Json. Array Begin(json Prop); json Iterator End := fb Json. Array End(json Prop); WHILE json Iterator <> json Iterator End DO IF (json Prop <> 0) THEN a Sensor2[i] := fb Json. Get Int(json Iterator); TE1000 Version: 1.14.2 17
## Page 18

Getting started END_IF json Iterator := fb Json. Next Array(json Iterator); i := i + 1; END_WHILE i := 0; END_IF json Prop := fb Json. Find Member Path(json Root, 'Values/Sensor3'); IF (json Prop <> 0) THEN n Sensor3 := fb Json. Get Int(json Prop); END_IF END_IF After the above code has been executed successfully, the keys that were read out are in the corresponding PLC variables, e.g. as follows: 18 Version: 1.14.2 TE1000
## Page 19

Function blocks 4 Function blocks 4.1 FB_Json Dom Parser This function block is derived from the same internal function block as FB_Json Dyn Dom Parser [} 89] and thus offers the same interface. The two derived function blocks differ only in their internal memory management. FB_Json Dom Parser is optimized for the fast and efficient parsing and creation of JSON documents that are only changed a little. The function block FB_Json Dyn Dom Parser [} 89] is recommended for JSON documents to which many changes are made (e.g. the cyclic changing of a specific value in the JSON document). WARNING Use of router memory The function block occupies new memory with each change, e.g. with the methods Set Object() or Set Json(). As a result, the amount of router memory used can grow enormously after repeated actions. This allocated memory is only released again by calling the New Document [} 64]() or Parse Document [} 65]() methods. Strings in UTF-8 format The variables of type STRING used here are based on the UTF-8 format. This STRING formatting is common for MQTT communication as well as for JSON documents. In order to be able to receive special characters and texts from a wide range of languages, the character set in the Tc3_Iot Base and Tc3_Json Xml libraries is not limited to the typical character set of the data type STRING. Instead, the Unicode character set in UTF-8 format is used in conjunction with the data type STRING. If the ASCII character set is used, there is no difference between the typical formatting of a STRING and the UTF-8 formatting of a STRING. Further information on the UTF-8 STRING format and available display and conversion options can be found in the documentation for the Tc2_Utilities PLC library. Syntax FUNCTION_BLOCK FB_Json Dom Parser VAR_OUTPUT init Status : HRESULT; END_VAR Outputs Name Type init Status HRESULT TE1000 Version: 1.14.2 19
## Page 20

Function blocks Methods 20 Version: 1.14.2 TE1000
## Page 21

Function blocks Name Description Add Array Member [} 24] Adds an Array member to a JSON object. Add Base64Member [} 25] Adds a Base64 member to a JSON object. Add Bool Member [} 26] Adds a Bool member to a JSON object. Add Date Time Member [} 27] Adds a Date Time member to a JSON object. Add Dc Time Member [} 27] Adds a Dc Time member to a JSON object. Add Double Member [} 28] Adds a Double member to a JSON object. Add File Time Member [} 29] Adds a File Time member to a JSON object. Add Hex Binary Member [} 29] Adds a Hex Binary member to a JSON object. Add Int64Member [} 30] Adds an Int64 member to a JSON object. Add Int Member [} 31] Adds an Int member to a JSON object. Add Json Member [} 31] Adds a JSON member to a JSON object. Add Null Member [} 32] Adds a NULL member to a JSON object. Add Object Member [} 33] Adds an Object member to a JSON object. Add String Member [} 33] Adds a String member to a JSON object. Add Uint64Member [} 34] Adds an UInt64 member to a JSON object. Add Uint Member [} 35] Adds an UInt member to a JSON object. Array Begin [} 35] Returns the first element of an array. Array End [} 36] Returns the last element of an array. Clear Array [} 37] Deletes the contents of an array. Copy Document [} 37] Copies the contents of the DOM memory into a variable of data type STRING. Copy Json [} 38] Extracts a JSON object from a key and stores it in a variable of data type STRING. Copy String [} 39] Copies the value of a key into a variable of data type STRING. Find Member [} 41] Searches for a specific property in a JSON document. Find Member Path [} 41] Searches for a specific property in a JSON document (path-specific). Get Array Size [} 43] Returns the number of elements in a JSON array. Get Array Value [} 43] Returns the value at the current iterator position of an array. Get Array Value By Idx [} 44] Returns the value of an array at a specified index. Get Base64 [} 44] Decodes a Base64 value from a JSON property. Get Bool [} 45] Returns the value of a property of the data type BOOL. Get Date Time [} 45] Returns the value of a property of the data type DATE_AND_TIME. Get Dc Time [} 46] Returns the value of a property of the data type DCTIME. Get Document [} 46] Returns the content of the DOM memory as the data type STRING(255). Get Document Length [} 47] Returns the length of a JSON document in the DOM memory. Get Document Root [} 47] Returns the root node of a JSON document in the DOM memory. Get Double [} 47] Returns the value of a property of the data type LREAL. Get File Time [} 48] Returns the value of a property of the data type DCTIME. Get Hex Binary [} 48] Decodes the Hex Binary content of a property and writes it to a certain memory address, Get Int [} 49] Returns the value of a property of the data type DINT. Get Int64 [} 49] Returns the value of a property of the data type LINT. Get Json [} 50] Returns the value of a property of the data type STRING(255). Get Json Length [} 50] Returns the length of a property if this is a JSON document. TE1000 Version: 1.14.2 21
## Page 22

Function blocks Name Description Get Max Decimal Places [} 51] Returns the current setting for Max Decimal Places. Get Member Name [} 51] Returns the name of a JSON property member at the position of the current iterator, Get Member Value [} 52] Returns the value of a JSON property member at the position of the current iterator, Get String [} 52] Returns the value of a property of the data type STRING(255). Get String Length [} 53] Returns the length of a property if its value is a string. Get Type [} 53] Returns the type of a property value. Get Uint [} 54] Returns the value of a property of the data type UDINT. Get Uint64 [} 55] Returns the value of a property of the data type ULINT. Has Member [} 55] Checks whether a certain property is present in the DOM memory. Is Array [} 56] Checks whether a given property is an array. Is Base64 [} 56] Checks whether the value of a given property is of the data type Base64. Is Bool [} 57] Checks whether the value of a given property is of the data type BOOL. Is Double [} 57] Checks whether the value of a given property is of the data type Double (PLC: LREAL). Is False [} 57] Checks whether the value of a given property is FALSE. Is Hex Binary [} 58] Checks whether the value of a property is in the Hex Binary format. Is Int [} 58] Checks whether the value of a given property is of the data type Integer (PLC: DINT) . Is Int64 [} 59] Checks whether the value of a given property is of the data type LINT. Is ISO8601Time Format [} 59] Checks whether the value of a given property has a time format according to ISO8601. Is Null [} 60] Checks whether the value of a given property is NULL. Is Number [} 60] Checks whether the value of a given property is a numerical value. Is Object [} 61] Checks whether the given property is a further JSON object. Is String [} 61] Checks whether the value of a given property is of the data type STRING. Is True [} 62] Checks whether the value of a given property is TRUE. Is Uint [} 62] Checks whether the value of a given property is of the data type UDINT. Is Uint64 [} 62] Checks whether the value of a given property is of the data type ULINT. Load Document From File [} 23] Loads a JSON document from a file. Member Begin [} 63] Returns the first child element below a JSON property. Member End [} 64] Returns the last child element below a JSON property. New Document [} 64] Generates a new empty JSON document in the DOM memory. Next Array [} 65] Returns the next element in an array. Next Member [} 65] Returns the next property in a JSON document. Parse Document [} 65] Loads a JSON object into the DOM memory for further processing. Popback Value Deletes the element at the end of an array. Pushback Base64Value [} 66] Appends a Base64 value to the end of an array. Pushback Bool Value [} 67] Appends a Base64 value to the end of an array. Pushback Date Time Value [} 68] Appends a value of the data type DATE_AND_TIME to the end of an array. Pushback Dc Time Value [} 68] Appends a value of the data type DCTIME to the end of an array. 22 Version: 1.14.2 TE1000
## Page 23

Function blocks Name Description Pushback Double Value [} 69] Appends a value of the data type Double to the end of an array. Pushback File Time Value [} 69] Appends a value of the data type FILETIME to the end of an array. Pushback Hex Binary Value [} 70] This method appends a Hex Binary-coded value to the end of an array. Pushback Int64Value [} 70] Appends a value of the data type Int64 to the end of an array. Pushback Int Value [} 71] Appends a value of the data type INT to the end of an array. Pushback Json Value [} 72] Appends a JSON document to the end of an array. Pushback Null Value [} 72] Appends a NULL value to the end of an array. Pushback String Value [} 73] Appends a value of the data type String to the end of an array. Pushback Uint64Value [} 73] Appends a value of the data type UInt64 to the end of an array. Pushback Uint Value [} 74] Appends a value of the data type UInt to the end of an array. Remove All Members [} 75] Removes all child elements from a given property. Remove Array [} 75] Deletes the value of the current array iterator. Remove Member [} 76] Deletes the property at the current iterator. Remove Member By Name [} 77] Removes a child element from a given property. Save Document To File [} 77] Saves a JSON document in a file. Set Array [} 79] Sets the value of a property to the type "Array". Set Base64 [} 79] Sets the value of a property to a Base64-coded value. Set Bool [} 80] Sets the value of a property to a value of the data type BOOL. Set Date Time [} 80] Sets the value of a property to a value of the data type DATE_AND_TIME. Set Dc Time [} 81] Sets the value of a property to a value of the data type DCTIME. Set Double [} 81] Sets the value of a property to a value of the data type Double. Set File Time [} 82] Sets the value of a property to a value of the data type FILETIME. Set Hex Binary [} 83] Sets the value of a property to a Hex Binary-coded value. Set Int [} 83] Sets the value of a property to a value of the data type INT Set Int64 [} 84] Sets the value of a property to a value of the data type Int64. Set Json [} 84] Inserts a further JSON document into the value of a property. Set Max Decimal Places [} 85] Sets the current setting for Max Decimal Places. Set Null [} 85] Sets the value of a property to the value NULL. Set Object [} 86] Sets the value of a property to the type "Object". Set String [} 86] Sets the value of a property to a value of the data type STRING. Set Uint [} 87] Sets the value of a property to a value of the data type UInt. Set Uint64 [} 88] Sets the value of a property to a value of the data type UInt64. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4022 x86, x64, ARM Tc3_Json Xml 4.1.1 Load Document From File This method loads a JSON document from a file. TE1000 Version: 1.14.2 23
## Page 24

Function blocks A rising edge on the input parameter b Exec triggers the loading procedure. The asynchronous process is terminated as soon as the reference b Exec is set back to FALSE from the method. When the process ends, the return value of the method indicates whether the loading of the file was successful (TRUE) or failed (FALSE) for the duration of one call. Encoding Please note that the imported files must be formatted in UTF-8. Formats such as UTF-16 are not supported. Syntax METHOD Load Document From File : BOOL VAR_IN_OUT CONSTANT s File : STRING; END_VAR VAR_INPUT b Exec : REFERENCE TO BOOL; END_VAR VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Load Document From File BOOL Inputs Name Type b Exec REFERENCE TO BOOL / Inputs/outputs Name Type s File STRING Outputs Name Type hr Error Code HRESULT Sample call: IF b Load THEN b Loaded := fb Json. Load Document From File(s File, b Load); END_IF 4.1.2 Add Array Member This method adds an array member to a JSON object. Syntax METHOD Add Array Member : SJson Value VAR_INPUT v : SJson Value; 24 Version: 1.14.2 TE1000
## Page 25

Function blocks END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR VAR_INPUT reserve : UDINT; END_VAR Return value Name Type Add Array Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) reserve UDINT / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Add Array Member(json Doc, 'Test Array', 0); 4.1.3 Add Base64Member This method adds a Base64 member to a JSON object. A structure, for example, can be addressed as an input parameter. The corresponding Base64 coding is done by the method. Syntax METHOD Add Base64Member : SJson Value VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Base64Member SJson Value (note possible invalidity [} 14]) TE1000 Version: 1.14.2 25
## Page 26

Function blocks Inputs Name Type v SJson Value (note possible invalidity [} 14]) p PVOID n DINT / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Base64 := fb Json. Add Base64Member(json Doc, 'Test Base64', ADR(st Struct), SIZEOF(st Struct)); 4.1.4 Add Bool Member This method adds a Bool member to a JSON object. Syntax METHOD Add Bool Member : SJson Value VAR_INPUT v : SJson Value; value : BOOL; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Bool Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value BOOL / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Bool Member(json Doc, 'Test Bool', TRUE); 26 Version: 1.14.2 TE1000
## Page 27

Function blocks 4.1.5 Add Date Time Member This method adds a Date Time member to a JSON object. Syntax METHOD Add Date Time Member : SJson Value VAR_INPUT v : SJson Value; value : DATE_AND_TIME; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Date Time Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value DATE_AND_TIME / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Date Time Member(json Doc, 'Test Date Time', DT#2018-11-22-12:12); 4.1.6 Add Dc Time Member This method adds a Dc Time member to a JSON object. Syntax METHOD Add Dc Time Member : SJson Value VAR_INPUT v : SJson Value; value : DCTIME; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR TE1000 Version: 1.14.2 27
## Page 28

Function blocks Return value Name Type Add Dc Time Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value DCTIME / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Dc Time Member(json Doc, 'Test Dc Time', 1234); 4.1.7 Add Double Member This method adds a Double member to a JSON object. Syntax METHOD Add Double Member : SJson Value VAR_INPUT v : SJson Value; value : LREAL; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Double Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value LREAL / Inputs/outputs Name Type member STRING Sample call: 28 Version: 1.14.2 TE1000
## Page 29

Function blocks json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Double Member(json Doc, 'Test Double', 42.42); 4.1.8 Add File Time Member This method adds a File Time member to a JSON object. Syntax METHOD Add File Time Member : SJson Value VAR_INPUT v : SJson Value; value : FILETIME; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add File Time Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value FILETIME / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add File Time Member(json Doc, 'Test File Time', ft Time); 4.1.9 Add Hex Binary Member This method adds a Hex Binary member to a JSON object. Syntax METHOD Add Hex Binary Member : SJson Value VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR TE1000 Version: 1.14.2 29
## Page 30

Function blocks VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Hex Binary Member Sjson Value (note possible invalidity [} 14]) Inputs Name Type v Sjson Value (note possible invalidity [} 14]) p PVOID n DINT / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Hex Binary Member(json Doc, Test Hex Binary, s Hex Binary, SIZEOF(s Hex Binary)); 4.1.10 Add Int64Member This method adds an Int64 member to a JSON object. Syntax METHOD Add File Time Member : Sjson Value VAR_INPUT v : Sjson Value; value : LINT; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Int64Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value LINT 30 Version: 1.14.2 TE1000
## Page 31

Function blocks / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Int64Member(json Doc, 'Test Int64', 42); 4.1.11 Add Int Member This method adds an Int member to a JSON object. Syntax METHOD Add Int Member : SJson Value VAR_INPUT v : SJson Value; value : DINT; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Int Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value DINT / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Int Member(json Doc, 'Test Int', 42); 4.1.12 Add Json Member This method adds a JSON member to a JSON object. TE1000 Version: 1.14.2 31
## Page 32

Function blocks Syntax METHOD Add Json Member: SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT member : STRING; raw Json : STRING; END_VAR Return value Name Type Add Json Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type member STRING raw Json STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Json Member(json Doc, 'Test Json', s Json); 4.1.13 Add Null Member This method adds a NULL member to a JSON object. Syntax METHOD Add Null Member : SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Null Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) 32 Version: 1.14.2 TE1000
## Page 33

Function blocks / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Null Member(json Doc, 'Test Json'); 4.1.14 Add Object Member This method adds an Object member to a JSON object. Syntax METHOD Add Object Member : SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Object Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Object Member(json Doc, 'Test Object'); 4.1.15 Add String Member This method adds a String member to a JSON object. Syntax METHOD Add String Member : SJson Value VAR_INPUT v : SJson Value; TE1000 Version: 1.14.2 33
## Page 34

Function blocks END_VAR VAR_IN_OUT CONSTANT member : STRING; value : STRING; END_VAR Return value Name Type Add String Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type member STRING value STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add String Member(json Doc, 'Test String', 'Test'); 4.1.16 Add Uint64Member This method adds an UInt64 member to a JSON object. Syntax METHOD Add Uint64Member : SJson Value VAR_INPUT v : SJson Value; value : ULINT; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Uint64Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value ULINT 34 Version: 1.14.2 TE1000
## Page 35

Function blocks / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Uint64Member(json Doc, 'Test Uint64', 42); 4.1.17 Add Uint Member This method adds an UInt member to a JSON object. Syntax METHOD Add Uint Member : SJson Value VAR_INPUT v : SJson Value; value : UDINT; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Add Uint Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value UDINT / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Mem := fb Json. Add Uint Member(json Doc, 'Test Uint', 42); 4.1.18 Array Begin This method returns the first element of an array and can be used together with the methods Array End() and Next Array() for iteration through a JSON array. TE1000 Version: 1.14.2 35
## Page 36

Function blocks Syntax METHOD Array Begin : SJson AIterator VAR_INPUT v : SJson Value; END_VAR Return value Name Type Array Begin SJson AIterator Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Iterator := fb Json. Array Begin(json Array); json Iterator End := fb Json. Array End(json Array); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Array Value(json Iterator); json Iterator := fb Json. Next Array(json Iterator); END_WHILE 4.1.19 Array End This method returns the last element of an array and can be used together with the methods Array Begin() and Next Array() for iteration through a JSON array. Syntax METHOD Array End : SJson AIterator VAR_INPUT v : SJson Value; END_VAR Return value Name Type Array End SJson AIterator Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Iterator := fb Json. Array Begin(json Array); json Iterator End := fb Json. Array End(json Array); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Array Value(json Iterator); json Iterator := fb Json. Next Array(json Iterator); END_WHILE 36 Version: 1.14.2 TE1000
## Page 37

Function blocks 4.1.20 Clear Array This method deletes the content of an array. Syntax METHOD Clear Array : BOOL VAR_INPUT v : SJson Value; i : SJson AIterator; END_VAR Return value Name Type Clear Array BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) i SJson AIterator Sample call: The following JSON document is to be loaded into the DOM memory: s Message := '{"serial Number":"123","battery Voltage":"1547m V","click Type":"SINGLE", "array": ["Hello",2,3]}'; The values of the JSON array "array" are to be deleted. First of all, the JSON document is searched iteratively for the "array" property, after which all elements of the array are deleted by calling the Clear Array() method. json Doc := fb Json. Parse Document(s Message); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Value := fb Json. Get Member Value(json Iterator); IF s Name = 'array' THEN json Array Iterator := fb Json. Array Begin(json Value); fb Json. Clear Array(json Value, json Array Iterator); END_IF json Iterator := fb Json. Next Member(json Iterator); END_WHILE 4.1.21 Copy Document This method copies the contents of the DOM memory into a variable of data type STRING, which can have any length. The method returns the length of the string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy Document : UDINT VAR_INPUT n Doc : DINT; TE1000 Version: 1.14.2 37
## Page 38

Function blocks END_VAR VAR_IN_OUT CONSTANT p Doc : STRING; END_VAR Return value Name Type Copy Document UDINT Inputs Name Type n Doc DINT / Inputs/Outputs Name Type p Doc STRING Sample call: n Len := fb Json. Copy Document(s Json, SIZEOF(s Json)); 4.1.22 Copy From Syntax METHOD Copy From : SJson Value VAR_INPUT v : SJson Value; w : SJson Value; END_VAR Return value Name Type Copy From SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) w SJson Value (note possible invalidity [} 14]) 4.1.23 Copy Json 38 Version: 1.14.2 TE1000
## Page 39

Function blocks This method extracts a JSON object from a key and stores it in a variable of data type STRING. This STRING can have any length. The method returns the length of the copied JSON object (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy Json : UDINT VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT p Doc : STRING; n Doc : UDINT; END_VAR Return value Name Type Copy Json UDINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type p Doc STRING n Doc STRING Sample call: The following JSON document is to be loaded into the DOM memory: s Message := ' {"serial Number":"123","meta":{"battery Voltage":"1547m V","click Type":"SINGLE"}}'; The value of the JSON object "meta" is to be extracted and stored in a variable of data type STRING. First the JSON document is searched iteratively for the property "meta", then its value or sub-object is extracted by calling the method Copy Json(). json Doc := fb Json. Parse Document(s Message); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Value := fb Json. Get Member Value(json Iterator); IF s Name = 'meta' THEN fb Json. Copy Json(json Value, s String, SIZEOF(s String)); END_IF json Iterator := fb Json. Next Member(json Iterator); END_WHILE After this run, the s String variable has the following content: {"battery Voltage":"1547m V","click Type":"SINGLE"} 4.1.24 Copy String TE1000 Version: 1.14.2 39
## Page 40

Function blocks This method copies the value of a key into a variable of the data type STRING, which can be of any length. The method returns the length of the copied string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy String : UDINT VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT p Str : STRING; n Str : UDINT; END_VAR Return value Name Type Copy String UDINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type p Str STRING n Str UDINT Sample call: The following JSON document is to be loaded into the DOM memory: s Message := ' {"serial Number":"123","battery Voltage":"1547m V","click Type":"SINGLE"}'; The value of the key "click Type" is to be extracted and stored in a variable of data type STRING. First, the JSON document is iteratively searched for the property "click Type". json Doc := fb Json. Parse Document(s Message); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Value := fb Json. Get Member Value(json Iterator); IF s Name = 'click Type' THEN fb Json. Copy String(json Value, s String, SIZEOF(s String)); END_IF json Iterator := fb Json. Next Member(json Iterator); END_WHILE After this run, the s String variable has the following content: SINGLE 4.1.25 Exception Raised 40 Version: 1.14.2 TE1000
## Page 41

Function blocks Syntax METHOD Exception Raised : BOOL Return value Name Type Exception Raised BOOL 4.1.26 Find Member This method searches for a specific property in a JSON document and returns it. 0 is returned if no corresponding property is found. Syntax METHOD Find Member : SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Find Member SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type member STRING Sample call: json Prop := fb Json. Find Member(json Doc, 'Property Name'); 4.1.27 Find Member Path This method searches for a specific property in a JSON document and returns it. The property is specified according to its path in the document. 0 is returned if no corresponding property is found. Syntax METHOD Find Member Path : SJson Value VAR_INPUT v : SJson Value TE1000 Version: 1.14.2 41
## Page 42

Function blocks END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Find Member Path SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member Path(json Doc, s Path); Accessing nested objects works according to the scheme a/b/c, to find a variable in a JSON hierarchy. The call for the variable c of the following JSON document is: json Prop := fb Json. Find Member Path(json Doc, 'a/b/c'); { "a":{ "b":{ "c": 123 } } } Support for arrays The method supports JSON documents with arrays from Twin CAT version >3.1.4024.35. The # character can be used to access elements of an array. json Prop := fb Json. Find Member Path(json Doc, '#1/Third#2'); [ { "First": 4 }, { "Second": 12, "Third": [ 1, 2, 3 ], "Fourth": { "a": true } }, ] The example call accesses the second element of the outer array (#1), then the third element of the array under the sub-element Third. 42 Version: 1.14.2 TE1000
## Page 43

Function blocks Treatment of special cases Inserting the ~ character provides special treatment within a path. The following table lists the different possibilities. Expression Result Example ~0 ~ is used as a character in the Test/Hello~0123 becomes Test/ string. Hello~123 ~1 The expression is replaced by the Test/Hello~1123 becomes Test/ character /, which is not interpreted Hello/123 as a separator, but as part of the string. ~2 The expression is replaced by the Test/Hello~2123 becomes Test/ character # , which is not Hello#123 interpreted as an array index, but as part of the string. 4.1.28 Get Array Size This method returns the number of elements in a JSON array. Syntax METHOD Get Array Size : UDINT VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Array Size UDINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); n Size := fb Json. Get Array Size(json Array); 4.1.29 Get Array Value This method returns the value at the current iterator position of an array. Syntax METHOD Get Array Value : SJson Value VAR_INPUT i : SJson AIterator; END_VAR TE1000 Version: 1.14.2 43
## Page 44

Function blocks Return value Name Type Get Array Value SJson Value (note possible invalidity [} 14]) Inputs Name Type i SJson AIterator Sample call: json Iterator := fb Json. Array Begin(json Array); json Iterator End := fb Json. Array End(json Array); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Array Value(json Iterator); json Iterator := fb Json. Next Array(json Iterator); END_WHILE 4.1.30 Get Array Value By Idx This method returns the value of an array in a specified index. Syntax METHOD Get Array Value By Idx : SJson Value VAR_INPUT v : SJson Value; idx : UDINT; END_VAR Return value Name Type Get Array Value By Idx SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) idx UDINT Sample call: json Value := fb Json. Get Array Value By Idx(json Array, 1); 4.1.31 Get Base64 This method decodes a Base64 value from a JSON property. If the content of a data structure, for example, is located behind the Base64 value, the decoded content can also be placed on an identical structure again. 44 Version: 1.14.2 TE1000
## Page 45

Function blocks Syntax METHOD Get Base64: DINT VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR Return value Name Type Get Base64 DINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) p PVOID n DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Base64 := fb Json. Find Member(json Doc, 'base64'); n Size := fb Json. Get Base64(json Base64, ADR(st Struct), SIZEOF(st Struct)); 4.1.32 Get Bool This method returns the value of a property of the data type BOOL. Syntax METHOD Get Bool : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Bool BOOL Inputs Name Type v Sjson Value (note possible invalidity [} 14]) 4.1.33 Get Date Time This method returns the value of a property of the data type DATE_AND_TIME. TE1000 Version: 1.14.2 45
## Page 46

Function blocks Syntax METHOD Get Date Time : DATE_AND_TIME VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Date Time DATE_AND_TIME Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.34 Get Dc Time This method returns the value of a property of the data type DCTIME. Syntax METHOD Get Dc Time : DCTIME VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Dc Time DCTIME Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); dc Time := fb Json. Get Dc Time(json Prop); 4.1.35 Get Document This method returns the content of the DOM memory as the data type STRING(255). With longer strings, the method will return a NULL string. In this case the method Copy Document [} 37]() must be used. Syntax METHOD Get Document : STRING(255) 46 Version: 1.14.2 TE1000
## Page 47

Function blocks Return value Name Type Get Document STRING(255) Sample call: s Json := fb Json. Get Document(); 4.1.36 Get Document Length This method returns the length of a JSON document in the DOM memory. Syntax METHOD Get Document Length: UDINT Return value Name Type Get Document Length UDINT Sample call: n Len := fb Json. Get Document Length(); 4.1.37 Get Document Root This method returns the root node of a JSON document in the DOM memory. Syntax METHOD Get Document Root : SJson Value Return value Name Type Get Document Root Sjson Value (note possible invalidity [} 14]) Sample call: json Root := fb Json. Get Document Root(); 4.1.38 Get Double This method returns the value of a property of the data type LREAL. TE1000 Version: 1.14.2 47
## Page 48

Function blocks Syntax METHOD Get Double : LREAL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Double LREAL Inputs Name Type v Sjson Value (note possible invalidity [} 14]) 4.1.39 Get File Time This method returns the value of a property of the data type DCTIME. Syntax METHOD Get File Time : FILETIME VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get File Time FILETIME Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); file Time := fb Json. Get File Time(json Prop); 4.1.40 Get Hex Binary This method decodes the Hex Binary content of a property and writes it to a certain memory address, e.g. to a data structure. 48 Version: 1.14.2 TE1000
## Page 49

Function blocks Syntax METHOD Get Hex Binary : DINT VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR Return value Name Type Get Hex Binary DINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) p PVOID n DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); n Len := fb Json. Get Hex Binary(json Prop, ADR(st Struct), SIZEOF(st Struct)); 4.1.41 Get Int This method returns the value of a property of the data type DINT. Syntax METHOD Get Int : DINT VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Int DINT Inputs Name Type v Sjson Value (note possible invalidity [} 14]) 4.1.42 Get Int64 This method returns the value of a property of the data type LINT. TE1000 Version: 1.14.2 49
## Page 50

Function blocks Syntax METHOD Get Int64 : LINT VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Int64 LINT Inputs Name Type v Sjson Value (note possible invalidity [} 14]) 4.1.43 Get Json This method returns the value of a property as data type STRING(255), if this is a JSON document itself. With longer strings, the method will return a NULL string. In this case the method Copy Json [} 38]() must be used. Syntax METHOD Get Json : STRING(255) VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Json STRING(255) Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); s Json := fb Json. Get Json(json Prop); 4.1.44 Get Json Length This method returns the length of a property if this is a JSON document. 50 Version: 1.14.2 TE1000
## Page 51

Function blocks Syntax METHOD Get Json Length : UDINT VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Json Length UDINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); n Len := fb Json. Get Json Length(json Prop); 4.1.45 Get Max Decimal Places This method returns the current setting for Max Decimal Places. This influences the number of decimal places in the case of floating-point numbers. Syntax METHOD Get Max Decimal Places : DINT Return value Name Type Get Max Decimal Places DINT Sample call: n Dec := fb Json. Get Max Decimal Places(); 4.1.46 Get Member Name This method returns the name of a JSON property member at the position of the current iterator, e.g. during the iteration of a child element of a JSON property with the methods Member Begin(), Member End() and Next Member(). Syntax METHOD Get Member Name : STRING(255) VAR_INPUT i : SJson Iterator; END_VAR TE1000 Version: 1.14.2 51
## Page 52

Function blocks Return value Name Type Get Member Name STRING(255) Inputs Name Type i SJson Iterator Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Iterator := fb Json. Next Member(json Iterator); END_WHILE 4.1.47 Get Member Value This method returns the value of a JSON property member at the position of the current iterator, e.g. during the iteration of a child element of a JSON property with the methods Member Begin(), Member End() and Next Member(). Syntax METHOD Get Member Value : SJson Value VAR_INPUT i : SJson Iterator; END_VAR Return value Name Type Get Member Value SJson Value (note possible invalidity [} 14]) Inputs Name Type i SJson Iterator Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO json Value := fb Json. Get Member Value(json Iterator); json Iterator := fb Json. Next Member(json Iterator); END_WHILE 4.1.48 Get String 52 Version: 1.14.2 TE1000
## Page 53

Function blocks This method returns the value of a property of the data type STRING(255). With longer strings, the method will return a NULL string. In this case the method Copy String [} 39]() must be used. Syntax METHOD Get String : STRING(255) VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get String STRING(255) Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.49 Get String Length This method returns the length of a property if its value is a string. Syntax METHOD Get String Length : UDINT VAR_INPUT v : SJson Value END_VAR Return value Name Type Get String Length UDINT Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); n Len := fb Json. Get String Length(json Prop); 4.1.50 Get Type This method returns the type of a property value. The return value can assume one of the values of the enum EJson Type. TE1000 Version: 1.14.2 53
## Page 54

Function blocks Syntax METHOD Get Type : EJson Type VAR_INPUT v : SJson Value END_VAR TYPE EJson Type : ( e Null Type := 0, e False Type := 1, e True Type := 2, e Object Type := 3, e Array Type := 4, e String Type := 5, e Number Type := 6 ) DINT; Return value Name Type Get Type EJson Type Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); e Json Type := fb Json. Get Type(json Prop); 4.1.51 Get Uint This method returns the value of a property of the data type UDINT. Syntax METHOD Get Uint : UDINT VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Uint UDINT Inputs Name Type v Sjson Value (note possible invalidity [} 14]) 54 Version: 1.14.2 TE1000
## Page 55

Function blocks 4.1.52 Get Uint64 This method returns the value of a property of the data type ULINT. Syntax METHOD Get Uint64 : ULINT VAR_INPUT v : SJson Value; END_VAR Return value Name Type Get Uint64 ULINT Inputs Name Type v Sjson Value (note possible invalidity [} 14]) 4.1.53 Has Member This method checks whether a certain property is present in the DOM memory. If the property is present the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Has Member : BOOL VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Has Member BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type member STRING TE1000 Version: 1.14.2 55
## Page 56

Function blocks Sample call: b Has Member := fb Json. Has Member(json Doc, 'Property Name'); 4.1.54 Is Array This method checks whether a given property is an array. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Array : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Array BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.55 Is Base64 This method checks whether the value of a given property is of the data type Base64. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Base64 : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Base64 BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 56 Version: 1.14.2 TE1000
## Page 57

Function blocks 4.1.56 Is Bool This method checks whether the value of a given property is of the data type BOOL. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Bool : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Bool BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.57 Is Double This method checks whether the value of a given property is of the data type Double (PLC: LREAL). If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Double : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Double BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.58 Is False TE1000 Version: 1.14.2 57
## Page 58

Function blocks This method checks whether the value of a given property is FALSE. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is False : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is False BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.59 Is Hex Binary This method checks whether the value of a property is in the Hex Binary format. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Hex Binary: BOOL VAR_INPUT v : SJson Value END_VAR Return value Name Type Is Hex Binary BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); b Ret := fb Json. Is Hex Binary(json Prop); 4.1.60 Is Int This method checks whether the value of a given property is of the data type Integer (PLC: DINT). If that is the case, the method returns TRUE, otherwise it returns FALSE. 58 Version: 1.14.2 TE1000
## Page 59

Function blocks Syntax METHOD Is Int : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Int BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.61 Is Int64 This method checks whether the value of a given property is of the data type LINT. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Int64 : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Int64 BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.62 Is ISO8601Time Format This method checks whether the value of a given property has a time format according to ISO8601. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is ISO8601Time Format : BOOL VAR_INPUT v : SJson Value; END_VAR TE1000 Version: 1.14.2 59
## Page 60

Function blocks Return value Name Type Is ISO8601Time Format BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.63 Is Null This method checks whether the value of a given property is NULL. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Null : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Null BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.64 Is Number This method checks whether the value of a given property is a numerical value. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Number : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Number BOOL 60 Version: 1.14.2 TE1000
## Page 61

Function blocks Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.65 Is Object This method checks whether the given property is a further JSON object. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Object : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Object BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.66 Is String This method checks whether the value of a given property is of the data type STRING. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is String : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is String BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) TE1000 Version: 1.14.2 61
## Page 62

Function blocks 4.1.67 Is True This method checks whether the value of a given property is TRUE. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is True : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is True BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.68 Is Uint This method checks whether the value of a given property is of the data type UDINT. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Uint : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Uint BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.69 Is Uint64 62 Version: 1.14.2 TE1000
## Page 63

Function blocks This method checks whether the value of a given property is of the data type ULINT. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Uint64 : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Is Uint64 BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) 4.1.70 Member Begin This method returns the first child element below a JSON property and can be used by a JSON property together with the methods Member End() and Next Member() for iteration. Syntax METHOD Member Begin : SJson Iterator VAR_INPUT v : SJson Value; END_VAR Return value Name Type Member Begin SJson Iterator Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Iterator := fb Json. Next Member(json Iterator); END_WHILE TE1000 Version: 1.14.2 63
## Page 64

Function blocks 4.1.71 Member End This method returns the last child element below a JSON property and can be used by a JSON property together with the methods Member Begin() and Next Member() for iteration. Syntax METHOD Member End : SJson Iterator VAR_INPUT v : SJson Value; END_VAR Return value Name Type Member End SJson Iterator Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Iterator := fb Json. Next Member(json Iterator); END_WHILE 4.1.72 New Document This method generates a new empty JSON document in the DOM memory. Syntax METHOD New Document : SJson Value Sample call: json Doc := fb Json. New Document(); Return value Name Type New Document SJson Value (note possible invalidity [} 14]) 64 Version: 1.14.2 TE1000
## Page 65

Function blocks 4.1.73 Next Array Syntax METHOD Next Array : SJson AIterator VAR_INPUT v : SJson AIterator; END_VAR Return value Name Type Next Array SJson AIterator Inputs Name Type i SJson Alterator 4.1.74 Next Member This method returns the next child element below a JSON property and can be used by a JSON property together with the methods Member Begin [} 63]() and Member End [} 64]() for iteration. Syntax METHOD Next Member : SJson Iterator VAR_INPUT v : SJson Iterator; END_VAR Return value Name Type Next Member SJson Iterator Inputs Name Type i SJson Iterator 4.1.75 Parse Document This method loads a JSON object into the DOM memory for further processing. The JSON object takes the form of a string and is transferred to the method as an input. A reference to the JSON document in the DOM memory is returned to the caller. TE1000 Version: 1.14.2 65
## Page 66

Function blocks Syntax METHOD Parse Document : SJson Value VAR_IN_OUT CONSTANT s Json : STRING; END_VAR Return value Name Type Parse Document SJson Value (note possible invalidity [} 14]) Inputs Name Type s Json STRING Sample call: json Doc := fb Json. Parse Document(s Json String); 4.1.76 Pushback Base64Value This method appends a Base64 value to the end of an array. A structure, for example, can be addressed as an input parameter. The corresponding Base64 coding is done by the method. Syntax METHOD Pushback Base64Value : SJson Value VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR Return value Name Type Pushback Base64Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) p PVOID n DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Base64Value(json Array, ADR(st Struct), SIZEOF(st Struct)); 66 Version: 1.14.2 TE1000
## Page 67

Function blocks 4.1.77 Pushback Bool Value This method appends a value of the data type BOOL to the end of an array. Syntax METHOD Pushback Bool Value : SJson Value VAR_INPUT v : SJson Value; value : BOOL; END_VAR Return value Name Type Pushback Bool Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) value BOOL Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Bool Value(json Array, TRUE); 4.1.78 Pushback Copy Value This method adds a JSON document from the memory of a FB_Json Dom Parser [} 19] to the end of an array. Syntax METHOD Pushback Copy Value : SJson Value VAR_INPUT v : SJson Value; json : SJson Value; END_VAR Return value Name Type Pushback Copy Value Sjson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) json SJson Value (note possible invalidity [} 14]) TE1000 Version: 1.14.2 67
## Page 68

Function blocks Sample call: json Copy:=fb Json Create. New Document(); fb Json Create. Add Int Member(json Copy,'a',1); fb Json Create. Add Int Member(json Copy,'b',2); json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Copy Value(json Array, json Copy); 4.1.79 Pushback Date Time Value This method appends a value of the data type DATE_AND_TIME to the end of an array. Syntax METHOD Pushback Date Time Value : SJson Value VAR_INPUT v : SJson Value; value : DATE_AND_TIME; END_VAR Return value Name Type Pushback Date Time Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) value DATE_AND_TIME Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Date Time Value(json Array, dt Time); 4.1.80 Pushback Dc Time Value This method appends a value of the data type DCTIME to the end of an array. Syntax METHOD Pushback Dc Time Value : SJson Value VAR_INPUT v : SJson Value; value : DCTIME; END_VAR Return value Name Type Pushback Dc Time Value SJson Value (note possible invalidity [} 14]) 68 Version: 1.14.2 TE1000
## Page 69

Function blocks Inputs Name Type v s Json Value (note possible invalidity [} 14]) value DCTIME Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Dc Time Value(json Array, dc Time); 4.1.81 Pushback Double Value This method appends a value of the data type Double to the end of an array. Syntax METHOD Pushback Double Value : SJson Value VAR_INPUT v : SJson Value; value : LREAL; END_VAR Return value Name Type Pushback Double Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) value LREAL Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Double Value(json Array, 42.42); 4.1.82 Pushback File Time Value This method appends a value of the data type FILETIME to the end of an array. Syntax METHOD Pushback File Time Value : SJson Value VAR_INPUT v : SJson Value; value : FILETIME; END_VAR TE1000 Version: 1.14.2 69
## Page 70

Function blocks Return value Name Type Pushback File Time Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) value FILETIME Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback File Time Value(json Array, file Time); 4.1.83 Pushback Hex Binary Value This method appends a Hex Binary value to the end of an array. The coding in the Hex Binary format is executed by the method. A data structure, for example, can be used as the source. Syntax METHOD Pushback Hex Binary Value : SJson Value VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR Return value Name Type Pushback Hex Binary Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) p PVOID n DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Hex Binary Value(json Array, ADR(st Struct), SIZEOF(st Struct)); 4.1.84 Pushback Int64Value 70 Version: 1.14.2 TE1000
## Page 71

Function blocks This method appends a value of the data type Int64 to the end of an array. Syntax METHOD Pushback Int64Value : SJson Value VAR_INPUT v : SJson Value; value : LINT; END_VAR Return value Name Type Pushback Int64Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) value LINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Int64Value(json Array, 42); 4.1.85 Pushback Int Value This method appends a value of the data type INT to the end of an array. Syntax METHOD Pushback Int Value : SJson Value VAR_INPUT v : SJson Value; value : DINT; END_VAR Return value Name Type Pushback Int Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v s Json Value (note possible invalidity [} 14]) value DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Int Value(json Array, 42); TE1000 Version: 1.14.2 71
## Page 72

Function blocks 4.1.86 Pushback Json Value This method appends a JSON document that exists as a STRING in the PLC to the end of an array. Syntax METHOD Pushback Json Value : SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT raw Json : STRING; END_VAR Return value Name Type Pushback Json Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type raw Json STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Json Value(json Array, s Json); 4.1.87 Pushback Null Value This method appends a NULL value to the end of an array. Syntax METHOD Pushback Null Value : SJson Value VAR_INPUT v : SJson Value; END_VAR Return value Name Type Pushback Null Value SJson Value (note possible invalidity [} 14]) 72 Version: 1.14.2 TE1000
## Page 73

Function blocks Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Null Value(json Array); 4.1.88 Pushback String Value This method appends a value of the data type DCTIME to the end of an array. Syntax METHOD Pushback String Value : SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT value : STRING; END_VAR Return value Name Type Pushback String Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type value STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback String Value(json Array, s String); 4.1.89 Pushback Uint64Value This method appends a value of the data type UInt64 to the end of an array. TE1000 Version: 1.14.2 73
## Page 74

Function blocks Syntax METHOD Pushback Uint64Value : SJson Value VAR_INPUT v : SJson Value; value : ULINT; END_VAR Return value Name Type Pushback Uint64Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value ULINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Uint64Value(json Array, 42); 4.1.90 Pushback Uint Value This method appends a value of the data type UInt to the end of an array. Syntax METHOD Pushback Uint Value : SJson Value VAR_INPUT v : SJson Value; value : UDINT; END_VAR Return value Name Type Pushback Uint Value SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value UDINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Array := fb Json. Find Member(json Doc, 'array'); json Value := fb Json. Pushback Uint Value(json Array, 42); 74 Version: 1.14.2 TE1000
## Page 75

Function blocks 4.1.91 Remove All Members This method removes all child elements from a given property. Syntax METHOD Remove All Members : BOOL VAR_INPUT v : SJson Value; END_VAR Return value Name Type Remove All Members BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); b Removed := fb Json. Remove All Members(json Prop); 4.1.92 Remove Array This method deletes the value of the current array iterator. Syntax METHOD Remove Array : BOOL VAR_INPUT v : SJson Value; i : SJson AIterator; END_VAR Return value Name Type Remove Array BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) i SJson AIterator Sample call: The following JSON document is to be loaded into the DOM memory: TE1000 Version: 1.14.2 75
## Page 76

Function blocks s Message := '{"serial Number":"123","battery Voltage":"1547m V","click Type":"SINGLE", "array": ["Hello",2,3]}'; The first array position is to be deleted. First of all, the JSON document is searched iteratively for the "array" property, after which the first element of the array is removed by calling the Remove Array() method. json Doc := fb Json. Parse Document(s Message); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); json Value := fb Json. Get Member Value(json Iterator); IF s Name = 'array' THEN json Array Iterator := fb Json. Array Begin(json Value); fb Json. Remove Array(json Value, json Array Iterator); END_IF json Iterator := fb Json. Next Member(json Iterator); END_WHILE 4.1.93 Remove Member This method deletes the property at the current iterator. Syntax METHOD Remove Member : BOOL VAR_INPUT v : SJson Value; i : SJson Iterator; keep Order : BOOL; END_VAR Return value Name Type Remove Member BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) i SJson Iterator keep Order BOOL Sample call: The following JSON document is to be loaded into the DOM memory: s Message := '{"serial Number":"123","battery Voltage":"1547m V","click Type":"SINGLE", "array": ["Hello",2,3]}'; The "array" property is to be deleted. First of all, the JSON document is searched for the "array" property, after which the property is removed. json Doc := fb Json. Parse Document(s Message); json Iterator := fb Json. Member Begin(json Doc); json Iterator End := fb Json. Member End(json Doc); WHILE json Iterator <> json Iterator End DO s Name := fb Json. Get Member Name(json Iterator); IF s Name = 'array' THEN fb Json. Remove Member(json Doc, json Iterator); END_IF json Iterator := fb Json. Next Member(json Iterator); END_WHILE 76 Version: 1.14.2 TE1000
## Page 77

Function blocks 4.1.94 Remove Member By Name This method removes a child element from a given property. The element is referenced by its name. Syntax METHOD Remove Member By Name : BOOL VAR_INPUT v : SJson Value; keep Order : BOOL; END_VAR VAR_IN_OUT CONSTANT member : STRING; END_VAR Return value Name Type Remove Member By Name BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) keep Order BOOL / Inputs/outputs Name Type member STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Remove Member By Name(json Prop, 'Child Name'); 4.1.95 Save Document To File This method saves a JSON document in a file. A rising edge at the input parameter b Exec triggers the saving procedure. The asynchronous process is terminated as soon as the reference b Exec is set back to FALSE from the method. When the process ends, the return value of the method indicates for one call whether saving of the file was successful (TRUE) or failed (FALSE). Syntax METHOD Save Document To File : BOOL VAR_IN_OUT CONSTANT s File : STRING; END_VAR VAR_INPUT b Exec : REFERENCE TO BOOL; END_VAR TE1000 Version: 1.14.2 77
## Page 78

Function blocks VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Save Document To File BOOL Inputs Name Type b Exec REFERENCE TO BOOL / Inputs/Outputs Name Type s File STRING Outputs Name Type hr Error Code HRESULT Sample call: IF b Save THEN b Saved := fb Json. Save Document To File(s File, b Save); END_IF 4.1.96 Set Ads Provider This method sets the context in which the file accesses are processed when loading and saving the JSON documents. If no ADS provider is specified, the current task is used. Syntax METHOD Set Ads Provider : BOOL VAR_INPUT oid : OTCID; END_VAR Return value Name Type Description Set Ads Provider BOOL The method returns TRUE if the setting of the ADS provider was successful. Inputs Name Type Description oid OTCID Object ID of the task. Sample call: 78 Version: 1.14.2 TE1000
## Page 79

Function blocks b Test := fb Json. Set Ads Provider(02010030); 4.1.97 Set Array This method sets the value of a property to the type "Array". New values can now be added to the array with the Pushback methods. Syntax METHOD Set Array : SJson Value VAR_INPUT v : SJson Value; END_VAR Return value Name Type Set Array SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Array(json Prop); 4.1.98 Set Base64 This method sets the value of a property to a Base64-coded value. A data structure, for example, can be used as the source. Coding to the Base64 format takes place inside the method. Syntax METHOD Set Base64 : SJson Value VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR Return value Name Type Set Base64 SJson Value (note possible invalidity [} 14]) TE1000 Version: 1.14.2 79
## Page 80

Function blocks Inputs Name Type v SJson Value (note possible invalidity [} 14]) p PVOID n DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Base64(json Prop, ADR(st Struct), SIZEOF(st Struct)); 4.1.99 Set Bool This method sets the value of a property to a value of the data type BOOL. Syntax METHOD Set Bool : SJson Value VAR_INPUT v : SJson Value; value : BOOL; END_VAR Return value Name Type Set Bool SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value BOOL Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Bool(json Prop, TRUE); 4.1.100 Set Date Time This method sets the value of a property to a value of the data type DATE_AND_TIME. Syntax METHOD Set Date Time : SJson Value VAR_INPUT v : SJson Value; value : DATE_AND_TIME; END_VAR 80 Version: 1.14.2 TE1000
## Page 81

Function blocks Return value Name Type Set Date Time SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value DATE_AND_TIME Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Date Time(json Prop, dt Time); 4.1.101 Set Dc Time This method sets the value of a property to a value of the data type DCTIME. Syntax METHOD Set Dc Time : SJson Value VAR_INPUT v : SJson Value; value : DCTIME; END_VAR Return value Name Type Set Dc Time SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value DCTIME Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Dc Time(json Prop, dc Time); 4.1.102 Set Double This method sets the value of a property to a value of the data type Double. TE1000 Version: 1.14.2 81
## Page 82

Function blocks Syntax METHOD Set Double : SJson Value VAR_INPUT v : SJson Value; value : LREAL; END_VAR Return value Name Type Set Double SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value LREAL Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Double(json Prop, 42.42); 4.1.103 Set File Time This method sets the value of a property to a value of the data type FILETIME. Syntax METHOD Set File Time : SJson Value VAR_INPUT v : SJson Value; value : FILETIME; END_VAR Return value Name Type Set File Time SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value FILETIME Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set File Time(json Prop, file Time); 82 Version: 1.14.2 TE1000
## Page 83

Function blocks 4.1.104 Set Hex Binary This method sets the value of a property to a Hex Binary-coded value. A data structure, for example, can be used as the source. Coding to the Hex Binary format takes place inside the method. Syntax METHOD Set Hex Binary : SJson Value VAR_INPUT v : SJson Value; p : PVOID; n : DINT; END_VAR Return value Name Type Set Hex Binary SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) p PVOID n DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Hex Binary(json Prop, ADR(st Struct), SIZEOF(st Struct)); 4.1.105 Set Int This method sets the value of a property to a value of the data type INT. Syntax METHOD Set Int : SJson Value VAR_INPUT v : SJson Value; value : DINT; END_VAR Return value Name Type Set Int SJson Value (note possible invalidity [} 14]) TE1000 Version: 1.14.2 83
## Page 84

Function blocks Inputs Name Type v SJson Value (note possible invalidity [} 14]) value DINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Int(json Prop, 42); 4.1.106 Set Int64 This method sets the value of a property to a value of the data type Int64. Syntax METHOD Set Int64 : SJson Value VAR_INPUT v : SJson Value; value : LINT; END_VAR Return value Name Type Set Int64 SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value LINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Int64(json Prop, 42); 4.1.107 Set Json This method inserts a further JSON document into the value of a property. Syntax METHOD Set Json : SJson Value VAR_INPUT v : SJson Value; END_VAR VAR_IN_OUT CONSTANT raw Json : STRING; END_VAR 84 Version: 1.14.2 TE1000
## Page 85

Function blocks Return value Name Type Set Json SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type raw Json STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Json(json Prop, s Json); 4.1.108 Set Max Decimal Places This function specifies the number of decimal places after which a floating-point number is rounded. Syntax METHOD Set Max Decimal Places VAR_INPUT dp : DINT; END_VAR Inputs Name Type dp DINT Sample call: n Dec := fb Json. Set Max Decimal Places(); 4.1.109 Set Null This method sets the value of a property to the value NULL. Syntax METHOD Set Null : SJson Value VAR_INPUT v : SJson Value; END_VAR TE1000 Version: 1.14.2 85
## Page 86

Function blocks Return value Name Type Set Null SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Null(json Prop); 4.1.110 Set Object This method sets the value of a property to the type "Object". This enables the nesting of JSON documents. Syntax METHOD Set Object : SJson Value VAR_INPUT v : SJson Value; END_VAR Return value Name Type Set Object Sjson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Object(json Prop); 4.1.111 Set String This method sets the value of a property to a value of the data type STRING. Syntax METHOD Set String : SJson Value VAR_INPUT v : SJson Value; END_VAR 86 Version: 1.14.2 TE1000
## Page 87

Function blocks VAR_IN_OUT CONSTANT value : STRING; END_VAR Return value Name Type Set String SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) / Inputs/outputs Name Type value STRING Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set String(json Prop, 'Hello World'); 4.1.112 Set Uint This method sets the value of a property to a value of the data type UInt. Syntax METHOD Set Uint: SJson Value VAR_INPUT v : SJson Value; value : UDINT; END_VAR Return value Name Type Set Uint SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value UDINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Uint(json Prop, 42); TE1000 Version: 1.14.2 87
## Page 88

Function blocks 4.1.113 Set Uint64 This method sets the value of a property to a value of the data type UInt64. Syntax METHOD Set Uint64 : SJson Value VAR_INPUT v : SJson Value; value : ULINT; END_VAR Return value Name Type Set Uint64 SJson Value (note possible invalidity [} 14]) Inputs Name Type v SJson Value (note possible invalidity [} 14]) value ULINT Sample call: json Doc := fb Json. Parse Document(s Existing Json Document); json Prop := fb Json. Find Member(json Doc, 'property'); json Value := fb Json. Set Uint64(json Prop, 42); 4.1.114 Swap This method swaps the content of two pointers. Syntax METHOD Swap : BOOL VAR_INPUT v : SJson Value; w : SJson Value; END_VAR; END_VAR Return value Name Type Swap BOOL Inputs Name Type v SJson Value (note possible invalidity [} 14]) w SJson Value (note possible invalidity [} 14]) 88 Version: 1.14.2 TE1000
## Page 89

Function blocks 4.2 FB_Json Dyn Dom Parser This function block is derived from the same internal function block as FB_Json Dom Parser [} 19] and thus offers the same interface. The two derived function blocks differ only in their internal memory management. The FB_Json Dyn Dom Parser is optimized for JSON documents where many changes are made and the JSON document is not released in between. It releases the allocated memory after an action has been executed, e.g. in the methods Set Object() or Set Json(). This flexibility results in greater overhead, allowing the FB_Json Dom Parser [} 19] to improve the performance. Strings in UTF-8 format The variables of type STRING used here are based on the UTF-8 format. This STRING formatting is common for MQTT communication as well as for JSON documents. In order to be able to receive special characters and texts from a wide range of languages, the character set in the Tc3_Iot Base and Tc3_Json Xml libraries is not limited to the typical character set of the data type STRING. Instead, the Unicode character set in UTF-8 format is used in conjunction with the data type STRING. If the ASCII character set is used, there is no difference between the typical formatting of a STRING and the UTF-8 formatting of a STRING. Further information on the UTF-8 STRING format and available display and conversion options can be found in the documentation for the Tc2_Utilities PLC library. Syntax FUNCTION_BLOCK FB_Json Dyn Dom Parser VAR_OUTPUT init Status : HRESULT; END_VAR Outputs Name Type init Status HRESULT Methods All methods can be found in FB_Json Dom Parser [} 19]. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4024.7 x86, x64, ARM Tc3_Json Xml 3.3.8.0 4.3 FB_Json Sax Reader Syntax FUNCTION_BLOCK FB_Json Sax Reader VAR_OUTPUT init Status : HRESULT; END_VAR TE1000 Version: 1.14.2 89
## Page 90

Function blocks Outputs Name Type init Status HRESULT Methods Name Description Decode Base64 [} 90] Converts a Base64-formated string to binary data. Decode Date Time [} 91] Creates a PLC variable of the data type DATE_AND_TIME or DT from a standardized ISO8601 time format (e.g. YYYY-MM-DDThh:mm:ss). Decode Dc Time [} 92] Creates a PLC variable of the data type DCTIME from a standardized ISO8601 time format (e.g. YYYY-MM-DDThh:mm:ss). Decode File Time [} 92] Creates a PLC variable of the data type FILETIME from a standardized ISO8601 time format (e.g. YYYY-MM-DDThh:mm:ss). Decode Hex Binary [} 93] Converts a string containing hexadecimal values into binary data. Is Base64 [} 94] Checks whether the transferred string corresponds to the Base64 format. Is Hex Binary [} 94] Checks whether the transferred string consists of hexadecimal values. Is ISO8601Time Format Checks whether the transferred string corresponds to the standardized ISO8601 time format. [} 95] Parse [} 95] Starts the SAX reader parsing process. Parse Values [} 96] Starts the SAX reader parsing process. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4022 x86, x64, ARM Tc3_Json Xml 4.3.1 Decode Base64 This method converts a Base64-formated string to binary data. If the conversion was successful the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Decode Base64 : BOOL VAR_INPUT s Base64 : STRING; p Bytes : POINTER TO BYTE; n Bytes : REFERENCE TO DINT; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Decode Base64 BOOL 90 Version: 1.14.2 TE1000
## Page 91

Function blocks Inputs Name Type s Base64 STRING p Bytes POINTER TO BYTE n Bytes REFERENCE TO DINT Outputs Name Type hr Error Code HRESULT Sample call: b Success := fb Json. Decode Base64('SGVsb G8g VHdpbk NBVA==', ADR(byte Array), byte Array Size); 4.3.2 Decode Date Time This method enables the generation of a PLC variable of the type DATE_AND_TIME or DT from a standardized ISO8601 time format (e.g. YYYY-MM-DDThh:mm:ss). DT corresponds to the number of seconds starting from the date 01.01.1970. If the conversion was successful the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Decode Date Time : BOOL VAR_IN_OUT CONSTANT s DT : STRING; END_VAR VAR_OUTPUT n DT : DATE_AND_TIME; hr Error Code : HRESULT; END_VAR Return value Name Type Decode Date Time BOOL / Inputs/Outputs Name Type s DT STRING Outputs Name Type n DT DATE_AND_TIME hr Error Code HRESULT Sample call: b Success := fb Json. Decode Date Time('2017-08-09T06:54:00', n DT => date Time); TE1000 Version: 1.14.2 91
## Page 92

Function blocks 4.3.3 Decode Dc Time This method enables the generation of a PLC variable of the type DCTIME from a standardized ISO8601 time format (e.g. YYYY-MM-DDThh:mm:ss). DCTIME corresponds to the number of nanoseconds starting from the date 01.01.2000. If the conversion was successful the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Decode Dc Time : BOOL VAR_IN_OUT CONSTANT s DC : STRING; END_VAR VAR_OUTPUT n DC : DCTIME; hr Error Code : HRESULT; END_VAR Return value Name Type Decode Dc Time BOOL / Inputs/Outputs Name Type s DC STRING Outputs Name Type n DC DCTIME hr Error Code HRESULT Sample call: b Success := fb Json. Decode Dc Time('2017-08-09T06:54:00', n Dc => dc Time); 4.3.4 Decode File Time This method enables the generation of a PLC variable of the type FILETIME from a standardized ISO8601 time format (e.g. YYYY-MM-DDThh:mm:ss). FILETIME corresponds to the number of nanoseconds starting from the date 01.01.1601  measured in 100 nanoseconds. If the conversion was successful the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Decode Date Time : BOOL VAR_IN_OUT CONSTANT s FT : STRING; END_VAR VAR_OUTPUT 92 Version: 1.14.2 TE1000
## Page 93

Function blocks n FT : FILETIME; hr Error Code : HRESULT; END_VAR Return value Name Type Decode Date Time BOOL / Inputs/Outputs Name Type s FT STRING Outputs Name Type n FT FILETIME hr Error Code HRESULT Sample call: b Success := fb Json. Decode File Time('2017-08-09T06:54:00', n FT => file Time); 4.3.5 Decode Hex Binary This method converts a string containing hexadecimal values into binary data. If the conversion was successful the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Decode Hex Binary : BOOL VAR_IN_OUT CONSTANT s Hex : STRING; END_VAR VAR_INPUT p Bytes : POINTER TO BYTE; n Bytes : REFERENCE TO DINT; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Decode Hex Binary BOOL Inputs Name Type p Bytes POINTER TO BYTE n Bytes REFERENCE TO DINT TE1000 Version: 1.14.2 93
## Page 94

Function blocks / Inputs/Outputs Name Type s Hex STRING Outputs Name Type hr Error Code HRESULT Sample call: b Success := fb Json. Decode Hex Binary('ABCEF93A', ADR(byte Array), byte Array Size); 4.3.6 Is Base64 This method checks whether the transferred string corresponds to the Base64 format. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Base64 : BOOL VAR_IN_OUT CONSTANT s Base64 : STRING; END_VAR Return value Name Type Is Base64 BOOL / Inputs/Outputs Name Type s Base64 STRING Sample call: b Is Base64 := fb Json. Is Base64('SGVsb G8g VHdpbk NBVA=='); 4.3.7 Is Hex Binary This method checks whether the transferred string consists of hexadecimal values. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is Hex Binary : BOOL VAR_IN_OUT CONSTANT s Hex : STRING; END_VAR 94 Version: 1.14.2 TE1000
## Page 95

Function blocks Return value Name Type Is Hex Binary BOOL / Inputs/Outputs Name Type s Hex STRING Sample call: b Success := fb Json. Is Hex Binary('ABCEF93A'); 4.3.8 Is ISO8601Time Format This method checks whether the transferred string corresponds to the standardized ISO8601 time format. If that is the case, the method returns TRUE, otherwise it returns FALSE. Syntax METHOD Is ISO8601Time Format : BOOL VAR_IN_OUT CONSTANT s DT : STRING; END_VAR Return value Name Type Is ISO8601Time Format BOOL / Inputs/Outputs Name Type s DT STRING Sample call: b Success := fb Json. Is ISO8601Time Format('2017-08-09T06:54:00'); 4.3.9 Parse This method starts the SAX reader parsing procedure. The JSON object to be parsed and a reference to a function block, which was derived from the interface ITc Json Sax Handler, are transferred as input parameters. This function block is then used for the callback methods of the SAX reader. Syntax METHOD Parse : BOOL VAR_IN_OUT CONSTANT s Json : STRING; END_VAR TE1000 Version: 1.14.2 95
## Page 96

Function blocks VAR_INPUT ip Hdl : ITc Json Sax Handler; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Parse BOOL Inputs Name Type ip Hdl ITc Json Sax Handler / Inputs/Outputs Name Type s Json STRING Outputs Name Type hr Error Code HRESULT 4.3.10 Parse Values This method starts the SAX reader parsing procedure. The JSON object to be parsed and a reference to a function block, which was derived from the interface ITc Json Sax Values, are transferred as input parameters. This function block is then used for the callback methods of the SAX reader. What is special about this method is that exclusively values are taken into account in the callback methods, i.e. there are no On Key() or On Start Object() callbacks. Syntax METHOD Parse Values : BOOL VAR_IN_OUT CONSTANT s Json : STRING; END_VAR VAR_INPUT ip Hdl : ITc Json Sax Values; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Parse Values BOOL 96 Version: 1.14.2 TE1000
## Page 97

Function blocks Inputs Name Type ip Hdl ITc Json Sax Values / Inputs/Outputs Name Type s Json STRING Outputs Name Type hr Error Code HRESULT 4.4 FB_Json Sax Writer Strings in UTF-8 format The variables of type STRING used here are based on the UTF-8 format. This STRING formatting is common for MQTT communication as well as for JSON documents. In order to be able to receive special characters and texts from a wide range of languages, the character set in the Tc3_Iot Base and Tc3_Json Xml libraries is not limited to the typical character set of the data type STRING. Instead, the Unicode character set in UTF-8 format is used in conjunction with the data type STRING. If the ASCII character set is used, there is no difference between the typical formatting of a STRING and the UTF-8 formatting of a STRING. Further information on the UTF-8 STRING format and available display and conversion options can be found in the documentation for the Tc2_Utilities PLC library. Syntax FUNCTION_BLOCK FB_Json Sax Writer VAR_OUTPUT init Status : HRESULT; END_VAR Outputs Name Type init Status HRESULT TE1000 Version: 1.14.2 97
## Page 98

Function blocks Methods 98 Version: 1.14.2 TE1000
## Page 99

Function blocks Name Description Add Base64 [} 100] Adds a value of the data type Base64 to a property. Add Bool [} 100] Adds a value of the data type BOOL to a property. Add Date Time [} 101] Adds a value of the data type DATE_AND_TIME to a property. Add Dc Time [} 101] Adds a value of the data type DCTIME to a property. Add Dint [} 101] Adds a value of the data type DINT to a property. Add File Time [} 102] Adds a value of the data type FILETIME to a property. Add Hex Binary [} 102] Adds a Hex Binary value to a property. Add Key [} 103] Adds a new property key at the current position of the SAX Writer. Add Key Bool [} 103] Creates a new property key and at the same time a value of the data type BOOL. Add Key Date Time [} 104] Creates a new property key and at the same time a value of the data type DATE_AND_TIME. Add Key Dc Time [} 104] Creates a new property key and at the same time a value of the data type DCTIME. Add Key File Time [} 105] Creates a new property key and at the same time a value of the data type FILETIME. Add Key Lreal [} 105] Creates a new property key and at the same time a value of the data type LREAL. Add Key Null [} 106] Creates a new property key and initializes its value with null. Add Key Number [} 106] Creates a new property key and at the same time a value of the data type DINT. Add Key String [} 107] Creates a new property key and at the same time a value of the data type STRING. Add Lint [} 107] Adds a value of the data type LINT to a property. Add Lreal [} 108] Adds a value of the data type LREAL to a property. Add Null [} 108] Adds the value null to a property. Add Raw Array [} 108] Adds a valid JSON array to a given property as a value. Add Raw Object [} 109] Adds a valid JSON object to a given property as a value. Add Real [} 109] Adds a value of the data type REAL to a property. Add String [} 110] Adds a value of the data type STRING to a property. Add Udint [} 110] Adds a value of the data type UDINT to a property. Add Ulint [} 111] Adds a value of the data type ULINT to a property. Copy Document [} 111] Copies the contents of the JSON object currently created with the SAX Writer into a target variable of the data type STRING. End Array [} 112] Creates the end of a started JSON array and inserts it at the current position of the SAX Writer. End Object [} 112] Creates the end of a started JSON object and inserts it at the current position of the SAX Writer. Get Document [} 113] Returns the content of the JSON object that is currently created with the SAX Writer and returns it as data type STRING(255). Get Document Length [} 113] Returns the length of the JSON object that is currently created with the SAX Writer and returns it as data type UDINT. Get Max Decimal Places [} 114] Is Complete Reset Document [} 114] Resets the JSON object currently created with the SAX Writer. Set Max Decimal Places [} 114] TE1000 Version: 1.14.2 99
## Page 100

Function blocks Name Description Start Array [} 115] Creates the start of a new JSON array and inserts it at the current position of the SAX Writer. Start Object [} 115] Creates the start of a new JSON object and inserts it at the current position of the SAX Writer. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4022 x86, x64, ARM Tc3_Json Xml 4.4.1 Add Base64 This method adds a value of the data type Base64 to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Base64 VAR_INPUT p Bytes : Pointer TO BYTE; n Bytes : DINT; END_VAR Inputs Name Type p Bytes POINTER TO BYTE n Bytes DINT 4.4.2 Add Bool This method adds a value of the data type BOOL to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Bool VAR_INPUT value : BOOL; END_VAR Inputs Name Type value BOOL Sample call: fb Json. Add Key('b Switch'); fb Json. Add Bool(TRUE); 100 Version: 1.14.2 TE1000
## Page 101

Function blocks 4.4.3 Add Date Time This method adds a value of the data type DATE_AND_TIME to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Date Time VAR_INPUT value : DATE_AND_TIME; END_VAR Inputs Name Type value DATE_AND_TIME Sample call: fb Json. Add Key('Timestamp'); fb Json. Add Date Time(dt Time); // dt Time is of type DATE_AND_TIME 4.4.4 Add Dc Time This method adds a value of the data type DCTIME to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Dc Time VAR_INPUT value : DCTIME; END_VAR Inputs Name Type value DCTIME Sample call: fb Json. Add Key('Timestamp'); fb Json. Add Dc Time(dc Time); // dc Time is of type DCTIME 4.4.5 Add Dint This method adds a value of the data type DINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. TE1000 Version: 1.14.2 101
## Page 102

Function blocks Syntax METHOD Add Dint VAR_INPUT value : DINT; END_VAR Inputs Name Type value DINT Sample call: fb Json. Add Key('n Number'); fb Json. Add Dint(42); 4.4.6 Add File Time This method adds a value of the data type FILETIME to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add File Time VAR_INPUT value : FILETIME; END_VAR Inputs Name Type value FILETIME Sample call: fb Json. Add Key('Timestamp'); fb Json. Add File Time(ft Time); // ft Time is of type FILETIME 4.4.7 Add Hex Binary This method adds a hex binary value to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Hex Binary VAR_INPUT p Bytes : POINTER TO BYTE; n Bytes : DINT; END_VAR 102 Version: 1.14.2 TE1000
## Page 103

Function blocks Inputs Name Type p Bytes POINTER TO BYTE n Bytes DINT Sample call: fb Json. Add Key('Hex Binary'); fb Json. Add Hex Binary(ADR(byte Hex Bin), SIZEOF(byte Hex Bin)); 4.4.8 Add Key This method adds a new property key at the current position of the SAX writer. The value of the new property is usually set afterwards. This can be done using one of the following methods, for example: Add Base64 [} 100], Add Bool [} 100], Add Date Time [} 101], Add Dc Time [} 101], Add Dint [} 101], Add File Time [} 102], Add Hex Binary [} 102], Add Lint [} 107], Add Lreal [} 108], Add Null [} 108], Add Raw Array [} 108], Add Raw Object [} 109], Add Real [} 109], Add String [} 110], Add Udint [} 110], Add Ulint [} 111]. Syntax METHOD Add Key VAR_IN_OUT CONSTANT key : STRING; END_VAR / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key('Property Name'); 4.4.9 Add Key Bool This method creates a new property key and at the same time a value of the data type BOOL. Syntax METHOD Add Key Bool VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : BOOL; END_VAR Inputs Name Type value BOOL TE1000 Version: 1.14.2 103
## Page 104

Function blocks / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Bool('b Switch', TRUE); 4.4.10 Add Key Date Time This method creates a new property key and at the same time a value of the data type DATE_AND_TIME. Syntax METHOD Add Key Date Time VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : DATE_AND_TIME; END_VAR Inputs Name Type value DATE_AND_TIME / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Date Time('Timestamp', dt Time); 4.4.11 Add Key Dc Time This method creates a new property key and at the same time a value of the data type DCTIME. Syntax METHOD Add Key Dc Time VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : DCTIME; END_VAR 104 Version: 1.14.2 TE1000
## Page 105

Function blocks Inputs Name Type value DCTIME / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Dc Time('Timestamp', dc Time); 4.4.12 Add Key File Time This method creates a new property key and at the same time a value of the data type FILETIME. Syntax METHOD Add Key File Time VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : FILETIME; END_VAR Inputs Name Type value FILETIME / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key File Time('Timestamp', ft Time); 4.4.13 Add Key Lreal This method creates a new property key and at the same time a value of the data type LREAL. Syntax METHOD Add Key Lreal VAR_IN_OUT CONSTANT key : STRING; END_VAR TE1000 Version: 1.14.2 105
## Page 106

Function blocks VAR_INPUT value : LREAL; END_VAR Inputs Name Type value LREAL / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Lreal('Property Name', 42.42); 4.4.14 Add Key Null This method creates a new property key and initializes its value with null. Syntax METHOD Add Key Null VAR_IN_OUT CONSTANT key : STRING; END_VAR / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Null('Property Name'); 4.4.15 Add Key Number This method creates a new property key and at the same time a value of the data type DINT. Syntax METHOD Add Key Number VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : DINT; END_VAR 106 Version: 1.14.2 TE1000
## Page 107

Function blocks Inputs Name Type value DINT / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Number('Property Name', 42); 4.4.16 Add Key String This method creates a new property key and at the same time a value of the data type STRING. Syntax METHOD Add Key String VAR_IN_OUT CONSTANT key : STRING; value : STRING; END_VAR / Inputs/Outputs Name Type key STRING value STRING Sample call: fb Json. Add Key String('Property Name', 'Hello World'); 4.4.17 Add Lint This method adds a value of the data type LINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Lint VAR_INPUT value : LINT; END_VAR Inputs Name Type value LINT TE1000 Version: 1.14.2 107
## Page 108

Function blocks Sample call: fb Json. Add Key('Property Name'); fb Json. Add Lint(42); 4.4.18 Add Lreal This method adds a value of the data type LREAL to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Lreal VAR_INPUT value : LREAL; END_VAR Inputs Name Type value LREAL Sample call: fb Json. Add Key('Property Name'); fb Json. Add Lreal(42.42); 4.4.19 Add Null This method adds the value null to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Null Sample call: fb Json. Add Key('Property Name'); fb Json. Add Null(); 4.4.20 Add Raw Array This method adds a valid JSON array to a given property as a value. The array to be added must be in a valid JSON format and may only be added if the SAX Writer is at a correspondingly valid position, e.g. directly after a preceding Add Key() [} 103], Start Array() [} 115] or as the first call after a Reset Document() [} 114]. 108 Version: 1.14.2 TE1000
## Page 109

Function blocks Syntax METHOD Add Raw Array VAR_IN_OUT CONSTANT raw Json : STRING; END_VAR Return value Name Type Add Raw Array BOOL / Inputs/Outputs Name Type raw Json STRING Sample call: fb Json. Add Key('Property Name'); fb Json. Add Raw Array('[1, 2, {"x":42, "y":42}, 4'); 4.4.21 Add Raw Object This method adds a valid JSON object to a given property as a value. The object to be added must be in a valid JSON format and may only be added if the SAX Writer is in an appropriately valid position, e.g. directly after a preceding Add Key() [} 103], Start Array() [} 115] or as the first call after a Reset Document() [} 114]. Syntax METHOD Add Raw Object VAR_IN_OUT CONSTANT raw Json : STRING; END_VAR / Inputs/Outputs Name Type raw Json STRING Sample call: fb Json. Add Key('Property Name'); fb Json. Add Raw Object('{"x":42, "y":42}'); 4.4.22 Add Real This method adds a value of the data type REAL to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Real VAR_INPUT value : REAL; END_VAR TE1000 Version: 1.14.2 109
## Page 110

Function blocks Inputs Name Type value REAL Sample call: fb Json. Add Key('Property Name'); fb Json. Add Real(42.42); 4.4.23 Add String This method adds a value of the data type STRING to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add String VAR_IN_OUT CONSTANT value : STRING; END_VAR / Inputs/Outputs Name Type value STRING Sample call: fb Json. Add Key('Property Name'); fb Json. Add String('Hello World'); 4.4.24 Add Udint This method adds a value of the data type UDINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Udint VAR_INPUT value : UDINT; END_VAR Inputs Name Type value UDINT Sample call: fb Json. Add Key('Property Name'); fb Json. Add Udint(42); 110 Version: 1.14.2 TE1000
## Page 111

Function blocks 4.4.25 Add Ulint This method adds a value of the data type ULINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 103]. Syntax METHOD Add Ulint VAR_INPUT value : ULINT; END_VAR Inputs Name Type value ULINT Sample call: fb Json. Add Key('Property Name'); fb Json. Add Ulint(42); 4.4.26 Copy Document This method copies the content of the current JSON object created with the SAX Writer to a target variable of the data type STRING, which can be of any length. The method returns the length of the string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy Document : UDINT VAR_IN_OUT CONSTANT p Doc : STRING; END_VAR VAR_INPUT n Doc : UDINT; END_VAR VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Copy Document UDINT Inputs Name Type n Doc UDINT TE1000 Version: 1.14.2 111
## Page 112

Function blocks / Inputs/Outputs Name Type p Doc STRING Outputs Name Type hr Error Code HRESULT Sample call: fb Json. Copy Document(s Target String, SIZEOF(s Target String)); 4.4.27 End Array This method generates the end of a started JSON array ("square closing bracket") and inserts it at the current position of the SAX writer. Syntax METHOD End Array : HRESULT Return value Name Type End Array HRESULT Sample call: fb Json. End Array(); 4.4.28 End Object This method generates the end of a started JSON object ("curly closing bracket") and inserts it at the current position of the SAX writer. Syntax METHOD End Object : HRESULT Return value Name Type End Object HRESULT Sample call: fb Json. End Object(); 112 Version: 1.14.2 TE1000
## Page 113

Function blocks 4.4.29 Get Document This method returns the content of the JSON object that is currently created with the SAX Writer and returns it as data type STRING(255). The maximum size of the string returned by the method is 255 characters. With longer strings, the method will return a NULL string. In this case the method Copy Document [} 111]() must be used. Syntax METHOD Get Document : STRING(255) VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Get Document STRING(255) Outputs Name Type hr Error Code HRESULT Sample call: s Target String := fb Json. Get Document(); 4.4.30 Get Document Length This method returns the length of the JSON object that is currently created with the SAX Writer and returns it as data type UDINT. Syntax METHOD Get Document Length : UDINT VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Get Document Length UDINT Outputs Name Type hr Error Code HRESULT Sample call: n Length := fb Json. Get Document Length(); TE1000 Version: 1.14.2 113
## Page 114

Function blocks 4.4.31 Get Max Decimal Places This function queries the currently set number of decimal places after which a floating point number is truncated. Syntax METHOD Get Max Decimal Places : DINT Return value Name Type Description Get Max Decimal Places DINT The currently set number of digits after which a floating point number is truncated. 4.4.32 Reset Document This method resets the JSON object currently created with the SAX writer. Syntax METHOD Reset Document : HRESULT Return value Name Type Reset Document HRESULT Sample call: fb Json. Reset Document(); 4.4.33 Set Max Decimal Places This function specifies the number of decimal places after which a floating-point number is rounded. Syntax METHOD Set Max Decimal Places : HRESULT VAR_INPUT decimal Places: DINT; END_VAR Return value Name Type Set Max Decimal Places HRESULT 114 Version: 1.14.2 TE1000
## Page 115

Function blocks Inputs Name Type Description decimal Pla DINT The number of decimal places to be set after which a floating- ces point number is truncated. 4.4.34 Start Array This method generates the start of a new JSON array ("square opening bracket") and inserts it at the current position of the SAX writer. Syntax METHOD Start Array : HRESULT Return value Name Type Start Array HRESULT Sample call: fb Json. Start Array(); 4.4.35 Start Object This method generates the start of a new JSON object ("curly opening bracket") and inserts it at the current position of the SAX writer. Syntax METHOD Start Object : HRESULT Return value Name Type Start Object HRESULT Sample call: fb Json. Start Object(); 4.5 FB_Json Sax Pretty Writer This function block has a difference from FB_Json Sax Writer [} 97]: it adds matching whitespaces for better readability of a JSON document. TE1000 Version: 1.14.2 115
## Page 116

Function blocks Strings in UTF-8 format The variables of type STRING used here are based on the UTF-8 format. This STRING formatting is common for MQTT communication as well as for JSON documents. In order to be able to receive special characters and texts from a wide range of languages, the character set in the Tc3_Iot Base and Tc3_Json Xml libraries is not limited to the typical character set of the data type STRING. Instead, the Unicode character set in UTF-8 format is used in conjunction with the data type STRING. If the ASCII character set is used, there is no difference between the typical formatting of a STRING and the UTF-8 formatting of a STRING. Further information on the UTF-8 STRING format and available display and conversion options can be found in the documentation for the Tc2_Utilities PLC library. Syntax FUNCTION_BLOCK FB_Json Sax Pretty Writer VAR_OUTPUT init Status : HRESULT; END_VAR Outputs Name Type init Status HRESULT Methods Name Description Set Format Options Adjusts the general formatting options for an instance of the [<=>] FB_Json Sax Pretty Writer. [} 131] Set Indent [} 131] Customizes the indentation. All other methods can be found at FB_Json Sax Writer [} 97]. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4022 x86, x64, ARM Tc3_Json Xml 4.5.1 Add Base64 This method adds a value of the data type Base64 to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Base64 VAR_INPUT p Bytes : Pointer TO BYTE; n Bytes : DINT; END_VAR 116 Version: 1.14.2 TE1000
## Page 117

Function blocks Inputs Name Type p Bytes POINTER TO BYTE n Bytes DINT 4.5.2 Add Bool This method adds a value of the data type BOOL to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Bool VAR_INPUT value : BOOL; END_VAR Inputs Name Type value BOOL Sample call: fb Json. Add Key('b Switch'); fb Json. Add Bool(TRUE); 4.5.3 Add Date Time This method adds a value of the data type DATE_AND_TIME to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Date Time VAR_INPUT value : DATE_AND_TIME; END_VAR Inputs Name Type value DATE_AND_TIME Sample call: fb Json. Add Key('Timestamp'); fb Json. Add Date Time(dt Time); // dt Time is of type DATE_AND_TIME TE1000 Version: 1.14.2 117
## Page 118

Function blocks 4.5.4 Add Dc Time This method adds a value of the data type DCTIME to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Dc Time VAR_INPUT value : DCTIME; END_VAR Inputs Name Type value DCTIME Sample call: fb Json. Add Key('Timestamp'); fb Json. Add Dc Time(dc Time); // dc Time is of type DCTIME 4.5.5 Add Dint This method adds a value of the data type DINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Dint VAR_INPUT value : DINT; END_VAR Inputs Name Type value DINT Sample call: fb Json. Add Key('n Number'); fb Json. Add Dint(42); 4.5.6 Add File Time This method adds a value of the data type FILETIME to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. 118 Version: 1.14.2 TE1000
## Page 119

Function blocks Syntax METHOD Add File Time VAR_INPUT value : FILETIME; END_VAR Inputs Name Type value FILETIME Sample call: fb Json. Add Key('Timestamp'); fb Json. Add File Time(ft Time); // ft Time is of type FILETIME 4.5.7 Add Hex Binary This method adds a hex binary value to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Hex Binary VAR_INPUT p Bytes : POINTER TO BYTE; n Bytes : DINT; END_VAR Inputs Name Type p Bytes POINTER TO BYTE n Bytes DINT Sample call: fb Json. Add Key('Hex Binary'); fb Json. Add Hex Binary(ADR(byte Hex Bin), SIZEOF(byte Hex Bin)); 4.5.8 Add Key This method adds a new property key at the current position of the SAX writer. The value of the new property is usually set afterwards. This can be done using one of the following methods, for example: Add Base64 [} 116], Add Bool [} 117], Add Date Time [} 117], Add Dc Time [} 118], Add Dint [} 118], Add File Time [} 118], Add Hex Binary [} 119], Add Lint [} 124], Add Lreal [} 124], Add Null [} 124], Add Raw Array [} 125], Add Raw Object [} 125], Add Real [} 126], Add String [} 126], Add Udint [} 127], Add Ulint [} 127]. Syntax METHOD Add Key VAR_IN_OUT CONSTANT key : STRING; END_VAR TE1000 Version: 1.14.2 119
## Page 120

Function blocks / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key('Property Name'); 4.5.9 Add Key Bool This method creates a new property key and at the same time a value of the data type BOOL. Syntax METHOD Add Key Bool VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : BOOL; END_VAR Inputs Name Type value BOOL / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Bool('b Switch', TRUE); 4.5.10 Add Key Date Time This method creates a new property key and at the same time a value of the data type DATE_AND_TIME. Syntax METHOD Add Key Date Time VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : DATE_AND_TIME; END_VAR Inputs Name Type value DATE_AND_TIME 120 Version: 1.14.2 TE1000
## Page 121

Function blocks / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Date Time('Timestamp', dt Time); 4.5.11 Add Key Dc Time This method creates a new property key and at the same time a value of the data type DCTIME. Syntax METHOD Add Key Dc Time VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : DCTIME; END_VAR Inputs Name Type value DCTIME / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Dc Time('Timestamp', dc Time); 4.5.12 Add Key File Time This method creates a new property key and at the same time a value of the data type FILETIME. Syntax METHOD Add Key File Time VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : FILETIME; END_VAR TE1000 Version: 1.14.2 121
## Page 122

Function blocks Inputs Name Type value FILETIME / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key File Time('Timestamp', ft Time); 4.5.13 Add Key Lreal This method creates a new property key and at the same time a value of the data type LREAL. Syntax METHOD Add Key Lreal VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : LREAL; END_VAR Inputs Name Type value LREAL / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Lreal('Property Name', 42.42); 4.5.14 Add Key Null This method creates a new property key and initializes its value with null. Syntax METHOD Add Key Null VAR_IN_OUT CONSTANT key : STRING; END_VAR 122 Version: 1.14.2 TE1000
## Page 123

Function blocks / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Null('Property Name'); 4.5.15 Add Key Number This method creates a new property key and at the same time a value of the data type DINT. Syntax METHOD Add Key Number VAR_IN_OUT CONSTANT key : STRING; END_VAR VAR_INPUT value : DINT; END_VAR Inputs Name Type value DINT / Inputs/Outputs Name Type key STRING Sample call: fb Json. Add Key Number('Property Name', 42); 4.5.16 Add Key String This method creates a new property key and at the same time a value of the data type STRING. Syntax METHOD Add Key String VAR_IN_OUT CONSTANT key : STRING; value : STRING; END_VAR / Inputs/Outputs Name Type key STRING value STRING TE1000 Version: 1.14.2 123
## Page 124

Function blocks Sample call: fb Json. Add Key String('Property Name', 'Hello World'); 4.5.17 Add Lint This method adds a value of the data type LINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Lint VAR_INPUT value : LINT; END_VAR Inputs Name Type value LINT Sample call: fb Json. Add Key('Property Name'); fb Json. Add Lint(42); 4.5.18 Add Lreal This method adds a value of the data type LREAL to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Lreal VAR_INPUT value : LREAL; END_VAR Inputs Name Type value LREAL Sample call: fb Json. Add Key('Property Name'); fb Json. Add Lreal(42.42); 4.5.19 Add Null 124 Version: 1.14.2 TE1000
## Page 125

Function blocks This method adds the value null to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Null Sample call: fb Json. Add Key('Property Name'); fb Json. Add Null(); 4.5.20 Add Raw Array This method adds a valid JSON array to a given property as a value. The array to be added must be in a valid JSON format and may only be added if the SAX Writer is at a correspondingly valid position, e.g. directly after a preceding Add Key() [} 119], Start Array() [} 132] or as the first call after a Reset Document() [} 130]. Syntax METHOD Add Raw Array VAR_IN_OUT CONSTANT raw Json : STRING; END_VAR Return value Name Type Add Raw Array BOOL / Inputs/Outputs Name Type raw Json STRING Sample call: fb Json. Add Key('Property Name'); fb Json. Add Raw Array('[1, 2, {"x":42, "y":42}, 4'); 4.5.21 Add Raw Object This method adds a valid JSON object to a given property as a value. The object to be added must be in a valid JSON format and may only be added if the SAX Writer is in an appropriately valid position, e.g. directly after a preceding Add Key() [} 119], Start Array() [} 132] or as the first call after a Reset Document() [} 130]. Syntax METHOD Add Raw Object VAR_IN_OUT CONSTANT raw Json : STRING; END_VAR TE1000 Version: 1.14.2 125
## Page 126

Function blocks / Inputs/Outputs Name Type raw Json STRING Sample call: fb Json. Add Key('Property Name'); fb Json. Add Raw Object('{"x":42, "y":42}'); 4.5.22 Add Real This method adds a value of the data type REAL to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Real VAR_INPUT value : REAL; END_VAR Inputs Name Type value REAL Sample call: fb Json. Add Key('Property Name'); fb Json. Add Real(42.42); 4.5.23 Add String This method adds a value of the data type STRING to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add String VAR_IN_OUT CONSTANT value : STRING; END_VAR / Inputs/Outputs Name Type value STRING Sample call: fb Json. Add Key('Property Name'); fb Json. Add String('Hello World'); 126 Version: 1.14.2 TE1000
## Page 127

Function blocks 4.5.24 Add Udint This method adds a value of the data type UDINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Udint VAR_INPUT value : UDINT; END_VAR Inputs Name Type value UDINT Sample call: fb Json. Add Key('Property Name'); fb Json. Add Udint(42); 4.5.25 Add Ulint This method adds a value of the data type ULINT to a property. Usually, a corresponding property was created beforehand with the method Add Key() [} 119]. Syntax METHOD Add Ulint VAR_INPUT value : ULINT; END_VAR Inputs Name Type value ULINT Sample call: fb Json. Add Key('Property Name'); fb Json. Add Ulint(42); 4.5.26 Copy Document This method copies the content of the current JSON object created with the SAX Writer to a target variable of the data type STRING, which can be of any length. The method returns the length of the string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. TE1000 Version: 1.14.2 127
## Page 128

Function blocks Syntax METHOD Copy Document : UDINT VAR_IN_OUT CONSTANT p Doc : STRING; END_VAR VAR_INPUT n Doc : UDINT; END_VAR VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Copy Document UDINT Inputs Name Type n Doc UDINT / Inputs/Outputs Name Type p Doc STRING Outputs Name Type hr Error Code HRESULT Sample call: fb Json. Copy Document(s Target String, SIZEOF(s Target String)); 4.5.27 End Array This method generates the end of a started JSON array ("square closing bracket") and inserts it at the current position of the SAX writer. Syntax METHOD End Array : HRESULT Return value Name Type End Array HRESULT Sample call: fb Json. End Array(); 128 Version: 1.14.2 TE1000
## Page 129

Function blocks 4.5.28 End Object This method generates the end of a started JSON object ("curly closing bracket") and inserts it at the current position of the SAX writer. Syntax METHOD End Object : HRESULT Return value Name Type End Object HRESULT Sample call: fb Json. End Object(); 4.5.29 Get Document This method returns the content of the JSON object that is currently created with the SAX Writer and returns it as data type STRING(255). The maximum size of the string returned by the method is 255 characters. With longer strings, the method will return a NULL string. In this case the method Copy Document [} 127]() must be used. Syntax METHOD Get Document : STRING(255) VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Get Document STRING(255) Outputs Name Type hr Error Code HRESULT Sample call: s Target String := fb Json. Get Document(); 4.5.30 Get Document Length TE1000 Version: 1.14.2 129
## Page 130

Function blocks This method returns the length of the JSON object that is currently created with the SAX Writer and returns it as data type UDINT. Syntax METHOD Get Document Length : UDINT VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Get Document Length UDINT Outputs Name Type hr Error Code HRESULT Sample call: n Length := fb Json. Get Document Length(); 4.5.31 Get Max Decimal Places This function queries the currently set number of decimal places after which a floating point number is truncated. Syntax METHOD Get Max Decimal Places : DINT Return value Name Type Description Get Max Decimal Places DINT The currently set number of digits after which a floating point number is truncated. 4.5.32 Reset Document This method resets the JSON object currently created with the SAX writer. Syntax METHOD Reset Document : HRESULT Return value Name Type Reset Document HRESULT Sample call: 130 Version: 1.14.2 TE1000
## Page 131

Function blocks fb Json. Reset Document(); 4.5.33 Set Format Options This method is used to customize the general formatting options for an instance of the FB_Json Sax Pretty Writer [} 115]. In addition to the default configuration, there is also the possibility that no line breaks are generated within an array. The array is then output in one line despite the inserted indentations. Syntax METHOD Set Format Options : HRESULT VAR_INPUT options : EJson Pretty Format Options; END_VAR TYPE EJson Pretty Format Options: ( e Format Default :=0, e Format Single Line Array:=1 ) DINT; Return value Name Type Set Format Options HRESULT Inputs Name Type options EJson Pretty Format Options Sample call: fb Json. Set Format Options(EJson Pretty Format Options.e Format Single Line Array); 4.5.34 Set Indent This method is used to customize the indentation. Syntax METHOD Set Indent : HRESULT VAR_INPUT indent Char : SINT; indent Char Count : UDINT; END_VAR Return value Name Type Set Indent HRESULT TE1000 Version: 1.14.2 131
## Page 132

Function blocks Inputs Name Type indent Char SINT indent Char Count UDINT Sample call: fb Json. Set Indent(1,5); 4.5.35 Set Max Decimal Places This function specifies the number of decimal places after which a floating-point number is rounded. Syntax METHOD Set Max Decimal Places : HRESULT VAR_INPUT decimal Places: DINT; END_VAR Return value Name Type Set Max Decimal Places HRESULT Inputs Name Type Description decimal Pla DINT The number of decimal places to be set after which a floating- ces point number is truncated. 4.5.36 Start Array This method generates the start of a new JSON array ("square opening bracket") and inserts it at the current position of the SAX writer. Syntax METHOD Start Array : HRESULT Return value Name Type Start Array HRESULT Sample call: fb Json. Start Array(); 132 Version: 1.14.2 TE1000
## Page 133

Function blocks 4.5.37 Start Object This method generates the start of a new JSON object ("curly opening bracket") and inserts it at the current position of the SAX writer. Syntax METHOD Start Object : HRESULT Return value Name Type Start Object HRESULT Sample call: fb Json. Start Object(); 4.6 FB_Json Read Write Data Type In order to use UTF-8 characters, e.g. in the automatic generation of metadata via the function block FB_Json Read Write Data Type [} 133], the check box for the support of UTF-8 in the symbolism must be activated in the Twin CAT project. To do this, double-click on SYSTEM in the project tree, open the Settings tab and activate the corresponding check box. TE1000 Version: 1.14.2 133
## Page 134

Function blocks Strings in UTF-8 format The variables of type STRING used here are based on the UTF-8 format. This STRING formatting is common for MQTT communication as well as for JSON documents. In order to be able to receive special characters and texts from a wide range of languages, the character set in the Tc3_Iot Base and Tc3_Json Xml libraries is not limited to the typical character set of the data type STRING. Instead, the Unicode character set in UTF-8 format is used in conjunction with the data type STRING. If the ASCII character set is used, there is no difference between the typical formatting of a STRING and the UTF-8 formatting of a STRING. Further information on the UTF-8 STRING format and available display and conversion options can be found in the documentation for the Tc2_Utilities PLC library. Outputs Name Type init Status HRESULT Methods Name Description FB_Json Read Write Data Type Metadata can be added via PLC attributes to the JSON representation of a PLC data structure on an FB_Json Sax Writer object. Add Json Key Value From Symbol [} 136] Creates the JSON representation of a PLC data structure on an FB_Json Sax Writer object. Add Json Value From Symbol [} 137] Creates the JSON representation of a PLC data structure on an FB_Json Sax Writer object. Copy Json String From Symbol [} 138] Creates the JSON representation of a symbol and copies it to a variable of data type STRING. Copy Json String From Symbol Properties Creates a corresponding JSON representation of PLC attributes on a symbol. [} 139] Copy Symbol Name By Address [} 140] Returns the complete (ADS) symbol name of a transferred symbol. Get Data Type Name By Address [} 141] Returns the data type name of a transferred symbol. Get Json From Symbol [} 141] Creates the corresponding JSON representation of a symbol. Get Json String From Symbol [} 142] Creates the corresponding JSON representation of a symbol. Get Json String From Symbol Properties Creates a corresponding JSON representation of PLC attributes on a symbol. [} 143] Get Size Json String From Symbol [} 144] Reads the size of the JSON representation of a symbol. Get Size Json String From Symbol Properti Reads the size of the JSON representation of PLC attributes on a symbol. es [} 145] Get Symbol Name By Address [} 146] Returns the complete (ADS) symbol name of a transferred symbol. Set Symbol From Json [} 146] Extracts a string containing a valid JSON message. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4022 x86, x64, ARM Tc3_Json Xml 134 Version: 1.14.2 TE1000
## Page 135

Function blocks 4.6.1 Add Json Key Properties From Symbol With the aid of this method, metadata can be added via PLC attributes to the JSON representation of a PLC data structure on an FB_Json Sax Writer [} 97] object. The method receives as its input parameters the instance of the FB_Json Sax Writer function block, the desired name of the JSON property that is to contain the metadata, the data type name of the structure and a string variable s Properties, which contains a list of the PLC attributes to be extracted, separated by a cross bar. Syntax METHOD Add Json Value From Symbol : BOOL VAR_IN_OUT fb Writer : FB_Json Sax Writer; END_VAR VAR_IN_OUT CONSTANT s Key : STRING; s Datatype : STRING; s Properties : STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Add Json Value From Symbol BOOL / Inputs/Outputs Name Type fb Writer FB_Json Sax Writer s Key STRING s Datatype STRING s Properties STRING Outputs Name Type hr Error Code HRESULT The PLC attributes can be specified in the following form on the structure elements: {attribute 'Unit' := 'm/s'} {attribute 'Display Name' := 'Speed'} Sensor1 : REAL; A complete sample of how to use this method can be found in section Tc3Json Xml Sample Json Data Type [} 215]. Sample call: fb Json Sax Writer. Reset Document() fb Json Data Type. Add Json Key Properties From Symbol(fb Json Sax Writer, 'Meta Data','ST_Values','Unit| Display Name'); TE1000 Version: 1.14.2 135
## Page 136

Function blocks 4.6.2 Add Json Key Value From Symbol This method generates the JSON representation of a PLC data structure on an FB_Json Sax Writer [} 97] object. The method receives as its input parameters the instance of the FB_Json Sax Writer function block, the data type name of the structure, and the address and size of the source structure instance. As a result, the FB_Json Sax Writer instance contains a valid JSON representation of the structure. Unlike the method Add Json Value From Symbol() [} 137], the elements of the source structure are nested here in a JSON sub- object whose name can be specified via the input/output parameter s Key. Syntax METHOD Add Json Value From Symbol : BOOL VAR_IN_OUT fb Writer : FB_Json Sax Writer; END_VAR VAR_IN_OUT CONSTANT s Key : STRING; s Datatype : STRING; END_VAR VAR_INPUT n Data : UDINT; p Data : PVOID; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Add Json Value From Symbol BOOL Inputs Name Type n Data UDINT p Data PVOID / Inputs/Outputs Name Type fb Writer FB_Json Sax Writer s Key STRING s Datatype STRING Outputs Name Type hr Error Code HRESULT A complete sample of how to use this method can be found in section Tc3Json Xml Sample Json Data Type [} 215]. Sample call: 136 Version: 1.14.2 TE1000
## Page 137

Function blocks fb Json Sax Writer. Reset Document() fb Json Data Type. Add Json Key Value From Symbol(fb Json Sax Writer, 'Values','ST_Values',SIZEOF(st Values), ADR(st Values)); 4.6.3 Add Json Value From Symbol This method generates the JSON representation of a PLC data structure on an FB_Json Sax Writer [} 97] object. The method receives as its input parameters the instance of the FB_Json Sax Writer function block, the data type name of the structure, and the address and size of the source structure instance. As a result, the FB_Json Sax Writer instance contains a valid JSON representation of the structure. Syntax METHOD Add Json Value From Symbol : BOOL VAR_IN_OUT fb Writer : FB_Json Sax Writer; END_VAR VAR_IN_OUT CONSTANT s Datatype : STRING; END_VAR VAR_INPUT n Data : UDINT; p Data : PVOID; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Add Json Value From Symbol BOOL Inputs Name Type n Data UDINT p Data PVOID / Inputs/Outputs Name Type fb Writer FB_Json Sax Writer s Datatype STRING Outputs Name Type hr Error Code HRESULT A complete sample of how to use this method can be found in section Tc3Json Xml Sample Json Data Type [} 215]. Sample call: TE1000 Version: 1.14.2 137
## Page 138

Function blocks fb Json Sax Writer. Reset Document() fb Json Data Type. Add Json Value From Symbol(fb Json Sax Writer,'ST_Values',SIZEOF(st Values), ADR(st Values)); 4.6.4 Copy Json String From Symbol This method generates the JSON representation of a symbol and copies it into a variable of the data type STRING, which can be of any length. The method returns the length of the string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy Json String From Symbol : UDINT VAR_INPUT n Data : UDINT; n Doc : UDINT; p Data : PVOID; END_VAR VAR_IN_OUT CONSTANT p Doc : STRING; s Datatype : STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Copy Json String From Symbol UDINT Inputs Name Type n Data UDINT n Doc UDINT p Data PVOID / Inputs/Outputs Name Type p Doc STRING s Datatype STRING Outputs Name Type hr Error Code HRESULT Sample call: n Len := fb Json Data Type. Copy Json String From Symbol('ST_Test',SIZEOF(st Test),ADR(st Test),s String,SIZEOF(s String) ); 138 Version: 1.14.2 TE1000
## Page 139

Function blocks 4.6.5 Copy Json String From Symbol Properties This method generates a corresponding JSON representation of PLC attributes on a symbol. In contrast to the Add Json Key Properties From Symbol [} 135] method, the result is not written to an instance of the function block FB_Json Sax Writer, but to a string variable. The method receives as its input parameters the data type name of the symbol and a string variable that represents a list of the PLC attributes to be extracted, separated by a cross bar. The method copies this JSON representation into a variable of the data type STRING, which can be of any length. The method returns the length of the string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy Json String From Symbol Properties : UDINT VAR_INPUT n Doc : UDINT; END_VAR VAR_IN_OUT CONSTANT p Doc : STRING; s Datatype : STRING; s Properties : STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Copy Json String From Symbol Properties UDINT Inputs Name Type n Doc UDINT / Inputs/Outputs Name Type p Doc STRING s Datatype STRING s Properties STRING Outputs Name Type hr Error Code HRESULT Sample call: n Len := fb Json Data Type. Copy Json String From Symbol Properties('ST_Test','Unit| Display Name',s String,SIZEOF(s String)); TE1000 Version: 1.14.2 139
## Page 140

Function blocks 4.6.6 Copy Symbol Name By Address This method returns the complete (ADS) symbol name of a transferred symbol. The method returns the size of the string (including null termination). If the destination buffer is too small, it is emptied by a null termination and returned as length 0. Syntax METHOD Copy Symbol Name By Address : UDINT VAR_INPUT n Data : UDINT; // size of symbol p Data : PVOID; // address of symbol END_VAR VAR_IN_OUT CONSTANT s Name : STRING; // target string buffer where the symbol name should be copied to END_VAR VAR_INPUT n Name : UDINT; // size in bytes of target string buffer END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Copy Symbol Name By Address UDINT Inputs Name Type n Data UDINT p Data PVOID n Name UDINT / Inputs/Outputs Name Type s Name STRING Outputs Name Type hr Error Code HRESULT Sample call: n Symbol Size := fb Json Data Type. Copy Symbol Name By Address(n Data:=SIZEOF(st Values), p Data:=ADR(st Values), s Name:=s Symbol Name, n Name:=SIZEOF(s Symbol Name)); Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4024.20 x86, x64, ARM Tc3_Json Xml 3.3.15.0 140 Version: 1.14.2 TE1000
## Page 141

Function blocks 4.6.7 Get Data Type Name By Address This method returns the data type name of a transferred symbol. Structures with a single variable If structures with a single variable are used, the data type cannot be read correctly using this method. The size and address information cannot be used to distinguish between the structure itself and the individual variables. Syntax METHOD Get Data Type Name By Address : STRING VAR_INPUT n Data : UDINT; p Data : PVOID; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Data Type Name By Address STRING Inputs Name Type n Data UDINT p Data PVOID Outputs Name Type hr Error Code HRESULT Sample call: s Buffer := fb Json Data Type. Get Data Type Name By Address(SIZEOF(st Values),ADR(st Values)); 4.6.8 Get Json From Symbol This method generates the corresponding JSON representation of a symbol. In contrast to the Add Json Value From Symbol() [} 137] method, the result is not written to an instance of the function block FB_Json Sax Writer, but to a string variable. The method receives as its input parameters the data type name of the symbol as well as the address and size of the source symbol, e.g. of a structure instance. The address and size of the destination buffer that contains the JSON representation of the symbol after the call are transferred as further input parameters. TE1000 Version: 1.14.2 141
## Page 142

Function blocks Syntax METHOD Get Json From Symbol : BOOL VAR_IN_OUT CONSTANT s Datatype : STRING; END_VAR VAR_INPUT n Data : UDINT; p Data : PVOID; n Json : REFERENCE TO UDINT; p Json : POINTER TO STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Json From Symbol BOOL Inputs Name Type n Data UDINT p Data PVOID n Json REFERENCE TO UDINT p Json POINTER TO STRING / Inputs/Outputs Name Type s Datatype STRING Outputs Name Type hr Error Code HRESULT Input parameter n Json The input parameter n Json contains the size of the destination buffer when the method is called, and the size of the actually written JSON object in the destination buffer when the method call is completed. Sample call: fb Json Data Type. Get Json From Symbol('ST_Values',SIZEOF(st Values), ADR(st Values), n Buffer Length, ADR(s Buffer)); 4.6.9 Get Json String From Symbol This method generates the corresponding JSON representation of a symbol. In contrast to the Add Json Value From Symbol() [} 137] method, the result is not written to an instance of the function block FB_Json Sax Writer, but to a string variable. The method receives as its input parameters the data type name of the symbol as well as the address and size of the source symbol of a structure instance, for example. 142 Version: 1.14.2 TE1000
## Page 143

Function blocks The maximum size of the string returned by the method is 255 characters. With longer strings, the method will return a NULL string. In this case the method Copy Json String From Symbol [} 138]() must be used. Syntax METHOD Get Json String From Symbol : STRING(255) VAR_IN_OUT CONSTANT s Datatype : STRING; END_VAR VAR_INPUT n Data : UDINT; p Data : PVOID; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Json String From Symbol STRING(255) Inputs Name Type n Data UDINT p Data PVOID / Inputs/Outputs Name Type s Datatype STRING Outputs Name Type hr Error Code HRESULT Sample call: s Buffer := fb Json Data Type. Get Json String From Symbol('ST_Values',SIZEOF(st Values), ADR(st Values)); 4.6.10 Get Json String From Symbol Properties This method generates a corresponding JSON representation of PLC attributes on a symbol. In contrast to the Add Json Key Properties From Symbol [} 135] method, the result is not written to an instance of the function block FB_Json Sax Writer, but to a string variable. The method receives as its input parameters the data type name of the symbol and a string variable that represents a list of the PLC attributes to be extracted, separated by a cross bar. The result is returned directly as the return value of the method. The maximum size of the string returned by the method is 255 characters. With longer strings, the method will return a NULL string. In this case the method Copy Json String From Symbol Properties [} 139]() must be used. TE1000 Version: 1.14.2 143
## Page 144

Function blocks Syntax METHOD Get Json String From Symbol Properties : STRING(255) VAR_IN_OUT CONSTANT s Datatype : STRING; s Properties : STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Json String From Symbol Properties STRING(255) / Inputs/Outputs Name Type s Datatype STRING s Properties STRING Outputs Name Type hr Error Code HRESULT Sample call: s Buffer := fb Json Data Type. Get Json String From Symbol Properties('ST_Values', 'Unit|Display Name'); 4.6.11 Get Size Json String From Symbol This method reads the size of the JSON representation of a symbol. The value is specified with null termination. Syntax METHOD Get Size Json String From Symbol : UDINT VAR_INPUT n Data :UDINT; p Data :PVOID; END_VAR VAR_IN_OUT CONSTANT s Datatype : STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Size Json String From Symbol UDINT 144 Version: 1.14.2 TE1000
## Page 145

Function blocks Inputs Name Type n Data UDINT p Data PVOID / Inputs/Outputs Name Type s Datatype STRING Outputs Name Type hr Error Code HRESULT Sample call: n Len := fb Json Data Type. Get Size Json String From Symbol('BOOL',SIZEOF(b Bool),ADR(b Bool)); 4.6.12 Get Size Json String From Symbol Properties This method reads the size of the JSON representation of PLC attributes on a symbol. The value is specified with null termination. Syntax METHOD Get Size Json String From Symbol Properties : UDINT VAR_IN_OUT CONSTANT s Datatype : STRING; s Properties : STRING; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Size Json String From Symbol Properties UDINT / Inputs/Outputs Name Type s Datatype STRING s Properties STRING Outputs Name Type hr Error Code HRESULT Sample call: n Len := fb Json Data Type. Get Size Json String From Symbol Properties('ST_Test','Display Name|Unit'); TE1000 Version: 1.14.2 145
## Page 146

Function blocks 4.6.13 Get Symbol Name By Address This method returns the complete (ADS) symbol name of a transferred symbol. The maximum size of the string returned by the method is 255 characters. With longer strings, the method will return a null string. In this case the method Copy Symbol Name By Address() [} 140] must be used. Syntax METHOD Get Symbol Name By Address : STRING(255) VAR_INPUT n Data : UDINT; p Data : PVOID; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Get Symbol Name By Address STRING(255) Inputs Name Type n Data UDINT p Data PVOID Outputs Name Type hr Error Code HRESULT Sample call: s Buffer := fb Json Data Type. Get Symbol Name By Address(SIZEOF(st Values), ADR(st Values)); 4.6.14 Set Symbol From Json This method extracts a string containing a valid JSON message and attempts to save the contents of the JSON object to an equivalent data structure. The method receives as its input parameters the string with the JSON object, the data type name of the target structure, and the address and size of the target structure instance. Syntax METHOD Set Symbol From Json : BOOL VAR_IN_OUT CONSTANT s Json : STRING; s Datatype : STRING; END_VAR VAR_INPUT n Data : UDINT; 146 Version: 1.14.2 TE1000
## Page 147

Function blocks p Data : PVOID; END_VAR VAR_OUTPUT hr Error Code : HRESULT; END_VAR Return value Name Type Set Symbol From Json BOOL Inputs Name Type n Data UDINT p Data PVOID / Inputs/Outputs Name Type s Json STRING s Datatype STRING Outputs Name Type hr Error Code HRESULT Sample call: fb Json Data Type. Set Symbol From Json(s Json,'ST_Values',SIZEOF(st Values Receive), ADR(st Values Receive)); 4.7 FB_Xml Dom Parser Strings in UTF-8 format The variables of type STRING used here are based on the UTF-8 format. This STRING formatting is common for MQTT communication as well as for JSON documents. In order to be able to receive special characters and texts from a wide range of languages, the character set in the Tc3_Iot Base and Tc3_Json Xml libraries is not limited to the typical character set of the data type STRING. Instead, the Unicode character set in UTF-8 format is used in conjunction with the data type STRING. If the ASCII character set is used, there is no difference between the typical formatting of a STRING and the UTF-8 formatting of a STRING. Further information on the UTF-8 STRING format and available display and conversion options can be found in the documentation for the Tc2_Utilities PLC library. Outputs Name Type init Status HRESULT TE1000 Version: 1.14.2 147
## Page 148

Function blocks Methods 148 Version: 1.14.2 TE1000
## Page 149

Function blocks Name Description Append Attribute [} 151] Appends a new attribute to an existing node. Append Attribute As Bool [} 152] Appends a new attribute to an existing node (Boolean). Append Attribute As Double Appends a new attribute to an existing node (Double). [} 153] Append Attribute As Float [} 153] Appends a new attribute to an existing node (Float). Append Attribute As Int [} 154] Appends a new attribute to an existing node (Integer). Append Attribute As Lint [} 155] Appends a new attribute to an existing node (Integer64). Append Attribute As Uint [} 156] Appends a new attribute to an existing node (Unsigned Integer). Append Attribute As Ulint [} 156] Appends a new attribute to an existing node (Unsigned Integer64). Append Attribute Copy [} 157] Appends a new attribute to an existing node. Append Child [} 158] Appends a new node below an existing node. Append Child As Bool [} 158] Appends a new node below an existing node (Boolean). Append Child As Double [} 159] Appends a new node below an existing node (Double). Append Child As Float [} 160] Appends a new node below an existing node (Float). Append Child As Int [} 161] Appends a new node below an existing node (Integer). Append Child As Lint [} 161] Appends a new node below an existing node (Integer64). Append Child As Uint [} 162] Appends a new node below an existing node (Unsigned Integer). Append Child As Ulint [} 163] Appends a new node below an existing node (Unsigned Integer64). Append Copy [} 163] Appends a new node below an existing node. Append Node [} 164] Appends a new node below an existing node. Attributes [} 165] Reads the attribute of a given XML node. Attribute As Bool [} 165] Returns the value of an attribute as data type Boolean. Attribute As Double [} 166] Returns the value of an attribute as data type Double. Attribute As Float [} 166] Returns the value of an attribute as data type Float. Attribute As Int [} 167] Returns the value of an attribute as data type Integer. Attribute As Lint [} 167] Returns the value of an attribute as data type Integer64. Attribute As Uint [} 168] Returns the value of an attribute as data type Unsigned Integer. Attribute As Ulint [} 168] Returns the value of an attribute as data type Unsigned Integer64. Attribute Begin [} 169] Returns an iterator over all attributes of an XML node. Attribute From Iterator [} 169] Converts the current position of an iterator to an XML attribute object. Attribute Name [} 170] Returns the name of a given attribute. Attributes [} 171] Used to navigate the DOM and returns an iterator for all attributes found at an XML node. Attribute Text [} 171] Returns the text of a given attribute. Begin [} 172] Returns an iterator over all child elements of an XML node. Begin By Name [} 172] Returns an iterator over all child elements of an XML node, starting at a particular element. Child [} 173] Used to navigate through the DOM. It returns a reference to the (first) child element of the current node. Child By Attribute [} 173] Used to navigate through the DOM. It returns a reference to a child element in the XML document. Child By Attribute And Name Used to navigate through the DOM. It returns a reference to a child element in the XML document. [} 174] Child By Name [} 175] Used to navigate through the DOM. It returns a reference to a child element in the XML document. TE1000 Version: 1.14.2 149
## Page 150

Function blocks Name Description Children [} 176] Used to navigate through the DOM. It returns an iterator for several child elements found in the XML document. Children By Name [} 176] Used to navigate through the DOM. It returns an iterator for several child elements found in the XML document. Clear Iterator [} 177] This method resets iterators that have already been used so that they can be used again the next time the program is run. Compare [} 178] Checks two iterators for equality. Copy Attribute Text [} 178] Reads the value of an XML attribute and writes it to a variable of data type String. Copy Document [} 179] Copies the contents of the DOM memory into a variable of data type String. Copy Node Text [} 180] Reads the value of an XML node and writes it to a variable of data type String. Copy Node Xml [} 180] Reads the XML structure of an XML node and writes it to a variable of data type String. End First Node By Path [} 181] Navigates through an XML document using a path that was transferred to the method. Get Attribute Text Length [} 182] Returns the length of the value of an XML attribute. Get Document Length [} 182] Returns the length of an XML document in bytes. Get Document Node [} 182] Returns the root node of an XML document. Get Node Text Length [} 183] Returns the length of the value of an XML node. Get Node Xml Length [} 183] Returns the length of the XML structure of an XML node. Get Root Node [} 184] Returns a reference to the first XML node in the XML document. Insert Attribute Copy [} 184] Inserts an attribute to an XML node, copying the name and value of an existing attribute. Insert Attribute [} 185] Inserts an attribute to an XML node. Insert Child [} 185] Inserts a node to an existing XML node. Insert Copy [} 186] Inserts a new node to an existing XML node and copies an existing node. Is End [} 187] Checks whether a given XML iterator is at the end of the iteration that is to be performed. Load Document From File [} 187] Loads a XML document from a file. New Document [} 188] Generates a new empty XML document in the DOM memory. Next [} 189] Sets an XML iterator for the next object that is to be processed. Next Attribute [} 189] Returns the next attribute for a given XML attribute. Next By Name [} 190] Sets an XML iterator for the next object that is to be processed, which is identified by its name. Next Sibling [} 190] Returns the next direct node for a given XML node at the same XML level. Next Sibling By Name [} 191] Returns the next direct node for a given XML node with a particular name at the same XML level. Node [} 192] Used in conjunction with an iterator to navigate through the DOM. Node As Bool [} 192] Returns the text of an XML node as data type Boolean. Node As Double [} 193] Returns the text of an XML node as data type Double. Node As Float [} 193] Returns the text of an XML node as data type Float. Node As Int [} 194] Returns the text of an XML node as data type Integer. Node As Lint [} 194] Returns the text of an XML node as data type Integer64. Node As Uint [} 195] Returns the text of an XML node as data type Unsigned Integer. Node As Ulint [} 195] Returns the text of an XML node as data type Unsigned Integer64. 150 Version: 1.14.2 TE1000
## Page 151

Function blocks Name Description Node Name [} 196] Returns the name of an XML node. Node Text [} 196] Returns the text of an XML node. Parse Document [} 197] Loads an XML object into the DOM memory for further processing. Remove Attribute Remove Attribute By Name Remove Child [} 197] Removes an XML child node from a given XML node. Remove Child By Name [} 198] Removes an XML child node from a given XML node. Save Document To File [} 198] Saves the current XML document in a file. Set Attribute [} 199] Sets the value of an attribute. Set Attribute As Bool [} 200] Sets the value of an attribute (Boolean). Set Attribute As Double [} 201] Sets the value of an attribute (double). Set Attribute As Float [} 201] Sets the value of an attribute (float). Set Attribute As Int [} 202] Sets the value of an attribute (integer). Set Attribute As Lint [} 202] Sets the value of an attribute (Integer64). Set Attribute As Uint [} 203] Sets the value of an attribute (Unsigned Integer). Set Attribute As Ulint [} 203] Sets the value of an attribute (Unsigned Integer64). Set Child [} 204] Sets the value of an XML node (String). Set Child As Bool [} 204] Sets the value of an XML node (Boolean). Set Child As Double [} 205] Sets the value of an XML node (Double). Set Child As Float [} 205] Sets the value of an XML node (Float). Set Child As Int [} 206] Sets the value of an XML node (Integer). Set Child As Lint [} 207] Sets the value of an XML node (Integer64). Set Child As Uint [} 207] Sets the value of an XML node (Unsigned Integer). Set Child As Ulint [} 208] Sets the value of an XML node (Unsigned Integer64). Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4022 x86, x64, ARM Tc3_Json Xml 4.7.1 Append Attribute This method adds a new attribute to an existing node. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; value : STRING; END_VAR TE1000 Version: 1.14.2 151
## Page 152

Function blocks Return value Name Type Append Attribute SXml Attribute Inputs Name Type n SXml Node / Inputs/Outputs Name Type name STRING value STRING Sample call: obj Attribute := fb Xml. Append Attribute(obj Machine, 'Name', 'some value'); 4.7.2 Append Attribute As Bool This method adds a new attribute to an existing node. The value of the attribute has the data type Boolean. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute As Bool : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : BOOL; END_VAR Return value Name Type Append Attribute As Bool SXml Attribute Inputs Name Type n SXml Node value BOOL 152 Version: 1.14.2 TE1000
## Page 153

Function blocks / Inputs/Outputs Name Type name STRING Sample call: obj Attribute := fb Xml. Append Attribute As Bool(obj Machine, 'Name', TRUE); 4.7.3 Append Attribute As Double This method adds a new attribute to an existing node. The value of the attribute has the data type Double. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute As Double : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : LREAL; END_VAR Return value Name Type Append Attribute As Double SXml Attribute Inputs Name Type n SXml Node value LREAL / Inputs/Outputs Name Type name STRING Sample call: obj Attribute := fb Xml. Append Attribute As Double(obj Machine, 'Name', 42.42); 4.7.4 Append Attribute As Float TE1000 Version: 1.14.2 153
## Page 154

Function blocks This method adds a new attribute to an existing node. The value of the attribute has the data type Float. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute As Float : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : REAL; END_VAR Return value Name Type Append Attribute As Float SXml Attribute Inputs Name Type n SXml Node value REAL / Inputs/Outputs Name Type name STRING Sample call: obj Attribute := fb Xml. Append Attribute As Float(obj Machine, 'Name', 42.42); 4.7.5 Append Attribute As Int This method adds a new attribute to an existing node. The value of the attribute has the data type Integer. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute As Int : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : DINT; END_VAR 154 Version: 1.14.2 TE1000
## Page 155

Function blocks Return value Name Type Append Attribute As Int SXml Attribute Inputs Name Type n SXml Node value DINT / Inputs/Outputs Name Type name STRING Sample call: obj Attribute := fb Xml. Append Attribute As Int(obj Machine, 'Name', 42); 4.7.6 Append Attribute As Lint This method adds a new attribute to an existing node. The value of the attribute has the data type Integer64. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute As Lint : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : LINT; END_VAR Return value Name Type Append Attribute As Lint SXml Attribute Inputs Name Type n SXml Node value LINT / Inputs/Outputs Name Type name STRING TE1000 Version: 1.14.2 155
## Page 156

Function blocks Sample call: obj Attribute := fb Xml. Append Attribute As Lint(obj Machine, 'Name', 42); 4.7.7 Append Attribute As Uint This method adds a new attribute to an existing node. The value of the attribute has the data type Unsigned Integer. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Append Attribute As Uint : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : UDINT; END_VAR Return value Name Type Append Attribute As Uint SXml Attribute Inputs Name Type n SXml Node value UDINT / Inputs/Outputs Name Type name STRING Sample call: obj Attribute := fb Xml. Append Attribute As Uint(obj Machine, 'Name', 42); 4.7.8 Append Attribute As Ulint This method adds a new attribute to an existing node. The value of the attribute has the data type Unsigned Integer64. The name and value of the new attribute and the existing XML node are transferred to the method as input parameters. The method returns a reference to the newly added attribute. 156 Version: 1.14.2 TE1000
## Page 157

Function blocks Syntax METHOD Append Attribute As Ulint : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : ULINT; END_VAR Return value Name Type Append Attribute As Ulint SXml Attribute Inputs Name Type n SXml Node value ULINT / Inputs/Outputs Name Type name STRING Sample call: obj Attribute := fb Xml. Append Attribute As Ulint(obj Machine, 'Name', 42); 4.7.9 Append Attribute Copy This method adds a new attribute to an existing node. The name and value of the new attribute are copied from an existing attribute. The existing attribute is transferred to the method as input parameter. Syntax METHOD Append Attribute Copy : SXml Attribute INPUT_VAR n : SXml Node; copy : SXml Attribute; END_VAR Return value Name Type Append Attribute Copy SXml Attribute Inputs Name Type n SXml Node copy SXml Attribute Sample call: TE1000 Version: 1.14.2 157
## Page 158

Function blocks xml New Attribute := fb Xml. Append Attribute Copy(xml Node, xml Existing Attribute); 4.7.10 Append Child This method inserts a new node below an existing node. The value of the new node is of the data type STRING. The name and the value of the new node as well as a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. The input parameter cdata indicates whether the value of the node is to be encapsulated in a CDATA function block, so that certain special characters such as "<" and ">" are allowed as values. Syntax METHOD Append Child : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; value : STRING; END_VAR VAR_INPUT cdata : BOOL; END_VAR Return value Name Type Append Child SXml Node Inputs Name Type n SXml Node cdata BOOL / Inputs/Outputs Name Type name STRING value STRING Sample call: xml New Node := fb Xml. Append Child(xml Existing, 'Controller', 'CX5120', FALSE); 4.7.11 Append Child As Bool This method inserts a new node below an existing node. The value of the new node has the data type Boolean. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. 158 Version: 1.14.2 TE1000
## Page 159

Function blocks Syntax METHOD Append Child As Bool : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : BOOL; END_VAR Return value Name Type Append Child As Bool SXml Node Inputs Name Type n SXml Node value BOOL / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Bool(xml Existing, 'Some Name', TRUE); 4.7.12 Append Child As Double This method inserts a new node below an existing node. The value of the new node has the data type Double. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Child As Double : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : LREAL; END_VAR Return value Name Type Append Child As Double SXml Node TE1000 Version: 1.14.2 159
## Page 160

Function blocks Inputs Name Type n SXml Node value LREAL / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Double(xml Existing, 'Some Name', 42.42); 4.7.13 Append Child As Float This method inserts a new node below an existing node. The value of the new node has the data type Float. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Child As Float : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : REAL; END_VAR Return value Name Type Append Child As Float SXml Node Inputs Name Type n SXml Node value REAL / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Float(xml Existing, 'Some Name', 42.42); 160 Version: 1.14.2 TE1000
## Page 161

Function blocks 4.7.14 Append Child As Int This method inserts a new node below an existing node. The value of the new node has the data type Integer. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Child As Int : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : DINT; END_VAR Return value Name Type Append Child As Int SXml Node Inputs Name Type n SXml Node value DINT / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Int(xml Existing, 'Some Name', 42); 4.7.15 Append Child As Lint This method inserts a new node below an existing node. The value of the new node has the data type Integer64. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Child As Lint : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR TE1000 Version: 1.14.2 161
## Page 162

Function blocks VAR_INPUT value : LINT; END_VAR Return value Name Type Append Child As Lint SXml Node Inputs Name Type n SXml Node value LINT / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Lint(xml Existing, 'Some Name', 42); 4.7.16 Append Child As Uint This method inserts a new node below an existing node. The value of the new node has the data type Unsigned Integer. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Child As Uint : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : UDINT; END_VAR Return value Name Type Append Child As Uint SXml Node Inputs Name Type n SXml Node value UDINT 162 Version: 1.14.2 TE1000
## Page 163

Function blocks / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Uint(xml Existing, 'Some Name', 42); 4.7.17 Append Child As Ulint This method inserts a new node below an existing node. The value of the new node has the data type Unsigned Integer64. The name and value of the new node and a reference to the existing node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Child As Ulint : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR VAR_INPUT value : ULINT; END_VAR Return value Name Type Append Child As Ulint SXml Node Inputs Name Type n SXml Node value ULINT / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Append Child As Ulint(xml Existing, 'Some Name', 42); 4.7.18 Append Copy TE1000 Version: 1.14.2 163
## Page 164

Function blocks This method inserts a new node below an existing node. The name and value of the new node are copied from an existing node. The references to the existing nodes are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Copy : SXml Node VAR_INPUT n : SXml Node; copy : SXml Node; END_VAR Return value Name Type Append Copy SXml Node Inputs Name Type n SXml Node copy SXml Node Sample call: xml New Node := fb Xml. Append Copy(xml Parent Node, xml Existing Node); 4.7.19 Append Node This method adds a new node to an existing node. The existing node and the name of the new node are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Append Node : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Append Node SXml Node Inputs Name Type n SXml Node 164 Version: 1.14.2 TE1000
## Page 165

Function blocks / Inputs/Outputs Name Type name STRING Sample call: obj Machines := fb Xml. Append Node(obj Root, 'Machines'); 4.7.20 Attributes This method can be used to read the attribute of a given XML node. The XML node and the name of the attribute are transferred to the method as input parameters. After the method has been called, further methods have to be called, for example to read the value of the attribute, e.g. Attribute As Int(). Syntax METHOD Attribute : SXml Attribute VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Attributes SXml Attribute Inputs Name Type n SXml Node / Inputs/Outputs Name Type name STRING Sample call: xml Machine1Attribute := fb Xml. Attribute(xml Machine1, 'Type'); 4.7.21 Attribute As Bool This method returns the value of an attribute as data type Boolean. The attribute is transferred to the method as input parameter. TE1000 Version: 1.14.2 165
## Page 166

Function blocks Syntax METHOD Attribute As Bool : BOOL VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Bool BOOL Inputs Name Type a SXml Attribute Sample call: b Value := fb Xml. Attribute As Bool(xml Attr); 4.7.22 Attribute As Double This method returns the value of an attribute as data type Double. The attribute is transferred to the method as input parameter. Syntax METHOD Attribute As Double : LREAL VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Double LREAL Inputs Name Type a SXml Attribute Sample call: lr Value := fb Xml. Attribute As Double(xml Attr); 4.7.23 Attribute As Float This method returns the value of an attribute as data type Float. The attribute is transferred to the method as input parameter. 166 Version: 1.14.2 TE1000
## Page 167

Function blocks Syntax METHOD Attribute As Float: REAL VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Float REAL Inputs Name Type a SXml Attribute Sample call: r Value := fb Xml. Attribute As Float(xml Attr); 4.7.24 Attribute As Int This method returns the value of an attribute as a data type Integer. The attribute is transferred to the method as input parameter. Syntax METHOD Attribute As Int : DINT VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Int DINT Inputs Name Type a SXml Attribute Sample call: n Value := fb Xml. Attribute As Int(xml Attr); 4.7.25 Attribute As Lint This method returns the value of an attribute as a data type Integer64. The attribute is transferred to the method as input parameter. TE1000 Version: 1.14.2 167
## Page 168

Function blocks Syntax METHOD Attribute As Lint : LINT VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Lint LINT Inputs Name Type a SXml Attribute Sample call: n Value := fb Xml. Attribute As Lint(xml Attr); 4.7.26 Attribute As Uint This method returns the value of an attribute as data type Unsigned Integer. The attribute is transferred to the method as input parameter. Syntax METHOD Attribute As Uint : UDINT VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Uint UDINT Inputs Name Type a SXml Attribute Sample call: n Value := fb Xml. Attribute As Uint(xml Attr); 4.7.27 Attribute As Ulint This method returns the value of an attribute as data type Unsigned Integer64. The attribute is transferred to the method as input parameter. 168 Version: 1.14.2 TE1000
## Page 169

Function blocks Syntax METHOD Attribute As Ulint : ULINT VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute As Ulint ULINT Inputs Name Type a SXml Attribute Sample call: n Value := fb Xml. Attribute As Ulint(xml Attr); 4.7.28 Attribute Begin This method returns an iterator over all attributes of an XML node. The XML node is transferred to the method as input parameter. Syntax METHOD Attribute Begin : SXml Iterator VAR_INPUT n : SXml Node; END_VAR Return value Name Type Attribute Begin SXml Iterator Inputs Name Type n SXml Node Sample call: xml Iterator := fb Xml. Attribute Begin(xml Node); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Attr := fb Xml. Attribute From Iterator(xml Iterator); n Attr Value := fb Xml. Attribute As Int(xml Attr); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.29 Attribute From Iterator TE1000 Version: 1.14.2 169
## Page 170

Function blocks This method converts the current position of an iterator to an XML attribute object. The iterator is transferred to the method as input parameter. Syntax METHOD Attribute From Iterator : SXml Attribute VAR_INPUT it : SXml Iterator; END_VAR Return value Name Type Attribute From Iterator SXml Attribute Inputs Name Type it SXml Iterator Sample call: xml Iterator := fb Xml. Attribute Begin(xml Node); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Attr := fb Xml. Attribute From Iterator(xml Iterator); n Attr Value := fb Xml. Attribute As Int(xml Attr); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.30 Attribute Name This method returns the name of a given attribute. The attribute is transferred to the method as input parameter. Syntax METHOD Attribute Name : STRING VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute Name STRING Inputs Name Type a SXml Attribute Sample call: s Name := fb Xml. Attribute Name(xml Attr); 170 Version: 1.14.2 TE1000
## Page 171

Function blocks 4.7.31 Attributes This method is used to navigate through the DOM and returns an iterator for all attributes found at an XML node. The iterator can then be used for further navigation through the elements that were found. The node and a reference to the iterator are transferred to the method as input parameters. Syntax METHOD Attributes : SXml Attribute VAR_INPUT n : SXml Node; it : REFERENCE TO SXml Iterator; END_VAR Return value Name Type Attributes SXml Attribute Inputs Name Type it REFERENCE TO SXml Iterator Sample call: xml Ret := fb Xml. Attributes(xml Node, xml Iterator); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Attr Ref := fb Xml. Attribute(xml Iterator); xml Machine Attr Text := fb Xml. Attribute Text(xml Machine Attr Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.32 Attribute Text This method returns the text of a given attribute. The attribute is transferred to the method as input parameter. Syntax METHOD Attribute Text : STRING(255) VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Attribute Text STRING(255) Inputs Name Type a SXml Attribute TE1000 Version: 1.14.2 171
## Page 172

Function blocks Sample call: s Text := fb Xml. Attribute Text(xml Attr); 4.7.33 Begin This method returns an iterator over all child elements of an XML node, always starting from the first child element. The XML node is transferred to the method as input parameter. Syntax METHOD Begin : SXml Iterator VAR_INPUT n : SXml Node; END_VAR Return value Name Type Begin SXml Iterator Inputs Name Type n SXml Node Sample call: xml Iterator := fb Xml. Begin(xml Node); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Node Ref := fb Xml. Node(xml Iterator); xml Node Value := fb Xml. Node Text(xml Node Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.34 Begin By Name This method returns an iterator over all child elements of an XML node, starting at a particular element. The XML node is transferred to the method as input parameter. Syntax METHOD Begin By Name : SXml Iterator VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Begin By Name SXml Iterator 172 Version: 1.14.2 TE1000
## Page 173

Function blocks Inputs Name Type n SXml Node / Inputs/Outputs Name Type name STRING Sample call: xml Node := fb Xml. Child By Name(xml Doc, 'Machines'); xml Iterator := fb Xml. Begin By Name(xml Node, 'Name X'); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Node Ref := fb Xml. Node(xml Iterator); xml Node Value := fb Xml. Node Text(xml Node Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.35 Child This method is used to navigate through the DOM. It returns a reference to the (first) child element of the current node. The start node is transferred to the method as input parameter. Syntax METHOD Child By Name : SXml Node VAR_INPUT n : SXml Node; END_VAR Return value Name Type Inputs Name Type n SXml Node Sample call: xml Child := fb Xml. Child(xml Node); 4.7.36 Child By Attribute This method is used to navigate through the DOM. It returns a reference to a child element in the XML document. The start node and the name and value of the attribute are transferred to the method as input parameters. TE1000 Version: 1.14.2 173
## Page 174

Function blocks Syntax METHOD Child By Attribute : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT attr : STRING; value : STRING; END_VAR Return value Name Type Child By Attribute SXml Node Inputs Name Type n SXml Node / Inputs/Outputs Name Type attr STRING value STRING Sample call: xml Machine1 := fb Xml. Child By Attribute(xml Machines, 'Type', '1'); 4.7.37 Child By Attribute And Name This method is used to navigate through the DOM. It returns a reference to a child element in the XML document. The start node, the name and value of the attribute, and the name of the child element are transferred to the method as input parameters. Syntax METHOD Child By Attribute And Name : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT attr : STRING; value : STRING; child : STRING; END_VAR Return value Name Type Child By Attribute And Name SXml Node 174 Version: 1.14.2 TE1000
## Page 175

Function blocks Inputs Name Type n SXml Node / Inputs/Outputs Name Type attr STRING value STRING child STRING Sample call: xml Machine2 := fb Xml. Child By Attribute And Name(xml Machines, 'Type', '2', 'Machine'); 4.7.38 Child By Name This method is used to navigate through the DOM. It returns a reference to a child element in the XML document. The start node and the name of the element to be returned are transferred to the method as input parameters. Syntax METHOD Child By Name : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Child By Name SXml Node Inputs Name Type n SXml Node / Inputs/Outputs Name Type name STRING Sample call: xml Machines := fb Xml. Child By Name(xml Doc, 'Machines'); TE1000 Version: 1.14.2 175
## Page 176

Function blocks 4.7.39 Children This method is used to navigate through the DOM. It returns an iterator for several child elements found in the XML document. The iterator can then be used for further navigation through the elements that were found. The start node and a reference to the iterator are transferred to the method as input parameters. Syntax METHOD Children : SXml Node VAR_INPUT n : SXml Node; it : REFERENCE TO SXml Iterator; END_VAR Return value Name Type Children SXml Node Inputs Name Type n SXml Node Sample call: xml Ret := fb Xml. Children(xml Node, xml Iterator); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Node Ref := fb Xml. Node(xml Iterator); xml Machine Node Text := fb Xml. Node Text(xml Machine Node Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.40 Children By Name This method is used to navigate through the DOM. It returns an iterator for several child elements found in the XML document. The iterator can then be used for further navigation through the elements that were found. The start node, the name of the child elements to be found and a reference to the iterator are transferred to the method as input parameters. Syntax METHOD Children By Name : SXml Node VAR_INPUT n : SXml Node; it : REFERENCE TO SXml Iterator; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Children By Name SXml Node 176 Version: 1.14.2 TE1000
## Page 177

Function blocks Inputs Name Type n SXml Node it REFERENCE TO SXml Iterator / Inputs/Outputs Name Type name STRING Sample call: xml Machine Node := fb Xml. Children By Name(xml Machines, xml Iterator, 'Machine'); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Node Ref := fb Xml. Node(xml Iterator); xml Machine Node Text := fb Xml. Node Text(xml Machine Node Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.41 Clear Iterator This method resets iterators that have already been used so that they can be used again the next time the program is run. Syntax METHOD Clear Iterator : BOOL VAR_INPUT it : SXml Iterator; END_VAR Return value Name Type Clear Iterator BOOL Inputs Name Type it SXml Iterator Sample call: b Result := fb Xml. Clear Iterator(xml It); Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4024.56 x86, x64, ARM Tc3_Json Xml 3.4.5.0 TE1000 Version: 1.14.2 177
## Page 178

Function blocks 4.7.42 Compare This method checks two iterators for equality. Syntax METHOD Compare : BOOL VAR_INPUT it1 : SXml Iterator; it2 : SXml Iterator; END_VAR Return value Name Type Compare BOOL Inputs Name Type It1 SXml Iterator It2 SXml Iterator Sample call: b Result := fb Xml. Compare(xml It1, xml It2); 4.7.43 Copy Attribute Text This method reads the value of an XML attribute and writes it to a variable of data type String. The XML attribute as well as the target variable and the length to be written are passed to the method as input parameters. The method returns the actual size. Syntax METHOD Copy Attribute Text : UDINT VAR_INPUT a : SXml Attribute; END_VAR VAR_IN_OUT CONSTANT s Xml : STRING; END_VAR VAR_INPUT n Xml : UDINT; END_VAR Return value Name Type Copy Attribute Text UDINT 178 Version: 1.14.2 TE1000
## Page 179

Function blocks Inputs Name Type a SXml Attribute n Xml UDINT / Inputs/Outputs Name Type s Xml STRING Sample call: n Length := fb Xml. Copy Attribute Text(xml Attr, s Target, SIZEOF(s Target)); 4.7.44 Copy Document This method copies the contents of the DOM memory into a variable of data type String. The length to be written and the variable into which the resulting string is to be written are passed to the method as input parameters. The method returns the actually written length. Note that the size of the string variable is at least equal to the size of the XML document in the DOM. Syntax METHOD Copy Document : UDINT VAR_IN_OUT CONSTANT s Xml : STRING; END_VAR VAR_INPUT n Xml : UDINT; END_VAR Return value Name Type Copy Document UDINT Inputs Name Type n Xml UDINT / Inputs/Outputs Name Type s Xml STRING Sample call: n Length := fb Xml. Copy Document(s Target, SIZEOF(s Target)); TE1000 Version: 1.14.2 179
## Page 180

Function blocks 4.7.45 Copy Node Text This method reads the value of an XML node and writes it to a variable of data type String. The XML node as well as the target variable and the length to be written are passed to the method as input parameters. The method returns the actual size. Syntax METHOD Copy Node Text : UDINT VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT s Xml : STRING; END_VAR VAR_INPUT n Xml : UDINT; END_VAR Return value Name Type Copy Node Text UDINT Inputs Name Type n SXml Node n Xml UDINT / Inputs/Outputs Name Type s Xml STRING Sample call: n Length := fb Xml. Copy Node Text(xml Node, s Target, SIZEOF(s Target)); 4.7.46 Copy Node Xml This method reads the XML structure of an XML node and writes it to a variable of data type String. The XML node as well as the target variable and the length to be written are passed to the method as input parameters. The method returns the actual size. Syntax METHOD Copy Node Xml : UDINT VAR_INPUT a : SXml Node; END_VAR VAR_IN_OUT CONSTANT s Xml : STRING; 180 Version: 1.14.2 TE1000
## Page 181

Function blocks END_VAR VAR_INPUT n Xml : UDINT; END_VAR Return value Name Type Copy Node Xml UDINT Inputs Name Type a SXml Node n Xml UDINT / Inputs/Outputs Name Type s Xml STRING Sample call: n Length := fb Xml. Copy Node Xml(xml Node, s Target, SIZEOF(s Target)); 4.7.47 First Node By Path This method navigates through an XML document using a path that was transferred to the method. The path and the start node are transferred to the method as input parameters. The path is specified with "/" as separator. The method returns a reference to the XML node that was found. Syntax METHOD First Node By Path : SXml Node VAR_INPUT n : SXml Node; path : STRING; END_VAR Return value Name Type First Node By Path SXml Node Inputs Name Type n SXml Node path STRING Sample call: xml Found Node := fb Xml. First Node By Path(xml Start Node, 'Level1/Level2/Level3'); TE1000 Version: 1.14.2 181
## Page 182

Function blocks 4.7.48 Get Attribute Text Length This method returns the length of the value of an XML attribute. The XML attribute is transferred to the method as input parameter. Syntax METHOD Get Attribute Text Length : UDINT VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Get Attribute Text Length UDINT Inputs Name Type a SXml Attribute Sample call: n Length := fb Xml. Get Attribute Text Length(xml Attr); 4.7.49 Get Document Length This method returns the length of an XML document in bytes. Syntax METHOD Get Document Length : UDINT Return value Name Type Get Document Length UDINT Sample call: n Length := fb Xml. Get Document Length(); 4.7.50 Get Document Node This method returns the root node of an XML document. This is not the same as the first XML node in the document (the method Get Root Node() should be used for this). The method can also be used to create an empty XML document in the DOM. 182 Version: 1.14.2 TE1000
## Page 183

Function blocks Syntax METHOD Get Document Node : SXml Node Return value Name Type Get Document Node SXml Node Sample call: obj Root := fb Xml. Get Document Node(); 4.7.51 Get Node Text Length This method returns the length of the value of an XML node. The XML node is transferred to the method as input parameter. Syntax METHOD Get Node Text Length : UDINT VAR_INPUT n : SXml Node; END_VAR Return value Name Type Get Node Text Length UDINT Inputs Name Type n SXml Node Sample call: n Length := fb Xml. Get Node Text Length(xml Node); 4.7.52 Get Node Xml Length This method returns the length of the XML structure of an XML node. The XML node is transferred to the method as input parameter. Syntax METHOD Get Node Xml Length : UDINT VAR_INPUT n : SXml Node; END_VAR TE1000 Version: 1.14.2 183
## Page 184

Function blocks Return value Name Type Get Node Xml Length UDINT Inputs Name Type n SXml Node Sample call: n Length := fb Xml. Get Node Xml Length(xml Node); 4.7.53 Get Root Node This method returns a reference to the first XML node in the XML document. Syntax METHOD Get Root Node : SXml Node Return value Name Type Get Root Node SXml Node Sample call: xml Root Node := fb Xml. Get Root Node(); 4.7.54 Insert Attribute Copy This method adds an attribute to an XML node. The name and value of an existing attribute are copied. The attribute can be placed at a specific position. The XML node, the position and a reference to the existing attribute object are transferred to the method as input parameters. The method returns a reference to the newly added attribute. Syntax METHOD Insert Attribute Copy : SXml Attribute VAR_INPUT n : SXml Node; before : SXml Attribute; copy : SXml Attribute; END_VAR Return value Name Type Insert Attribute Copy SXml Attribute 184 Version: 1.14.2 TE1000
## Page 185

Function blocks Inputs Name Type n SXml Node before SXml Attribute copy SXml Attribute Sample call: xml New Attr := fb Xml. Insert Attribute Copy(xml Node, xml Before Attr, xml Copy Attr); 4.7.55 Insert Attribute This method adds an attribute to an XML node. The attribute can be placed at a specific position. The XML node and the position and name of the new attribute are transferred to the method as input parameters. The method returns a reference to the newly added attribute. A value for the attribute can then be entered using the Set Attribute() method, for example. Syntax METHOD Insert Attribute : SXml Attribute VAR_INPUT n : SXml Node; before : SXml Attribute; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Insert Attribute SXml Attribute Inputs Name Type n SXml Node before SXml Attribute / Inputs/Outputs Name Type name STRING Sample call: xml New Attr := fb Xml. Insert Attribute(xml Node, xml Before Attr, 'Some Name'); 4.7.56 Insert Child TE1000 Version: 1.14.2 185
## Page 186

Function blocks This method adds a node to an existing XML node. The new node can be placed at a specific location. The existing XML node and the position and name of the new node are transferred to the method as input parameters. The method returns a reference to the newly added node. A value for the node can then be entered using the Set Child() method, for example. Syntax METHOD Insert Child : SXml Node VAR_INPUT n : SXml Node; before : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Insert Child SXml Node Inputs Name Type n SXml Node before SXml Attribute / Inputs/Outputs Name Type name STRING Sample call: xml New Node := fb Xml. Insert Child(xml Node, xml Before Node, 'Some Name'); 4.7.57 Insert Copy This method adds a new node to an existing XML node and copies an existing node. The new node can be placed anywhere in the existing node. The XML node, the position and a reference to the existing node object are transferred to the method as input parameters. The method returns a reference to the newly added node. Syntax METHOD Insert Copy : SXml Node VAR_INPUT n : SXml Node; before : SXml Node; copy : SXml Node; END_VAR Return value Name Type Insert Copy SXml Node 186 Version: 1.14.2 TE1000
## Page 187

Function blocks Inputs Name Type n SXml Node before SXml Node copy SXml Node Sample call: xml New Node := fb Xml. Insert Copy(xml Node, xml Before Node, xml Copy Node); 4.7.58 Is End This method checks whether a given XML iterator is at the end of the iteration that is to be performed. Syntax METHOD Is End : BOOL VAR_INPUT it : SXml Iterator; END_VAR Return value Name Type Is End BOOL Inputs Name Type nit SXml Iterator Sample call: xml Iterator := fb Xml. Begin(xml Node); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Node Ref := fb Xml. Node(xml Iterator); xml Node Value := fb Xml. Node Text(xml Node Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.59 Load Document From File This method loads an XML document from a file. The absolute path to the file is transferred to the method as input parameter. A rising edge on the input parameter b Exec triggers the loading procedure. The asynchronous process is terminated as soon as the reference b Exec is set back to FALSE from the method. When the process ends, the return value of the method indicates whether the loading of the file was successful (TRUE) or failed (FALSE) for the duration of one call. TE1000 Version: 1.14.2 187
## Page 188

Function blocks Encoding Please note that the imported files must be formatted in UTF-8. Formats such as UTF-16 are not supported. Syntax METHOD Load Document From File : BOOL VAR_IN_OUT CONSTANT s File : STRING; END_VAR VAR_INPUT b Exec : REFERENCE TO BOOL; END_VAR VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Load Document From File BOOL Inputs Name Type b Exec REFERENCE TO BOOL / Inputs/outputs Name Type s File STRING Outputs Name Type hr Error Code HRESULT Sample call: IF b Load THEN b Loaded := fb Xml. Load Document From File('C:\Test.xml', b Load); END_IF 4.7.60 New Document This method creates an empty XML document in the DOM memory. Syntax METHOD New Document : BOOL Return value Name Type New Document BOOL 188 Version: 1.14.2 TE1000
## Page 189

Function blocks Sample call: fb Xml. New Document(); 4.7.61 Next This method sets an XML iterator for the next object that is to be processed. Syntax METHOD Next : SXml Iterator VAR_INPUT it : SXml Iterator; END_VAR Return value Name Type Next SXml Iterator Inputs Name Type it SXml Iterator Sample call: xml Iterator := fb Xml. Begin(xml Node); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Node Ref := fb Xml. Node(xml Iterator); xml Node Value := fb Xml. Node Text(xml Node Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.62 Next Attribute This method returns the next attribute for a given XML attribute. Syntax METHOD Next Attribute : SXml Attribute VAR_INPUT a : SXml Attribute; END_VAR Return value Name Type Next Attribute SXml Attribute TE1000 Version: 1.14.2 189
## Page 190

Function blocks Inputs Name Type a SXml Attribute Sample call: xml Next Attr := fb Xml. Next Attribute(xml Attr); 4.7.63 Next By Name This method sets an XML iterator for the next object that is to be processed, which is identified by its name. Syntax METHOD Next By Name : SXml Iterator VAR_INPUT it : SXml Iterator; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Next By Name SXml Iterator Inputs Name Type it SXml Iterator / Inputs/Outputs Name Type name STRING Sample call: xml Iterator := fb Xml. Begin(xml Node); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Node Ref := fb Xml. Node(xml Iterator); xml Node Value := fb Xml. Node Text(xml Node Ref); xml Iterator := fb Xml. Next By Name(xml Iterator, 'Some Name'); END_WHILE 4.7.64 Next Sibling This method returns the next direct node for a given XML node at the same XML level. 190 Version: 1.14.2 TE1000
## Page 191

Function blocks Syntax METHOD Next Sibling : SXml Node VAR_INPUT n : SXml Node; END_VAR Return value Name Type Next Sibling SXml Node Inputs Name Type n SXml Node Sample call: xml Sibling := fb Xml. Next Sibling(xml Node); 4.7.65 Next Sibling By Name This method returns the next direct node for a given XML node with a particular name at the same XML level. Syntax METHOD Next Sibling By Name : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Next Sibling By Name SXml Node Inputs Name Type n SXml Node / Inputs/Outputs Name Type name STRING Sample call: xml Sibling := fb Xml. Next Sibling By Name(xml Node, 'Some Name'); TE1000 Version: 1.14.2 191
## Page 192

Function blocks 4.7.66 Node This method is used in conjunction with an iterator to navigate through the DOM. The iterator is transferred to the method as input parameter. The method then returns the current XML node as return value. Syntax METHOD Node : SXml Node VAR_INPUT it : SXml Iterator; END_VAR Return value Name Type Node SXml Node Inputs Name Type it SXml Iterator Sample call: xml Machine Node := fb Xml. Children By Name(xml Machines, xml Iterator, 'Machine'); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Node := fb Xml. Node(xml Iterator); xml Machine Node Value := fb Xml. Node Text(xml Machine Node); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE 4.7.67 Node As Bool This method returns the text of an XML node as data type Boolean. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Bool : BOOL VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Bool BOOL Inputs Name Type n SXml Node Sample call: b Xml Node:= fb Xml. Node As Bool(xml Machine1); 192 Version: 1.14.2 TE1000
## Page 193

Function blocks 4.7.68 Node As Double This method returns the text of an XML node as data type Double. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Double : LREAL VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Double LREAL Inputs Name Type n SXml Node Sample call: lr Xml Node:= fb Xml. Node As Double(xml Machine1); 4.7.69 Node As Float This method returns the text of an XML node as data type Float. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Float : REAL VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Float REAL Inputs Name Type n SXml Node Sample call: r Xml Node:= fb Xml. Node As Float(xml Machine1); TE1000 Version: 1.14.2 193
## Page 194

Function blocks 4.7.70 Node As Int This method returns the text of an XML node as a data type Integer. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Int : DINT VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Int DINT Inputs Name Type n SXml Node Sample call: n Xml Node:= fb Xml. Node As Int(xml Machine1); 4.7.71 Node As Lint This method returns the text of an XML node as a data type Integer64. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Lint : LINT VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Lint LINT Inputs Name Type n SXml Node Sample call: n Xml Node:= fb Xml. Node As Lint(xml Machine1); 194 Version: 1.14.2 TE1000
## Page 195

Function blocks 4.7.72 Node As Uint This method returns the text of an XML node as data type Unsigned Integer. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Uint : UDINT VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Uint UDINT Inputs Name Type n SXml Node Sample call: n Xml Node:= fb Xml. Node As Uint(xml Machine1); 4.7.73 Node As Ulint This method returns the text of an XML node as data type Unsigned Integer64. The XML node is transferred to the method as input parameter. Syntax METHOD Node As Ulint : ULINT VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node As Ulint ULINT Inputs Name Type n SXml Node Sample call: n Xml Node:= fb Xml. Node As Ulint(xml Machine1); TE1000 Version: 1.14.2 195
## Page 196

Function blocks 4.7.74 Node Name This method returns the name of an XML node. A reference to the XML node is transferred to the method as input parameter. Syntax METHOD Node Name : STRING VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node Name STRING Inputs Name Type n SXml Node Sample call: s Node Name := fb Xml. Node Name(xml Machine1); 4.7.75 Node Text This method returns the text of an XML node. The XML node is transferred to the method as input parameter. If the text of an XML node is longer than 255 characters, the method Copy Node Text [} 180] must be used. Syntax METHOD Node Text : STRING(255) VAR_INPUT n : SXml Node; END_VAR Return value Name Type Node Text STRING(255) Inputs Name Type n SXml Node Sample call: s Machine1Name := fb Xml. Node Text(xml Machine1); 196 Version: 1.14.2 TE1000
## Page 197

Function blocks 4.7.76 Parse Document This method loads an XML document into the DOM memory for further processing. The XML document exists as a string and is transferred to the method as input parameter. A reference to the XML document in the DOM is returned to the caller. Syntax METHOD Parse Document : SXml Node VAR_IN_OUT CONSTANT s Xml : STRING; END_VAR Return value Name Type Parse Document SXml Node / Inputs/Outputs Name Type s Xml STRING Sample call: xml Doc := fb Xml. Parse Document(s Xml To Parse); 4.7.77 Remove Child This method removes an XML child node from a given XML node. The two XML nodes are transferred to the method as input parameters. The method returns TRUE if the operation was successful and the XML node was removed. Syntax METHOD Remove Child : BOOL VAR_INPUT n : SXml Node; child : SXml Node; END_VAR Return value Name Type Remove Child BOOL Inputs Name Type n SXml Node child SXml Node Sample call: TE1000 Version: 1.14.2 197
## Page 198

Function blocks b Removed := fb Xml. Remove Child(xml Parent, xml Child); 4.7.78 Remove Child By Name This method removes an XML child node from a given XML node. The node to be removed is addressed by its name. If there is more than one child node, the last child node is removed. The method returns TRUE if the operation was successful and the XML node was removed. Syntax METHOD Remove Child By Name : BOOL VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT name : STRING; END_VAR Return value Name Type Remove Child By Name BOOL Inputs Name Type n SXml Node / Inputs/Outputs Name Type name STRING Sample call: b Removed := fb Xml. Remove Child By Name(xml Parent, 'Some Name'); 4.7.79 Save Document To File This method saves the current XML document in a file. The absolute path to the file is transferred to the method as input parameter. A rising edge at the input parameter b Exec triggers the saving procedure. The asynchronous process is terminated as soon as the reference b Exec is set back to FALSE from the method. When the process ends, the return value of the method indicates for one call whether saving of the file was successful (TRUE) or failed (FALSE). Syntax METHOD Save Document To File : BOOL VAR_IN_OUT CONSTANT s File : STRING; END_VAR VAR_INPUT b Exec : REFERENCE TO BOOL; END_VAR 198 Version: 1.14.2 TE1000
## Page 199

Function blocks VAR_OUTPUT hr Error Code: HRESULT; END_VAR Return value Name Type Save Document To File BOOL Inputs Name Type b Exec REFERENCE TO BOOL / Inputs/Outputs Name Type s File STRING Outputs Name Type hr Error Code HRESULT Sample call: IF b Save THEN b Saved = fb Xml. Save Document To File('C:\Test.xml', b Save); END_IF 4.7.80 Set Ads Provider Syntax METHOD Set Ads Provider : BOOL VAR_IN_OUT CONSTANT oid : OTCID; END_VAR Return value Name Type Set Ads Provider BOOL / Inputs/Outputs Name Type oid OTCID 4.7.81 Set Attribute TE1000 Version: 1.14.2 199
## Page 200

Function blocks This method sets the value of an attribute. The value has the data type String. Syntax METHOD Set Attribute : SXml Attribute VAR_INPUT a : SXml Attribute; END_VAR VAR_IN_OUT CONSTANT value : STRING; END_VAR Return value Name Type Set Attribute SXml Attribute Inputs Name Type a SXml Attribute / Inputs/Outputs Name Type value STRING Sample call: xml Attr := fb Xml. Set Attribute(xml Existing Attr, 'Test'); 4.7.82 Set Attribute As Bool This method sets the value of an attribute. The value has the data type Boolean. Syntax METHOD Set Attribute As Bool : SXml Attribute VAR_INPUT a : SXml Attribute; value : BOOL; END_VAR Return value Name Type Set Attribute As Bool SXml Attribute Inputs Name Type a SXml Attribute value BOOL Sample call: xml Attr := fb Xml. Set Attribute As Bool(xml Existing Attr, TRUE); 200 Version: 1.14.2 TE1000
## Page 201

Function blocks 4.7.83 Set Attribute As Double This method sets the value of an attribute. The value here has the data type Double. Syntax METHOD Set Attribute As Double : SXml Attribute VAR_INPUT a : SXml Attribute; value : LREAL; END_VAR Return value Name Type Set Attribute As Double SXml Attribute Inputs Name Type a SXml Attribute value LREAL Sample call: xml Attr := fb Xml. Set Attribute As Double(xml Existing Attr, 42.42); 4.7.84 Set Attribute As Float This method sets the value of an attribute. The value has the data type Float. Syntax METHOD Set Attribute As Float : SXml Attribute VAR_INPUT a : SXml Attribute; value : REAL; END_VAR Return value Name Type Set Attribute As Float SXml Attribute Inputs Name Type a SXml Attribute value REAL Sample call: xml Attr := fb Xml. Set Attribute As Float(xml Existing Attr, 42.42); TE1000 Version: 1.14.2 201
## Page 202

Function blocks 4.7.85 Set Attribute As Int This method sets the value of an attribute. The value has the data type Integer. Syntax METHOD Set Attribute As Int : SXml Attribute VAR_INPUT a : SXml Attribute; value : DINT; END_VAR Return value Name Type Set Attribute As Int SXml Attribute Inputs Name Type a SXml Attribute value DINT Sample call: xml Attr := fb Xml. Set Attribute As Int(xml Existing Attr, 42); 4.7.86 Set Attribute As Lint This method sets the value of an attribute. The value has the data type Integer64. Syntax METHOD Set Attribute As Lint : SXml Attribute VAR_INPUT a : SXml Attribute; value : LINT; END_VAR Return value Name Type Set Attribute As Lint SXml Attribute Inputs Name Type a SXml Attribute value LINT Sample call: xml Attr := fb Xml. Set Attribute As Lint(xml Existing Attr, 42); 202 Version: 1.14.2 TE1000
## Page 203

Function blocks 4.7.87 Set Attribute As Uint This method sets the value of an attribute. The value has the data type Unsigned Integer. Syntax METHOD Set Attribute As Uint : SXml Attribute VAR_INPUT a : SXml Attribute; value : UDINT; END_VAR Return value Name Type Set Attribute As Uint SXml Attribute Inputs Name Type a SXml Attribute value UDINT Sample call: xml Attr := fb Xml. Set Attribute As Uint(xml Existing Attr, 42); 4.7.88 Set Attribute As Ulint This method sets the value of an attribute. The value has the data type Unsigned Integer64. Syntax METHOD Set Attribute As Ulint : SXml Attribute VAR_INPUT a : SXml Attribute; value : ULINT; END_VAR Return value Name Type Set Attribute As Ulint SXml Attribute Inputs Name Type a SXml Attribute value ULINT Sample call: xml Attr := fb Xml. Set Attribute As Ulint(xml Existing Attr, 42); TE1000 Version: 1.14.2 203
## Page 204

Function blocks 4.7.89 Set Child This method sets the value of an XML node. The value is transferred to the method as input parameter of data type String. The input parameter cdata indicates whether the value of the node is to be encapsulated in a CDATA function block, so that certain special characters such as "<" and ">" are allowed as values. Syntax METHOD Set Child : SXml Node VAR_INPUT n : SXml Node; END_VAR VAR_IN_OUT CONSTANT value : STRING; END_VAR VAR_INPUT cdata : BOOL; END_VAR Return value Name Type Set Child SXml Node Inputs Name Type n SXml Node cdata BOOL / Inputs/Outputs Name Type value STRING Sample call: xml Node := fb Xml. Set Child(xml Existing Node, 'Some Text', FALSE); 4.7.90 Set Child As Bool This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Boolean. Syntax METHOD Set Child As Bool : SXml Node VAR_INPUT n : SXml Node; value : BOOL; END_VAR 204 Version: 1.14.2 TE1000
## Page 205

Function blocks Return value Name Type Set Child As Bool SXml Node Inputs Name Type n SXml Node value BOOL Sample call: xml Node := fb Xml. Set Child(xml Existing Node, TRUE); 4.7.91 Set Child As Double This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Double. Syntax METHOD Set Child As Double : SXml Node VAR_INPUT n : SXml Node; value : LREAL; END_VAR Return value Name Type Set Child As Double SXml Node Inputs Name Type n SXml Node value LREAL Sample call: xml Node := fb Xml. Set Child As Double(xml Existing Node, 42.42); 4.7.92 Set Child As Float This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Float. TE1000 Version: 1.14.2 205
## Page 206

Function blocks Syntax METHOD Set Child As Float : SXml Node VAR_INPUT n : SXml Node; value : REAL; END_VAR Return value Name Type Set Child As Float SXml Node Inputs Name Type n SXml Node value REAL Sample call: xml Node := fb Xml. Set Child As Float(xml Existing Node, 42.42); 4.7.93 Set Child As Int This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Integer. Syntax METHOD Set Child As Int : SXml Node VAR_INPUT n : SXml Node; value : DINT; END_VAR Return value Name Type Set Child As Int SXml Node Inputs Name Type n SXml Node value DINT Sample call: xml Node := fb Xml. Set Child As Int(xml Existing Node, 42); 206 Version: 1.14.2 TE1000
## Page 207

Function blocks 4.7.94 Set Child As Lint This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Integer64. Syntax METHOD Set Child As Lint : SXml Node VAR_INPUT n : SXml Node; value : LINT; END_VAR Return value Name Type Set Child As Lint SXml Node Inputs Name Type n SXml Node value LINT Sample call: xml Node := fb Xml. Set Child As Lint(xml Existing Node, 42); 4.7.95 Set Child As Uint This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Unsigned Integer. Syntax METHOD Set Child As Uint : SXml Node VAR_INPUT n : SXml Node; value : UDINT; END_VAR Return value Name Type Set Child As Uint SXml Node Inputs Name Type n SXml Node value UDINT TE1000 Version: 1.14.2 207
## Page 208

Function blocks Sample call: xml Node := fb Xml. Set Child As Uint(xml Existing Node, 42); 4.7.96 Set Child As Ulint This method sets the value of an XML node. The value is transferred to the method as input parameter of data type Unsigned Integer64. Syntax METHOD Set Child As Ulint : SXml Node VAR_INPUT n : SXml Node; value : ULINT; END_VAR Return value Name Type Set Child As Ulint SXml Node Inputs Name Type n SXml Node value ULINT Sample call: xml Node := fb Xml. Set Child As Ulint(xml Existing Node, 42); 4.8 FB_Jwt Encode The function block enables the creation and signing of a JSON Web Token (JWT). Syntax Definition: FUNCTION_BLOCK FB_Jwt Encode VAR_INPUT b Execute : BOOL; s Header Alg : STRING(46); s Payload : STRING(1023); s Key File Path : STRING(511); t Timeout : TIME; p Key : PVOID; n Key Size : UDINT; 208 Version: 1.14.2 TE1000
## Page 209

Function blocks n Jwt Size : UDINT; END_VAR VAR_IN_OUT CONSTANT s Jwt : STRING; END_VAR VAR_OUTPUT b Busy : BOOL; b Error : BOOL; hr Error Code : HRESULT; init Status : HRESULT; END_VAR Inputs Name Type Description b Execute BOOL A rising edge activates processing of the function block. s Header Alg STRING(46) The algorithm to be used for the JWT header, e.g. RS256. s Payload STRING(1023) The JWT payload to be used. s Key File Path STRING(511) Path to the private key to be used for the signature of the JWT. t Timeout TIME ADS timeout, which is used internally for file access to the private key. p Key PVOID Buffer for the private key to be read. n Key Size UDINT Maximum size of the buffer. s Jwt STRING Contains the fully coded and signed JWT after the function block has been processed. n Jwt Size UDINT Size of the generated JWT including zero termination. Outputs Name Type Description b Busy BOOL Is TRUE as long as processing of the function block is in progress. b Error BOOL Becomes TRUE as soon as an error situation occurs. hr Error Code HRESULT Returns an error code if the b Error output is set. An explanation of the possible error codes can be found in the Appendix. init Status HRESULT Returns an error code in case of a failed initialization of the function block. Requirements Twin CAT version Hardware Libraries to be integrated Twin CAT 3.1, Build 4024.4 x86, x64, ARM Tc3_Json Xml 3.3.6.0 TE1000 Version: 1.14.2 209
## Page 210

Interfaces 5 Interfaces 5.1 ITc Json Sax Handler 5.1.1 On Bool This callback method is triggered if a value of the data type BOOL was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Bool : HRESULT VAR_INPUT value : BOOL; END_VAR 5.1.2 On Dint This callback method is triggered if a value of the data type DINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Dint : HRESULT VAR_INPUT value : DINT; END_VAR 5.1.3 On End Array This callback method is triggered if a square closing bracket, which corresponds to the JSON synonym for an ending array, was found at the position of the SAX reader. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On End Array : HRESULT 5.1.4 On End Object This callback method is triggered if a curly closing bracket, which corresponds to the JSON synonym for an ending object, was found at the position of the SAX reader. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On End Object : HRESULT 5.1.5 On Key This callback method is triggered if a property was found at the position of the SAX reader. The property name lies on the input/output parameter key and its length on the input parameter len. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Key : HRESULT VAR_IN_OUT CONSTANT key : STRING; END_VAR 210 Version: 1.14.2 TE1000
## Page 211

Interfaces VAR_INPUT len : UDINT; END_VAR 5.1.6 On Lint This callback method is triggered if a value of the data type LINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Lint : HRESULT VAR_INPUT value : LINT; END_VAR 5.1.7 On Lreal This callback method is triggered if a value of the data type LREAL was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Lreal : HRESULT VAR_INPUT value : LREAL; END_VAR 5.1.8 On Null This callback method is triggered if a NULL value was found at the position of the SAX reader. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Null : HRESULT 5.1.9 On Start Array This callback method is triggered if a square opening bracket, which corresponds to the JSON synonym for a starting array, was found at the position of the SAX reader. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Start Array : HRESULT 5.1.10 On Start Object This callback method is triggered if a curly opening bracket, which corresponds to the JSON synonym for a starting object, was found at the position of the SAX reader. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Start Object : HRESULT TE1000 Version: 1.14.2 211
## Page 212

Interfaces 5.1.11 On String This callback method is triggered if a value of the data type STRING was found at the position of the SAX reader. The In/Out parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On String : HRESULT VAR_IN_OUT CONSTANT value : STRING; END_VAR VAR_INPUT len : UDINT; END_VAR 5.1.12 On Udint This callback method is triggered if a value of the data type UDINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Udint : HRESULT VAR_INPUT value : UDINT; END_VAR 5.1.13 On Ulint This callback method is triggered if a value of the data type ULINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Ulint : HRESULT VAR_INPUT value : ULINT; END_VAR 5.2 ITc Json Sax Values 5.2.1 On Bool Value This callback method is triggered if a value of the data type BOOL was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Bool Value : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; value : BOOL; END_VAR 5.2.2 On Dint Value This callback method is triggered if a value of the data type DINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. 212 Version: 1.14.2 TE1000
## Page 213

Interfaces Syntax METHOD On Dint Value : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; value : DINT; END_VAR 5.2.3 On Lint Value This callback method is triggered if a value of the data type LINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Lint Value : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; value : LINT; END_VAR 5.2.4 On Lreal Value This callback method is triggered if a value of the data type LREAL was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Lreal Value : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; value : LREAL; END_VAR 5.2.5 On Null Value This callback method is triggered if a NULL value was found at the position of the SAX reader. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Null : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; END_VAR 5.2.6 On String Value This callback method is triggered if a value of the data type STRING was found at the position of the SAX reader. The input/output parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On String Value : HRESULT VAR_IN_OUT CONSTANT value : STRING; END_VAR VAR_INPUT len : UDINT; level : UDINT; infos : POINTER TO Tc Json Level Info; END_VAR TE1000 Version: 1.14.2 213
## Page 214

Interfaces 5.2.7 On Udint Value This callback method is triggered if a value of the data type UDINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Udint Value : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; value : UDINT; END_VAR 5.2.8 On Ulint Value This callback method is triggered if a value of the data type ULINT was found at the position of the SAX reader. The input parameter value contains the value found. The SAX parsing procedure is aborted by setting the return value HRESULT to S_FALSE. Syntax METHOD On Ulint Value : HRESULT VAR_INPUT level : UDINT; infos : POINTER TO Tc Json Level Info; value : ULINT; END_VAR 214 Version: 1.14.2 TE1000
## Page 215

Samples 6 Samples Downloads Sample code and configurations for this product can be obtained from the corresponding repository on Git Hub: https://github.com/Beckhoff/Tc3Json Xml_Samples. There you have the option to clone the repository or download a ZIP file containing the sample. 6.1 Tc3Json Xml Sample Json Data Type Sample of the automatic conversion of structures into a JSON message This sample illustrates how a data structure can be converted into a JSON message (and vice versa). In the conversion the layout of a structure is converted one-to-one into a corresponding JSON equivalent. Additional metadata can be created via PLC attributes on the member variables of the structure. Layout of the data structure to be converted TYPE ST_Values : STRUCT {attribute 'Unit' := 'm/s'} {attribute 'Display Name' := 'Speed'} Sensor1 : REAL; {attribute 'Unit' := 'V'} {attribute 'Display Name' := 'Voltage'} Sensor2 : DINT; {attribute 'Unit' := 'A'} {attribute 'Display Name' := 'Current'} Sensor3 : DINT; END_STRUCT END_TYPE Declaration range PROGRAM MAIN VAR dt Timestamp : DATE_AND_TIME := DT#2017-04-04-12:42:42; fb Json : FB_Json Sax Writer; fb Json Data Type : FB_Json Read Write Data Type; s Json Doc : STRING(255); s Json Doc2 : STRING(2000); st Values : ST_Values; END_VAR TE1000 Version: 1.14.2 215
## Page 216

Samples Implementation range Two ways of generating the JSON message are shown, starting with the instance fb Json of the function block FB_Json Sax Writer. The Get Document() method can be used with a JSON message with no more than 255 characters. However, the Copy Document() method must be used with larger JSON messages. fb Json. Reset Document(); fb Json. Start Object(); fbjson. Add Key Date Time('Timestamp', dt Timestamp); fb Json Data Type. Add Json Key Value From Symbol(fb Json, 'Values', 'ST_Values', SIZEOF(st Values), ADR(st Valu es)); fb Json Data Type. Add Json Key Properties From Symbol(fb Json, 'Meta Data', 'ST_Values', 'Unit|Display Name'); fb Json. End Object(); s Json Doc := fb Json. Get Document(); fb Json. Copy Document(s Json Doc2, SIZEOF(s Json Doc2)); Resulting JSON message { "Timestamp": "2017-04-04T12:42:42", "Values": { "Sensor1": 0.0, "Sensor2": 0, "Sensor3": 0 }, "Meta Data": { "Sensor1": { "Unit": "m/s", "Display Name": "Speed" }, "Sensor2": { "Unit": "V", "Display Name": "Voltage" }, "Sensor3": { "Unit": "A", "Display Name": "Current" } } } Alternative As an alternative, the method Add Json Value From Symbol() can also be used to generate a JSON format directly from a data structure. fb Json. Reset Document(); fb Json Data Type. Add Json Value From Symbol(fb Json, 'ST_Values', SIZEOF(st Values), ADR(st Values)); s Json Doc := fb Json. Get Document(); fb Json. Copy Document(s Json Doc2, SIZEOF(s Json Doc2)); The resulting JSON object looks like this: { "Sensor1": 0.0, "Sensor2": 0, "Sensor3": 0 } Conversion of a JSON message back to a data structure The above samples show how a JSON object can be generated from a data structure in a simple manner. There is also a corresponding method in the Tc3_Json Xml library for the reverse process, i.e. the extraction of values from a (received) JSON object back into a data structure. This application is made possible by calling the method Set Symbol From Json(). fb Json Data Type. Set Symbol From Json(some Json, 'ST_Values', SIZEOF(st Values Receive), ADR(st Values Receive)); The string variable s Json Doc2 contains the JSON object, which is transferred into the structure instance st Values Receive by calling the method. Target data structure The target data structure must match the structure of the JSON document. Otherwise Set Symbol From Json() returns FALSE. 216 Version: 1.14.2 TE1000
## Page 217

Samples 6.2 Tc3Json Xml Sample Json Sax Reader Sample of the parsing of JSON documents via SAX Reader This sample illustrates how a JSON message can be run through programmatically. The function block FB_Json Sax Reader is used as the basis. Declaration range PROGRAM MAIN VAR fb Json : FB_Json Sax Reader; p Json Parse : Json Sax Handler; s Json Doc : STRING(255) := '{"Values": {"Timestamp":"2017-04-04T12:42:42","Sensor1":42.42,"Sensor2":42}}'; END_VAR Implementation range Through the calling of the Parse() method, the transfer of the JSON message as a STRING and the interface pointer to a function block instance that implements the interface Itc Json Sax Handler, the SAX Reader is activated and the corresponding callback methods are run through. fb Json. Parse(s Json := s Json Doc, ip Hdl := p Json Parse); Callback methods The callback methods are called on the instance of the function block that implements the interface Itc Json Sax Handler. Each callback method represents a "found" element in the JSON message. For example, the callback method On Start Object() is called as soon as an opening curly bracket has been detected. According to the example JSON message mentioned above, therefore, the following callback methods are run through in this order: 1. On Start Object(), due to the first opening curly bracket 2. On Key(), due to the property "Values" 3. On Start Object(), due to the second opening curly bracket 4. On Key(), due to the property "Timestamp" 5. On String(), due to the value of the property "Timestamp" 6. On Key(), due to the property "Sensor1" 7. On Lreal(), due to the value of the property "Sensor1" 8. On Key(), due to the property "Sensor2" 9. On Udint(), due to the value of the property "Sensor2" 10. On End Object(), due to the first closing curly bracket 11. On End Object(), due to the second closing curly bracket Within the callback methods the current state is defined and saved via an instance of the enum E_Json States. This can also be used to determine whether the JSON message is valid. For example, if the callback method On Lreal() is called and the state is not the expected State 70 (JSON_STATE_ONLREAL), the return value S_FALSE can be returned to the method. The SAX Reader then automatically cancels the further processing. 6.3 Tc3Json Xml Sample Json Sax Writer Sample of the creation of JSON documents via SAX Writer This sample illustrates how a JSON message can be created over the DAX mechanism. The function block FB_Json Sax Writer is used as the basis. Declaration range PROGRAM MAIN VAR dt Timestamp : DATE_AND_TIME := DT#2017-04-04-12:42:42; TE1000 Version: 1.14.2 217
## Page 218

Samples fb Json : FB_Json Sax Writer; s Json Doc : STRING(255); END_VAR Implementation range The SAX mechanism runs sequentially through the JSON document to be created, i.e. the corresponding elements are run though and created one after the other. fb Json. Start Object(); fb Json. Add Key('Timestamp'); fb Json. Add Date Time(dt Timestamp); fb Json. Add Key('Values'); fb Json. Start Object(); fb Json. Add Key('Sensor1'); fb Json. Add Real(42.42); fb Json. Add Key('Sensor2'); fb Json. Add Dint(42); fb Json. Add Key('Sensor3'); fb Json. Add Bool(TRUE); fb Json. End Object(); fb Json. End Object(); s Json Doc := fb Json. Get Document(); fb Json. Reset Document(); Resulting JSON message { "Timestamp": "2017-04-04T12:42:42", "Values": { "Sensor1": 42.42, "Sensor2": 42, "Sensor3": true } } 6.4 Tc3Json Xml Sample Json Dom Reader This sample illustrates how a JSON message can be run through programmatically on the basis of DOM. The function block FB_Json Dom Parser is used as the basis. Declaration range PROGRAM MAIN VAR fb Json : FB_Json Dom Parser; json Doc : SJson Value; json Prop : SJson Value; json Value : SJson Value; b Has Member : BOOL; s Message : STRING(255) := '{"serial Number":"G030PT028191AC4R","battery Voltage":"1547m V","click Ty pe":"SINGLE"}'; st Received Data : ST_Received Data; END_VAR Implementation range The JSON message is loaded into the DOM tree using the Parse Document() method. You can subsequently check whether it contains a certain property using the Has Member() method. The Find Member() method selects the property. The Get String() method extracts its value. json Doc := fb Json. Parse Document(s Message); b Has Member := fb Json. Has Member(json Doc, 'serial Number'); IF (b Has Member) THEN b Has Member := FALSE; json Prop := fb Json. Find Member(json Doc, 'serial Number'); st Received Data.serial Number := fb Json. Get String(json Prop); END_IF b Has Member := fb Json. Has Member(json Doc, 'battery Voltage'); IF (b Has Member) THEN b Has Member := FALSE; json Prop := fb Json. Find Member(json Doc, 'battery Voltage'); st Received Data.battery Voltage := fb Json. Get String(json Prop); END_IF 218 Version: 1.14.2 TE1000
## Page 219

Samples b Has Member := fb Json. Has Member(json Doc, 'click Type'); IF (b Has Member) THEN b Has Member := FALSE; json Prop := fb Json. Find Member(json Doc, 'click Type'); st Received Data.click Type := fb Json. Get String(json Prop); END_IF The use of the method Has Member() is not absolutely necessary, since the method Find Member() already returns 0 if a property was not found. The code shown above can also be implemented as follows: json Doc := fb Json. Parse Document(s Message); json Prop := fb Json. Find Member(json Doc, 'serial Number'); IF (json Prop <> 0) THEN st Received Data.serial Number := fb Json. Get String(json Prop); END_IF json Prop := fb Json. Find Member(json Doc, 'battery Voltage'); IF (json Prop <> 0) THEN st Received Data.battery Voltage := fb Json. Get String(json Prop); END_IF json Prop := fb Json. Find Member(json Doc, 'click Type'); IF (json Prop <> 0) THEN st Received Data.click Type := fb Json. Get String(json Prop); END_IF Nested JSON objects The approach is similar with nested JSON objects. Since the entire document is located in the DOM, it is simple to navigate. Let's take a JSON object that looks like this: s Message : STRING(255) := '{"Values":{"serial":"G030PT028191AC4R"}}'; The property we are looking for is located in the sub-object "Values". The following code shows how to extract the property. json Doc := fb Json. Parse Document(s Message); b Has Member := fb Json. Has Member(json Doc, 'Values'); IF (b Has Member) THEN b Has Member := FALSE; json Prop := fb Json. Find Member(json Doc, 'Values'); IF json Prop <> 0 THEN json Serial := fb Json. Find Member(json Prop, 'serial'); st Received Data.serial Number := fb Json. Get String(json Serial); END_IF END_IF 6.5 Tc3Json Xml Sample Xml Dom Reader This sample illustrates how an XML document can be processed programmatically based on DOM. The function block FB_Xml Dom Parser is used as a basis. Declaration range PROGRAM MAIN VAR fb Xml : FB_Xml Dom Parser; xml Doc : SXml Node; xml Machines : SXml Node; xml Machine1 : SXml Node; xml Machine2 : SXml Node; xml Iterator : SXml Iterator; xml Machine Node : SXml Node; xml Machine Node Value : STRING; xml Machine Attribute Ref : SXml Attribute; xml Machine1Attribute : SXml Attribute; xml Machine2Attribute : SXml Attribute; s Machine1Name : STRING; s Machine2Name : STRING; n Machine Attribute : DINT; n Machine1Attribute : DINT; n Machine2Attribute : DINT; TE1000 Version: 1.14.2 219
## Page 220

Samples s Message To Parse : STRING(255) := '<Machines><Machine Type="1" Test="3">Wilde Nelli</ Machine><Machine Type="2">Huber8</Machine></Machines>'; END_VAR Implementation range The implementation section shows various options for parsing an XML document. (* Load XML content *) xml Doc := fb Xml. Parse Document(s Message To Parse); (* Parse XML nodes - Option 1 *) xml Machines := fb Xml. Child By Name(xml Doc, 'Machines'); xml Machine1 := fb Xml. Child By Attribute(xml Machines, 'Type', '1'); xml Machine2 := fb Xml. Child By Attribute And Name(xml Machines, 'Type', '2', 'Machine'); (* Parse XML nodes - Option 2 *) xml Machines := fb Xml. Child By Name(xml Doc, 'Machines'); xml Machine Node := fb Xml. Children(xml Machines, xml Iterator); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Node := fb Xml. Node(xml Iterator); xml Machine Node Value := fb Xml. Node Text(xml Machine Node); xml Machine Node := fb Xml. Children(xml Machines, xml Iterator); END_WHILE (* Parse XML nodes - Option 3 *) xml Machines := fb Xml. Child By Name(xml Doc, 'Machines'); xml Iterator := fb Xml. Begin(xml Machines); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Node := fb Xml. Node(xml Iterator); xml Machine Node Value := fb Xml. Node Text(xml Machine Node); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE (* Parse XML attributes - Option 1*) xml Machine1Attribute := fb Xml. Attribute(xml Machine1, 'Type'); xml Machine2Attribute := fb Xml. Attribute(xml Machine2, 'Type'); (* Parse XML attributes - Option 2*) xml Iterator := fb Xml. Attribute Begin(xml Machine1); WHILE NOT fb Xml. Is End(xml Iterator) DO xml Machine Attribute Ref := fb Xml. Attribute From Iterator(xml Iterator); n Machine Attribute := fb Xml. Attribute As Int(xml Machine Attribute Ref); xml Iterator := fb Xml. Next(xml Iterator); END_WHILE (* Retrieve node values *) s Machine1Name := fb Xml. Node Text(xml Machine1); s Machine2Name := fb Xml. Node Text(xml Machine2); (* Retrieve attribute values *) n Machine1Attribute := fb Xml. Attribute As Int(xml Machine1Attribute); n Machine2Attribute := fb Xml. Attribute As Int(xml Machine2Attribute); 6.6 Tc3Json Xml Sample Xml Dom Writer This sample illustrates how an XML document can be created programmatically based on DOM. The function block FB_Xml Dom Parser is used as a basis. Declaration range PROGRAM MAIN VAR fb Xml : FB_Xml Dom Parser; obj Root : SXml Node; obj Machines : SXml Node; obj Machine : SXml Node; obj Controllers : SXml Node; obj Controller : SXml Node; obj Attribute : SXml Attribute; s Xml String : STRING(1000); b Create : BOOL := FALSE; b Save : BOOL := TRUE; n Length : UDINT; new Attr : SXml Attribute; END_VAR 220 Version: 1.14.2 TE1000
## Page 221

Samples Implementation range The implementation section shows various options for creating an XML document. IF b Create THEN (* Create an empty XML document *) obj Root := fb Xml. Get Document Node(); (* Create a new XML node 'Machines' and add to the empty document *) obj Machines := fb Xml. Append Node(obj Root, 'Machines'); (* Create a new XML node 'Machine' and add an attribute to this node. Append node to 'Machines' *) obj Machine := fb Xml. Append Node(obj Machines, 'Machine'); obj Attribute := fb Xml. Append Attribute(obj Machine, 'Name', 'Wilde Nelli'); (* Create a new XML node 'Controllers' and add to the 'Machine' node *) obj Controllers := fb Xml. Append Node(obj Machine, 'Controllers'); (* Create a new XML node 'Controller' and add some attributes. Append node to 'Controllers'. *) obj Controller := fb Xml. Append Child(obj Controllers, 'Controller', 'CX5120', FALSE); obj Attribute := fb Xml. Append Attribute(obj Controller, 'Type', 'EPC'); obj Attribute := fb Xml. Append Attribute(obj Controller, 'OS', 'Windows Embedded Compact 7'); (* Create a new XML node 'Controller' and add some attributes. Append node to 'Controllers'. *) obj Controller := fb Xml. Append Child(obj Controllers, 'Controller', 'CX2040', FALSE); obj Attribute := fb Xml. Append Attribute(obj Controller, 'Type', 'EPC'); obj Attribute := fb Xml. Append Attribute(obj Controller, 'OS', 'Windows Embedded Standard 7'); (* Create a new XML node 'Controller' and add some attributes. Append node to 'Controllers'. *) obj Controller := fb Xml. Append Child(obj Controllers, 'Controller', 'C6015', FALSE); obj Attribute := fb Xml. Append Attribute(obj Controller, 'Type', 'IPC'); obj Attribute := fb Xml. Append Attribute(obj Controller, 'OS', 'Windows 10 Io T Enterprise'); (* Create a new XML node 'Machine' and add an attribute to this node. Append node to 'Machines' *) obj Machine := fb Xml. Append Node(obj Machines, 'Machine'); obj Attribute := fb Xml. Append Attribute(obj Machine, 'Name', 'Stanze Oscar'); (* Create a new XML node 'Controllers' and add to the 'Machine' node *) obj Controllers := fb Xml. Append Node(obj Machine, 'Controllers'); (* Create a new XML node 'Controller' and add some attributes. Append node to 'Controllers'. *) obj Controller := fb Xml. Append Child(obj Controllers, 'Controller', 'C6017', FALSE); obj Attribute := fb Xml. Append Attribute(obj Controller, 'Type', 'IPC'); obj Attribute := fb Xml. Append Attribute(obj Controller, 'OS', 'Windows 10 Io T Enterprise'); new Attr := fb Xml. Insert Attribute(obj Controller, obj Attribute, 'Add Attribute'); fb Xml. Set Attribute(new Attr, 'Hola'); (* Retrieve XML document and store in a variable of data type STRING(1000) *) n Length := fb Xml. Copy Document(s Xml String, SIZEOF(s Xml String)); b Create := FALSE; END_IF TE1000 Version: 1.14.2 221
## Page 222

Error Codes 7 Error Codes 7.1 ADS Return Codes Grouping of error codes: Global error codes: ADS Return Codes [} 222]... (0x9811_0000 ...) Router error codes: ADS Return Codes [} 222]... (0x9811_0500 ...) General ADS errors: ADS Return Codes [} 223]... (0x9811_0700 ...) RTime error codes: ADS Return Codes [} 225]... (0x9811_1000 ...) Global error codes Hex Dec HRESULT Name Description 0x0 0 0x98110000 ERR_NOERROR No error. 0x1 1 0x98110001 ERR_INTERNAL Internal error. 0x2 2 0x98110002 ERR_NORTIME No real time. 0x3 3 0x98110003 ERR_ALLOCLOCKEDMEM Allocation locked  memory error. 0x4 4 0x98110004 ERR_INSERTMAILBOX Mailbox full  the ADS message could not be sent. Reducing the number of ADS messages per cycle will help. 0x5 5 0x98110005 ERR_WRONGRECEIVEHMSG Wrong HMSG. 0x6 6 0x98110006 ERR_TARGETPORTNOTFOUND Target port not found  ADS server is not started, not reachable or not installed. 0x7 7 0x98110007 ERR_TARGETMACHINENOTFOUND Target computer not found  AMS route was not found. 0x8 8 0x98110008 ERR_UNKNOWNCMDID Unknown command ID. 0x9 9 0x98110009 ERR_BADTASKID Invalid task ID. 0x A 10 0x9811000A ERR_NOIO No IO. 0x B 11 0x9811000B ERR_UNKNOWNAMSCMD Unknown AMS command. 0x C 12 0x9811000C ERR_WIN32ERROR Win32 error. 0x D 13 0x9811000D ERR_PORTNOTCONNECTED Port not connected. 0x E 14 0x9811000E ERR_INVALIDAMSLENGTH Invalid AMS length. 0x F 15 0x9811000F ERR_INVALIDAMSNETID Invalid AMS Net ID. 0x10 16 0x98110010 ERR_LOWINSTLEVEL Installation level is too low Twin CAT 2 license error. 0x11 17 0x98110011 ERR_NODEBUGINTAVAILABLE No debugging available. 0x12 18 0x98110012 ERR_PORTDISABLED Port disabled  Twin CAT system service not started. 0x13 19 0x98110013 ERR_PORTALREADYCONNECTED Port already connected. 0x14 20 0x98110014 ERR_AMSSYNC_W32ERROR AMS Sync Win32 error. 0x15 21 0x98110015 ERR_AMSSYNC_TIMEOUT AMS Sync Timeout. 0x16 22 0x98110016 ERR_AMSSYNC_AMSERROR AMS Sync error. 0x17 23 0x98110017 ERR_AMSSYNC_NOINDEXINMAP No index map for AMS Sync available. 0x18 24 0x98110018 ERR_INVALIDAMSPORT Invalid AMS port. 0x19 25 0x98110019 ERR_NOMEMORY No memory. 0x1A 26 0x9811001A ERR_TCPSEND TCP send error. 0x1B 27 0x9811001B ERR_HOSTUNREACHABLE Host unreachable. 0x1C 28 0x9811001C ERR_INVALIDAMSFRAGMENT Invalid AMS fragment. 0x1D 29 0x9811001D ERR_TLSSEND TLS send error  secure ADS connection failed. 0x1E 30 0x9811001E ERR_ACCESSDENIED Access denied  secure ADS access denied. Router error codes 222 Version: 1.14.2 TE1000
## Page 223

Error Codes Hex Dec HRESULT Name Description 0x500 1280 0x98110500 ROUTERERR_NOLOCKEDMEMORY Locked memory cannot be allocated. 0x501 1281 0x98110501 ROUTERERR_RESIZEMEMORY The router memory size could not be changed. 0x502 1282 0x98110502 ROUTERERR_MAILBOXFULL The mailbox has reached the maximum number of possible messages. 0x503 1283 0x98110503 ROUTERERR_DEBUGBOXFULL The Debug mailbox has reached the maximum number of possible messages. 0x504 1284 0x98110504 ROUTERERR_UNKNOWNPORTTYPE The port type is unknown. 0x505 1285 0x98110505 ROUTERERR_NOTINITIALIZED The router is not initialized. 0x506 1286 0x98110506 ROUTERERR_PORTALREADYINUSE The port number is already assigned. 0x507 1287 0x98110507 ROUTERERR_NOTREGISTERED The port is not registered. 0x508 1288 0x98110508 ROUTERERR_NOMOREQUEUES The maximum number of ports has been reached. 0x509 1289 0x98110509 ROUTERERR_INVALIDPORT The port is invalid. 0x50A 1290 0x9811050A ROUTERERR_NOTACTIVATED The router is not active. 0x50B 1291 0x9811050B ROUTERERR_FRAGMENTBOXFULL The mailbox has reached the maximum number for fragmented messages. 0x50C 1292 0x9811050C ROUTERERR_FRAGMENTTIMEOUT A fragment timeout has occurred. 0x50D 1293 0x9811050D ROUTERERR_TOBEREMOVED The port is removed. General ADS error codes TE1000 Version: 1.14.2 223
## Page 224

Error Codes Hex Dec HRESULT Name Description 0x700 1792 0x98110700 ADSERR_DEVICE_ERROR General device error. 0x701 1793 0x98110701 ADSERR_DEVICE_SRVNOTSUPP Service is not supported by the server. 0x702 1794 0x98110702 ADSERR_DEVICE_INVALIDGRP Invalid index group. 0x703 1795 0x98110703 ADSERR_DEVICE_INVALIDOFFSET Invalid index offset. 0x704 1796 0x98110704 ADSERR_DEVICE_INVALIDACCESS Reading or writing not permitted. Several causes are possible. For example, an incorrect password was entered when creating routes. 0x705 1797 0x98110705 ADSERR_DEVICE_INVALIDSIZE Parameter size not correct. 0x706 1798 0x98110706 ADSERR_DEVICE_INVALIDDATA Invalid data values. 0x707 1799 0x98110707 ADSERR_DEVICE_NOTREADY Device is not ready to operate. 0x708 1800 0x98110708 ADSERR_DEVICE_BUSY Device is busy. 0x709 1801 0x98110709 ADSERR_DEVICE_INVALIDCONTEXT Invalid operating system context. This can result from use of ADS blocks in different tasks. It may be possible to resolve this through multitasking synchronization in the PLC. 0x70A 1802 0x9811070A ADSERR_DEVICE_NOMEMORY Insufficient memory. 0x70B 1803 0x9811070B ADSERR_DEVICE_INVALIDPARM Invalid parameter values. 0x70C 1804 0x9811070C ADSERR_DEVICE_NOTFOUND Not found (files, ...). 0x70D 1805 0x9811070D ADSERR_DEVICE_SYNTAX Syntax error in file or command. 0x70E 1806 0x9811070E ADSERR_DEVICE_INCOMPATIBLE Objects do not match. 0x70F 1807 0x9811070F ADSERR_DEVICE_EXISTS Object already exists. 0x710 1808 0x98110710 ADSERR_DEVICE_SYMBOLNOTFOUND Symbol not found. 0x711 1809 0x98110711 ADSERR_DEVICE_SYMBOLVERSIONINVALID Invalid symbol version. This can occur due to an online change. Create a new handle. 0x712 1810 0x98110712 ADSERR_DEVICE_INVALIDSTATE Device (server) is in invalid state. 0x713 1811 0x98110713 ADSERR_DEVICE_TRANSMODENOTSUPP Ads Trans Mode not supported. 0x714 1812 0x98110714 ADSERR_DEVICE_NOTIFYHNDINVALID Notification handle is invalid. 0x715 1813 0x98110715 ADSERR_DEVICE_CLIENTUNKNOWN Notification client not registered. 0x716 1814 0x98110716 ADSERR_DEVICE_NOMOREHDLS No further handle available. 0x717 1815 0x98110717 ADSERR_DEVICE_INVALIDWATCHSIZE Notification size too large. 0x718 1816 0x98110718 ADSERR_DEVICE_NOTINIT Device not initialized. 0x719 1817 0x98110719 ADSERR_DEVICE_TIMEOUT Device has a timeout. 0x71A 1818 0x9811071A ADSERR_DEVICE_NOINTERFACE Interface query failed. 0x71B 1819 0x9811071B ADSERR_DEVICE_INVALIDINTERFACE Wrong interface requested. 0x71C 1820 0x9811071C ADSERR_DEVICE_INVALIDCLSID Class ID is invalid. 0x71D 1821 0x9811071D ADSERR_DEVICE_INVALIDOBJID Object ID is invalid. 0x71E 1822 0x9811071E ADSERR_DEVICE_PENDING Request pending. 0x71F 1823 0x9811071F ADSERR_DEVICE_ABORTED Request is aborted. 0x720 1824 0x98110720 ADSERR_DEVICE_WARNING Signal warning. 0x721 1825 0x98110721 ADSERR_DEVICE_INVALIDARRAYIDX Invalid array index. 0x722 1826 0x98110722 ADSERR_DEVICE_SYMBOLNOTACTIVE Symbol not active. 0x723 1827 0x98110723 ADSERR_DEVICE_ACCESSDENIED Access denied. Several causes are possible. For example, a unidirectional ADS route is used in the opposite direction. 0x724 1828 0x98110724 ADSERR_DEVICE_LICENSENOTFOUND Missing license. 0x725 1829 0x98110725 ADSERR_DEVICE_LICENSEEXPIRED License expired. 0x726 1830 0x98110726 ADSERR_DEVICE_LICENSEEXCEEDED License exceeded. 0x727 1831 0x98110727 ADSERR_DEVICE_LICENSEINVALID Invalid license. 0x728 1832 0x98110728 ADSERR_DEVICE_LICENSESYSTEMID License problem: System ID is invalid. 0x729 1833 0x98110729 ADSERR_DEVICE_LICENSENOTIMELIMIT License not limited in time. 0x72A 1834 0x9811072A ADSERR_DEVICE_LICENSEFUTUREISSUE Licensing problem: time in the future. 0x72B 1835 0x9811072B ADSERR_DEVICE_LICENSETIMETOLONG License period too long. 0x72C 1836 0x9811072C ADSERR_DEVICE_EXCEPTION Exception at system startup. 0x72D 1837 0x9811072D ADSERR_DEVICE_LICENSEDUPLICATED License file read twice. 0x72E 1838 0x9811072E ADSERR_DEVICE_SIGNATUREINVALID Invalid signature. 0x72F 1839 0x9811072F ADSERR_DEVICE_CERTIFICATEINVALID Invalid certificate. 0x730 1840 0x98110730 ADSERR_DEVICE_LICENSEOEMNOTFOUND Public key not known from OEM. 0x731 1841 0x98110731 ADSERR_DEVICE_LICENSERESTRICTED License not valid for this system ID. 224 Version: 1.14.2 TE1000
## Page 225

Error Codes Hex Dec HRESULT Name Description 0x732 1842 0x98110732 ADSERR_DEVICE_LICENSEDEMODENIED Demo license prohibited. 0x733 1843 0x98110733 ADSERR_DEVICE_INVALIDFNCID Invalid function ID. 0x734 1844 0x98110734 ADSERR_DEVICE_OUTOFRANGE Outside the valid range. 0x735 1845 0x98110735 ADSERR_DEVICE_INVALIDALIGNMENT Invalid alignment. 0x736 1846 0x98110736 ADSERR_DEVICE_LICENSEPLATFORM Invalid platform level. 0x737 1847 0x98110737 ADSERR_DEVICE_FORWARD_PL Context  forward to passive level. 0x738 1848 0x98110738 ADSERR_DEVICE_FORWARD_DL Context  forward to dispatch level. 0x739 1849 0x98110739 ADSERR_DEVICE_FORWARD_RT Context  forward to real-time. 0x740 1856 0x98110740 ADSERR_CLIENT_ERROR Client error. 0x741 1857 0x98110741 ADSERR_CLIENT_INVALIDPARM Service contains an invalid parameter. 0x742 1858 0x98110742 ADSERR_CLIENT_LISTEMPTY Polling list is empty. 0x743 1859 0x98110743 ADSERR_CLIENT_VARUSED Var connection already in use. 0x744 1860 0x98110744 ADSERR_CLIENT_DUPLINVOKEID The called ID is already in use. 0x745 1861 0x98110745 ADSERR_CLIENT_SYNCTIMEOUT Timeout has occurred  the remote terminal is not responding in the specified ADS timeout. The route setting of the remote terminal may be configured incorrectly. 0x746 1862 0x98110746 ADSERR_CLIENT_W32ERROR Error in Win32 subsystem. 0x747 1863 0x98110747 ADSERR_CLIENT_TIMEOUTINVALID Invalid client timeout value. 0x748 1864 0x98110748 ADSERR_CLIENT_PORTNOTOPEN Port not open. 0x749 1865 0x98110749 ADSERR_CLIENT_NOAMSADDR No AMS address. 0x750 1872 0x98110750 ADSERR_CLIENT_SYNCINTERNAL Internal error in Ads sync. 0x751 1873 0x98110751 ADSERR_CLIENT_ADDHASH Hash table overflow. 0x752 1874 0x98110752 ADSERR_CLIENT_REMOVEHASH Key not found in the table. 0x753 1875 0x98110753 ADSERR_CLIENT_NOMORESYM No symbols in the cache. 0x754 1876 0x98110754 ADSERR_CLIENT_SYNCRESINVALID Invalid response received. 0x755 1877 0x98110755 ADSERR_CLIENT_SYNCPORTLOCKED Sync Port is locked. 0x756 1878 0x98110756 ADSERR_CLIENT_REQUESTCANCELLED The request was canceled. RTime error codes Hex Dec HRESULT Name Description 0x1000 4096 0x98111000 RTERR_INTERNAL Internal error in the real-time system. 0x1001 4097 0x98111001 RTERR_BADTIMERPERIODS Timer value is not valid. 0x1002 4098 0x98111002 RTERR_INVALIDTASKPTR Task pointer has the invalid value 0 (zero). 0x1003 4099 0x98111003 RTERR_INVALIDSTACKPTR Stack pointer has the invalid value 0 (zero). 0x1004 4100 0x98111004 RTERR_PRIOEXISTS The request task priority is already assigned. 0x1005 4101 0x98111005 RTERR_NOMORETCB No free TCB (Task Control Block) available. The maximum number of TCBs is 64. 0x1006 4102 0x98111006 RTERR_NOMORESEMAS No free semaphores available. The maximum number of semaphores is 64. 0x1007 4103 0x98111007 RTERR_NOMOREQUEUES No free space available in the queue. The maximum number of positions in the queue is 64. 0x100D 4109 0x9811100D RTERR_EXTIRQALREADYDEF An external synchronization interrupt is already applied. 0x100E 4110 0x9811100E RTERR_EXTIRQNOTDEF No external sync interrupt applied. 0x100F 4111 0x9811100F RTERR_EXTIRQINSTALLFAILED Application of the external synchronization interrupt has failed. 0x1010 4112 0x98111010 RTERR_IRQLNOTLESSOREQUAL Call of a service function in the wrong context 0x1017 4119 0x98111017 RTERR_VMXNOTSUPPORTED Intel VT-x extension is not supported. 0x1018 4120 0x98111018 RTERR_VMXDISABLED Intel VT-x extension is not enabled in the BIOS. 0x1019 4121 0x98111019 RTERR_VMXCONTROLSMISSING Missing function in Intel VT-x extension. 0x101A 4122 0x9811101A RTERR_VMXENABLEFAILS Activation of Intel VT-x fails. Specific positive HRESULT Return Codes: TE1000 Version: 1.14.2 225
## Page 226

Error Codes HRESULT Name Description 0x0000_0000 S_OK No error. 0x0000_0001 S_FALSE No error. Example: successful processing, but with a negative or incomplete result. 0x0000_0203 S_PENDING No error. Example: successful processing, but no result is available yet. 0x0000_0256 S_WATCHDOG_TIMEOUT No error. Example: successful processing, but a timeout occurred. TCP Winsock error codes Hex Dec Name Description 0x274C 10060 WSAETIMEDOUT A connection timeout has occurred - error while establishing the connection, because the remote terminal did not respond properly after a certain period of time, or the established connection could not be maintained because the connected host did not respond. 0x274D 10061 WSAECONNREFUSED Connection refused - no connection could be established because the target computer has explicitly rejected it. This error usually results from an attempt to connect to a service that is inactive on the external host, that is, a service for which no server application is running. 0x2751 10065 WSAEHOSTUNREACH No route to host - a socket operation referred to an unavailable host. More Winsock error codes: Win32 error codes 226 Version: 1.14.2 TE1000
## Page 227

Support and Service 8 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services:  support  design, programming and commissioning of complex automation systems  and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service:  on-site service  repair service  spare parts service  hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TE1000 Version: 1.14.2 227
## Page 229

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hlshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
