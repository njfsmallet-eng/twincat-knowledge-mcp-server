---
title: "TF5120_TC3_Robotics_mxAutomation_EN"
product: "TF5120"
category: "Motion_Control"
tags: ["AUTOMATION", "ROBOTICS"]
language: "EN"
document_type: "Manual"
version: "2.0.0"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5120_TC3_Robotics_mxAutomation_EN.pdf"
release_date: "2023-04-17"
---
Manual | EN TF5120 Twin CAT 3 | Robotics mx Automation 2023-04-17 | Version: 2.0.0
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 7 1.1 Notes on the documentation............................................................................................................. 7 1.2 Safety instructions............................................................................................................................. 8 1.3 Notes on information security............................................................................................................ 9 2 Introduction............................................................................................................................................. 10 2.1 Target group.................................................................................................................................... 10 2.2 Industrial robot documentation........................................................................................................ 10 2.3 Terms used..................................................................................................................................... 10 3 Product description................................................................................................................................ 12 3.1 Overview......................................................................................................................................... 12 3.2 Intended use and misuse................................................................................................................ 12 4 Safety....................................................................................................................................................... 13 5 Installation............................................................................................................................................... 14 5.1 System requirements...................................................................................................................... 14 6 Programming........................................................................................................................................... 16 6.1 Frequently used input/output signals in the MC function blocks..................................................... 16 6.1.1 Input signals..................................................................................................................... 16 6.1.2 Output signals.................................................................................................................. 17 6.1.3 Signal sequence for execution of Execute....................................................................... 17 6.2 Structures for motion programming (STRUCT)............................................................................... 18 6.3 Data of a Cartesian workspace....................................................................................................... 21 6.4 Data of an axis-specific workspace................................................................................................. 22 6.5 Programming tips for Tc3_mx Automation....................................................................................... 23 6.5.1 Structure of a PLC program............................................................................................. 23 6.5.2 Stopping the robot............................................................................................................ 23 6.6 Frequently used input/output signals in the KRC function blocks................................................... 24 6.6.1 Input signals..................................................................................................................... 24 6.6.2 Output signals.................................................................................................................. 24 6.6.3 Signal sequence for execution of Execute Cmd............................................................... 25 7 Function blocks....................................................................................................................................... 27 7.1 Overview of function blocks............................................................................................................ 27 7.2 Functions for motion programming................................................................................................. 30 7.2.1 Approaching an absolute Cartesian position with a linear motion.................................... 30 7.2.2 Approaching a relative Cartesian position with a linear motion........................................ 32 7.2.3 Approaching an absolute Cartesian position as quickly as possible................................ 34 7.2.4 Approaching a relative Cartesian position as quickly as possible.................................... 35 7.2.5 Approaching an axis-specific position as quickly as possible.......................................... 37 7.2.6 Approaching an absolute Cartesian position with a circular motion................................. 38 7.2.7 Approaching a relative Cartesian position with a circular motion..................................... 40 7.2.8 Jogging to an end position............................................................................................... 42 7.2.9 Jogging to a relative end position in the TOOL coordinate system with a linear motion.. 45 7.2.10 Jogging to a relative Cartesian position with a linear motion........................................... 46 7.2.11 Jogging to the end position (advanced)........................................................................... 47 TF5120 Version: 2.0.0 3
## Page 4

Table of contents 7.3 Functions for motion programming (PLC OPEN-compliant)........................................................... 50 7.3.1 Approaching an absolute Cartesian position with a linear motion.................................... 50 7.3.2 Approaching a relative Cartesian position with a linear motion........................................ 52 7.3.3 Approaching an absolute Cartesian position as quickly as possible................................ 53 7.3.4 Approaching a relative Cartesian position as quickly as possible.................................... 55 7.3.5 Approaching an axis-specific position as quickly as possible.......................................... 56 7.3.6 Approaching an absolute Cartesian position with a circular motion................................. 58 7.3.7 Approaching a relative Cartesian position with a circular motion..................................... 60 7.4 Functions for program execution control......................................................................................... 62 7.4.1 Canceling a program........................................................................................................ 62 7.4.2 Canceling a program (advanced)..................................................................................... 63 7.4.3 Pausing robot motion....................................................................................................... 64 7.4.4 Continuing a program....................................................................................................... 64 7.4.5 Waiting for a digital input.................................................................................................. 65 7.5 Functions for interrupt programming............................................................................................... 66 7.5.1 Declaring interrupts.......................................................................................................... 66 7.5.2 Activating interrupts.......................................................................................................... 67 7.5.3 Deactivating interrupts..................................................................................................... 68 7.5.4 Reading the state of an interrupt...................................................................................... 69 7.6 Functions for path-related switching actions................................................................................... 70 7.6.1 Activating a switching action for path points.................................................................... 70 7.6.2 Activating a path-related switching action........................................................................ 71 7.7 Diagnostic functions........................................................................................................................ 73 7.7.1 Reading and acknowledging error states......................................................................... 73 7.7.2 Reading the current state of the mx A interface................................................................ 74 7.7.3 Reading error messages of the mx A interface................................................................. 75 7.7.4 Resetting error messages of the mx A interface............................................................... 76 7.7.5 Reading error messages of the robot controller............................................................... 76 7.7.6 Reading diagnostic signals.............................................................................................. 77 7.8 General special functions................................................................................................................ 79 7.8.1 Reading system variables................................................................................................ 79 7.8.2 Writing system variables.................................................................................................. 80 7.8.3 Calling a brake test.......................................................................................................... 82 7.8.4 Calling a mastering test.................................................................................................... 83 7.8.5 Reading the safety controller signals............................................................................... 85 7.8.6 Reading the state of the Touch Up status keys................................................................ 86 7.8.7 Teaching points................................................................................................................ 86 7.8.8 Modifying settings for the advance run............................................................................ 87 7.8.9 Reading settings for the advance run.............................................................................. 88 7.8.10 Calculating the Cartesian robot position from the axis angles......................................... 89 7.8.11 Calculating the Cartesian robot position from the axis angles (advanced)...................... 90 7.8.12 Calculating axis angles from the Cartesian robot position............................................... 91 7.8.13 Calculating axis angles from the Cartesian robot position (advanced)............................ 92 7.8.14 Executing KRL programs................................................................................................. 93 7.8.15 Executing KRL programs (advanced).............................................................................. 94 7.8.16 Displaying the current robot position in a different coordinate system............................. 95 4 Version: 2.0.0 TF5120
## Page 5

Table of contents 7.9 Special functions for Conveyor....................................................................................................... 96 7.9.1 Initializing a conveyor....................................................................................................... 96 7.9.2 Activating a conveyor....................................................................................................... 97 7.9.3 Tracking a workpiece on the conveyor............................................................................. 98 7.9.4 Picking up a workpiece from the conveyor....................................................................... 99 7.9.5 Deleting a workpiece on the conveyor........................................................................... 100 7.9.6 Activating interrupts for monitoring................................................................................. 101 7.9.7 Deactivating interrupts for monitoring............................................................................ 102 7.10 Special functions for Vector Move.................................................................................................. 103 7.10.1 Activating a motion along a vector................................................................................. 103 7.10.2 Deactivating motion along a vector................................................................................ 104 7.11 Special functions for Load Data Determination............................................................................... 105 7.11.1 Configuring load data determination.............................................................................. 105 7.11.2 Checking the start position of the load data determination............................................ 106 7.11.3 Carrying out a test run before load data determination.................................................. 107 7.11.4 Carrying out load data determination............................................................................. 108 7.11.5 Assigning the load data.................................................................................................. 108 7.12 Special functions for workspaces.................................................................................................. 109 7.12.1 Configuring Cartesian workspaces................................................................................ 109 7.12.2 Reading the configuration of Cartesian workspaces...................................................... 110 7.12.3 Configuring axis-specific workspaces............................................................................ 111 7.12.4 Reading the configuration of axis-specific workspaces.................................................. 112 7.12.5 Reading the status of the workspaces........................................................................... 113 7.13 Administrative functions................................................................................................................ 114 7.13.1 Reading outputs of the robot system............................................................................. 114 7.13.2 Writing robot system inputs............................................................................................ 115 7.13.3 Initializing the mx A interface.......................................................................................... 115 7.13.4 Setting the program override (POV)............................................................................... 116 7.13.5 Activating and reading Automatic External signals from the robot controller................. 117 7.13.6 Setting KRC_Automatic External inputs automatically.................................................... 119 7.13.7 Reading the current robot position................................................................................. 120 7.13.8 Reading the current axis position................................................................................... 121 7.13.9 Reading the current path velocity................................................................................... 122 7.13.10 Reading the current axis velocity................................................................................... 123 7.13.11 Reading the current robot acceleration.......................................................................... 124 7.13.12 Reading a digital input.................................................................................................... 125 7.13.13 Reading digital inputs 1 to 8........................................................................................... 125 7.13.14 Reading multiple digital inputs....................................................................................... 126 7.13.15 Reading a digital output................................................................................................. 127 7.13.16 Writing a digital output.................................................................................................... 127 7.13.17 Writing digital outputs 1 to 8........................................................................................... 128 7.13.18 Reading an analog input................................................................................................ 129 7.13.19 Reading an analog output.............................................................................................. 130 7.13.20 Writing an analog output................................................................................................ 130 7.13.21 Selecting the tool, base and interpolation mode............................................................ 131 7.13.22 Reading TOOL data....................................................................................................... 132 TF5120 Version: 2.0.0 5
## Page 6

Table of contents 7.13.23 Writing TOOL data......................................................................................................... 133 7.13.24 Reading BASE data....................................................................................................... 134 7.13.25 Writing BASE data......................................................................................................... 134 7.13.26 Reading the load data.................................................................................................... 135 7.13.27 Writing load data............................................................................................................ 136 7.13.28 Reading the software limit switches of the robot axes................................................... 138 7.13.29 Reading the software limit switches of the external axes............................................... 138 7.13.30 Writing the software limit switches of the robot axes..................................................... 139 7.13.31 Writing the software limit switches of the external axes................................................. 140 8 Messages............................................................................................................................................... 142 8.1 Error messages of the mx A interface in the robot interpreter....................................................... 142 8.2 Error messages of the mx A interface in the submit interpreter..................................................... 145 8.3 Errors in the function block............................................................................................................ 150 8.4 Pro Con OS errors.......................................................................................................................... 156 6 Version: 2.0.0 TF5120
## Page 7

Foreword 1 Foreword 1.1 Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT Technology is covered, including but not limited to the following patent applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilization of this document as well as the communication of its contents to others without express authorization are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5120 Version: 2.0.0 7
## Page 8

Foreword 1.2 Safety instructions Safety regulations Please note the following safety instructions and explanations! Product-specific safety instructions can be found on following pages or in the areas mounting, wiring, commissioning etc. Exclusion of liability All the components are supplied in particular hardware and software configurations appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation and drive engineering who are familiar with the applicable national standards. Description of symbols In this documentation the following symbols are used with an accompanying safety instruction or note. The safety instructions must be read carefully and followed without fail! DANGER Serious risk of injury! Failure to follow the safety instructions associated with this symbol directly endangers the life and health of persons. WARNING Risk of injury! Failure to follow the safety instructions associated with this symbol endangers the life and health of persons. CAUTION Personal injuries! Failure to follow the safety instructions associated with this symbol can lead to injuries to persons. NOTE Damage to the environment or devices Failure to follow the instructions associated with this symbol can lead to damage to the environment or equipment. Tip or pointer This symbol indicates information that contributes to better understanding. 8 Version: 2.0.0 TF5120
## Page 9

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF5120 Version: 2.0.0 9
## Page 10

Introduction 2 Introduction 2.1 Target group This documentation is aimed at users with the following knowledge and skills: • Knowledge of the robot controller system • Advanced PLC programming skills • Advanced knowledge of field bus interfaces For optimal use of KUKA products, KUKA recommends that customers should take part in a course of training at KUKA College. Information about the training program can be found at www.kuka.com or can be obtained directly from the KUKA subsidiaries. 2.2 Industrial robot documentation To be taken from the KUKA Documentation. 2.3 Terms used Term Description Axis group Group of robot axes and additional axes which together form a robot system (e.g. a robot with 6 axes and 1 additional axis) FIFO First In First Out Procedure with which a data memory is processed Those elements that were stored first will be retrieved first from the memory. KR C KUKA Robot Control KRL KUKA Robot Language KUKA smart HMI See "smart HMI KUKA smart PAD See "smart PAD mx A interface Option package KUKA. PLC mx Automation on the robot controller with a communication interface to the PLC NULLFRAME Cartesian coordinate system where all coordinates have the value null Ether CAT Ethernet-based fieldbus (Ethernet interface) Robot interpreter Synchronously operating process in which the current robot program is processed BCO run The robot is moved to the coordinates of the motion block where the block pointer is located. This allows the robot position be brought to match the coordinates of the current point. smart HMI smart Human-Machine Interface User interface on the smart PAD smart PAD Handheld programming device for robot control The smart PAD has all the operating and display options required for operating and programming the industrial robot. There are 2 models: • smart PAD • smart PAD-2 There are variants of each model, e.g. with different lengths of connection cables. 10 Version: 2.0.0 TF5120
## Page 11

Introduction Term Description The designation "KUKA smart PAD" or "smart PAD" refers to both models unless they are explicitly distinguished. PLC Programmable Logic Controller Is used in systems as a higher-level master module in the bus system. Submit interpreter Cyclically running logic program that runs in parallel to the motion program on the robot controller Work Visual Engineering environment for KR C-controlled robot cells TF5120 Version: 2.0.0 11
## Page 12

Product description 3 Product description 3.1 Overview The Twin CAT library contains function blocks for programming automation tasks with Twin CAT 3. Communication The EL6695-1001 terminal from KUKA is provided for data exchange between the PLC and the robot controller. Work Visual The following software is required to configure the fieldbuses and to connect the fieldbus signals: • Work Visual 3.2 Intended use and misuse Use TF5120 Twin CAT 3 mx Automation may only be operated under the specified system requirements [} 14]: Any other use or use beyond this is considered misuse and is not permitted. The manufacturer will not be liable for any resulting damages. The risk is borne solely by the operator. Intended use also includes observing the commissioning and configuration instructions in this documentation. Misuse All applications deviating from the intended use are considered as misuse and are not permitted. These include, for example: • Misconfiguration (deviating from this documentation). As a result, the robot may perform actions other than those planned by the PLC programmer. • Use in a programming environment other than Twin CAT 3.1.4020.14 or higher. 12 Version: 2.0.0 TF5120
## Page 13

Safety 4 Safety This documentation contains safety instructions that relate specifically to the software described here. DANGER Observe safety-relevant information • Safe use of this product requires knowledge of and compliance with basic safety measures. Death, serious injury or property damage may otherwise result. • When reading other documentation, also familiarize yourself with the safety symbols used in it and with the meaning of these safety symbols. Carefully observe safety symbols and safety instructions within other documentation as well. DANGER The chapter "Safety" in the operating and programming instructions of the KUKA System Software (KSS) must be observed. Death of persons, serious injuries or considerable damage to property can otherwise be the result. TF5120 Version: 2.0.0 13
## Page 14

Installation 5 Installation 5.1 System requirements Hardware Robot controller: • KR C4 • KR C4 compact • KR C5 • KR C5 micro Ether CAT • EL6695-1001 (sales, support and service are provided by KUKA) External PLC: • Beckhoff Twin CAT 3 controller Software Robot controller: • KUKA System Software 8.3, KUKA System Software 8.5, KUKA System Software 8.6 or KUKA System Software 8.7 The following KRL resources must be free: KRL resource Number I/Os 2049 … 4 080 Interrupts Index[90 … 97] KR C4 robot controller: Library Tc3_mx Automation Library Tc3_mx Automation V3_0 Library Tc3_mx Automation V3_1 for KSS 8.3 for KSS 8.5 for KSS 8.6 KUKA. PLC Pro Con OS 4-1 4.1 KUKA. PLC Pro Con OS 4-1 5.0 KUKA. PLC Pro Con OS 4-1 5.0 Option with Conveyor Tech: Option with Conveyor Tech: Option with Conveyor Tech: • KUKA. Conveyor Tech 6.0 • KUKA. Conveyor Tech 7.0 • KUKA. Conveyor Tech 8.0 Option with Vector Move: Option with Vector Move: Option with Vector Move: • KUKA. Vector Move 1.0 • KUKA. Vector Move 2.0 • KUKA. Vector Move 2.0 Standard laptop/PC: Standard laptop/PC: Standard laptop/PC: • Work Visual 4.0 • Work Visual 5.0 • Work Visual 6.0 Twin CAT 4020.14 or higher Twin CAT 4022.27 or higher Twin CAT 4024.11 or higher KR C5 robot controller: Library Tc3_mx Automation V3_2 for KSS8.7 KUKA. PLC Pro Con OS 4-1 6.0 Option with Conveyor Tech: • KUKA. Conveyor Tech 8.1 Option with Vector Move: • KUKA. Vector Move 2.0 Standard laptop/PC: 14 Version: 2.0.0 TF5120
## Page 15

Installation Library Tc3_mx Automation V3_2 for KSS8.7 • Work Visual 6.0 Twin CAT 4024.17 or higher KR C4 or KR C5 robot controller: Library Tc3_mx Automation V3_3 for KR C5 with KSS8.7 for KR C4 with KSS8.6 KUKA. PLC Pro Con OS 4-1 6.0 KUKA. PLC Pro Con OS 4-1 5.0 Option with Conveyor Tech: Option with Conveyor Tech: • KUKA. Conveyor Tech 8.1 • KUKA. Conveyor Tech 8.0 Option with Vector Move: • KUKA. Vector Move 2.0 Standard laptop/PC: • Work Visual 6.0 Option with Load Data Determination: • KUKA. Load Data Determination 7.2 Twin CAT 3.1.4024.40 or higher Industrial PC/Embedded PC: • Twin CAT 3.1.4020.14 or higher, depending on the required mx Automation version TF5120 Version: 2.0.0 15
## Page 16

Programming 6 Programming 6.1 Frequently used input/output signals in the MC function blocks The MC function blocks differ from the KRC function blocks in that they correspond to the PLC OPEN standard or are closer to it. The behavior of the Busy signal output in particular is different for the MC function blocks. Here, the Com Acpt signal output must be used for linking function blocks. 6.1.1 Input signals Axis Group Idx This signal input is used to set the number of the robot addressed by a function block. Execute If this signal is set, mx Automation transfers the associated function block to the robot. The function block is stored in a statement buffer by the robot, provided there is still sufficient space in the buffer. If the Execute input is reset, mx Automation deletes the function block from the buffer again unless execution of the statement has already begun. Queue Mode Mode in which an instruction is executed on the robot controller Value Name Description 0 DIRECT Instruction is executed directly by the Submit interpreter (Submit program). This mode is not available for some function blocks. 1 ABORTING Instruction is executed immediately by the Robot interpreter (main program). Before that, all active movements and buffered instructions are aborted and the robot is completely decelerated. 2 BUFFERED Instruction is buffered. Buffered instructions are processed by the Robot interpreter (main program) according to the FIFO principle. Circ Type Orientation control for circular motion Value Name Description 0 BASE Basic orientation control during a circular motion 1 PATH Path-related orientation control during a circular motion Ori Type Orientation control for the TCP Value Name Description 0 VAR The orientation of the TCP changes continuously during the movement. 1 CONSTANT The orientation of the TCP remains constant during the movement. 2 JOINT The orientation of the TCP changes continuously during the movement, but not quite uniformly. This is done by linear transfer (axis-specific method) of the manual axis angles. 16 Version: 2.0.0 TF5120
## Page 17

Programming Value Name Description This orientation type is not suitable if a certain course of the orientation must be held exactly. 6.1.2 Output signals Com Busy This signal output indicates that the associated function block has been sent from the PLC to the robot's instruction buffer and transferred correctly. Com Acpt This signal output indicates that the associated function block has been sent from the PLC to the robot's instruction buffer and transferred correctly. This signal output is identical to the Done signal output of the KRC function blocks. It is recommended to use this signal output for the contouring of movements. Busy This signal output indicates that execution of the associated function block has begun. However, it is possible that the function block has not yet been transferred to the robot's instruction buffer. This distinguishes this signal output from the Busy signal output of the KRC function blocks. Active This signal output indicates that the associated function block is currently being executed on the robot. It is reset when the Execute input is reset. Error This signal output indicates that an error has occurred during the execution of the associated function block on the robot. In this case, the Error ID signal output contains an error number. It is reset when the Execute input is reset. Error ID This signal output contains an error number. The errors and error causes associated with the error number are described here: (>>> Messages [} 142]) Command Aborted This signal output indicates that the execution of an instruction or movement was aborted. 6.1.3 Signal sequence for execution of Execute Example The signal curve is shown for the following case: • An instruction was transferred via Execute and successfully executed. TF5120 Version: 2.0.0 17
## Page 18

Programming Signal curve - Execute successful Pos. Description 1 The function block is transferred to the robot (= request to execute instruction). 2 The instruction has been transferred (= is in the instruction buffer of the robot). The Com Acpt and Com Busy outputs are set. 3 The instruction is currently executed. 4 The instruction was completed successfully. Neither an error occurred nor was the instruction aborted, e.g. by KRC_Abort. In case of an error, the Error signal would be set instead of the Done signal, and in case of an abort, the Aborted signal would be set instead of the Done signal. 5 When the Execute input is reset, the outputs are also reset. 6.2 Structures for motion programming (STRUCT) Predefined data structures (STRUCT) can be used in the PLC library. Overview Structure Description APO Contour parameters for a Move motion command (>>> APO [} 19]) COORDSYS Coordinate system to which the Cartesian coordinates of the target position refer during a Move or Jog motion command. (>>> COORDSYS [} 19]) E6AXIS Angle or translation values of the axes of an axis group for a Move Axis motion command (>>> E6AXIS [} 20]) E6POS Cartesian coordinates of the target position for a Move or Jog motion command (>>> E6POS [} 20]) FRAME Spatial coordinates and orientation for the TOOL or BASE coordinate system 18 Version: 2.0.0 TF5120
## Page 19

Programming Structure Description (>>> FRAME [} 21]) POSITION Contains all positions as well as the coordinate system to which a point refers. (>>> POSITION [} 21]) POSITION_ARRAY Field from 100 positions of structure type POSITION (>>> POSITION_ARRAY [} 21]) APO Element Type Description PTP_MODE INT Specifies whether and how the end point of a PTP movement is contoured. • 0: Without contouring (default) • 1: Causes the end point to be contoured. For PTP-PTP contouring, the specification C_PTP is sufficient. During PTP-CP contouring, i.e. if a LIN or CIRC block follows after the contoured PTP block, another contour parameter must be specified. • 2: PTP CP contouring with distance parameters • 3: PTP CP contouring with orientation parameters • 4: PTP CP contouring with velocity parameters CP_MODE INT Specifies whether and how the end point of a CP movement (LIN, CIRC) is contoured. • 0: Without contouring (default) • 1: Contouring with distance parameters • 2: Contouring with orientation parameter • 3: Contouring with velocity parameters CPTP INT Contouring distance for PTP movements (= distance before the end point at which contouring starts at the earliest). • 1 … 100 % Maximum distance 100%: half the distance between the end point and the target point, referred to the contour of the PTP movement without contouring. CDIS REAL Distance parameter (unit: mm) The contouring starts at the earliest when the distance to the end point falls below the value specified here. CORI REAL Orientation parameter (unit: °) Contouring starts at the earliest when the dominant orientation angle (turning or tilting the longitudinal axis of the tool) falls below the angular distance to the end point specified here. CVEL INT Velocity parameter • 1 … 100 % The contour parameter specifies at what percentage of the programmed velocity the contouring starts at the earliest in the deceleration phase towards the end point. COORDSYS Element Type Description Tool INT TOOL coordinate system number • -1: Coordinate system is not changed TF5120 Version: 2.0.0 19
## Page 20

Programming Element Type Description • 0: NULLFRAME • 1 … 16: TOOL_DATA[1 … 16] Default: -1 Base INT Number of the BASE coordinate system • -1: Coordinate system is not changed • 0: NULLFRAME • 1 … 32: BASE_DATA[1 … 32] Default: -1 IPO_MODE INT Interpolation mode • 0: The tool is mounted on the mounting flange. • 1: The tool is a stationary tool. Default: 0 E6AXIS Element Type Description A1 REAL Position of robot axis A1 (unit: mm or °) A2 REAL Position of robot axis A2 (unit: mm or °) A3 REAL Position of robot axis A3 (unit: mm or °) A4 REAL Position of robot axis A4 (unit: mm or °) A5 REAL Position of robot axis A5 (unit: mm or °) A6 REAL Position of robot axis A6 (unit: mm or °) E1 REAL Position of additional axis E1 (optional), (unit: mm or °) E2 REAL Position of additional axis E2 (optional), (unit: mm or °) E3 REAL Position of additional axis E3 (optional), (unit: mm or °) E4 REAL Position of additional axis E4 (optional), (unit: mm or °) E5 REAL Position of additional axis E5 (optional), (unit: mm or °) E6 REAL Position of additional axis E6 (optional), (unit: mm or °) E6POS Element Type Description X REAL Position on the X-axis (unit: mm) Y REAL Position on the Y-axis (unit: mm) Z REAL Position on the Z-axis (unit: mm) A REAL Rotation around the Z-axis • -180° … +180° B REAL Rotation around the Y-axis • -180° … +180° C REAL Rotation around the X-axis • -180° … +180° S INT Status The values of position (X, Y, Z) and orientation (A, B, C) of the TCP are not sufficient to unambiguously define the T INT Turn position of a robot, since several axis positions are still possible with the same TCP. Status and Turn are used to define a unique position from several possible axis positions. Further information on status and turn can be found in the operating and programming instructions of the KUKA System Software (KSS). 20 Version: 2.0.0 TF5120
## Page 21

Programming Element Type Description E1 REAL Position of additional axis E1 (optional), (unit: mm or °) E2 REAL Position of additional axis E2 (optional), (unit: mm or °) E3 REAL Position of additional axis E3 (optional), (unit: mm or °) E4 REAL Position of additional axis E4 (optional), (unit: mm or °) E5 REAL Position of additional axis E5 (optional), (unit: mm or °) E6 REAL Position of additional axis E6 (optional), (unit: mm or °) FRAME Element Type Description X REAL Position on the X-axis (unit: mm) Y REAL Position on the Y-axis (unit: mm) Z REAL Position on the Z-axis (unit: mm) A REAL Z-axis orientation • -180° … +180° B REAL Y-axis orientation • -180° … +180° C REAL X-axis orientation • -180° … +180° POSITION Element Description COORDSYS (>>> COORDSYS [} 19]) E6POS (>>> E6POS [} 20]) E6AXIS (>>> E6AXIS [} 20]) POSITION_ARRAY Element Description POSITION • 1 … 100 (>>> POSITION [} 21]) 6.3 Data of a Cartesian workspace Here the data of a Cartesian workspace used in some function blocks are described in advance. Origin and orientation The following elements are used to specify the origin and orientation of a Cartesian workspace. These elements refer to the WORLD coordinate system and are defined in the BOX variable. Element Data type Unit Minimum Maximum X REAL mm - - Y REAL mm - - Z REAL mm - - A REAL ° -180 180 B REAL ° -180 180 C REAL ° -180 180 TF5120 Version: 2.0.0 21
## Page 22

Programming Dimensions The following elements are used to specify the dimensions of a Cartesian workspace. Element Data type Unit X1 REAL mm X2 REAL mm Y1 REAL mm Y2 REAL mm Z1 REAL mm Z2 REAL mm 6.4 Data of an axis-specific workspace The data of an axis-specific workspace used in some function blocks are described in advance here. This data is defined with the following elements in the AXBOX variable. Robot axes Element Data type Unit Description A1_N REAL mm/° Lower limit for axis angle A2_N REAL mm/° A3_N REAL mm/° A4_N REAL mm/° A5_N REAL mm/° A6_N REAL mm/° A1_P REAL mm/° Upper limit for axis angle A2_P REAL mm/° A3_P REAL mm/° A4_P REAL mm/° A5_P REAL mm/° A6_P REAL mm/° Additional axes Element Data type Unit Description E1_N REAL mm/° Lower limit for axis angle E2_N REAL mm/° E3_N REAL mm/° E4_N REAL mm/° E5_N REAL mm/° E6_N REAL mm/° E1_P REAL mm/° Upper limit for axis angle E2_P REAL mm/° E3_P REAL mm/° E4_P REAL mm/° E5_P REAL mm/° E6_P REAL mm/° 22 Version: 2.0.0 TF5120
## Page 23

Programming 6.5 Programming tips for Tc3_mx Automation Instantiation The following function blocks may only be instantiated once per robot. In case of multiple instantiation, the signals of the most recently called function block are output. • KRC_Read Axis Group • KRC_Initialize • KRC_Set Override • KRC_Automatic External • KRC_Auto Start • KRC_Diag • KRC_Write Axis Group All other function blocks used in the mx Automation robot program can be created as a multi-instance call. Execute Cmd • If possible, only set an Execute Cmd input for one function block of the same robot simultaneously. • Do not reset an Execute Cmd input after an activation until the function block confirms the execution of the instruction by the Done signal or indicates by the Error or Aborted signal that the instruction was not executed. If the Execute Cmd input is reset beforehand, it is not reported back whether the instruction was executed. • If the Busy or Com Acpt output of a function block is connected to the Execute Cmd input of the following function block, a sequence of consecutive functions can be transferred to the instruction buffer and executed. Program override If the function block KRC_Automatic External is used, the program override must be set to a value greater than zero. Only then a PLC program can be processed. Contouring Contouring means: the programmed point is not approached exactly. Contouring is an option which can be selected during motion programming. • Contouring is only possible if 2 motion instructions follow each other. • Contouring is only possible if the motion instruction is followed by a motion instruction transmitted in BUFFERED mode. 6.5.1 Structure of a PLC program Each PLC program must contain the following function blocks: 1. KRC_Read Axis Group 2. KRC_Initialize 3. KRC_Write Axis Group Any number of function blocks can be inserted between the KRC_Initialize and KRC_Write Axis Group function blocks, e.g. KRC_Automatic External, KRC_Move Direct Absolute, etc. 6.5.2 Stopping the robot There are 4 ways to stop the robot. These differ in how the movement should be continued: • Stop and abort program processing (RESET input at the KRC_Automatic External function block) TF5120 Version: 2.0.0 23
## Page 24

Programming • Stop and delete the buffered instructions (KRC_Abort) • Stop and wait for a condition, then continue and execute the buffered instructions (KRC_Declare Interrupt) • Stop and wait for the function block KRC_Continue, then continue and execute the buffered instructions (KRC_Interrupt) 6.6 Frequently used input/output signals in the KRC function blocks 6.6.1 Input signals Axis Group Idx The robot system is selected via this signal input. Up to 5 robot systems can be used. A robot system is a grouping of axes into an axis group. Execute Cmd When this signal input is set, mx Automation transfers the associated function block to the robot. The function block is stored by the robot in an instruction buffer, provided that there is still free space in the buffer. If the Execute Cmd input is reset, mx Automation deletes the function block from the buffer again, unless execution of the instruction has already begun. Buffer Mode Mode in which an instruction is executed on the robot controller Value Name Description 0 DIRECT Instruction is executed directly by the Submit interpreter (Submit program). This mode is not available for some function blocks. 1 ABORTING Instruction is executed immediately by the Robot interpreter (main program). Before that, all active movements and buffered instructions are aborted and the robot is completely decelerated. 2 BUFFERED Instruction is buffered. Buffered instructions are processed by the Robot interpreter (main program) according to the FIFO principle. 6.6.2 Output signals Busy This signal output indicates that the associated function block is currently being transferred to the robot's instruction buffer or has already been transferred. It is reset when the Execute Cmd input is reset. Active This signal output indicates that the associated function block is currently being executed on the robot. It is reset when the Execute Cmd input is reset. Done This signal output indicates that the associated function block has been successfully executed by the robot. It is reset when the Execute Cmd input is reset. 24 Version: 2.0.0 TF5120
## Page 25

Programming Error This signal output indicates that an error has occurred during the execution of the associated function block. In this case, the Error ID signal output contains an error number. It is reset when the Execute Cmd input is reset. Error ID This signal output contains an error number. The errors and error causes associated with the error number are described here: (>>> Messages [} 142]) Aborted This signal output is set either when the function block KRC_Abort is executed or when an instruction is executed in ABORTING mode. It is reset when the Execute Cmd input is reset. 6.6.3 Signal sequence for execution of Execute Cmd Example The signal curve is shown for the following case: • An instruction was transferred via Execute Cmd and executed successfully. Signal curve - Execute Cmd successful Pos. Description 1 The function block is transferred to the robot (= request to execute instruction). 2 The instruction is transferred. 3 The instruction is currently executed. 4 The instruction was completed successfully. Neither an error occurred nor was the instruction aborted, e.g. by KRC_Abort. In case of an error, the Error signal would be set instead of the Done signal, and in case of an abort, the Aborted signal would be set instead of the Done signal. 5 When the Execute Cmd input is reset, the outputs are also reset. Variations • Execute Cmd is reset before Done is set. In this case, the instruction is executed, but the Done signal is not set. This means that it is not reported back that the instruction was executed. TF5120 Version: 2.0.0 25
## Page 26

Programming • Execute Cmd is reset before Error or Aborted is set. In this case the instruction is aborted, but the Error or Aborted signal is not set. This means that it is not reported back that the instruction was aborted. • Execute Cmd is reset before Active is set. In this case, the function block is deleted from the robot's instruction buffer. • Execute Cmd is reset before Busy is set. In this case the function block is not transferred to the robot and consequently the instruction is not executed. 26 Version: 2.0.0 TF5120
## Page 27

Function blocks 7 Function blocks 7.1 Overview of function blocks Administrative functions KRC_Read Axis Group (>>> Reading outputs of the robot system [} 114]) KRC_Write Axis Group (>>> Writing robot system inputs [} 115]) KRC_Initialize (>>> Initializing the mx A interface [} 115]) KRC_Set Override (>>> Setting the program override (POV) [} 116]) KRC_Automatic External (>>> Activating and reading Automatic External signals from the robot controller [} 117]) KRC_Auto Start (>>> Setting KRC_Automatic External inputs automatically [} 119]) KRC_Read Actual Position (>>> Reading the current robot position [} 120]) KRC_Read Actual Axis Position (>>> Reading the current axis position [} 121]) KRC_Read Actual Velocity (>>> Reading the current path velocity [} 122]) KRC_Read Actual Axis Velocity (>>> Reading the current axis velocity [} 123]) KRC_Read Actual Acceleration (>>> Reading the current robot acceleration [} 124]) KRC_Read Digital Input (>>> Reading a digital input [} 125]) KRC_Read Digital Input1To8 (>>> Reading digital inputs 1 to 8 [} 125]) KRC_Read Digital Input Array (>>> Reading multiple digital inputs [} 126]) KRC_Read Digital Output (>>> Reading a digital output [} 127]) KRC_Write Digital Output (>>> Writing a digital output [} 127]) KRC_Write Digital Output1To8 (>>> Writing digital outputs 1 to 8 [} 128]) KRC_Read Analog Input (>>> Reading an analog input [} 129]) KRC_Read Analog Output (>>> Reading an analog output [} 130]) KRC_Write Analog Output (>>> Writing an analog output [} 130]) KRC_Set Coord Sys (>>> Selecting the tool, base and interpolation mode [} 131]) KRC_Read Tool Data (>>> Reading TOOL data [} 132]) KRC_Write Tool Data (>>> Writing TOOL data [} 133]) KRC_Read Base Data (>>> Reading BASE data [} 134]) KRC_Write Base Data (>>> Writing BASE data [} 134]) KRC_Read Load Data (>>> Reading the load data [} 135]) KRC_Write Load Data (>>> Writing load data [} 136]) KRC_Read Soft End (>>> Reading the software limit switches of the robot axes [} 138]) KRC_Read Soft End Ext (>>> Reading the software limit switches of the external axes [} 138]) KRC_Write Soft End (>>> Writing the software limit switches of the robot axes [} 139]) KRC_Write Soft End Ext (>>> Writing the software limit switches of the external axes [} 140]) Functions for motion programming KRC_Move Linear Absolute (>>> Approaching an absolute Cartesian position with a linear motion [} 30]) KRC_Move Linear Relative (>>> Approaching a relative Cartesian position with a linear motion [} 32]) KRC_Move Direct Absolute (>>> Approaching an absolute Cartesian position as quickly as possible [} 34]) TF5120 Version: 2.0.0 27
## Page 28

Function blocks Functions for motion programming KRC_Move Direct Relative (>>> Approaching a relative Cartesian position as quickly as possible [} 35]) KRC_Move Axis Absolute (>>> Approaching an axis-specific position as quickly as possible [} 37]) KRC_Move Circ Absolute (>>> Approaching an absolute Cartesian position with a circular motion [} 38]) KRC_Move Circ Relative (>>> Approaching a relative Cartesian position with a circular motion [} 40]) KRC_Jog (>>> Jogging to an end position [} 42]) KRC_Jog Tool Relative (>>> Jogging to a relative end position in the TOOL coordinate system with a linear motion [} 45]) KRC_Jog Linear Relative (>>> Jogging to a relative Cartesian position with a linear motion [} 46]) KRC_Jog Advanced (>>> Jogging to the end position (advanced) [} 47]) Functions for motion programming (PLC OPEN-compliant) MC_Move Linear Absolute (>>> Approaching an absolute Cartesian position with a linear motion [} 50]) MC_Move Linear Relative (>>> Approaching a relative Cartesian position with a linear motion [} 52]) MC_Move Direct Absolute (>>> Approaching an absolute Cartesian position as quickly as possible [} 53]) MC_Move Direct Relative (>>> Approaching a relative Cartesian position as quickly as possible [} 55]) MC_Move Axis Absolute (>>> Approaching an axis-specific position as quickly as possible [} 56]) MC_Move Circular Absolute (>>> Approaching an absolute Cartesian position with a circular motion [} 58]) MC_Move Circular Relative (>>> Approaching a relative Cartesian position with a circular motion [} 60]) Functions for program execution control KRC_Abort (>>> Canceling a program [} 62]) KRC_Abort Advanced (>>> Canceling a program (advanced) [} 63]) KRC_Interrupt (>>> Pausing robot motion [} 64]) KRC_Continue (>>> Continuing a program [} 64]) KRC_Wait For Input (>>> Waiting for a digital input [} 65]) Functions for interrupt programming KRC_Declare Interrupt (>>> Declaring interrupts [} 66]) KRC_Activate Interrupt (>>> Activating interrupts [} 67]) KRC_Deactivate Interrupt (>>> Deactivating interrupts [} 68]) KRC_Read Interrupt State (>>> Reading the state of an interrupt [} 69]) Functions for path-related switching actions KRC_Set Distance Trigger (>>> Activating a switching action for path points [} 70]) KRC_Set Path Trigger (>>> Activating a path-related switching action [} 71]) 28 Version: 2.0.0 TF5120
## Page 29

Function blocks Diagnostic functions KRC_Error (>>> Reading and acknowledging error states [} 73]) KRC_Read MXAStatus (>>> Reading the current state of the mx A interface [} 74]) KRC_Read MXAError (>>> Reading error messages of the mx A interface [} 75]) KRC_Message Reset (>>> Resetting error messages of the mx A interface [} 76]) KRC_Read KRCError (>>> Reading error messages of the robot controller [} 76]) KRC_Diag (>>> Reading diagnostic signals [} 77]) General special functions KRC_Read Sys Var (>>> Reading system variables [} 79]) KRC_Write Sys Var (>>> Writing system variables [} 80]) KRC_Brake Test (>>> Calling a brake test [} 82]) KRC_Mas Ref (>>> Calling a mastering test [} 83]) KRC_Read Safe OPStatus (>>> Reading the safety controller signals [} 85]) KRC_Read Touch UPState (>>> Reading the state of the Touch Up status keys [} 86]) KRC_Touch UP (>>> Teaching points [} 86]) KRC_Set Advance (>>> Modifying settings for the advance run [} 87]) KRC_Get Advance (>>> Reading settings for the advance run [} 88]) KRC_Forward (>>> Calculating the Cartesian robot position from the axis angles [} 89]) KRC_Forward Advanced (>>> Calculating the Cartesian robot position from the axis angles (advanced) [} 90]) KRC_Inverse (>>> Calculating axis angles from the Cartesian robot position [} 91]) KRC_Inverse Advanced (>>> Calculating axis angles from the Cartesian robot position (advanced) [} 92]) KRC_Tech Function (>>> Executing KRL programs [} 93]) KRC_Tech Function Advanced (>>> Executing KRL programs (advanced) [} 94]) KRC_Activate Pos Conversion (>>> Displaying the current robot position in a different coordinate system [} 95]) Special functions for Conveyor KRC_Conv Ini Off (>>> Initializing a conveyor [} 96]) KRC_Conv On (>>> Activating a conveyor [} 97]) KRC_Conv Follow (>>> Tracking a workpiece on the conveyor [} 98]) KRC_Conv Skip (>>> Picking up a workpiece from the conveyor [} 99]) KRC_Conv Del WPS (>>> Deleting a workpiece on the conveyor [} 100]) KRC_Activate Conv Interrupt (>>> Activating interrupts for monitoring [} 101]) KRC_Deactivate Conv Interrupt (>>> Deactivating interrupts for monitoring [} 102]) In order to be able to use these function blocks, KUKA. Conveyor Tech must be installed on the robot controller. Special functions for Vector Move KRC_Vector Move On (>>> Activating a motion along a vector [} 103]) KRC_Vector Move Off (>>> Deactivating motion along a vector [} 104]) TF5120 Version: 2.0.0 29
## Page 30

Function blocks In order to be able to use these function blocks, KUKA. Vector Move must be installed on the robot controller. Special functions for Load Data Determination KRC_LDDconfig (>>> Configuring load data determination [} 105]) KRC_LDDcheck Pos (>>> Checking the start position of the load data determination [} 106]) KRC_LDDtest Run (>>> Carrying out a test run before load data determination [} 107]) KRC_LDDstart (>>> Carrying out load data determination [} 108]) KRC_LDDwrite Load (>>> Assigning the load data [} 108]) In order to be able to use these function blocks, KUKA. Load Data Determination must be installed on the robot controller. Special functions for workspaces KRC_Write Workspace (>>> Configuring Cartesian workspaces [} 109]) KRC_Read Workspace (>>> Reading the configuration of Cartesian workspaces [} 110]) KRC_Write Ax Workspace (>>> Configuring axis-specific workspaces [} 111]) KRC_Read Ax Workspace (>>> Reading the configuration of axis-specific workspaces [} 112]) KRC_Read Workstates (>>> Reading the status of the workspaces [} 113]) 7.2 Functions for motion programming Motion instructions can only be executed in ABORTING or BUFFERED mode. If a motion is to be approximated, the following motion must be transferred in BUFFERED mode. Approximation is not possible with the Active output because the next motion instruction is not sent until the previous one is executed. Approximation is only possible if the Busy output of the previous function block is connected to the Execute Cmd input of the subsequent block. Further information about the basics of motion programming – motion types, orientation control, and approximate positioning – is contained in the operating and programming instructions for the KUKA System Software. 7.2.1 Approaching an absolute Cartesian position with a linear motion Description The function block KRC_Move Linear Absolute executes a linear motion to a Cartesian end position. The coordinates of the end position are absolute. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. 30 Version: 2.0.0 TF5120
## Page 31

Function blocks KRC_Move Linear Absolute Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Ori Type INT Approximate APO Buffer Mode INT Spline Mode BOOL Fig. 1: Function block KRC_Move Linear Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian end position (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED TF5120 Version: 2.0.0 31
## Page 32

Function blocks Parameter Type Description (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional linear motion. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.2 Approaching a relative Cartesian position with a linear motion Description The function block KRC_Move Linear Relative is used to execute a linear motion to a relative Cartesian end position. The parameter “Position” contains the path from the current position to the end position. This statement always refers to the current position of the robot. If the motion is interrupted and then re-executed, the robot executes the entire motion again, starting from the position at which it was interrupted. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. KRC_Move Linear Relative Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Ori Type INT Approximate APO Buffer Mode INT Spline Mode BOOL Fig. 2: Function block KRC_Move Linear Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. 32 Version: 2.0.0 TF5120
## Page 33

Function blocks Parameter Type Description Position E6POS Distance between end position and current position. The end position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the selected coordinate system). Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional linear motion. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 33
## Page 34

Function blocks 7.2.3 Approaching an absolute Cartesian position as quickly as possible Description The function block KRC_Move Direct Absolute executes a point-to-point motion to a Cartesian end position. The coordinates of the end position are absolute. The robot moves as quickly as possible to the end position. The fastest path is generally not the shortest path and is thus not a straight line. This corresponds to a PTP motion on the robot system. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. KRC_Move Direct Absolute Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Approximate APO Buffer Mode INT Spline Mode BOOL Fig. 3: Function block KRC_Move Direct Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian end position (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Note: If the value -1 is transferred for Status and Turn, the shortest path to the end position is taken. Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) 34 Version: 2.0.0 TF5120
## Page 35

Function blocks Parameter Type Description Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional point-to-point motion. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.4 Approaching a relative Cartesian position as quickly as possible Description The function block KRC_Move Direct Relative executes a point-to-point motion to a relative Cartesian end position. The parameter “Position” contains the path from the current position to the end position. This corresponds to a PTP_REL motion on the robot system. This statement always refers to the current position of the robot. If the motion is interrupted and then re-executed, the robot executes the entire motion again, starting from the position at which it was interrupted. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. TF5120 Version: 2.0.0 35
## Page 36

Function blocks KRC_Move Direct Relative Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Approximate APO Buffer Mode INT Spline Mode BOOL Fig. 4: Function block KRC_Move Direct Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance between end position and current position. The end position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the selected coordinate system). Note: If the value -1 is transferred for Status and Turn, the shortest path to the end position is taken. Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional point-to-point motion. 36 Version: 2.0.0 TF5120
## Page 37

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.5 Approaching an axis-specific position as quickly as possible Description The function block KRC_Move Axis Absolute executes a point-to-point motion to an axis-specific end position. The axis positions are absolute. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. KRC_Move Axis Absolute Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Axis Position E6AXIS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Approximate APO DINT Error ID Buffer Mode INT Spline Mode BOOL Fig. 5: Function block KRC_Move Axis Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Axis Position E6AXIS Axis-specific end position (>>> E6AXIS [} 20]) The data structure E6Axis contains the angle values or translation values for all axes of the axis group in the end position. Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. Default: 0% (= acceleration is not changed) TF5120 Version: 2.0.0 37
## Page 38

Function blocks Parameter Type Description Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional point-to-point motion. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.6 Approaching an absolute Cartesian position with a circular motion Description The function block KRC_Move Circ Absolute executes a circular motion to a Cartesian end position. In order for the robot controller to be able to calculate the circular motion, an auxiliary position must be specified in addition to the end position. The coordinates of the auxiliary position and end position are absolute. The auxiliary position cannot be approximated. The motion always stops exactly at this point. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. KRC_Move Circ Absolute Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Circ HP E6POS BOOL Aborted Angle REAL BOOL Error Velocity INT DINT Error ID Acceleration INT Coordinate System COORDSYS Ori Type INT Circ Type INT Approximate APO Buffer Mode INT Spline Mode BOOL Fig. 6: Function block KRC_Move Circ Absolute 38 Version: 2.0.0 TF5120
## Page 39

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian end position (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Circ HP E6POS Coordinates of the Cartesian auxiliary position (>>> E6POS [} 20]) The data structure E6POS contains all components of the auxiliary position (= position of the TCP relative to the origin of the BASE coordinate system). Angle REAL Circular angle (= overall angle of the circular motion) The circular angle makes it possible to extend the motion beyond the programmed end point or to shorten it. The actual end point thus no longer corresponds to the programmed end point. The circular angle is not limited, i.e. a circular angle greater than ±360° can be specified: • > 0.0°: In the case of a positive angle, the motion is carried out from the start point via Circ HP towards Position. • < 0.0°: In the case of a negative angle, the motion is carried out from the start point via Position towards Circ HP. • = 0.0°: The circular angle is ignored. End position is Position. The radius of the circle is calculated on the basis of the start position, Circ HP and Position. Default: 0.0° Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the auxiliary or end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) TF5120 Version: 2.0.0 39
## Page 40

Function blocks Parameter Type Description Circ Type INT Orientation control during the circular motion • 0: BASE • 1: PATH (>>> Circ Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional circular motion. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.7 Approaching a relative Cartesian position with a circular motion Description The function block KRC_Move Circ Relative executes a circular motion to a Cartesian end position. In order for the robot controller to be able to calculate the circular motion, an auxiliary position must be specified in addition to the end position. The coordinates of the auxiliary position and end position are relative to the current position (= start position of the circular motion). The auxiliary position cannot be approximated. The motion always stops exactly at this point. This statement always refers to the current position of the robot. If the motion is interrupted and then re-executed, the robot executes the entire motion again, starting from the position at which it was interrupted. If the motion is executed as a spline motion, the following must be taken into consideration: If the motion is approximated and there is no further motion instruction in the buffer, the output “Done” is not set for the spline motion. In this case, the motion is not ended at the end point, but at the approximate positioning point. 40 Version: 2.0.0 TF5120
## Page 41

Function blocks KRC_Move Circ Relative Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Circ HP E6POS BOOL Aborted Angle REAL BOOL Error Velocity INT DINT Error ID Acceleration INT Coordinate System COORDSYS Ori Type INT Circ Type INT Approximate APO Buffer Mode INT Spline Mode BOOL Fig. 7: Function block KRC_Move Circ Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance between end position and current position. The end position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Circ HP E6POS Coordinates of the Cartesian auxiliary position (relative to the current position) (>>> E6POS [} 20]) The data structure E6POS contains all components of the auxiliary position (= position of the TCP relative to the origin of the BASE coordinate system). Angle REAL Circular angle (= overall angle of the circular motion) The circular angle makes it possible to extend the motion beyond the programmed end point or to shorten it. The actual end point thus no longer corresponds to the programmed end point. The circular angle is not limited, i.e. a circular angle greater than ±360° can be specified: • > 0.0°: In the case of a positive angle, the motion is carried out from the start point via Circ HP towards Position. • < 0.0°: In the case of a negative angle, the motion is carried out from the start point via Position towards Circ HP. • = 0.0°: The circular angle is ignored. End position is Position. The radius of the circle is calculated on the basis of the start position, Circ HP and Position. Default: 0.0° Velocity INT Velocity • 0 … 100% TF5120 Version: 2.0.0 41
## Page 42

Function blocks Parameter Type Description Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the auxiliary or end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Circ Type INT Orientation control during the circular motion • 0: BASE • 1: PATH (>>> Circ Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Spline Mode BOOL TRUE = motion is executed as a spline motion. FALSE = motion is executed as a conventional circular motion. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.8 Jogging to an end position Description The function block KRC_Jog can be used to move to an end position with a linear motion or a point-to-point motion. 42 Version: 2.0.0 TF5120
## Page 43

Function blocks The function is always executed in ABORTING mode, i.e. all active motions and buffered statements are canceled, the robot is braked and the motion is then executed. KRC_Jog Axis Group Idx INT BOOL Busy Move Type INT BOOL Active Velocity INT BOOL Error Acceleration INT DINT Error ID Coordinate System COORDSYS Increment REAL A1_X_P BOOL A1_X_M BOOL A2_Y_P BOOL A2_Y_M BOOL A3_Z_P BOOL A3_Z_M BOOL A4_A_P BOOL A4_A_M BOOL A5_B_P BOOL A5_B_M BOOL A6_C_P BOOL A6_C_M BOOL E1_P BOOL E1_M BOOL E2_P BOOL E2_M BOOL E3_P BOOL E3_M BOOL E4_P BOOL E4_M BOOL E5_P BOOL E5_M BOOL E6_P BOOL E6_M BOOL Fig. 8: Function block KRC_Jog Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Move Type INT Motion type for Cartesian or axis-specific jogging • 0: Axis-specific • 1: Cartesian • 2: Axis-specific, as spline motion • 3: Cartesian, as spline motion Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. In the case of Move Type 1 and 3, the maximum value refers to the value of DEF_VEL_CP of the robot system. Default value: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% TF5120 Version: 2.0.0 43
## Page 44

Function blocks Parameter Type Description Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. In the case of Move Type 1 and 3, the maximum value refers to the value of DEF_ACC_CP of the robot system. Default value: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the coordinates of the end position refer. (>>> COORDSYS [} 19]) Increment REAL Incremental jogging The maximum distance for incremental jogging can be limited using this parameter. • > 0.0: The robot moves no more than the specified distance. For axis-specific jogging, the maximum distance is automatically limited to the software limit switches. For Cartesian jogging in the A, B or C direction, the maximum distance is limited to 90°. If the input signal is reset before the robot has reached the end position, the robot stops immediately. • ≤ 0.0: For Cartesian jogging in the X, Y or Z direction, the maximum distance is limited to 100000 mm. The robot motion restarts each time the input signals are changed. A1_X_P BOOL Motion instruction A1_X_M BOOL The motion is started at a rising edge of the signal and stopped A2_Y_P BOOL at a falling edge of the signal. A2_Y_M BOOL In the case of Move Type 0 and 2, the robot axes can be moved as far as 0.1 mm/° before the software limit switches. For this, A3_Z_P BOOL the software limit switch values are read once when the PLC is A3_Z_M BOOL started. A4_A_P BOOL Several robot axes can be moved simultaneously. The TCP can A4_A_M BOOL be moved along the axes of several coordinate systems. A5_B_P BOOL If the input signals are changed, the motion is stopped and then A5_B_M BOOL resumed with the modified configuration. If the positive and A6_C_P BOOL negative motion directions are activated simultaneously, an error number is displayed. A6_C_M BOOL Depending on the Move Type, the inputs for axes A1 … A6 have E1_P BOOL a dual assignment with the coordinates, e.g. A1 with X, A2 with E1_M BOOL Y, etc. E2_P BOOL The inputs that end in "P" (e.g. A2_Y_P) move in the positive E2_M BOOL direction. The inputs that end in "M" (e.g. A3_Z_M) move in the E3_P BOOL negative direction. E3_M BOOL E4_P BOOL E4_M BOOL E5_P BOOL E5_M BOOL E6_P BOOL E6_M BOOL 44 Version: 2.0.0 TF5120
## Page 45

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.9 Jogging to a relative end position in the TOOL coordinate system with a linear motion Description The function block KRC_Jog Tool Relative can be used to move to a Cartesian end position in the TOOL coordinate system with a linear motion. The coordinates of the end position are relative to the current position. Status and Turn of the end position are ignored, i.e. the axis positions at the end position are not unambiguously defined. The function is always executed in ABORTING mode, i.e. all active motions and buffered statements are canceled, the robot is braked and the linear motion is then executed. KRC_Jog Tool Relative Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Ori Type INT Fig. 9: Function block KRC_Jog Tool Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance from the target position to the current position. The target position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the selected coordinate system). Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) TF5120 Version: 2.0.0 45
## Page 46

Function blocks Parameter Type Description Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.10 Jogging to a relative Cartesian position with a linear motion Description The function block KRC_Jog Linear Relative can be used to move to a Cartesian end position with a linear motion. The end position is relative to the current position. The function is always executed in ABORTING mode, i.e. all active motions and buffered statements are canceled, the robot is braked and the linear motion is then executed. KRC_Jog Linear Relative Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Ori Type INT Fig. 10: Function block KRC_Jog Linear Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 46 Version: 2.0.0 TF5120
## Page 47

Function blocks Parameter Type Description Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance from the target position to the current position. The target position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the selected coordinate system). Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.2.11 Jogging to the end position (advanced) Description The function block KRC_Jog Advanced can be used to move to an end position with a linear motion or a point-to-point motion. The function is activated by means of the parameter Jog Advanced. The following modified values are permanently transferred to the robot controller as long as the parameter Jog Advanced is activated: • Tool TF5120 Version: 2.0.0 47
## Page 48

Function blocks • Base • Interpolation mode • Motion type The robot interpreter cannot perform any other calculations if the output “Busy” has the value TRUE. This function block cannot be used with conveyor systems. KRC_Jog Advanced Axis Group Idx INT BOOL Busy Move Type INT BOOL Active Velocity INT BOOL Error Acceleration INT DINT Error ID Coordinate System COORDSYS Jog Advanced BOOL B_A1_JA_P BOOL B_A1_JA_M BOOL B_A2_JA_P BOOL B_A2_JA_M BOOL B_A3_JA_P BOOL B_A3_JA_M BOOL B_A4_JA_P BOOL B_A4_JA_M BOOL B_A5_JA_P BOOL B_A5_JA_M BOOL B_A6_JA_P BOOL B_A6_JA_M BOOL B_E1_JA_P BOOL B_E1_JA_M BOOL B_E2_JA_P BOOL B_E2_JA_M BOOL B_E3_JA_P BOOL B_E3_JA_M BOOL B_E4_JA_P BOOL B_E4_JA_M BOOL B_E5_JA_P BOOL B_E5_JA_M BOOL B_E6_JA_P BOOL B_E6_JA_M BOOL B_X_JA_P BOOL B_X_JA_M BOOL B_Y_JA_P BOOL B_Y_JA_M BOOL B_Z_JA_P BOOL B_Z_JA_M BOOL B_A_JA_P BOOL B_A_JA_M BOOL B_B_JA_P BOOL B_B_JA_M BOOL B_C_JA_P BOOL B_C_JA_M BOOL Fig. 11: Function block KRC_Jog Advanced 48 Version: 2.0.0 TF5120
## Page 49

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Move Type INT Motion type for Cartesian or axis-specific jogging • 1: Axis-specific as a spline motion and Cartesian as a spline motion in the BASE coordinate system • 2: Axis-specific and Cartesian as a spline motion in the TOOL coordinate system Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. Default value: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. Default value: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the coordinates of the end position refer. (>>> COORDSYS [} 19]) Jog Advanced BOOL The Jog Advanced function is activated at a rising edge of the signal and deactivated at a falling edge of the signal. B_A1_JA_P BOOL Motion instruction B_A1_JA_M BOOL The motion instruction is only executed if the parameter B_A2_JA_P BOOL Jog Advanced is activated. B_A2_JA_M BOOL The motion is started at a rising edge of the signal and stopped at a falling edge of the signal. B_A3_JA_P BOOL B_A3_JA_M BOOL In the case of axis-specific motion, the robot axes can be moved as far as 0.1 mm/° before the software limit switches. For this, the B_A4_JA_P BOOL software limit switch values are read once when the PLC is B_A4_JA_M BOOL started. B_A5_JA_P BOOL The TCP can be moved along the axes of several coordinate B_A5_JA_M BOOL systems. B_A6_JA_P BOOL If the input signals are changed, the motion is stopped and then B_A6_JA_M BOOL resumed with the modified configuration. If the positive and negative motion directions are activated simultaneously, an error B_E1_JA_P BOOL number is displayed. B_E1_JA_M BOOL The inputs that end in "P" (e.g. B_A2_JA_P) move in the positive B_E2_JA_P BOOL direction. The inputs that end in "M" (e.g. B_A3_JA_M) move in B_E2_JA_M BOOL the negative direction. B_E3_JA_P BOOL B_E3_JA_M BOOL B_E4_JA_P BOOL B_E4_JA_M BOOL B_E5_JA_P BOOL B_E5_JA_M BOOL B_E6_JA_P BOOL B_E6_JA_M BOOL B_X_JA_P BOOL TF5120 Version: 2.0.0 49
## Page 50

Function blocks Parameter Type Description B_X_JA_M BOOL B_Y_JA_P BOOL B_Y_JA_M BOOL B_Z_JA_P BOOL B_Z_JA_M BOOL B_A_JA_P BOOL B_A_JA_M BOOL B_B_JA_P BOOL B_B_JA_M BOOL B_C_JA_P BOOL B_C_JA_M BOOL Outputs Parameter Type Description Busy BOOL TRUE = function block is active and waiting for a motion instruction Active BOOL TRUE = motion is currently being executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.3 Functions for motion programming (PLC OPEN- compliant) The MC function blocks described below differ from the KRC function blocks in that they correspond to the PLC OPEN standard or are closer to it. Approximation is not possible with the Active output because the next motion instruction is not sent until the previous one is executed. Approximation is only possible if the Com Acpt output of the previous function block is connected to the Execute input of the subsequent block. For information on the frequently used signals in the MC function blocks, see (>>> Frequently used input/output signals in the MC function blocks). 7.3.1 Approaching an absolute Cartesian position with a linear motion Description The function block MC_Move Linear Absolute is used to execute a linear motion to a Cartesian end position. The coordinates of the end position are absolute. 50 Version: 2.0.0 TF5120
## Page 51

Function blocks MC_Move Linear Absolute Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Position E6POS BOOL Busy Velocity REAL BOOL Active Acceleration REAL BOOL Done Coordinate System COORDSYS BOOL Command Aborted Ori Type INT BOOL Error Approximate APO DINT Error ID Queue Mode INT Fig. 12: Function block MC_Move Linear Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian end position (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Velocity REAL Velocity for the path motion • 0 … 2 m/s The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0 m/s (= velocity is not changed) Acceleration REAL Acceleration for the path motion • 0 … 2.3 m/s2 The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0 m/s2 (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Note: In the case of a linear motion, the Cartesian coordinates always refer to the BASE coordinate system. Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) TF5120 Version: 2.0.0 51
## Page 52

Function blocks Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.3.2 Approaching a relative Cartesian position with a linear motion Description The function block MC_Move Linear Relative is used to execute a linear motion to a relative Cartesian end position. The parameter “Position” contains the path from the current position to the end position. This statement always refers to the current position of the robot. If the motion is interrupted and then re-executed, the robot executes the entire motion again, starting from the position at which it was interrupted. MC_Move Linear Relative Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Distance E6POS BOOL Busy Velocity REAL BOOL Active Acceleration REAL BOOL Done Coordinate System COORDSYS BOOL Command Aborted Ori Type INT BOOL Error Approximate APO DINT Error ID Queue Mode INT Fig. 13: Function block MC_Move Linear Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance from the target position to the current position. The target position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the selected coordinate system). Velocity REAL Velocity for the path motion • 0 … 2 m/s 52 Version: 2.0.0 TF5120
## Page 53

Function blocks Parameter Type Description The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0 m/s (= velocity is not changed) Acceleration REAL Acceleration for the path motion • 0 … 2.3 m/s2 The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0 m/s2 (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.3.3 Approaching an absolute Cartesian position as quickly as possible Description The function block MC_Move Direct Absolute executes a point-to-point motion to a Cartesian end position. The coordinates of the end position are absolute. The robot moves as quickly as possible to the end position. The fastest path is generally not the shortest path and is thus not a straight line. This corresponds to a PTP motion on the robot system. TF5120 Version: 2.0.0 53
## Page 54

Function blocks MC_Move Direct Absolute Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Position E6POS BOOL Busy Velocity REAL BOOL Active Acceleration REAL BOOL Done Coordinate System COORDSYS BOOL Command Aborted Approximate APO BOOL Error Queue Mode INT DINT Error ID Fig. 14: Function block MC_Move Direct Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian end position (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Note: If the value -1 is transferred for Status and Turn, the shortest path to the end position is taken. Velocity REAL Velocity for the path motion • 0 … 100% The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% Acceleration REAL Acceleration for the path motion • 0 … 100% The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= velocity is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Note: In the case of a point-to-point motion, the Cartesian coordinates always refer to the BASE coordinate system. Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) 54 Version: 2.0.0 TF5120
## Page 55

Function blocks Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.3.4 Approaching a relative Cartesian position as quickly as possible Description The function block MC_Move Direct Relative executes a point-to-point motion to a relative Cartesian end position. The parameter “Position” contains the path from the current position to the end position. This corresponds to a PTP_REL motion on the robot system. This statement always refers to the current position of the robot. If the motion is interrupted and then re-executed, the robot executes the entire motion again, starting from the position at which it was interrupted. MC_Move Direct Relative Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Distance E6POS BOOL Busy Velocity REAL BOOL Active Acceleration REAL BOOL Done Coordinate System COORDSYS BOOL Command Aborted Approximate APO BOOL Error Queue Mode INT DINT Error ID Fig. 15: Function block MC_Move Direct Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance between end position and current position. The end position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the selected coordinate system). Note: If the value -1 is transferred for Status and Turn, the shortest path to the end position is taken. TF5120 Version: 2.0.0 55
## Page 56

Function blocks Parameter Type Description Velocity REAL Velocity for the path motion • 0 … 100% The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity not changed) Acceleration REAL Acceleration for the path motion • 0 … 100% The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the end position refer (>>> COORDSYS [} 19]) Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.3.5 Approaching an axis-specific position as quickly as possible Description The function block MC_Move Axis Absolute is used to execute a point-to-point motion to an axis-specific end position. The axis positions are absolute. 56 Version: 2.0.0 TF5120
## Page 57

Function blocks MC_Move Axis Absolute Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Axis Position E6AXIS BOOL Busy Velocity REAL BOOL Active Acceleration REAL BOOL Done Approximate APO BOOL Command Aborted Queue Mode INT BOOL Error DINT Error ID Fig. 16: Function block MC_Move Axis Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Axis Position E6AXIS Axis-specific end position (>>> E6AXIS [} 20]) The data structure E6Axis contains the angle values or translation values for all axes of the axis group in the end position. Velocity REAL Velocity for the path motion • 0 … 100% The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0% (= velocity is not changed) Acceleration REAL Acceleration for the path motion • 0 … 100% The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0% (= acceleration is not changed) Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block TF5120 Version: 2.0.0 57
## Page 58

Function blocks Parameter Type Description Error ID DINT Error number 7.3.6 Approaching an absolute Cartesian position with a circular motion Description The function block MC_Move Circular Absolute executes a circular motion to a Cartesian end position. In order for the robot controller to be able to calculate the circular motion, an auxiliary position must be specified in addition to the end position. The coordinates of the auxiliary position and end position are absolute. The auxiliary position cannot be approximated. The motion always stops exactly at this point. MC_Move Circular Absolute Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Position E6POS BOOL Busy Circ HP E6POS BOOL Active Angle REAL BOOL Done Velocity REAL BOOL Command Aborted Acceleration REAL BOOL Error Coordinate System COORDSYS DINT Error ID Ori Type INT Circ Type INT Approximate APO Queue Mode INT Fig. 17: Function block MC_Move Circular Absolute Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian end position (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Circ HP E6POS Coordinates of the Cartesian auxiliary position (>>> E6POS [} 20]) The data structure E6POS contains all components of the auxiliary position (= position of the TCP relative to the origin of the BASE coordinate system). Angle REAL Circular angle (= overall angle of the circular motion) The circular angle makes it possible to extend the motion beyond the programmed end point or to shorten it. The actual end point thus no longer corresponds to the programmed end point. The circular angle is not limited, i.e. a circular angle greater than ±360° can be specified: 58 Version: 2.0.0 TF5120
## Page 59

Function blocks Parameter Type Description • > 0.0°: In the case of a positive angle, the motion is carried out from the start point via Circ HP towards Position. • < 0.0°: In the case of a negative angle, the motion is carried out from the start point via Position towards Circ HP. • = 0.0°: The circular angle is ignored. End position is Position. The radius of the circle is calculated on the basis of the start position, Circ HP and Position. Default: 0.0° Velocity REAL Velocity for the path motion • 0 … 2 m/s The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0 m/s (= velocity is not changed) Acceleration REAL Acceleration for the path motion • 0 … 2.3 m/s2 The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0 m/s2 (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the auxiliary or end position refer (>>> COORDSYS [} 19]) Note: In the case of a circular motion, the Cartesian coordinates always refer to the BASE coordinate system. Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Circ Type INT Orientation control during the circular motion • 0: BASE • 1: PATH (>>> Circ Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped TF5120 Version: 2.0.0 59
## Page 60

Function blocks Parameter Type Description Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.3.7 Approaching a relative Cartesian position with a circular motion Description The function block MC_Move Circular Relative executes a circular motion to a Cartesian end position. In order for the robot controller to be able to calculate the circular motion, an auxiliary position must be specified in addition to the end position. The coordinates of the auxiliary position and end position are relative to the current position (= start position of the circular motion). The auxiliary position cannot be approximated. The motion always stops exactly at this point. This statement always refers to the current position of the robot. If the motion is interrupted and then re-executed, the robot executes the entire motion again, starting from the position at which it was interrupted. MC_Move Circular Relative Axis Group Idx INT BOOL Com Acpt Execute BOOL BOOL Com Busy Distance E6POS BOOL Busy Circ HP E6POS BOOL Active Angle REAL BOOL Done Velocity REAL BOOL Command Aborted Acceleration REAL BOOL Error Coordinate System COORDSYS DINT Error ID Ori Type INT Circ Type INT Approximate APO Queue Mode INT Fig. 18: Function block MC_Move Circular Relative Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Distance from the target position to the current position. The target position is based on the current position. (>>> E6POS [} 20]) The data structure E6POS contains all components of the end position (= position of the TCP relative to the origin of the BASE coordinate system). Circ HP E6POS Coordinates of the Cartesian auxiliary position (relative to the current position) (>>> E6POS [} 20]) 60 Version: 2.0.0 TF5120
## Page 61

Function blocks Parameter Type Description The data structure E6POS contains all components of the auxiliary position (= position of the TCP relative to the origin of the BASE coordinate system). Angle REAL Circular angle (= overall angle of the circular motion) The circular angle makes it possible to extend the motion beyond the programmed end point or to shorten it. The actual end point thus no longer corresponds to the programmed end point. The circular angle is not limited, i.e. a circular angle greater than ±360° can be specified: • > 0.0°: In the case of a positive angle, the motion is carried out from the start point via Circ HP towards Position. • < 0.0°: In the case of a negative angle, the motion is carried out from the start point via Position towards Circ HP. • = 0.0°: The circular angle is ignored. End position is Position. The radius of the circle is calculated on the basis of the start position, Circ HP and Position. Default: 0.0° Velocity REAL Velocity for the path motion • 0 … 2 m/s The maximum value is dependent on the robot type and refers to the value of DEF_VEL_CP of the robot system. Default: 0 m/s (= velocity is not changed) Acceleration REAL Acceleration for the path motion • 0 … 2.3 m/s2 The maximum value is dependent on the robot type and refers to the value of DEF_ACC_CP of the robot system. Default: 0 m/s2 (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the auxiliary or end position refer (>>> COORDSYS [} 19]) Ori Type INT Orientation control of the TCP • 0: VAR • 1: CONSTANT • 2: JOINT (>>> Ori Type [} 16]) Circ Type INT Orientation control during the circular motion • 0: BASE • 1: PATH (>>> Circ Type [} 16]) Approximate APO Approximation parameter (>>> APO [} 19]) Queue Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Queue Mode [} 16]) TF5120 Version: 2.0.0 61
## Page 62

Function blocks Outputs Parameter Type Description Com Acpt BOOL TRUE = statement was completely transferred and confirmed by the robot controller. Com Busy BOOL TRUE = statement was transferred and confirmed by the robot controller, but has not yet been executed completely. Busy BOOL TRUE = function block has not yet been executed completely. Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Command Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.4 Functions for program execution control 7.4.1 Canceling a program Description The function block KRC_Abort cancels active and buffered statements and motions. The parameter Active specifies whether or not the statement is still being executed. If the robot interpreter is no longer active, this can result in the statement being transferred, but not yet fully executed. Statements and motions of function blocks without Buffer Mode or Queue Mode that are executed cyclically are not canceled. KRC_Abort is not processed if the function block KRC_Interrupt is active. In this case, the program must first be resumed with KRC_Continue before it can be aborted with KRC_Abort. KRC_Abort Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active BOOL Done BOOL Error DINT Error ID Fig. 19: Function block KRC_Abort Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed 62 Version: 2.0.0 TF5120
## Page 63

Function blocks Parameter Type Description Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.4.2 Canceling a program (advanced) Description The function block KRC_Abort Advanced cancels active and buffered statements and motions. The parameter Active specifies whether or not the statement is still being executed. If the robot interpreter is no longer active, this can result in the statement being transferred, but not yet fully executed. Statements and motions of function blocks without Buffer Mode or Queue Mode that are executed cyclically are not canceled. The parameter Brake Reaction can be used to define the braking reaction of the robot. KRC_Abort Advanced is not processed if the KRC_Interrupt function block is active. In this case, the program must first be resumed with KRC_Continue before it can be aborted with KRC_Abort Advanced. KRC_Abort Advanced Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Brake Reaction INT BOOL Done BOOL Error DINT Error ID Fig. 20: Function block KRC_Abort Advanced Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Brake Reaction INT Braking reaction of the robot • 1: BRAKE • 2: BRAKE F (default) • 3: BRAKE FF Note: Further information about the BRAKE statements is contained in the operating and programming instructions for the KUKA System Software (KSS). Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 63
## Page 64

Function blocks 7.4.3 Pausing robot motion Description The function block KRC_Interrupt is used to stop the robot. It brakes either gently (BRAKE) or as quickly as possible (BRAKE F) from high velocities. If a BRAKE statement is active, no more statements are processed via the mx A interface. The function block KRC_Abort is also no longer processed. KRC_Abort cannot cancel the program until it has been resumed with KRC_Continue, i.e. the BRAKE statement is no longer active. While the BRAKE statement is active, the program can only be canceled by means of a RESET of the function block KRC_Automatic External. KRC_Interrupt Axis Group Idx INT BOOL Brake Active Execute BOOL BOOL Error Fast BOOL DINT Error ID Fig. 21: Function block KRC_Interrupt Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute BOOL The statement is executed in the case of a rising edge of the signal. The robot program is interrupted for as long as the input Execute is set to TRUE. Fast BOOL TRUE = robot stops as quickly as possible FALSE = robot stops gently Outputs Parameter Type Description Brake Active BOOL TRUE = statement is active and robot is waiting for enabling Error BOOL TRUE = error in function block Error ID DINT Error number 7.4.4 Continuing a program Description The function block KRC_Continue can be used to resume execution of a program that has been stopped by means of an interrupt. If KRC_Continue is used together with KRC_Interrupt, the input Execute for KRC_Interrupt must have the value FALSE before KRC_Continue can be executed. KRC_Continue Axis Group Idx INT BOOL Error Enable BOOL DINT Error ID Fig. 22: Function block KRC_Continue 64 Version: 2.0.0 TF5120
## Page 65

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Enable BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number 7.4.5 Waiting for a digital input Description The function block KRC_Wait For Input stops the program until a digital input takes a defined value. Program execution is then resumed. KRC_Wait For Input Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Number INT BOOL Done Value BOOL BOOL Aborted b Continue BOOL BOOL Error Buffer Mode INT DINT Error ID Fig. 23: Function block KRC_Wait For Input Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the digital input (corresponds to $IN[1 … 2048] on the robot controller) • 1 … 2048 Value BOOL Value of the digital input b Continue BOOL TRUE = poll input in advance run Note: The robot controller executes programs with an advance run and a main run. Further information about the advance run and main run is contained in the operating and programming instructions for the KUKA System Software (KSS). Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) TF5120 Version: 2.0.0 65
## Page 66

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed (robot is waiting for an input) Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.5 Functions for interrupt programming 7.5.1 Declaring interrupts Description The function block KRC_Declare Interrupt declares an interrupt to a digital input. There are 8 predefined interrupts available for this. An interrupt can be used to stop the robot during the motion. Depending on how the Reaction parameter is configured, the robot brakes gently from high velocities (BRAKE) or as quickly as possible (BRAKE F). The remaining program sequence can be determined using a robot input or a PLC function block. If a BRAKE statement is active, no more statements are processed via the mx A interface. The function block KRC_Abort is also no longer processed. KRC_Abort cannot cancel the program until it has been resumed with KRC_Continue, i.e. the BRAKE statement is no longer active. While the BRAKE statement is active, the program can only be canceled by means of a RESET of the function block KRC_Automatic External. KRC_Declare Interrupt Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Interrupt INT BOOL Aborted Input INT BOOL Error Input Value BOOL DINT Error ID Reaction INT Buffer Mode INT Fig. 24: Function block KRC_Declare Interrupt Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is buffered in the case of a rising edge of the signal. Interrupt INT Number of the interrupt • 1 … 8 Note: Number 1 is the interrupt with the highest priority. Input INT Number of the digital input to which the interrupt is declared • 1 … 2048 66 Version: 2.0.0 TF5120
## Page 67

Function blocks Parameter Type Description Note: It must be ensured that no inputs are used that are already assigned by the system. Example: $IN[1025] is always TRUE. Input Value BOOL TRUE = statement is executed in the case of a rising edge of the signal. FALSE = statement is executed in the case of a falling edge of the signal. Reaction INT Reaction to the interrupt • 0: Brake fast and wait for the EXT_START parameter of the function block KRC_Automatic External • 1: Brake normally and wait for the EXT_START parameter of the function block KRC_Automatic External • 2: Brake fast and wait for the Input parameter • 3: Brake normally and wait for the Input parameter • 4: Brake fast and wait for the edge of the function block KRC_Continue • 5: Brake normally and wait for the edge of the function block KRC_Continue • 6: Brake fast and wait for the edge of the function block KRC_Continue and the Input parameter • 7: Brake normally and wait for the edge of the function block KRC_Continue and the Input parameter Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been processed Note: The statement can no longer be aborted. Exception: Program is deselected or reset. Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.5.2 Activating interrupts Description The function block KRC_Activate Interrupt activates a previously declared interrupt. There are 8 predefined interrupts available for this. The function block KRC_Read Interrupt State can be used to monitor and check whether an interrupt is active. TF5120 Version: 2.0.0 67
## Page 68

Function blocks KRC_Activate Interrupt Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Interrupt INT BOOL Aborted Buffer Mode INT BOOL Error DINT Error ID Fig. 25: Function block KRC_Activate Interrupt Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is buffered in the case of a rising edge of the signal. Interrupt INT Number of the interrupt • 1 … 8 Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been processed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.5.3 Deactivating interrupts Description The function block KRC_Deactivate Interrupt deactivates a previously declared interrupt. There are 8 predefined interrupts available for this. KRC_Deactivate Interrupt Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Interrupt INT BOOL Aborted Buffer Mode INT BOOL Error DINT Error ID Fig. 26: Function block KRC_Deactivate Interrupt Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 68 Version: 2.0.0 TF5120
## Page 69

Function blocks Parameter Type Description Execute Cmd BOOL The statement is buffered in the case of a rising edge of the signal. Interrupt INT Number of the interrupt • 1 … 8 Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.5.4 Reading the state of an interrupt Description The function block KRC_Read Interrupt State reads the state of an interrupt. This is updated cyclically. KRC_Read Interrupt State Axis Group Idx INT BOOL Valid Interrupt INT INT Value BOOL Error DINT Error ID Fig. 27: Function block KRC_Read Interrupt State Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Interrupt INT Number of the interrupt • 1 … 8 Outputs Parameter Type Description Valid BOOL TRUE = data are valid Value INT State of specified interrupt • 0: Interrupt has not been declared. • 1: Interrupt has been declared. • 2: Interrupt has been declared and activated. • 3: Interrupt has been declared and activated and has now been deactivated again (see Status 1). TF5120 Version: 2.0.0 69
## Page 70

Function blocks Parameter Type Description • 4: Interrupt has been triggered and is active. • 5: Interrupt has been triggered and the main program has already been resumed with the function block KRC_Continue. Error BOOL TRUE = error in function block Error ID DINT Error number 7.6 Functions for path-related switching actions 7.6.1 Activating a switching action for path points Description The function block KRC_Set Distance Trigger triggers a path-related switching action in the case of PTP or LIN motions. The Trigger triggers a defined statement. The statement refers to the start point or end point of the motion block. The statement is executed parallel to the robot motion. The statement can be shifted in time. It is then not triggered exactly at the start or end point, but brought forward or delayed. Further information on triggers, on offsetting the switching point and on the offset limits can be found in the operating and programming instructions for the KUKA System Software (KSS). KRC_Set Distance Trigger Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Distance INT BOOL Aborted Delay INT BOOL Error Output INT DINT Error ID Value BOOL Pulse REAL Buffer Mode INT Fig. 28: Function block KRC_Set Distance Trigger Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is buffered in the case of a rising edge of the signal. Distance INT Switching point of the trigger • 0: Switching action at the start point • 1: Switching action at the end point Delay INT Statement delay • Delay = 0 ms: no delay The statement cannot be shifted freely in time. The shifts that are available depend on the value selected for Distance. Further information about this is contained in the operating and programming instructions for the KUKA System Software (KSS). 70 Version: 2.0.0 TF5120
## Page 71

Function blocks Parameter Type Description Output INT Number of the digital output that can be set by the switching action • 1 … 2048 Note: It must be ensured that no outputs are used that are already assigned by the system. Example: $OUT[1025] is always TRUE. Value BOOL TRUE = activate output FALSE = deactivate output Pulse REAL Length of the pulse • 0.0 s No pulse active • 0.1 … 3.0 s Pulse interval = 0.1 s Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been processed Note: The statement can no longer be aborted. Exception: Program is deselected or reset. The signal does not indicate whether the switching action has really been triggered. Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.6.2 Activating a path-related switching action Description The function block KRC_Set Path Trigger triggers a path-related switching action in the case of CP motions. The Trigger triggers a defined statement. The statement refers to the end point of the motion block. The statement is executed parallel to the robot motion. The statement can be shifted in time and/or space. It is then not triggered exactly at the end point, but beforehand or afterwards. Path triggers can only be activated before CP motions. If the subsequent motion is not a CP motion, the robot controller issues an error message. Further information on triggers, on offsetting the switching point and on the offset limits can be found in the operating and programming instructions for the KUKA System Software (KSS). TF5120 Version: 2.0.0 71
## Page 72

Function blocks KRC_Set Path Trigger Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Path REAL BOOL Aborted Delay INT BOOL Error Output INT DINT Error ID Value BOOL Pulse REAL Buffer Mode INT Fig. 29: Function block KRC_Set Path Trigger Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is buffered in the case of a rising edge of the signal. Path REAL Statement offset If the statement is to be shifted in space, the desired distance from the end point must be specified here. If this end point is approximated, Path is the distance to the position on the approximate positioning arc closest to the end point. • Path = 0.0 mm: no offset • Path > 0.0 mm: shifts the statement towards the end of the motion. • Path < 0.0 mm: shifts the statement towards the start of the motion. Delay INT Statement delay • Delay = 0 ms: no delay The statement cannot be shifted freely in time. The offsets that are possible depend on the value selected for Path. Further information about this is contained in the operating and programming instructions for the KUKA System Software (KSS). Output INT Number of the digital output that can be set by the switching action • 1 … 2048 Note: It must be ensured that no outputs are used that are already assigned by the system. Example: $OUT[1025] is always TRUE. Value BOOL TRUE = activate output FALSE = deactivate output Pulse REAL Length of the pulse • 0.0 s No pulse active • 0.1 … 3.0 s Pulse interval = 0.1 s Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) 72 Version: 2.0.0 TF5120
## Page 73

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been processed Note: The statement can no longer be aborted. Exception: Program is deselected or reset. The signal does not indicate whether the switching action has really been triggered. Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.7 Diagnostic functions 7.7.1 Reading and acknowledging error states Description The function block KRC_Error collectively reads and acknowledges the current error state of the mx A interface, the error state of the robot controller and the error state of the function blocks. If more than one error has occurred in the function block at the same time, only the error number of the most recent error is displayed. Errors in a function block cause the motion enable to be canceled. If more than one error has occurred at the same time, these errors are displayed with the following priority ranking: 1. Errors of the mx A interface in the robot interpreter 2. Errors of the mx A interface in the submit interpreter 3. Pro Con OS errors 4. Errors in the PLC 5. Errors in a function block of the local PLC 6. Errors in the robot controller The function block KRC_Error contains all diagnostic function blocks, which means that this block displays all important diagnostic data. KRC_Error Axis Group Idx INT BOOL Error Message Reset BOOL DINT Error ID BOOL No Heartbeat KRC BOOL No Heartbeat PCOS BOOL Not Online BOOL Not Initialized BOOL No Op Mode Ext BOOL No Move Enable BOOL User Safe Not OK BOOL Krc Error Active BOOL Drives Not Ready BOOL No Prog Active Fig. 30: Function block KRC_Error TF5120 Version: 2.0.0 73
## Page 74

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Message Reset BOOL Acknowledges error messages of the mx A interface and the robot controller TRUE = reset message Note: The messages can only be reset if the robot is stationary. Outputs Parameter Type Description Error BOOL TRUE = error in function block Error ID INT Error number No Heartbeat KRC BOOL The submit interpreter is not sending a life sign No Heartbeat PCOS BOOL Pro Con OS is not sending a life sign Not Online BOOL No connection to robot controller Not Initialized BOOL No statements can be executed, as the connection has not been initialized. No Op Mode Ext BOOL Robot is not in Automatic External mode No Move Enable BOOL No motion enable present. User Safe Not OK BOOL The operator safety is violated. The $USER_SAF signal of the Automatic External interface is not active. Krc Error Active BOOL Error messages of the robot controller are active. The $STOPMESS signal of the Automatic External interface is active. Drives Not Ready BOOL The drives are not ready. The $PERI_RDY signal of the Automatic External interface is not active. No Prog Active BOOL The robot program is not active. The $PRO_ACT signal of the Automatic External interface is not active. 7.7.2 Reading the current state of the mx A interface Description The function block KRC_Read MXAStatus reads the current state of the mx A interface. KRC_Read MXAStatus Axis Group Idx INT INT Status BOOL Error DINT Error ID Fig. 31: Function block KRC_Read MXAStatus Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 74 Version: 2.0.0 TF5120
## Page 75

Function blocks Outputs Parameter Type Description Status INT Current state of the mx A interface (>>> Status [} 75]) Error BOOL TRUE = error in function block Error ID DINT Error number Status Current state of the mx A interface (function block KRC_Read MXAStatus) Value Name Description 0 Invalid No function blocks can be processed. Frequent causes: • Submit interpreter stopped or deselected • I/O error due to incorrect bus configuration • Robot controller not started. 1 Error An mx A error message is active. The error message must be reset with the function block KRC_Message Reset. 2 Program Stopped Robot interpreter is not active (main program has been stopped or deselected). 3 Stand By Robot interpreter is active and waiting for statements, e.g. waiting for an input. 4 Executing Robot interpreter is active (main program is being executed). 5 Aborting Robot stopped and all statements aborted. 7.7.3 Reading error messages of the mx A interface Description The function block KRC_Read MXAError is used to read the current error state of an axis group. Only error messages generated by the mx A interface are displayed. KRC_Read MXAError Axis Group Idx INT BOOL Error DINT Error ID Fig. 32: Function block KRC_Read MXAError Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 75
## Page 76

Function blocks 7.7.4 Resetting error messages of the mx A interface Description The function block KRC_Message Reset resets the current error state of an axis group. Only error messages generated by the mx A interface are reset. Messages can only be reset if the robot is stationary. KRC_Message Reset Axis Group Idx INT BOOL Error Message Reset BOOL DINT Error ID Fig. 33: Function block KRC_Message Reset Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Message Reset BOOL TRUE = reset message Outputs Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number 7.7.5 Reading error messages of the robot controller Description The function block KRC_Read KRCError reads the current error state of the robot controller. Only error messages generated by the robot controller are displayed. Messages can only be reset if the robot is stationary. 76 Version: 2.0.0 TF5120
## Page 77

Function blocks KRC_Read KRCError Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Error Offset INT DINT Error ID BOOL STOPMESS INT Message Count DINT Message1 DINT Message2 DINT Message3 DINT Message4 DINT Message5 DINT Message6 DINT Message7 DINT Message8 DINT Message9 DINT Message10 Fig. 34: Function block KRC_Read KRCError Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Offset INT If there are more than 10 messages in the message buffer, the desired start index of the message buffer can be selected using the offset. Example: If there are 15 messages in the message buffer, the offset must be 6 in order to read messages 6 to 15. Outputs Parameter Type Description Done BOOL TRUE = data are valid Error BOOL TRUE = error in function block Error ID DINT Error number STOPMESS BOOL TRUE = safety circuit is interrupted (robot fault) Message Count INT Number of messages in the message buffer Message1 … DINT The numbers of up to 10 messages in the message buffer can be output. Message10 7.7.6 Reading diagnostic signals Description The function block KRC_Diag reads the diagnostic signals of the robot controller. The function block may only be instanced once per axis group. In the case of multiple instancing, the signals of the most recently called function block are output. TF5120 Version: 2.0.0 77
## Page 78

Function blocks KRC_Diag Axis Group Idx INT BOOL Valid Show Trace BOOL INT Queue Count Max Submit Cycle INT BOOL Pos Act Valid BOOL Brake Active INT Submit Heartbeat INT Submit Cyc_Act INT Submit Cyc_Min INT Submit Cyc_Max INT Submit Cyc_Avg DINT Active Pos Order ID DINT Active Order IDB DINT Avg_Duration INT Proconos Heartbeat INT Proconos Cyc_Act INT Proconos Cyc_Min INT Proconos Cyc_Max INT Proconos Cyc_Avg DINT Error ID_RI DINT Error ID_SI DINT Error ID_PLC DINT Error ID_PCOS BOOL Error DINT Error ID Fig. 35: Function block KRC_Diag Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Show Trace BOOL TRUE = activate display of the active function blocks in the message window of the KUKA smart HMI. FALSE = deactivate display of the active function blocks in the message window of the KUKA smart HMI. Note: Only activate the display for test and diagnostic purposes. If the display is active, approximate positioning is no longer possible and the cycle time of the submit interpreter is adversely affected. Max Submit Cycle INT Maximum cycle time of the submit interpreter Default: 1 000 ms Note: If the maximum cycle time is exceeded, the $MOVE_ENABLE signal for motion enable is reset. Outputs Parameter Type Description Valid BOOL TRUE = data are valid Queue Count INT Number of buffered statements • 1 … 90 Pos Act Valid BOOL TRUE = position data are valid (BCO) Brake Active BOOL TRUE = robot is stopped by means of a BRAKE statement Submit Heartbeat INT Heartbeat signal of the submit interpreter (counter is incremented by 1 every Submit cycle) • 1 … 245 78 Version: 2.0.0 TF5120
## Page 79

Function blocks Parameter Type Description Submit Cyc_Act REAL Current cycle time of the submit interpreter; unit: ms Mean value over 1,000 ms = 1/number of cycles per second Submit Cyc_Min REAL Shortest cycle time of the submit interpreter since the last broken connection; unit: ms Submit Cyc_Max REAL Longest cycle time of the submit interpreter since the last broken connection; unit: ms Submit Cyc_Avg INT Mean value of the cycle time of the submit interpreter during the calculation period Avg_Duration; unit: ms Active Pos Order ID DINT Order ID of the KRC_Move motion command that is currently being executed Active Order IDB DINT Order ID of the current KRC_Move motion command in the advance run Avg_Duration DINT Duration of the current calculation period for the mean value of the cycle time; unit: ms The calculation period is restarted after a break in the connection to the submit interpreter or, at the latest, after 60 minutes. Proconos Heartbeat INT Life sign from Pro Con OS (counter is incremented by 1 every Pro Con OS cycle) Proconos Cyc_Act INT Current cycle time of Pro Con OS; unit: ms Mean value over 1,000 ms = 1/number of cycles per second Proconos Cyc_Min INT Shortest cycle time of Pro Con OS since the last broken connection; unit: ms Proconos Cyc_Max INT Longest cycle time of Pro Con OS since the last broken connection; unit: ms Proconos Cyc_Avg INT Mean value of the cycle time of Pro Con OS during the calculation period Avg_Duration; unit: ms Error ID_RI DINT Robot interpreter error number Error ID_SI DINT Submit interpreter error number Error ID_PLC DINT PLC error number Error ID_PCOS DINT Pro Con OS error number Error BOOL TRUE = error in function block Error ID DINT Error number 7.8 General special functions 7.8.1 Reading system variables Description The function block KRC_Read Sys Var can be used to read system variables. TF5120 Version: 2.0.0 79
## Page 80

Function blocks KRC_Read Sys Var Axis Group Idx INT BOOL Done Execute Cmd BOOL REAL Value1 Index INT REAL Value2 REAL Value3 REAL Value4 REAL Value5 REAL Value6 REAL Value7 REAL Value8 REAL Value9 REAL Value10 BOOL Error DINT Error ID Fig. 36: Function block KRC_Read Sys Var Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Index INT Index of the system variable • 1: $ADVANCE So far, only the system variable $ADVANCE can be read. If required for the customer-specific application, the list of readable system variables can be expanded by KUKA. Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number Value1 … Value10 REAL Value of the system variable If the system variable is a structure type, up to 10 components of the structure can be read. 7.8.2 Writing system variables Description The function block KRC_Write Sys Var can be used to write system variables. 80 Version: 2.0.0 TF5120
## Page 81

Function blocks KRC_Write Sys Var Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Index INT BOOL Aborted Value1 REAL BOOL Error Value2 REAL DINT Error ID Value3 REAL Value4 REAL Value5 REAL Value6 REAL Value7 REAL Value8 REAL Value9 REAL Value10 REAL b Continue BOOL Buffer Mode INT Fig. 37: Function block KRC_Write Sys Var Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Index INT Index of the system variable • 1: $ADVANCE Value1 … Value10 REAL Value of the system variable If the system variable is a structure type, up to 10 components of the structure can be written. b Continue BOOL TRUE = write to system variable without advance run stop Note: Only possible for specific system variables. Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) So far, only the system variable $ADVANCE can be written. If required for the customer-specific application, the list of writable system variables can be expanded by KUKA. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 81
## Page 82

Function blocks 7.8.3 Calling a brake test Description The function block KRC_Brake Test calls the program for the brake test. The brake test is started at the position at which the robot is located when the program is called. The brake test must be performed with a program override of 100% (function block KRC_Set Override). During the brake test, all brakes are checked to see whether the wear limit has been reached. For this purpose, the robot accelerates to a defined velocity limit. Once the robot has reached the velocity, the brake is applied and the result for this braking operation is displayed. If the brake test is successful, the robot is located back at the start position at the end of the measurement. If the brake test fails, i.e. a brake has been identified as being defective, the robot moves directly to a parking position. The coordinates of the parking position must be specified in the function block. Parking position The parking position must be selected in a position where no persons are endangered if the robot sags because of the defective brake. The transport position, for example, can be selected as the parking position. Further information about the transport position is contained in the robot operating or assembly instructions. Detailed information about the brake test is contained in the operating and programming instructions for the KUKA System Software (KSS). KRC_Brake Test Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Park Position E6POS BOOL Done Park Velocity INT BOOL Aborted Park Acceleration INT DINT Result Park Coordinate System COORDSYS BOOL Error Buffer Mode INT DINT Error ID Fig. 38: Function block KRC_Brake Test Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Park Position E6POS Coordinates of the Cartesian parking position (>>> E6POS [} 20]) The data structure E6POS contains all components of the parking position (= position of the TCP relative to the origin of the selected coordinate system). Park Velocity INT Velocity 82 Version: 2.0.0 TF5120
## Page 83

Function blocks Parameter Type Description • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. Default: 0% (= velocity is not changed) Park Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. Default: 0% (= acceleration is not changed) Park Coordinate Syst COORDSYS Coordinate system to which the Cartesian coordinates of the em parking position refer (>>> COORDSYS [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped Aborted BOOL TRUE = statement/motion has been aborted Result DINT Result of the brake test • 0: brake test failed (brake identified as defective or no connection to robot controller) • 1: brake test successful (no brake defective, but at least one brake has reached the wear limit) • 2: brake test successful (no brake defective or reached wear limit) Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.4 Calling a mastering test Description The function block KRC_Mas Ref is used to execute the mastering test. After the function block has been called, the robot moves in a linear direction from the current position to the reference position. Once the robot has reached the reference position, the current axis values are compared with the axis values which have been saved in KUKA. Safe Operation. The robot then moves back to the start position (= position before the function block was called). The reference position is defined in the function block with the input parameter Position and corresponds to the reference position defined with KUKA. Safe Operation. If the deviation between the current position and the reference position is too great, the mastering test has failed. TF5120 Version: 2.0.0 83
## Page 84

Function blocks Detailed information about the mastering test can be found in the KUKA. Safe Operation documentation. KRC_Mas Ref Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Position E6POS BOOL Done Velocity INT BOOL Aborted Acceleration INT BOOL Error Coordinate System COORDSYS DINT Error ID Buffer Mode INT BOOL Mas Ref Request Fig. 39: Function block KRC_Mas Ref Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Position E6POS Coordinates of the Cartesian reference position (>>> E6POS [} 20]) The data structure E6POS contains all components of the reference position (= position of the TCP relative to the origin of the selected coordinate system). Velocity INT Velocity • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. Default: 0% (= velocity is not changed) Acceleration INT Acceleration • 0 … 100% Refers to the maximum value specified in the machine data. The maximum value is dependent on the robot type. Default: 0% (= acceleration is not changed) Coordinate System COORDSYS Coordinate system to which the Cartesian coordinates of the reference position refer (>>> COORDSYS [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = motion is currently being executed Done BOOL TRUE = motion has stopped 84 Version: 2.0.0 TF5120
## Page 85

Function blocks Parameter Type Description Aborted BOOL TRUE = statement/motion has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number Mas Ref Request BOOL TRUE = mastering test has been requested internally by the robot controller 7.8.5 Reading the safety controller signals Description The function block KRC_Read Safe OPStatus reads signals of the safety controller. (Only relevant if KUKA. Safe Operation is installed.) KRC_Read Safe OPStatus Axis Group Idx INT BOOL Valid MASTERINGTEST_REQ_EXT BOOL BOOL BRAKETEST_REQ_INT BRAKETEST_REQ_EXT BOOL BOOL MASTERINGTEST_REQ_INT BOOL BRAKETEST_MONTIME BOOL BRAKETEST_WORK BOOL BRAKES_OK BOOL BRAKETEST_WARN BOOL MASTERINGTESTSWITCH_OK BOOL Error DINT Error ID Fig. 40: Function block KRC_Read Safe OPStatus Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 MASTERINGTEST_REQ_EXT BOOL TRUE = mastering test requested by the PLC BRAKETEST_REQ_EXT BOOL TRUE = brake test requested by the PLC. Outputs Parameter Type Description Valid BOOL TRUE = data are valid BRAKETEST_REQ_INT BOOL TRUE = brake test requested by the safety controller. MASTERINGTEST_REQ_INT BOOL TRUE = mastering test requested by the safety controller. BRAKETEST_MONTIME BOOL TRUE = robot was stopped due to elapsed brake test monitoring time. BRAKETEST_WORK BOOL TRUE = brake test is currently being performed BRAKES_OK BOOL Edge TRUE --> FALSE: A brake has been identified as defective. BRAKETEST_WARN BOOL Edge FALSE --> TRUE: At least 1 brake has been detected as having reached the wear limit. MASTERINGTESTSWITCH_OK BOOL TRUE = reference switch is OK. Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 85
## Page 86

Function blocks 7.8.6 Reading the state of the Touch Up status keys Description The function block KRC_Read Touch UPState reads the current state of the Touch Up status keys on the smart PAD. In order to be able to teach points using the status keys on the smart PAD, the function block must be linked to the function block KRC_Touch UP. KRC_Read Touch UPState Axis Group Idx INT BOOL Valid BOOL Touch UP INT Index BOOL Error DINT Error ID Fig. 41: Function block KRC_Read Touch UPState Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Valid BOOL TRUE = data are valid Touch UP BOOL State of the Touch Up status key on the smart PAD TRUE = Touch Up status key has been pressed. Index INT Number selected using the status key on the smart PAD to teach a position • 1 … 100 Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.7 Teaching points Description The function block KRC_Touch UP can be used to teach a point directly in the PLC. Tool, base and interpolation mode of this point are automatically saved by the function block. KRC_Touch UP Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Error Index INT DINT Error ID ↔ Position Array Reference To POSITION_ARRAY Fig. 42: Function block KRC_Touch UP 86 Version: 2.0.0 TF5120
## Page 87

Function blocks Inputs Parameter Type Description Position Array POSITION_ Array with the taught points and the corresponding coordinate ARRAY systems Note: The array can be used directly in the PLC. (>>> POSITION_ ARRAY [} 21]) Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL TRUE = the point is taught Index INT Number under which the taught point is saved in the PLC • 1 … 100 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.8 Modifying settings for the advance run Description The settings for the advance run are modified using the function block KRC_Set Advance. The advance run is the maximum number of motion blocks that the robot controller calculates and plans in advance during program execution. The actual number is dependent on the capacity of the computer. The advance run is required, for example, in order to be able to calculate approximate positioning motions. If the program execution is reset, the set values are reset to the default values. KRC_Set Advance Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Count INT BOOL Aborted Max Wait Time INT BOOL Error Mode INT DINT Error ID Buffer Mode INT Fig. 43: Function block KRC_Set Advance Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is buffered in the case of a rising edge of the signal. Count INT Number of functions to be transferred before the first robot motion • 1 … 50 TF5120 Version: 2.0.0 87
## Page 88

Function blocks Parameter Type Description Default value: 2 Max Wait Time INT Maximum wait time before the beginning of program execution if the set number of functions is not reached in the parameter count. • 1 … 32 767 ms Default value: 300 ms Mode INT Wait mode • 0: The currently set mode is not changed. • 1: If the first instruction is an approximated motion instruction, the system waits for further instructions. • 2: The system always waits for the number of set functions or for the maximum wait time to elapse. Default value: 1 Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement has been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.9 Reading settings for the advance run Description Function block KRC_Get Advance reads the values that have been set in the function block KRC_Set Advance. Fig. 44: Function block KRC_Get Advance Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. 88 Version: 2.0.0 TF5120
## Page 89

Function blocks Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Count INT Number of functions to be transferred by the PLC before the first robot motion • 1 … 50 Default value: 2 Max Wait Time INT Maximum wait time before the beginning of program execution if the set number of functions is not reached in the parameter count. • 1 … 32 767 ms Default value: 300 ms Mode INT Wait mode • 0: The currently set mode is not changed. • 1: If the first instruction is an approximated motion instruction, the system waits for further instructions. • 2: The system always waits for the number of set functions or for the maximum wait time to elapse. Default value: 1 Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.10 Calculating the Cartesian robot position from the axis angles Description The function block KRC_Forward uses specified axis angles to calculate the Cartesian robot position. KRC_Forward Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Axis_Values E6AXIS E6POS Position Check Soft End BOOL BOOL Error Buffer Mode INT DINT Error ID Fig. 45: Function block KRC_Forward Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the statement at a rising edge of the signal. Axis_Values E6AXIS Axis-specific values that are to be converted to Cartesian coordinates (>>> E6AXIS [} 20]) The data structure E6AXIS contains the angle values or translation values for all axes of the axis group in this position. Check Soft End BOOL Checks whether the specified axis angles lie within the software limit switches. If not, an error number is displayed. Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED TF5120 Version: 2.0.0 89
## Page 90

Function blocks Parameter Type Description (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Position E6POS Cartesian robot position calculated from the specified axis angles Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.11 Calculating the Cartesian robot position from the axis angles (advanced) Description The function block KRC_Forward Advanced uses specified axis angles to calculate the Cartesian robot position. The TOOL and BASE coordinate systems and the interpolation mode are included in the calculation. The function is executed automatically in Buffer Mode 0 and can therefore be used independently of the motion execution. The specified value for the interpolation mode must match the current value on the robot controller. KRC_Forward Advanced Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Axis_Values E6AXIS E6POS Position Check Soft End BOOL BOOL Aborted Coordinate System COORDSYS BOOL Error DINT Error ID Fig. 46: Function block KRC_Forward Advanced Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the statement at a rising edge of the signal. Axis_Values E6AXIS Axis-specific values that are to be converted to Cartesian coordinates (>>> E6AXIS [} 20]) The data structure E6AXIS contains the angle values or translation values for all axes of the axis group in this position. Check Soft End BOOL Checks whether the specified axis angles lie within the software limit switches. If not, an error number is displayed. 90 Version: 2.0.0 TF5120
## Page 91

Function blocks Parameter Type Description Coordinate System COORDSYS Specification of the TOOL and BASE coordinate system and the interpolation mode (>>> COORDSYS [} 19]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Position E6POS Cartesian robot position calculated from the specified axis angles Note: External axes E4 to E6 are not taken into consideration in the calculation. Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.12 Calculating axis angles from the Cartesian robot position Description The function block KRC_Inverse uses a specified Cartesian robot position to calculate the axis angles. KRC_Inverse Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Position E6POS E6AXIS Axis Position Pos Valid S BOOL BOOL Aborted Pos Valid T BOOL BOOL Error Start_Axis E6AXIS DINT Error ID Check Soft End BOOL Buffer Mode INT Fig. 47: Function block KRC_Inverse Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the statement at a rising edge of the signal. Position E6POS Cartesian robot position Pos Valid S BOOL TRUE = The Status value contained in the Position parameter is valid. FALSE = The Status value is unknown. Pos Valid T BOOL TRUE = The Turn value contained in the Position parameter is valid. FALSE = The Turn value is unknown. Start_Axis E6Axis Axis-specific values at the start point of the motion The start point is the axis-specific position from which the robot moves to the position that is to be calculated. Check Soft End BOOL Checks whether the values from the Start_Axis parameter lie within the software limit switches. If not, an error number is displayed. Buffer Mode INT Mode in which the statement is executed TF5120 Version: 2.0.0 91
## Page 92

Function blocks Parameter Type Description • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Axis Position E6AXIS Axis angles that have been calculated from the specified Cartesian robot position (>>> E6AXIS [} 20]) The data structure E6AXIS contains all the axis positions of the axis group. Aborted BOOL TRUE = statement was aborted before it was processed in the advance run Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.13 Calculating axis angles from the Cartesian robot position (advanced) Description The function block KRC_Inverse Advanced uses a specified Cartesian robot position to calculate the axis angles. The TOOL and BASE coordinate systems and the interpolation mode are included in the calculation. The function is executed automatically in Buffer Mode 0 and can therefore be used independently of the motion execution. The specified value for the interpolation mode must match the current value on the robot controller. KRC_Inverse Advanced Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Position E6POS E6AXIS Axis Position Pos Valid S BOOL BOOL Aborted Pos Valid T BOOL BOOL Error Start_Axis E6AXIS DINT Error ID Check Soft End BOOL Coordinate System COORDSYS Fig. 48: Function block KRC_Inverse Advanced Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the statement at a rising edge of the signal. 92 Version: 2.0.0 TF5120
## Page 93

Function blocks Parameter Type Description Position E6POS Cartesian robot position Note: External axes E4 to E6 are not taken into consideration in the calculation. Pos Valid S BOOL TRUE = the Status value contained in the Position parameter is valid. FALSE = the Status value is unknown. Pos Valid T BOOL TRUE = the Turn value contained in the Position parameter is valid. FALSE = the Turn value is unknown. Start_Axis E6Axis Axis-specific values at the start point of the motion The start point is the axis-specific position from which the robot moves to the position that is to be calculated. Check Soft End BOOL Checks whether the values from the Start_Axis parameter lie within the software limit switches. If not, an error number is displayed. Coordinate System COORDSYS Specification of the TOOL and BASE coordinate system and the interpolation mode (>>> COORDSYS [} 19]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Axis Position E6AXIS Axis angles that have been calculated from the specified Cartesian robot position (>>> E6AXIS [} 20]) The data structure E6AXIS contains all the axis positions of the axis group. Aborted BOOL TRUE = statement was aborted before it was processed in the advance run Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.14 Executing KRL programs Description The function block KRC_Tech Function is used to execute KRL programs in the robot interpreter or submit interpreter. The parameter Buffer Mode can be used to select the mode in which the program is executed. KRC_Tech Function Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Tech Function ID INT BOOL Done Parameter Count INT BOOL Aborted Buffer Mode INT BOOL Error ↔ BOOL_DATA Reference To BOOL_ARRAY_40 DINT Error ID ↔ INT_DATA Reference To INT32_ARRAY_40 ↔ REAL_DATA Reference To REAL_ARRAY_40 Fig. 49: Function block KRC_Tech Function TF5120 Version: 2.0.0 93
## Page 94

Function blocks Inputs Parameter Type Description BOOL_DATA ARRAY [1 … 40] OF Array of type BOOL as transfer parameter BOOL INT_DATA ARRAY [1 … 40] OF Array of type DINT as transfer parameter DINT REAL_DATA ARRAY [1 … 40] OF Array of type REAL as transfer parameter REAL Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tech Function ID INT ID for selecting the function at KRL level (SWITCH CASE ID) Parameter Count INT Maximum variable index that can be used for the parameters BOOL_DATA, INT_DATA and REAL_DATA • 1 … 40 Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.8.15 Executing KRL programs (advanced) Description The function block KRC_Tech Function Advanced is used to execute KRL programs in the submit interpreter. The return values of the KRL function are output in the parameter Return Value. KRC_Tech Function Advanced Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Tech Function ID INT BOOL Done Parameter Count INT BOOL Aborted ↔ BOOL_DATA Reference To BOOL_ARRAY_40 BOOL Error ↔ INT_DATA Reference To INT32_ARRAY_40 DINT Error ID ↔ REAL_DATA Reference To REAL_ARRAY_40 REAL_ARRAY_12 Return Value Fig. 50: Function block KRC_Tech Function Advanced 94 Version: 2.0.0 TF5120
## Page 95

Function blocks Inputs Parameter Type Description BOOL_DATA ARRAY [1 … 40] OF Array of type BOOL as transfer parameter BOOL INT_DATA ARRAY [1 … 40] OF Array of type DINT as transfer parameter DINT REAL_DATA ARRAY [1 … 40] OF Array of type REAL as transfer parameter REAL Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tech Function ID INT ID for selecting the function at KRL level (SWITCH CASE ID) Parameter Count INT Maximum variable index that can be used for the parameters BOOL_DATA, INT_DATA and REAL_DATA • 1 … 40 Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number Return Value ARRAY [1 … 12] OF Array of type REAL as return values from the KRL function REAL 7.8.16 Displaying the current robot position in a different coordinate system Description The function block KRC_Activate Pos Conversion can be used to display the current robot position relative to the selected TOOL or BASE coordinate system or interpolation mode. KRC_Activate Pos Conversion Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Activate Conversion BOOL BOOL Aborted Coord Sys To Display COORDSYS BOOL Error DINT Error ID Fig. 51: Function block KRC_Activate Pos Conversion Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 TF5120 Version: 2.0.0 95
## Page 96

Function blocks Parameter Type Description Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Activate Conversion BOOL TRUE = current robot position is displayed in the selected coordinate system. FALSE = current robot position is displayed in the current coordinate system of the robot controller. Coord Sys To Display COORDSYS Coordinate system in which the current robot position is to be displayed. (>>> COORDSYS [} 19]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.9 Special functions for Conveyor 7.9.1 Initializing a conveyor Description The function block KRC_Conv Ini Off is used to initialize a conveyor. The AMI is set to the state #INITIALIZED and the conveyor distance to 0. KRC_Conv Ini Off Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Conveyor Number INT BOOL Aborted Buffer Mode INT BOOL Error DINT Error ID Fig. 52: Function block KRC_Conv Ini Off Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) 96 Version: 2.0.0 TF5120
## Page 97

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.9.2 Activating a conveyor Description The function block KRC_Conv On activates the AMI, i.e. sets it to the #ACTIVE state. If the AMI is activated, the synchronization signals at the input of interface X33 (Fast Measurement) are evaluated. The conveyor offset can be detected out in the background leaving the robot controller free to perform other tasks. This allows the robot to carry out on-the-fly tracking of a part on the conveyor. KRC_Conv On Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Conveyor Number INT BOOL Aborted Buffer Mode INT BOOL Error DINT Error ID Fig. 53: Function block KRC_Conv On Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 97
## Page 98

Function blocks 7.9.3 Tracking a workpiece on the conveyor Description The function block KRC_Conv Follow enables the robot to follow a workpiece on the conveyor. KRC_Conv Follow can be used to define a range on the conveyor in which the robot starts to track the workpiece. If the workpiece has already exceeded the maximum conveyor distance (input Max Distance) when the function block is called, the output Max Distance Reached is set. This function block can only be executed if the AMI has been activated using KRC_Conv On. KRC_Conv Follow Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Conveyor Number INT BOOL Done Start Distance REAL BOOL Aborted Max Distance REAL BOOL Max Distance Reached Buffer Mode INT BOOL Error DINT Error ID Fig. 54: Function block KRC_Conv Follow Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Start Distance REAL Distance traveled by the workpiece while the robot waits before starting to track the workpiece on the conveyor. • In the case of a linear conveyor: Specification in millimeters • In the case of a circular conveyor: Specification in degrees Max Distance REAL Maximum distance traveled by the workpiece before the robot starts to synchronize itself with the workpiece. • In the case of a linear conveyor: Specification in millimeters • In the case of a circular conveyor: Specification in degrees Note: This input is not monitored during synchronized motions of the conveyor. The distance covered by the workpiece is monitored by an interrupt. The corresponding settings are made in Work Visual. Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) 98 Version: 2.0.0 TF5120
## Page 99

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Max Distance Reached BOOL TRUE = the maximum distance traveled by the workpiece (input Max Distance) was already exceeded at the time of execution. The statement was not executed. Execution of the program is stopped (WAIT FOR FALSE) and is waiting for the program to be aborted. Error BOOL TRUE = error in function block Error ID DINT Error number 7.9.4 Picking up a workpiece from the conveyor Description The function block KRC_Conv Skip is used to determine which workpieces are to be picked up, e.g. every second workpiece, every third workpiece, etc. A total of up to 1024 workpieces can be monitored in the background. If the workpiece has already exceeded the maximum conveyor distance (input Max Distance) when the function block is called, the output Max Distance Reached is set. This function block can only be executed if the AMI has been activated using KRC_Conv On. KRC_Conv Skip Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Conveyor Number INT BOOL Done Piece Number INT BOOL Aborted Start Distance REAL BOOL Max Distance Reached Max Distance REAL BOOL Error Buffer Mode INT DINT Error ID Fig. 55: Function block KRC_Conv Skip Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Piece Number INT The number entered specifies which workpieces are to be picked up. Examples: • 1: Every workpiece is picked up. • 3: Every 3rd workpiece is picked up. • 5: Every 5th workpiece is picked up. TF5120 Version: 2.0.0 99
## Page 100

Function blocks Parameter Type Description Start Distance REAL Distance traveled by the workpiece while the robot waits before starting to track the workpiece on the conveyor. • In the case of a linear conveyor: Specification in millimeters • In the case of a circular conveyor: Specification in degrees Max Distance REAL Maximum distance traveled by the workpiece before the robot starts to synchronize itself with the workpiece. • In the case of a linear conveyor: Specification in millimeters • In the case of a circular conveyor: Specification in degrees Note: This input is not monitored during synchronized motions of the conveyor. The distance covered by the workpiece is monitored by an interrupt. The corresponding settings are made in Work Visual. Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Max Distance Reached BOOL TRUE = the maximum distance traveled by the workpiece (input Max Distance) was already exceeded at the time of execution. The statement was not executed. Execution of the program is stopped (WAIT FOR FALSE) and is waiting for the program to be aborted. Error BOOL TRUE = error in function block Error ID DINT Error number 7.9.5 Deleting a workpiece on the conveyor Description The KRC_Conv Del WPS function block deletes the specified number of workpieces from the workpiece list of the conveyor driver. Deletion starts with the oldest workpiece in the list. KRC_Conv Del WPS Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Conveyor Number INT BOOL Done Piece Number INT BOOL Aborted BOOL Error DINT Error ID Fig. 56: Function block KRC_Conv Del WPS Inputs Parameter Type Description Axis Group Idx INT Index of axis group 100 Version: 2.0.0 TF5120
## Page 101

Function blocks Parameter Type Description • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Piece Number INT Number of workpieces to be deleted Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.9.6 Activating interrupts for monitoring Description The function block KRC_Activate Conv Interrupt activates the following interrupts: • Alarm distance monitoring • Maximum distance monitoring • $STOPMESS error monitoring An interrupt cannot be processed until the interrupt has been activated by the main run of the robot interpreter. The monitoring functions are activated by the function blocks KRC_Conv Follow and KRC_Conv Skip insofar as these have been successfully synchronized with a workpiece. Calling this function block is only necessary if the monitoring function is to be ended and reactivated. KRC_Activate Conv Interrupt Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Conveyor Number INT BOOL Done Buffer Mode INT BOOL Aborted BOOL Error DINT Error ID Fig. 57: Function block KRC_Activate Conv Interrupt Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Buffer Mode INT Mode in which the statement is executed TF5120 Version: 2.0.0 101
## Page 102

Function blocks Parameter Type Description • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.9.7 Deactivating interrupts for monitoring Description The function block KRC_Deactivate Conv Interrupt deactivates the following interrupts: • Alarm distance monitoring • Maximum distance monitoring • $STOPMESS error monitoring It is advisable to call this function block if leaving the conveyor area, or if monitoring is not desired. KRC_Deactivate Conv Interrupt Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Active Conveyor Number INT BOOL Done Buffer Mode INT BOOL Aborted BOOL Error DINT Error ID Fig. 58: Function block KRC_Deactivate Conv Interrupt Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Conveyor Number INT Number of the conveyor • 1 … 3 Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) 102 Version: 2.0.0 TF5120
## Page 103

Function blocks Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Active BOOL TRUE = statement is currently being executed Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.10 Special functions for Vector Move 7.10.1 Activating a motion along a vector Description The function block KRC_Vector Move On is used to move a robot along a defined vector in Cartesian space. Here, the robot is moved by an external force. KRC_Vector Move On Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done X REAL BOOL Aborted Y REAL BOOL Error Z REAL DINT Error ID A REAL B REAL C REAL Vector Limit REAL Max Duration REAL Torque Offset Value REAL Buffer Mode INT Fig. 59: Function block KRC_Vector Move On Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. X REAL Defines the direction of the vector Y REAL The vector must be specified in relation to the TCP of the TOOL Z REAL coordinate system. The last taught point before the function block is called is the root point of the vector. A REAL Limits: B REAL C REAL • Translational motion (X, Y, Z): max. 200 mm in the positive and negative directions • Rotational motion (A, B, C): max. 30° in the positive and negative directions Vector Limit REAL Permissible vector length limit TF5120 Version: 2.0.0 103
## Page 104

Function blocks Parameter Type Description If this value is exceeded, the robot is stopped with ramp-down braking. • 0 … 30% Default: 10% Max Duration REAL Length of time after which Vector Move is deactivated if an error has occurred • 0 … 10000 s Default: 100 s Torque Offset Value REAL Defines the resistance torque of the robot (unit: Nm) The resistance torque is the torque with which the robot acts against the external force. It has the effect that the robot only begins to move when a specific amount of force is exerted. The resistance torque can be defined in addition to the holding torque. The holding torque depends on the robot position, type, size and additional load. • 1 … 200 Nm Default: 1 Nm Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.10.2 Deactivating motion along a vector Description The function block KRC_Vector Move Off is used to deactivate the motion along a vector. KRC_Vector Move Off Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Buffer Mode INT BOOL Aborted BOOL Error DINT Error ID Fig. 60: Function block KRC_Vector Move Off Inputs Parameter Type Description Axis Group Idx INT Index of axis group 104 Version: 2.0.0 TF5120
## Page 105

Function blocks Parameter Type Description • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.11 Special functions for Load Data Determination 7.11.1 Configuring load data determination Description The function block KRC_LDDconfig is used to configure load data determination. A precondition for execution of the function block is that the function block KRC_LDDcheck Pos has been successfully executed beforehand. KRC_LDDconfig Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Load A3Settings INT BOOL Error Warm Up BOOL DINT Error ID M_A3 REAL X_A3 REAL Y_A3 REAL Z_A3 REAL A_A3 REAL B_A3 REAL C_A3 REAL JX_A3 REAL JY_A3 REAL JZ_A3 REAL Mass REAL Fig. 61: Function block KRC_LDDconfig Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 TF5120 Version: 2.0.0 105
## Page 106

Function blocks Parameter Type Description Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Load A3Settings INT • 0: No supplementary load on axis 3 • 1: Maximum permissible load on axis 3 for the robot ($DEF_LA3_M, $DEF_LA3_CM, $DEF_LA3_J) • 2: Values from LOAD_A3_DATA defined during start-up are used (default) • 3: Transferred data from the function block are applied and saved in the file $config.dat Warm Up BOOL TRUE = a warm-up is carried out before load data determination. TRUE = no warm-up is carried out before load data determination. M_A3 REAL Mass of the supplementary load on axis 3 X_A3 REAL Position of the center of mass of the supplementary load on axis 3 relative to the FLANGE coordinate system Y_A3 Z_A3 A_A3 REAL Orientation of the center of mass of the supplementary load on axis 3 relative to the FLANGE coordinate system B_A3 C_A3 JX_A3 REAL Mass moments of inertia of the supplementary load on axis 3 relative to the FLANGE coordinate system JY_A3 JZ_A3 Mass REAL • ≤ 0: Payload is automatically determined • > 0: Payload is already known from CAD data or a measurement Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.11.2 Checking the start position of the load data determination Description The function block KRC_LDDcheck Pos is used to check the start position for load data determination. If the start position is not suitable, an error number is generated. KRC_LDDcheck Pos Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done BOOL Error DINT Error ID Fig. 62: Function block KRC_LDDcheck Pos Inputs Parameter Type Description Axis Group Idx INT Index of axis group 106 Version: 2.0.0 TF5120
## Page 107

Function blocks Parameter Type Description • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.11.3 Carrying out a test run before load data determination Description The function block KRC_LDDtest Run is used to carry out a test run without determination of the load data. The motion sequence for load data determination is carried out at low velocity. The purpose of the test run is to avoid possible collisions during load data determination. The test run before load data determination must be performed with a program override of ≤10% (function block KRC_Set Override). KRC_LDDtest Run Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done BOOL Error DINT Error ID Fig. 63: Function block KRC_LDDtest Run Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 107
## Page 108

Function blocks 7.11.4 Carrying out load data determination Description The function block KRC_LDDstart is used to perform load data determination. The load data determination must be performed with a program override of 100% (function block KRC_Set Override). KRC_LDDstart Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Tool INT BOOL Error DINT Error ID Fig. 64: Function block KRC_LDDstart Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tool INT Number of the tool for which load data determination is to be carried out • 1 … maximum number of tools Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.11.5 Assigning the load data Description The function block KRC_LDDwrite Load assigns the determined load data to the specified tool. It is always the most recently determined load data that are used. It is thus also possible to assign the most recently determined load data to multiple tools. KRC_LDDwrite Load Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Buffer Mode INT BOOL Error Tool INT DINT Error ID Fig. 65: Function block KRC_LDDwrite Load 108 Version: 2.0.0 TF5120
## Page 109

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Tool INT Number of the tool to which the load data are to be assigned • 1 … maximum number of tools Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number 7.12 Special functions for workspaces 7.12.1 Configuring Cartesian workspaces Description The function block KRC_Write Workspace is used to configure Cartesian (= cubic) workspaces for the robot. Workspaces serve to protect the system. A maximum of 8 Cartesian workspaces can be configured at any one time. The workspaces may overlap. KRC_Write Workspace Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Workspace No INT BOOL Aborted Workspace Mode INT BOOL Error Workspace Data BOX DINT Error ID Buffer Mode INT Fig. 66: Function block KRC_Write Workspace Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Workspace No INT Number of workspace • 1 … 8 Workspace Mode INT Mode for workspaces TF5120 Version: 2.0.0 109
## Page 110

Function blocks Parameter Type Description • 0: #OFF • 1: #INSIDE • 2: #OUTSIDE • 3: #INSIDE_STOP • 4: #OUTSIDE_STOP Note: Further information about the mode for workspaces is contained in the operating and programming instructions for the KUKA System Software (KSS). Workspace Data BOX Data of the workspace (>>> Data of a Cartesian workspace [} 21]) Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.12.2 Reading the configuration of Cartesian workspaces Description The function block KRC_Read Workspace reads the configuration of the Cartesian workspaces for the robot. KRC_Read Workspace Axis Group Idx INT BOOL Done Execute Cmd BOOL INT Workspace Mode Workspace No INT BOX Workspace Data BOOL Error DINT Error ID Fig. 67: Function block KRC_Read Workspace Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Workspace No INT Number of workspace • 1 … 8 110 Version: 2.0.0 TF5120
## Page 111

Function blocks Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Workspace Mode INT Mode for workspaces • 0: #OFF • 1: #INSIDE • 2: #OUTSIDE • 3: #INSIDE_STOP • 4: #OUTSIDE_STOP Note: Further information about the mode for workspaces is contained in the operating and programming instructions for the KUKA System Software (KSS). Workspace Data BOX Data of the workspace (>>> Data of a Cartesian workspace [} 21]) Error BOOL TRUE = error in function block Error ID DINT Error number 7.12.3 Configuring axis-specific workspaces Description The function block KRC_Write Ax Workspace is used to configure axis-specific workspaces for the robot. These serve to protect the system. A maximum of 8 axis-specific workspaces can be configured at any one time. The workspaces may overlap. KRC_Write Ax Workspace Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Workspace No INT BOOL Aborted Workspace Mode INT BOOL Error Workspace Data AXBOX DINT Error ID Buffer Mode INT Fig. 68: Function block KRC_Write Ax Workspace Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Workspace No INT Number of workspace • 1 … 8 Workspace Mode INT Mode for workspaces • 0: #OFF • 1: #INSIDE • 2: #OUTSIDE • 3: #INSIDE_STOP • 4: #OUTSIDE_STOP TF5120 Version: 2.0.0 111
## Page 112

Function blocks Parameter Type Description Note: Further information about the mode for workspaces is contained in the operating and programming instructions for the KUKA System Software (KSS). Workspace Data AXBOX Data of the workspace (>>> Data of an axis-specific workspace [} 22]) Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.12.4 Reading the configuration of axis-specific workspaces Description The function block KRC_Read Ax Workspace reads the configuration of the axis-specific workspaces for the robot. KRC_Read Ax Workspace Axis Group Idx INT BOOL Done Execute Cmd BOOL INT Workspace Mode Workspace No INT AXBOX Workspace Data BOOL Error DINT Error ID Fig. 69: Function block KRC_Read Ax Workspace Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL Starts/buffers the motion in the case of a rising edge of the signal. Workspace No INT Number of workspace • 1 … 8 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Workspace Mode INT Mode for workspaces 112 Version: 2.0.0 TF5120
## Page 113

Function blocks Parameter Type Description • 0: #OFF • 1: #INSIDE • 2: #OUTSIDE • 3: #INSIDE_STOP • 4: #OUTSIDE_STOP Note: Further information about the mode for workspaces is contained in the operating and programming instructions for the KUKA System Software (KSS). Workspace Data AXBOX Data of the workspace (>>> Data of an axis-specific workspace [} 22]) Error BOOL TRUE = error in function block Error ID DINT Error number 7.12.5 Reading the status of the workspaces Description The function block KRC_Read Workstates reads the current status of the workspaces. The status of the workspaces is updated cyclically. KRC_Read Workstates Axis Group Idx INT BOOL Valid BOOL WORKSTATE1 BOOL WORKSTATE2 BOOL WORKSTATE3 BOOL WORKSTATE4 BOOL WORKSTATE5 BOOL WORKSTATE6 BOOL WORKSTATE7 BOOL WORKSTATE8 BOOL AXWORKSTATE1 BOOL AXWORKSTATE2 BOOL AXWORKSTATE3 BOOL AXWORKSTATE4 BOOL AXWORKSTATE5 BOOL AXWORKSTATE6 BOOL AXWORKSTATE7 BOOL AXWORKSTATE8 BOOL Error DINT Error ID Fig. 70: Function block KRC_Read Workstates Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Valid BOOL TRUE = data are valid TF5120 Version: 2.0.0 113
## Page 114

Function blocks Parameter Type Description WORKSTATE1 BOOL Status of the workspaces WORKSTATE2 BOOL WORKSTATE3 BOOL WORKSTATE4 BOOL WORKSTATE5 BOOL WORKSTATE6 BOOL WORKSTATE7 BOOL WORKSTATE8 BOOL AXWORKSTATE1 BOOL AXWORKSTATE2 BOOL AXWORKSTATE3 BOOL AXWORKSTATE4 BOOL AXWORKSTATE5 BOOL AXWORKSTATE6 BOOL AXWORKSTATE7 BOOL AXWORKSTATE8 BOOL Error BOOL TRUE = error in function block Error ID DINT Error number 7.13 Administrative functions 7.13.1 Reading outputs of the robot system Description The function block KRC_Read Axis Group is used to assign the parameter KRC4_Input to the parameter Axis Group Idx. The following function blocks always refer to the same robot system using the parameter Axis Group Idx. The function block KRC_Read Axis Group must always be called at the start of the program. Access to the parameter Axis Group Idx is only permissible between the function blocks KRC_Read Axis Group and KRC_Write Axis Group. The function block may only be instanced once per axis group. In the case of multiple instancing, the signals of the most recently called function block are output. KRC_Read Axis Group KRC4_Input Pointer To BYTE BOOL Error Axis Group Idx INT DINT Error ID Fig. 71: Function block KRC_Read Axis Group Inputs Parameter Type Description KRC4_Input POINTER TO BYTE Defines the start index of the output range of the robot controller Axis Group Idx INT Index of axis group • 1 … 5 114 Version: 2.0.0 TF5120
## Page 115

Function blocks Outputs Parameter Type Description Error ID DINT Error number Error BOOL TRUE = error in function block 7.13.2 Writing robot system inputs Description The function block KRC_Write Axis Group uses the parameter Axis Group Idx to write the inputs to the range defined by the parameter KRC4_Output. The function block KRC_Write Axis Group must always be called at the end of the program. Access to Axis Group Idx is only permissible between the function blocks KRC_Read Axis Group and KRC_Write Axis Group. The function block may only be instanced once per axis group. In the case of multiple instancing, the signals of the most recently called function block are output. KRC_Write Axis Group Axis Group Idx INT BOOL Error KRC4_Output Pointer To BYTE DINT Error ID Fig. 72: Function block KRC_Write Axis Group Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 KRC4_Output POINTER TO BYTE Defines the start index of the input range of the robot controller Outputs Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.3 Initializing the mx A interface Description The function block KRC_Initialize initializes the mx A interface on the robot controller. Statements cannot be transferred until the interface has been initialized. The function block may only be instanced once per axis group. In the case of multiple instancing, the signals of the most recently called function block are output. TF5120 Version: 2.0.0 115
## Page 116

Function blocks KRC_Initialize Axis Group Idx INT BOOL Done BOOL Error DINT Error ID DINT KRC_Serial DINT KRC_Major DINT KRC_Minor DINT KRC_Revision DINT KRC_Abs Accur DINT PLC_Major DINT PLC_Minor DINT PLC_Revision Fig. 73: Function block KRC_Initialize Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Done BOOL TRUE = initialization successfully completed Error BOOL TRUE = error in function block Error ID DINT Error number KRC_Serial DINT Serial number of the robot controller KRC_Major DINT Version identifier of the mx A interface (1st digit) KRC_Minor DINT Version identifier of the mx A interface (2nd digit) KRC_Revision DINT Version identifier of the mx A interface (3rd digit) KRC_Abs Accur DINT Version identifier of the positionally accurate robot model • 1: ACTIVE (= positionally accurate robot model is loaded and is being used. A positionally accurate robot model is saved on the RDC.) • 2: INACTIVE (= positionally accurate robot model is loaded, but is not used. A positionally accurate robot model is saved on the RDC, but it is currently deactivated (until the next cold start of the robot controller).) • 3: NONE (= standard robot model. No positionally accurate robot model is used. No positionally accurate robot model is saved on the RDC.) PLC_Major DINT Version identifier of the PLC library (1st digit) PLC_Minor DINT Version identifier of the PLC library (2nd digit) PLC_Revision DINT Version identifier of the PLC library (3rd digit) 7.13.4 Setting the program override (POV) Description The function block KRC_Set Override sets the program override. 116 Version: 2.0.0 TF5120
## Page 117

Function blocks Program override is the velocity of the robot during program execution. It is specified as a percentage of the programmed velocity. The override setting is transferred to the robot during every PLC cycle. If the override setting is changed, this change is detected by the robot and applied. The override is only applied in Automatic External mode so that the override can be set via the smart PAD in the test modes T1 and T2, e.g. for teaching. The program override refers to all motions of the robot system. The function block may only be instanced once per axis group. In the case of multiple instancing, the signals of the most recently called function block are output. KRC_Set Override Axis Group Idx INT BOOL Valid Override INT INT Actual Override BOOL Error DINT Error ID Fig. 74: Function block KRC_Set Override Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Override INT Program override • 0 … 100% Outputs Parameter Type Description Valid BOOL TRUE = data are valid Actual Override INT Current override setting • 0 … 100% Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.5 Activating and reading Automatic External signals from the robot controller Description The function block KRC_Automatic External activates the Automatic External interface and reads the interface signals. The function block KRC_Auto Start can be used to simplify use of KRC_Automatic External. (>>> Setting KRC_Automatic External inputs automatically [} 119]) The function block requires the Automatic External mode of the robot system. Further information about this functionality is contained in the operating and programming instructions for the KUKA System Software (KSS). TF5120 Version: 2.0.0 117
## Page 118

Function blocks The function block may only be instanced once per axis group. In the case of multiple instancing, the signals of the most recently called function block are output. KRC_Automatic External Axis Group Idx INT BOOL Valid MOVE_ENABLE BOOL BOOL RC_RDY1 CONF_MESS BOOL BOOL ALARM_STOP DRIVES_ON BOOL BOOL USER_SAFE DRIVES_OFF BOOL BOOL PERI_RDY EXT_START BOOL BOOL ROB_CAL RESET BOOL BOOL IO_ACTCONF ENABLE_T1 BOOL BOOL STOPMESS ENABLE_T2 BOOL BOOL INT_E_STOP ENABLE_AUT BOOL BOOL PRO_ACT ENABLE_EXT BOOL BOOL APPL_RUN BOOL PRO_MOVE BOOL ON_PATH BOOL NEAR_POSRET BOOL ROB_STOPPED BOOL T1 BOOL T2 BOOL AUT BOOL EXT Fig. 75: Function block KRC_Automatic External Inputs Parameter Type Signal name (robot Description controller) Axis Group Idx INT — Index of axis group • 1 … 5 MOVE_ENABLE BOOL $MOVE_ENABLE TRUE = motion enable for the robot Note: This system variable is monitored by the robot controller in all operating modes. CONF_MESS BOOL $CONF_MESS TRUE = acknowledgement of error messages DRIVES_ON BOOL $DRIVES_ON TRUE = activation of the robot drives DRIVES_OFF BOOL $DRIVES_OFF TRUE = deactivation of the robot drives EXT_START BOOL $EXT_START TRUE = start or continuation of robot program execution RESET BOOL — Selects the mx Automation robot program in the case of a rising edge of the signal and starts it. First, all buffered statements are aborted. ENABLE_T1 BOOL — TRUE = enabling of T1 mode The signal $MOVE_ENABLE is suppressed in the absence of enabling. The robot cannot be moved. ENABLE_T2 BOOL — TRUE = enabling of T2 mode The signal $MOVE_ENABLE is suppressed in the absence of enabling. The robot cannot be moved. ENABLE_AUT BOOL — TRUE = enabling of Automatic mode 118 Version: 2.0.0 TF5120
## Page 119

Function blocks Parameter Type Signal name (robot Description controller) The signal $MOVE_ENABLE is suppressed in the absence of enabling. The robot cannot be moved. ENABLE_EXT BOOL — TRUE = enabling of Automatic External mode The signal $MOVE_ENABLE is suppressed in the absence of enabling. The robot cannot be moved. Outputs Parameter Type Signal name (robot Description controller) Valid BOOL — TRUE = data are valid RC_RDY1 BOOL $RC_RDY1 TRUE = robot controller ready for program start ALARM_STOP BOOL $ALARM_STOP FALSE = robot stop by EMERGENCY STOP USER_SAFE BOOL $USER_SAF FALSE = operator safety violated PERI_RDY BOOL $PERI_RDY TRUE = robot drives activated ROB_CAL BOOL $ROB_CAL TRUE = robot axes mastered IO_ACTCONF BOOL $IO_ACTCONF TRUE = Automatic External interface active STOPMESS BOOL $STOPMESS TRUE = safety circuit interrupted (robot fault) INT_E_STOP BOOL Int. E-Stop TRUE = external EMERGENCY STOP FALSE = EMERGENCY STOP device pressed on the smart PAD PRO_ACT BOOL $PRO_ACT TRUE = process active at robot level APPL_RUN BOOL APPL_RUN TRUE = robot program running PRO_MOVE BOOL $PRO_MOVE TRUE = synchronous robot motion active ON_PATH BOOL $ON_PATH TRUE = robot on programmed path NEAR_POSRET BOOL $NEAR_POSRET TRUE = robot near most recently saved position on the programmed path (after leaving path) ROB_STOPPED BOOL $ROB_STOPPED TRUE = robot is at standstill T1 BOOL $T1 TRUE = operating mode T1 selected T2 BOOL $T2 TRUE = operating mode T2 selected AUT BOOL $AUT TRUE = operating mode Automatic selected EXT BOOL $EXT TRUE = operating mode Automatic External selected 7.13.6 Setting KRC_Automatic External inputs automatically Description The function block KRC_Auto Start automatically sets the existing signals of the KRC_Automatic External function block in the correct sequence. This function block can be used to activate the Automatic External interface of the robot system without the need for in-depth knowledge of the individual steps. The signals for activating the Automatic External interface are checked prior to starting. If one or more signals is missing, corresponding error numbers are displayed. The following inputs must additionally be set at the function block KRC_Automatic External: • MOVE_ENABLE • ENABLE_T1 • ENABLE_T2 TF5120 Version: 2.0.0 119
## Page 120

Function blocks • ENABLE_AUT • ENABLE_EXT • DRIVES_OFF All other inputs are set by the function block KRC_Auto Start. KRC_Auto Start Axis Group Idx INT BOOL Busy Execute Reset BOOL BOOL Done BOOL Disp Active BOOL Reset Valid BOOL Error DINT Error ID Fig. 76: Function block KRC_Auto Start Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Reset BOOL Selects the mx Automation robot program in the case of a rising edge of the signal and starts it. The program is reset beforehand and all buffered statements are aborted. Outputs Parameter Type Description Busy BOOL The sequence is active but not yet completed. Done BOOL The sequence is completed. Disp Active BOOL TRUE = robot program is active Reset Valid BOOL TRUE = conditions for a RESET at the function block KRC_Automatic External are met Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.7 Reading the current robot position Description The function block KRC_Read Actual Position reads the current Cartesian actual position of the robot. This is updated cyclically. 120 Version: 2.0.0 TF5120
## Page 121

Function blocks KRC_Read Actual Position Axis Group Idx INT BOOL Valid E6POS Position REAL X REAL Y REAL Z REAL A REAL B REAL C INT Status INT Turn INT Tool INT Base INT IPOMode Fig. 77: Function block KRC_Read Actual Position Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Valid BOOL TRUE = data are valid Position E6POS Current Cartesian actual position ($POS_ACT on the robot controller) The data structure E6POS contains all components of the Cartesian actual position (= position of the TCP relative to the origin of the BASE coordinate system). X, Y, Z REAL Current actual position in the X, Y, Z directions A, B, C REAL Orientation A, B, C in the current actual position Status INT Status of the current actual position Turn INT Turn of the current actual position Tool INT Number of the currently used TOOL coordinate system ($ACT_TOOL_C on the robot controller) Base INT Number of the currently used BASE coordinate system ($ACT_BASE_C on the robot controller) IPOMode INT Current interpolation mode ($IPO_MODE_C on the robot controller) 7.13.8 Reading the current axis position Description The function block KRC_Read Actual Axis Position reads the current axis-specific robot position. This is updated cyclically. TF5120 Version: 2.0.0 121
## Page 122

Function blocks KRC_Read Actual Axis Position Axis Group Idx INT BOOL Valid E6AXIS Axis Position REAL A1 REAL A2 REAL A3 REAL A4 REAL A5 REAL A6 REAL E1 REAL E2 REAL E3 REAL E4 REAL E5 REAL E6 Fig. 78: Function block KRC_Read Actual Axis Position Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Valid BOOL TRUE = data are valid Axis Position E6AXIS Current axis-specific robot position ($AXIS_ACT on the robot controller) The data structure E6AXIS contains all the axis positions of the axis group. A1 … A6 REAL Current position of robot axes A1 to A6 E1 … E6 REAL Current position of external axes E1 to E6 7.13.9 Reading the current path velocity Description The function block KRC_Read Actual Velocity reads the current actual velocity at the TCP of the robot. This is updated cyclically. The current path velocity can only be read for CP motions in program mode. KRC_Read Actual Velocity Axis Group Idx INT BOOL Valid REAL Value Fig. 79: Function block KRC_Read Actual Velocity 122 Version: 2.0.0 TF5120
## Page 123

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Valid BOOL TRUE = data are valid Value REAL Current path velocity ($VEL_ACT on the robot controller) Unit: m/s 7.13.10 Reading the current axis velocity Description The function block KRC_Read Actual Axis Velocity reads the current axis-specific velocity of the robot. KRC_Read Actual Axis Velocity Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Error DINT Error ID INT A1 INT A2 INT A3 INT A4 INT A5 INT A6 INT E1 INT E2 INT E3 INT E4 INT E5 INT E6 Fig. 80: Function block KRC_Read Actual Axis Velocity Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number A1 … A6 INT Current motor speed (-100% … +100%) of A1 … A6, relative to the maximum motor speed ($VEL_AXIS_MA on the robot controller) Note: The actual resulting speed of the robot axis ($VEL_AXIS_ACT on the robot controller) is dependent on the gear ratio. TF5120 Version: 2.0.0 123
## Page 124

Function blocks Parameter Type Description E1 … E6 INT Current motor speed (-100% … +100%) of E1 … E6, relative to the maximum motor speed ($VEL_AXIS_MA on the robot controller) Note: The actual resulting speed of the external axis is dependent on the gear ratio. 7.13.11 Reading the current robot acceleration Description The function block KRC_Read Actual Acceleration reads the current Cartesian acceleration at the TCP of the robot. The current Cartesian acceleration about angles A, B, C is not evaluated. KRC_Read Actual Acceleration Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Error DINT Error ID REAL ACC_ABS REAL X REAL Y REAL Z REAL A REAL B REAL C Fig. 81: Function block KRC_Read Actual Acceleration Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Error BOOL TRUE = error in function block Error ID DINT Error number ACC_ABS REAL Current Cartesian acceleration relative to the absolute value of the overall acceleration ($ACC_CAR_ACT on the robot controller) Unit: m/s2 X, Y, Z REAL Current Cartesian acceleration in the X, Y, Z directions Unit: m/s2 A, B, C REAL Current Cartesian acceleration about angles A, B, C 0 m/s2 (not calculated) 124 Version: 2.0.0 TF5120
## Page 125

Function blocks 7.13.12 Reading a digital input Description The function block KRC_Read Digital Input polls and reads a digital input of the robot controller. KRC_Read Digital Input Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Value Number INT BOOL Error DINT Error ID Fig. 82: Function block KRC_Read Digital Input Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the digital input (corresponds to $IN[1 … 2048] on the robot controller) • 1 … 2048 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Value BOOL Value of the digital input Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.13 Reading digital inputs 1 to 8 Description The function block KRC_Read Digital Input1To8 polls and reads the digital inputs 1 to 8 of the robot controller. KRC_Read Digital Input1To8 Axis Group Idx INT BOOL Valid BOOL IN1 BOOL IN2 BOOL IN3 BOOL IN4 BOOL IN5 BOOL IN6 BOOL IN7 BOOL IN8 BOOL Error DINT Error ID Fig. 83: Function block KRC_Read Digital Input1To8 TF5120 Version: 2.0.0 125
## Page 126

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Outputs Parameter Type Description Valid BOOL TRUE = data are valid IN1 … IN8 BOOL Actual value of the digital input $IN[1] … $IN[8] Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.14 Reading multiple digital inputs Description The function block KRC_Read Digital Input Array polls and reads multiple digital inputs of the robot controller. KRC_Read Digital Input Array Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Values Startnumber INT BOOL Error Length INT DINT Error ID Fig. 84: Function block KRC_Read Digital Input Array Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Startnumber INT Number of the 1st digital input polled (corresponds to $IN[1 … 2048] on the robot controller) • 1 … 2048 Length INT Number of inputs that are polled • 1 … 200 Note: If the number of inputs to be read exceeds the 1 … 2048 range, no error message is generated. Inputs outside of this range are not read. Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Values BOOL[200] Values of the digital inputs Error BOOL TRUE = error in function block Error ID DINT Error number 126 Version: 2.0.0 TF5120
## Page 127

Function blocks 7.13.15 Reading a digital output Description The function block KRC_Read Digital Output polls and reads a digital output of the robot controller. KRC_Read Digital Output Axis Group Idx INT BOOL Done Execute Cmd BOOL BOOL Value Number INT BOOL Error DINT Error ID Fig. 85: Function block KRC_Read Digital Output Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the digital output (corresponds to $OUT[1 … 2048] on the robot controller) • 1 … 2048 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Value BOOL Value of the digital output Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.16 Writing a digital output Description The function block KRC_Write Digital Output writes a digital output or a pulse output on the robot controller. KRC_Write Digital Output Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Number INT BOOL Aborted Value BOOL BOOL Error Pulse REAL DINT Error ID b Continue BOOL Buffer Mode INT Fig. 86: Function block KRC_Write Digital Output Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 TF5120 Version: 2.0.0 127
## Page 128

Function blocks Parameter Type Description Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the digital output (corresponds to $OUT[1 … 2048] on the robot controller) • 1 … 2048 Note: It must be ensured that no outputs are used that are already assigned by the robot system. Example: $OUT[1025] is always TRUE. Value BOOL Value of the digital output Pulse REAL Length of the pulse • 0.0 s No pulse active • 0.1 … 3.0 s Pulse interval = 0.1 s b Continue BOOL TRUE = output written in advance run Note: The robot controller executes programs with an advance run and a main run. Further information about the advance run and main run is contained in the operating and programming instructions for the KUKA System Software (KSS). Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.17 Writing digital outputs 1 to 8 Description The function block KRC_Write Digital Output1To8 writes the digital outputs 1 to 8 on the robot controller. The outputs are written cyclically. 128 Version: 2.0.0 TF5120
## Page 129

Function blocks KRC_Write Digital Output1To8 Axis Group Idx INT BOOL Error OUT1 BOOL DINT Error ID OUT2 BOOL OUT3 BOOL OUT4 BOOL OUT5 BOOL OUT6 BOOL OUT7 BOOL OUT8 BOOL Fig. 87: Function block KRC_Write Digital Output1To8 Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 OUT1 … OUT8 BOOL Setpoint value of the output $OUT[1] … $OUT[8] Outputs Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.18 Reading an analog input Description The function block KRC_Read Analog Input polls and reads an analog input of the robot controller. KRC_Read Analog Input Axis Group Idx INT BOOL Done Execute Cmd BOOL REAL Value Number INT BOOL Error DINT Error ID Fig. 88: Function block KRC_Read Analog Input Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the analog input ($ANIN[1 … 32] on the robot controller) • 1 … 32 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Value REAL Value of the analog input TF5120 Version: 2.0.0 129
## Page 130

Function blocks Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.19 Reading an analog output Description The function block KRC_Read Analog Output polls and reads an analog output of the robot controller. KRC_Read Analog Output Axis Group Idx INT BOOL Done Execute Cmd BOOL REAL Value Number INT BOOL Error DINT Error ID Fig. 89: Function block KRC_Read Analog Output Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the analog output ($ANOUT[1 … 32] on the robot controller) • 1 … 32 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Value REAL Value of the analog output Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.20 Writing an analog output Description The function block KRC_Write Analog Output polls and writes an analog output of the robot controller. KRC_Write Analog Output Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Number INT BOOL Aborted Value REAL BOOL Error b Continue BOOL DINT Error ID Buffer Mode INT Fig. 90: Function block KRC_Write Analog Output 130 Version: 2.0.0 TF5120
## Page 131

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Number INT Number of the analog output ($ANOUT[1 … 32] on the robot controller) • 1 … 32 Value REAL Value of the analog output b Continue BOOL TRUE = output written in advance run Note: The robot controller executes programs with an advance run and a main run. Further information about the advance run and main run is contained in the operating and programming instructions for the KUKA System Software (KSS). Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.21 Selecting the tool, base and interpolation mode Description The function block KRC_Set Coord Sys can be used to set the tool, base and interpolation mode without having to execute a motion at the same time. This function is required, for example, to read the current position in different coordinate systems. Further information about tool and base in the robot system is contained in the operating and programming instructions for the KUKA System Software (KSS). KRC_Set Coord Sys Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Coordinate System COORDSYS BOOL Aborted Buffer Mode INT BOOL Error DINT Error ID Fig. 91: Function block KRC_Set Coord Sys TF5120 Version: 2.0.0 131
## Page 132

Function blocks Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Coordinate System COORDSYS Coordinate system to which the specified values refer (>>> COORDSYS [} 19]) Buffer Mode INT Mode in which the statement is executed • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.22 Reading TOOL data Description The function block KRC_Read Tool Data reads the TOOL data of the robot. KRC_Read Tool Data Axis Group Idx INT BOOL Done Execute Cmd BOOL FRAME Tool Data Tool No INT BOOL Error DINT Error ID Fig. 92: Function block KRC_Read Tool Data Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tool No INT Number of the TOOL coordinate system • 1 … 16: TOOL_DATA[1 … 16] Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Tool Data FRAME The data structure FRAME contains the following TOOL data: 132 Version: 2.0.0 TF5120
## Page 133

Function blocks Parameter Type Description • X, Y, Z: Origin of the TOOL coordinate system relative to the FLANGE coordinate system • A, B, C: Orientation of the TOOL coordinate system relative to the FLANGE coordinate system (>>> FRAME [} 21]) Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.23 Writing TOOL data Description The function block KRC_Write Tool Data writes the TOOL data of the robot. KRC_Write Tool Data Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Tool Data FRAME BOOL Aborted Tool No INT BOOL Error Buffer Mode INT DINT Error ID Fig. 93: Function block KRC_Write Tool Data Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tool Data FRAME The data structure FRAME contains the following TOOL data: • X, Y, Z: Origin of the TOOL coordinate system relative to the FLANGE coordinate system • A, B, C: Orientation of the TOOL coordinate system relative to the FLANGE coordinate system (>>> FRAME [} 21]) Tool No INT Number of the TOOL coordinate system • 1 … 16: TOOL_DATA[1 … 16] Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted TF5120 Version: 2.0.0 133
## Page 134

Function blocks Parameter Type Description Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.24 Reading BASE data Description The function block KRC_Read Base Data reads the BASE data of the robot. KRC_Read Base Data Axis Group Idx INT BOOL Done Execute Cmd BOOL FRAME Base Data Base No INT BOOL Error DINT Error ID Fig. 94: Function block KRC_Read Base Data Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Base No INT Number of the BASE coordinate system • 1 … 32: BASE_DATA[1 … 32] Outputs Parameter Type Description Done BOOL TRUE = statement has been executed Base Data FRAME The data structure FRAME contains the following BASE data: • X, Y, Z: Origin of the BASE coordinate system relative to the WORLD coordinate system • A, B, C: Orientation of the BASE coordinate system relative to the WORLD coordinate system (>>> FRAME [} 21]) Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.25 Writing BASE data Description The function block KRC_Write Base Data writes the BASE data of the robot. 134 Version: 2.0.0 TF5120
## Page 135

Function blocks KRC_Write Base Data Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Base No INT BOOL Aborted Base Data FRAME BOOL Error Buffer Mode INT DINT Error ID Fig. 95: Function block KRC_Write Base Data Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Base No INT Number of the BASE coordinate system • 1 … 32: BASE_DATA[1 … 32] Base Data FRAME The data structure FRAME contains the following BASE data: • X, Y, Z: Origin of the BASE coordinate system relative to the WORLD coordinate system • A, B, C: Orientation of the BASE coordinate system relative to the WORLD coordinate system (>>> FRAME [} 21]) Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.26 Reading the load data Description The function block KRC_Read Load Data reads the load data of the robot (payload data or supplementary load data). Each tool of the robot controller has its own tool load data. The supplementary load data are valid for the entire robot. TF5120 Version: 2.0.0 135
## Page 136

Function blocks KRC_Read Load Data Axis Group Idx INT BOOL Done Execute Cmd BOOL REAL M Tool INT REAL X REAL Y REAL Z REAL A REAL B REAL C REAL JX REAL JY REAL JZ BOOL Error DINT Error ID Fig. 96: Function block KRC_Read Load Data Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tool INT Number of the TOOL coordinate system for reading the payload data or number for reading the supplementary load data • 1 … 16: TOOL_DATA[1 … 16] • -1: Supplementary load A1 • -2: Supplementary load A2 • -3: Supplementary load A3 Outputs Parameter Type Description Done BOOL TRUE = statement has been executed M REAL Mass X, Y, Z REAL Position of the center of gravity relative to the flange A, B, C REAL Orientation of the principal inertia axes relative to the flange JX, JY, JZ REAL Mass moments of inertia Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.27 Writing load data Description The function block KRC_Write Load Data writes the load data of the robot (payload data or supplementary load data). 136 Version: 2.0.0 TF5120
## Page 137

Function blocks KRC_Write Load Data Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done Tool INT BOOL Aborted M REAL BOOL Error X REAL DINT Error ID Y REAL Z REAL A REAL B REAL C REAL JX REAL JY REAL JZ REAL Buffer Mode INT Fig. 97: Function block KRC_Write Load Data Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Tool INT Number of the TOOL coordinate system for writing the payload data or number for writing the supplementary load data • 1 … 16: TOOL_DATA[1 … 16] • -1: Supplementary load A1 • -2: Supplementary load A2 • -3: Supplementary load A3 M REAL Mass X, Y, Z REAL Position of the center of gravity relative to the flange A, B, C REAL Orientation of the principal inertia axes relative to the flange JX, JY, JZ REAL Mass moments of inertia Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 137
## Page 138

Function blocks 7.13.28 Reading the software limit switches of the robot axes Description The function block KRC_Read Soft End reads the software limit switches of the robot axes. KRC_Read Soft End Axis Group Idx INT BOOL Done Execute Cmd BOOL REAL A1_Min REAL A1_Max REAL A2_Min REAL A2_Max REAL A3_Min REAL A3_Max REAL A4_Min REAL A4_Max REAL A5_Min REAL A5_Max REAL A6_Min REAL A6_Max BOOL Error DINT Error ID Fig. 98: Function block KRC_Read Soft End Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Done BOOL TRUE = statement has been executed A1_Min … A6_Min REAL Negative software limit switch of axis A1 … A6 Unit: mm or ° A1_Max … A6_Max REAL Positive software limit switch of axis A1 … A6 Unit: mm or ° Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.29 Reading the software limit switches of the external axes Description The function block KRC_Read Soft End Ext reads the software limit switches of the external axes. 138 Version: 2.0.0 TF5120
## Page 139

Function blocks KRC_Read Soft End Ext Axis Group Idx INT BOOL Done Execute Cmd BOOL REAL E1_Min REAL E1_Max REAL E2_Min REAL E2_Max REAL E3_Min REAL E3_Max REAL E4_Min REAL E4_Max REAL E5_Min REAL E5_Max REAL E6_Min REAL E6_Max BOOL Error DINT Error ID Fig. 99: Function block KRC_Read Soft End Ext Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. Outputs Parameter Type Description Done BOOL TRUE = statement has been executed E1_Min … E6_Min REAL Negative software limit switch of axis E1 … E6 Unit: mm or ° E1_Max … E6_Max REAL Positive software limit switch of axis E1 … E6 Unit: mm or ° Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.30 Writing the software limit switches of the robot axes Description The function block KRC_Write Soft End writes the software limit switches of the robot axes. TF5120 Version: 2.0.0 139
## Page 140

Function blocks KRC_Write Soft End Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done A1_Min REAL BOOL Aborted A1_Max REAL BOOL Error A2_Min REAL DINT Error ID A2_Max REAL A3_Min REAL A3_Max REAL A4_Min REAL A4_Max REAL A5_Min REAL A5_Max REAL A6_Min REAL A6_Max REAL Buffer Mode INT Fig. 100: Function block KRC_Write Soft End Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. A1_Min … A6_Min REAL Negative software limit switch of axis A1 … A6 Unit: mm or ° A1_Max … A6_Max REAL Positive software limit switch of axis A1 … A6 Unit: mm or ° Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number 7.13.31 Writing the software limit switches of the external axes Description The function block KRC_Write Soft End Ext writes the software limit switches of the external axes. 140 Version: 2.0.0 TF5120
## Page 141

Function blocks KRC_Write Soft End Ext Axis Group Idx INT BOOL Busy Execute Cmd BOOL BOOL Done E1_Min REAL BOOL Aborted E1_Max REAL BOOL Error E2_Min REAL DINT Error ID E2_Max REAL E3_Min REAL E3_Max REAL E4_Min REAL E4_Max REAL E5_Min REAL E5_Max REAL E6_Min REAL E6_Max REAL Buffer Mode INT Fig. 101: Function block KRC_Write Soft End Ext Inputs Parameter Type Description Axis Group Idx INT Index of axis group • 1 … 5 Execute Cmd BOOL The statement is executed in the case of a rising edge of the signal. E1_Min … E6_Min REAL Negative software limit switch of axis E1 … E6 Unit: mm or ° E1_Max … E6_Max REAL Positive software limit switch of axis E1 … E6 Unit: mm or ° Buffer Mode INT Mode in which the statement is executed • 0: DIRECT • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) Outputs Parameter Type Description Busy BOOL TRUE = statement is currently being transferred or has already been transferred Done BOOL TRUE = statement has been executed Aborted BOOL TRUE = statement has been aborted Error BOOL TRUE = error in function block Error ID DINT Error number TF5120 Version: 2.0.0 141
## Page 142

Messages 8 Messages 8.1 Error messages of the mx A interface in the robot interpreter No. Message text Cause Remedy 0 — — — 1 INTERNAL ERROR Internal exception error Contact service. 2 ASSERT FAILED Internal exception error 3 OVERFLOW STATUS There are more than 100 status Reduce the number of instructions RETURN QUEUE change feedback messages to be that are buffered simultaneously. (MAIN) transmitted from the robot controller Contact service if this is not to the PLC. 4 OVERFLOW STATUS possible. RETURN QUEUE The data transfer rate is much (TRIGGER) smaller than the processing speed. 5 INVALID COMMAND Internal exception error Contact service. QUEUE INDEX 6 INVALID COMMAND Internal exception error STATE 7 INVALID COMMAND ID Internal exception error 8 INVALID MOVE TYPE Internal exception error 9 OVERFLOW TRIGGER Internal exception error FIFO 10 UNDERFLOW Internal exception error TRIGGER FIFO 11 INVALID TRIGGER Internal exception error FIFO INDEX 12 EXECUTION OF Internal exception error T_AFTER MISSING 13 EXECUTION OF Internal exception error T_START MISSING 14 INVALID Internal exception error ADVANCE_ACT 16 TIMEOUT HEARTBEAT Connection to PLC interrupted Reconnect, then acknowledge FROM PLC error. PLC program stopped Restart PLC program. Connecting line defective or not Replace connecting line or connect connected correctly correctly. 17 INVALID ORDERID Internal exception error Contact service. (INVERSE) 30 INVALID PTP APO An invalid contour parameter was Program valid value (parameter transferred for a PTP movement. Approximate). 31 INVALID CP APO An invalid contour parameter was (>>> APO [} 19]) transferred for a CP movement (LIN, CIRC). 32 INVALID BASE An invalid number for the BASE Specify the number of the BASE NUMBER coordinate system has been coordinate system currently used in programmed in a the robot controller (parameter KRC_Read Base Data or Base No). KRC_Write Base Data function block. • 1 … 32 142 Version: 2.0.0 TF5120
## Page 143

Messages No. Message text Cause Remedy An invalid number for the BASE Specify the number of the BASE coordinate system has been coordinate system currently used in programmed in a KRC_Move or the robot controller (parameter KRC_Jog function block. Coordinate System - COORDSYS. Base). (>>> COORDSYS [} 19]) 33 INVALID TOOL An invalid number for the TOOL Specify the number of the TOOL NUMBER coordinate system has been coordinate system currently used in programmed in a the robot controller (parameter KRC_Read Tool Data or Tool No). KRC_Write Tool Data function block. • 1 … 16 An invalid number for the TOOL Specify the number of the TOOL coordinate system has been coordinate system currently used in programmed in a KRC_Move or the robot controller (parameter KRC_Jog function block. Coordinate System - COORDSYS. Tool). (>>> COORDSYS [} 19]) 34 INVALID VELOCITY An invalid value for the velocity has Program valid value (parameter been programmed in a function Velocity): block. • 0 … 100 % 35 INVALID An invalid value for the acceleration Program valid value (parameter ACCELERATION has been programmed in a function Acceleration): block. • 0 … 100 % 36 INVALID C_PTP An invalid approximation distance Program valid value (parameter was transferred for a PTP Approximate). movement. (>>> APO [} 19]) 37 INVALID C_DIS An invalid distance parameter was transferred for a contouring motion. 38 INVALID C_VEL An invalid velocity parameter was transferred for a contouring motion. 39 INVALID C_ORI An invalid orientation parameter was transferred for a contouring motion. 40 INVALID ORI_TYPE An invalid value for the orientation Program valid value (parameter control of the TCP has been Ori Type). programmed in a KRC_Move or (>>> Ori Type [} 16]) KRC_Jog function block. 41 POSITION DATA NOT No target position was transferred Define at least 1 element of the INITIALIZED when calling a KRC_Move function target position (parameter block. Position). (>>> E6POS [} 20]) 42 AXISPOSITION DATA No axis position was transferred Define at least 1 axis position NOT INITIALIZED when calling a KRC_Move Axis (parameter Axis Position). function block. (>>> E6AXIS [} 20]) 43 INVALID TRIGGER An invalid value for the switching Program valid value (parameter DISTANCE point of the trigger has been Distance): programmed in a • 0: Switching action in the start KRC_Set Distance Trigger function point block. • 1: Switching action in the end point 44 INVALID TRIGGER IO An invalid output has been Program valid value (parameter programmed in a Output): KRC_Set Distance Trigger or • 1 … 2 048 KRC_Set Path Trigger function block. TF5120 Version: 2.0.0 143
## Page 144

Messages No. Message text Cause Remedy 45 INVALID TRIGGER An invalid value for the length of the Program valid value (parameter PULSE pulse has been programmed in a Pulse): KRC_Set Distance Trigger or • 0.1 … 3.0 s KRC_Set Path Trigger function block. • 0.0 s (No pulse active) 46 INVALID CIRC_HP No auxiliary position was transferred Define at least 1 element of the when calling a KRC_Move Circ auxiliary position (parameter function block. Circ HP). (>>> E6AXIS [} 20]) 47 INVALID INTERRUPT The number of the digital input to Program valid value (parameter IO which an interrupt is declared is Input): invalid (function block • 1 … 2 048 KRC_Declare Interrupt). 48 INVALID INTERRUPT An invalid number was transferred Program valid value (parameter PRIORITY when calling a KRC_...interrupt Interrupt): function block. • 1 … 8 49 INTERRUPT NOT Interrupt was not declared. Declare interrupt. DECLARED (>>> Declare interrupt [} 66]) 50 INVALID INTERRUPT The reaction to the interrupt, which Program valid reaction (parameter ACTION was programmed when an interrupt Reaction) was declared, is invalid. (>>> Declare interrupt [} 66]) 51 INVALID IO NUMBER The number of the digital input to Program valid value (parameter which an interrupt is declared is Input): invalid (function block • 1 … 2 048 KRC_Declare Interrupt). 52 INVALID PULSE An invalid value for the length of the Program valid value (parameter DURATION pulse has been programmed in the Pulse): KRC_ Write Digital Output function • 0.1 … 3.0 s block. • 0.0 s (No pulse active) 53 INVALID An invalid Buffer Mode has been Program valid Buffer Mode. BUFFER_MODE programmed in a function block. The (>>> Buffer Mode [} 24]) DIRECT mode is not available for some function blocks, for example. 54 INVALID TOOL An invalid number has been Program valid value (parameter NUMBER FOR programmed in the function block Tool). LOAD_DATA KRC_Read Load Data or (>>> Read load data [} 135]) KRC_Write Load Data for reading or writing the load data or the additional (>>> Write load data [} 136]) load data. 55 INVALID ANALOG IO An invalid number has been Program valid value (parameter NUMBER programmed in a function block for Number): the analog input or output. • 1 … 32 56 INVALID IPO_MODE An invalid value for the interpolation Program valid value (parameter mode has been programmed in a Coordinate System - function block, e.g. in a KRC_Move COORDSYS. IPO_MODE). function block. (>>> COORDSYS [} 19]) 57 INVALID CIRC_TYPE In a KRC_Move Circ function block Program valid value (parameter an invalid value has been Circ Type). programmed for the orientation (>>> Circ Type [} 16]) control during the circular motion. 58 INVALID FRAME DATA Invalid TOOL or BASE data were Program valid data (parameter programmed in a Tool Data or Base Data). KRC_Write Tool Data or (>>> Write TOOL data [} 133]) KRC_Write Base Data function block. 144 Version: 2.0.0 TF5120
## Page 145

Messages No. Message text Cause Remedy (>>> Write BASE data [} 134]) 59 INVALID LOAD DATA Invalid load data were programmed Program valid data. in a KRC_Write Load Data function (>>> Write load data [} 136]) block. 60 INVALID SOFT_END Error when writing the software limit Program smaller values for the (REVERSED) switches: positive software limit negative software limit switches switch < negative software limit than for the positive software limit switch (function block switches. KRC_Write Soft End or KRC_Write Soft End Ex) 61 INVALID INTERRUPT Internal exception error Contact service. STATE 62 INVALID SYS VAR In a KRC_Read Sys Var or Program valid value (parameter INDEX KRC_Write Sys Var function block an Index). index was transferred for which no (>>> Read system variables [} 79]) system variable is stored. (>>> Write system variables [} 80]) 63 INVALID SYS VAR An invalid value for the system Program valid value (parameter VALUE variable has been programmed in a Value1 ... Value10). KRC_Write Sys Var function block. (>>> Write system variables [} 80]) 64 SYS VAR NOT An error occurred while writing a system variable. WRITEABLE The specified system variable does not exist or may not be written to in the current operating state. 65 INVALID REAL VALUE The programmed real value is Program valid value: invalid. • -2,147,483,500 … +2,147,483,500 66 ERROR SETTING Error while writing a digital output. It Use another digital output OUTPUT is possible that the output is already (parameter Number): occupied by the system. • 1 … 2 048 67 ERROR SETTING Error when writing the software limit Program valid values for the SOFTEND switches: A possible error is, for software limit switches (see example, that a rotatory axis is machine data). written with a value outside +/-360°. 68 INVALID TECH In a KRC_Tech Function function Contact service.) FUNCTION INDEX block a Tech Function ID was transferred for which no technology function is stored. 69 INVALID TECH An invalid value has been Contact service. FUNCTION programmed for a parameter in a PARAMETER KRC_Tech Function function block. 70 INVALID PARAMETER An invalid value has been Program valid values for the VALUE programmed for one or more parameters. parameters in the called function block. 8.2 Error messages of the mx A interface in the submit interpreter No. Message text Cause Remedy 401 INTERNAL ERROR Internal exception error Contact service. 402 ASSERT FAILED Internal exception error 403 INVALID COMMAND ID Internal exception error TF5120 Version: 2.0.0 145
## Page 146

Messages No. Message text Cause Remedy 404 INVALID COMMAND Internal exception error STATE 405 OVERFLOW Internal exception error COMMAND QUEUE 406 INVALID COMMAND Internal exception error QUEUE INDEX 407 INVALID COMMAND Internal exception error (PRE) QUEUE INDEX 408 INVALID Internal exception error WRITE_Q_IDX AND WRITE_PRE_Q_IDX 409 OVERFLOW STATUS There are more than 100 status Reduce the number of instructions RETURN QUEUE change feedback messages to be that are buffered simultaneously. (SUBMIT) transmitted from the robot controller Contact service if this is not to the PLC. possible. The data transfer rate is much smaller than the processing speed. 410 INVALID FIELDBUS Internal exception error Contact service. TELEGRAMM LENGTH 411 TIMEOUT Internal exception error ABORT_REQUEST 412 INVALID CHECKSUM The checksum during data transmission from the PLC to the robot PLC -> KRC controller is invalid: Error during commissioning: Check configuration in Work Visual and Twin CAT and configure • Ether CAT configuration in Ether CAT correctly. Work Visual or Twin CAT faulty Error during operation: Contact service. • Bit error during data transmission 413 INVALID MOVE TYPE Internal exception error Contact service. 414 TIMEOUT HEARTBEAT Connection to PLC interrupted Reconnect, then acknowledge FROM PLC error. PLC program stopped Restart PLC program. Submit Interpeter deselected or Restart Submit Interpeter. stopped Connecting line defective or not Replace connecting line or connect connected correctly correctly. 416 SYS VAR NOT An error occurred while reading a system variable. INITIALIZED The specified system variable does not exist or may not be read in the current operating state. Example: $POS_ACT can only be accessed after a BCO run. 417 UNDERFLOW OF Internal exception error Contact service. NIBBLE 418 OVERFLOW OF Internal exception error NIBBLE 419 UNDERFLOW OF Internal exception error BYTE 420 OVERFLOW OF BYTE Internal exception error 421 UNDERFLOW OF Internal exception error INT16 422 OVERFLOW OF INT16 Internal exception error 423 UNDERFLOW OF Internal exception error INT32 424 OVERFLOW OF INT32 Internal exception error 146 Version: 2.0.0 TF5120
## Page 147

Messages No. Message text Cause Remedy 425 UNDERFLOW OF Internal exception error REAL 426 OVERFLOW OF REAL Internal exception error 430 INVALID PTP APO An invalid contour parameter was Program valid value (parameter transferred for a PTP movement. Approximate). 431 INVALID CP APO An invalid contour parameter was (>>> APO [} 19]) transferred for a CP movement (LIN, CIRC). 432 INVALID BASE An invalid number for the BASE Specify the number of the BASE NUMBER coordinate system has been coordinate system currently used in programmed in a the robot controller (parameter KRC_Read Base Data or Base No). KRC_Write Base Data function block. • 1 … 32 An invalid number for the BASE Specify the number of the BASE coordinate system has been coordinate system currently used in programmed in a KRC_Move or the robot controller (parameter KRC_Jog function block. Coordinate System - COORDSYS. Base). (>>> COORDSYS [} 19]) 433 INVALID TOOL An invalid number for the TOOL Specify the number of the TOOL NUMBER coordinate system has been coordinate system currently used in programmed in a the robot controller (parameter KRC_Read Tool Data or Tool No). KRC_Write Tool Data function block. • 1 … 16 An invalid number for the TOOL Specify the number of the TOOL coordinate system has been coordinate system currently used in programmed in a KRC_Move or the robot controller (parameter KRC_Jog function block. Coordinate System - COORDSYS. Tool). (>>> COORDSYS [} 19]) 434 INVALID VELOCITY An invalid value for the velocity has Program valid value (parameter been programmed in a function Velocity): block. • 0 … 100 % 435 INVALID An invalid value for the acceleration Program valid value (parameter ACCELERATION has been programmed in a function Acceleration): block. • 0 … 100 % 436 INVALID C_PTP An invalid approximation distance Program valid value (parameter was transferred for a PTP Approximate). movement. (>>> APO [} 19]) 437 INVALID C_DIS An invalid distance parameter was transferred for a contouring motion. 438 INVALID C_VEL An invalid velocity parameter was transferred for a contouring motion. 439 INVALID C_ORI An invalid orientation parameter was transferred for a contouring motion. 440 INVALID ORI_TYPE An invalid value for the orientation Program valid value (parameter control of the TCP has been Ori Type). programmed in a KRC_Move or (>>> Ori Type [} 16]) KRC_Jog function block. 441 POSITION DATA NOT No target position was transferred Define at least 1 element of the INITIALIZED when calling a KRC_Move function target position (parameter block. Position). (>>> E6POS [} 20]) TF5120 Version: 2.0.0 147
## Page 148

Messages No. Message text Cause Remedy 442 AXISPOSITION DATA No axis position was transferred Define at least 1 axis position NOT INITIALIZED when calling a KRC_Move Axis (parameter Axis Position). function block. (>>> E6AXIS [} 20]) 443 INVALID TRIGGER An invalid value for the switching Program valid value (parameter DISTANCE point of the trigger has been Distance): programmed in the • 0: Switching action in the start KRC_Set Distance Trigger function point block. • 1: Switching action in the end point 444 INVALID TRIGGER IO An invalid output has been Program valid value (parameter programmed in a Output): KRC_Set Distance Trigger or • 1 … 2 048 KRC_Set Path Trigger function block. 445 INVALID TRIGGER An invalid value for the length of the Program valid value (parameter PULSE pulse has been programmed in a Pulse): KRC_Set Distance Trigger or • 0.1 … 3.0 s KRC_Set Path Trigger function block. • 0.0 s (No pulse active) 446 INVALID CIRC_HP No auxiliary position was transferred Define at least 1 element of the when calling a KRC_Move Circ auxiliary position (parameter function block. Circ HP). (>>> E6AXIS [} 20]) 447 INVALID INTERRUPT The number of the digital input to Program valid value (parameter IO which an interrupt is declared is Input): invalid (function block • 1 … 2 048 KRC_Declare Interrupt). 448 INVALID INTERRUPT An invalid number was transferred Program valid value (parameter NUMBER/ PRIORITY when calling a KRC_...interrupt Interrupt): function block. • 1 … 8 449 INTERRUPT NOT Interrupt was not declared. Declare interrupt. DECLARED (>>> Declare interrupt [} 66]) 450 INVALID INTERRUPT The reaction to the interrupt, which Program valid reaction (parameter ACTION was programmed when an interrupt Reaction) was declared, is invalid. (>>> Declare interrupt [} 66]) 451 INVALID IO NUMBER The number of the digital input to Program valid value (parameter which an interrupt is declared is Input): invalid (function block • 1 … 2 048 KRC_Declare Interrupt). 452 INVALID PULSE An invalid value for the length of the Program valid value (parameter DURATION pulse has been programmed in the Pulse): KRC_ Write Digital Output function • 0.1 … 3.0 s block. • 0.0 s (No pulse active) (>>> Write digital output [} 127]) 453 INVALID An invalid Buffer Mode has been Program valid Buffer Mode. BUFFER_MODE programmed in a function block. The (>>> Buffer Mode [} 24]) DIRECT mode is not available for some function blocks, for example. 454 INVALID TOOL An invalid number has been Program valid value (parameter NUMBER FOR programmed in the function block Tool). LOAD_DATA KRC_Read Load Data or (>>> Read load data [} 135]) KRC_Write Load Data for reading or writing the load data or the additional (>>> Write load data [} 136]) load data. 148 Version: 2.0.0 TF5120
## Page 149

Messages No. Message text Cause Remedy 455 INVALID ANALOG IO An invalid number has been Program valid number (parameter NUMBER programmed in a function block for Number): the analog input or output. • 1 … 32 456 INVALID IPO_MODE An invalid value for the interpolation Program valid value (parameter mode has been programmed in a Coordinate System - function block, e.g. in a KRC_Move COORDSYS. IPO_MODE). function block. (>>> COORDSYS [} 19]) 457 INVALID CIRC_TYPE In a KRC_Move Circ function block Program valid value (parameter an invalid value has been Circ Type). programmed for the orientation (>>> Circ Type [} 16]) control during the circular motion. 458 INVALID FRAME DATA Invalid TOOL or BASE data were Program valid data (parameter programmed in a Tool Data or Base Data). KRC_Write Tool Data or (>>> Write TOOL data [} 133]) KRC_Write Base Data function block. (>>> Write BASE data [} 134]) 459 INVALID LOAD DATA Invalid load data were programmed Program valid data. in a KRC_Write Load Data function (>>> Write load data [} 136]) block. 460 INVALID SOFT_END Error when writing the software limit Program smaller values for the (REVERSED) switches: positive software limit negative software limit switches switch < negative software limit than for the positive software limit switch switches. 461 INVALID INTERRUPT Internal exception error Contact service. STATE 462 INVALID SYS VAR In a KRC_Read Sys Var or Program valid value (parameter INDEX KRC_Write Sys Var function block an Index). index was transferred for which no (>>> Read system variables [} 79]) system variable is stored. (>>> Write system variables [} 80]) 463 INVALID SYS VAR An invalid value for the system Program valid value (parameter VALUE variable has been programmed in a Value1 ... Value10). KRC_Write Sys Var function block. (>>> Write system variables [} 80]) 464 SYS VAR NOT An error occurred while writing a system variable. WRITEABLE The specified system variable does not exist or may not be written to in the current operating state. 465 INVALID REAL VALUE The programmed real value is Program valid value: invalid. • -2,147,483,500 … +2,147,483,500 466 ERROR SETTING Error while writing an output. It is Use another digital output OUTPUT possible that the output is already (parameter Number): occupied by the system. • 1 … 2 048 467 ERROR SETTING An error occurred while writing a Program valid values for the SOFTEND software limit switch. software limit switches (see machine data). A possible error is, for example, that a rotatory axis is written with a value outside +/-360°. 468 INVALID TECH In a KRC_Tech Function function Contact service. FUNCTION INDEX block a Tech Function ID was transferred for which no technology function is stored. 469 INVALID TECH An invalid value has been Contact service. FUNCTION programmed for a parameter in a PARAMETER KRC_Tech Function function block. TF5120 Version: 2.0.0 149
## Page 150

Messages No. Message text Cause Remedy 470 INVALID PARAMETER An invalid value has been Program valid values for the VALUE programmed for one or more parameters. parameters in the called function block. 471 PDAT NOT No PDAT data was transferred when Define at least 1 element of the INITIALIZED calling a KRC_Forward Advanced or PDAT_ACT. KRC_Inverse Advanced function block. 472 FDAT NOT No FDAT data was transferred when Define at least 1 element of the INITIALIZED calling a KRC_Forward Advanced or FDAT_ACT. KRC_Inverse Advanced function block. 473 LDAT NOT No LDAT data was transferred when Define at least 1 element of the INITIALIZED calling a KRC_Forward Advanced or LDAT_ACT. KRC_Inverse Advanced function block. 474 INVALID TOOL OR An invalid number for the TOOL Specify the number of the TOOL BASE NUMBER coordinate system or for the BASE coordinate system currently used in coordinate system has been the robot controller (parameter programmed in the Tool). KRC_Forward Advanced or • 1 … 16 KRC_Inverse Advanced function block. Specify the number of the BASE coordinate system currently used in the robot controller (parameter Base). • 1 … 32 8.3 Errors in the function block No. Message text Cause Remedy 501 INTERNAL ERROR Internal exception error Contact service. 502 INVALID Buffer Mode 0: DIRECT is not Program correct mode: BUFFER_MODE permitted for this function block. • 1: ABORTING • 2: BUFFERED (>>> Buffer Mode [} 24]) 503 INVALID MXA The software versions of the mx A Install compatible software versions VERSION interface and the PLC library are not on robot controller and PLC. compatible. (>>> initialize mx A interface [} 115]) 504 INVALID OVERRIDE Invalid override value in function Program a valid value (parameter block KRC_Set Override Override): • 0 … 100% 505 MAX GROUP REF IDX The index of the axis group specified Simply instantiate the REACHED in the KRC_Read Axis Group function KRC_Read Axis Group function block is already occupied. block in a program. 506 INVALID The index of the axis group specified Specify a valid index for the axis GROUPREFIDX in the function block is invalid. group (parameter Axis Group Idx). 507 INVALID FB ORDER The order in which the function Program the function blocks in the blocks are called is invalid. correct order. 508 CONNECTION NOT No instructions can be transferred Initialize the mx A interface. INITIALIZED because the mx A interface has not (>>> initialize mx A interface [} 115]) been initialized. 509 NO CONNECTION TO Connection to robot controller Reconnect, then acknowledge KRC interrupted error. 150 Version: 2.0.0 TF5120
## Page 151

Messages No. Message text Cause Remedy 510 TIMEOUT HEARTBEAT The robot controller is switched off. Restart the robot controller. FROM KRC Submit interpreter deselected or Restart Submit interpreter. stopped Bus error or I/O configuration faulty Check I/O configuration. Connection cable defective or not Replace connection cable or connected correctly. connect correctly. Maximum cycle time of the Submit Increase the value for interpreter is too short (only for Max Submit Cycle in the KRC_Diag message no. 510) function block. A function was called from the input Before calling a function with Execute Cmd before the interface Execute Cmd wait for the output was initialized. KRC_Initialize. Done. To reset the error, set the input Execute Cmd to the value FALSE. 511 TIMEOUT CMD The input Execute Cmd was reset Acknowledge the message and INTERFACE BLOCKED before the busy signal was set. reset the input Execute Cmd in the future only after the Done, Error or Aborted signal has been set. 512 INVALID CHECKSUM The checksum for the data transmission from the robot controller to the KRC -> PLC PLC is invalid. Error during start-up: Check configuration in Work Visual and Twin CAT and configure • Ether CAT configuration in Ether CAT correctly. Work Visual or Twin CAT faulty Error during operation: Contact service. • Bit error during the data transmission 513 INVALID POSITION An invalid number was transferred Program a valid value (parameter INDEX for the position to be taught in the Index): KRC_Touch UP function block. • 1 … 100 514 POS_ACT INVALID The current position cannot be taught BCO with a RESET at the because the position data is invalid KRC_Automatic External function (no BCO). block. 517 INVALID COMMAND Internal exception error Contact service. SIZE 518 KRC STOPMESS Group error that prevents the motion Check how the error was triggered ACTIVE enable and correct the error. • Analyze the messages in the message window of the KUKA smart HMI. • Read the current error state of the robot controller with the KRC_Read KRCError function block. 519 INVALID ABSOLUTE An invalid value for the parameter Contact service. VELOCITY Absolute Velocity has been programmed in a KRC_Move function block. 520 VELOCITY CONFLICT Several values for the velocity have Contact service. been programmed in a KRC_Move function block. 521 INVALID PARAMETER An invalid value for the parameter Contact service. COUNT Parameter Count has been programmed in a KRC_Tech Function function block. TF5120 Version: 2.0.0 151
## Page 152

Messages No. Message text Cause Remedy 522 INVALID PARAMETER The parameter Parameter Count has Contact service. USAGE been configured incorrectly in the KRC_Tech Function function block. 523 INVALID OPERATION The robot is in the wrong operation Select the Automatic External MODE mode. operation mode. 524 USER_SAF SIGNAL The operator protection is violated. Close the protection equipment and NOT ACTIVE acknowledge the closing. 525 ALARM_STOP SIGNAL The safety configuration is faulty, Check and change the safety NOT ACTIVE causing an EMERGENCY STOP to configuration of the system (robot be triggered. controller and PLC). No connection to the EMERGENCY Check EMERGENCY STOP of the STOP of the system system and restore connection. Inputs and outputs of the Automatic 1. In the main menu, select Display External interface are configured > Inputs/Outputs > Automatic incorrectly. External. 2. Check and change the configuration of the inputs and outputs. 526 APPL_RUN SIGNAL RESET cannot be performed 1. Wait until the robot program has ACTIVE because a robot program is being been processed. executed. 2. Execute the instruction again. 527 TIMEOUT MESSAGE The message cannot be Acknowledge the message on the CONFIRM acknowledged by the PLC. robot controller. 528 TIMEOUT MXA An error cannot be acknowledged in Contact service. MESSAGE CONFIRM the KRC_Auto Start function block. 529 TIMEOUT SWITCHING Internal exception error Contact service. DRIVES ON 530 TIMEOUT PROGRAM Internal exception error SELECTION 531 TIMEOUT PROGRAM Internal exception error START 532 MOVE_ENABLE Robot has no motion enable Enable motion with the parameter SIGNAL NOT ACTIVE MOVE_ENABLE. 533 INVALID Not all axis angles required for Define the missing axis angles in AXIS_VALUES execution are defined in the the KRC_Forward function block. KRC_Forward function block. 534 INVALID $BASE Internal exception error Contact service. 535 INVALID $TOOL Internal exception error 536 INVALID SOFTEND Error in KRC_Forward function block: Enter axis angles that are within the software limit switches (parameter The specified axis angles are outside Axis_Values). the software limit switches. or: Change the software limit switches. 537 ERR MATH TRAFO Error in KRC_Forward function block: Enter axis angles that the robot can reach (parameter Axis_Values). The robot cannot reach the specified axis angles. 538 INVALID Error in KRC_Inverse function block: • Specify the complete Cartesian AXIS_VALUES robot position (parameter • The Cartesian robot position was Position). not fully specified. • Specify the complete axis- • The axis-specific values at the specific values at the start point start point of the movement were of the movement (parameter incompletely specified. Start_Axis). 539 INVALID $BASE Internal exception error Contact service. 152 Version: 2.0.0 TF5120
## Page 153

Messages No. Message text Cause Remedy 540 INVALID $TOOL Internal exception error 541 INVALID SOFTEND Error in KRC_Inverse function block: Enter values that are within the software limit switches (parameter The axis-specific values at the start Start_Axis). point of the movement are outside the software limit switches. Or: Change the software limit switches. 542 ERR MATH TRAFO Error in KRC_Inverse function block: Enter values that the robot can reach (parameter Start_Axis). The robot cannot reach the specified axis-specific values at the start point of the movement. 543 INVALID EXECUTE In the case of a concatenated motion Acknowledge the message and in that can be contoured, the Execute future do not reset the Execute input was reset before the Com Acpt input until the Com Acpt signal has signal was set by the function block. been set. 544 INVALID DEV_VEL_CP Initialization of the mx A interface on Check whether the output Done in the robot controller has not yet been the function block KRC_Initialize is completed or is faulty. active. 547 INVALID TURN Error in KRC_Inverse function block: Enter values that are within the software limit switches (parameter With the specified turn, the axis- Position). specific values are at the specified position outside the software limit Or: Change the software limit switches. switches. 550 Check of LDD Error in KRC_LDDconfig function More information about the source Installation (LDD in block: of the error can be found in the EXT) failed (Err=-1)! Windows Event Log. The check of the installation and activation of the function block failed. 551 Check of LDD Error in KRC_LDDconfig function Installation (LDD in block: EXT) failed (Err=-2)! The initialization of the internal data interface is not correct. 552 Check of LDD Error in KRC_LDDconfig function Observe the error messages. Installation (LDD in block: EXT) failed (Err=-3)! The user data configuration is not valid. 553 Default settings not Internal error More information about the source correctly finished of the error can be found in the (Err=-40)! Windows Event Log. 554 Default settings not Internal error correctly finished (Err=-41)! 555 Default settings not Internal error correctly finished (Err=-42)! 556 A4 < 0.0 … Move A4 to Error in function block Move axis 4 in positive direction to 0.0 KRC_LDDconfig or 0°. KRC_LDDcheck Pos: Axis 4 is smaller than 0°. 557 A4 > 0.0 … Move A4 to Error in function block Move axis 4 in negative direction to 0.0 KRC_LDDconfig or 0°. KRC_LDDcheck Pos: Axis 4 is greater than 0°. 558 Axis ranges: A2 / A3 not Error in function block Position axes 2 and 3 so that the valid! KRC_LDDconfig or robot arm is horizontal. KRC_LDDcheck Pos: TF5120 Version: 2.0.0 153
## Page 154

Messages No. Message text Cause Remedy The position of axes 2 and 3 is not valid. 559 Axis ranges: A3 range Error in function block Reduce or increase the axis range. not valid! KRC_LDDconfig or Ideal values: KRC_LDDcheck Pos: • Axis range: 4° Axis 3: Axis range is not valid. • Start position: ±2° 560 Axis position: A4 Error in function block Move axis 4 to 0°. position not valid! KRC_LDDconfig or KRC_LDDcheck Pos: Axis 4: Axis range is not valid. 561 Axis ranges: A5 range Error in function block Reduce or increase the axis range. not valid! KRC_LDDconfig or Ideal values: KRC_LDDcheck Pos: • Axis range: 80° Axis 5: Axis range is not valid. • Start position: ±40° 562 Axis ranges: A6 range Error in function block Reduce or increase the axis range. not valid! KRC_LDDconfig or Ideal values: KRC_LDDcheck Pos: • Axis range: 120° Axis 6: Axis range is not valid. • Start position: ±60° 563 Axis ranges: A1 too Error in function block Move axis 1 in positive direction of close to the lower limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 1 violates the permissible lower axis range. 564 Axis ranges: A2 too Error in function block Move axis 2 in positive direction of close to the lower limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 2 violates the permissible lower axis range. 565 Axis ranges: A3 too Error in function block Move axis 3 in positive direction of close to the lower limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 3 violates the permissible lower axis range. 566 Axis ranges: A5 too Error in function block Move axis 5 in positive direction of close to the lower limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 5 violates the permissible lower axis range. 567 Axis ranges: A6 too Error in function block Move axis 6 in positive direction of close to the lower limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 6 violates the permissible lower axis range. 568 Axis ranges: A1 too Error in function block Move axis 1 in negative direction of close to the upper limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 1 violates the permissible upper axis range. 569 Axis ranges: A2 too Error in function block Move axis 2 in negative direction of close to the upper limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: 154 Version: 2.0.0 TF5120
## Page 155

Messages No. Message text Cause Remedy Axis 2 violates the permissible upper axis range. 570 Axis ranges: A3 too Error in function block Move axis 3 in negative direction of close to the upper limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 3 violates the permissible upper axis range. 571 Axis ranges: A5 too Error in function block Move axis 5 in negative direction of close to the upper limit! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 5 violates the permissible upper axis range. 572 Axis ranges: A6 range Error in function block Move axis 6 in negative direction of not valid! KRC_LDDconfig or movement. KRC_LDDcheck Pos: Axis 6 violates the permissible upper axis range. 574 LDD configuration not Error in KRC_LDDtest Run function More information about the source valid! block: of the error can be found in the Windows Event Log. The load data determination was not configured correctly. 575 LDD KRL Program not Error in KRC_LDDstart function More information about the source correctly finished block: of the error can be found in the Windows Event Log. The load data determination was not completed correctly. 576 Kuka. Load 5 result Error in KRC_LDDstart function More information about the source unknown block: of the error can be found in the logbook of KUKA. Load. The load analysis did not provide any result. 577 LDD_LOAD_RESULT = Error in KRC_LDDstart function Contact service. #STATOVL block: The load analysis has shown that there is a static overload. The selected robot type is not permitted for the specified load case. 578 LDD_LOAD_RESULT = Error in KRC_LDDstart function #DYNOVL block: The load analysis has shown that there is a dynamic overload. The selected robot type is not permitted for the specified load case. 579 LDD_LOAD_RESULT = Error in KRC_LDDstart function #OVL block: The load analysis has shown that there is a static and dynamic overload. The selected robot type is not permitted for the specified load case. 580 LDD_LOAD_RESULT = Error in KRC_LDDstart function #SLOOR block: The load analysis has shown that the additional load is outside the specified range. The selected robot type is not permitted for the specified load case. TF5120 Version: 2.0.0 155
## Page 156

Messages No. Message text Cause Remedy 581 Tool Number=-1: Error in the function block To assign the load data to a tool, $config.dat unchanged! KRC_LDDstart or set the Tool parameter to a valid KRC_LDDwrite Load: value and call the KRC_LDDwrite Load function block. Parameter Tool = -1 • 1 ... maximum number of tools The determined load data are not assigned to any tool. 582 LDD_start not correctly Error in the function block Observe the error messages. finished! KRC_LDDstart or KRC_LDDwrite Load: The load data determination was not completed correctly. 583 Kuka. Load 5 not Error in the function block Observe the error messages. correctly finished! KRC_LDDstart or If necessary, refer to the Windows KRC_LDDwrite Load: Event Log or the KUKA. Load log for The evaluation of the load data by further information. KUKA. Load was not completed correctly. 584 Tool number not Error in the function block Set tool number (parameter Tool) correct! KRC_LDDstart or to a valid value: KRC_LDDwrite Load: • 1 ... maximum number of tools The tool number is not valid. 585 LDD KRL Test run Error in KRC_LDDtest Run function Execute the test drive program Program not correctly block: completely. finished! The test drive was not completed correctly. 586 program override check, Error in KRC_LDDtest Run function 1. Set the program override to should be less or equal block: ≤ 10% (function block 10 KRC_Set Override). Function block was executed with a program override ≥ 10%. 2. Execute KRC_LDDtest Run function block again. 587 Internal error Error in the function block More information about the source KRC_LDDstart or of the error can be found in the KRC_LDDwrite Load: Windows Event Log. Internal error 588 Internal error Error in the function block More information about the source KRC_LDDstart or of the error can be found in the KRC_LDDwrite Load: Windows Event Log. Internal error 8.4 Pro Con OS errors No. Message text Cause Remedy 701 INTERNAL ERROR Internal exception error Contact service. 702 ASSERT FAILED Internal exception error 703 INVALID COMMAND ID Internal exception error 704 INVALID HEADER Internal exception error DATA 709 ERROR READING Internal exception error SOFTPLC 710 ERROR FROM KRC Internal exception error SUBMIT 156 Version: 2.0.0 TF5120
## Page 157

Messages No. Message text Cause Remedy 712 INVALID CHECKSUM The checksum for the data Contact service. PLC -> KRC transmission from the PLC to the robot controller is invalid. 713 INVALID MOVE TYPE An invalid value has been Contact service. programmed for the Move Type parameter in a KRC_Move function block. 730 INVALID PTP APO An invalid contour parameter was Program a valid value (parameter transferred for a PTP movement. Approximate). 731 INVALID CP APO An invalid contour parameter was (>>> APO [} 19]) transferred for a CP movement (LIN, CIRC). 732 INVALID BASE An invalid number has been Specify the number of the BASE NUMBER programmed for the BASE coordinate system currently used in coordinate system in the function the robot controller (parameter block KRC_Read Base Data or Base No). KRC_Write Base Data. • 1 … 32 An invalid number has been Specify the BASE coordinate programmed for the BASE system number currently used in coordinate system in a KRC_Move or the robot controller (parameter KRC_Jog function block. Coordinate System - COORDSYS. Base). (>>> COORDSYS [} 19]) 733 INVALID TOOL An invalid number has been Specify the TOOL coordinate NUMBER programmed for the TOOL system number currently used in coordinate system in the function the robot controller (parameter block KRC_Read Tool Data or Tool No). KRC_Write Tool Data. • 1 … 16 An invalid number has been Specify the TOOL coordinate programmed for the TOOL system number currently used in coordinate system in a KRC_Move or the robot controller (parameter KRC_Jog function block. Coordinate System - COORDSYS. Tool). (>>> COORDSYS [} 19]) 734 INVALID VELOCITY An invalid value has been Program a valid value (parameter programmed for the velocity in a Velocity): function block. • 0 … 100% • 0 ... 2 m/s (only for MC_Move Linear and MC_Move Circular function blocks) 735 INVALID An invalid value has been Program a valid value (parameter ACCELERATION programmed for the acceleration in a Acceleration): function block. • 0 … 100% • 0 ... 2.3 m/s2 (only for MC_Move Linear and MC_Move Circular function blocks) 736 INVALID C_PTP An invalid approximation distance Program a valid value (parameter was transferred for a PTP Approximate). movement. (>>> APO [} 19]) 737 INVALID C_DIS An invalid distance parameter was transferred for an approximated motion. TF5120 Version: 2.0.0 157
## Page 158

Messages No. Message text Cause Remedy 738 INVALID C_VEL An invalid velocity parameter was transferred for an approximated motion. 739 INVALID C_ORI An invalid alignment parameter was transferred for an approximated motion. 740 INVALID ORI_TYPE An invalid value has been Program a valid value (parameter programmed in a KRC_Move or Ori Type). KRC_Jog function block for the (>>> Ori Type [} 16]) orientation control of the TCP orientation control. 741 POSITION DATA NOT No target position was transferred Define at least 1 element of the INITIALIZED when calling a KRC_Move function target position (parameter block. Position). (>>> E6POS [} 20]) 742 AXISPOSITION DATA No axis position was transferred Define at least 1 axis position NOT INITIALIZED when calling a KRC_Move Axis (parameter Axis Position). function block. (>>> E6AXIS [} 20]) 743 INVALID TRIGGER An invalid value has been Program a valid value (parameter DISTANCE programmed for the switching point Distance): of the switch in a • 0: Switching action at the start KRC_Set Distance Trigger function point block. • 1: Switching action at the end point 744 INVALID TRIGGER IO An invalid output has been Program a valid value (parameter programmed in a Output): KRC_Set Distance Trigger or • 1 … 2048 KRC_Set Path Trigger function block. 745 INVALID TRIGGER An invalid value has been Program a valid value (parameter PULSE programmed in a Pulse): KRC_Set Distance Trigger or • 0.1 … 3.0 s KRC_Set Path Trigger function block for the pulse length. • 0.0 s (no pulse active) 746 INVALID CIRC_HP No auxiliary position was transferred Define at least 1 element of the when calling a KRC_Move Circ auxiliary position (parameter function block. Circ HP). (>>> E6AXIS [} 20]) 747 INVALID INTERRUPT The number of the digital input for Program a valid value (parameter IO which the interrupt is declared is Input): invalid (function block • 1 … 2048 KRC_Declare Interrupt). 748 INVALID INTERRUPT An invalid number was transferred Program a valid value (parameter PRIORITY when calling a KRC_...interrupt Interrupt): function block. • 1 … 8 750 INVALID INTERRUPT The interrupt reaction programmed Program a valid reaction (parameter ACTION when declaring the interrupt is Reaction). invalid. (>>> Declare interrupt [} 66]) 751 INVALID IO NUMBER The number of the digital input for Program a valid value (parameter which the interrupt is declared is Input): invalid (function block • 1 … 2048 KRC_Declare Interrupt). 752 INVALID PULSE An invalid value has been Program a valid value (parameter DURATION programmed in the Pulse): KRC_Write Digital Output function • 0.1 … 3.0 s block for the pulse length. 158 Version: 2.0.0 TF5120
## Page 159

Messages No. Message text Cause Remedy • 0.0 s (no pulse active) 753 INVALID An invalid Buffer Mode has been Program a valid Buffer Mode. BUFFER_MODE programmed in a function block, e.g. (>>> Buffer Mode [} 24]) the DIRECT mode is not available for certain function blocks. 754 INVALID TOOL An invalid number has been Program a valid value (parameter NUMBER FOR programmed in the Tool). LOAD_DATA KRC_Read Load Data or (>>> Read load data [} 135]) KRC_Write Load Data function block for reading or writing the load data or (>>> Write load data [} 136]) supplementary load data. 755 INVALID ANALOG IO An invalid value has been Program a valid value (parameter NUMBER programmed in a function block for Number): the analog input or output. • 1 … 32 756 INVALID IPO_MODE An invalid value has been Program a valid value (parameter programmed in a function block for Coordinate System - the interpolation type, e.g. COORDSYS. IPO_MODE). KRC_Move. (>>> COORDSYS [} 19]) 757 INVALID CIRC_TYPE An invalid value has been Program a valid value (parameter programmed in a KRC_Move Circ Circ Type). function block for the orientation (>>> Circ Type [} 16]) control during the circular motion. 758 INVALID FRAME DATA Invalid TOOL or BASE data were Program valid data (parameter programmed in a Tool Data or Base Data). KRC_Write Tool Data or (>>> Write TOOL data [} 133]) KRC_Write Base Data function block. (>>> Write BASE data [} 134]) 759 INVALID LOAD DATA Invalid load data were programmed Program valid data. in a KRC_Write Load Data function (>>> Write load data [} 136]) block. 760 INVALID SOFT_END Error when writing the software limit Program lower values for the (REVERSED) switches: positive software limit negative software limit switch than switch < negative software limit for the positive software limit switch. switch (function block KRC_Write Soft End or KRC_Write Soft End Ex) 765 INVALID REAL VALUE The programmed real value is • -2,147,483,500 … invalid. +2,147,483,500 770 INVALID PARAMETER An invalid value has been Program valid values for the VALUE programmed for one or more parameters. parameters in the called function block. 771 INVALID ADVANCE An invalid value has been Program a valid value (parameter COUNT programmed for the number of Count): functions which are to be transferred • 1 … 50 prior to the first robot motion in the KRC_Set Advance function block. 772 INVALID In the KRC_Set Advance function Program a valid value (parameter MAXWAITTIME block, an invalid value has been Max Wait Time): programmed for the maximum • 1 … 32 767 ms waiting time before program execution starts in the event that the specified number of functions in the Count parameter is not reached. 773 INVALID ADVANCE An invalid value for the Wait mode Program a valid value (parameter MODE has been programmed in the Mode): KRC_Set Advance function block. • 0 … 2 TF5120 Version: 2.0.0 159
## Page 160

Messages No. Message text Cause Remedy 774 INVALID DI In the function block Program a valid value (parameter STARTNUMBER KRC_Read Digital Input Array, an Startnumber): invalid value has been programmed • 1 … 2048 for the number of the first digital input that is called. 775 INVALID DI LENGTH In the KRC_Read Digital Input Array Program a valid value (parameter function block, an invalid value has Length): been programmed for the number of • 1 … 200 inputs that are polled. 776 INVALID CONVEYOR An invalid value has been Program a valid value (parameter NUMBER programmed for the number of the Conveyor Number): conveyor in the called function block. • 1 … 3 777 INVALID CONVEYOR In the function block Program a valid value (parameter STARTDISTANCE KRC_Conv Follow or KRC_Conv Skip, Start Distance): an invalid value has been • In the case of a linear conveyor: programmed for the distance specification in millimeters traveled by the workpiece while the robot waits before starting to track • In the case of a circular the workpiece on the conveyor. conveyor: specification in degrees 778 INVALID CONVEYOR In function block KRC_Conv Follow or Program a valid value (parameter MAXDISTANCE KRC_Conv Skip, an invalid value has Max Distance): been programmed for the maximum • In the case of a linear conveyor: distance that the workpiece travels specification in millimeters before the robot starts to synchronize with the workpiece. • In the case of a circular conveyor: specification in degrees 779 INVALID CONVEYOR In the KRC_Conv Skip function block, Program a valid value (parameter PIECENUMBER an invalid value has been Piece Number). programmed for the number Examples: specifying which workpieces are to be picked up. • 1: Every workpiece is picked up. • 3: Every third workpiece is picked up. 780 INVALID An invalid value has been Program a valid value (parameter WORKSPACENO programmed for the number of the Workspace No): workspace in the called function • 1 … 8 block. 781 INVALID An invalid value for the workspace Program a valid value (parameter WORKSPACEMODE mode has been programmed in the Workspace Mode): called function block. • 0 … 4 782 INVALID Internal exception error Contact service. WORKSPACEPART 783 UDP CONNECTION Connection timeout for UDP Check the IP addresses of the two TIMEOUT communication connection points and the cable between them. Set a longer value for the timeout in the mxa_config.dat file. 801 STOPMESS ACTIVE Group error that prevents motion Check how the error was triggered enable and correct the error. • Analyze the messages in the message window of the KUKA smart HMI. • Read the current error state of the robot controller with the KRC_Read KRCError function block. 160 Version: 2.0.0 TF5120
## Page 162

More Information: www.beckhoff.com/tf5120 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
