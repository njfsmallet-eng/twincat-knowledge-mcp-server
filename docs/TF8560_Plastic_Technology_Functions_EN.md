---
title: "TF8560_Plastic_Technology_Functions_EN"
product: "TF8560"
category: "Process_Engineering"
tags: ["FUNCTIONS", "PLASTIC", "TECHNOLOGY"]
language: "EN"
document_type: "Manual"
version: "1.4.0"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF8560_Plastic_Technology_Functions_EN.pdf"
release_date: "2025-08-07"
---
Manual | EN TF8560 Twin CAT 3 | Plastic Technology Functions 2025-08-07 | Version: 1.4.0
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 9 1.1 Notes on the documentation............................................................................................................. 9 1.2 For your safety.................................................................................................................................. 9 1.3 Notes on information security.......................................................................................................... 11 1.4 Documentation issue status............................................................................................................ 11 2 Concept of Libraries............................................................................................................................... 12 3 Axes.......................................................................................................................................................... 14 3.1 FB_Axis Base - Virtual axes............................................................................................................. 14 3.2 Instantiation..................................................................................................................................... 15 3.2.1 FB_Axis Nc Base............................................................................................................... 15 3.2.2 FB_Axis Nc Trafo Base....................................................................................................... 16 3.2.3 FB_Axis Hydraulic Base..................................................................................................... 17 3.2.4 FB_Axis Inv Base............................................................................................................... 19 3.2.5 FB_Actuator Base............................................................................................................. 20 3.3 Properties and methods.................................................................................................................. 21 3.4 States (state machine).................................................................................................................... 21 3.5 Axis variants and their interfaces.................................................................................................... 23 3.5.1 I_Axis Base....................................................................................................................... 25 3.5.2 I_Axis Base Dev................................................................................................................. 26 3.5.3 I_Axis Nc Base................................................................................................................... 29 3.5.4 I_Axis Nc Base Dev............................................................................................................ 30 3.5.5 I_Axis Hydraulic Base........................................................................................................ 32 3.5.6 I_Axis Hydraulic Base Dev.................................................................................................. 34 3.5.7 I_Axis Inv Base.................................................................................................................. 37 3.5.8 I_Axis Inv Base Dev............................................................................................................ 38 3.6 Transformation axes....................................................................................................................... 40 3.6.1 Construction of a transforming axis.................................................................................. 40 3.6.2 Semi-transformation mode............................................................................................... 41 3.6.3 Full transformation mode................................................................................................. 42 3.6.4 I_Axis Trafo Base............................................................................................................... 42 3.6.5 I_Axis Trafo Base Dev........................................................................................................ 44 3.6.6 I_Axis Nc Trafo Base.......................................................................................................... 46 3.6.7 I_Axis Nc Trafo Base Dev.................................................................................................... 48 3.6.8 FB_Trafo Table Generator................................................................................................. 51 3.6.9 FB_Clamp Table Generator............................................................................................... 52 3.6.10 FB_Crank Table Generator................................................................................................ 56 3.6.11 FB_Scotch Yoke Table Generator...................................................................................... 57 3.6.12 FB_Crank Double Shaft Table Generator............................................................................ 58 3.7 Linear actuators.............................................................................................................................. 59 3.7.1 I_Motion Base................................................................................................................... 60 3.7.2 I_Motion Base Dev............................................................................................................. 60 3.7.3 I_Actuator Base................................................................................................................. 61 3.7.4 I_Actuator Base Dev.......................................................................................................... 62 TF8560 Version: 1.4.0 3
## Page 4

Table of contents 4 Core functions......................................................................................................................................... 65 4.1 Embedding core functions in an axis.............................................................................................. 65 4.2 The basics of core functions (FB_Core Function)............................................................................ 65 4.2.1 Permanently active core functions................................................................................... 66 4.3 Commanded core functions (FB_Corefunction Feedback).............................................................. 67 4.3.1 Edge-triggered core functions.......................................................................................... 69 4.3.2 Statically controlled core functions................................................................................... 73 4.4 Actuals............................................................................................................................................ 76 4.5 Actuals Actuator............................................................................................................................... 77 4.6 Actuals Hydraulics............................................................................................................................ 79 4.7 Actuals Nc........................................................................................................................................ 80 4.8 Auto Ident......................................................................................................................................... 81 4.8.1 Do Auto Ident()................................................................................................................... 83 4.8.2 Set Parameter()................................................................................................................. 84 4.9 Camming......................................................................................................................................... 86 4.9.1 Do Camming..................................................................................................................... 89 4.9.2 Set Guiding Value.............................................................................................................. 90 4.9.3 Set Lookup Interface.......................................................................................................... 91 4.9.4 FB_Camming Look Up....................................................................................................... 91 4.9.5 E_Lookup Mode.............................................................................................................. 100 4.10 Direct Output.................................................................................................................................. 101 4.10.1 Do Activate...................................................................................................................... 103 4.11 Disable Soft End............................................................................................................................. 104 4.11.1 Do Disable....................................................................................................................... 105 4.11.2 Re Enable....................................................................................................................... 106 4.12 External Generating....................................................................................................................... 107 4.12.1 Do Enable()..................................................................................................................... 108 4.13 Estop............................................................................................................................................. 109 4.13.1 Do Estop......................................................................................................................... 111 4.14 Homing.......................................................................................................................................... 111 4.14.1 Abort............................................................................................................................... 114 4.14.2 Absolute Switch............................................................................................................... 116 4.14.3 Absolute Switch Detect.................................................................................................... 119 4.14.4 Block.............................................................................................................................. 123 4.14.5 Block Detect.................................................................................................................... 126 4.14.6 Finish.............................................................................................................................. 130 4.14.7 Limit Switch..................................................................................................................... 132 4.14.8 Limit Switch Detect........................................................................................................... 136 4.15 Jog................................................................................................................................................ 139 4.15.1 Do Jog M()....................................................................................................................... 141 4.15.2 Do Jog P()........................................................................................................................ 141 4.15.3 Set Parameter()............................................................................................................... 142 4.16 Limiting.......................................................................................................................................... 143 4.17 Motion Params............................................................................................................................... 144 4.17.1 Actuator Params H........................................................................................................... 148 4.18 Motion Setpoints............................................................................................................................ 149 4 Version: 1.4.0 TF8560
## Page 5

Table of contents 4.19 Power............................................................................................................................................ 150 4.19.1 Do Power()...................................................................................................................... 152 4.19.2 Feed Enable()................................................................................................................. 153 4.20 Pressure Control............................................................................................................................ 153 4.20.1 Pressure Control. PID...................................................................................................... 154 4.20.2 Pressure Control. Supervisor........................................................................................... 163 4.21 Ptp................................................................................................................................................. 165 4.21.1 Check Point().................................................................................................................. 167 4.21.2 Do Move()....................................................................................................................... 168 4.21.3 Get Clamp Point()............................................................................................................ 169 4.21.4 Get Point()....................................................................................................................... 169 4.21.5 Get Updated Point()......................................................................................................... 170 4.21.6 Set Clamp Point()............................................................................................................. 171 4.21.7 Set Point()....................................................................................................................... 171 4.21.8 Update Position()............................................................................................................ 172 4.21.9 ST_Look Up Ptp Point....................................................................................................... 173 4.21.10 ST_Look Up Clamping..................................................................................................... 174 4.22 Ptp Look Up.................................................................................................................................... 175 4.22.1 Get Point()....................................................................................................................... 176 4.22.2 Read Master()................................................................................................................. 176 4.22.3 Set Point()....................................................................................................................... 177 4.22.4 Update Position()............................................................................................................ 178 4.23 Reset............................................................................................................................................. 178 4.24 Set Position.................................................................................................................................... 179 4.24.1 Do Set Position().............................................................................................................. 181 4.24.2 Set Parameter()............................................................................................................... 181 4.25 Stop............................................................................................................................................... 182 4.25.1 Do Stop()......................................................................................................................... 184 4.25.2 Set Parameter()............................................................................................................... 184 4.26 Teach Position............................................................................................................................... 185 4.27 Teach Update................................................................................................................................. 186 4.28 Tool Adaption................................................................................................................................. 187 4.29 Transformation.............................................................................................................................. 188 4.29.1 Translate From Drive()..................................................................................................... 191 4.29.2 Translate From Load()..................................................................................................... 191 4.29.3 Translate To Drive()......................................................................................................... 192 4.29.4 Translate To Load().......................................................................................................... 193 4.29.5 Update To Lin Load()........................................................................................................ 194 4.30 Tuning........................................................................................................................................... 194 4.31 Velocity Feed................................................................................................................................. 196 4.31.1 Do Feed()........................................................................................................................ 198 5 I/O........................................................................................................................................................... 199 5.1 Base (Abstract)............................................................................................................................. 199 5.1.1 Io Base............................................................................................................................ 199 5.1.2 Io Ec................................................................................................................................ 201 5.1.3 Io Ec Ads.......................................................................................................................... 204 TF8560 Version: 1.4.0 5
## Page 6

Table of contents 5.1.4 Input Base....................................................................................................................... 205 5.1.5 Output Base.................................................................................................................... 208 5.2 Analog........................................................................................................................................... 214 5.2.1 Input Analog16................................................................................................................ 214 5.2.2 Input Analog16Status...................................................................................................... 215 5.2.3 Input Analog32................................................................................................................ 218 5.2.4 Output Analog16............................................................................................................. 219 5.3 Co E............................................................................................................................................... 220 5.3.1 Input Co E_Polling........................................................................................................... 220 5.3.2 Input Co E406.................................................................................................................. 222 5.3.3 Output Co E408............................................................................................................... 223 5.3.4 Output Co E408_P........................................................................................................... 226 5.4 Digital............................................................................................................................................ 228 5.4.1 Io Digital.......................................................................................................................... 228 5.4.2 Input Digital..................................................................................................................... 229 5.4.3 Input Digital Cam.............................................................................................................. 230 5.4.4 Output Digital.................................................................................................................. 231 5.5 Serial............................................................................................................................................. 232 5.5.1 Input Ssi.......................................................................................................................... 232 5.6 Device (inverter)............................................................................................................................ 233 5.6.1 Inv Device Base............................................................................................................... 233 5.6.2 Inv Device Ec................................................................................................................... 234 5.6.3 Inv Device Co E402.......................................................................................................... 236 5.6.4 Inverter Co E402_CSVM.................................................................................................. 239 5.6.5 Inverter Co E402_VM....................................................................................................... 241 5.6.6 Inverter Analog................................................................................................................ 242 5.7 ST_Flex Value................................................................................................................................ 244 5.7.1 E_Flex Value................................................................................................................... 244 5.7.2 U_Flex Value................................................................................................................... 245 6 Machine Data.......................................................................................................................................... 247 6.1 FB_Md Container........................................................................................................................... 247 6.1.1 E_Md File Type................................................................................................................ 248 6.1.2 I_Md Json Options........................................................................................................... 248 6.2 FB_Md Component........................................................................................................................ 249 6.2.1 Md Next Parameter()........................................................................................................ 250 6.2.2 Md Set Parameter().......................................................................................................... 250 6.3 ST_Mdata...................................................................................................................................... 251 7 Utilities................................................................................................................................................... 252 7.1 Filter.............................................................................................................................................. 252 7.1.1 FB_Filter Base................................................................................................................ 252 7.1.2 FB_Filter Pt1................................................................................................................... 253 7.1.3 FB_Filter Slew Rate Limit.................................................................................................. 254 7.1.4 FB_Filter Srl Pt1............................................................................................................... 254 7.2 HRESULT..................................................................................................................................... 255 7.2.1 F_Succeeded Hr............................................................................................................. 256 6 Version: 1.4.0 TF8560
## Page 7

Table of contents 7.2.2 F_Hresult Create............................................................................................................. 256 7.2.3 F_Hresult Failure............................................................................................................. 257 7.2.4 F_Hresult Success.......................................................................................................... 258 7.3 Messages...................................................................................................................................... 258 7.3.1 FB_Message.................................................................................................................. 258 7.3.2 FB_Xyz Message............................................................................................................ 259 7.3.3 FB_Message Base.......................................................................................................... 260 7.4 Services........................................................................................................................................ 261 7.4.1 FB_Co EService.............................................................................................................. 261 7.4.2 FB_Co EParameter......................................................................................................... 262 7.5 Simulation..................................................................................................................................... 263 7.5.1 General simulation components..................................................................................... 263 7.5.2 Simulation of an Ether CAT based servo drive axis........................................................ 268 7.5.3 Simulation of an inverter axis......................................................................................... 277 7.5.4 I/O Simulation containers............................................................................................... 290 7.5.5 Components of the hydraulic simulation........................................................................ 293 7.5.6 Sim Actuator.................................................................................................................... 302 7.6 Debug............................................................................................................................................ 303 7.6.1 FB_Check Demo Mode.................................................................................................... 303 7.6.2 FB_Change Detector...................................................................................................... 304 7.6.3 FB_Core Debug.............................................................................................................. 305 7.7 Plc Mc Manager Support................................................................................................................. 305 7.8 External Hyd Axis Lib Ref................................................................................................................. 306 8 Appendix................................................................................................................................................ 308 8.1 Torque Limiting.............................................................................................................................. 308 8.2 Pressure Control............................................................................................................................ 309 8.2.1 I_Axis Base. Set Process Handler()................................................................................... 309 8.2.2 PID. Enable Switch Over()................................................................................................ 309 8.2.3 PID. Get Actual().............................................................................................................. 310 8.2.4 PID. Get Params()............................................................................................................ 311 8.2.5 PID. Set Params()............................................................................................................ 311 8.2.6 PID. Setpoint()................................................................................................................. 312 8.2.7 FB_Process Handler Base............................................................................................... 312 8.2.8 FB_Read Process Value.................................................................................................. 317 TF8560 Version: 1.4.0 7
## Page 8

Table of contents 8 Version: 1.4.0 TF8560
## Page 9

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TF8560 Version: 1.4.0 9
## Page 10

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 10 Version: 1.4.0 TF8560
## Page 11

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. 1.4 Documentation issue status Version Change 1.4.x Software v12.10.0 - New features added Properties and methods supplemented in several function blocks New: FB_Crank Double Shaft Table Generator [} 56] Pressure Control [} 309] 1.3.x New: FB_Sim Co E402_Inverter [} 277] 1.2.x Additions in the chapters: Axes [} 14], Core functions [} 65], I/O [} 199], Machine Data [} 247], Utilities [} 252], Appendix [} 308] 1.1.x New: I/O [} 199] 1.0.x New creation TF8560 Version: 1.4.0 11
## Page 12

Concept of Libraries 2 Concept of Libraries TF8560 TC3 Plastic Technology Functions is a solution that allows the plastics processing industry to rapidly implement Twin CAT 3-based motion tasks. In plastics processing machines, two different drive types, electric and hydraulic, can be used individually or in combination. The underlying Motion Control libraries for these two drive types are different. Therefore, there is the Twin CAT 3 NC PTP (TF5000) for electric axes and the Twin CAT 3 Hydraulic Positioning (TF5810) for hydraulic axes on the Twin CAT 3 platform. If the control program is developed directly on the basis of these two Motion Control libraries, the customer must re-implement all interfaces that call different libraries when the drive technology is changed. TC3 Plastic Technology Functions provides a unified interface for the common functions of the hydraulic and electric Motion Control libraries. When developing the control program based on TC3 Plastic Technology Functions, only minimal modification is necessary for a different drive technology. In addition, the elementary motion tasks commonly used in plastics processing, such as cam plates for wall thickness control, multi-segment PTP motion, and pressure control, have been implemented and fully tested in TC3 Plastic Technology Functions, encapsulated as core functions. Customers are freed from building them from scratch and can directly use the provided components to achieve complex functions with little engineering effort. The basic concept of TC3 Plastic Technology Functions: • Uniformity: A uniform interface for calling common Motion Control functions for hydraulic and electric axes. • Ready-to-use: Implementation and encapsulation of essential motion tasks commonly used in plastics processing processes. • Expandability: Extension or modification of the functions through inheritance. • Flexibility: Choice of language, object/process-oriented programming approach, multitasking/multi-core capability (to be tested). TC3 Plastic Technology Functions libraries and license TC3 Plastic Technology Functions can be considered as an interface between the customer application and the Twin CAT 3 platform. TC3 Plastic Technology Functions consists of three libraries, namely Tc3_Plastic Functions, Tc3_Plastic Nc, and Tc3_Plastic Hydraulic. Their dependencies are as shown in the figure below. Tc3_Plastic Functions implements the common functions for both drive types. The functions specific to the electric or hydraulic axes are implemented respectively in Tc3_Plastic Nc and Tc3_Plastic Hydraulic and will correspondingly call TF5000 Twin CAT 3 NC PTP or TF5810 Twin CAT 3 Hydraulic Positioning. 12 Version: 1.4.0 TF8560
## Page 13

Concept of Libraries TF8560 Version: 1.4.0 13
## Page 14

Axes 3 Axes When setting up the functions of an axis, the methods and properties for implementing an elementary motion task are bundled in special function blocks. These are so-called core functions, which can be an active command, such as executing a multi-segment PTP movement, or a passive task, such as displaying the motion state and parameters of an axis, and are described in more detail in the chapter "Core functions concept". 3.1 FB_Axis Base - Virtual axes Twin CAT 3 Plastic Technology Functions defines FB_Axis Base as a virtual base axis. This provides the core functions required for both electric and hydraulic drives. The ABSTRACT definition means that FB_Axis Base cannot be instantiated. This is intentional, as the connection to specific Motion Control libraries is missing and some core functions are only instantiated in the specific versions. For electric axes FB_Axis Nc Base and for hydraulic axes FB_Axis Hydraulic Base is derived from FB_Axis Base. On the one hand, the connection to the Motion Control libraries is established. On the other hand, special axis types add their own core functions for their mode of operation. The following figure shows how the axis classes (FBs) in Twin CAT 3 Plastic Technology Functions are to be understood structurally. Further motion objects In addition to the basic concept of NC-based and hydraulic-based axes, the Plastic Technology Functions provide further axis and movement types. These include transformation and inverter axes as well as digital linear actuators. The following UML diagram shows the relationship between the individual types and their availability per library. 14 Version: 1.4.0 TF8560
## Page 15

Axes 3.2 Instantiation FB_Axis Nc Base, FB_Axis Hydraulic Base and FB_Axis Inv Base can be instantiated. Below you will find sample code for creating instances of these axis types. The input variables of these FBs are all defined in the method FB_init(). FB_init() is always called implicitly when initializing an instance of a FB. For a detailed description see FB_init(). Some input variables of FB_init() must be assigned mandatory, while others are optional and can be 0. The following table shows the requirements of FB_Axis Nc Base, FB_Axis Hydraulic Base, FB_Axis Inv Base and FB_Actuator Base when assigning their input variables. For a detailed explanation of each input variable, see METHOD FB_init(). The open source project TF85xx - Plastic Application, which is based on TF8560 - Twin CAT 3 Plastic Technology Functions, has designed common machine axes and their motion tasks in blow molding and other types of plastics machines. This includes axes such as clamp, blow pin, wall thickness control, injection unit, etc. Customers can use the Plastic Application as the basis for their control system or as a tutorial for TF8560 Twin CAT 3 Plastic Technology Functions as required. Name Description FB_Axis Hydraulic Base [} 17] Hydraulic axes, operated with the Tc2_Hydraulics library. FB_Axis Nc Base [} 15] Servo axes, operated with the Tc2_MC2 library. FB_Axis Nc Trafo Base [} 16] Transforming servo axes, operated with the Tc2_MC2 library. FB_Axis Inv Base [} 19] Inverter axes FB_Actuator Base [} 20] Digital linear actuators 3.2.1 FB_Axis Nc Base This FB creates an axis operated with the Tc2_MC2 library. Syntax: fb Nc Axis: FB_Axis Nc Base ( Axis Name := 'Nc Clamp Axis1', n Ptp Points := 10, i Process Handler := 0, TF8560 Version: 1.4.0 15
## Page 16

Axes i Pos Cam Lookup := 0, i Velo Cam Lookup := 0 ); Initialization parameters of the FB_init constructor Designation Type Obligatory Description Axis Name STRING Yes The text-based name of the axis. Used for messages and file names, among other things. n Ptp Points INT Yes Number of available segments in PTP tables. The number of points can also be set via Ptp. Set Points() i Process Handler I_Process Handler No A function block for handling pressures and other process variables. Reserved, currently to be assigned zero i Pos Cam Lookup I_Camming Lookup No An interface to a FB with a position cam plate. [} 91] This input is usually assigned zero, as the cam plate is defined at a later point in time. i Velo Cam Lookup I_Camming Lookup No An interface to a FB with a velocity cam plate. [} 91] This input is usually assigned zero, as the cam plate is defined at a later point in time. Required libraries NC-based axes require the Tc2_MC2 library and a Twin CAT NC license. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.2.2 FB_Axis Nc Trafo Base This FB creates a transforming axis operated with the Tc2_MC2 and Tc2_MC2_Camming library. Syntax: fb Nc Trafo Axis: FB_Axis Nc Trafo Base ( Axis Name := 'Nc Axis', n Ptp Points := 10, n Trafo Points := 181, i Process Handler := 0, i Pos Cam Lookup := 0, i Velo Cam Lookup := 0 ); 16 Version: 1.4.0 TF8560
## Page 17

Axes Initialization parameters of the FB_init constructor Designation Type Obligatory Description Axis Name STRING Yes The text-based name of the axis. Used for messages and file names, among other things. n Ptp Points INT Yes Number of available segments in PTP tables. The number of points can also be set via Ptp. Set Points() n Trafo Points INT Yes Number of usable transformer points in the transformation table. i Process Handler I_Process Handler No A function block for handling pressures and other process variables. Reserved, currently to be assigned zero i Pos Cam Lookup I_Camming Lookup No An interface to a FB with a position cam plate. [} 91] This input is usually assigned zero, as the cam plate is defined at a later point in time. i Velo Cam Lookup I_Camming Lookup No An interface to a FB with a velocity cam plate. [} 91] This input is usually assigned zero, as the cam plate is defined at a later point in time. Required libraries NC-based transformation axes require the Tc2_MC2 and the Tc2_MC2_Camming library and a Twin CAT NC PTP & Camming license. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.2.3 FB_Axis Hydraulic Base This FB creates an axis operated with the Tc2_Hydraulics library. Syntax: fb Hyd Axis1: FB_Axis Hydraulic Base ( Axis Name := 'Hyd Clamp Axis1', n Ptp Points := 10, i Process Handler := 0, i Pos Cam Lookup := 0, i Velo Cam Lookup := 0, i Encoder := fb Hyd Clamp Axis Enc In01, i Drive := fb Hyd Clamp Axis Drive Out01, i Pressure P := fb Hyd Clamp Axis1Prs In P, TF8560 Version: 1.4.0 17
## Page 18

Axes i Pressure M := fb Hyd Clamp Axis1Prs In M, i Pos Filter := 0, i Velo Filter := 0 ); Initialization parameters of the FB_init constructor Designation Type Obligatory Description Axis Name STRING Yes The text-based name of the axis. Used for messages and file names, among other things. n Ptp Points INT Yes Number of available segments in PTP tables. The number of points can also be set via Ptp. Set Points() i Process Handler I_Process Handler No A function block for handling pressures and other process variables. Reserved, currently to be assigned zero i Pos Cam Lookup I_Camming Lookup No An interface to a FB with a position cam plate. [} 91] This input is usually assigned zero, as the cam plate is defined at a later point in time. i Velo Cam Lookup I_Camming Lookup No An interface to a FB with a velocity cam plate. [} 91] This input is usually assigned zero, as the cam plate is defined at a later point in time. i Encoder I_Input Base Yes I/O interface for the encoder. This interface is used to determine the actual position of the axis. Can also be assigned via a property i Drive I_Output Base Yes I/O interface for the drive. This interface is used to output the target velocity of the axis. Can also be assigned via a property i Pressure P I_Input Base No I/O interface for a pressure sensor. This interface is used to determine the pressure on the positive cylinder surface. Can also be assigned via a property i Pressure M I_Input Base No I/O interface for a pressure sensor. This interface is used to determine the pressure on the negative cylinder surface. Can also be assigned via a property i Pos Filter I_Filter No Interface for a filter of the actual position. Can also be assigned via a property i Velo Filter I_Filter No Interface for a filter of the actual velocity. Can also be assigned via a property 18 Version: 1.4.0 TF8560
## Page 19

Axes Strong filtering Strong filtering may have a negative effect on the performance of the axis. Required libraries Hydraulic axes require the Tc2_Hydraulics library. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 3.2.4 FB_Axis Inv Base This FB creates an axis operated with a simple inverter. This type of axis is prepared for the use of drive components whose definition is below the possibilities of a servo axis. The biggest problem might be the lack of position feedback. But even very simple drives like frequency inverters may be used to support some tasks in a machine, such as turning an extruder or moving a conveyor belt. The axis does not require position feedback and does not support position-bound functions. Syntax: fb Inv Axis: FB_Axis Inv Base ( Axis Name := 'Inv Extruder', n Ptp Points := 10, i Process Handler := 0, i Pos Cam Lookup := 0, i Velo Cam Lookup := 0 ); Initialization parameters of the FB_init constructor Designation Type Obligatory Axis Name STRING Yes Used for messages and file names, among other things. n Ptp Points INT No Not supported for inverter axes i Process Handler I_Process Handler No Optional: A function block for handling pressures and other process variables. i Pos Cam Lookup I_Camming Lookup No Not supported for inverter axes i Velo Cam Lookup I_Camming Lookup No Optional: A lookup function block with a Vvs P camming table. [} 91] Connection options (I/Os) Designation Type Description Device I_Inv Device [} 233] Field device used to control the axis TF8560 Version: 1.4.0 19
## Page 20

Axes Availability of connection options The connection option is available as a property of the axis and can be linked once to an I/O instance: e.g. fb Inv Axis. Device := fb Device Co E; Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.2.5 FB_Actuator Base This FB creates an instance of a linear Boolean actuator. These include, for example, pneumatic or hydraulic valves with connected cylinders. For control, the actuator shares the common interface I_Motion Base [} 60] with the other axis types. This allows simple motion functions to be programmed regardless of the compact drive technology used: for example, a pneumatic handling device could be replaced by a compact servo axis via the interface. Syntax: fb Actuator: FB_Actuator Base; Connection options (I/Os) Designation Type Description Feedback Base I_Input Base [} 229] Feedback signal for reaching the base position Feedback Work I_Input Base [} 229] Feedback signal for reaching the working position Output Base I_Output Base [} 231] Output signal for control in base position Output Work I_Output Base [} 231] Output signal for control in working position Feedback Power I_Input Base [} 229] Feedback signal for the successful release of active operation. Can be connected to pressure monitoring of the supply, for example. Output Power I_Output Base [} 231] Output signal for enabling the actuator. Can be connected to a supply shut-off valve, for example. Availability of connection options The connection options are available as properties of the axis and can be linked once to an I/O instance: e.g. fb Actuator. Output Work := fb Output Work; Necessity of individual connections All linkable device connections (I/Os) of an actuator are optional, • Missing outputs limit the possible commands • Missing inputs are simulated with a parameterizable time [} 148] Only digital I/O devices possible Despite the use of general I/O interfaces for the device connections, only digital options can currently be used. An extension is planned for future versions. 20 Version: 1.4.0 TF8560
## Page 21

Axes Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.3 Properties and methods Some of the properties of the axes are standard variables (e.g. i Nc Sample Axis. Name of type STRING) and the required information can be processed directly. Other properties are so-called Core Functions and return a type INTERFACE to the Core Function itself. For example, the axis has a property of type I_Power with the name Power, which is the INTERFACE of FB_Power. This interface can be used to access properties and methods provided there. The constantly active algorithms for cyclic calls are not executed in the main part (body) of the FBs, but in its cycle method. An axis is therefore only executed if its Cyclic() methods are called. In addition, the cycle method of an axis should be called exactly once for each PLC cycle, as these can also execute setpoint generation and control algorithms. // Core Function method calls i Nc Sample Axis. Power. Do Power(TRUE) i Nc Sample Axis. Power. Feed Enable(TRUE, TRUE); // Core Function property access b Enabled := i Nc Sample Axis. Power. Status; // Cyclic call of the axis i Nc Sample Axis. Cyclic(); 3.4 States (state machine) The state of an axis is declared via an enumeration of the type E_Axis State. This information is provided by each axis as a property with the name State (e.g. i Nc Sample Axis. State). An overview of all states can be represented as follows: TF8560 Version: 1.4.0 21
## Page 22

Axes State Description e Init The axis is in the initialization phase and must be initialized according to the application requirements. In this state the axis is not ready for operation. e Config The axis applies a series of parameters from the subordinate drive technology (NC, hydraulics library). Settings that are important for correct operation are checked for correspondence to the motion technology. ADS and mapping connections are also tested at the same time. e Ready The axis has been successfully initialized and configured. It is ready to accept an enable, given via i Axis. Power. e Idle The axis is enabled and ready to accept motion commands (e.g. Jog P() ). e Busy The axis is processing a command (e.g. Jog P() ). e Done The axis has successfully completed a command (e.g. Table Move() ). e Stopping The axis is in the state of processing a stop or Estop command. e Stopped The Stop command was successful. e Emergency Stop The Estop command was successful. 22 Version: 1.4.0 TF8560
## Page 23

Axes State Description e Resetting The axis was instructed by Reset() to initiate the change from the state e Failed to the state e Ready. e Failed The axis is in the error state. 3.5 Axis variants and their interfaces The TC3 Plastic Technology Functions creates the corresponding INTERFACEs for each function block (FB). For a detailed description see INTERFACE concept. In this document the following naming rules are applied: FB_Xyz: Declaration of a function block fb Xyz: an instance of FB_Xyz I_Xyz: the INTERFACE declaration corresponding to FB_Xyz i Xyz: a variable of I_Xyz that is instantiated with fb Xyz NOTICE Do not access the fb Xyz instance of an axis directly We suggest that you don't access the fb Xyz of an axis directly, but instead access the properties and methods of the FB_Xyz via i Xyz, as is shown below. This is because the development of I_Xyz in TC3_Plastic Technology Functions only considers the properties and methods that are needed externally to operate FB_Xyz. In contrast to that, the properties and methods that are only to be called by other methods inside FB_Xyz do not appear in I_Xyz. As a result, i Xyz is clearer than fb Xyz and customers can find the information they need faster than with fb Xyz, while the risk of misuse is prevented. s Name := fb Nc Axis1. Name // not preferred s Name := i Nc Clamp1. Name // preferred It should be noted that TC3 Plastic Technology Functions creates two INTERFACEs with different information content for each function block of the axes. For example, FB_Axis Base has the interfaces I_Axis Base and I_Axis Base Dev. I_Axis Base contains the necessary functions of the axes for most common cases. In contrast, I_Axis Base Dev provides more information access and allows users to implement more complex functions. For the sake of simplicity and security, it is recommended to use the general interface (e.g. I_Axis Base). i Nc Axis1: I_Axis Nc Base := fb Nc Axis1; i Nc Axis1Dev: I_Axis Nc Base Dev := fb Nc Axis1; i Hyd Axis1: I_Axis Hydraulic Base := fb Hyd Axis1; i Hyd Axis1Dev: I_Axis Hydraulic Base Dev := fb Hyd Axis1; The following UML diagram shows the available interfaces of the individual axes and their inheritance structure. TF8560 Version: 1.4.0 23
## Page 24

Axes Name Description I_Motion Base [} 60] General motion unit I_Motion Base Dev [} 60] I_Axis Base [} 25] General axis I_Axis Base Dev [} 26] I_Axis Nc Base [} 29] NC-based axis I_Axis Nc Base Dev [} 30] I_Axis Hydraulic Base [} 32] Hydraulic-based axis. I_Axis Hydraulic Base Dev [} 34] . I_Axis Inv Base [} 37] Inverter-based axis I_Axis Inv Base Dev [} 38] I_Axis Trafo Base [} 42] General transformation axis I_Axis Trafo Base Dev [} 44] I_Axis Nc Trafo Base [} 46] NC-based transformation axis I_Axis Nc Trafo Base Dev [} 48] 24 Version: 1.4.0 TF8560
## Page 25

Axes Name Description I_Actuator Base [} 61] Digital linear actuator I_Actuator Base Dev [} 62] 3.5.1 I_Axis Base Represents the general interface for an axis. Syntax: INTERFACE I_Axis Base EXTENDS I_Motion Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. Auto Torque Limit Sel BOOL Get, Set A TRUE allows the axis to select an internal function ect1 block for torque limitation if the type of a servo drive (Co E, So E) has been detected. Alternatively: . Auto Limiting Select TF8560 Version: 1.4.0 25
## Page 26

Axes Name Type Access Description Axis Name1 STRING Get, Set The axis name must be unique. This is of particular importance for hydraulic axes. The library used here uses the axis name as file name for loading and saving the axis parameters. Alternatively: . Name Bad Switch Over1 BOOL Get Identifies whether a pressure switchover has occurred due to safety conditions. Alternatively: . Pressure Control. Supervisor. B ad Switch Over Torque Limiting I_Torque Limiting Get Torque limitation of the axis. [} 308]1 Alternatively: . Limiting Switch Over1 BOOL Get The pressure switchover has been triggered. Alternatively: . Pressure Control. Supervisor. S witch Over I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. 1Obsolete Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Obsolete elements only Get Process Handler()1 Reserved for future extension. Set Process Handler() Reserved for future extension. [} 309]1 I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. 1Obsolete Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 3.5.2 I_Axis Base Dev Represents the extended interface for an axis. Syntax: INTERFACE I_Axis Base Dev EXTENDS I_Axis Base, I_Motion Base Dev 26 Version: 1.4.0 TF8560
## Page 27

Axes Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Base Dev Axis Is Inverter BOOL Get TRUE if the axis is of type FB_Axis Inv Base [} 19]. Axis Is Nc BOOL Get TRUE if the axis is based on a Twin CAT NC axis. Ptp Points INT Get, Set The number of supported segments in the table supported by Ptp [} 165]. I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. [INTERN] I_Core Debug Get Debugging support Core Debug [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] TF8560 Version: 1.4.0 27
## Page 28

Axes Name Type Access Description Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Dev [INTERN] Only for internal use. Convert Count To Pos [INTERN] Only for internal use. Convert Pos To Count Go Error Base(n Error C This method can be used to set the axis to an error state. ode) Set Limiting(i Limiting This method connects a limiting block to the axis. ) Set Torque Limiting(i Torq This method connects a torque limiting block to the axis. ue Limiting)1 I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. 1Obsolete 28 Version: 1.4.0 TF8560
## Page 29

Axes Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 3.5.3 I_Axis Nc Base Represents the general interface for an NC axis. Syntax: INTERFACE I_Axis Nc Base EXTENDS I_Axis Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Nc Base Actuals Nc [} 80] I_Nc Actuals Get Provision of current actual values (positions, velocities, torque, etc.). It is an extended version of Actuals. I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base TF8560 Version: 1.4.0 29
## Page 30

Axes Name Type Access Description Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.5.4 I_Axis Nc Base Dev Represents the extended interface for an NC axis. Syntax: INTERFACE I_Axis Nc Base Dev EXTENDS I_Axis Base Dev, I_Axis Nc Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Base Dev Axis Is Inverter BOOL Get TRUE if the axis is of type FB_Axis Inv Base [} 19]. Axis Is Nc BOOL Get TRUE if the axis is based on a Twin CAT NC axis. Ptp Points INT Get, Set The number of supported segments in the table supported by Ptp [} 165]. I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. [INTERN] I_Core Debug Get Debugging support Core Debug 30 Version: 1.4.0 TF8560
## Page 31

Axes Name Type Access Description [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Axis Nc Base Actuals Nc [} 80] I_Nc Actuals Get Provision of current actual values (positions, velocities, torque, etc.). It is an extended version of Actuals. I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. TF8560 Version: 1.4.0 31
## Page 32

Axes Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Nc Base Dev Get Nc Axis Ref() The address to the mapping interface (AXIS_REF) between NC and PLC. I_Axis Base Dev [INTERN] Only for internal use. Convert Count To Pos [INTERN] Only for internal use. Convert Pos To Count Go Error Base(n Error C This method can be used to set the axis to an error state. ode) Set Limiting(i Limiting This method connects a limiting block to the axis. ) Set Torque Limiting(i Torq This method connects a torque limiting block to the axis. ue Limiting)1 I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.5.5 I_Axis Hydraulic Base Represents the general interface for a hydraulic axis. Syntax: INTERFACE I_Axis Hydraulic Base EXTENDS I_Axis Base 32 Version: 1.4.0 TF8560
## Page 33

Axes Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Hydraulic Base Actuals Hydraulics I_Actuals Hydraulic Get Provision of current actual values (positions, velocities, pressures, etc.). It is an extended version [} 79] of Actuals. Auto Ident [} 81] I_Auto Ident Get Automatic characteristic measurement of the hydraulic axis. Direct Output I_Direct Output Get Direct output via the drive interface of the axis. [} 101] Use Dat File BOOL Get, Set A TRUE here signals that the axis loads its parameters with function blocks of the hydraulics library from a file during startup. Notice A TRUE must be set before the first Cyclic call. I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). TF8560 Version: 1.4.0 33
## Page 34

Axes Name Type Access Description Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 3.5.6 I_Axis Hydraulic Base Dev Represents the extended interface for a hydraulic axis. Syntax: INTERFACE I_Axis Hydraulic Base Dev EXTENDS I_Axis Base Dev, I_Axis Hydraulic Base, I_External Hyd Axis Lib Ref Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Hydraulic Base Dev Drive I_Output Base Get, Set I/O interface for communication with the axis output hardware. Encoder I_Input Base Get, Set I/O interface for communication with the actual value acquisition of the axis. Pos Filter I_Filter Get, Set Filter interface for filtering the actual position of the axis. Pressure Input M I_Input Base Get, Set I/O interface for determining the actual pressure of the axis acting in the negative direction of movement. Pressure Input P I_Input Base Get, Set I/O interface for determining the actual pressure of the axis acting in the positive direction of movement. Velo Filter I_Filter Get, Set Filter interface for filtering the actual velocity of the axis. I_Axis Base Dev Axis Is Inverter BOOL Get TRUE if the axis is of type FB_Axis Inv Base [} 19]. 34 Version: 1.4.0 TF8560
## Page 35

Axes Name Type Access Description Axis Is Nc BOOL Get TRUE if the axis is based on a Twin CAT NC axis. Ptp Points INT Get, Set The number of supported segments in the table supported by Ptp [} 165]. I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. [INTERN] I_Core Debug Get Debugging support Core Debug [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Axis Hydraulic Base Actuals Hydraulics I_Actuals Hydraulic Get Provision of current actual values (positions, velocities, pressures, etc.). It is an extended version [} 79] of Actuals. Auto Ident [} 81] I_Auto Ident Get Automatic characteristic measurement of the hydraulic axis. Direct Output I_Direct Output Get Direct output via the drive interface of the axis. [} 101] Use Dat File BOOL Get, Set A TRUE here signals that the axis loads its parameters with function blocks of the hydraulics library from a file during startup. Notice A TRUE must be set before the first Cyclic call. I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. TF8560 Version: 1.4.0 35
## Page 36

Axes Name Type Access Description Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_External Hyd Axis Lib Ref Get Hyd Axis Ref() The address to the mapping interface (AXIS_REF_Bk Plc Mc) between hydraulics library and PLC. I_Axis Base Dev [INTERN] Only for internal use. Convert Count To Pos [INTERN] Only for internal use. Convert Pos To Count Go Error Base(n Error C This method can be used to set the axis to an error state. ode) Set Limiting(i Limiting This method connects a limiting block to the axis. ) Set Torque Limiting(i Torq This method connects a torque limiting block to the axis. ue Limiting)1 I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Axis Base Obsolete elements only 36 Version: 1.4.0 TF8560
## Page 37

Axes I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 3.5.7 I_Axis Inv Base Represents the general interface for an inverter axis. Syntax: INTERFACE I_Axis Inv Base EXTENDS I_Axis Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. TF8560 Version: 1.4.0 37
## Page 38

Axes Name Type Access Description I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.5.8 I_Axis Inv Base Dev Represents the extended interface for an inverter axis. Syntax: INTERFACE I_Axis Inv Base Dev EXTENDS I_Axis Base Dev, I_Axis Inv Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Inv Base Dev Device I_Inv Device Get, Set I/O interface for communication with the axis inverter I_Axis Base Dev Axis Is Inverter BOOL Get TRUE if the axis is of type FB_Axis Inv Base [} 19]. Axis Is Nc BOOL Get TRUE if the axis is based on a Twin CAT NC axis. Ptp Points INT Get, Set The number of supported segments in the table supported by Ptp [} 165]. I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. 38 Version: 1.4.0 TF8560
## Page 39

Axes Name Type Access Description Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Dev [INTERN] Only for internal use. Convert Count To Pos [INTERN] Only for internal use. Convert Pos To Count Go Error Base(n Error C This method can be used to set the axis to an error state. ode) Set Limiting(i Limiting This method connects a limiting block to the axis. ) Set Torque Limiting(i Torq This method connects a torque limiting block to the axis. ue Limiting)1 I_Motion Base Dev TF8560 Version: 1.4.0 39
## Page 40

Axes Name Description [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.6 Transformation axes The mechanical solution for some axis types requires the design of a non-linear lever mechanism. The tool path does not follow the drive movement in a constant ratio. This enables the optimization of axis properties for varying requirements in individual areas of the travel. For the best possible embedding of this non- linearity, this design must be represented accordingly by a suitable software concept. Typical mechanics for a transforming axis would be: • Crank drives • Scotch yoke • customized concepts. • etc… 3.6.1 Construction of a transforming axis A transformation axis is a container object that implements the same interface as a standard Nc axis. Inside this object there are two local standard axis objects, named Load Side and Drive Side. These internal objects are used to handle the specific requirements for the effective tool and the actuator part. There is almost no exchange between the application project and these internal objects because the usual interactions use the interfaces of the container object. 40 Version: 1.4.0 TF8560
## Page 41

Axes Used symbols Symbol Description Actuals A common core function that contains information about the current situation of the axis. There are alternative sub-versions for the different axis types. TA: Tool Adaptation A common core function that is used to handle the differences between the axis and the effective tool. TRx: Transformation A core function specific to transforming axes. It is used to convert actual values of the drive side axis into load side actual values (TR1) and load side setpoints (TR2) or setpoints (TR3) into drive side values. MM: Operation mode select In this figure the "Full transformation mode" is selected. 3.6.2 Semi-transformation mode In this operation mode all commands are forwarded to the Drive Side axis. To avoid unexpected position lag errors, the Load Side axis is not enabled. The actual position and velocity values of the Load Side are updated using translated values from the Drive Side. Any commanded motion will be executed by the Drive Side using translated target position values. A commanded move to 100.0 will make the tool travel to 100.0 mm, no matter what Drive Side motor angle is required. Velocity cannot be translated The commanded velocity cannot be translated because the result would depend on the position. TF8560 Version: 1.4.0 41
## Page 42

Axes No constant velocity Because the profile generation is executed by the Drive Side axis, the tool will not travel with constant velocity. No position or velocity camming A position or velocity camming is not supported. 3.6.3 Full transformation mode In this operation mode, almost all commands are forwarded to the Load Side axis. Enabling the container object will enable both internal axes. The actual position and velocity values of the Load Side are updated using translated values from the Drive Side. The transformation will be performed by converting the output of the Load Side profile calculation. Again, a commanded move to 100.0 will make the tool travel to 100.0 mm, no matter what Drive Side motor angle is required. Constant velocity Because the profile generation is executed by the Load Side axis, the tool will travel with constant velocity. Excessive Drive Side velocity values required In some areas of the travel, even low tool velocities may require excessive Drive Side velocity values. Full transformation temporarily paused For Jog or Homing commands, the full transformation is temporarily paused. All position and velocity values are used following Drive Side definitions without any translation. 3.6.4 I_Axis Trafo Base Represents the general interface for a transformation axis. Syntax: INTERFACE I_Axis Trafo Base EXTENDS I_Axis Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Trafo Base Actuals Drive I_Motion Actuals Get Provision of current actual values of the drive side (positions, velocities, etc.). Motion Setpoints Driv I_Motion Setpoints Get Provision of current setpoints on the drive side e (position, velocity, etc.). Suspend BOOL Get, Set Temporarily suspends the full transformation. Suspended BOOL Get The full transformation is temporarily suspended. Synchronise BOOL Get, Set Activates the full transformation of the axis. Synchronised BOOL Get The full transformation is active. Transformation I_Transformation Get Transformation function of the axis. [} 188] 42 Version: 1.4.0 TF8560
## Page 43

Axes Name Type Access Description I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. TF8560 Version: 1.4.0 43
## Page 44

Axes Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.6.5 I_Axis Trafo Base Dev Represents the extended interface for a transformation axis. Syntax: INTERFACE I_Axis Trafo Base Dev EXTENDS I_Axis Base Dev, I_Axis Trafo Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Trafo Base Dev Do Transforming BOOL Get, Set [INTERNAL] For internal use only. Drive Side Base I_Axis Base Dev Get Interface to the drive side of the transformation axis. Is Transforming BOOL Get, Set [INTERNAL] For internal use only. Load Side Base I_Axis Base Dev Get Interface to the load side of the transformation axis. I_Axis Base Dev Axis Is Inverter BOOL Get TRUE if the axis is of type FB_Axis Inv Base [} 19]. Axis Is Nc BOOL Get TRUE if the axis is based on a Twin CAT NC axis. Ptp Points INT Get, Set The number of supported segments in the table supported by Ptp [} 165]. I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. [INTERN] I_Core Debug Get Debugging support Core Debug [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Axis Trafo Base Actuals Drive I_Motion Actuals Get Provision of current actual values of the drive side (positions, velocities, etc.). Motion Setpoints Driv I_Motion Setpoints Get Provision of current setpoints on the drive side e (position, velocity, etc.). Suspend BOOL Get, Set Temporarily suspends the full transformation. Suspended BOOL Get The full transformation is temporarily suspended. Synchronise BOOL Get, Set Activates the full transformation of the axis. Synchronised BOOL Get The full transformation is active. 44 Version: 1.4.0 TF8560
## Page 45

Axes Name Type Access Description Transformation I_Transformation Get Transformation function of the axis. [} 188] I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Dev [INTERN] Only for internal use. Convert Count To Pos TF8560 Version: 1.4.0 45
## Page 46

Axes Name Description [INTERN] Only for internal use. Convert Pos To Count Go Error Base(n Error C This method can be used to set the axis to an error state. ode) Set Limiting(i Limiting This method connects a limiting block to the axis. ) Set Torque Limiting(i Torq This method connects a torque limiting block to the axis. ue Limiting)1 I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.6.6 I_Axis Nc Trafo Base Represents the general interface for a transforming NC axis. Syntax: INTERFACE I_Axis Nc Trafo Base EXTENDS I_Axis Trafo Base, I_Axis Nc Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Nc Trafo Base Actuals Drive Nc I_Nc Actuals Get Provision of current actual values of the drive side (positions, velocities, torque, etc.). It is an extended version of Actuals. I_Axis Nc Base 46 Version: 1.4.0 TF8560
## Page 47

Axes Name Type Access Description Actuals Nc [} 80] I_Nc Actuals Get Provision of current actual values (positions, velocities, torque, etc.). It is an extended version of Actuals. I_Axis Trafo Base Actuals Drive I_Motion Actuals Get Provision of current actual values of the drive side (positions, velocities, etc.). Motion Setpoints Driv I_Motion Setpoints Get Provision of current setpoints on the drive side e (position, velocity, etc.). Suspend BOOL Get, Set Temporarily suspends the full transformation. Suspended BOOL Get The full transformation is temporarily suspended. Synchronise BOOL Get, Set Activates the full transformation of the axis. Synchronised BOOL Get The full transformation is active. Transformation I_Transformation Get Transformation function of the axis. [} 188] I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. TF8560 Version: 1.4.0 47
## Page 48

Axes Name Type Access Description Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Base Obsolete elements only I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.6.7 I_Axis Nc Trafo Base Dev Represents the extended interface for a transforming NC axis. Syntax: INTERFACE I_Axis Nc Trafo Base Dev EXTENDS I_Axis Trafo Base Dev, I_Axis Nc Base Dev, I_Axis Nc Trafo Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Axis Trafo Base Dev Do Transforming BOOL Get, Set [INTERNAL] For internal use only. Drive Side Base I_Axis Base Dev Get Interface to the drive side of the transformation axis. Is Transforming BOOL Get, Set [INTERNAL] For internal use only. Load Side Base I_Axis Base Dev Get Interface to the load side of the transformation axis. I_Axis Base Dev Axis Is Inverter BOOL Get TRUE if the axis is of type FB_Axis Inv Base [} 19]. Axis Is Nc BOOL Get TRUE if the axis is based on a Twin CAT NC axis. Ptp Points INT Get, Set The number of supported segments in the table supported by Ptp [} 165]. I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. [INTERN] I_Core Debug Get Debugging support Core Debug 48 Version: 1.4.0 TF8560
## Page 49

Axes Name Type Access Description [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Axis Nc Trafo Base Actuals Drive Nc I_Nc Actuals Get Provision of current actual values of the drive side (positions, velocities, torque, etc.). It is an extended version of Actuals. I_Axis Trafo Base Actuals Drive I_Motion Actuals Get Provision of current actual values of the drive side (positions, velocities, etc.). Motion Setpoints Driv I_Motion Setpoints Get Provision of current setpoints on the drive side e (position, velocity, etc.). Suspend BOOL Get, Set Temporarily suspends the full transformation. Suspended BOOL Get The full transformation is temporarily suspended. Synchronise BOOL Get, Set Activates the full transformation of the axis. Synchronised BOOL Get The full transformation is active. Transformation I_Transformation Get Transformation function of the axis. [} 188] I_Axis Nc Base Actuals Nc [} 80] I_Nc Actuals Get Provision of current actual values (positions, velocities, torque, etc.). It is an extended version of Actuals. I_Axis Base Auto Limit Select BOOL Get, Set A TRUE allows the axis to select an internal function block for limiting if the servo drive type (Co E, So E) has been detected. Camming [} 86] I_Camming Main Get Functions for processing cam plates. Disable Soft End I_Disable Soft End Get Possibility to temporarily disable the software limit switches of the axis and restore their original state. [} 104] Estop [} 109] I_Estop Get Function for canceling an active motion command to bring the axis to a standstill. If available, increased dynamic parameters are applied. Ext Generated BOOL Get TRUE if the setpoint generation runs via the External Generating [} 107] core function. Homing [} 111] I_Homing Main Get Provision of a selection of homing procedures. Limiting [} 143] I_Limiting Get Limitation (torque, pressure, etc.) of the axis. Motion Setpoints I_Motion Setpoints Get Provision of current setpoints (position, velocity, etc.). [} 149] Ptp [} 165] I_Ptp Get Function for active movements. A table with a section-by-section definition is used. Set Position [} 179] I_Set Position Get Set a new actual position of the axis. Stop [} 182] I_Stop Get Canceling an active motion command to bring the axis to a standstill. The dynamics parameters of the motion command are used. Teach Position I_Teach Position Get Commissioning of axes with analog position measuring systems. [} 185] Teach Update I_Teach Update Get [} 186] TF8560 Version: 1.4.0 49
## Page 50

Axes Name Type Access Description Tool Adaption I_Tool Adaption Get Conversion of positions and velocities between an axis and a tool. [} 187] Velocity Feed [} 196] I_Velocity Feed Get An interface to a local function block that triggers a motion without specifying a destination. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Axis Nc Trafo Base Dev Get Nc Drive Axis Ref() The address on the mapping interface (AXIS_REF) of the drive side between NC and PLC. I_Axis Nc Base Dev Get Nc Axis Ref() The address to the mapping interface (AXIS_REF) between NC and PLC. I_Axis Base Dev [INTERN] Only for internal use. Convert Count To Pos [INTERN] Only for internal use. Convert Pos To Count Go Error Base(n Error C This method can be used to set the axis to an error state. ode) Set Limiting(i Limiting This method connects a limiting block to the axis. ) Set Torque Limiting(i Torq This method connects a torque limiting block to the axis. ue Limiting)1 I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Axis Base Obsolete elements only I_Motion Base 50 Version: 1.4.0 TF8560
## Page 51

Axes Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 3.6.8 FB_Trafo Table Generator Represents the base class for generation algorithms of transformation cam plates. The following pre-implemented geometries are included: 1. FB_Clamp Table Generator [} 52] - Geometry of a typical clamp 2. FB_Crank Table Generator [} 56] - Geometry of a crank drive 3. FB_Scotch Yoke Table Generator [} 57] - Geometry of a Scotch yoke 4. FB_Crank Double Shaft Table Generator [} 58] - Crank drive with drive lever on both sides Syntax: FUNCTION_BLOCK ABSTRACT FB_Trafo Table Generator Properties Name Type Access Description Look Up I_Camming Look Up Get, Set Interface to the table to be written [} 91] Drive High End LREAL Get, Set Upper limit of the drive position. Drive Low End LREAL Get, Set Lower limit of the drive position. Drive Step LREAL Get Step size of the drive positions. Param Valid BOOL Get The set parameters have valid values. Points INT Get, Set Number of points to be defined. Methods Name Description Define Table() Starts the calculation of the transformation table. Reset() Resets generator calculations. Methods are abstract The methods are defined as ABSTRACT and must be implemented in inheriting classes. Interfaces Type Description I_Trafo Table Generator Standard interface on FB_Trafo Table Generator. TF8560 Version: 1.4.0 51
## Page 52

Axes Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.6.9 FB_Clamp Table Generator Implements a calculation algorithm for a standard clamp mechanism. 52 Version: 1.4.0 TF8560
## Page 53

Axes Names of the dimension designations in the sketch The dimension designations are the same as the names of the properties of the class to be configured. Syntax: FUNCTION_BLOCK FB_Clamp Table Generator EXTENDS FB_Trafo Table Generator TF8560 Version: 1.4.0 53
## Page 54

Axes Properties Name Type Access Description Look Up I_Camming Look Up Get, Set Interface to the table to be written [} 91] Asym Half I_Clamp Table Generato Get Interface to an asymmetrical half of the clamp. r_Half Notice If this property is called at least once, the class switches to asymmetrical operation mode. Base Distance LREAL Get, Set Distance between the two stationary bearing points in the center of the mechanism. Base Height LREAL Get, Set Height of the fixed center of the mechanism to the flange point of the motor. Optional if Drive Arm and Load Arm are aligned in the closed position. Drive Arm LREAL Get, Set Lever arm attached to the drive. Load Arm LREAL Get, Set Transfer arm to the tool arms. Tool Arm Angle LREAL Get, Set Internal angle between the two parts of the side tool arm. Tool Arm_1 LREAL Get, Set Lower part of the lateral tool arm. Tool Arm_2 LREAL Get, Set Upper part of the lateral tool arm. Tool Arm_3 LREAL Get, Set Horizontal tool arm. Tool Joint Height LREAL Get, Set Height of the anchor point (joint) of the tool mounted in the direction of movement. Optional if Tool Arm_3 remains almost horizontal. Tool Joint Offset LREAL Get, Set Offset of the tool clamping surface to the anchor point mounted in the direction of movement. In the recommended configuration of this parameter, the transformation results in the distance between the tool clamping surfaces. To use the distance of the tool opening, it is recommended to use the core function Tool Adaption . Drive High End LREAL Get, Set Upper limit of the drive position. Drive Low End LREAL Get, Set Lower limit of the drive position. Drive Step LREAL Get Step size of the drive positions. Param Valid BOOL Get The set parameters have valid values. Points INT Get, Set Number of points to be defined. Methods Name Description Define Table() Starts the calculation of the transformation table. Reset() Resets generator calculations. Interfaces Type Description I_Trafo Table Generator Standard interface on FB_Trafo Table Generator. I_Clamp Table Generator Standard interface on FB_Clamp Table Generator. 54 Version: 1.4.0 TF8560
## Page 55

Axes Drawing without optional parameters Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) TF8560 Version: 1.4.0 55
## Page 56

Axes 3.6.10 FB_Crank Table Generator Implements a calculation algorithm for a crank mechanism. Names of the dimension designations in the sketch The dimension designations are the same as the names of the properties of the class to be configured. Syntax: FUNCTION_BLOCK FB_Crank Table Generator EXTENDS FB_Trafo Table Generator Properties Name Type Access Description Look Up I_Camming Look Up Get, Set Interface to the table to be written [} 91] Drive Arm LREAL Get, Set Lever arm attached to the drive. Height Offset LREAL Get, Set Height offset between the guiding direction of the load and the pivot point of the drive. Load Arm LREAL Get, Set Transfer arm to the guided load side. Drive High End LREAL Get, Set Upper limit of the drive position. Drive Low End LREAL Get, Set Lower limit of the drive position. Drive Step LREAL Get Step size of the drive positions. Param Valid BOOL Get The set parameters have valid values. Points INT Get, Set Number of points to be defined. 56 Version: 1.4.0 TF8560
## Page 57

Axes Methods Name Description Define Table() Starts the calculation of the transformation table. Reset() Resets generator calculations. Interfaces Type Description I_Trafo Table Generator Standard interface on FB_Trafo Table Generator. I_Crank Table Generator Standard interface on FB_Crank Table Generator. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.6.11 FB_Scotch Yoke Table Generator Implements a calculation algorithm for a scotch yoke mechanism. Names of the dimension designations in the sketch The dimension designations are the same as the names of the properties of the class to be configured. Syntax: FUNCTION_BLOCK FB_Scotch Yoke Table Generator EXTENDS FB_Trafo Table Generator Properties Name Type Access Description Look Up I_Camming Look Up Get, Set Interface to the table to be written [} 91] Drive Arm LREAL Get, Set Radius of the eccentric rotation. Drive High End LREAL Get, Set Upper limit of the drive position. Drive Low End LREAL Get, Set Lower limit of the drive position. Drive Step LREAL Get Step size of the drive positions. TF8560 Version: 1.4.0 57
## Page 58

Axes Name Type Access Description Param Valid BOOL Get The set parameters have valid values. Points INT Get, Set Number of points to be defined. Methods Name Description Define Table() Starts the calculation of the transformation table. Reset() Resets generator calculations. Interfaces Type Description I_Trafo Table Generator Standard interface on FB_Trafo Table Generator. I_Scotch Yoke Table Generator Standard interface on FB_Scotch Yoke Table Generator. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.6.12 FB_Crank Double Shaft Table Generator Implements a calculation algorithm for a crank mechanism with drive levers on both sides. Names of the dimension designations in the sketch The dimension designations are the same as the names of the properties of the class to be configured. Syntax: FUNCTION_BLOCK FB_Crank Table Generator EXTENDS FB_Trafo Table Generator 58 Version: 1.4.0 TF8560
## Page 59

Axes Properties Name Type Access Description Look Up I_Camming Look Up Get, Set Interface to the table to be written [} 91] Asym Half I_Crank Double Shaft Ta Get Interface to an asymmetrical half of the crank ble Generator_Half drive. Notice If this property is called at least once, the class switches to asymmetrical operation mode. Drive Arm LREAL Get, Set Lever arm attached to the drive. Height Offset LREAL Get, Set Height offset between the guiding direction of the load and the pivot point of the drive. Load Arm LREAL Get, Set Transfer arm to the guided load side. Drive High End LREAL Get, Set Upper limit of the drive position. Drive Low End LREAL Get, Set Lower limit of the drive position. Drive Step LREAL Get Step size of the drive positions. Param Valid BOOL Get The set parameters have valid values. Points INT Get, Set Number of points to be defined. Methods Name Description Define Table() Starts the calculation of the transformation table. Reset() Resets generator calculations. Interfaces Type Description I_Trafo Table Generator Standard interface on FB_Trafo Table Generator. I_Crank Double Shaft Table Generat Standard interfaces on FB_Crank Double Shaft Table Generator. or Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 3.7 Linear actuators Some handling and/or processing devices require a very simple type of drive technology. From the process side, it is of secondary importance whether the drive is operated with a pneumatic/hydraulic cylinder or a miniature servomotor with spindle, for example. The requirement of the application is a constant linear movement with a base position and a working position. The Twin CAT 3 Plastic Technology Functions offer a simplified variant of the type FB_Axis Base for this purpose: FB_Motion Base. Based on this motion class, simple linear movements can be programmed for both axes and digital actuators. The digital actuators can be instantiated in a project via the FB_Actuator Base class. TF8560 Version: 1.4.0 59
## Page 60

Axes 3.7.1 I_Motion Base Represents the general interface for a motion unit. Syntax: INTERFACE I_Motion Base EXTENDS I_Message Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.7.2 I_Motion Base Dev Represents the extended interface for a motion unit. Syntax: INTERFACE I_Motion Base Dev EXTENDS I_Motion Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. 60 Version: 1.4.0 TF8560
## Page 61

Axes Name Type Access Description [INTERN] I_Core Debug Get Debugging support Core Debug [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.7.3 I_Actuator Base Represents the general interface for an actuator. Syntax: INTERFACE I_Actuator Base EXTENDS I_Motion Base TF8560 Version: 1.4.0 61
## Page 62

Axes Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Actuator Base Actuals Actuator I_Actuals Actuator Get Provision of current actual values (positions, velocities, motion times, etc.). It is an extended [} 77] version of Actuals. Tuning [} 194] I_Actuator Tuning Get Tuning function for calibrating the movement time. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Actuator Base Do Base(b Enable) Command for the movement to the base position (Jog. Do Jog M()). Do Work(b Enable) Command to move to the working position (Jog. Do Jog P()). I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 3.7.4 I_Actuator Base Dev Represents the extended interface for an actuator. Syntax: INTERFACE I_Actuator Base Dev EXTENDS I_Motion Base Dev, I_Actuator Base Properties Name Type Access Description Actuals [} 76] I_Motion Actuals Get Provision of current actual values (positions, velocities, etc.) I_Actuator Base Dev Feedback Base I_Input Base Get, Set I/O interface to an end position sensor of the base position. 62 Version: 1.4.0 TF8560
## Page 63

Axes Name Type Access Description Feedback Power I_Input Base Get, Set I/O interface to the status feedback of a power release. Feedback Work I_Input Base Get, Set I/O interface to an end position sensor of the working position. Output Base I_Output Base Get, Set I/O interface for controlling the base position. Output Power I_Output Base Get, Set I/O interface for controlling a power release. Output Work I_Output Base Get, Set I/O interface for controlling the working position. I_Motion Base Dev [INTERN] UDINT Get, Set A counter that assigns an identification to each Cmd Current activated command. [INTERN] E_Current Cmd Get, Set A counter that assigns an identification to each Cmd Current Id activated command. [INTERN] Cmd Next UDINT Get The next value to be used as Cmd Current. [INTERN] I_Core Debug Get Debugging support Core Debug [INTERN] LREAL Get In the startup phase, the axis will determine the cycle Cycle Time time of the PLC task that runs the axis function. The axis will not execute any function if it could not update this value. [INTERN] LREAL Get The internal query of the cycle time is valid Cycle Time Valid I_Actuator Base Actuals Actuator I_Actuals Actuator Get Provision of current actual values (positions, velocities, motion times, etc.). It is an extended [} 77] version of Actuals. Tuning [} 194] I_Actuator Tuning Get Tuning function for calibrating the movement time. I_Motion Base Jog [} 139] I_Jog Get Command motion without a defined destination (travel on revocation). Motion Params I_Motion Params Get Compilation of motion parameters [} 144] Name STRING Get The textual name of the motion unit. Power [} 150] I_Power Get Function for releasing the axis and its direction- related feed releases. State [} 21] E_Axi State Get The current state of the axis. I/O interfaces optional All I/O interfaces of an actuator are optional. The feedback signals can be simulated over time via Motion Params. Actuator Xyz. Feedback Delay. Methods Name Description Cyclic() This method implements all motion mechanisms that must be called cyclically. I_Motion Base Dev [INTERN] Only for internal use. Append Corefunction(i C ore Func) [INTERN] Only for internal use. Enter Critical Section() TF8560 Version: 1.4.0 63
## Page 64

Axes Name Description [INTERN] This method changes the state of the axis with high priority. Force State(e New State ) [INTERN] Only for internal use. Leave Critical Section() [INTERN] Used to determine the cycle time. Read Cycle Time() I_Actuator Base Do Base(b Enable) Command for the movement to the base position (Jog. Do Jog M()). Do Work(b Enable) Command to move to the working position (Jog. Do Jog P()). I_Motion Base Do Reset(b Execute) Triggers the reset of error states in the axis and in all local Core Functions. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 64 Version: 1.4.0 TF8560
## Page 65

Core functions 4 Core functions In plastics machines, an axis must perform a variety of elementary motion tasks, such as multi-stage PTP movements, pressure control, homing, and so on. Usually, these motion commands are independent of each other and the axis performs only one motion command at a time. Twin CAT 3 Plastic Technology Functions implements and encapsulates each of these motion tasks in a separate FB called a Corefunction. The Corefunctions were defined in a standardized format. The base axis defined in Twin CAT 3 Plastic Technology Functions provides the common Corefunctions. By deriving a specific axis, the user can also replace or supplement the function of a Corefunction without influencing the behavior of other Corefunctions. This makes the Twin CAT 3 Plastic Technology Functions flexible and easy to customize. 4.1 Embedding core functions in an axis A core function cannot operate independently because it contains only the code implementation of the motion task, but is not connected to the Motion Control library. When an axis is initialized, the core function receives the interface of the axis, while the axis contains an interface of the core function. At the same time, the core function receives interfaces to Motion Control library functions. The axis creates a concatenated list to call its core functions. This list is used during the operation of the axis for the following tasks: • Signaling an Online Change • Passing on information about the cycle time • Cyclic calling of methods • Command for resetting errors The core functions have access to the information of the axis. In addition, it is possible to call the interfaces of other core functions of the axis if this is necessary for the coordinated execution of tasks. 4.2 The basics of core functions (FB_Core Function) All Corefunctions have a number of common features that are implemented in a ABSTRACT FB_Corefunction. A number of Corefunctions are derived from FB_Corefunction Feedback [} 67] and provide further properties and methods. Through the inheritance of FB_Corefunction, each Corefunction receives the properties and methods described here. Core functions are instantiated within motion objects as local elements. At startup, the core function receives an interface to its host axis and, if necessary, to a drive-related adaptation. Syntax: FUNCTION_BLOCK ABSTRACT FB_Corefunction EXTENDS FB_Message Base Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. TF8560 Version: 1.4.0 65
## Page 66

Core functions Name Type Access Description Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. [INTERN] Axis State E_Axis State [} 21] Get, Set The current state of the axis state machine. [INTERN] BOOL Get The Corefunction is connected to an axis. Connected [INTERN] LREAL Get, Set The cycle time of the PLC task from which the Cycle Time method Cyclic() of the Corefunction is executed. [INTERN] BOOL Get, Set A TRUE indicates that the Cycle Time of the Cycle Time Valid Corefunction is defined. [INTERN] Next Core I_Corefunction Get, Set This property is part of the execution chain and must not be affected by the application task. [INTERN] BOOL Get, Set The axis uses this property to signal an Online Online Change Mark Change to the Corefunction. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Corefunction [INTERN] Apply Command() Applies the command to the axis. [INTERN] Clear States() Clears up some of the possible states. [INTERN] This method is called when the axis is reset. Do Reset(b Execute) [INTERN] Removes the command from the axis. Remove Command() Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.2.1 Permanently active core functions A Corefunction from this group does not accept any commands and remains active as soon as a connection with the axis is established, i.e. the Corefunction remains in the Ready State. The state transitions and conditions of the constantly active Corefunctions are shown in the figure below. 66 Version: 1.4.0 TF8560
## Page 67

Core functions The following Corefunctions are of this type: Permanently active Core- Description functions Actuals [} 76] Contains the state of the axis. Actuals Actuator [} 77] Is derived from Actuals and interprets position and velocity as Boolean. Actuals Hydraulics [} 79] Derived from Actuals and extends it to include hydraulic-specific elements. Actuals Nc [} 80] Is derived from Actuals and extends it with NC-specific elements. Motion Params [} 144] Provides access to a range of axis parameters. Motion Setpoints [} 149] Contains the current setpoints of the axis. Ptp Look Up [} 175] Contains the multi-segment PTP move command. Tool Adaption [} 187] Contains the parameters of a tool adaptation. State machine 4.3 Commanded core functions (FB_Corefunction Feedback) These Corefunctions are activated by a command. The functions of this group are derived from a ABSTRACT FB_Corefunction Feedback. As a result, all Corefunctions of this group have additional properties compared to the variants derived from FB_Corefunction. Non-functional situation A situation that does not allow the use of the core function. This may be caused by a failed or missing initialization or any other problem that causes damage to the axis or its sub-components. In this case the axis is permanently in Init State. TF8560 Version: 1.4.0 67
## Page 68

Core functions Idling situation In this situation, the axis has no active, failed or completed command pending. As a rule, there are some requirements that must be considered when activating the core function. If it can be activated, it reports Idle State, otherwise Ready State. Refer to the core function documentation for details. No command The core functions of the always active group do not support a command (and do not need one). Consequently, they will not report Idle State at any time. Active situation While the core function is actively performing its task, it reports Busy State. This situation ends when a fault is detected in the controlled component or device, or when another function has taken over control. For edge-triggered core functions and some statically controlled core functions, this situation ends when the task is successfully completed. In these cases, the core function is changed to the final situation. Performed task is aborted Statically controlled core functions leave this situation by terminating the executed task and falling back into idle mode as soon as the command of the core function is cleared. Final situation In this situation, the signals are determined by the result of the previous active situation. A Done State reports a successfully completed task. A Failed State or Aborted State indicates a failed result or an abort by another function. Check the command input In the next cycle, after the result of the above active situation has been signaled, the core function starts checking the command input. If the input is FALSE, the core function falls back to idle. Syntax: FUNCTION_BLOCK ABSTRACT FB_Corefunction Feedback EXTENDS FB_Corefunction Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. 68 Version: 1.4.0 TF8560
## Page 69

Core functions Name Type Access Description Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. [INTERN] Axis State E_Axis State [} 21] Get, Set The current state of the axis state machine. [INTERN] BOOL Get The Corefunction is connected to an axis. Connected [INTERN] LREAL Get, Set The cycle time of the PLC task from which the Cycle Time method Cyclic() of the Corefunction is executed. [INTERN] BOOL Get, Set A TRUE indicates that the Cycle Time of the Cycle Time Valid Corefunction is defined. [INTERN] Next Core I_Corefunction Get, Set This property is part of the execution chain and must not be affected by the application task. [INTERN] BOOL Get, Set The axis uses this property to signal an Online Online Change Mark Change to the Corefunction. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Corefunction [INTERN] Apply Command() Applies the command to the axis. [INTERN] Clear States() Clears up some of the possible states. [INTERN] This method is called when the axis is reset. Do Reset(b Execute) [INTERN] Removes the command from the axis. Remove Command() Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.3.1 Edge-triggered core functions The command accepted by these core functions is usually called b Execute (with the exception of Power, which is described below). The rising edge of b Execute triggers a series of checks to determine whether the execution conditions are met. If the execution conditions are not met, the command is rejected and the core function is set to Failed State (case 1 in the figure below). If the execution conditions are met, the command is accepted and the core function enters Busy State. The falling edge of b Execute does not directly trigger a response TF8560 Version: 1.4.0 69
## Page 70

Core functions in Busy State (case b below). If the command was executed successfully, the core function enters the Done State (case 2 below), otherwise it enters the Failed State (case 3 below). At this time it is checked if b Excute is still TRUE and the state of the core function is changed in the next PLC cycle. The state transition is shown in the figure below. The following functions are edge-triggered core functions: Corefunction Description Disable Soft End Is used to temporarily disable and re-enable the soft limit switches of the axis. [} 104] Homing [} 111] Provides a range of homing methods. Power [} 150] Used to activate and deactivate the axis. Ptp [} 165] Is used to perform multi-segment PTP movements. Reset [} 178] Is used to reset the error state of axis and devices. Set Position [} 179] Is used to change the actual position of the axis. Estop [} 109] Command for emergency shutdown using the maximum dynamic parameters to stop the axis. Stop [} 182] Command for stop with the standard dynamic parameters for stopping the axis. Teach Position Used for referencing analog encoder systems. [} 185] Teach Update Used for referencing analog encoder systems. Is used after Teach Position [} 185] to [} 186] calculate the measured values. Tuning [} 194] A special core function for actuators. It is used for automatic optimization such as motion time measurement. 70 Version: 1.4.0 TF8560
## Page 71

Core functions Timing Digram TF8560 Version: 1.4.0 71
## Page 72

Core functions State machine Exceptional case: Power Power has a deviant behavior Although power is an edge-triggered core function, the command for Power is called b Enable. Power has a different state machine than other edge-triggered core functions: with Done State it returns to Busy State when the b Enable signal changes. 72 Version: 1.4.0 TF8560
## Page 73

Core functions 4.3.2 Statically controlled core functions The command that is accepted by these core functions is usually called b Enable. The rising edge of b Enable triggers a series of checks to determine whether the execution conditions are met. If the execution conditions are not met, the command is rejected and the core function enters the Failed State (case 1 in the figure below). If the execution conditions are met, the command is accepted and the core function enters Busy State. The falling edge of b Enable triggers a response to terminate execution (case 2 below). If an error occurs during the execution of the command, the core function enters the Failed State (case 3 below). At this time it is checked if b Enable is still TRUE and the state of the core function is changed in the next PLC cycle. The following core functions are statically controlled: TF8560 Version: 1.4.0 73
## Page 74

Core functions Corefunction Description Camming [} 86] Is used to activate setpoint generation that is controlled by a guide value. External Generating Is used internally for setpoint generation by Twin CAT 3 Plastic Technology Functions. [} 107] Jog [} 139] Is used to command a movement without a specified target. Pressure Control Reserved for future extension. [} 153] Velocity Feed [} 196] Is used to activate a movement without a specified target and a velocity that is controlled by a guide value. Auto Ident [} 81] A special core function for hydraulic axes. It is used to identify the characteristic velocity behavior of the axis. Direct Output [} 101] A special core function for hydraulic axes. It is used to send output signals directly to the control device. Transformation A special core function for transforming axes. It is used for coupling the two internal axes of a transforming axis. [} 188] 74 Version: 1.4.0 TF8560
## Page 75

Core functions Timing Diagram TF8560 Version: 1.4.0 75
## Page 76

Core functions State machine 4.4 Actuals This core function is not instantiated directly. It is used as a common part of type-specific core functions like Actuals Hydraulics, Actuals Nc or Actuals Actuator. 76 Version: 1.4.0 TF8560
## Page 77

Core functions All derivatives of Actuals are members of the group of permanently active core functions. Syntax: FUNCTION_BLOCK FB_Motion Actuals EXTENDS FB_Corefunction Properties Name Type Access Description Acceleration LREAL Get The current actual acceleration. Dynamics Exceeded BOOL Get, Set TRUE if the dynamic limits of the axis were exceeded during a currently active camming. This signal is only deleted when camming is stopped. Jerk LREAL Get The current actual jerk. Position LREAL Get The current actual position. Process Value LREAL Get, Set The current actual process value. Raw Axis Position LREAL Get The unconverted current actual position. Set Event BOOL Get, Set Reserved. Velocity LREAL Get The current actual velocity. Interfaces Type Description I_Motion Actuals Standard interface on FB_Motion Actuals. Example: IF i Axis Base. Actuals. Position >= f Target Position THEN b In Pos := TRUE; END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.5 Actuals Actuator Exclusive function for actuators This core function is only available for actuators. This core function is used to display a compilation of actual values of an actuator. It is an extension of Actuals and extends the range of its parent element by adding specific interpretations for actuators. Like all derivatives of Actuals, this core function belongs to the group of permanently active core functions. TF8560 Version: 1.4.0 77
## Page 78

Core functions Syntax: FUNCTION_BLOCK FB_Actuator Actuals EXTENDS FB_Motion Actuals Properties Name Type Access Description Acceleration LREAL Get The current actual acceleration. Is Base BOOL Get Base position reached. Is Work BOOL Get Working position reached. Move Time Base LREAL Get Current/last movement time to the base position. Move Time Work LREAL Get Current/last movement time to the working position. To Base BOOL Get Movement to the base position. To Work BOOL Get Movement to the working position. Dynamics Exceeded BOOL Get, Set TRUE if the dynamic limits of the axis were exceeded during a currently active camming. This signal is only deleted when camming is stopped. Jerk LREAL Get The current actual jerk. Position LREAL Get The current actual position. Process Value LREAL Get, Set The current actual process value. Raw Axis Position LREAL Get The unconverted current actual position. Set Event BOOL Get, Set Reserved. Velocity LREAL Get The current actual velocity. Alias of position and velocity The derivative for actuators defines the following positions and velocities • Position: 0 = Is Base, 1 = Intermediate position, 2 = Is Work • Velocity: -1 = To Base, 0 = Standstill, 1 = To Work Interfaces Type Description I_Motion Actuals Standard interface on FB_Motion Actuals. I_Actuator Actuals Standard interface on FB_Actuator Actuals. Example: // Get specific interface I_Actuator Base from general interface I_Motion Base IF __QUERYINTERFACE(i Motion Base, i Actuator Base) THEN b In Base Pos := i Actuator Base. Actuals Actuator. Is Base ELSE // interface is not set to an instance of FB_Actuator Base b Incompatible := TRUE END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 78 Version: 1.4.0 TF8560
## Page 79

Core functions 4.6 Actuals Hydraulics Exclusive function for hydraulic axes This core function is only available for hydraulic axis types. This core function is used to display a compilation of actual values of the axis. It is an extension of Actuals and extends the range of its parent element by adding specific values for hydraulic axes. Like all derivatives of Actuals, this Corefunction belongs to the group of permanently active Corefunction. Syntax: FUNCTION_BLOCK FB_Hydraulic Actuals EXTENDS FB_Motion Actuals Properties Name Type Access Description Acceleration LREAL Get The current actual acceleration. Oil Pressure A LREAL Get The current actual pressure on the A-side of the cylinder. Oil Pressure B LREAL Get The current actual pressure on the B-side of the cylinder. Valve Feedback LREAL Get The current feedback value (slider actual position) of the valve. Valve Output LREAL Get The current output value (slider set position) for the valve. Dynamics Exceeded BOOL Get, Set TRUE if the dynamic limits of the axis were exceeded during a currently active camming. This signal is only deleted when camming is stopped. Jerk LREAL Get The current actual jerk. Position LREAL Get The current actual position. Process Value LREAL Get, Set The current actual process value. Raw Axis Position LREAL Get The unconverted current actual position. Set Event BOOL Get, Set Reserved. Velocity LREAL Get The current actual velocity. The terms A and B The terms A and B are used in the definition of the hydraulics library, i.e. the side of the cylinder that makes the axis move in positive direction is regarded as the A side. Sometimes no feedback Not all types of proportional valves support this kind of feedback. TF8560 Version: 1.4.0 79
## Page 80

Core functions Interfaces Type Description I_Motion Actuals Standard interface on FB_Motion Actuals. I_Hydraulic Actuals Standard interface on FB_Hydraulic Actuals. Example: // Get specific interface I_Axis Hydraulic Base from general interface I_Axis Base IF __QUERYINTERFACE(i Axis Base, i Axis Hydraulic) THEN b Clamping Force Reached := i Axis Hydraulic. Actuals Hydraulic. Oil Pressure A > f Clamping Pressure; ELSE // interface is not set to an instance of FB_Axis Hydraulic Base b Incompatible := TRUE END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 4.7 Actuals Nc Exclusive function for NC axes This core function is only available for NC axis types. This core function is used to display a compilation of actual values of the axis. It is an extension of Actuals and extends the range of its parent element by adding specific values for NC axes. Like all derivatives of Actuals, this core function belongs to the group of permanently active core functions. Syntax: FUNCTION_BLOCK FB_Nc Actuals EXTENDS FB_Motion Actuals Properties Name Type Access Description Acceleration LREAL Get The current actual acceleration. Torque LREAL Get The current torque actual value. Torque Limit Exceed BOOL Get TRUE if the torque limit has been reached. ed Dynamics Exceeded BOOL Get, Set TRUE if the dynamic limits of the axis were exceeded during a currently active camming. This signal is only deleted when camming is stopped. 80 Version: 1.4.0 TF8560
## Page 81

Core functions Name Type Access Description Jerk LREAL Get The current actual jerk. Position LREAL Get The current actual position. Process Value LREAL Get, Set The current actual process value. Raw Axis Position LREAL Get The unconverted current actual position. Set Event BOOL Get, Set Reserved. Velocity LREAL Get The current actual velocity. Clear this property Torque Limit Exceeded is set by the library, but not cleared. The application must be sure to clear this property at the start of a function that has to be monitored. Interfaces Type Description I_Motion Actuals Standard interface on FB_Motion Actuals. I_Nc Actuals Standard interface on FB_Nc Actuals. Example: // Get specific interface I_Axis Nc Base from general interface I_Axis Base IF __QUERYINTERFACE(i Axis Base, i Axis Nc) THEN b Clamping Force Reached := i Axis Nc. Actuals Nc. Torque > f Clamping Torque; ELSE // interface is not set to an instance of FB_Axis Nc Base b Incompatible := TRUE END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 4.8 Auto Ident Exclusive function for hydraulic axes This core function is only available for hydraulic axis types. This core function is used to analyze the non-linear transfer characteristic of hydraulic axes. It belongs to the group of statically controlled Corefunctions. Syntax: FUNCTION_BLOCK FB_Auto Ident EXTENDS FB_Corefunction Feedback TF8560 Version: 1.4.0 81
## Page 82

Core functions Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Auto Ident Do Auto Ident() [} 83] Activates and terminates the measurement procedure. Set Parameter() [} 84] Sets the parameters for the measurement procedure. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Auto Ident Standard interface on FB_Auto Ident I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // This sample requires the Autoident parameters set by the Plc Mc Manager in 'Lin Def' // Get specific interface I_Axis Hydraulic Base from general interface I_Axis Base IF __QUERYINTERFACE(i Axis Base, i Axis Hydraulic) THEN // abort or done IF b Abort OR i Axis Hydraulic. Auto Ident. Done State THEN 82 Version: 1.4.0 TF8560
## Page 83

Core functions b Auto Ident := FALSE; i Axis Hydraulic. Auto Ident. Do Auto Ident(FALSE); // start the command ELSIF b Auto Ident THEN hresult := i Axis Hydraulic. Auto Ident. Do Auto Ident(TRUE); END_IF ELSE // interface is not set to an instance of FB_Axis Hydraulic Base b Incompatible := TRUE; END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 4.8.1 Do Auto Ident() This method is used to activate the core function. Syntax: METHOD Do Auto Ident : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Auto Ident HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge starts the identification. A falling edge cancels a still active identification with an invalid table. TF8560 Version: 1.4.0 83
## Page 84

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 4.8.2 Set Parameter() This method can be used to set the parameters for identification. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT Enable Arrea Ratio : BOOL; Enable End Of Travel : BOOL; Enable Overlapp : BOOL; Enable Valve Characteristic : BOOL; Enable Zero Adjust : BOOL; End Of Travel Negativ : LREAL; End Of Travel Positiv : LREAL; End Of Travel Negativ Limit : LREAL; End Of Travel Positiv Limit : LREAL; End Of Velocity Negativ Limit : LREAL; End Of Velocity Positiv Limit : LREAL; Deceleration Factor : LREAL; Valve Characteristic Low End : LREAL; Valve Characteristic High End : LREAL; Valve Characteristic Ramp : LREAL; Valve Characteristic Settling: LREAL; Valve Characteristic Recovery: LREAL; Valve Characteristic Min Cycle: LREAL; Valve Characteristic Tbl Count: INT; Valve Characteristic Type : INT; Valve Lin Limit M : LREAL; Valve Lin Limit P : LREAL; END_VAR Return value Name Type Description Set Parameter HRESULT See below 84 Version: 1.4.0 TF8560
## Page 85

Core functions The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Designation Type Description Enable Arrea Ratio BOOL A TRUE will request a separate identification of effects caused by cylinder asymmetry. Enable End Of Travel BOOL A TRUE will request a separate identification of mechanical limits of traveling. Enable Overlapp BOOL A TRUE will request a separate identification of effects caused by valve overlap. Enable Valve Characteristic BOOL A TRUE will request the identification of the valves transfer characteristic. Enable Zero Adjust BOOL A TRUE will request a separate identification of effects caused by valve offset. End Of Travel Negativ LREAL A mechanical travel limit. This value may be found by identification or entered by using an HMI. End Of Travel Positiv LREAL A mechanical travel limit. This value may be found by identification or entered by using an HMI. End Of Travel Negativ Limit LREAL This value defines a control value limit. The identification will be concluded for that direction if the output to the control device has reached the limit. End Of Travel Positiv Limit LREAL This value defines a control value limit. The identification will be concluded for that direction if the output to the control device has reached the limit. End Of Velocity Negativ Limit LREAL This value defines an actual velocity limit. The identification will be concluded for that direction if the actual velocity exceeds the limit. End Of Velocity Positiv Limit LREAL This value defines an actual velocity limit. The identification will be concluded for that direction if the actual velocity exceeds the limit. Deceleration Factor LREAL This value defines the limits of travel that will be used for the identification. Valve Characteristic Low End LREAL This value defines the limits of travel that will be used for the identification. Valve Characteristic High End LREAL This value defines the limits of travel that will be used for the identification. Valve Characteristic Ramp LREAL This parameter defines the ramping to the output value currently under investigation. Valve Characteristic Settling LREAL This parameter defines the delay for starting the investigation after ramping to the output value. Valve Characteristic Recovery LREAL This parameter defines a recovery time before continuing the identification in the opposite direction. Valve Characteristic Min Cycle LREAL This value specifies a minimum limit for identification. Valve Characteristic Tbl Count INT This parameter defines the number of points in the linearization table. TF8560 Version: 1.4.0 85
## Page 86

Core functions Designation Type Description Notice This value must be an odd number. It must be in the range of 5 to 1001. Recommended values are 101, 201 or 401. Valve Characteristic Type INT This parameter is reserved to indicate the use of valves with special behavior details. For more details, see the hydraulics library documentation. Valve Lin Limit M LREAL This value limits the use of the linearization table. Valve Lin Limit P LREAL This value limits the use of the linearization table. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 4.9 Camming Core function is not supported by inverter axes This core function is not supported by inverter axes. Any use will report DEVICE_NOTINIT and trigger an error message. The property provides two options: Camming. Pos for position camming and Camming. Velo for velocity camming. To do this, two classes of the same type are instantiated, but with different parameterizations. All these functions belong to the group of statically controlled core functions. Both types of camming use a guiding value to identify a control value within a camming lookup table. For more information, see Camming Look Up [} 91]. Any useful information can serve as a guiding value. Common options are a time (LREAL variable that starts with zero and is cyclically updated by adding the cycle time of the PLC tasks) or the position of another axis. WARNING Unexpected responses of the controlled axis Unsuitable guiding values or table points can lead to unexpected reactions of the controlled axis. This may result in risk of accident or damage. Using a camming requires several steps: • A camming lookup table must be instantiated. There is no rule for the number of these tables. A table used once can be used again at a later time by repeating the following steps. • The table must be defined by loading the table points. Make sure that the point data corresponds to the camming type (position, velocity) for which it is to be used. • The properties of the table must be updated. 86 Version: 1.4.0 TF8560
## Page 87

Core functions • The table must be assigned to the camming with the method Set Lookupinterface(). At this time, camming must not be commanded. • An initial guiding value must be specified with the Set Guiding Value() method. • At the right time use Do Camming(TRUE) to enable the function. Make sure that the axis is in a situation (position, velocity) that matches the situation of the camming table. • Make sure that the guiding value is updated cyclically. • At the right time use Do Camming(FALSE) to disable the function. Pay attention to the situation (position, velocity) of the axis. Syntax: FUNCTION_BLOCK FB_Camming EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Camming Overrun BOOL Get TRUE if the current guiding value is not within the range of the camming lookup table. Synchronize BOOL Get, Set With Synchronize=FALSE the axis should follow every setpoint change immediately. A TRUE requires the axis to follow setpoint changes with respect to the dynamic limit parameters. Synchronized BOOL Get TRUE if Synchronize=TRUE and the setpoint changes are within the limits of the dynamic parameters of the axis. [INTERN] BOOL Get, Set This property defines the camming rule. A TRUE Use As Position causes the core function to act as a position camming. A FALSE will cause it to act as a velocity camming. This property is set during startup. The application must not change its setting. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. TF8560 Version: 1.4.0 87
## Page 88

Core functions Name Type Access Description Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Camming Do Camming() [} 89] This method is used to enable and disable the core function. Set Guiding Value() [} 90] This method is used to update the guiding value. Set Lookup Interface() This method must be used to connect a camming table. [} 91] Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Camming Standard interface on FB_Camming I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // For this example, the axis should currently be in the f Center position CASE n State OF 0: // Define camming curve f Center := 100.0; // [mm] f Amplitude := 100.0; // [mm] f Cycle Time := 0.002; // [s] // parameterise the lookup table fb Camming Lookup. Equidistance := TRUE; fb Camming Lookup. Interpolation := E_Lookup Mode.e Second Order; fb Camming Lookup. Set Points(401); fb Camming Look Up. Min Guiding Value := 0.0; fb Camming Look Up. Max Guiding Value := 15.0; // Create a sinusoidal curve over 15 seconds FOR i := 1 TO 401 DO f Cam Time := 15.0 * (i - 1) / 400.0; f Point := f Center + f Amplitude * SIN(2.0 * PI * f Cam Time / 15.0); IF FAILED(fb Camming Look Up. Set Point(i, f Point, 35.0)) THEN n State := -1; END_IF; END_FOR // check table validation IF NOT fb Camming Lookup. Valid THEN n State := -1; // assign camming table to camming function ELSIF FAILED(i Axis Base. Camming. Pos. Set Lookup Interface(fb Camming Look Up)) THEN n State := -1; // assign initial camming value ELSIF FAILED(i Axis Base. Camming. Pos. Set Guiding Value(0.0)) THEN n State := -1; END_IF IF n State >= 0 THEN n State := n State + 1; END_IF 1: // start camming IF FAILED(i Axis Base. Camming. Pos. Do Camming(TRUE)) THEN 88 Version: 1.4.0 TF8560
## Page 89

Core functions n State := -1; END_IF f Time := 0.0; IF n State > 0 THEN n State := n State + 1; END_IF 2: // operate camming f Time := MIN(f Time + f Cycle Time, 15.0); IF i Axis Base. Camming. Pos. Failed State THEN n State := -1; ELSIF FAILED(i Axis Base. Camming. Pos. Set Guiding Value(f Time)) THEN n State := -1; ELSIF f Time >= 15.0 THEN n State := n State + 1;; END_IF 3, // camming done -1: // error f Time := 0.0; i Axis Base. Camming. Pos. Do Camming(FALSE); END_CASE Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.1 Do Camming This method is used to enable and disable the core function. Syntax: METHOD Do Camming : HRESULT VAR_INPUT b Enable: BOOL; END_VAR Return value Name Type Description Do Camming HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. TF8560 Version: 1.4.0 89
## Page 90

Core functions Inputs Name Type Description b Enable BOOL A TRUE activates the camming. A FALSE ends the camming and slows down a still existing movement. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.2 Set Guiding Value This method must be used cyclically to update the guiding value. Syntax: METHOD Set Guiding Value : HRESULT VAR_INPUT f Guiding Value: LREAL; END_VAR Return value Name Type Description Set Guiding Value HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description f Guiding Value LREAL The default value valid in the next cycle. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 90 Version: 1.4.0 TF8560
## Page 91

Core functions 4.9.3 Set Lookup Interface This method must be used to connect a camming table. Syntax: METHOD Set Lookup Interface: HRESULT VAR_INPUT i Lookup: I_Camming Look Up; END_VAR Return value Name Type Description Set Lookup Interface HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description i Look Up I_Camming Look Up The camming table to use. [} 91] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4 FB_Camming Look Up This class is able to dynamically allocate memory and make it available as a table. Similarly, this function block acts as a Look Up table for the cam plate core function or the transformation table of a transformation axis. Syntax: FUNCTION_BLOCK FB_Camming Look Up EXTENDS FB_Message Base TF8560 Version: 1.4.0 91
## Page 92

Core functions Initialization parameters of the FB_init constructor Name Type Description Points INT Defines the number of points = 0 enables subsequent assignment via Set Points(…) Op Mode E_Lookup Mode Defines the operation mode of the Look Up table [} 100] = e Undefined enables subsequent assignment via Interpolation and Equdistance Properties Name Type Access Description Equidistance BOOL Get, Set1 In equidistant mode, the table assumes equal distances between the Min Guiding Value and the Max Guiding Value. Interpolation E_Lookup Mode Get, Set1 Interpolation mode of the table [} 100] Invalid Point BOOL Get Is set by a call to Look Up() or Look Down() if the requested point is outside the valid range. Min Guiding Value LREAL Get, Set Smallest possible value for the Look Up() and Look Down() function Max Guiding Value LREAL Get, Set Largest possible value for the Look Up() and Look Down() function Overrun BOOL Get Additional information on Invalid Point: TRUE -> Invalid Point is above the definition range. FALSE -> Invalid Point is below the definition range. Points LREAL Get Number of available points in the table Valid BOOL Get The configuration of the table is validated and ready for use. Op Mode 2 E_Lookup Mode Get Operation mode of the table [} 100] 1Must be set before determining the number of points 2Obsolete Methods Name Description Get Point() [} 93] Returns an equidistant point in the table. Get Point Non Equi() [} 94] Returns any point consisting of a master and a slave value. Look Down() [} 96] Translates a slave value to a matching master value. Look Up() [} 96] Translates a master value to a matching slave value. Set Point() [} 97] Sets an equidistant point in the table. Set Point Non Equidistant() [} 98] Sets any point consisting of a master and a slave value. Set Points() [} 99] Defines the number of assignable points once. Set Properties() [} 99]2 Sets the master limit values of the table Get Properties() [} 95]2 Returns the master limit values of the table Get Points() [} 93]2 Returns the number of points available in the table Get Valid()2 Checks the table for validity 92 Version: 1.4.0 TF8560
## Page 93

Core functions 2Obsolete Interfaces Type Description I_Camming Look Up Standard interface on FB_Camming Look Up Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 4.9.4.1 Get Point() This method returns a point in the table addressed by n Idx Syntax: METHOD Get Point : HRESULT VAR_INPUT n Idx: INT; f Slave: REFERENCE TO LREAL; f Torque Limiting: REFERENCE TO LREAL; END_VAR Return value Name Type Description Get Point HRESULT Return value with feedback on the success of the execution Inputs Name Type Description n Idx INT Index of the requested table point f Slave REFERENCE Slave value of the table point TO LREAL f Torque Limiting REFERENCE Torque Limiting value (secondary slave value) of the table point TO LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.2 Get Points() TF8560 Version: 1.4.0 93
## Page 94

Core functions This method returns the number of points available in the table Syntax: METHOD Get Point : HRESULT VAR_INPUT n Points: REFERENCE TO INT; END_VAR Return value Name Type Description Get Point HRESULT Return value with feedback on the success of the execution Inputs Name Type Description n Points REFERENCE Number of available points TO INT Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.3 Get Point Non Equi() This method reads a point in the table addressed by n Idx that has a specific master position. If the equidistant operation mode (Equidistant= FALSE) is active, this function returns a 0 as the master value. Syntax: METHOD Get Point Non Equi : HRESULT VAR_INPUT n Idx: INT; f Master: REFERENCE TO LREAL := 0; // optional f Slave: REFERENCE TO LREAL; f Limiting: REFERENCE TO LREAL := 0; // optional END_VAR Return value Name Type Description Get Point Non Eq HRESULT Return value with feedback on the success of the execution. ui Inputs Name Type Description n Idx INT Index of the table point to be read. f Master REFERNCE Master value of the table point. TO LREAL 94 Version: 1.4.0 TF8560
## Page 95

Core functions Name Type Description f Slave REFERNCE Slave value of the table point. TO LREAL f Limiting REFERNCE Limiting value (secondary slave value) of the table point. TO LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.4 Get Properties() This method returns the master limit values of the table. These are used to break down the master position in equidistant operation modes of the table. Syntax: METHOD Set Properties : HRESULT VAR_INPUT b Valid : REFERENCE BOOL; f Max Guiding Value : REFERENCE LREAL; f Min Guiding Value : REFERENCE LREAL; END_VAR Return value Name Type Description Get Properties HRESULT Return value with feedback on the success of the execution Inputs Name Type Description b Valid REFERENCE The table is validated TO BOOL f Max Guiding Val REFERENCE Maximum value of the master ue TO LREAL f Min Guiding Val REFERENCE Minimum value of the master ue TO LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 95
## Page 96

Core functions 4.9.4.5 Look Down() This method translates a slave value to a matching master value. If the value lies between two defined points in the table, the selected operation mode is used for interpolation. Syntax: METHOD Look Down : HRESULT VAR_INPUT Slave: LREAL; Slave Velo: LREAL; f Guiding Value: REFERENCE TO LREAL; f Guiding Velo: REFERENCE TO LREAL; Torque Limiting: REFERENCE TO LREAL; END_VAR Return value Name Type Description Look Down HRESULT Return value with feedback on the success of the execution Inputs Name Type Description Slave LREAL Primary slave value Slave Velo LREAL Tertiary slave value Notice Only available in second-order equidistant operation mode f Guiding Value REFERENCE Resulting master value for the requested slave value TO LREAL f Guiding Velo REFERENCE Master value for the requested tertiary slave value. This is determined TO LREAL taking into account the first derivative of the primary slave value Notice Only available in second-order equidistant operation mode Torque Limiting REFERENCE Secondary slave value for the requested primary slave value TO LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.6 Look Up() This method translates a master value to a matching slave value. If the value lies between two defined points in the table, the selected operation mode is used for interpolation. 96 Version: 1.4.0 TF8560
## Page 97

Core functions Syntax: METHOD Look Up : HRESULT VAR_INPUT f Guiding Value: LREAL; f Guiding Velo: LREAL; Slave: REFERENCE TO LREAL; Slave Velo: REFERENCE TO LREAL; Torque Limiting: REFERENCE TO LREAL; END_VAR Return value Name Type Description Look Down HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description f Guiding Value LREAL Master value f Guiding Velo LREAL Reserved for later use. Slave REFERENCE Resulting slave value. TO LREAL Slave Velo REFERENCE Reserved for later use. TO LREAL Torque Limiting REFERENCE Secondary slave value for the requested primary master value. TO LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.7 Set Point() This method sets a point in the table addressed via n Idx. Syntax: METHOD Set Point : HRESULT VAR_INPUT n Idx : INT; f Slave : LREAL; f Torque Limiting : LREAL; END_VAR Return value Name Type Description Set Point HRESULT Return value with feedback on the success of the execution. TF8560 Version: 1.4.0 97
## Page 98

Core functions Inputs Name Type Description n Idx INT Index of the table point to be set. f Slave LREAL Slave value of the table point. f Torque Limiting LREAL Torque Limiting value (secondary slave value) of the table point. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.8 Set Point Non Equidistant() This method sets a point in the table addressed via n Idx that has a specific master position. If the equidistant operation mode (Equidistant= FALSE) is active, the master value is ignored. Syntax: METHOD Set Point Non Equidistant : HRESULT VAR_INPUT n Idx : INT; f Master : LREAL; f Slave : LREAL; f Torque Limiting : LREAL; END_VAR Return value Name Type Description Set Point Non Eq HRESULT Return value with feedback on the success of the execution. uidistant Inputs Name Type Description n Idx INT Index of the table point to be set. f Master LREAL Master value of the table point. f Slave LREAL Slave value of the table point. f Torque Limiting LREAL Torque Limiting value (secondary slave value) of the table point. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 98 Version: 1.4.0 TF8560
## Page 99

Core functions 4.9.4.9 Set Points() This method sets the number of available points in the table. Method can only be executed once If this method is executed for the second time or a number of points > 0 is passed in the initialization, this method fails. The number of points can only be defined once. Syntax: METHOD Set Points : HRESULT VAR_INPUT n Required: INT; END_VAR Return value Name Type Description Get Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description n Required INT Number of points requested. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.4.10 Set Properties() This method sets the master limit values of the table. These are used to break down the master position in equidistant operation modes of the table. Syntax: METHOD Set Properties : HRESULT VAR_INPUT b Valid : BOOL; f Max Guiding Value : LREAL; f Min Guiding Value : LREAL; END_VAR Return value Name Type Description Set Properties HRESULT Return value with feedback on the success of the execution. TF8560 Version: 1.4.0 99
## Page 100

Core functions Inputs Name Type Description b Valid BOOL Defines the valid initialization of the table. f Max Guiding Val LREAL Maximum value of the master. ue f Min Guiding Val LREAL Minimum value of the master. ue Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.9.5 E_Lookup Mode Operation mode of the FB_Camming Look Up class. Syntax: {attribute 'qualified_only'} {attribute 'strict'} TYPE E_Lookup Mode : ( // bad configuration e Undefined := 0, // obsolete ones (hidden) e None Equi := 1, e None Equi Lin Ipol, e Equi Lin Ipol, e Equi Second Order, // interpolation modes e Step := 16#10, e Linear := 16#20, e Second Order := 16#30, // equidistant modes are not actively shown (hidden), because they're determined by the MSB = TRUE/FALSE e Step_Equi := 16#8010, // not implemented yet e Linear_Equi := 16#8020, e Second Order_Equi := 16#8030 ); END_TYPE Values Name Number Interpolation e Step 0x0010 No interpolation, sectional definition e Linear 0x0020 Linear e Second Order 0x0030 Second order (parabola) Hidden [ INTERNAL ] e Step_Equi 0x8010 Reserved - not implemented yet e Linear_Equi 0x8020 Linear (equidistant) e Second Order_Equi 0x8020 Second order (equidistant) Obsolete Name Number Equidistant Interpolation e None Equi 1 No / 100 Version: 1.4.0 TF8560
## Page 101

Core functions Name Number Equidistant Interpolation e None Equi Li 2 Linear n Ipol e Equi Lin Ipol 3 Yes Linear e Equi Second 4 Second order (parabola) Order Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 4.10 Direct Output Exclusive function for hydraulic axes This core function is only available for hydraulic axis types. This core function is used to directly control the output of a hydraulic axis. There will be no monitoring of position limits. This core function is a member of the group of statically-controlled core functions. Syntax: FUNCTION_BLOCK FB_Direct Output EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Direct Output Output Reference LREAL Get, Set This property defines the value that must be specified as Out Put Value to cause a full-scale output to the controlled device. Output Value LREAL Get, Set This property is used to define the output to the device. Output Reference as a scaling here. Ramptime LREAL Get, Set Ramp Time is used to define the time for ramping from zero to the full-scale value. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction TF8560 Version: 1.4.0 101
## Page 102

Core functions Name Type Access Description Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. The output value is influenced by Ramp Time Any change in the output whose amount is less than the full-scale value requires a proportional part of Ramp Time. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Direct Output Do Activate() [} 103] This method enables and disables the direct output. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Direct Output Standard interface on FB_Direct Output. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // Get specific interface I_Axis Hydraulic Base from general interface I_Axis Base IF __QUERYINTERFACE(i Axis Base, i Axis Hydraulic) THEN IF b Direct Output THEN // in this example, the reference is the electrical unit used i Axis Hydraulic. Direct Output. Output Reference := 10.0; // [V] i Axis Hydraulic. Direct Output. Ramptime := 1.0; // [s] i Axis Hydraulic. Direct Output. Do Activate(TRUE); // the set value will switch after 2 seconds fb Ton. Pt := T#2S; IF fb Ton. Q THEN i Axis Hydraulic. Direct Output. Output Value := 3.0; // [V] ELSE i Axis Hydraulic. Direct Output. Output Value := 1.0; // [V] END_IF ELSIF i Axis Hydraulic. Direct Output. Is Commanded THEN i Axis Hydraulic. Direct Output. Do Activate(FALSE); END_IF fb Ton. In := b Direct Output; 102 Version: 1.4.0 TF8560
## Page 103

Core functions fb Ton(); ELSE // interface is not set to an instance of FB_Axis Hydraulic Base b Incompatible := TRUE; END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 4.10.1 Do Activate This method enables and disables the direct output. Syntax: METHOD Do Activate : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Activate HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A TRUE enables the output. A FALSE ramps the output to zero and disables the core function. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher TF8560 Version: 1.4.0 103
## Page 104

Core functions 4.11 Disable Soft End Core function is not supported by inverter axes This core function is not supported by inverter axes. Any use will report DEVICE_NOTINIT and trigger an error message. This core function is used to temporarily disable and re-enable the software position limits of the axis. • Disable Soft End is a member of the group of edge-triggered core functions. Syntax: FUNCTION_BLOCK FB_Disable Soft End EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Disable Soft End Disabled BOOL Get A TRUE signal reports active disabling. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. 104 Version: 1.4.0 TF8560
## Page 105

Core functions Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Disable Soft End Do Disable() [} 105] This method disables the set software position limits. Re Enable() [} 106] This method re-enables the set software position limits. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Disable Soft End Standard interface on FB_Disable Soft End I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // disable on entering setup mode IF b Enter Setup Mode THEN IF NOT i Axis Base. Disable Soft End. Disabled THEN i Axis Base. Disable Soft End. Do Disable(TRUE); ELSIF i Axis Base. Disable Soft End. Is Commanded THEN i Axis Base. Disable Soft End. Do Disable(FALSE); END_IF // reenable on leaving setup mode ELSIF b Leave Setup Mode THEN IF NOT i Axis Base. Disable Soft End. Disabled THEN i Axis Base. Disable Soft End. Re Enable(TRUE); ELSIF i Axis Base. Disable Soft End. Is Commanded THEN i Axis Base. Disable Soft End. Re Enable(FALSE); END_IF END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.11.1 Do Disable This method disables the set software position limits. Syntax: METHOD Do Disable: HRESULT VAR_INPUT b Execute: BOOL; END_VAR TF8560 Version: 1.4.0 105
## Page 106

Core functions Return value Name Type Description Do Disable HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers the disabling. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.11.2 Re Enable This method re-enables the set software position limits. Syntax: METHOD Re Enable: HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Re Enable HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. 106 Version: 1.4.0 TF8560
## Page 107

Core functions E_Ads Err Return value Cause NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers the re-enabling. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.12 External Generating Not available via the axis interfaces This core function is not available via the axis interfaces. Direct access by the application is not required. This core function is used for setpoint generation generated in Twin CAT 3 Plastic Technlogy Functions. It belongs to the group of statically controlled core functions. Syntax: FUNCTION_BLOCK FB_External Generating EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_External Generating Position LREAL Get, Set Transfer of the set position. Limiting LREAL Get, Set Transfer of the active limitation value Velocity LREAL Get, Set Transfer of the target velocity. Torque Limiting1 LREAL Get, Set Transfer of the applied torque limit. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. TF8560 Version: 1.4.0 107
## Page 108

Core functions Name Type Access Description Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_External Generating Do Enable() [} 108] Enables/disables external setpoint generation. FB_Corefunction [INTERN] Apply Command() Applies the command to the axis. [INTERN] Clear States() Clears up some of the possible states. [INTERN] This method is called when the axis is reset. Do Reset(b Execute) [INTERN] Removes the command from the axis. Remove Command() Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_External Generating Standard interface on FB_External Generating. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 4.12.1 Do Enable() This method enables the external setpoint generation. Syntax: METHOD Do Enable : HRESULT VAR_INPUT b Enable : BOOL; END_VAR 108 Version: 1.4.0 TF8560
## Page 109

Core functions Return value Name Type Description Do Enable HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Enable BOOL A rising edge triggers the external setpoint generation. A falling edge stops the external setpoint generation with a final stop ramp. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.13 Estop This Corefunction is used to trigger an emergency stop operation. It will use the maximum dynamic parameters that are allowed for this axis by the underlying motion technology. Syntax: FUNCTION_BLOCK FB_Estop EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Estop No Creeping BOOL Get, Set A TRUE in this property avoids the creep phase at the end of the stopping process of a hydraulic axis. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. TF8560 Version: 1.4.0 109
## Page 110

Core functions Name Type Access Description Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Estop Do Estop() [} 111] A rising edge triggers the stop. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Estop Standard interface on FB_Estop. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // Execute estop on pressing the emergency stop button IF b Emergency Stop Pressed THEN i Axis Base. Estop. Do Estop(TRUE); // revert command ELSIF i Axis Base. Estop. Is Commanded THEN i Axis Base. Estop. Do Estop(FALSE); END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 110 Version: 1.4.0 TF8560
## Page 111

Core functions 4.13.1 Do Estop This method is used to trigger the stop. Syntax: METHOD Do Estop : HRESULT VAR_INPUT b Execute: BOOL; END_VAR Return value Name Type Description Do Estop HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge at this input triggers the stop. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14 Homing Core function is not supported by inverter axes This core function is not supported by inverter axes. Any use will report DEVICE_NOTINIT and trigger an error message. The property offers access to a range of homing functions. TF8560 Version: 1.4.0 111
## Page 112

Core functions All these functions belong to the group of edge-triggered core functions. There are two groups of homing functions: Initiating or continuing functions (Absolute Switch, Absolute Switch Detect, Block, Block Detect, Limit Switch, Limit Switch Detect) and terminating functions (Abort, Finish). Triggering a function of the first group changes the behavior of the axis by activating the homing mode. If this change has already been made by another function in this group, this has no effect. In this mode, the underlying motion technology disables a number of mechanisms such as lag monitoring, velocity pre-control, software position limit switch, etc. NOTICE Unexpected behavior Axes in homing mode may respond to motion commands in an unexpected manner. As the last step of a homing procedure, the functions of the second group are used to terminate the homing mode and set the axis to a normal behavior. Syntax: FUNCTION_BLOCK FB_Homing Main Properties Name Type Access Description Abort [} 114] I_Homing Abort Get An active homing is aborted without success. Absolute Switch I_Homing Absolute S Get Homing is performed at a position reported by a witch binary sensor. [} 116] Absolute Switch Dete I_Homing Absolute S Get The actual position is recorded at a position reported witch Detection by a binary sensor. ct [} 119] Block [} 123] I_Homing Block Get Homing is performed on a mechanical stop. Block Detect [} 126] I_Homing Block Dete Get The actual position is recorded at a mechanical stop. ction Finish [} 130] I_Homing Finish Get An active homing is completed successfully. Limit Switch [} 132] I_Homing Limit Switc Get Homing is performed at a position reported by a h hardware limit switch. Limit Switch Detect I_Homing Limit Switc Get The actual position is recorded at a position reported h Detection by a hardware limit switch. [} 136] Interfaces Type Description I_Homing Main Standard interface on FB_Homing Main. Example: CASE n State OF 0: // parameterise homing functions // homing block i Axis Base. Homing. Block. Set Parameter General( e Direction := E_Adaptable Homing Direction.e Negative, f Velocity := 20.0, f Acceleration := 0.0, f Deceleration := 0.0, f Jerk := 0.0, t Time Limit := T#60S, f Distance Limit := 800.0, f Torque Limit := 0.0 ); i Axis Base. Homing. Block. Set Parameter( 112 Version: 1.4.0 TF8560
## Page 113

Core functions f Set Position:=0.0, f Detection Velocity Limit:=5.0, t Detection Velocity Time:=T#0.5S, f Torque Tolerance:=0.0, b Options Disable Drive Access := TRUE, b Options Instant Lag Reduction := TRUE, b Options Torque Polarity Inverted := FALSE ); // homing block detect i Axis Base. Homing. Block Detect. Set Parameter General( e Direction:=E_Adaptable Homing Direction.e Positive, f Velocity:=50.0, f Acceleration:=0.0, f Deceleration:=0.0, f Jerk:=0.0, t Time Limit:=T#60S, f Distance Limit:=800.0, f Torque Limit:=0.0 ); i Axis Base. Homing. Block Detect. Set Parameter( f Detection Velocity Limit:=5.0, t Detection Velocity Time:=T#0.25S, f Torque Tolerance:=0.0, b Options Disable Drive Access := FALSE, b Options Instant Lag Reduction := TRUE, b Options Torque Polarity Inverted := FALSE ); // homing finish i Axis Base. Homing. Finish. Set Parameter( f Distance:=-20.0, f Velocity:=50.0, f Acceleration:=0.0, f Deceleration:=0.0, f Jerk:=0.0, b Options Disable Drive Access := FALSE ); // start with homing on block IF FAILED(i Axis Base. Homing. Block. Do Homing(TRUE)) THEN n State := -1; ELSE n State := n State + 1; END_IF 1: // after block, start block detect IF i Axis Base. Homing. Block. Failed State THEN n State := -1; ELSIF i Axis Base. Homing. Block. Done State THEN i Axis Base. Homing. Block. Do Homing(FALSE); IF FAILED(i Axis Base. Homing. Block Detect. Do Homing(TRUE)) THEN n State := -1; ELSE n State := n State + 1; END_IF END_IF 2: // after blcok detect, finish IF i Axis Base. Homing. Block Detect. Failed State THEN n State := -1; ELSIF i Axis Base. Homing. Block Detect. Done State THEN i Axis Base. Homing. Block Detect. Do Homing(FALSE); IF FAILED(i Axis Base. Homing. Finish. Do Finish(TRUE)) THEN n State := -1; ELSE n State := n State + 1; END_IF END_IF 3: // waiting for finish IF i Axis Base. Homing. Finish. Failed State THEN n State := -1; TF8560 Version: 1.4.0 113
## Page 114

Core functions ELSIF i Axis Base. Homing. Finish. Done State THEN i Axis Base. Homing. Finish. Do Finish(FALSE); n State := n State + 1; END_IF 4, // done -1: // error i Axis Base. Homing. Block. Do Homing(FALSE); i Axis Base. Homing. Block Detect. Do Homing(FALSE); i Axis Base. Homing. Finish. Do Finish(FALSE); END_CASE Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.1 Abort This core function can be used to abort a homing in case of a problem. Abort required Abort is also required if a homing function fails. Methods Name Description Do Abort() [} 114] A rising edge triggers the abort. Set Parameter() [} 115] The procedure for returning to normal operation can be specified. Interfaces Type Description I_Homing Abort Standard interface on FB_Homing Abort. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.1.1 Do Abort() 114 Version: 1.4.0 TF8560
## Page 115

Core functions This method triggers the abort in case of a rising edge. Syntax: METHOD Do Abort : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Abort HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers the abort. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.1.2 Set Parameter() The procedure for returning to normal operation can be specified. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT b Options Disable Drive Access : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. TF8560 Version: 1.4.0 115
## Page 116

Core functions Inputs Name Type Description b Options Disable Drive Access BOOL A TRUE prevents ADS communication via the fieldbus from being used to change parameters of the controlled device in order to return to normal operation. Non-Beckhoff servo drives This option must be used for most non-Beckhoff servo drives. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.2 Absolute Switch This core function performs homing by searching for a fixed edge of a signal. A specified position is set at this location. Properties Name Type Access Description Absolute Switch BOOL Get, Set This signal indicates the homing position. Negative Limit Switch BOOL Get, Set The hardware limit switch at the lower end of the available travel path. Positive Limit Switch BOOL Get, Set The hardware limit switch at the upper end of the available travel path. The action of the limit switches is defined by PLCopen standards. Methods Name Description Do Homing() [} 117] This method triggers the homing. Set Parameter() [} 117] A set of parameters specific to this homing procedure is set. Set Parameter General() A set of travel parameters for the homing procedure is set. [} 118] Interfaces Type Description I_Homing Absolute Switch Standard interface on FB_Homing Absolute Switch. 116 Version: 1.4.0 TF8560
## Page 117

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.2.1 Do Homing() This method triggers the homing. Syntax: METHOD Do Homing : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Homing HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers homing. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.2.2 Set Parameter() A set of parameters specific to this homing procedure is set. TF8560 Version: 1.4.0 117
## Page 118

Core functions Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Set Position : LREAL; e Switch Mode : E_Adaptable Switch Mode; b Options Disable Drive Access : BOOL; b Options Enable Lag Error Detection : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Description f Set Position Specifies the value that is applied to the actual position at the homing event. e Switch Mode Defines how the Absolute Switch is interpreted as a homing event. b Options Disable Drive Access A TRUE prevents the underlying motion technology from using ADS communication via the fieldbus to change parameters of the controlled device and return to normal operation. Notice This option must be used for most non-Beckhoff servo drives. b Options Enable Lag Error Detection A TRUE will enable the lag error detection while the function is being executed. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.2.3 Set Parameter General() A general set of travel parameters for the homing procedure is set. Syntax: METHOD Set Parameter General : HRESULT VAR_INPUT e Direction : E_Adaptable Homing Direction; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; t Time Limit : TIME; f Distance Limit : LREAL; f Torque Limit : LREAL; END_VAR 118 Version: 1.4.0 TF8560
## Page 119

Core functions Return value Name Type Description Set Parameter General HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description e Direction E_Adaptable Homing Direction The movement with which the homing event is found. f Velocity LREAL The velocity of the movement used in the search of the homing event. f Acceleration LREAL The acceleration of the movement used in the search of the homing event. f Deceleration LREAL The deceleration of the movement used in the search of the homing event. f Jerk LREAL The jerk of the movement used in the search of the homing event. t Time Limit TIME The timeout limit of the core function. f Distance Limit LREAL The maximum distance that may be traveled in the search of the homing event. f Torque Limit LREAL The limit of the torque applied in the search of the homing event. Torque limitation in the event of a mechanical blockage The torque limitation is used to prevent damage if the axis encounters a mechanical blockage without having detected the homing event. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.3 Absolute Switch Detect This core function performs homing by searching for a fixed edge of a signal. At this location the actual position is latched and reported. Properties Name Type Access Description Absolute Switch BOOL Get, Set This signal indicates the homing position. Negative Limit Switch BOOL Get, Set The hardware limit switch at the lower end of the available travel path. Positive Limit Switch BOOL Get, Set The hardware limit switch at the upper end of the available travel path. Recorded Position LREAL Get The position latched at the location of the signal. TF8560 Version: 1.4.0 119
## Page 120

Core functions The action of the limit switches is defined by PLCopen standards. Methods Name Description Do Homing() [} 120] This method triggers the homing. Set Parameter() [} 121] A set of parameters specific to this homing procedure is set. Set Parameter General() A set of travel parameters for the homing procedure is set. [} 122] Interfaces Type Description I_Homing Absolute Switch Detect Standard interface on FB_Homing Absolute Switch Detect. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.3.1 Do Homing() This method triggers the homing. Syntax: METHOD Do Homing : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Homing HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. 120 Version: 1.4.0 TF8560
## Page 121

Core functions Inputs Name Type Description b Execute BOOL A rising edge triggers homing. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.3.2 Set Parameter() A set of parameters specific to this homing procedure is set. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT e Switch Mode : E_Adaptable Switch Mode; b Options Disable Drive Access : BOOL; b Options Enable Lag Error Detection : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Description e Switch Mode Defines how the Absolute Switch is interpreted as a homing event. b Options Disable Drive Access A TRUE prevents the underlying motion technology from using ADS communication via the fieldbus to change parameters of the controlled device and return to normal operation. Notice This option must be used for most non-Beckhoff servo drives. b Options Enable Lag Error Detection A TRUE will enable the lag error detection while the function is being executed. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 121
## Page 122

Core functions 4.14.3.3 Set Parameter General() A general set of travel parameters for the homing procedure is set. Syntax: METHOD Set Parameter General : HRESULT VAR_INPUT e Direction : E_Adaptable Homing Direction; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; t Time Limit : TIME; f Distance Limit : LREAL; f Torque Limit : LREAL; END_VAR Return value Name Type Description Set Parameter General HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description e Direction E_Adaptable Homing Direction The movement with which the homing event is found. f Velocity LREAL The velocity of the movement used in the search of the homing event. f Acceleration LREAL The acceleration of the movement used in the search of the homing event. f Deceleration LREAL The deceleration of the movement used in the search of the homing event. f Jerk LREAL The jerk of the movement used in the search of the homing event. t Time Limit TIME The timeout limit of the core function. f Distance Limit LREAL The maximum distance that may be traveled in the search of the homing event. f Torque Limit LREAL The limit of the torque applied in the search of the homing event. Torque limitation in the event of a mechanical blockage The torque limitation is used to prevent damage if the axis encounters a mechanical blockage without having detected the homing event. 122 Version: 1.4.0 TF8560
## Page 123

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.4 Block This core function performs homing by searching for a mechanical stop. At this location the actual position is latched and reported. Methods Name Description Do Homing() [} 123] This method triggers the homing. Set Parameter() [} 124] A set of parameters specific to this homing procedure is set. Set Parameter General() A set of travel parameters for the homing procedure is set. [} 125] Interfaces Type Description I_Homing Block Standard interface on FB_Homing Block. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.4.1 Do Homing() This method triggers the homing. Syntax: METHOD Do Homing : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Homing HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. TF8560 Version: 1.4.0 123
## Page 124

Core functions E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers homing. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.4.2 Set Parameter() A set of parameters specific to this homing procedure is set. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Set Position : LREAL; f Detection Velocity Limit : LREAL; t Detection Velocity Time : TIME; f Torque Tolerance : LREAL; b Options Disable Drive Access : BOOL; b Options Instant Lag Reduction : BOOL; b Options Torque Polarity Inverted : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Description f Set Position The position to be assigned to the homing event. f Detection Velocity Limit A velocity threshold for the detection of the homing event. For details see below. 124 Version: 1.4.0 TF8560
## Page 125

Core functions Name Description t Detection Velocity Time A filter time for the detection of the homing event. For details see below. f Torque Tolerance A torque threshold for the detection of the homing event. For details see below. b Options Disable Drive Access A TRUE prevents the underlying motion technology from using ADS communication via the fieldbus to change parameters of the controlled device and return to normal operation. Notice This option must be used for most non-Beckhoff servo drives. b Options Instant Lag Reduction A TRUE causes the lag error to be cleared (set position := actual position) when the homing event is detected. b Options Torque Polarity Inverted A TRUE causes an inverted evaluation of the torque. Notice This inversion must be used if the signs of the torque and the direction of movement do not match. This may be caused by direction-reversing mechanics (gears, etc.). The homing event A mechanical block as a homing event is detected if at the same time the torque is below the torque limit by less than f Torque Tolerance and the actual velocity has been continuously below f Detection Velocity Limit since t Detection Velocity Time. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.4.3 Set Parameter General() A general set of travel parameters for the homing procedure is set. Syntax: METHOD Set Parameter General : HRESULT VAR_INPUT e Direction : E_Adaptable Homing Direction; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; t Time Limit : TIME; f Distance Limit : LREAL; f Torque Limit : LREAL; END_VAR TF8560 Version: 1.4.0 125
## Page 126

Core functions Return value Name Type Description Set Parameter General HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description e Direction E_Adaptable Homing Direction The movement with which the homing event is found. f Velocity LREAL The velocity of the movement used in the search of the homing event. f Acceleration LREAL The acceleration of the movement used in the search of the homing event. f Deceleration LREAL The deceleration of the movement used in the search of the homing event. f Jerk LREAL The jerk of the movement used in the search of the homing event. t Time Limit TIME The timeout limit of the core function. f Distance Limit LREAL The maximum distance that may be traveled in the search of the homing event. f Torque Limit LREAL The limit of the torque applied in the search of the homing event. Torque limitation in the event of a mechanical blockage The torque limitation is used to prevent damage if the axis encounters a mechanical blockage without having detected the homing event. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.5 Block Detect This core function performs homing by searching for a mechanical stop. At this location the actual position is latched and reported. Properties Name Type Access Description Recorded Position LREAL Get The position latched at the location of the signal. Methods Name Description Do Homing() [} 127] This method triggers the homing. Set Parameter() [} 128] A set of parameters specific to this homing procedure is set. 126 Version: 1.4.0 TF8560
## Page 127

Core functions Name Description Set Parameter General() A set of travel parameters for the homing procedure is set. [} 129] Interfaces Type Description I_Homing Block Detect Standard interface on FB_Homing Block Detect. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.5.1 Do Homing() This method triggers the homing. Syntax: METHOD Do Homing : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Homing HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers homing. TF8560 Version: 1.4.0 127
## Page 128

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.5.2 Set Parameter() A set of parameters specific to this homing procedure is set. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Detection Velocity Limit : LREAL; t Detection Velocity Time : TIME; f Torque Tolerance : LREAL; b Options Disable Drive Access : BOOL; b Options Instant Lag Reduction : BOOL; b Options Torque Polarity Inverted : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Description f Detection Velocity Limit A velocity threshold for the detection of the homing event. For details see below. t Detection Velocity Time A filter time for the detection of the homing event. For details see below. f Torque Tolerance A torque threshold for the detection of the homing event. For details see below. b Options Disable Drive Access A TRUE prevents the underlying motion technology from using ADS communication via the fieldbus to change parameters of the controlled device and return to normal operation. Notice This option must be used for most non-Beckhoff servo drives. b Options Instant Lag Reduction A TRUE causes the lag error to be cleared (set position := actual position) when the homing event is detected. b Options Torque Polarity Inverted A TRUE causes an inverted evaluation of the torque. Notice This inversion must be used if the signs of the torque and the direction of movement do not match. This may be caused by direction-reversing mechanics (gears, etc.). 128 Version: 1.4.0 TF8560
## Page 129

Core functions The homing event A mechanical block as a homing event is detected if at the same time the torque is below the torque limit by less than f Torque Tolerance and the actual velocity has been continuously below f Detection Velocity Limit since t Detection Velocity Time. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.5.3 Set Parameter General() A general set of travel parameters for the homing procedure is set. Syntax: METHOD Set Parameter General : HRESULT VAR_INPUT e Direction : E_Adaptable Homing Direction; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; t Time Limit : TIME; f Distance Limit : LREAL; f Torque Limit : LREAL; END_VAR Return value Name Type Description Set Parameter General HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description e Direction E_Adaptable Homing Direction The movement with which the homing event is found. f Velocity LREAL The velocity of the movement used in the search of the homing event. f Acceleration LREAL The acceleration of the movement used in the search of the homing event. f Deceleration LREAL The deceleration of the movement used in the search of the homing event. f Jerk LREAL The jerk of the movement used in the search of the homing event. t Time Limit TIME The timeout limit of the core function. TF8560 Version: 1.4.0 129
## Page 130

Core functions Name Type Description f Distance Limit LREAL The maximum distance that may be traveled in the search of the homing event. f Torque Limit LREAL The limit of the torque applied in the search of the homing event. Torque limitation in the event of a mechanical blockage The torque limitation is used to prevent damage if the axis encounters a mechanical blockage without having detected the homing event. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.6 Finish This core function must be used to successfully complete a homing. Abort required Abort is required if a homing function fails. Methods Name Description Do Finish() [} 130] A rising edge triggers the termination. Set Parameter() [} 131] The procedure for returning to normal operation can be specified. Interfaces Type Description I_Homing Finish Standard interface on FB_Homing Finish. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.6.1 Do Finish() This method triggers the termination on a rising edge. 130 Version: 1.4.0 TF8560
## Page 131

Core functions Syntax: METHOD Do Finish : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Finish HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers the termination. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.6.2 Set Parameter() The procedure for returning to normal operation can be specified. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Distance : LREAL; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; b Options Disable Drive Access : BOOL; END_VAR TF8560 Version: 1.4.0 131
## Page 132

Core functions Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description f Distance LREAL Here you can define a distance by which the axis should move away from the homing position. In many cases, there is a torque at the end of a homing procedure. The mechanics of the axis can be relieved by a movement suitably selected in amount and direction. f Velocity LREAL The velocity to be commanded for this. f Acceleration LREAL The acceleration to be commanded for this. f Deceleration LREAL The deceleration to be commanded for this. f Jerk LREAL The jerk to be commanded for this. b Options Disable Drive Access BOOL A TRUE prevents ADS communication via the fieldbus from being used to change parameters of the controlled device in order to return to normal operation. Notice The option b Options Disable Drive Access must be used for most non-Beckhoff servo drives. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.7 Limit Switch This core function performs homing by searching for a fixed edge of a signal. A specified position is set at this location. Properties Name Type Access Description Negative Limit Switch BOOL Get, Set The hardware limit switch at the lower end of the available travel path. Positive Limit Switch BOOL Get, Set The hardware limit switch at the upper end of the available travel path. The action of the limit switches is defined by PLCopen standards. 132 Version: 1.4.0 TF8560
## Page 133

Core functions Methods Name Description Do Homing() [} 133] This method triggers the homing. Set Parameter() [} 134] A set of parameters specific to this homing procedure is set. Set Parameter General() A set of travel parameters for the homing procedure is set. [} 135] Interfaces Type Description I_Homing Limit Switch Standard interface on FB_Homing Limit Switch. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.7.1 Do Homing() This method triggers the homing. Syntax: METHOD Do Homing : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Homing HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers homing. TF8560 Version: 1.4.0 133
## Page 134

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.7.2 Set Parameter() A set of parameters specific to this homing procedure is set. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Set Position : LREAL; e Switch Mode : E_Adaptable Switch Mode; b Options Disable Drive Access : BOOL; b Options Enable Lag Error Detection : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Description f Set Position Specifies the value that is applied to the actual position at the homing event. e Switch Mode Defines how the Absolute Switch is interpreted as a homing event. b Options Disable Drive Access A TRUE prevents the underlying motion technology from using ADS communication via the fieldbus to change parameters of the controlled device and return to normal operation. This option must be used for most non-Beckhoff servo drives. b Options Enable Lag Error Detection A TRUE will enable the lag error detection while the function is being executed. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 134 Version: 1.4.0 TF8560
## Page 135

Core functions 4.14.7.3 Set Parameter General() A general set of travel parameters for the homing procedure is set. Syntax: METHOD Set Parameter General : HRESULT VAR_INPUT e Direction : E_Adaptable Homing Direction; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; t Time Limit : TIME; f Distance Limit : LREAL; f Torque Limit : LREAL; END_VAR Return value Name Type Description Set Parameter General HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description e Direction E_Adaptable Homing Direction The movement with which the homing event is found. f Velocity LREAL The velocity of the movement used in the search of the homing event. f Acceleration LREAL The acceleration of the movement used in the search of the homing event. f Deceleration LREAL The deceleration of the movement used in the search of the homing event. f Jerk LREAL The jerk of the movement used in the search of the homing event. t Time Limit TIME The timeout limit of the core function. f Distance Limit LREAL The maximum distance that may be traveled in the search of the homing event. f Torque Limit LREAL The limit of the torque applied in the search of the homing event. Torque limitation in the event of a mechanical blockage The torque limitation is used to prevent damage if the axis encounters a mechanical blockage without having detected the homing event. TF8560 Version: 1.4.0 135
## Page 136

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.8 Limit Switch Detect This core function performs homing by searching for a fixed edge of a signal. At this location the actual position is latched and reported. Properties Name Type Access Description Negative Limit Switch BOOL Get, Set The hardware limit switch at the lower end of the available travel path. Positive Limit Switch BOOL Get, Set The hardware limit switch at the upper end of the available travel path. Recorded Position LREAL Get The position latched at the location of the signal. The action of the limit switches is defined by PLCopen standards. Methods Name Description Do Homing() [} 136] This method triggers the homing. Set Parameter() [} 137] A set of parameters specific to this homing procedure is set. Set Parameter General() A set of travel parameters for the homing procedure is set. [} 138] Interfaces Type Description I_Homing Limit Switch Detect Standard interface on FB_Homing Limit Switch Detect. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.8.1 Do Homing() 136 Version: 1.4.0 TF8560
## Page 137

Core functions This method triggers the homing. Syntax: METHOD Do Homing : HRESULT VAR_INPUT b Execute : BOOL; END_VAR Return value Name Type Description Do Homing HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge triggers homing. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.8.2 Set Parameter() A set of parameters specific to this homing procedure is set. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT e Switch Mode : E_Adaptable Switch Mode; b Options Disable Drive Access : BOOL; b Options Enable Lag Error Detection : BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. TF8560 Version: 1.4.0 137
## Page 138

Core functions Inputs Name Description e Switch Mode Defines how the Absolute Switch is interpreted as a homing event. b Options Disable Drive Access A TRUE prevents the underlying motion technology from using ADS communication via the fieldbus to change parameters of the controlled device and return to normal operation. This option must be used for most non-Beckhoff servo drives. b Options Enable Lag Error Detection A TRUE will enable the lag error detection while the function is being executed. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.14.8.3 Set Parameter General() A general set of travel parameters for the homing procedure is set. Syntax: METHOD Set Parameter General : HRESULT VAR_INPUT e Direction : E_Adaptable Homing Direction; f Velocity : LREAL; f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; t Time Limit : TIME; f Distance Limit : LREAL; f Torque Limit : LREAL; END_VAR Return value Name Type Description Set Parameter General HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description e Direction E_Adaptable Homing Direction The movement with which the homing event is found. f Velocity LREAL The velocity of the movement used in the search of the homing event. 138 Version: 1.4.0 TF8560
## Page 139

Core functions Name Type Description f Acceleration LREAL The acceleration of the movement used in the search of the homing event. f Deceleration LREAL The deceleration of the movement used in the search of the homing event. f Jerk LREAL The jerk of the movement used in the search of the homing event. t Time Limit TIME The timeout limit of the core function. f Distance Limit LREAL The maximum distance that may be traveled in the search of the homing event. f Torque Limit LREAL The limit of the torque applied in the search of the homing event. Torque limitation in the event of a mechanical blockage The torque limitation is used to prevent damage if the axis encounters a mechanical blockage without having detected the homing event. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.15 Jog This core function is used to start and stop the axis with a certain velocity but without a defined target position. Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Jog Is Jogging M BOOL Get A TRUE signals an active jogging in negative direction. Is Jogging P BOOL Get A TRUE signals an active jogging in positive direction. Is Stopping BOOL Get A TRUE signals the stopping of the axis after an active jogging. Limiting LREAL Get, Set Setpoint for limiting (e.g. torque, pressure) during jogging. Torque Limiting1 LREAL Get, Set This sets the torque limit during jogging. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. TF8560 Version: 1.4.0 139
## Page 140

Core functions Name Type Access Description Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. 1Obsolete Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Jog Do Jog M() [} 141] This method performs the start and stop of the axis in the negative direction. Do Jog P() [} 141] This method performs the start and stop of the axis in the positive direction. Set Parameter() [} 142] This method is used to set the parameters of a movement in jogging mode. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Jog Standard interface on FB_Jog. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: IF b Jog Pos THEN hresult := i Axis Base. Jog. Set Parameter( f Acceleration := 0.0, // default f Deceleration := 0.0, // default f Jerk := 0.0, // default f Velocity := 20.0 // [mm/s] ); i Axis Base. Jog. Do Jog P(TRUE); ELSIF i Axis Base. Jog. Is Commanded THEN i Axis Base. Jog. Do Jog P(FALSE); END_IF 140 Version: 1.4.0 TF8560
## Page 141

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 4.15.1 Do Jog M() This method performs the start and stop of the axis in the negative direction. Syntax: METHOD Do Jog M : HRESULT VAR_INPUT b Enable : BOOL; END_VAR Return value Name Type Description Do Jog M HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Enable BOOL A rising edge starts a jogging in negative direction. A falling edge triggers a stop of the axis. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.15.2 Do Jog P() This method performs the start and stop of the axis in the positive direction. TF8560 Version: 1.4.0 141
## Page 142

Core functions Syntax: METHOD Do Jog P : HRESULT VAR_INPUT b Enable : BOOL; END_VAR Return value Name Type Description Do Jog P HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Enable BOOL A rising edge starts a jogging in positive direction. A falling edge triggers a stop of the axis. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.15.3 Set Parameter() This method is used to set the parameters of a movement in jogging mode. Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Acceleration : LREAL; f Deceleration : LREAL; f Jerk : LREAL; f Velocity : LREAL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. 142 Version: 1.4.0 TF8560
## Page 143

Core functions Inputs Name Type Description f Acceleration LREAL The commanded acceleration. f Deceleration LREAL The commanded deceleration. f Jerk LREAL The commanded jerk. f Velocity LREAL The commanded velocity. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.16 Limiting This function is responsible for limiting all axis functions. The type of limitation depends on the drive technology. For example, the torque of electric axes and the pressure of hydraulic axes can be limited. The following function blocks are automatically available internally for axes of type FB_Axis Nc Base: • FB_Torque Limiting Co E - DS402 (AX8000) based Torque Limiting • FB_Torque Limitng So E - AX5000 based Torque Limiting No core function This function does not belong to any classification of core functions. It is only mentioned in the context of core functions, as it can be achieved via the properties of an axis. Syntax: FUNCTION_BLOCK FB_Limiting EXTENDS FB_Message Base Properties Name Type Access Description Activate BOOL Get, Set Activates the use of the Active Value as an active limit. Active Value LREAL Get Limitation value currently available Actual LREAL Get Current actual value of the limited variable (torque/ pressure) Connected To Drive BOOL Get An internal connection to a drive unit has been established. Default Fb I_Limiting Fb (Get, Set) Access to the standard function block for torque limitation if specific handling is used. Direction E_Adaptable Directio Get, Set Direction in which the torque limit should act. n Idle Value LREAL Get, Set The idle value for the limitation to which the axis returns after a command. Max Value LREAL Get, Set The effective limitation of the limit for each command. Nominal Value LREAL Get, Set The normalized value in relation to the Reference Value. TF8560 Version: 1.4.0 143
## Page 144

Core functions Name Type Access Description Reference Value LREAL Get, Set Reference value for the maximum command value of the limit. Actual Torque 1 LREAL Get, Set Current actual torque value of the axis. 1Obsolete Methods Name Description [INTERN] Implements the return to the idle value when a command is terminated. Return To Idle() Interfaces Type Description I_Limiting Standard interface on FB_Limiting. I_Limiting Fb Extended interface for use as a core function. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 4.17 Motion Params This Corefunction is used to display a range of parameter values for a motion unit. Support of the parameters depends on the technology Some parameters are only available for specific drive technologies. Please note the comments in the "Choice" column! 144 Version: 1.4.0 TF8560
## Page 145

Core functions Function is asynchronous An implementation of runtime switching via this function block must always take the state of the function block into account. A written parameter does not become active immediately. • The Busy State can be checked by setting it to FALSE Axes must be disabled Some parameters cannot be written while an axis is enabled. Syntax: FUNCTION_BLOCK FB_Motion Params EXTENDS FB_Corefunction Properties Name Type Access Selection Description Actuator Base I_Actuator Get Access to parameters for the base position of an Params H actuator. [} 148] Actuator Work I_Actuator Get Access to parameters for the working position of Params H an actuator. [} 148] Asym Targeting BOOL Get, Set TRUE if the parameters for the target approach are direction-dependent. Otherwise, the parameters for the negative direction are ignored and the parameters for the positive direction are used regardless of the direction. Auto Brake Calculati BOOL Get, Set TRUE if the braking distance is determined on automatically. Axis Is Nc BOOL Get / TRUE, if the axis is operated with Twin CAT NC. Brake Distance M LREAL Get, Set The braking distance time in negative direction. See also Asym Targeting. Brake Distance P LREAL Get, Set The braking distance time in positive direction. Creep Distance M LREAL Get, Set The creep distance in negative direction. See also Asym Targeting. Creep Distance P LREAL Get, Set The creep distance in positive direction. Creep Speed M LREAL Get, Set The creep speed in negative direction. Creep Speed P LREAL Get, Set The creep speed in positive direction. Cycle Time LREAL Get / The cycle time of the task in which the real-time functions of the axis are executed. Cylinder Area A LREAL Get, Set Cylinder area of the A side of the activated hydraulic cylinder (positive direction). Cylinder Area B LREAL Get, Set Cylinder area of the B side of the activated hydraulic cylinder (negative direction). Drive Is Co E BOOL Get / TRUE, if the axis has a Co E interface. Drive Is Servo BOOL Get / TRUE if the axis is a servo drive. Drive Is Simulated BOOL Get / TRUE if the drive of the axis is simulated. Drive Is So E BOOL Get / TRUE, if the axis has a So E interface. Drive Reversed BOOL Get, Set TRUE if the drive of the axis is inverted. Notice The outputs are swapped for actuators. TF8560 Version: 1.4.0 145
## Page 146

Core functions Name Type Access Selection Description Drive Torque Weighti LREAL Get / Scaling factor of the actual torque value of the ng drive. Drive Type UDINT Get / A numeric identifier for the type of the connected drive. Notice The meaning of the constants is defined in the Tc2 NC or the Tc2_Hydraulics library. Encoder Interpolatio LREAL Get, Set The divider for the encoder evaluation. It n specifies the number of increments corresponding to the distance specified by Encoder Weighting. Encoder Is Analog BOOL Get / TRUE if the encoder of the axis uses an analog input. Encoder Is Simulate BOOL Get / TRUE if the encoder of the axis is simulated. d Encoder Mask UDINT Get / Encoder mask for encoder value overflow Encoder Mode UDINT Get / Operation mode of the encoder Encoder Reversed BOOL Get, Set TRUE if the encoder / feedback of the axis is inverted. Notice The feedback inputs are swapped for actuators. Encoder Type UDINT Get / A numeric identifier for the type of the connected encoder. Notice The meaning of the constants is defined in the Tc2 NC or the Tc2_Hydraulics library. Encoder Weighting LREAL Get, Set The factor for encoder evaluation. It specifies the distance corresponding to a number of increments specified by Encoder Interpolation. Encoder Zero Shift LREAL Get, Set The zero offset shift of the encoder. Has Auto Limiting BOOL Get / TRUE if the axis uses an internal automatic limiting function. Lag Controlled BOOL Get / TRUE if the axis has a position controller. Lag Ctrl Kp LREAL Get, Set The k P factor of the position controller. Lag Filter LREAL Get, Set The filter time of the lag error monitoring. Lag Limit LREAL Get, Set The threshold value of the lag error monitoring. Lag Monitored BOOL Get, Set TRUE, if the lag error monitoring of the axis is active. Max Acc Application LREAL Get, Set An additional restriction on acceleration. Max Acceleration LREAL Get, Set The maximum permissible acceleration. Notice A write operation on this parameter is always also applied to Max Acc Application. Max Dec Application LREAL Get, Set An additional limitation of the deceleration. Max Deceleration LREAL Get, Set The maximum permissible deceleration. Notice A write operation on this parameter is always also applied to Max Dec Application. Max Jerk LREAL Get, Set The maximum permissible jerk. 146 Version: 1.4.0 TF8560
## Page 147

Core functions Name Type Access Selection Description Max Velo Application LREAL Get, Set An additional velocity restriction. Max Velo System LREAL Get, Set The maximum velocity of the axis. Notice This parameter acts as a reference value for the maximum velocity output of the drive interface. Min Velo Application LREAL Get, Set The minimum velocity of the axis. Persist BOOL Get, Set Enables the persistent saving of parameter write operations of this function block on the target system. Scaling Oil Pressure LREAL Get, Set The scaling factor for the actual pressure acquisition. Soft End Max LREAL Get, Set The maximum software limit switch. Soft End Max Ena BOOL Get, Set Enable for the maximum software limit switch. Soft End Max System LREAL Get, Set For the load side of transforming axes: The converted maximum software limit switch of the drive side. For the drive side of transforming axes: The converted maximum software limit switch of the load side. For non-transforming axes: A copy of the maximum software limit switch. Soft End Min LREAL Get, Set The minimum software limit switch. Soft End Min Ena BOOL Get, Set Enable for the minimum software limit switch. Soft End Min System LREAL Get, Set For the load side of transforming axes: The converted minimum software limit switch of the drive side. For the drive side of transforming axes: The converted minimum software limit switch of the load side. For non-transforming axes: A copy of the minimum software limit switch. Valid BOOL Get / TRUE if all parameters are valid. Velo Monitored BOOL Get, Set TRUE if the velocity monitoring of the axis is active. Velo Lag Limit LREAL Get, Set The tolerance window for triggering velocity monitoring. Notice For actuators, the limit is interpreted as a time. Busy State BOOL Get / TRUE, if the function block writes changed parameters. Ready State BOOL Get / TRUE if the function block has loaded all parameters at least once. Has Torque Limiting1 BOOL Get Obsolete Returns the value of Has Auto Limiting. Min Velo Jog1 LREAL Get, Set Obsolete Returns the value of Min Velo Application. 1Obsolete Key TF8560 Version: 1.4.0 147
## Page 148

Core functions TF5810 Hydraulic Positioning FB_Axis Hydraulic Base TF5000 NC PTP FB_Axis Nc Base TF8560 Inverter Axis FB_Axis Inv Base TF8560 Linear Actuator FB_Actuator Base Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Motion Params Standard interface on FB_Motion Params. Example: i Axis Base. Motion Params. Soft End Max := f Axis Stroke; Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) 4.17.1 Actuator Params H Exclusive function for actuators This core function is only available for actuators. This core function combines several parameters per end position of an actuator. The core function is a member of the group of permanently active core functions. Syntax: FUNCTION_BLOCK FB_Param Actuator H EXTENDS FB_Corefunction Properties Name Type Access Description Feedback Delay LREAL Get, Set Delay [s] of the feedback signal. Feedback Delay Off LREAL Get, Set Delay [s] of the falling edge of the feedback signal. Hold Output BOOL Get, Set The output should remain active when the motion commands are canceled. Notice The output only remains active when the end position has been reached! Invert Feedback BOOL Get, Set The interpretation of the feedback signal is inverted (In Pos = FALSE). Latch Feedback BOOL Get, Set The feedback signal is saved after the end position has been reached. 148 Version: 1.4.0 TF8560
## Page 149

Core functions Name Type Access Description Return Time LREAL Get, Set Time [s] after which the actuator automatically commands itself back in the opposite direction. Return Time Ena BOOL Get, Set Enables the time-based reset command. Timeout LREAL Get, Set Time [s] after the end position must be reached. Otherwise, the actuator goes into the error state. Use Impulse BOOL Get, Set The output is canceled when the end position is reached. Interfaces Type Description I_Actuator Params H Standard interface on FB_Actuator Params H. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 4.18 Motion Setpoints This core function offers a range of current setpoints. This core function is a member of the group of permanently active core functions. Syntax: FUNCTION_BLOCK FB_Motion Setpoints EXTENDS FB_Corefunction Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Motion Setpoints Acceleration LREAL Get The current acceleration setpoint. Jerk LREAL Get The current jerk setpoint. Position LREAL Get The current position setpoint. Limiting LREAL Get The current setpoint of the limiting function (e.g. torque, pressure). Velocity LREAL Get The current velocity setpoint. Torque Limiting1 LREAL Get The current setpoint for torque limitation. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. TF8560 Version: 1.4.0 149
## Page 150

Core functions Name Type Access Description Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. 1Obsolete Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Motion Setpoints Standard interface on FB_Motion Setpoints. Example: // calculating the difference between target and actual velocity f Velo Lag := ABS(i Axis Base. Actuals. Velocity) - ABS(i Axis Base. Motion Setpoints. Velocity); Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 4.19 Power This core function is used to enable or disable active operation of the controlled device. Syntax: FUNCTION_BLOCK FB_Power EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Power Is Feed Enabled M BOOL Get TRUE if the axis is enabled for active movement in negative direction. Is Feed Enabled P BOOL Get TRUE if the axis is enabled for active movement in positive direction. 150 Version: 1.4.0 TF8560
## Page 151

Core functions Name Type Access Description Override LREAL Get, Set A factor for scaling commanded velocities. Notice The effect is significantly influenced by the type of axis and its parameterization. Status BOOL Get TRUE, if the axis is enabled for active operation. Notice For an active movement, the direction- related enable is also required. Timeout LREAL Get, Set If there is no response, an axis error is triggered after the time-out period. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Power Do Power() [} 152] Enable for active operation of the axis. Feed Enable() [} 153] Directional enables for commanding active axis movements. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Power Standard interface on FB_Power. I_Power Dev Extended interface with access to the Timeout property. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. TF8560 Version: 1.4.0 151
## Page 152

Core functions Example: i Axis Base. Power. Do Power(b Enable); i AXis Base. Power. Feed Enable(b Enable, b Enable); Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.19.1 Do Power() This method is used to enable or disable the axis for active operation. If this requires an exchange of signals with a device, this exchange is performed and monitored. Syntax: METHOD Do Power: HRESULT VAR_INPUT b Enable: BOOL; END_VAR Return value Name Type Description Do Power HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Enable BOOL A rising edge starts the enable process. A falling edge starts the disable process. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 152 Version: 1.4.0 TF8560
## Page 153

Core functions 4.19.2 Feed Enable() This method is used to define directional enables for active movements of the axis. Syntax: METHOD Feed Enable: HRESULT VAR_INPUT b Feed Ena Positive: BOOL; b Feed Ena Negative: BOOL; END_VAR Return value Name Type Description Feed Enable HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Feed Ena Positive BOOL A TRUE enables active movements in positive direction. b Feed Ena Negative BOOL A TRUE enables active movements in negative direction. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.20 Pressure Control This Corefunction is provided to allow access to a number of controller types. There is currently an extended PID controller [} 154] and a supervisor for reading the pressure value and switching to pressure control. Syntax: FUNCTION_BLOCK FB_Pressure Control Main TF8560 Version: 1.4.0 153
## Page 154

Core functions Properties Name Type Access Description PID [} 154] I_Pressure Control Get Extended PID controller. Supervisor [} 163] I_Process Superviso Get Infrastructure and organization of pressure control. r Interfaces Type Description I_Pressure Control Main Standard interface on FB_Pressure Control Main. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 4.20.1 Pressure Control. PID This core function implements an extended PID controller functionality. The pressure value read by the Supervisor [} 163] is used as the controlled variable. The velocity of the axis is controlled as the manipulated variable. Accordingly, this control structure can be used for a range of tasks: • Holding pressure control in injection molding machines • Back pressure control in injection molding machines • Melt pressure control for extruders • Others Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Pressure Control_PID Actual BOOL Get Current actual pressure value. Allow Switch Over BOOL Get, Set Allows switching from another active Corefunction to pressure control. Notice Currently, only Ptp is supported for switching. 154 Version: 1.4.0 TF8560
## Page 155

Core functions Name Type Access Description Limiting LREAL Get, Set Setpoint for the limitation (e.g., torque, pressure) during pressure control. Parameters [} 158] I_Pressure Control P Get, Set Parameter set that is used for control. The parameter arams_PID sets can be switched by assignment. If a 0 is assigned, the internal parameter set is used. Pressure Look Up I_Pressure Look Up Get, Set Print setpoint table for sequential processing of print setpoints. Notice Preliminary implementation Target LREAL Get, Set Command variable (setpoint) of the controller. Is Enabled1 BOOL Get A TRUE signals the active state of the pressure switchover. Alternatively: . Allow Switch Over FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description Activate() [} 156] Activate / deactivate the controller. Switch Over() [} 157] Activate the controller by switching another command. Enable Switch Over() Enable for automatic activation by a Pressure Handler. [} 309]1 Alternatively: Allow Switch Over Get Actual() [} 310]1 The actual value of the controller is determined. Alternatively: Actual Get Params() [} 311]1 An interface to the connected parameter set is determined. Alternatively: Parameters Set Params() [} 311]1 A parameter set is connected to the controller. Alternatively: Parameters Setpoint() [} 312]1 Set the command variable (setpoint) of the controller. Alternatively: Target TF8560 Version: 1.4.0 155
## Page 156

Core functions 1Obsolete Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Pressure Control Standard interfaces on FB_Pressure Control_PID. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // Requires connected pressure input, e.g. via Pressure Control. Supervisor. Sensor // Start pressure control on application start signal IF b Start THEN // Assign pressure setpoint i Axis Base. Pressure Control. PID. Target := 20.0; // parameterize once before activation and activate IF i Axis Base. Pressure Control. PID. Idle State THEN i Axis Base. Pressure Control. PID. Limiting := 80.0; i Axis Base. Pressure Control. PID. Parameters. Kp := 0.5; i Axis Base. Pressure Control. PID. Parameters. Enable I := TRUE; i Axis Base. Pressure Control. PID. Parameters. Tn := 1.0; i Axis Base. Pressure Control. PID. Activate(TRUE); // wait until function is terminated ELSIF b Stop THEN b Start := FALSE; i Axis Base. Pressure Control. PID. Activate(FALSE); END_IF END_IF Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 4.20.1.1 Activate This method is used to activate and deactivate the controller. Syntax: METHOD Activate: HRESULT VAR_INPUT b Enable: BOOL; END_VAR Return value Name Type Description Activate HRESULT See below 156 Version: 1.4.0 TF8560
## Page 157

Core functions Inputs Name Type Description b Enable BOOL Enable for the controller. 4.20.1.2 Switch Over This method can be used by a pressure handler function block. A TRUE at b Switchover will activate the controller if Enable Switch Over(TRUE) has been called before. Syntax: METHOD Switch Over: HRESULT VAR_INPUT b Switch Over: BOOL; END_VAR Return value Name Type Description Switch Over HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Switch Over BOOL The activation signal of the pressure handler. TF8560 Version: 1.4.0 157
## Page 158

Core functions 4.20.1.3 FB_Pressure Control Params_PID This function block contains a parameter set to be used by a FB_Pressure Control_PID [} 154] function block. Syntax: FUNCTION_BLOCK FB_Pressure Control Params_PID Properties Name Type Access Properties Change Rate LREAL Get, Set The ramp rate used in pressure units per second (typ. [bar/s]). Further notes at Enable Change Rate. Enable BOOL Get, Set This property is used to activate and deactivate the proportional component of the PID controller. Further notes at Kp. Enable Change Rate BOOL Get, Set Enables a setpoint ramp function. The internally used setpoint for control can be updated to the specified setpoint at a limited rate, specified as Change Rate. A setting of Change Rate=0.0 or Enable Change Rate=FALSE disables the ramp function and causes the internal setpoint to follow the specified setpoint immediately. Enable Output Limit BOOL Get, Set Enables a limiting function for the output of the controller (manipulated variable). Further notes at Output Limit. Enable D BOOL Get, Set Enables the differential component of the PID controller. Further notes at Td. Enable Feed Forward BOOL Get, Set Enables the speed feedforward control. Further notes at Feed Forward. Enable I BOOL Get, Set Enables the integrating part of the PID controller. Further notes at Tn. Enable Neg BOOL Get, Set Enables a negative output of the controller. Enable Pos BOOL Get, Set Enables a positive output of the controller. 158 Version: 1.4.0 TF8560
## Page 159

Core functions Name Type Access Properties Enable Profile BOOL Get, Set Enables the use of the setpoint profile via PID. Pressure Look Up Notice Preliminary implementation Feed Forward LREAL Get, Set Pre-control values for speed feedforward control. If Enable Feed Forward is set to TRUE, the value of Feed Forward is multiplied by Feed Forward Factor and added to the PID response output. In the case of back pressure control, the reverse velocity of the injector can be adapted to the effect of the dosing axis using feedforward control. This can make a positive contribution to the control quality when dynamically adjusting the dosing speed. Feed Forward Factor LREAL Get, Set Gain factor for the speed feedforward control. Further notes at Feed Forward. Kp LREAL Get, Set The proportional gain of the PID controller. Enable must be TRUE to release the effect. The value is measured in velocity unit per pressure unit (typically [mm/s / bar]. Output Limit LREAL Get, Set Limit for the output of the controller. Reversed BOOL Get, Set Reverses the output of the PID controller. In some applications, the axis must move in the positive direction to relieve pressure. A typical example is holding pressure and back pressure control in injection molding machines. Td LREAL Get, Set The differential component of the PID controller. The value is measured in velocity unit * second per pressure unit (typically [mm/s * s / bar}) The response is calculated if Enable D=TRUE and Td and Tdd>=Cycle Time, otherwise it is 0. Tdd LREAL Get, Set Damping of the differential component of the PID controller. Further notes at Td. Tn LREAL Get, Set The integrating component of the PID controller. The value is calculated in velocity units per pressure unit seconds (typically [mm/s / (bar * s)]) The response is calculated if Enable I=TRUE and Tn>=Cycle Time, , otherwise it is 0. The output is limited to Wu Limit. Wu Limit LREAL Get, Set Effective limitation of the integrating component of the PID controller. Further notes at Tn. Enable M1 BOOL Get, Set Obsolete variant of . Enable Neg Enable P1 BOOL Get, Set Obsolete variant of . Enable Pos Enable Clipping1 BOOL Get, Set Obsolete variant of . Enable Output Limit 1Obsolete TF8560 Version: 1.4.0 159
## Page 160

Core functions Methods Name Description Get Bool Parameter [} 160] This method is used to read BOOL parameters of the controller. For details see E_Pressure Control Param [} 162]. Get Float Parameter [} 161] This method is used to read LREAL parameters of the controller. For details see E_Pressure Control Param [} 162]. Set Bool Parameter [} 161] This method is used to define BOOL parameters of the controller. For details see E_Pressure Control Param [} 162]. Set Float Parameter [} 162] This method is used to define LREAL parameters of the controller. For details see E_Pressure Control Param [} 162]. Interfaces Name Description I_Pressure Control Params_PID Standard interface on FB_Pressure Control Params_PID Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 4.20.1.3.1 Get Bool Parameter This method is used to read BOOL parameters of the controller. For details see E_Pressure Control Param [} 162]. Syntax: METHOD Get Bool Parameter : HRESULT VAR_INPUT e Select: E_Pressure Control Param; b Value : REFERENCE TO BOOL; END_VAR Return value Name Type Description Get Bool Parameter HRESULT See below Inputs Name Type Description e Select E_Pressure Control Param The selection of the parameter. b Value REFERENCE TO BOOL A reference to the variable to be updated with the parameter. 160 Version: 1.4.0 TF8560
## Page 161

Core functions 4.20.1.3.2 Get Float Parameter This method is used to read LREAL parameters of the controller. For details see E_Pressure Control Param [} 162]. Syntax: METHOD Get Float Parameter : HRESULT VAR_INPUT e Select: E_Pressure Control Param; f Value : REFERENCE TO LREAL; END_VAR Return value Name Type Description Get Float Parameter HRESULT See below Inputs Name Type Description e Select E_Pressure Control Param The selection of the parameter. f Value REFERENCE TO LREAL A reference to the variable to be updated with the parameter. 4.20.1.3.3 Set Bool Parameter This method is used to define BOOL parameters of the controller. For details see E_Pressure Control Param [} 162]. Syntax: METHOD Set Bool Parameter : HRESULT VAR_INPUT e Select: E_Pressure Control Param; b Value : BOOL; END_VAR Return value Name Type Description Set Bool Parameter HRESULT See below Inputs Name Type Description e Select E_Pressure Control Param The selection of the parameter. b Value BOOL The value with which the parameter is to be defined. TF8560 Version: 1.4.0 161
## Page 162

Core functions 4.20.1.3.4 Set Float Parameter This method is used to define LREAL parameters of the controller. For details see E_Pressure Control Param [} 162]. Syntax: METHOD Set Float Parameter : HRESULT VAR_INPUT e Select: E_Pressure Control Param; f Value : LREAL; END_VAR Return value Name Type Description Set Float Parameter HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description e Select E_Pressure Control Param The selection of the parameter. f Value LREAL The value with which the parameter is to be defined. 4.20.1.3.5 E_Pressure Control Param The values of this enumeration are used by Get Bool Parameter(), Get Float Parameter(), Set Bool Parameter() and Set Float Parameter() of FB_Pressure Control Params_PID [} 154]. TYPE E_Pressure Control Param : ( e Kp := 1, e Tn, e Td, e Tdd, // e Wu Limit, e Out Limit, // e Change Rate, e Feed Forward, e Feed Forward Factor, e Enable, e Enable P, e Enable M, // e Reversed, 162 Version: 1.4.0 TF8560
## Page 163

Core functions // e Enable FF, e Enable I, e Enable D, e Enable Clipping, e Enable Change Rate ); END_TYPE 4.20.2 Pressure Control. Supervisor This Corefunction organizes the pressure control of the axis and provides the infrastructure interfaces. This is reflected in an interface for a pressure sensor and the switching function for pressure switchover. Pressure switchover only for certain core functions The pressure switchover can only be carried out with the following core functions: • PTP [} 165] Syntax: FUNCTION_BLOCK FB_Process Supervisor EXTENDS FB_Corefunction Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Process Supervisor Bad Switch Over BOOL Get Identifies whether a pressure switchover occurred due to safety conditions. External Mode BOOL Get TRUE as soon as an external Process Handler has been assigned. Filter I_Filter [} 252] Get, Set Interface for a filter to be applied to the actual pressure value. Min Cushion LREAL Get, Set Minimum distance that the axis must travel before the pressure-based switchover can be triggered. Position Limit LREAL Get, Set Safety-limiting position from which a Bad Switch Over is identified. Pressure Limit LREAL Get, Set Safety-limiting pressure above which a Bad Switch Over is identified. Pressure Threshold LREAL Get, Set Pressure threshold value above which a switchover should take place. Requirement is Switch On Pressure Sensor I_Input Base [} 205] Get, Set Interface for an actual pressure value sensor Switch On Pressure BOOL Get, Set Activates the switchover based on a pressure threshold value. Switch On Time BOOL Get, Set Activates the switchover based on the time of the previous command. Switch On Travel BOOL Get, Set Activates the switchover based on the value set by a previous command. Switch Over BOOL Get If TRUE, the Supervisor has triggered the pressure switchover. TF8560 Version: 1.4.0 163
## Page 164

Core functions Name Type Access Description Timeout LREAL Get, Set Safety-limiting time from which a Bad Switch Over is identified. Time Threshold LREAL Get, Set Time threshold from which a switchover should take place. Requirement is Switch On Time Travel Threshold LREAL Get, Set Threshold value from which a switchover should take place. Requirement is Switch On Travel Value Offset LREAL Get, Set Zero offset shift for the read actual pressure value. Value Weighting LREAL Get, Set Weighting factor for the maximum value of the read actual pressure value. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description Get External() Returns the connected external supervisor (implements I_Process Handler [} 165]). Notice Can return NULL if not previously assigned. Set External(i Handler) Assigns an external supervisor (implements I_Process Handler [} 165]). If 0 is transferred, the internal supervisor is reactivated. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Process Supervisor Standard interface on FB_Process Supervisor. Example: i Axis Base. Pressure Control. Supervisor. Sensor := fb Input Main Extruder Melt Pressure; i Axis Base. Pressure Control. Supervisor. Value Offset := 0.0; i Axis Base. Pressure Control. Supervisor. Value Weighting := 200.0; // bar 164 Version: 1.4.0 TF8560
## Page 165

Core functions Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 4.20.2.1 I_Process Handler Interface for an external supervisor. Syntax: INTERFACE I_Process Handler Properties Name Type Access Description Axis I_Axis Base [} 25] Get, Set Interface to the connected axis. Assigned by Supervisor. Set External() Bad Switch Over BOOL Get Reports a safety-related pressure switchover to the axis. Process Value LREAL Get Pressure value with which the pressure controller should operate. Switch Over BOOL Get Triggers the switching over to holding pressure. Methods Name Description Get Process Values() Method that implements the read process of the pressure value and can be called at a suitable point by the axis. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 4.21 Ptp Core function is not supported by inverter axes This core function is not supported by inverter axes. Any use will report DEVICE_NOTINIT and trigger an error message. This core function is used to perform multi-segment movements with the possibility to switch to torque or constant output clamping at the end. Syntax: FUNCTION_BLOCK FB_Ptp EXTENDS FB_Corefunction Feedback TF8560 Version: 1.4.0 165
## Page 166

Core functions Properties FB_Ptp Active Segment INT Get The number of the point that is currently being approached. Is Clamping BOOL Get TRUE if the core function has switched the axis to clamping. Moving Negative BOOL Get TRUE if the axis is actively moving in the negative direction. Moving Positive BOOL Get TRUE if the axis is actively moving in the positive direction. Number Of Points INT Get The number of points that the core function can store. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Ptp Check Point() [} 167] The specified segment is compared with the axis parameters. Do Move() [} 168] The execution is triggered. Get Clamp Point() [} 169] A segment of the clamping table is read back. Get Point() [} 169] A segment of the lookup table is read back. Get Updated Point() [} 170] A segment of the lookup table is read back. Invalidate Clamp Point() All segments in the clamping table are marked as invalid. Invalidate Table() All segments in the lookup table are marked as invalid. Set Clamp Point() [} 171] A segment of the clamping table is defined. 166 Version: 1.4.0 TF8560
## Page 167

Core functions Name Description Set Point() [} 171] A segment of the lookup table is defined. Update Position() [} 172] The target position of the segment is changed after it is defined. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Ptp Standard interface on FB_Ptp. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: CASE n State OF 0: // define 2 example points st Lookup Ptp Point. Position := 100.0; // [mm] st Lookup Ptp Point. Velocity := 20.0; // [mm/s] st Lookup Ptp Point. Valid := TRUE; // validate point // assign first point IF FAILED(i Axis Base. Ptp. Set Point(1, st Lookup Ptp Point)) THEN n State := -1; END_IF st Lookup Ptp Point. Position := 20.0; // [mm] st Lookup Ptp Point. Velocity := 30.0; // [mm/s] // assign second point IF FAILED(i Axis Base. Ptp. Set Point(2, st Lookup Ptp Point)) THEN n State := -1; END_IF // send the axis to travel IF FAILED(i Axis Base. Ptp. Do Move(TRUE)) THEN n State := -1; ELSIF n State >= 0 THEN n State := n State + 1; END_IF 1: // observe the movement IF i Axis Base. Ptp. Failed State THEN n State := -1; ELSIF i Axis Base. Ptp. Done State THEN n State := n State + 1; END_IF 2, // done -1: // error i Axis Base. Ptp. Do Move(FALSE); END_CASE Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.1 Check Point() TF8560 Version: 1.4.0 167
## Page 168

Core functions The transferred point is compared with the axis parameters. The result is only tested as SUCCEEDED() if the target does not exceed any of the enabled software position limits and does not fall below the minimum velocity. Syntax: METHOD Check Point: HRESULT VAR_INPUT st Point: ST_Look Up Ptp Point; END_VAR Return value Name Type Description Check Point HRESULT Return value with feedback on the validity of the point. Inputs Name Type Description st Point ST_Look Up Ptp Point The point to be checked. [} 173] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.2 Do Move() The PTP movement is triggered. Syntax: METHOD Do Move: HRESULT VAR_INPUT b Execute: BOOL; END_VAR Return value Name Type Description Do Move HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. 168 Version: 1.4.0 TF8560
## Page 169

Core functions Inputs Name Type Description b Execute BOOL A rising edge triggers the command. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.3 Get Clamp Point() A point in the clamping table is read back. Syntax: METHOD Get Clamp Point: HRESULT VAR_INPUT n Idx: INT; st Clamp Point: REFERENCE TO ST_Look Up Clamping; END_VAR Return value Name Type Description Get Clamp Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the point. st Clamp Poin REFERENC A reference to the variable that is to be updated with the requested point. t E TO ST_Look Up Cl amping [} 174] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.4 Get Point() A point of the lookup table is read back. TF8560 Version: 1.4.0 169
## Page 170

Core functions Syntax: METHOD Get Point: HRESULT VAR_INPUT n Idx : INT; st Point: REFERENCE TO ST_Look Up Ptp Point; END_VAR Return value Name Type Description Get Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Meeting n Idx INT The index of the interpolation point. st Point REFERENCE TO A reference to the variable that is to be updated with the ST_Look Up Ptp Point [} 173] requested point. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.5 Get Updated Point() A point of the lookup table is read back. Syntax: METHOD Get Updated Point: HRESULT VAR_INPUT n Idx : INT; st Point : REFERENCE TO ST_Look Up Ptp Point; END_VAR Return value Name Type Description Get Updated Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Meeting n Idx INT The index of the segment. st Point REFERENCE TO A reference to the variable that is to be updated with the ST_Look Up Ptp Point [} 173] requested point. 170 Version: 1.4.0 TF8560
## Page 171

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.6 Set Clamp Point() A segment of the clamping table is defined. Syntax: METHOD Set Clamp Point: HRESULT VAR_INPUT Idx: INT; st Clamp Point: ST_Look Up Clamping; END_VAR Return value Name Type Description Set Clamp Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the clamping point. st Clamp Point ST_Look Up Clamping [} 174] The clamping point to be used. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.7 Set Point() A point of the lookup table is defined. Syntax: METHOD Set Point: HRESULT VAR_INPUT n Idx : INT; st Point: REFERENCE TO ST_Look Up Ptp Point; END_VAR TF8560 Version: 1.4.0 171
## Page 172

Core functions Return value Name Type Description Set Point BOOL Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the segment. st Point REFERENCE TO A reference to the variable that is to be updated. ST_Look Up Ptp Point [} 173] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.21.8 Update Position() The target position of the point is changed after it is defined. Syntax: METHOD Update Position: HRESULT VAR_INPUT n Idx : INT; f Position: LREAL; b Swap : BOOL; END_VAR Return value Name Type Description Update Position BOOL Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the point to be updated. f Position LREAL The new target position. b Swap BOOL With b Swap=TRUE the direction related enables (Positive Only, Negative Only) are swapped. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 172 Version: 1.4.0 TF8560
## Page 173

Core functions 4.21.9 ST_Look Up Ptp Point Such a structure contains the information of a PTP point. Syntax: // ATTENTION: pointer arithmetics in arrays of this type // be sure sizeof is the same as distance in arrays // TYPE ST_Look Up Ptp Point : STRUCT Position: LREAL; Velocity: LREAL; Acceleration: LREAL; Deceleration: LREAL; Jerk: LREAL; Limiting: LREAL; // Pressure or torque Valid: BOOL; // 1 byte Positive Only: BOOL; // 1 byte Negative Only: BOOL; // 1 byte balign: ARRAY[4..8] OF BOOL; // 5 bytes alignment to 8 bytes END_STRUCT END_TYPE Parameter Name Type Description Position LREAL Target position of the PTP point. If there is another point in the motion profile, it will be blended with the Blending Low rule. Velocity LREAL Velocity with which the point is to be approached. Acceleration LREAL Acceleration with which the point is to be approached. If 0 is transferred, the default values of the axis are used. Deceleration LREAL Deceleration with which the point is to be approached. If 0 is transferred, the default values of the axis are used. Jerk LREAL Jerk with which the point is to be approached. If 0 is transferred, the default values of the axis are used. Limiting LREAL Limitation (torque or pressure) with which the point is to be approached. If 0 is transferred, the idle value of the axis is used. Valid BOOL Marks the point as valid for use with the next command. Positive Only BOOL The PTP movement should only be executed if the resulting movement will be in a positive direction. Negative Only BOOL The PTP movement should only be executed if the resulting movement will be in the negative direction. balign ARRAY [4..8] OF BOOL [INTERNAL] Adjustment to a byte length of the structure divisible by 8. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 173
## Page 174

Core functions 4.21.10 ST_Look Up Clamping Such a structure contains the information of a clamping point. Syntax: // ATTENTION: pointer arithmetics in arrays of this type // be sure sizeof is the same as distance in arrays // TYPE ST_Look Up Clamping : STRUCT Position: LREAL; Velocity: LREAL; Acceleration: LREAL; // velocity units per second Limiting: LREAL; // pressure or torque Limiting Ramp: LREAL; // limiting units per second Duration: LREAL; // seconds Valid: BOOL; // 1 byte Positive Only: BOOL; // 1 byte Negative Only: BOOL; // 1 byte balign: ARRAY[4..8] OF BOOL; // 5 bytes alignment to 8 bytes END_STRUCT END_TYPE Parameter Name Type Description Position LREAL Target position of the clamping point. Velocity LREAL Velocity with which the clamp feed should be moved. Acceleration LREAL Acceleration with which the clamping velocity should be moved. If 0 is transferred, the default values of the axis are used. Limiting LREAL Limitation (torque or pressure) with which the clamping is to be executed. If 0 is transferred, the idle value of the axis is used. Limiting Ramp LREAL Ramp to the limitation value [limitation unit / s]. Duration LREAL Duration over which the clamping point is to be executed. Notice Can be shortened by reaching the position of a subsequent clamping point. Valid BOOL Marks the clamping point as valid for use with the next command. Positive Only BOOL The clamping movement should only be carried out if the resulting movement will be in a positive direction. Negative Only BOOL The clamping movement should only be carried out if the resulting movement will be in the negative direction. balign ARRAY [4..8] OF BOOL [INTERNAL] Adjustment to a byte length of the structure divisible by 8. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 174 Version: 1.4.0 TF8560
## Page 175

Core functions 4.22 Ptp Look Up Not available via the axis interfaces This core function is not available via the axis interfaces. Direct access by the application is not required. This core function is used to store the definition of a complex multi-segment movement. Connection during startup The internal Ptp Look Up core function of the axis is connected to the Ptp core function at startup. Properties Name Type Access Description Number Of Points INT Get The number of motion points that the core function can store. Definition at the instantiation The capacity of the core function must be defined at instantiation. See Instantiation [} 15]. Methods Name Description Get Point() [} 176] A point from the lookup table is read back. Invalidate() All points in the lookup table are marked as invalid. Read Master() [} 176] A master value is determined that corresponds to the specified slave value. Set Point() [} 177] A point of the lookup table is defined. Update Position() In some applications, the target position of the segments must be changed after definition. [} 178] This method is used, for example, with transforming axes. Interfaces Type Description I_Ptp Look Up Standard interface on FB_Ptp Look Up. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 175
## Page 176

Core functions 4.22.1 Get Point() A point from the lookup table is read back. Syntax: METHOD Get Point: HRESULT VAR_INPUT n Idx : INT; st Point: REFERENCE TO ST_Look Up Ptp Point Intern; END_VAR Return value Name Type Description Get Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the point. Permissible range 1 ... Number Of Points. st Point REFERENCE TO A reference to the variable to be updated with the point data. ST_Look Up Ptp Point Intern Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.22.2 Read Master() This method finds a master value that corresponds to the specified slave value. Syntax: METHOD Read Master : HRESULT VAR_INPUT f Slave: LREAL; f Master: REFERENCE TO LREAL; END_VAR Return value Name Type Description Read Master HRESULT Return value with feedback on the success of the execution. 176 Version: 1.4.0 TF8560
## Page 177

Core functions Inputs Name Type Description f Slave LREAL The specified slave value. f Master REFERENCE TO A reference to the variable to be updated with the master position. LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.22.3 Set Point() A point of the lookup table is defined. Syntax: METHOD Set Point: HRESULT VAR_INPUT n Idx : INT; st Point: REFERENCE TO ST_Look Up Ptp Point; b Force : BOOL; END_VAR Return value Name Type Description Set Point HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the point. Permissible range 1 ... Number Of Points. st Point REFERENCE TO A reference to the variable to be updated with the point data. ST_Look Up Ptp Point [} 173] b Force BOOL If TRUE, the segment will be updated even if the axis executes a command. Notice Make sure that the axis does not execute a Ptp command. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 177
## Page 178

Core functions 4.22.4 Update Position() In some use cases, the target position of the segments must be modified after definition. This method is used for transforming axes, for example. Syntax: METHOD Update Position: HRESULT VAR_INPUT n Idx : INT; f Position: LREAL; b Swap : BOOL; b Force : BOOL; END_VAR Return value Name Type Description Update Position HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description n Idx INT The index of the point. Permissible range 1 ... Number Of Points. f Position LREAL The value to be used for the update. b Swap BOOL With b Swap=TRUE the direction related enables (Positive Only, Negative Only) are swapped. b Force BOOL If TRUE, the point will be updated even if the axis executes a command. Notice Make sure that the axis does not execute a Ptp command. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.23 Reset Not available via the axis interfaces This core function is not available via the axis interfaces. Direct access by the application is not required. This core function resets the error state of an axis in a controlled manner. The Do Reset() method can be accessed directly via the motion interface I_Motion Base and the interfaces inherited from it. Syntax: FUNCTION_BLOCK FB_Reset EXTENDS FB_Corefunction Feedback 178 Version: 1.4.0 TF8560
## Page 179

Core functions Methods Name Description Do Reset() Resets the error state of an axis. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Reset Standard interface on FB_Reset. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: i Axis Base. Do Reset(b Reset); Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.24 Set Position Core function is not supported by inverter axes This core function is not supported by inverter axes. Any use will report DEVICE_NOTINIT and trigger an error message. This Corefunction is used to change the actual position without physically moving the axis. It updates the offset of the position encoder function. Syntax: FUNCTION_BLOCK FB_Set Position EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Set Position Mode BOOL Get, Set Mode = TRUE causes the actual position to be changed by an amount specified as Target. Mode = FALSE causes the actual position to be set to the value specified as the target. This property can also be set using the Set Parameter() method. Target LREAL Get, Set The new position value is set here. This property can also be set using the Set Parameter() method. FB_Corefunction Feedback TF8560 Version: 1.4.0 179
## Page 180

Core functions Name Type Access Description Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Set Position Do Set Position() [} 181] A rising edge at the input b Execute triggers the setting of the position. Set Parameter() [} 181] Here the new position and the operation mode of the Corefunction are defined. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Set Position Standard interface on FB_Set Position. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: IF b Set Position THEN i Axis Base. Set Position. Mode := TRUE; // TRUE => Add relative i Axis Base. Set Position. Target := 12.34; // [mm] i Axis Base. Set Position. Do Set Position(TRUE); // revert command ELSIF i Axis Base. Set Position. Is Commanded THEN i Axis Base. Set Position. Do Set Position(FALSE); END_IF 180 Version: 1.4.0 TF8560
## Page 181

Core functions Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.24.1 Do Set Position() This method triggers the core function. Syntax: METHOD Do Set Position : HRESULT VAR_INPUT b Execute: BOOL; END_VAR Return value Name Type Description Do Set Position HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge starts the core function. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.24.2 Set Parameter() Here the new position and the operation mode of the core function are defined. TF8560 Version: 1.4.0 181
## Page 182

Core functions Syntax: METHOD Set Parameter : HRESULT VAR_INPUT f Position: LREAL; b Relative: BOOL; END_VAR Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description f Position LREAL The position value to be used is defined here. b Relative BOOL b Relative = TRUE causes the actual position to be changed by an amount specified as f Position. b Relative = FALSE causes the actual position to be set to the value specified as f Position. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.25 Stop This Corefunction is used to perform a stop operation using certain parameters. Syntax: FUNCTION_BLOCK FB_Stop EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Stop No Creeping BOOL Get, Set A TRUE in this property avoids the creep phase at the end of the stopping process of the hydraulics library. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. 182 Version: 1.4.0 TF8560
## Page 183

Core functions Name Type Access Description Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Stop Do Stop() [} 184] A rising edge triggers the stop. Set Parameter() [} 184] This method is used to define the dynamic parameters of the operation. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Stop Standard interface on FB_Stop. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: IF b Stop Axis THEN i Axis Base. Stop. Do Stop(TRUE); // revert command ELSIF i Axis Base. Stop. Is Commanded THEN i Axis Base. Stop. Do Stop(FALSE); END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 183
## Page 184

Core functions 4.25.1 Do Stop() This method is used to trigger the stop. Syntax: METHOD Do Stop : HRESULT VAR_INPUT b Execute: BOOL; END_VAR Return value Name Type Description Do Stop HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Execute BOOL A rising edge at this input triggers the stop. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.25.2 Set Parameter() This method is used to define the dynamic parameters of the operation. Syntax: METHOD Set Parameter: HRESULT VAR_INPUT f Deceleration: LREAL; f Jerk : LREAL; END_VAR 184 Version: 1.4.0 TF8560
## Page 185

Core functions Return value Name Type Description Set Parameter HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description f Deceleration LREAL The deceleration to be used. f Jerk LREAL The jerk to be used. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.26 Teach Position This core function is used for referencing analog encoder systems. Syntax: FUNCTION_BLOCK FB_Teach Position EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Teach Latch M LREAL Get, (Set) The recorded value when executing Do Teach M() in analog increments. Teach Latch PTeach LREAL Get, (Set) The recorded value when executing Do Teach P() in Latch P analog increments. Valid BOOL Get Two valid values were recorded. Methods Name Description Do Teach(b Execut Sets the axis to teaching mode. e) Do Teach M(b Execu Triggers the recording of the lower position. te) Do Teach P(b Execu Triggers the recording of the upper position. te) TF8560 Version: 1.4.0 185
## Page 186

Core functions Interfaces Type Description I_Teach Position Standard interface on FB_Teach Position. I_Teach Position Dev Extended interface with access to the setters of the latch properties. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 4.27 Teach Update This core function is used for referencing analog encoder systems. It is used after Teach Position [} 185] to calculate the measured values. Syntax: FUNCTION_BLOCK FB_Teach Update EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Set Upper Position BOOL Get, Set FALSE = The set position is used for the lower measured value. TRUE = The set position is used for the upper measured value. Methods Name Description Do Update(b Execu Calculates the measurement and parameters for encoder offset and scaling. te) Set Position(f Posi Configures the setpoint at one of the measuring points. tion) Set Stroke(f Strok Configures the stroke between the two measuring points. e) Interfaces Type Description I_Teach Update Standard interface on FB_Teach Updaten. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 186 Version: 1.4.0 TF8560
## Page 187

Core functions 4.28 Tool Adaption This Corefunction is used to convert between axis coordinates and tool working position. An offset and an optional inversion are taken into account. Syntax: FUNCTION_BLOCK FB_Tool Adaption Default EXTENDS FB_Corefunction Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Tool Adaption Default Inverting BOOL Get, Set A TRUE here signals a reversal of direction between axis and tool movement. Offset LREAL Get, Set The difference between axis and tool position. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. TF8560 Version: 1.4.0 187
## Page 188

Core functions Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Tool Adaption Default Axis Position() The axis position is determined for a given tool position. Axis Velocity() The axis velocity is determined for a given tool velocity. Tool Position() The tool position is determined for a given axis position. Tool Velocity() The tool velocity is determined for a given axis velocity. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Tool Adaption Standard interface on FB_Tool Adaption Default. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: i Axis Base. Tool Adaption. Inverting := FALSE; i Axis Base. Tool Adaption. Offset := 100.0; Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.29 Transformation Exclusive function for transforming axes This core function is only available for transforming axes. This core function manages the coupling of the two internal axes of a transforming axis. To this end, the transformation works internally with three translation paths: 1. Drive table - Drive position in a load position. ◦ The drive table itself consists of the points in the transferred table. ◦ Is used as the basis for generating the virtual encoder position of the load side. 2. Load table - load position in a drive position. ◦ Is the inverse function of the transferred load table. ◦ Is used in the full transformation for synchronization of the drive side. ◦ Used in the half transformation to convert the command positions ◦ Is linearized if Lower Limit and/or Upper Limit are within the load positions 3. Drive table - Reverse translation of an actuator position into a load position. ◦ Is used to check the validity of a target position without linearization. 188 Version: 1.4.0 TF8560
## Page 189

Core functions Syntax: FUNCTION_BLOCK FB_Nc Transformation EXTENDS FB_Trafo Corefunction Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Nc Transformation Is Updating BOOL Get TRUE as long as a previously passed table is being processed internally. Lower Limit LREAL Get, Set Lower limit from which the load table is linearized. Reversed LREAL Get, Set Reserved for future use. Table I_Camming Look Up Get, Set Interface for the transformation table to be transferred. [} 91] Upper Limit LREAL Get, Set Upper limit from which the load table is linearized. Valid BOOL Get The transferred table was loaded successfully. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Nc Transformation Get Slot() Reserves the index of a slot for asynchronous translation function and returns it. Release Slot(n Slot) Releases a reserved slot. Translate From Drive() Translates a drive position into a load position using the load table. [} 191] Translate From Load() [} 191] Reserved for future use. Translate To Drive() [} 192] Translates a load position into a drive position using the load table. Translate To Load() [} 193] Translates a drive position into a load position using the drive table. Update To Lin Load() [} 194] Translates a position in a linearized way, depending on the set Lower Limit properties. [INTERN] Prioritized execution of the Translate To Drive() method. Translate To Drive Prio() TF8560 Version: 1.4.0 189
## Page 190

Core functions Name Description [INTERN] Prioritized execution of the Translate To Load() method. Translate To Load Prio() Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Transformation Standard interface on FB_Nc Transformation. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // Get specific interface I_Axis Trafo Base from general interface I_Axis Base IF __QUERYINTERFACE(i Axis Base, i Axis Trafo Base) THEN CASE n State OF 0: // define transformation mechanics (e.g. a crank shaft) fb Crank Table Generator. Drive Arm := 50.0; // [mm] fb Crank Table Generator. Load Arm := 200.0; // [mm] fb Crank Table Generator. Height Offset := 0.0; // [mm] fb Crank Table Generator. Drive Low End := 0.0; // [°] fb Crank Table Generator. Drive High End := 180.0; // [°] // configure a table in which the generated characteristic curve is stored fb Camming Lookup. Equidistance := TRUE; fb Camming Lookup. Interpolation := E_Lookup Mode.e Second Order; fb Camming Lookup. Set Points(181); // Resultion => 1 point per degree [°] fb Crank Table Generator. Look Up := fb Camming Lookup; // Start table generation IF fb Crank Table Generator. Define Table() THEN n State := n State + 1; ELSE n State := -1; END_IF 1: // assign the caracteristics curve to the axis i Axis Trafo Base. Transformation. Table := fb Crank Table Generator; IF i Axis Trafo Base. Transformation. Valid THEN n State := n State + 1; ELSIF NOT i Axis Trafo Base. Transformation. Is Updating THEN n State := -1; END_IF 2: // transformation is ready to use. // Activate full transformation to linearise load side behavior i Axis Trafo Base. Synchronise := TRUE; -1: // error END_CASE ELSE // interface is not set to an instance deriving FB_Axis Trafo Base (e.g. FB_Axis Nc Trafo Base) b Incompatible := TRUE; END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 190 Version: 1.4.0 TF8560
## Page 191

Core functions 4.29.1 Translate From Drive() This method is used to calculate a load position using the transformation table of the load table. Syntax: METHOD Translate From Drive : HRESULT VAR_INPUT b Execute: BOOL; f Drive Position: LREAL; f Load Position: REFERENCE TO LREAL; n Slot: INT; END_VAR Return value Name Type Description Translate From Driv HRESULT Return value with feedback on the success of the execution. e Inputs Name Type Description b Execute BOOL A rising edge starts the asynchronous execution of this method. f Drive Position LREAL Drive position to be translated. f Load Position REFERENCE Translated load position. TO LREAL n Slot INT The slot to be used for the asynchronous query. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.29.2 Translate From Load() This method is used to calculate a drive position using the transformation table of the drive side. Syntax: METHOD Translate From Load : HRESULT VAR_INPUT b Execute: BOOL; f Load Position: LREAL; f Drive Position: REFERENCE TO LREAL; n Slot: INT; END_VAR TF8560 Version: 1.4.0 191
## Page 192

Core functions Return value Name Type Description Translate From Loa HRESULT Return value with feedback on the success of the execution. d Inputs Name Type Description b Execute BOOL A rising edge starts the asynchronous execution of this method. f Load Position LREAL Load position to be translated. f Drive Position REFERENCE Translated drive position. TO LREAL n Slot INT The slot to be used for the asynchronous query. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.29.3 Translate To Drive() This method is used to calculate a drive position using the transformation table of the load table. Syntax: METHOD Translate To Drive : HRESULT VAR_INPUT b Execute: BOOL; f Load Position: LREAL; f Load Velocity: LREAL; f Drive Position: REFERENCE TO LREAL; f Drive Velocity: REFERENCE TO LREAL; n Slot: INT; END_VAR Return value Name Type Description Translate To Drive HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description b Execute BOOL A rising edge starts the asynchronous execution of this method. f Load Position LRELA Load position to be translated. f Load Velocity LREAL Load velocity to be translated. f Drive Position REFERENCE Translated load position. TO LREAL 192 Version: 1.4.0 TF8560
## Page 193

Core functions Name Type Description f Drive Velocity REFERENCE Translated load velocity. TO LREAL n Slot INT The slot to be used for the asynchronous query. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.29.4 Translate To Load() This method is used to calculate a load position via the transformation table of the drive side. Syntax: METHOD Translate To Load : HRESULT VAR_INPUT b Execute: BOOL; f Drive Position: LREAL; f Drive Velocity: LREAL; f Load Position: REFERENCE TO LREAL; f Load Velocity: REFERENCE TO LREAL; n Slot: INT; END_VAR Return value Name Type Description Translate To Load HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description b Execute BOOL A rising edge starts the asynchronous execution of this method. f Drive Position LREAL Drive position to be translated. f Drive Velocity LREAL Drive velocity to be translated. f Load Position REFERENCE Translated load position. TO LREAL f Load Velocity REFERENCE Translated load velocity. TO LREAL n Slot INT The slot to be used for the asynchronous query. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 193
## Page 194

Core functions 4.29.5 Update To Lin Load() This method is used to translate a position in a linearized way, depending on the set Lower Limit property. Syntax: METHOD Update To Lin Load : LREAL VAR_INPUT f Drive Position: LREAL; f Load Position: LREAL; END_VAR Return value Name Type Description Update To Lin Load LREAL Linearized load position. Inputs Name Type Description f Drive Position LREAL Current drive position. f Load Position LREAL Current load position. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 4.30 Tuning Exclusive function for actuators This core function is only available for actuators. This core function is used to automatically optimize an actuator. Syntax: FUNCTION_BLOCK FB_Actuator Tuning EXTENDS FB_Corefunction Feedback Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Actuator Tuning Timeout Factor LREAL Get, Set Factor (multiplier) for determining the timeout of the movement time. 194 Version: 1.4.0 TF8560
## Page 195

Core functions Name Type Access Description FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Actuator Tuning Do Abort(b Execute) Cancels the current procedure. Do Tune Timeout(b Execute Starts a sequence of commands to the end positions of the actuator and ) measures the time of the movement. Notice Make sure that the connected end positions can be reached mechanically. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Actuator Tuning Standard interface on FB_Actuator Tuning. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: // Get specific interface I_Actuator Base from general interface I_Motion Base IF __QUERYINTERFACE(i Motion Base, i Actuator Base) THEN CASE n State OF 0: // Start the tuning i Actuator Base. Tuning. Do Tune Timeout(TRUE); 1: // observe or abort IF i Actuator Base. Tuning. Failed State THEN n State := -1; TF8560 Version: 1.4.0 195
## Page 196

Core functions ELSIF i Actuator Base. Tuning. Done State THEN n State := n State + 1; ELSIF b Abort Tuning THEN i Actuator Base. Tuning. Do Abort(TRUE); n State := n State + 2; END_IF 2, // done 3, // aborted -1: // error i Actuator Base. Tuning. Do Abort(FALSE); i Actuator Base. Tuning. Do Tune Timeout(FALSE); END_CASE ELSE // interface is not set to an instance of FB_Actuator Base b Incompatible := TRUE; END_IF Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 4.31 Velocity Feed This core function is used to start the axis at a commanded velocity without a defined target position. Properties Name Type Access Description Init State BOOL Get, Set The core function is not completely and successfully initialized. FB_Velocity Feed Gear Factor LREAL Get, Set The factor with which to respond to Guiding Value. Guiding Value LREAL Get, Set The commanded velocity. Limiting LREAL Get, Set Setpoint for the limitation (e.g., torque, pressure) during command execution. FB_Corefunction Feedback Aborted State BOOL Get, Set Signals the abort of a command by another Corefunction. Busy State BOOL Get, Set Signals the active execution of a command. Done State BOOL Get, Set Signals the successful execution of a command. Idle State BOOL Get, Set The Corefunction is ready for operation and commandable. Is Commanded BOOL Get Signals the pending of a command. FB_Corefunction Failed State BOOL Get, Set If Is Activated is TRUE at the same time: Signals the failure of an accepted command. If Is Activated is FALSE at the same time: Signals the rejection of a command. Has Feedback BOOL Get The core function has responded to a pending command. 196 Version: 1.4.0 TF8560
## Page 197

Core functions Name Type Access Description Is Activated BOOL Get The core function has an accepted command pending. Is Local Cmd BOOL Get Signals that the axis is assigned with a command of this core function. Ready State BOOL Get, Set The Corefunction is ready for operation, but is not commandable at this time. Possible reasons are: - The axis is not enabled. - Another Corefunction is active. - The Corefunction does not support any commands. Decouple the axis A Gear Factor of 0.0 will effectively decouple the axis from the Guiding Value. Move in the opposite direction A negative Gear Factor causes the axis to move in the opposite direction. Methods Name Description [INTERN] Cyclic() This method is called cyclically by the axis. FB_Velocity Feed Do Feed() [} 198] A rising edge triggers the core function. Interfaces Type Description I_Corefunction Standard interface on FB_Corefunction. I_Velocity Feed Standard interface on FB_Velocity Feed. I_Corefunction Feedback Standard interface on FB_Corefunction Feedback. Example: IF b Cmd Velo Feed THEN i Axis Base. Velocity Feed. Gear Factor := 1.0; i Axis Base. Velocity Feed. Guiding Value := 20.0; // [mm/s] i Axis Base. Velocity Feed. Do Feed(TRUE); ELSIF i Axis Base. Velocity Feed. Is Commanded THEN i Axis Base. Velocity Feed. Do Feed(FALSE); END_IF Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) TF8560 Version: 1.4.0 197
## Page 198

Core functions 4.31.1 Do Feed() A rising edge at b Enable triggers the core function, while a falling edge causes it to stop and return to idle. Syntax: METHOD Do Feed : HRESULT VAR_INPUT b Enable: BOOL; END_VAR Return value Name Type Description Do Feed HRESULT See below The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_BUSY 0x9B00 0708 The axis is busy performing another core function. DEVICE_INVALID 0x9B00 0706 Not all data and parameters for the core function are available DATA and valid. DEVICE_INVALIDS 0x9B00 0712 The state of the axis does not allow the execution. TATE DEVICE_NOTINIT 0x9B00 0718 The core function is not or not completely initialized. NOERR 0x1B00 0000 The core function has accepted the command. Inputs Name Type Description b Enable BOOL A rising edge triggers the core function, while a falling edge causes it to stop and return to idle. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 198 Version: 1.4.0 TF8560
## Page 199

I/O 5 I/O The integration of input and output signals in Twin CAT is realized via mapping. For this purpose, it is relatively simple to define a variable as the carrier of I/O information. When transferring this information, however, the specific data type of the information must be known. To ensure that the interface defined in the Twin CAT 3 Plastic Technology Functions can work independently of the data type, the library creates general I/O classes (FBs) and specific classes derived from them to ensure maximum flexibility and expandability. With the generalization of the I/O type, other tasks such as the processing of diagnostic information can also be implemented. 5.1 Base (Abstract) 5.1.1 Io Base This class is the basis for all I/O elements. It defines a rudimentary basic scope of methods. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Io Base EXTENDS FB_Message Base Methods Name Description Cyclic() Cycle method Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.1.1 Get Process Value() This method is used to read the terminal-specific input/output value. TF8560 Version: 1.4.0 199
## Page 200

I/O Syntax: METHOD Get Process Value : HRESULT VAR_INPUT st Value: REFERENCE TO ST_Flex Value; END_VAR Return value Name Type Description Get Process Val HRESULT Return value with feedback on the success of the execution. ue The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Value REFERENCE TO Reference to a variable to which the input/output value is to be ST_Flex Value [} 244] written. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.1.2 Set Process Value() This method is used to write the terminal-specific input/output value. Syntax: METHOD Set Process Value : HRESULT VAR_INPUT st Value: REFERENCE TO ST_Flex Value; END_VAR Return value Name Type Description Set Process Val HRESULT Return value with feedback on the success of the execution. ue The return value of the method is of type HRESULT. The following return values are to be expected. 200 Version: 1.4.0 TF8560
## Page 201

I/O E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Value REFERENCE TO Reference to a variable whose value is to be set to the input/output ST_Flex Value [} 244] value. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.2 Io Ec This class is the basis for Ether CAT-based I/O elements. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Io Ec EXTENDS FB_Io Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Ec Misses UINT Get Number of Ether CAT diagnostic errors in a row TF8560 Version: 1.4.0 201
## Page 202

I/O Methods Name Description Cyclic() Cycle method Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 202] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 203] Get Process Value() Reads the terminal-specific input/output value. [} 202] Set Process Value() Writes the terminal-specific input/output value. [} 203] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.2.1 Get Process Io Status() This method is used to read the Ether CAT status of an I/O element. Syntax: METHOD Get Process Io Status : HRESULT VAR_INPUT b Wc State: REFERENCE TO BOOL; b Toggle: REFERENCE TO BOOL; n Info Data State: REFERENCE TO UINT; s Ads Addr: REFERENCE TO AMSADDR; END_VAR Return value Name Type Description Get Process Io St HRESULT Return value with feedback on the success of the execution. atus The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND 202 Version: 1.4.0 TF8560
## Page 203

I/O E_Ads Err Return value Cause DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description b Wc State REFERENCE TO Reference to a variable to which the Wc State is to be written. BOOL b Toggle REFERENCE TO Reference to a variable to which the toggle is to be written. BOOL n Info Data State REFERENCE TO Reference to a variable to which the Info Data state is to be written. UINT s Ads Addr REFERENCE TO Reference to a variable to which the Ads Addr is to be written. AMSADDR Notice Only available with Io Ec Ads [} 204]. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.2.2 Set Process Io Status() This method is used to write the Ether CAT status of an I/O element. Syntax: METHOD Set Process Io Status : HRESULT VAR_INPUT b Wc State: BOOL; b Toggle: BOOL; n Info Data State: UINT; s Ads Addr: AMSADDR; END_VAR Return value Name Type Description Set Process Io St HRESULT Return value with feedback on the success of the execution. atus The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND TF8560 Version: 1.4.0 203
## Page 204

I/O E_Ads Err Return value Cause DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description b Wc State BOOL Wc State to be written to the input variable. b Toggle BOOL Toggle to be written to the input variable. n Info Data State UINT Info Data State to be written to the input variable. s Ads Addr AMSADDR Ads Addr to be written to the input variable. Notice Only available with Io Ec Ads [} 204]. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.3 Io Ec Ads This class is the basis for Ether CAT-based I/O elements with ADS interface. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Io Ec Ads EXTENDS FB_Io Ec I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Methods Name Description Cyclic() Cycle method 204 Version: 1.4.0 TF8560
## Page 205

I/O Name Description Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.4 Input Base This class is the basis for I/O input elements. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Input Base EXTENDS FB_Io Ec Ads I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). TF8560 Version: 1.4.0 205
## Page 206

I/O Properties Name Type Access Description Input Scale DINT Get, Set Scale for scaling the input value. Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the input element. [} 206] Set Channel State() Writes the status word of the input element. [} 207] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Base Standard interface on FB_Input Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.4.1 Get Channel State() This method is used to read the channel state of an I/O element. Syntax: METHOD Get Channel State : HRESULT VAR_INPUT st Device State: REFERENCE TO ST_Flex Value; END_VAR 206 Version: 1.4.0 TF8560
## Page 207

I/O Return value Name Type Description Get Channel Sta HRESULT Return value with feedback on the success of the execution. te The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Device State REFERENCE TO Reference to a variable to which the device state is to be written. ST_Flex Value [} 244] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.1.4.2 Set Channel State() This method is used to write the channel state of an I/O element. Syntax: METHOD Set Channel State : HRESULT VAR_INPUT st Device State: REFERENCE TO ST_Flex Value; END_VAR Return value Name Type Description Set Channel Stat HRESULT Return value with feedback on the success of the execution. e The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND TF8560 Version: 1.4.0 207
## Page 208

I/O E_Ads Err Return value Cause DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Device State REFERENCE TO Variable with the state to be written to the input variable. ST_Flex Value [} 244] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.1.5 Output Base This class is the basis for I/O output elements. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Output Base EXTENDS FB_Io Ec Ads I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the output element. [} 209] 208 Version: 1.4.0 TF8560
## Page 209

I/O Name Description Get Controlword() Reads the control word of the output element. [} 210] Get Process Feedbac Reads the check signal of the output element. k() [} 211] Set Channel State() Writes the channel state of the output element. [} 212] Set Controlword() Writes the control word of the output element. [} 213] Set Process Feedback Writes the check signal of the output element. () [} 213] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Output Base Standard interface on FB_Output Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.1.5.1 Get Channel State() This method is used to read the channel state of an I/O element. Syntax: METHOD Get Channel State : HRESULT VAR_INPUT st Device State: REFERENCE TO ST_Flex Value; END_VAR TF8560 Version: 1.4.0 209
## Page 210

I/O Return value Name Type Description Get Channel Sta HRESULT Return value with feedback on the success of the execution. te The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Device State REFERENCE TO Reference to a variable to which the device state is to be written. ST_Flex Value [} 244] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.1.5.2 Get Controlword() This method is used to read the control word of an I/O output element. Syntax: METHOD Get Controlword : HRESULT VAR_INPUT n Drive Control Word: REFERENCE TO UINT; END_VAR Return value Name Type Description Get Controlword HRESULT Return value with feedback on the success of the execution. The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND 210 Version: 1.4.0 TF8560
## Page 211

I/O E_Ads Err Return value Cause DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description n Drive Control W REFERENCE TO Reference to a variable to which the channel state is to be written. ord UINT Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.1.5.3 Get Process Feedback() This method is used to read the check signal of an I/O output element. Syntax: METHOD Get Process Feedback : HRESULT VAR_INPUT st Value: REFERENCE TO ST_Flex Value; END_VAR Return value Name Type Description Get Process Fee HRESULT Return value with feedback on the success of the execution. dback The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. TF8560 Version: 1.4.0 211
## Page 212

I/O Inputs Name Type Description st Value REFERENCE TO Reference to a variable to which the check value is to be written. ST_Flex Value [} 244] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.1.5.4 Set Channel State() This method is used to write the channel state of an I/O element. Syntax: METHOD Set Channel State : HRESULT VAR_INPUT st Device State: REFERENCE TO ST_Flex Value; END_VAR Return value Name Type Description Set Channel Stat HRESULT Return value with feedback on the success of the execution. e The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Device State REFERENCE TO Variable with the state to be written to the input variable. ST_Flex Value [} 244] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 212 Version: 1.4.0 TF8560
## Page 213

I/O 5.1.5.5 Set Controlword() This method is used to write the control word of an I/O output element. Syntax: METHOD Set Controlword : HRESULT VAR_INPUT n Drive Control Word: UINT; END_VAR Return value Name Type Description Set Controlword HRESULT Return value with feedback on the success of the execution. The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description n Drive Control W UINT Control word to be written to the input variable. ord Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.1.5.6 Set Process Feedback() This method is used to write the check signal of an I/O output element. Syntax: METHOD Set Process Feedback : HRESULT VAR_INPUT st Value: REFERENCE TO ST_Flex Value; END_VAR TF8560 Version: 1.4.0 213
## Page 214

I/O Return value Name Type Description Set Process Fee HRESULT Return value with feedback on the success of the execution. dback The return value of the method is of type HRESULT. The following return values are to be expected. E_Ads Err Return value Cause DEVICE_ERROR 0x9B00 0700 The I/O element is in error state. DEVICE_SYMBOL 0x9B00 0710 The transferred reference is invalid. NOTFOUND DEVICE_INCOMP 0x9B00 070E The variable type of the transferred structure does not match the ATIBLE I/O element. DEVICE_SRVNOT 0x1B00 0701 Function is not supported by the I/O element. SUPP Notice This return value is not marked as an error! DEVICE_NOERR 0x1B00 000 Execution was successful. Inputs Name Type Description st Value REFERENCE TO Variable with the check signal that is to be written to the input ST_Flex Value [} 244] variable. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.2 Analog 5.2.1 Input Analog16 This class can be used for a 16-bit analog input element. Syntax: FUNCTION_BLOCK FB_Input Analog16 EXTENDS FB_Input Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Analog Value INT Input Numerical signed analog input value. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. 214 Version: 1.4.0 TF8560
## Page 215

I/O Name Type Direction Description Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Input Scale DINT Get, Set Scale for scaling the input value. Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the input element. [} 206] Set Channel State() Writes the status word of the input element. [} 207] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Analog16 Standard interface on FB_Input Analog16. I_Input Base Standard interface on FB_Input Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.2.2 Input Analog16Status This class can be used for a 16-bit analog input element with additional status information. TF8560 Version: 1.4.0 215
## Page 216

I/O The following are currently explicitly supported: • EL3255 Syntax: FUNCTION_BLOCK FB_Input Analog16Status EXTENDS FB_Input Analog16 I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Status U_Input Analog Input Detailed status value for a single analog input. 16_Status [} 217] Analog Value INT Input Numerical signed analog input value. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Input Scale DINT Get, Set Scale for scaling the input value. Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the input element. [} 206] Set Channel State() Writes the status word of the input element. [} 207] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Analog16Status Standard interface on FB_Input Analog16Status. I_Input Analog16 Standard interface on FB_Input Analog16. I_Input Base Standard interface on FB_Input Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. 216 Version: 1.4.0 TF8560
## Page 217

I/O Type Description I_Io Ec Standard interface on FB_Io Ec. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 5.2.2.1 U_Input Analog16_Status Union for decoding an analog input status word. Syntax: TYPE U_Input Analog16_Status : UNION {attribute 'tc_no_symbol'} w: WORD; {attribute 'tc_no_symbol'} el3255: ST_Input Analog16_Status_EL3255; END_UNION END_TYPE Values Name Type Description w WORD Word as a complete data type. el3255 ST_Input Analog16_Status_EL3255 [} 217] Breakdown of the word into bits of an EL3255. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 5.2.2.2 ST_Input Analog16_Status_EL3255 Structure for the breakdown of an analog input channel status of an EL3255. Syntax: TYPE ST_Input Analog16_Status_EL3255 : STRUCT Underrange: BIT; Overrange: BIT; Limit1: ST_Input Analog16_Status_Limit; Limit2: ST_Input Analog16_Status_Limit; Error: BIT; Reserve_7: BIT; Reserve_8: BIT; Reserve_9: BIT; Reserve_10: BIT; Reserve_11: BIT; Reserve_12: BIT; Sync Error: BIT; Tx PDOState: BIT; Tx PDOToggle: BIT; END_STRUCT END_TYPE Bits Name Offset Description Underrange 0 The electrical measuring range was undershot. TF8560 Version: 1.4.0 217
## Page 218

I/O Name Offset Description Overrange 1 The electrical measuring range has been exceeded. Limit 1 2 Evaluation of Limit 1 (see EL3255 documentation). Limit 2 4 Evaluation of Limit 2 (see EL3255 documentation). Error 6 General measurement error Sync Error 13 Synchronization error with "Distributed Clocks". Tx PDOState 14 Validity of the process data, FALSE = valid. Tx PDOToggle 15 Changing bit for each process data exchange. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 5.2.3 Input Analog32 This class can be used for a 32-bit analog input element. Syntax: FUNCTION_BLOCK FB_Input Analog32 EXTENDS FB_Input Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Analog Value DINT Input Numerical signed analog input value. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Input Scale DINT Get, Set Scale for scaling the input value. Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the input element. [} 206] Set Channel State() Writes the status word of the input element. [} 207] 218 Version: 1.4.0 TF8560
## Page 219

I/O Name Description Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Analog32 Standard interface on FB_Input Analog32. I_Input Base Standard interface on FB_Input Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.2.4 Output Analog16 This class can be used for a 16-bit analog output element. Syntax: FUNCTION_BLOCK FB_Output Analog16 EXTENDS FB_Output Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Analog Value INT Output Numerical signed analog output value. Feedback INT Input Numerical signed check value for the analog output value. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). TF8560 Version: 1.4.0 219
## Page 220

I/O Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the output element. [} 206] Get Controlword() Reads the control word of the output element. [} 210] Get Process Feedbac Reads the check signal of the output element. k() [} 211] Set Channel State() Writes the channel state of the output element. [} 207] Set Controlword() Writes the control word of the output element. [} 213] Set Process Feedback Writes the check signal of the output element. () [} 213] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Output Analog16 Standard interface on FB_Output Analog16. I_Output Base Standard interface on FB_Output Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.3 Co E 5.3.1 Input Co E_Polling This class implements a virtual input for an asynchronous Co E value from an Ether CAT device that is read via ADS. This function can be used for cyclic reading of internal terminal information (such as the internal temperature). 220 Version: 1.4.0 TF8560
## Page 221

I/O Syntax: FUNCTION_BLOCK FB_Input Co E_Polling EXTENDS FB_Io Base Properties Name Type Access Description Input Scale DINT Get, Set Reserved (compatibility with I_Input Base) FB_Input Co E_Polling Config I_Co EParameter Get Information on the parameter to be read: address, data type, memory type, validation [} 262] Device I_Io Ec Ads [} 204] Get, Set The ADS address information is used from the device transferred here. Polling Interval LREAL Get, Set Time interval at which the asynchronous value is updated. Methods Name Description Cyclic() Cycle method FB_Input Co E_Polling Get Channel State() Reserved (compatibility with I_Input Base) [} 206] Set Channel State() Reserved (compatibility with I_Input Base) [} 207] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 202] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 203] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Co E_Polling Standard interface on FB_Input Co E_Polling. I_Input Base Compatible interface for general inputs. I_Io Ec Ads Standard interfaces for ADS-capable I/O devices. I_Io Ec Standard interfaces for Ether CAT-capable I/O devices. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) Also see about this 2 Get Process Io Status() [} 202] 2 Set Process Io Status() [} 203] TF8560 Version: 1.4.0 221
## Page 222

I/O 5.3.2 Input Co E406 This class can be used for a DS406 based encoder. In this context, the term Co E (CAN over Ether CAT) refers to the transmission of the Ci A DS406 protocol via Ether CAT. Syntax: FUNCTION_BLOCK FB_Input Co E406 EXTENDS FB_Input Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Counter Value DINT Input Counter value of the encoder. Device State WORD Input Status word of the encoder. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Input Scale DINT Get, Set Scale for scaling the input value. Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the input element. [} 206] Set Channel State() Writes the status word of the input element. [} 207] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] 222 Version: 1.4.0 TF8560
## Page 223

I/O Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Co E406 Standard interface on FB_Input Co E406. I_Input Base Standard interface on FB_Input Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.3.3 Output Co E408 This class can be used for a DS408 based hydraulic valve. In this context, the term Co E (CAN over Ether CAT) refers to the transmission of the Ci A DS408 protocol via Ether CAT. Syntax: FUNCTION_BLOCK FB_Output Co E408 EXTENDS FB_Output Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Control Word U_Co E408_Cont Output Union for the control word of the valve. rol Word [} 224] Spool Set Value INT Output Setpoint for the valve coil. Status Word U_Co E408_Stat Input Union for the status word of the valve. us Word [} 225] Spool Actual Value INT Input Check signal for the position of the valve coil. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Methods Name Description Cyclic() Cycle method TF8560 Version: 1.4.0 223
## Page 224

I/O Name Description Get Channel State() Reads the status word of the output element. [} 206] Get Controlword() Reads the control word of the output element. [} 210] Get Process Feedbac Reads the check signal of the output element. k() [} 211] Set Channel State() Writes the channel state of the output element. [} 207] Set Controlword() Writes the control word of the output element. [} 213] Set Process Feedback Writes the check signal of the output element. () [} 213] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Output Co E408 Standard interface on FB_Output Co E408. I_Output Base Standard interface on FB_Output Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.3.3.1 U_Co E408_Control Word Union for decoding a Co E408 control word Syntax: TYPE U_Co E408_Control Word : UNION {attribute 'tc_no_symbol'} bits: ST_Co E408_Control Word; {attribute 'tc_no_symbol'} w: WORD; END_UNION END_TYPE 224 Version: 1.4.0 TF8560
## Page 225

I/O Values Name Type Description bits ST_Co E408_Control Word [} 225] Breakdown of the word into bits. w WORD Word as a complete data type. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.3.3.2 ST_Co E408_Control Word Structure for breaking down a Co E408 control word. Syntax: TYPE ST_Co E408_Control Word : STRUCT Disable: BIT; Hold Enable: BIT; Device Mode Active Enable: BIT; Reset: BIT; END_STRUCT END_TYPE Bits Name Offset Description Disable 0 Disable valve. Hold Enable 1 Enable valve hold mode. Device Mode Activ 2 Generally enable the valve. e Enable Reset 3 Reset error state. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.3.3.3 U_Co E408_Status Word Union for decoding a Co E408 status word. Syntax: TYPE U_Co E408_Status Word : UNION {attribute 'tc_no_symbol'} bits: ST_Co E408_Status Word; {attribute 'tc_no_symbol'} w: WORD; END_UNION END_TYPE Values Name Type Description bits ST_Co E408_Status Word [} 226] Breakdown of the word into bits. w WORD Word as a complete data type. TF8560 Version: 1.4.0 225
## Page 226

I/O Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.3.3.4 ST_Co E408_Status Word Structure for the breakdown of a Co E408 status word. Syntax: TYPE ST_Co E408_Status Word : STRUCT Disabled: BIT; Hold Enabled: BIT; Device Mode Active Enabled: BIT; Ready: BIT; END_STRUCT END_TYPE Bits Name Offset Description Disabled 0 Valve is disabled. Hold Enabled 1 Valve hold mode is enabled. Device Mode Activ 2 Valve is generally enabled. e Enabled Ready 3 Device is ready to operate. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.3.4 Output Co E408_P This class is an extension of the Co E408-based valve with integrated pressure measurement. Syntax: FUNCTION_BLOCK FB_Output Co E408_P EXTENDS FB_Output Co E408 I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Pressure Value INT Input Actual pressure value of the internal valve pressure measurement. 226 Version: 1.4.0 TF8560
## Page 227

I/O Name Type Direction Description Control Word U_Co E408_Cont Output Union for the control word of the valve. rol Word [} 224] Spool Set Value INT Output Setpoint for the valve coil. Status Word U_Co E408_Stat Input Union for the status word of the valve. us Word [} 225] Spool Actual Value INT Input Check signal for the position of the valve coil. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Pressure I_Input Base Get Interface for integrated pressure measurement Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the output element. [} 206] Get Controlword() Reads the control word of the output element. [} 210] Get Process Feedbac Reads the check signal of the output element. k() [} 211] Set Channel State() Writes the channel state of the output element. [} 207] Set Controlword() Writes the control word of the output element. [} 213] Set Process Feedback Writes the check signal of the output element. () [} 213] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Output Co E408 Standard interface on FB_Output Co E408. I_Output Base Standard interface on FB_Output Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. TF8560 Version: 1.4.0 227
## Page 228

I/O Type Description I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.4 Digital 5.4.1 Io Digital This class is the basis for digital I/O elements. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Io Digital EXTENDS FB_Io Base Properties Name Type Access Description Delay Off LREAL Get, Set Delay [s] of a falling edge of the digital signal. Delay On LREAL Get, Set Delay [s] of a rising edge of the digital signal. In BOOL Get, Set Digital input value. Invert BOOL Get, Set Inverts the interpretation of the input value. Q BOOL Get Interpreted input value. QF BOOL Get Falling edge from Q. QR BOOL Get Rising edge from Q. Methods Name Description Cyclic() Cycle method Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Io Ec Standard interface on FB_Io Ec. 228 Version: 1.4.0 TF8560
## Page 229

I/O Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.4.2 Input Digital This class is used for digital input signals. Syntax: FUNCTION_BLOCK FB_Input Digital EXTENDS FB_Io Digital I/O variables Name Type Direction Description Inp BOOL Input Digital input signal Properties Name Type Access Description Delay Off LREAL Get, Set Delay [s] of a falling edge of the digital signal. Delay On LREAL Get, Set Delay [s] of a rising edge of the digital signal. In BOOL Get, Set Digital input value. Invert BOOL Get, Set Inverts the interpretation of the input value. Q BOOL Get Interpreted input value. QF BOOL Get Falling edge from Q. QR BOOL Get Rising edge from Q. Methods Name Description Cyclic() Cycle method Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Base Compatible standard interface for inputs. This class implements hidden placeholders for compatibility. I_Input Digital Standard interface on FB_Input Digital. I_Io Ec Standard interface on FB_Io Ec. TF8560 Version: 1.4.0 229
## Page 230

I/O Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.4.3 Input Digital Cam This class is used for the digital feedback of an FB_Axis Hydraulic Base [} 17]. Syntax: FUNCTION_BLOCK FB_Input Digital Cam EXTENDS FB_Io Base Properties Name Type Access Description Break M I_Input Digital [} 229] Get, Set Digital input element for a brake sensor in the negative direction on the axis track. Break P I_Input Digital [} 229] Get, Set Digital input element for a brake sensor in the positive direction on the axis track. Target M I_Input Digital [} 229] Get, Set Digital input element for the end position in the negative direction on the axis track. Target P I_Input Digital [} 229] Get, Set Digital input element for the end position in the positive direction on the axis track. Methods Name Description Cyclic() Cycle method Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Coding of the st Value for FB_Input Digital Cam. Get|Set Process Value() The value for the ST_Flex Value of the Input Digital Cam input element is coded bit by bit as BYTE: Bit 0: Target P Bit 1: Break P Bit 2: Break M Bit 3: Target P Bit 4: Target P Connected Bit 5: Break P Connected Bit 6: Break M Connected Bit 7 Target M Connected Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Digital Cam Standard interface on FB_Input Digital Cam. 230 Version: 1.4.0 TF8560
## Page 231

I/O Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 5.4.4 Output Digital This class is used for digital output signals. Syntax: FUNCTION_BLOCK FB_Output Digital EXTENDS FB_Io Digital I/O variables Name Type Direction Description Out BOOL Output Digital output signal. Properties Name Type Access Description Delay Off LREAL Get, Set Delay [s] of a falling edge of the digital signal. Delay On LREAL Get, Set Delay [s] of a rising edge of the digital signal. In BOOL Get, Set Digital input value. Invert BOOL Get, Set Inverts the interpretation of the input value. Q BOOL Get Interpreted input value. QF BOOL Get Falling edge from Q. QR BOOL Get Rising edge from Q. Methods Name Description Cyclic() Cycle method Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Output Base Compatible standard interface for outputs. This class implements hidden placeholders for compatibility. I_Output Digital Standard interface on FB_Output Digital. I_Io Ec Standard interface on FB_Io Ec. TF8560 Version: 1.4.0 231
## Page 232

I/O Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.5 Serial 5.5.1 Input Ssi This class can be used for an SSI based encoder. Syntax: FUNCTION_BLOCK FB_Input Ssi EXTENDS FB_Input Base I/O variables Name Type Direction Description Wc State BIT Input Working Counter State Counter Value DINT Input Counter value of the encoder. Device State WORD Input Status word of the encoder. Ads Addr AMSADDR Input ADS address of the I/O element for asynchronous communication. Toggle BIT Input Bit switching with the update rate of the mapping. Info Data State UINT Input Numerical information on the state of the Ether CAT slave (see State). Properties Name Type Access Description Input Scale DINT Get, Set Scale for scaling the input value. Methods Name Description Cyclic() Cycle method Get Channel State() Reads the status word of the input element. [} 206] Set Channel State() Writes the status word of the input element. [} 207] Get Process Io Status( Reads the Ether CAT status of the input/output element. ) [} 199] Set Process Io Status() Writes the Ether CAT status of the input/output element. [} 200] 232 Version: 1.4.0 TF8560
## Page 233

I/O Name Description Get Process Value() Reads the terminal-specific input/output value. [} 199] Set Process Value() Writes the terminal-specific input/output value. [} 200] Interfaces Type Description I_Io Base Standard interface on FB_Io Base. I_Input Ssi Standard interface on FB_Input Ssi. I_Input Base Standard interface on FB_Input Base. I_Io Ec Ads Standard interface on FB_Io Ec Ads. I_Io Ec Standard interface on FB_Io Ec. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6 Device (inverter) 5.6.1 Inv Device Base This class is the basis for inverter I/O elements. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Inv Device Base Properties Name Type Access Description Act Velocity LREAL Get Current velocity of the inverter motor. Connected BOOL Get [INTERNAL] Class has been connected to an axis. Enable N BOOL Get, Set Negative directional enable of the axis. Enable P BOOL Get, Set Positive directional enable of the axis. Enable Power BOOL Get, Set Power enable of the axis. Enable Supply BOOL Get, Set Supply enable of the axis. Error BOOL Get Inverter is in error state. Error ID UDINT Get Error code of the inverter error. Load LREAL Get Moad of the inverter. Power Enabled BOOL Get Feedback of the power enable of the inverter. TF8560 Version: 1.4.0 233
## Page 234

I/O Name Type Access Description Reset BOOL Get, Set Reset signal of the axis. Reseted BOOL Get, Set Feedback of the successful reset. Set Velocity LREAL Get, Set Set velocity of the axis. Stop BOOL Get, Set Stop signal of the axis for possible stop functions of the inverter. Stopped BOOL Get Feedback of the successful stop of the inverter. Supply Enabled BOOL Get Feedback of the supply enable of the inverter. Direction of the signals The properties essentially form the interface between the inverter and the inverter axis. • Methods without a setter are usually feedback signals from the inverter to the axis. • Methods with setters are command signals from the axis to the inverter. Methods Name Description Cyclic() Cycle method Connect() Connects the inverter device to the axis. Go Error() Simulates an error of the inverter device. Interfaces Type Description I_Inv Device Base Standard interface on FB_Inv Device Base Defines the interface to the axis. I_Inv Device Base Dev Extended interface on FB_Inv Device Base. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.2 Inv Device Ec This class is the basis for inverters with Ether CAT status. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Inv Device Ec EXTENDS FB_Inv Device Base 234 Version: 1.4.0 TF8560
## Page 235

I/O I/O variables Name Type Direction Description Ec Status FB_Io Ec Ads Uni Input Ether CAT status of the inverter. [} 204] Properties Name Type Access Description Act Velocity LREAL Get Current velocity of the inverter motor. Connected BOOL Get [INTERNAL] Class has been connected to an axis. Enable N BOOL Get, Set Negative directional enable of the axis. Enable P BOOL Get, Set Positive directional enable of the axis. Enable Power BOOL Get, Set Power enable of the axis. Enable Supply BOOL Get, Set Supply enable of the axis. Error BOOL Get Inverter is in error state. Error ID UDINT Get Error code of the inverter error. Load LREAL Get Moad of the inverter. Power Enabled BOOL Get Feedback of the power enable of the inverter. Reset BOOL Get, Set Reset signal of the axis. Reseted BOOL Get, Set Feedback of the successful reset. Set Velocity LREAL Get, Set Set velocity of the axis. Stop BOOL Get, Set Stop signal of the axis for possible stop functions of the inverter. Stopped BOOL Get Feedback of the successful stop of the inverter. Supply Enabled BOOL Get Feedback of the supply enable of the inverter. Methods Name Description Cyclic() Cycle method Connect() Connects the inverter device to the axis. Go Error() Simulates an error of the inverter device. Interfaces Type Description I_Inv Device Base Standard interface on FB_Inv Device Base Defines the interface to the axis. I_Inv Device Base Dev Extended interface on FB_Inv Device Base. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) TF8560 Version: 1.4.0 235
## Page 236

I/O 5.6.3 Inv Device Co E402 This class is the basis for DS402-based inverters. In this context, the term Co E (CAN over Ether CAT) refers to the transmission of the Ci A DS402 protocol via Ether CAT. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Inv Device Co E402 EXTENDS FB_Inv Device Ec I/O variables Name Type Direction Description Ec Status FB_Io Ec Ads Uni Input Ether CAT status of the inverter. [} 204] Control Word U_Co E402_Cont Output Control word to the inverter. rol Word [} 237] Status Word U_Co E402_Stat Input Status word of the inverter. us Word [} 238] Properties Name Type Access Description Act Velocity LREAL Get Current velocity of the inverter motor. Tol Standstill LREAL Get, Set Tolerance with which the current velocity is interpreted as standstill. Connected BOOL Get [INTERNAL] Class has been connected to an axis. Enable N BOOL Get, Set Negative directional enable of the axis. Enable P BOOL Get, Set Positive directional enable of the axis. Enable Power BOOL Get, Set Power enable of the axis. Enable Supply BOOL Get, Set Supply enable of the axis. Error BOOL Get Inverter is in error state. Error ID UDINT Get Error code of the inverter error. Load LREAL Get Moad of the inverter. Power Enabled BOOL Get Feedback of the power enable of the inverter. Reset BOOL Get, Set Reset signal of the axis. Reseted BOOL Get, Set Feedback of the successful reset. Set Velocity LREAL Get, Set Set velocity of the axis. Stop BOOL Get, Set Stop signal of the axis for possible stop functions of the inverter. Stopped BOOL Get Feedback of the successful stop of the inverter. Supply Enabled BOOL Get Feedback of the supply enable of the inverter. 236 Version: 1.4.0 TF8560
## Page 237

I/O Methods Name Description Cyclic() Cycle method Connect() Connects the inverter device to the axis. Go Error() Simulates an error of the inverter device. Interfaces Type Description I_Inv Device Base Standard interface on FB_Inv Device Base Defines the interface to the axis. I_Inverter Co E402 Standard interface on FB_Inv Device Co E402. I_Inv Device Base Dev Extended interface on FB_Inv Device Base. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.3.1 U_Co E402_Control Word Union for decoding a Co E402 control word. Syntax: TYPE U_Co E402_Control Word : UNION {attribute 'tc_no_symbol'} bits: ST_Co E402_Control Word; {attribute 'tc_no_symbol'} w: WORD; END_UNION END_TYPE Values Name Type Description bits ST_Co E402_Control Word [} 237] Breakdown of the word into bits. w WORD Word as a complete data type. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.3.2 ST_Co E402_Control Word Structure for breaking down a Co E402 control word. Syntax: TYPE ST_Co E402_Control Word : STRUCT Switch On: BIT; Enable Voltage: BIT; Quick Stop Disable: BIT; Enable Operation: BIT; TF8560 Version: 1.4.0 237
## Page 238

I/O Reserve_4: BIT; Reserve_5: BIT; Reserve_6: BIT; Reset: BIT; Halt: BIT; END_STRUCT END_TYPE Bits Name Offset Description Switch On 0 Switch on the device. Enable Voltage 1 Enable supply. Quick Stop Disabl 2 Disable quick stop. e Enable Operation 3 Enable power. Reset 7 Reset error state. Halt 8 Stop the inverter. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.3.3 U_Co E402_Status Word Union for decoding a Co E402 status word. Syntax: TYPE U_Co E402_Status Word : UNION {attribute 'tc_no_symbol'} bits: ST_Co E402_Status Word; {attribute 'tc_no_symbol'} w: WORD; END_UNION END_TYPE Values Name Type Description bits ST_Co E402_Status Word [} 238] Breakdown of the word into bits. w WORD Word as a complete data type. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.3.4 ST_Co E402_Status Word Structure for the breakdown of a Co E402 status word. Syntax: TYPE ST_Co E402_Status Word : STRUCT Ready To Switch On: BIT; Switched On: BIT; Operation Enabled: BIT; 238 Version: 1.4.0 TF8560
## Page 239

I/O Fault: BIT; Voltage Enabled: BIT; Quick Stop Inactive: BIT; Switch On Disabled: BIT; Warning: BIT; Reserve_8: BIT; Remote: BIT; END_STRUCT END_TYPE Bits Name Offset Description Ready To Switch O 0 Inverter is ready to be switched on. n Switched On 1 Inverter is switched on. Operation Enable 2 Power is enabled. d Fault 3 Inverter is in error state. Voltage Enabled 4 Supply is enabled. Quick Stop Inactiv 5 Quick stop is disabled. e Switch On Disable 6 Inverter is blocked from being switched on. d Warning 7 Inverter reports a warning. Remote 9 Inverter runs in remote mode and can be controlled via the interface. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.4 Inverter Co E402_CSVM This class can be used for DS402 inverters in Cyclic Synchronous Velocity Mode. Syntax: FUNCTION_BLOCK FB_Inverter Co E402_CSVM EXTENDS FB_Inv Device Co E402 I/O variables Name Type Direction Description Ec Status FB_Io Ec Ads Uni Input Ether CAT status of the inverter. [} 204] Target Velocity DINT Output Target velocity of the inverter. Position Actual DINT Input Actual position of the inverter. Velocity Actual DINT Input Actual velocity of the inverter. Torque Actual INT Input Current torque. TF8560 Version: 1.4.0 239
## Page 240

I/O Name Type Direction Description Control Word U_Co E402_Cont Output Control word to the inverter. rol Word [} 237] Status Word U_Co E402_Stat Input Status word of the inverter. us Word [} 238] Properties Name Type Access Description Act Velocity LREAL Get Current velocity of the inverter motor. Output Factor LREAl Get, Set Multiplier for the velocity output. Torque Factor LREAL Get, Set Multiplier for interpretation of the actual torque. Tol Standstill LREAL Get, Set Tolerance with which the current velocity is interpreted as standstill. Connected BOOL Get [INTERNAL] Class has been connected to an axis. Enable N BOOL Get, Set Negative directional enable of the axis. Enable P BOOL Get, Set Positive directional enable of the axis. Enable Power BOOL Get, Set Power enable of the axis. Enable Supply BOOL Get, Set Supply enable of the axis. Error BOOL Get Inverter is in error state. Error ID UDINT Get Error code of the inverter error. Load LREAL Get Moad of the inverter. Power Enabled BOOL Get Feedback of the power enable of the inverter. Reset BOOL Get, Set Reset signal of the axis. Reseted BOOL Get, Set Feedback of the successful reset. Set Velocity LREAL Get, Set Set velocity of the axis. Stop BOOL Get, Set Stop signal of the axis for possible stop functions of the inverter. Stopped BOOL Get Feedback of the successful stop of the inverter. Supply Enabled BOOL Get Feedback of the supply enable of the inverter. Methods Name Description Cyclic() Cycle method Connect() Connects the inverter device to the axis. Go Error() Simulates an error of the inverter device. Interfaces Type Description I_Inv Device Base Standard interface on FB_Inv Device Base Defines the interface to the axis. I_Inverter Co E402 Standard interface on FB_Inv Device Co E402. I_Inv Device Base Dev Extended interface on FB_Inv Device Base. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 240 Version: 1.4.0 TF8560
## Page 241

I/O 5.6.5 Inverter Co E402_VM This class can be used for DS402 inverters in Velocity Mode. Syntax: FUNCTION_BLOCK FB_Inverter Co E402_VM EXTENDS FB_Inv Device Co E402 I/O variables Name Type Direction Description Ec Status FB_Io Ec Ads Uni Input Ether CAT status of the inverter. [} 204] Turn Rate INT Output Set speed for the inverter. Output Rate INT Input Actual speed of the inverter. Load Actual INT Input Current load of the inverter motor. Control Word U_Co E402_Cont Output Control word to the inverter. rol Word [} 237] Status Word U_Co E402_Stat Input Status word of the inverter. us Word [} 238] Properties Name Type Access Description Act Velocity LREAL Get Current velocity of the inverter motor. Tol Standstill LREAL Get, Set Tolerance with which the current velocity is interpreted as standstill. Connected BOOL Get [INTERNAL] Class has been connected to an axis. Enable N BOOL Get, Set Negative directional enable of the axis. Enable P BOOL Get, Set Positive directional enable of the axis. Enable Power BOOL Get, Set Power enable of the axis. Enable Supply BOOL Get, Set Supply enable of the axis. Error BOOL Get Inverter is in error state. Error ID UDINT Get Error code of the inverter error. Load LREAL Get Moad of the inverter. Power Enabled BOOL Get Feedback of the power enable of the inverter. Reset BOOL Get, Set Reset signal of the axis. Reseted BOOL Get, Set Feedback of the successful reset. Set Velocity LREAL Get, Set Set velocity of the axis. Stop BOOL Get, Set Stop signal of the axis for possible stop functions of the inverter. Stopped BOOL Get Feedback of the successful stop of the inverter. Supply Enabled BOOL Get Feedback of the supply enable of the inverter. TF8560 Version: 1.4.0 241
## Page 242

I/O Methods Name Description Cyclic() Cycle method Connect() Connects the inverter device to the axis. Go Error() Simulates an error of the inverter device. Interfaces Type Description I_Inv Device Base Standard interface on FB_Inv Device Base Defines the interface to the axis. I_Inverter Co E402 Standard interface on FB_Inv Device Co E402. I_Inv Device Base Dev Extended interface on FB_Inv Device Base. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.6.6 Inverter Analog This class is used for inverters with an analog interface. Syntax: FUNCTION_BLOCK FB_Inverter Analog EXTENDS FB_Inv Device Base I/O variables Name Type Direction Description QVelocity FB_Output Anal Output Velocity output og16 [} 219] QPower Enable FB_Output Digit Output Power enable al [} 231] QPositive Enable FB_Output Digit Output Positive directional enable al [} 231] QNegative Enable FB_Output Digit Output Negative directional enable al [} 231] QReset FB_Output Digit Output Reset the inverter error state. al [} 231] IActual Velocity FB_Input Analog Input Message of the current velocity. 16 [} 214] 242 Version: 1.4.0 TF8560
## Page 243

I/O Name Type Direction Description IActual Load FB_Input Analog Input Message of the current load. 16 [} 214] IEnable Feedback FB_Input Digital Input Message of power enable. [} 229] IFault FB_Input Digital Input Inverter error [} 229] Properties Name Type Access Description Act Velocity LREAL Get Current velocity of the inverter motor. Tol Standstill LREAL Get, Set Tolerance with which the current velocity is interpreted as standstill. Connected BOOL Get [INTERNAL] Class has been connected to an axis. Enable N BOOL Get, Set Negative directional enable of the axis. Enable P BOOL Get, Set Positive directional enable of the axis. Enable Power BOOL Get, Set Power enable of the axis. Enable Supply BOOL Get, Set Supply enable of the axis. Error BOOL Get Inverter is in error state. Error ID UDINT Get Error code of the inverter error. Load LREAL Get Moad of the inverter. Power Enabled BOOL Get Feedback of the power enable of the inverter. Reset BOOL Get, Set Reset signal of the axis. Reseted BOOL Get, Set Feedback of the successful reset. Set Velocity LREAL Get, Set Set velocity of the axis. Stop BOOL Get, Set Stop signal of the axis for possible stop functions of the inverter. Stopped BOOL Get Feedback of the successful stop of the inverter. Supply Enabled BOOL Get Feedback of the supply enable of the inverter. Direction of the signals The properties essentially form the interface between the inverter and the inverter axis. • Methods without a setter are usually feedback signals from the inverter to the axis. • Methods with setters are command signals from the axis to the inverter. Methods Name Description Cyclic() Cycle method Connect() Connects the inverter device to the axis. Go Error() Simulates an error of the inverter device. Interfaces Type Description I_Inv Device Base Standard interface on FB_Inv Device Base Defines the interface to the axis. I_Inverter Analog Standard interface on FB_Inverter Analog. I_Inv Device Base Dev Extended interface on FB_Inv Device Base. TF8560 Version: 1.4.0 243
## Page 244

I/O Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.7 ST_Flex Value Structure for transferring information without specifying the data type. Syntax: TYPE ST_Flex Value : STRUCT Var Type: E_Flex Value; // 4 byte Value: U_Flex Value; // 8 byte END_STRUCT END_TYPE Values Name Type Description Var Type E_Flex Value [} 244] Enumeration for identifying the value to be read. Value U_Flex Value [} 245] Union to which the value is written. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 5.7.1 E_Flex Value Enumeration to identify a value of the type U_Flex Value. Syntax: {attribute 'qualified_only'} {attribute 'strict'} TYPE E_Flex Value : ( e ILLEGAL := -1, // // 1 bit // e BOOL := 0, // // 8 bit // e SINT := 8, e USINT, e BYTE, // // 16 bit // e INT := 16, e UINT, e WORD, // // 32 bit // e DINT := 32, e UDINT, e DWORD, e REAL, // // 64 bit // 244 Version: 1.4.0 TF8560
## Page 245

I/O e LINT := 64, e ULINT, e LWORD, e LREAL ); END_TYPE Values Name Number Bit width e ILLEGAL -1 / e BOOL 0 1 bit e SINT 8 8 bits e USINT 9 e BYTE 10 e INT 16 16 bits e UINT 17 e WORD 18 e DINT 32 32 bits e UDINT 33 e DWORD 34 e REAL 35 e LINT 64 64 bits e ULINT 65 e LWORD 66 e LREAL 67 Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 5.7.2 U_Flex Value Union to hold the information in the data type ST_Flex Value. Syntax: TYPE U_Flex Value : UNION b: BOOL; // si: SINT; usi: USINT; bt: BYTE; // i: INT; ui: UINT; w: WORD; // di: DINT; udi: UDINT; dw: DWORD; re: REAL; // li: LINT; uli: ULINT; lw: LWORD; lr: LREAL; END_UNION END_TYPE TF8560 Version: 1.4.0 245
## Page 246

I/O Values Name Type b BOOL si SINT usi USINT bt BYTE i INT ui UINT w WORD di DINT udi UDINT dw DWORD re REAL li LINT uli ULINT lw LWORD lr LREAL Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 246 Version: 1.4.0 TF8560
## Page 247

Machine Data 6 Machine Data 6.1 FB_Md Container This class is able to write data from a list of components to a file. The file format is binary and secured via a CRC checksum. This automatically makes it more difficult for unauthorized users to manipulate this file. Syntax: FUNCTION_BLOCK FB_Md Container Properties Name Type Access Description Busy BOOL Get The container is busy reading or writing. Done BOOL Get Reading or writing has been successfully completed. Error BOOL Get An error has occurred while reading or writing. File Type E_Md File Type [} 248] Get, Set File encoding type Ignore Component Type BOOL Get, Set The component type is not taken into account for calling the Callback methods. Ignore Crc BOOL Get, Set A CRC checksum that does not match will not result in an abortion of the loading process Json Options I_Md Json Options Get Formatting options for saving in Json format [} 248] Load BOOL Get, Set Command to read the file. Name STRING Get, Set Name of the machine data container. Net Id T_Ams Net ID Get, Set AMS (ADS) network ID of the target system. Not available for the File Type e Json Path T_Max String Get, Set Path under which the machine data is to be saved. Save BOOL Get, Set Command for writing the file. Timeout LREAL Get, Set Time-out period of the system response of this function. File Path1 STRING Get, Set Path under which the machine data is to be saved. 1Obsolete Methods Name Description Abort() Aborts the current loading or saving process. Add Component() Adds another component to the container. Clear Chain() Deletes the list of all components. Cyclic() Cycle method TF8560 Version: 1.4.0 247
## Page 248

Machine Data Interfaces Type Description I_Md Container Standard interface on FB_Md Container. Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) 6.1.1 E_Md File Type Describes the supported file formatting of an FB_Md Container [} 247]. TYPE E_Md File Type : ( e Binary := 0, e Json ); END_TYPE Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) 6.1.2 I_Md Json Options Interface to the options available for Json formatting. Syntax: INTERFACE I_Md Json Options Properties Name Type Access Description Group Components BOOL Get, Set Groups the parameters within the file into sub-nodes per component. When using Ingore Component Type, only the index is grouped. Param Index As Hex BOOL Get, Set All parameter index numbers are saved as hexadecimal coded STRING. Word As Hex BOOL Get, Set All parameters of the word data type (WORD, DWORD, LWORD, BYTE) are saved as hexadecimal coded STRING. Write Descriptors BOOL Get, Set Component names and parameter descriptions are also written to the file. Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) Also see about this 248 Version: 1.4.0 TF8560
## Page 249

Machine Data 2 FB_Md Container [} 247] 6.2 FB_Md Component The class represents the basis of a machine data component. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Md Component Properties Name Type Access Description Component Name T_Max String Get, Set Component name. Is written to the file if the Json option Write Descriptors is set. Component Index USINT Get, Set Index of the instance of the component. Identifies a component if there are several components of the same type in a container. Component Type USINT Get, Set Index of the component type. Connected BOOL Get Component is connected to the container. Crc Checked BOOL Get, Set CRC checksum has been checked. End Mark BOOL Get, Set Is set when the component has accepted the last parameter. Md Next Component I_Md Component Get Interface to the next component. Md Param Descriptor T_Max String Get, Set Name of the next parameter to be written. Is written to the file if the Json option Write Descriptors is set. Methods Name Description Clear Chain() Resets the interface to the next component and calls its Clear Chain() method. Event-driven methods (callback methods) Name Description Md Next Parameter() [} 250] Gets parameters from the application. Md Set Parameter() [} 250] Passes parameters to the application. Interfaces Type Description I_Md Container Standard interface on FB_Md Container. TF8560 Version: 1.4.0 249
## Page 250

Machine Data Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 6.2.1 Md Next Parameter() This method is used to get the parameters from the application in order to write them to the file. Syntax: METHOD ABSTRACT Md Next Parameter : BOOL VAR_INPUT st Mdata: REFERENCE TO ST_Mdata; END_VAR Return value Name Type Description Md Next Parame BOOL TRUE = st Mdata contains a valid parameter. ter FALSE = No further data available. Inputs Name Type Description st Mdata REFERENCE TO Reference to a variable to which the component should write the ST_Mdata [} 251] information of the parameter. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 6.2.2 Md Set Parameter() This method is used to set the parameters of the application that are read from the file. Syntax: METHOD ABSTRACT Md Set Parameter : BOOL VAR_INPUT st Mdata: REFERENCE TO ST_Mdata; END_VAR 250 Version: 1.4.0 TF8560
## Page 251

Machine Data Return value Name Type Description Md Set Paramet BOOL TRUE = Parameter is applied. er FALSE = Parameter cannot be used. Inputs Name Type Description st Mdata REFERENCE TO Reference to a variable that contains the parameter loaded from the ST_Mdata [} 251] file. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 6.3 ST_Mdata This structure defines a parameter data set for the machine data. Syntax: TYPE ST_Mdata : STRUCT n Param Index: UDINT; // 4 byte n Component Type: USINT; // 1 byte n Component Index: USINT; // 1 byte st Flex: ST_Flex Value; // 12 byte END_STRUCT //------------- END_TYPE // 18 byte Values Name Type Description n Param Index UDINT Individual index of the written parameter. n Component Type USINT Components Type [} 249] of the written parameter. n Component Index USINT Components Index [} 249] of the written parameter. st Flex ST_Flex Value [} 244] Data type-independent parameter. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 251
## Page 252

Utilities 7 Utilities 7.1 Filter Filters are FBs that may be applied to reduce noise in actual values like axis position or velocity, pressures, or forces. To be compatible with the intended use they must implement at least the pre-defined INTERFACE I_Filter. Tc3 Plastic libraries supply a range of basic filter FBs. Find details below. 7.1.1 FB_Filter Base Base class for filter function blocks for filtering floating point numbers. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. Syntax: FUNCTION_BLOCK ABSTRACT FB_Filter Base EXTENDS FB_Message Base Properties Name Type Access Description Output LREAL Get The filtered value. Methods Name Description Cyclic Cycle method Cyclic Update [} 252] Cyclic transfer of a new input value. Interfaces Type Description I_Filter Basic interface for filter function blocks. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.1.1.1 Cyclic Update 252 Version: 1.4.0 TF8560
## Page 253

Utilities Cyclic transfer of a new value. Syntax: METHOD Cyclic Update: LREAL VAR_INPUT b Force: BOOL; f Input: LREAL; END_VAR Inputs Name Type Description b Force BOOL The filtered value is updated with the input value regardless of filter parameters if this input is TRUE. Notice A TRUE overwrites the parameterized filter behavior! f Input LREAL New input value Outputs Name Type Description Cyclic Update LREAL The filtered value. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.1.2 FB_Filter Pt1 This class, derived from FB_Filter Base, implements a filter of type PT1. Syntax: FUNCTION_BLOCK FB_Filter Pt1 EXTENDS FB_Filter Base Initialization parameters of the FB_init constructor Name Type Description f Tau LREAL Filter time constant [s] Properties Name Type Access Description Output LREAL Get The filtered value. Tau LREAL Get, Set The filter time constant [s] TF8560 Version: 1.4.0 253
## Page 254

Utilities Methods Name Description Cyclic Cycle method Cyclic Update [} 252] Cyclic transfer of a new input value. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.1.3 FB_Filter Slew Rate Limit This class derived from FB_Filter Base implements a filter that limits the rate of rise (i.e. the ramp rate). Syntax: FUNCTION_BLOCK FB_Filter Slew Rate Limit EXTENDS FB_Filter Base Initialization parameters of the FB_init constructor Name Type Description f Change Rate LREAL The maximum rate of change of the filtered value. Properties Name Type Access Description Output LREAL Get The filtered value. Change Rate Limit LREAL Get, Set The maximum rate of change of the filtered value. Methods Name Description Cyclic Cycle method Cyclic Update [} 252] Cyclic transfer of a new input value. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.1.4 FB_Filter Srl Pt1 254 Version: 1.4.0 TF8560
## Page 255

Utilities This class derived from FB_Filter Base implements a PT1 filter and a ramp limiting filter. Syntax: FUNCTION_BLOCK FB_Filter Srl Pt1 EXTENDS FB_Filter Base Properties Name Type Access Description Output LREAL Get The filtered value. Tau LREAL Get, Set The filter time constant [s] Change Rate Limit LREAL Get, Set The maximum rate of change of the filtered value. Methods Name Description Cyclic Cycle method Cyclic Update [} 252] Cyclic transfer of a new input value. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.2 HRESULT Most methods of the Twin CAT 3 Plastic Technology Functions return information about the success of the execution by means of a HRESULT value. This is formed from individual 16 bits of information and a 16-bit error code. This results in the 32-bit data type. The basic structure is as follows: Bits 31 30-16 15-0 Meaning 0 = Success, Characteristic identifier of the Error code: Typically matching the 1 = Error Plastic Technology Functions: enumeration E_Ads Err 0x1B00 There are several ways to evaluate an HRESULT error code: • Basically, the Tc3_Module library offers simple functions for checking. ◦ SUCCEEDED() --> Success ◦ FAILED() --> Failure • As the HRESULT data type is signed, bit 31 can also be checked by a greater than/less than comparison. ◦ >= 0 --> Success ◦ < 0 --> Failure • The F_Succeeded Hr(...) [} 256] function combines two error code evaluation processes. ◦ The function itself returns a boolean TRUE if the HRESULT value indicates a success. ◦ If the HRESULT indicates a failure, the information is copied to the Destination variable passed. See also PLC Programming Conventions - Error Codes TF8560 Version: 1.4.0 255
## Page 256

Utilities 7.2.1 F_Succeeded Hr This method checks a HRESULT value for success and copies the result to a transferred variable if the check fails. Syntax: FUNCTION F_Succeeded Hr : BOOL VAR_INPUT Source: HRESULT; END_VAR VAR_IN_OUT Destination: HRESULT; END_VAR Inputs/outputs Name Type Description Destination HRESULT Variable to which the HRESULT value is to be copied in the event of an error. Inputs Name Type Description Source HRESULT Error code to be checked. Return value Name Type Description F_Succeeded Hr BOOL TRUE if the check was successful. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.2.2 F_Hresult Create This method is used to create a HRESULT value. Whether the value is interpreted as a success depends on the input parameter b Success. Syntax: FUNCTION F_Hresult Success : HRESULT VAR_INPUT b Success: BOOL; n Feedback: UDINT; END_VAR 256 Version: 1.4.0 TF8560
## Page 257

Utilities Return value Name Type Description F_Hresult Creat HRESULT Created HRESULT value. e Inputs Name Type Description n Feedback UDINT Error code to be integrated into HRESULT. Only accepted if b Success = FALSE. b Success BOOL Indicator for the success. Requirements Development Environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.66 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.10.0.0) 7.2.3 F_Hresult Failure This method is used to generate a HRESULT value that is interpreted as an error. Syntax: FUNCTION F_Hresult Failure : HRESULT VAR_INPUT n Feedback: UDINT; END_VAR Return value Name Type Description F_Hresult Failur HRESULT Generated HRESULT value. e Inputs Name Type Description n Feedback UDINT Error code to be integrated into the HRESULT. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher TF8560 Version: 1.4.0 257
## Page 258

Utilities 7.2.4 F_Hresult Success This method is used to generate a HRESULT value that is interpreted as a success. Syntax: FUNCTION F_Hresult Success : HRESULT VAR_INPUT n Feedback: UDINT; END_VAR Return value Name Type Description F_Hresult Succ HRESULT Generated HRESULT value. ess Inputs Name Type Description n Feedback UDINT Error code to be integrated into the HRESULT. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.3 Messages 7.3.1 FB_Message This class is able to send messages via the Event Logger. Syntax: FUNCTION_BLOCK FB_Message EXTENDS FB_Tc Message Methods Name Description Set Trace Level() [} 259] Fixes the severity of the events thrown by this instance. Reset() Creates a SUCCESS_EVENT. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 258 Version: 1.4.0 TF8560
## Page 259

Utilities 7.3.1.1 Set Trace Level() This method fixes the severity of the events thrown by this instance. Syntax: METHOD Set Trace Level : HRESULT VAR_INPUT b Own Trace Level: BOOL; // activate internal trace level e Trace Level: Tc Event Severity; // set internal trace level END_VAR Return value Name Type Description Set Trace Level HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description b Own Trace Level BOOL Activates the fixed severity level. e Trace Level Tc Event Severity Severity level Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.3.2 FB_Xyz Message These classes take into account various static parameters of the library in order to report messages in the Event Logger. Syntax: FUNCTION_BLOCK FB_Xyz Message EXTENDS FB_Message Methods Name Description Set Trace Level() [} 259] Fixes the severity of the events thrown by this instance. TF8560 Version: 1.4.0 259
## Page 260

Utilities Name Description Send Message() [} 260] Generates a message in the Event Logger. Reset() Creates a SUCCESS_EVENT. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.3.2.1 Send Message() This method sends a message to the Event Logger. Syntax: METHOD Send Message : HRESULT VAR_INPUT st Event Entry: Tc Event Entry; // Tc Event Entry to be created and send s String: STRING(255); // additional STRING attribute END_VAR Return value Name Type Description Send Message HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description st Event Entry Tc Event Entry Message to be generated and sent. s String STRING(255) Optional additional information as text. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.3.3 FB_Message Base This class is the basic scope of the Event Logger interface of most axes and core functions. Class is Abstract Since the class is defined as ABSTRACT, the class cannot be instantiated and must be implemented using inheritance. 260 Version: 1.4.0 TF8560
## Page 261

Utilities Syntax: FUNCTION_BLOCK ABSTRACT FB_Message Base Properties Name Type Access Description Error BOOL Get Error state Result Message I_Tc Message Get Access to the internal instance of the error messages. Methods Name Description Do Reset(b Execute) Resets the error. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.4 Services 7.4.1 FB_Co EService This class provides a read and write service for Co E-addressable Ether CAT devices. This can be used to read and/or write internal information from a field device, for example. Syntax: FUNCTION_BLOCK FB_Co EService EXTENDS FB_Message Base Properties Name Type Access Description Ads Addr AMSADDR Get, Set ADS address of the target device. Is set automatically when an existing field device is linked via Ec Device. Busy BOOL Get The service is currently performing a read or write operation. Config I_Co EParameter [} 262] Get Information on the parameter to be read: address, data type, memory type, validation Done BOOL Get The read or write process has been successfully completed. Ec Device I_Io Ec Ads [} 204] Get, Set Transfer of an existing I/O element with mapping of the ADS address Error BOOL Get An error has occurred during the read or write process. Error Id UDINT Get Error code of the last error that occurred. TF8560 Version: 1.4.0 261
## Page 262

Utilities Methods Name Description Cyclic() Cycle method Read(b Execute) Commands a read process. Write(b Execute) Commands a write process. Interfaces Type Description I_Co EService Standard interface on FB_Co EService. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 7.4.2 FB_Co EParameter This class bundles the information of a Co E value in a field device. Syntax: FUNCTION_BLOCK FB_Co EParameter Properties Name Type Access Description Index WORD Get, Set Identifies the main index of the Co E value. Sub Index BYTE Get, Set Addresses a sub-information in a structured Co E value. Valid BOOL Get, Set The value contained in Value was read by an FB_Co EService [} 261], for example, and is valid. Value REFERENCE TO Get, Set Union, which saves the read value U_Flex Value [} 245] (regardless of the set data type). Var Type E_Flex Value [} 244] Get, Set Defines the data type of the parameter to be read. Notice The correct data type must be configured for the execution of a FB_Co EService service. Interfaces Type Description I_Co EParameter Standard interface on FB_Co EParameter. 262 Version: 1.4.0 TF8560
## Page 263

Utilities Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) 7.5 Simulation A simulation requires the emulation of a process that is influenced by a controller. This is realized by sending control values to output devices that control actuators. The state of the process is detected by sensors, which respond by sending signals to input devices. Typical examples for these devices are: • servo drives and valves with direct fieldbus interface • rotary encoders and sensors with direct fieldbus interface • rotary encoders and sensors via analog input terminals • servo drives and valves via analog output terminals The most efficient way to connect a process simulation with a control implementation such as an application based on TC3 Plastic Functions is to replace the real I/O devices with compatible container objects. In such a concept, the simulation must perform the following tasks: • emulate the functionality of the output device • simulate the behavior of the actuator • simulate the effect on the process • simulate the behavior of the sensor • emulate the functionality of the input device 7.5.1 General simulation components 7.5.1.1 FB_Sim Ax Common This class is used as a common platform for carrying out various types of axis simulations. It is not intended to instantiate objects. Syntax: FUNCTION_BLOCK FB_Sim Ax Common Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. Notice The simulated position of the actuator can deviate from the reported axis position. FB_Sim Ax Common Actual Velocity LREAL Get, Set Simulated axis velocity. TF8560 Version: 1.4.0 263
## Page 264

Utilities Name Type Access Description Notice The simulated velocity of the actuator may deviate from the reported axis position. Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: 264 Version: 1.4.0 TF8560
## Page 265

Utilities Name Type Access Description • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. Interfaces Type Description I_Sim Ax Common Standard interface for FB_Sim Ax Common. TF8560 Version: 1.4.0 265
## Page 266

Utilities Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.5.1.1.1 Go Fault State() This method can be used to simulate an error situation on the simulated axis. The simulated axis does not respond to setpoints, updates the simulated drive state machine and reports the problem via the status word. Syntax: METHOD Go Fault State : BOOL Return value Name Type Description Go Fault State BOOL Reserved for future implementation Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.5.1.2 FB_Noise This FB is used to generate a pseudo-random signal that resembles a white noise disturbance. Noise signals may be used to simulate a common problem of analog sensors and interfaces. Objects of this type are typically used as local elements in an implementation of an axis simulation. Syntax: FUNCTION_BLOCK FB_Noise Methods Name Description Cyclic [} 267] Cyclic call to generate a new value. Set Line Noise Level [} 267] Determination of the level of an influence by a supply network. 266 Version: 1.4.0 TF8560
## Page 267

Utilities Name Description Set Spark Noise Level [} 267] Determination of the level of an influence by static discharges. Set White Noise Level [} 268] Setting the level of the noise signal. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.5.1.2.1 Cyclic Method to be called cyclically to generate a new value. Syntax: METHOD Cyclic : LREAL Outputs Name Type Description Cyclic LREAL The new value of the noise signal 7.5.1.2.2 Set Line Noise Level Determination of the level of an influence by a supply network. Syntax: METHOD Set Line Noise Level VAR_INPUT f Level: LREAL; END_VAR Inputs Name Type Description f Level LREAL Level of an influence by a supply network. Recommended standard: depending on the use of the signal. 7.5.1.2.3 Set Spark Noise Level Determination of the level of an influence by static discharges. TF8560 Version: 1.4.0 267
## Page 268

Utilities Syntax: METHOD Set Spark Noise Level VAR_INPUT f Level: LREAL; END_VAR Inputs Name Type Description f Level LREAL Level of an influence by static discharges. Recommended standard: depending on the use of the signal. 7.5.1.2.4 Set White Noise Level Setting the level of the noise signal. Syntax: METHOD Set White Noise Level VAR_INPUT f Level: LREAL; END_VAR Inputs Name Type Description f Level LREAL Level of the noise signal. Recommended standard: depending on the use of the signal. 7.5.2 Simulation of an Ether CAT based servo drive axis Twin CAT 3 Technology Functions offers two types of Ether CAT-based servo drives: So E and Co E devices. Both protocols can be used in real machines, but simulating the real behavior is an additional challenge. In Co E drives, a device reset command is triggered via a Control Word/Status Word mechanism, while So E drives use acyclic ADS via Ether CAT communication. Since the simulation of the So E mechanism is much more complicated, only a Co E-based simulation is provided. Implementing a simulated servo axis A simulation requires an implementation that can run in one of two places: • in the same context as the control implementation • in a separate PLC or even on a separate CPU Instantiation in the same context: Designation Type Description {attribute 'Tc Context Name':='Fast Task'} Instructs Twin CAT to update the I/O of the FB_Sim Co E402_Servo class in a specified task. The task should be identical to the call of the Cyclic() method of the simulation block. fb Nc Axis Sim FB_Sim Co E402_Servo [} 270] Creates an instance of the simulation block. b Nc Axis Sim Go Error BOOL Creates a signal with which the simulation triggers an error state and requests a reset procedure. 268 Version: 1.4.0 TF8560
## Page 269

Utilities Designation Type Description fb Nc Axis Sim Limiter FB_Sim Torque Limiting Co E402 Creates an instance of a FB that is needed to provide the simulation with the torque limitation _Servo [} 275] capability. This FB will exchange data with the control functionality via an interface access. Instantiation in a separate context: Designation Type Description {attribute 'Tc Context Name':='Fast Task'} Instructs Twin CAT to update the I/O of the FB_Sim Co E402_Servo class in a specified task. The task should be identical to the call of the Cyclic() method of the simulation block. fb Nc Axis Sim FB_Sim Co E402_Servo [} 270] Creates an instance of the simulation block. b Nc Axis Sim Go Error BOOL Creates a signal with which the simulation triggers an error state and requests a reset procedure. {attribute 'Tc Context Name':='Fast Task'} Instructs the following instance to be updated in a specified task. The task should be identical to the call of the Cyclic() method of the simulation block. fb Nc Axis Sim Limiter FB_Sim Torque Limiting Co E40 Creates an instance of a FB that is needed to provide the simulation with the torque limitation 2_Mapped [} 275] capability. This FB exchanges data with the control functionality via mapping. Initialization of a simulated servo axis Initialization is required during the start-up phase. The following list can be used as an example. IF NOT b Initialised AND b Simulation THEN fb Nc Axis Sim. Encoder Weighting:=5.0; fb Nc Axis Sim. Encoder Zero Shift:=100.0; fb Nc Axis Sim. Encoder Noise Level:=0.001; fb Nc Axis Sim. High Side Block:=700.0; fb Nc Axis Sim. High Side Spring Length:=1.0; fb Nc Axis Sim. Low Side Block:=100.0; fb Nc Axis Sim. Low Side Spring Length:=1.0; fb Nc Axis Sim. Position Lag Kp:=1.0; fb Nc Axis Sim. High Side Endswitch:=699.0; fb Nc Axis Sim. Low Side Endswitch:=101.0; fb Nc Axis Sim. Abs Switch High End:=679.0; fb Nc Axis Sim. Abs Switch Low End:=21.0; // the next line must be used if the simulation // is implemented in a separate context fb Nc Axis Sim Limiter Mapped. Connect To Sim(ip Sim:=fb Nc Axis2Sim); // the next two lines must be used if the simulation // is implemented in the same context fb Nc Axis Sim Limiter. Connect To Sim(ip Sim:=fb Nc Axis2Sim); i Nc Axis. Set Torque Limiting(fb Nc Axis Sim Limiter); END_IF The last line defines the class used by the axis for torque limitation when the simulation is performed in the same context. In this case the penultimate line is required to connect this class to the drive simulation. Above these lines is an example of implementation in a separate context. Mapping of a simulated servo axis The simulation FB provides a local instance of a mapping interface defined as follows: Nc Adapt : FB_Sim Co E402_Servo Nc Adapt; The supplied mapping structures for encoder and drive inputs and outputs are compatible with the Twin CAT NC interfaces and can thus be used. TF8560 Version: 1.4.0 269
## Page 270

Utilities Functionality of the Co E402 simulation All mechanisms that use mapped interfaces are supported in a way that is expected by Twin CAT NC. This also includes torque limitation. Since there is no way to emulate ADS communication, some mechanisms cannot be supported. • Simulated axes cannot be supported by Drive Manager. There is no servo drive and no motor. The commissioning requires just parameters and must be done hard coded in the application project. • The Advanced Homing library of Twin CAT NC uses the ADS communication to disable some functions of the AX servo drives while the homing procedures are executed. The core functions of the TC3 Plastic Functions provide methods to avoid the use of this communication. The homing mechanisms are also ready for use with simulated servo axes. 7.5.2.1 FB_Sim Co E402_Servo This class implements a simulation of a Co E402 servo drive. The FB offers mapping elements for Co E interfaces of servo drives. Mapping is done in the same way as for the real drive unit. Syntax: FUNCTION_BLOCK FB_Sim Co E402_Servo EXTENDS FB_Sim Ax Common VAR_INPUT Nc Adapt: FB_Co E402_Servo Adapt; END_VAR I/O variables Name Type Direction Description Nc Adapt FB_Co E402_S Input/Output The mapping interface for the NC axis. ervo Adapt Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. Notice The simulated position of the actuator can deviate from the reported axis position. FB_Sim Co E402_Servo Actual Torque LREAL Get The simulated actual torque. External Torque LREAL Get, Set Here, an external torque can be specified from the simulation of a simulated process. Inertia LREAL Get Moment of inertia [kg * m³], formed from Moving Mass and a chaining of gears. Position Lag Kp LREAL Get, Set The position control gain of the simulated servo. Reversed BOOL Get, Set TRUE if the direction of rotation of the simulated servo is inverted. Status Word WORD Get The status word of the servo. Torque Limit Negative LREAL Get, Set The negative torque limit. Torque Limit Positive LREAL Get, Set The positive torque limit. FB_Sim Ax Common 270 Version: 1.4.0 TF8560
## Page 271

Utilities Name Type Access Description Actual Velocity LREAL Get, Set Simulated axis velocity. Notice The simulated velocity of the actuator may deviate from the reported axis position. Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor TF8560 Version: 1.4.0 271
## Page 272

Utilities Name Type Access Description Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. NOTICE When using a simulated servo drive, a FB of type FB_Sim Torque Limiting Co E402_Servo [} 275] or FB_Sim Torque Limiting Co E402_Mapped [} 275] must be used to perform the data exchange between Twin CAT 3 Plastic Functions and the simulation. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. FB_Sim Co E402_Servo Cyclic() This method must be called cyclically. 272 Version: 1.4.0 TF8560
## Page 273

Utilities Name Description Gear() [} 273] Starts a chaining of gear factors. Gear Box() [} 273] Rotary transmission (gearbox). Gear Rack NPinion() [} 274] Linear transmission by rack and pinion. Gear Screw() [} 275] Linear transmission by spindle. Interfaces Type Description I_Sim Ax Common Standard interface for FB_Sim Ax Common. I_Sim Co E402_Servo Standard interface for FB_Sim Co E402_Servo. I_Sim Ax Gear Gear interface for coupling gear ratios of the axis. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 7.5.2.1.1 Gear() This method is used to start the chaining of gear factors. Effects on the actual position The gear methods are used to determine the moment of inertia and the encoder weighting. Check the resulting Encoder Weighting to ensure that it matches the NC. Syntax: METHOD Gear Box : I_Sim Ax Gear Return value Name Type Description Gear Box I_Sim Ax Gear Gear interface on the axis to configure a chaining of gearboxes. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) Tc3_Plastic Nc (>= v3.12.5.0) 7.5.2.1.2 Gear Box() This method can be used to configure a rotary transmission factor of the gearbox. TF8560 Version: 1.4.0 273
## Page 274

Utilities Effects on the actual position The gear methods are used to determine the moment of inertia and the encoder weighting. Check the resulting Encoder Weighting to ensure that it matches the NC. Syntax: METHOD Gear Box : I_Sim Ax Gear VAR_INPUT f Ratio In: LREAL; f Ratio Out: LREAL; END_VAR Return value Name Type Description Gear Box I_Sim Ax Gear Gear interface on the axis to configure a chaining of gearboxes. Inputs Name Type Description f Ratio In LREAL Number of teeth of the gearbox input. f Ratio Out LREAL Number of teeth of the gearbox output. Mathematical relationship of the inputs f Ration In and f Ratio Out can be regarded as the numerator and denominator of a mathematical fraction. This allows the transmission ratio to be specified as a fraction. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) Tc3_Plastic Nc (>= v3.12.5.0) 7.5.2.1.3 Gear Rack NPinion() This method is used to finalize a chaining of gears by means of a rack. Effects on the actual position The gear methods are used to determine the moment of inertia and the encoder weighting. Check the resulting Encoder Weighting to ensure that it matches the NC. Syntax: METHOD Gear Rack NPinion VAR_INPUT f Pinion Radius: LREAL; // [m] END_VAR Inputs Name Type Description f Pinion Radius LREAL Effective radius [m] of the pinion on the rack 274 Version: 1.4.0 TF8560
## Page 275

Utilities Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) Tc3_Plastic Nc (>= v3.12.5.0) 7.5.2.1.4 Gear Screw() This method is used to finalize a chaining of gears by means of a spindle. Effects on the actual position The gear methods are used to determine the moment of inertia and the encoder weighting. Check the resulting Encoder Weighting to ensure that it matches the NC. Syntax: METHOD Gear Screw VAR_INPUT f Radius: LREAL; // [m] f Pitch: LREAL; // [m] END_VAR Inputs Name Type Description f Radius LREAL Radius of the spindle [m] f Pitch LREAL Pitch of the spindle [m] Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) Tc3_Plastic Nc (>= v3.12.5.0) 7.5.2.2 FB_Sim Torque Limiting Co E402_Servo If the simulation is performed in the same task in which the process software of the axis is running: A FB of this type must be used to provide a simulated servo drive with a torque limitation. If the simulation is not performed in the same task in which the process software of the axis is running: A FB of this type must be used to provide a simulated servo drive with a torque limitation and to connect it by a mapping. TF8560 Version: 1.4.0 275
## Page 276

Utilities Properties Name Type Access Description Activate BOOL Get, Set A TRUE signals that a torque limitation is active. Methods Name Description Connect To Sim() [} 276] This method establishes a connection between the torque-limiting FB and the simulated servo drive. Cyclic This method, to be called cyclically, performs all calculations and decisions. Interfaces Type Description I_Torque Limiting Fb Interface for linking with the Torque Limiting function of an axis. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 7.5.2.2.1 Connect To Sim() This method establishes a connection between the torque-limiting FB and the simulated servo drive. This connection replaces the Ether CAT communication with a real Co E402-based servo drive. Syntax: METHOD Connect To Sim : HRESULT VAR_INPUT ip Sim: I_Sim Co E402_Servo; END_VAR Return value Name Type Description Connect To Sim HRESULT Return value with feedback on the success of the execution. Inputs Name Type Description ip Sim I_Sim Co E402_Servo The simulation block for the simulation of a Co E402 servo. 276 Version: 1.4.0 TF8560
## Page 277

Utilities Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Nc v3.12.4.26 or higher 7.5.3 Simulation of an inverter axis This simulation corresponds to an inverter axis and can be used to replace a real inverter drive. For this purpose, compatible mapping elements are provided and a behavior very similar to that of a real axis is emulated. Implementation of a simulated inverter axis A simulation requires an implementation that can run in one of two places: • in the same context as the control implementation • in a separate runtime or even on a separate CPU Implementation in both contexts is recommended as described below: Name Type Description {attribute 'Tc Context Name':='Fast Task'} Instructs FB_Sim Co E402_Inverter to be updated in a specific task. In this case it must be the calling task that executes the Cyclic() method of the simulation block. fb Inv Axis Sim FB_Sim Co E402_Inverter_Xyz Creates an instance of the simulation FB. [} 280] b Inv Axis Sim Go Error BOOL Creates a signal for the simulation to report an error state and request a reset procedure. Range of supported inverters The term FB_Sim Co E402_Inverter_Xyz above must be replaced by one of the following options: FB_Sim Co E402_Inverter_VM FB_Sim Co E402_Inverter_CSVM Initialization of a simulated inverter axis In the startup phase, it is necessary to implement an initialization sequence as described below. IF NOT b Initialised AND b Simulation THEN fb Inv Axis Sim. Cycle Time := 0.002; fb Inv Axis Sim. Max Turn Rate := 1380.0; fb Inv Axis Sim. Min Turnrate := 45.0; fb Inv Axis Sim. Ramp Time := 2.0; fb Inv Axis Sim. Output Factor := 1.0; fb Inv Axis Sim. Reference Load := 100.0; END_IF The parameters must correspond to the behavior of the simulated device, not to the intended use. 7.5.3.1 FB_Sim Co E402_Inverter TF8560 Version: 1.4.0 277
## Page 278

Utilities This simulation corresponds to an inverter axis and can be used to replace a real inverter drive by providing compatible mapping elements and emulating behavior very similar to that of a real axis. The FB provides mapping elements for Co E interfaces of basic frequency inverters (FI) that match the interfaces implemented by the adapter FB for this drive type. Mapping is done in the same way as for the real drive unit. Syntax: FUNCTION_BLOCK ABSTRACT FB_Sim Co E402_Inverter EXTENDS FB_Sim Ax Common VAR_INPUT Et C_Device AT %Q* : FB_Et C_Sim Device; END_VAR I/O variables Name Type Direction Description Et C_Device FB_Et C_Sim De Input/Output Diagnostic interface for an Ether CAT-capable device. vice Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. Notice The simulated position of the actuator can deviate from the reported axis position. FB_Sim Co E402_Inverter Load LREAL Get, Set Here you can specify a load that is claimed by a simulated process. Max Turn Rate LREAL Get, Set The maximum turn rate of the drive. Min Turnrate LREAL Get, Set A minimum turn rate can be specified here. If a value > 0.0 is specified, the drive ignores set turn rates below this threshold and a dead band is created. If the default is less than 10 RPM, it is assumed that the inverter supports vector control. Output Factor LREAL Get, Set Multiplier for the output. Ramp Time LREAL Get, Set Here the time for the ramp from zero to Max Turn Rate or vice versa is defined. Reference Load LREAL Get, Set A reference value for Load. Alias for . Moving Mass Vector Controlled BOOL Get A TRUE specifies that the actual turn rate is load independent. If FALSE, the inverter responds to a load torque with a proportional slip. The simulation assumes a slip of 0 to 50 % for a load of 0 to 100 % of the reference load. FB_Sim Ax Common Actual Velocity LREAL Get, Set Simulated axis velocity. Notice The simulated velocity of the actuator may deviate from the reported axis position. Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. 278 Version: 1.4.0 TF8560
## Page 279

Utilities Name Type Access Description Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. TF8560 Version: 1.4.0 279
## Page 280

Utilities Name Type Access Description High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. FB_Sim Co E402_Inverter Cyclic() Cycle method Trigger Error()1 A call to this method places the simulated drive into the error state. Alternatively: Go Fault State() Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) 7.5.3.2 FB_Sim Co E402_Inverter_VM 280 Version: 1.4.0 TF8560
## Page 281

Utilities This simulation corresponds to an inverter axis and can be used to replace a real inverter drive by providing compatible mapping elements and emulating behavior very similar to that of a real axis. The FB provides mapping elements for Co E interfaces of basic frequency inverters (FI) that match the interfaces implemented by the adapter FB for this drive type. Mapping is done in the same way as for the real drive unit. Syntax: FUNCTION_BLOCK FB_Sim Co E402_Inverter_VM EXTENDS FB_Sim Co E402_Inverter VAR_INPUT IO : FB_Co E402_Inverter Adapt; END_VAR I/O variables Name Type Direction Description Et C_Device FB_Et C_Sim De Input/Output Diagnostic interface for an Ether CAT-capable device. vice I/O FB_Co E402_In Input/Output The mapping interface for the inverter axis. verter Adapt Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. Notice The simulated position of the actuator can deviate from the reported axis position. FB_Sim Co E402_Inverter Load LREAL Get, Set Here you can specify a load that is claimed by a simulated process. Max Turn Rate LREAL Get, Set The maximum turn rate of the drive. Min Turnrate LREAL Get, Set A minimum turn rate can be specified here. If a value > 0.0 is specified, the drive ignores set turn rates below this threshold and a dead band is created. If the default is less than 10 RPM, it is assumed that the inverter supports vector control. Output Factor LREAL Get, Set Multiplier for the output. Ramp Time LREAL Get, Set Here the time for the ramp from zero to Max Turn Rate or vice versa is defined. Reference Load LREAL Get, Set A reference value for Load. Alias for . Moving Mass Vector Controlled BOOL Get A TRUE specifies that the actual turn rate is load independent. If FALSE, the inverter responds to a load torque with a proportional slip. The simulation assumes a slip of 0 to 50 % for a load of 0 to 100 % of the reference load. FB_Sim Ax Common Actual Velocity LREAL Get, Set Simulated axis velocity. Notice The simulated velocity of the actuator may deviate from the reported axis position. TF8560 Version: 1.4.0 281
## Page 282

Utilities Name Type Access Description Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset 282 Version: 1.4.0 TF8560
## Page 283

Utilities Name Type Access Description High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. FB_Sim Co E402_Inverter Cyclic() Cycle method Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) TF8560 Version: 1.4.0 283
## Page 284

Utilities 7.5.3.3 FB_Sim Co E402_Inverter_CSVM This simulation corresponds to an inverter axis and can be used to replace a real inverter drive by providing compatible mapping elements and emulating behavior very similar to that of a real axis. The FB provides mapping elements for Co E interfaces of frequency inverters that implement a servo-like architecture and that match the interfaces implemented by the adapter FB for this type of drives. Mapping is done in the same way as for the real drive unit. Syntax: FUNCTION_BLOCK FB_Sim Co E402_Inverter_CSVM EXTENDS FB_Sim Co E402_Inverter VAR_INPUT Outputs AT %I* : ST_Co E402_CSVM_Outputs; Inputs AT %Q* : ST_Co E402_CSVM_Inputs; END_VAR I/O variables Name Type Direction Description Et C_Device FB_Et C_Sim De Input/Output Diagnostic interface for an Ether CAT-capable device. vice Outputs ST_Co E402_C Input The mapping interface for the inverter outputs. SVM_Outputs Inputs ST_Co E402_C Output The mapping interface for the inverter inputs. SVM_Inputs Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. Notice The simulated position of the actuator can deviate from the reported axis position. FB_Sim Co E402_Inverter Load LREAL Get, Set Here you can specify a load that is claimed by a simulated process. Max Turn Rate LREAL Get, Set The maximum turn rate of the drive. Min Turnrate LREAL Get, Set A minimum turn rate can be specified here. If a value > 0.0 is specified, the drive ignores set turn rates below this threshold and a dead band is created. If the default is less than 10 RPM, it is assumed that the inverter supports vector control. Output Factor LREAL Get, Set Multiplier for the output. Ramp Time LREAL Get, Set Here the time for the ramp from zero to Max Turn Rate or vice versa is defined. Reference Load LREAL Get, Set A reference value for Load. Alias for . Moving Mass Vector Controlled BOOL Get A TRUE specifies that the actual turn rate is load independent. 284 Version: 1.4.0 TF8560
## Page 285

Utilities Name Type Access Description If FALSE, the inverter responds to a load torque with a proportional slip. The simulation assumes a slip of 0 to 50 % for a load of 0 to 100 % of the reference load. FB_Sim Ax Common Actual Velocity LREAL Get, Set Simulated axis velocity. Notice The simulated velocity of the actuator may deviate from the reported axis position. Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: TF8560 Version: 1.4.0 285
## Page 286

Utilities Name Type Access Description • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. FB_Sim Co E402_Inverter Cyclic() Cycle method 286 Version: 1.4.0 TF8560
## Page 287

Utilities Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) 7.5.3.4 FB_Sim Analog_Inverter This simulation corresponds to an inverter axis and can be used to replace a real inverter drive by providing compatible mapping elements and emulating behavior very similar to that of a real axis. The FB offers mapping elements for an analog interface of basic frequency inverters (FU) that match the interfaces implemented by the adapter FB for this drive type. Mapping is done in the same way as for the real drive unit. Syntax: FUNCTION_BLOCK FB_Sim Analog_Inverter EXTENDS FB_Sim Ax Common VAR_INPUT Velocity : FB_Sim Analog Output El Terminal4; // mandatory Actuals : FB_Sim Analog Input El Terminal4; Power Enable AT %I* : BOOL; // mandatory Positive Enable AT %I* : BOOL; // optional: will be TRUE if no mapping Negative Enable AT %I* : BOOL; // optional: will be TRUE if no mapping Reset AT %I* : BOOL; // mandatory Enable Feedback AT %Q* : BOOL; Fault AT %Q* : BOOL; END_VAR I/O variables Name Type Direction Description Fault BOOL Output Output of a simulated error. Velocity FB_Sim Analog O Input Velocity input for the setpoint from the control. utput El Terminal 4 [} 291] Actuals FB_Sim Analog I Output Velocity feedback (actual value) to the control. The load value is returned on channel 2. nput El Terminal 4 [} 291] Power Enable BOOL Input Power enable for the inverter. Positive Enable BOOL Input Positive power enable. Negative Enable BOOL Input Negative power enable. Reset BOOL Input Resetting a simulated error. Enable Feedback BOOL Output Feedback of successful power enable. Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. TF8560 Version: 1.4.0 287
## Page 288

Utilities Name Type Access Description Notice The simulated position of the actuator can deviate from the reported axis position. FB_Analog_Inverter Load LREAL Get, Set Here you can specify a load that is claimed by a simulated process. Max Turn Rate LREAL Get, Set The maximum turn rate of the drive. Min Turnrate LREAL Get, Set A minimum turn rate can be specified here. If a value > 0.0 is specified, the drive ignores set turn rates below this threshold and a dead band is created. If the default is less than 10 RPM, it is assumed that the inverter supports vector control. Output Factor LREAL Get, (Set) Multiplier for the output. Ramp Time LREAL Get, Set Here the time for the ramp from zero to Max Turn Rate or vice versa is defined. Reference Load LREAL Get, Set A reference value for Load. Alias for . Moving Mass Vector Controlled BOOL Get A TRUE specifies that the actual turn rate is load independent. If FALSE, the inverter responds to a load torque with a proportional slip. The simulation assumes a slip of 0 to 50 % for a load of 0 to 100 % of the reference load. FB_Sim Ax Common Actual Velocity LREAL Get, Set Simulated axis velocity. Notice The simulated velocity of the actuator may deviate from the reported axis position. Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. 288 Version: 1.4.0 TF8560
## Page 289

Utilities Name Type Access Description Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. TF8560 Version: 1.4.0 289
## Page 290

Utilities Name Type Access Description Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. FB_Sim Analog_Inverter Cyclic() Cycle method Interfaces Type Description I_Sim Ax Common Standard interface for FB_Sim Ax Common. I_Sim Analog_Inverter Standard interface for FB_Sim Analog_Inverter. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.6.1.0) Also see about this 2 Simulation of an analog output terminal [} 291] 2 Simulation of an analog input terminal [} 291] 7.5.4 I/O Simulation containers To create a simulation, function blocks are needed that can replace an I/O device in a compatible way. Name Channels Description FB_Sim Analog Input El Terminal4 [} 291] 4 Simulation of an analog Ether CAT input terminal. Example EL3134 FB_Sim Analog Output El Terminal4 [} 291] 4 Simulation of an analog Ether CAT output terminal. Example EL4134 FB_Sim Ssi Input El Terminal1 [} 293] 1 Simulation of an Ether CAT SSI input terminal. Example EL5001 FB_Co E402_Servo Adapt [} 292] 1 AX8000 290 Version: 1.4.0 TF8560
## Page 291

Utilities 7.5.4.1 Simulation of an analog input terminal Simulation of a 4-channel analog input terminal. This FB only provides a mapping interface and does not contain an implementation. Syntax: FUNCTION_BLOCK FB_Sim Analog Input El Terminal4 Inputs Name Type Access Initial value Description Analog Value1 INT IN 0 The simulated input value of the 1st channel. Analog Value2 INT IN 0 The simulated input value of the 2nd channel. Analog Value3 INT IN 0 The simulated input value of the 3rd channel. Analog Value4 INT IN 0 The simulated input value of the 4th channel. Wc State BOOL OUT FALSE The simulated Working Counter State. Toggle BOOL OUT FALSE The simulated toggle bit. Info Data State UINT OUT 8 The simulated Device State. Ads Addr AMSADDR OUT The simulated ADS address. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.5.4.2 Simulation of an analog output terminal Simulation of a 4-channel analog output terminal. This FB only provides a mapping interface and does not contain an implementation. Syntax: FUNCTION_BLOCK FB_Sim Analog Output El Terminal4 TF8560 Version: 1.4.0 291
## Page 292

Utilities Inputs Name Type Access Initial value Description Output1 INT IN 0 The simulated output value of the 1st channel. Output2 INT IN 0 The simulated output value of the 2nd channel. Output3 INT IN 0 The simulated output value of the 3rd channel. Output4 INT IN 0 The simulated output value of the 4th channel. Wc State BOOL OUT FALSE The simulated Working Counter State. Info Data State UINT OUT 8 The simulated Device State. Ads Addr AMSADDR OUT The simulated ADS address. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.5.4.3 Simulation of a Co E402 servo drive Simulation of a Co E408 servo drive. This FB only provides a mapping interface and does not contain an implementation. Syntax: FUNCTION_BLOCK FB_Co E402_Servo Adapt Inputs Name Type Access Description Nc Drive In NCDRIVESTRUCT_IN2 OUT For the Drive In interface of the NC. Nc Drive Out NCDRIVESTRUCT_OUT2 IN For the Drive Out interface of the NC. Nc Enc In NCENCODERSTRUCT_IN2B OUT For the Encoder In interface of the NC. Nc Enc Out NCENCODERSTRUCT_OUT2 IN For the Encoder Out interface of the NC. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 292 Version: 1.4.0 TF8560
## Page 293

Utilities 7.5.4.4 Simulation of an SSI input terminal Simulation of a 1-channel SSI input terminal. This FB only provides a mapping interface and does not contain an implementation. Syntax: FUNCTION_BLOCK FB_Sim Ssi Input El Terminal1 Inputs Name Type Access Initial value Description Analog Value1 INT IN 0 The simulated input value of the 1st channel. Analog Value2 INT IN 0 The simulated input value of the 2nd channel. Analog Value3 INT IN 0 The simulated input value of the 3rd channel. Analog Value4 INT IN 0 The simulated input value of the 4th channel. Wc State BOOL OUT FALSE The simulated Working Counter State. Toggle BOOL OUT FALSE The simulated toggle bit. Info Data State UINT OUT 8 The simulated Device State. Ads Addr AMSADDR OUT The simulated ADS address. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.5.5 Components of the hydraulic simulation 7.5.5.1 FB_Sim Hyd Ax_Standard This FB is a simplified simulation of a universal hydraulic axis. A number of typical effects are supported. The implementation of this object is not a full-fledged and realistic simulation. Syntax: FUNCTION_BLOCK FB_Sim Hyd Ax_Standard EXTENDS FB_Sim Ax Common TF8560 Version: 1.4.0 293
## Page 294

Utilities Properties Name Type Access Description Actual Position LREAL Get, Set Simulated axis position. Notice The simulated position of the actuator can deviate from the reported axis position. FB_Sim Hyd Ax_Standard Cylinder I_Sim Cylinder [} 298] Get An interface to the local FB_Sim Cylinder object. Encoder I_Sim Universal Encoder Get An interface to the local FB_Sim Universal Encoder object. [} 301] External Force LREAL Get, Set This runtime value can be updated with pressure values required for process simulation. It is used to calculate the total pressure on the simulated cylinder and is part of the reported actual pressure. Overlapp_PA LREAL Get, Set Overlap on the A-side of the valve. Overlapp_PB LREAL Get, Set Overlap on the B-side of the valve. Pressure Transducer A I_Pressure Transducer Get An interface to the local FB_Pressure Transducer object on the A- [} 300] side of the FB_Sim Cylinder object. Pressure Transducer B I_Pressure Transducer Get An interface to the local FB_Pressure Transducer object on the B- [} 300] side of the FB_Sim Cylinder object. Qnominal_PA LREAL Get, Set Oil flow between the supply connection and the A-side connection of the valve. Qnominal_PB LREAL Get, Set Oil flow between the supply connection and the B-side connection of the valve. Spool Feedback INT Get Feedback value of the valve coil position. Supply Pressure LREAL Get, Set Supply pressure of the valve. Valve I_Sim Valve [} 296] Get An interface to the local FB_Sim Valve object on the B-side of the FB_Sim Cylinder object. Valve Control Value Type E_Sim Control Value Typ Get, Set The valve type used for the axis. e Valve Xyz <Diverse> Get, (Set) Forwarded values of the internal FB_Sim Valve instance. FB_Sim Ax Common Actual Velocity LREAL Get, Set Simulated axis velocity. Notice The simulated velocity of the actuator may deviate from the reported axis position. Absolut Switch BOOL Get This runtime value provides information about the simulated feedback signal as defined by Abs Switch High Select. Abs Switch High End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=TRUE: Absolut Switch is TRUE if the simulated actuator position is >= Abs Switch High End. Notice The simulated position of the actuator can deviate from the reported axis position. 294 Version: 1.4.0 TF8560
## Page 295

Utilities Name Type Access Description Abs Switch High Select BOOL Get, Set This parameter defines the active Absolut Switch. A TRUE selects Abs Switch High End, while a FALSE makes Abs Switch Low End the active Absolut Switch. Abs Switch Low End LREAL Get, Set This parameter defines the threshold value for the case Abs Switch High Select=FALSE: Absolut Switch is TRUE if the simulated actuator position is <= Abs Switch Low End. Notice The simulated position of the actuator can deviate from the reported axis position. Cycle Time LREAL Get, Set This parameter must be initialized with the update calling cycle of the Cyclic() method and will be forwarded to any sub-component if required. It is used to define any time behavior. Deny Enable BOOL Get, Set A TRUE blocks the feedback of the controller enable. This can be used to simulate a lack of response from the field device. Encoder Interpolation LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor denominator • Hydraulics library: encoder, inc. Interpolation Encoder Noise Level LREAL Get, Set The simulated axis offers the possibility to disturb the reported position with a pseudo- random white noise. This is realized by a FB_Noise() function block. The parameter Encoder Noise Level is forwarded as Set White Noise Level. Encoder Weighting LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: encoder, parameter, scaling factor numerator • Hydraulics library: encoder, weighting factor Encoder Zero Shift LREAL Get, Set This parameter must be initialized with the same value as the corresponding parameter in the motion technology: • NC: rotary encoder, parameter, position bias • Hydraulics library: encoder, zero offset High Side Block LREAL Get, Set The simulated position of the actuator is limited to a value less than or equal to this parameter. High Side Endswitch LREAL Get, Set This parameter defines the Upper End Switch threshold that becomes TRUE when the simulated position of the actuator is >= this parameter. High Side Spring Lengt LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the upper side of the actuator stroke. TF8560 Version: 1.4.0 295
## Page 296

Utilities Name Type Access Description Lower End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is >= High Side Endswitch. Low Side Block LREAL Get, Set The simulated position of the actuator is limited to a value above or equal to this parameter. Low Side Endswitch LREAL Get, Set This parameter defines the Lower End Switch threshold that becomes TRUE when the simulated position of the actuator is <= this parameter. Low Side Spring Length LREAL Get, Set This parameter defines the length of a simulated spring-like effect at the lower side of the actuator stroke. Moving Mass LREAL Get, Set This parameter can be used to define a moving mass. It is used to calculate dynamic acceleration and deceleration forces, torques or pressures. No Block BOOL Get, Set If this parameter is set to TRUE, the use of the springs and blocks on the upper and lower sides will be disabled. Reversed BOOL Get, Set The simulated axis works inverted. Upper End Switch BOOL Get This runtime value provides information about the state of a simulated sensor. Becomes TRUE if the position of the simulated actuator is <= Low Side Endswitch. Methods Name Description Go Fault State() [} 266] This method can be used to simulate an error situation on the simulated axis. FB_Sim Hyd Ax_Standard Cyclic() Cycle method Interfaces Type Description I_Sim Ax Common Standard interface for FB_Sim Ax Common. I_Sim Hyd Ax Standard interface for FB_Sim Hyd Ax_Standard. Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) Tc3_Plastic Hydraulic (>= v12.8.2.0) 7.5.5.2 FB_Sim Valve 296 Version: 1.4.0 TF8560
## Page 297

Utilities This simplified simulation of an analog proportional or servo valve is used as part of a simulated hydraulic axis. It supports a range of typical variants of non-linearities. There is no dynamic behavior. The implementation of this object is not a full-fledged and realistic simulation. Objects of this type are typically used as local elements in an implementation of an axis simulation. Syntax: FUNCTION_BLOCK ABSTRACT FB_Sim Valve Properties Name Type Access Description Ads Addr AMSADDR Get, Set This variable is used to implement a mapping interface of an analog valve. Control Value INT Get, Set This runtime value must be updated cyclically with an output property of a FB_Sim Analog Output El Terminal4 instance. This assignment can be understood as the cable connecting an output terminal to an input pin of the valve connector. Control Value Norm LREAL Get This runtime value provides information about the current control value in abstract units (e.g. %). Control Value Type E_Sim Control Val Get, Set This parameter must be initialized with a value that ue Type specifies the type of the control signal. It must match the type of the simulated output terminal. Info Data State UINT Get, Set This variable is used to implement a mapping interface of an analog valve. Orifice_PA LREAL Get This runtime value provides information about the current opening between the supply port and the A- side port of the valve. Orifice_PB LREAL Get This runtime value provides information about the current opening between the supply port and the B- side port of the valve. Overlapp_PA LREAL Get, Set This parameter must be initialized with the overlap on the A-side of the valve. Typical values can be found in the manufacturer's data sheets. Overlapp_PB LREAL Get, Set This parameter must be initialized with the overlap on the B-side of the valve. Typical values can be found in the manufacturer's data sheets. P_A LREAL Get, Set This runtime value reports about the pressure at the A-side port of the valve. P_B LREAL Get, Set This runtime value reports about the pressure at the B-side port of the valve. Q_PA LREAL Get This runtime value reports about the oil flow between the supply port and the A-side port of the valve. Q_PB LREAL Get This runtime value reports about the oil flow between the supply port and the B-side port of the valve. TF8560 Version: 1.4.0 297
## Page 298

Utilities Name Type Access Description Qnominal_PA LREAL Get, Set This parameter must be initialized with the capacity of the supply to the A-side opening of the simulated valve. Typical values can be found in the manufacturer's data sheets. Qnominal_PB LREAL Get, Set This parameter must be initialized with the capacity of the supply to the B-side opening of the simulated valve. Typical values can be found in the manufacturer's data sheets. Spool Feedback INT Get This runtime value reports about the actual position of the valve piston. It is used to implement a mapping interface of an analog valve. Supply Pressure LREAL Get, Set This runtime value must be updated with the supply pressure. If the value is assumed to be constant, it can be updated once during initialization. Toggle BOOL Get This variable is used to implement a mapping interface of an analog valve. Valve Spool Type E_Sim Valve Spoo Get, Set This parameter sets the transfer characteristic of the l Type valve. Wc State BOOL Get, Set This variable is used to implement a mapping interface of an analog valve. Methods Name Description Cyclic() Cycle method Interfaces Type Description I_Sim Valve Standard interface for FB_Sim Valve. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 7.5.5.3 FB_Sim Cylinder This simplified simulation of a universal cylinder is used as part of a simulated hydraulic axis. A number of typical effects are supported. The implementation of this object is not a full-fledged and realistic simulation. 298 Version: 1.4.0 TF8560
## Page 299

Utilities Objects of this type are typically used as local elements in an implementation of an axis simulation. Syntax: FUNCTION_BLOCK FB_Sim Cylinder Properties Name Type Access Description Cycle Time LREAL Get, Set This parameter must be initialized with the call cycle time. External Force LREAL Get, Set This runtime value can be used to update an external force in the simulation calculation. It is used for conversion to pressure values. High Side Block LREAL Get, Set The simulated upper mechanical stop. High Side Spring Length LREAL Get, Set The simulated spring action before the upper mechanical stop. Low Side Block LREAL Get, Set The simulated lower mechanical stop. Low Side Spring Length LREAL Get, Set The simulated spring action before the lower mechanical stop. P_A LREAL Get, Set The simulated pressure at the A-side cylinder port. P_B LREAL Get, Set The simulated pressure at the B-side cylinder port. Piston Diameter LREAL Get, Set The diameter of the cylinder piston. It is used to calculate the effective areas of the cylinder. Position LREAL Get, Set The current position of the cylinder. Q_PA LREAL Get, Set This runtime value provides information about the oil flow flowing into or out of the A-side cylinder port. This value is usually determined by a valve simulation and passed on by a hydraulic axis simulation. Q_PB LREAL Get, Set This runtime value provides information about the oil flow flowing into or out of the B-side cylinder port. This value is usually determined by a valve simulation and passed on by a hydraulic axis simulation. Rod Diameter LREAL Get, Set The diameter of the rod of the cylinder. It is used to calculate the effective areas of the cylinder. Stroke LREAL Get, Set The stroke length (i.e. the distance between the lower and upper mechanical end positions) of the cylinder. It is used to limit the actual position. Methods Name Description Cyclic() Cycle method TF8560 Version: 1.4.0 299
## Page 300

Utilities Interfaces Type Description I_Sim Cylinder Standard interface for FB_Sim Cylinder. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 7.5.5.4 FB_Sim Pressure Transducer This simplified simulation of a universal pressure transducer is used as component of a simulated hydraulic axis. A number of typical effects are supported. The implementation of this object is not a full-fledged and realistic simulation. Objects of this type are typically used as local elements in an implementation of an axis simulation. Syntax: FUNCTION_BLOCK FB_Sim Pressure Transducer Properties Name Type Access Description Adc Value INT Get This runtime value contains the input value of the simulated terminal. Cycle Time LREA Get, Set This parameter must be initialized with the call cycle time. Noise Level LREAL Get, Set This parameter can be used to set the amplitude of a simulated noise signal that is added to the pressure at the sensor. Nominal Pressure LREAL Get, Set This parameter must be initialized with the rated pressure (i.e. full scale) of the simulated transducer. Pressure LREAL Get, Set This runtime value must be updated cyclically with the pressure of a specific point in a simulated hydraulic system. Signal LREAL Get This runtime value contains the electrical signal of a simulated 0 to 10 V pressure transducer. Methods Name Description Cyclic() Cycle method 300 Version: 1.4.0 TF8560
## Page 301

Utilities Interfaces Type Description I_Sim Valve Standard interface for FB_Sim Valve. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 7.5.5.5 FB_Sim Universal Encoder This simplified simulation of a universal encoder is used as part of a simulated hydraulic axis. A number of typical effects are supported. The implementation of this object is not a full-fledged and realistic simulation. Objects of this type are typically used as local elements in an implementation of an axis simulation. Syntax: FUNCTION_BLOCK FB_Sim Universal Encoder Properties Name Type Access Description Ads Addr AMSADDR Get This variable is used to implement a mapping interface of an analog valve. Count_UDINT UDINT Get This variable is used to implement a mapping interface of an analog valve. Count_UINT UINT Get This variable is used to implement a mapping interface of an analog valve. Info Data State UINT Get, Set This variable is used to implement a mapping interface of an analog valve. Noise Level LREAL Get, Set This parameter must be initialized with the white noise amplitude to be simulated. Offset LREAL Get, Set This parameter must be initialized with the displacement between the cylinder zero point (e.g. the lower stop) and the encoder zero point. Position LREAL Get, Set This runtime value provides information about the actual position of the encoder. Resolution LREAL Get, Set This parameter must be initialized with the resolution (i.e. the path per increment) of the encoder. Reversed BOOL Get, Set The encoder operates inverted to the working direction of the cylinder. TF8560 Version: 1.4.0 301
## Page 302

Utilities Name Type Access Description Toggle BOOL Get This variable is used to implement a mapping interface of an analog valve. Wc State BOOL Get, Set This variable is used to implement a mapping interface of an analog valve. Methods Name Description Cyclic() Cycle method [PROTECTED] Returns the normalized encoder value. _Normalized() Interfaces Type Description I_Sim Universal Encoder Standard interface for FB_Sim Universal Encoder. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher 7.5.6 Sim Actuator This class simulates a digital linear actuator. Syntax: FUNCTION_BLOCK FB_Sim Actuator I/O variables Name Type Direction Description b Sens Base BOOL Output Sensor for the base position of the actuator. b Sens Work BOOL Output Sensor for the working position of the actuator. b Valve Base BOOL Input Valve for the base position of the actuator. b Valve Work BOOL Input Valve for the working position of the actuator. Properties Name Type Access Description Delay Base LREAL Get, Set Delay between signal for base position and sensor signal. Delay Work LREAL Get, Set Delay between signal for the working position and sensor signal. 302 Version: 1.4.0 TF8560
## Page 303

Utilities Name Type Access Description Enable BOOL Get, Set Enable the simulation. Has Mid Position BOOL Get, Set The simulated actuator valve has a middle position. Spring Returned BOOL Get, Set The simulated actuator valve is spring-returned. Methods Name Description Cyclic() Cycle method Interfaces Type Description I_Sim Actuator Standard interface on FB_Sim Actuator. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.55 PC or CX (x64, x86) Tc3_Plastic Functions (>= v3.12.5.0) 7.6 Debug 7.6.1 FB_Check Demo Mode A FB of this type can be instantiated and used by the PLC application to scan the fieldbus configuration. It reports on fieldbuses with special features such as real-time performance or USB support. Syntax: FUNCTION_BLOCK FB_Check Demo Mode Properties Name Type Description Demo Mode BOOL A TRUE after scanning the fieldbus configuration has one of the following causes: There is no fieldbus configured with real-time performance. Force Demo Mode=TRUE and Force Non Demo Mode=FALSE. Et C_detected BOOL A TRUE after scanning the fieldbus configuration signals that the configuration provides for an Ether CAT fieldbus. Force Demo Mode BOOL With a TRUE the Demo Mode can be forced. Force Non Demo Mode BOOL With a TRUE the Non Demo Mode can be forced. Non Demo Mode BOOL A TRUE after scanning the fieldbus configuration has one of the following causes: At least one fieldbus with real-time performance is configured. Force Demo Mode=FALSE and Force Non Demo Mode=TRUE. TF8560 Version: 1.4.0 303
## Page 304

Utilities Name Type Description Re Scan BOOL A TRUE on this property triggers a rescan of the fieldbus configuration. Rt Bus_detected BOOL A TRUE after scanning the fieldbus configuration signals that the configuration provides for a fieldbus with real-time performance. USB_detected BOOL A TRUE after scanning the fieldbus configuration signals that the configuration provides for a USB connection. This typically indicates a control panel. Methods Name Description Cyclic This method is to be called cyclically by the application. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.6.2 FB_Change Detector This class can recognize sudden changes in a value. Syntax: FUNCTION_BLOCK FB_Change Detector Properties Name Type Access Description Cycletime LREAL Get, Set Cycle time used for checking. Filter LREAL Get, Set Filter time over which a slight change in the value is adjusted. Tolerance LREAL Get, Set Tolerance above which a change is recognized. Methods Name Description Cyclic(f Value) Cycle method Notice Returns FALSE if f Value has changed. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 304 Version: 1.4.0 TF8560
## Page 305

Utilities 7.6.3 FB_Core Debug This class is used for better debugging of the core function chain. Syntax: FUNCTION_BLOCK FB_Core Debug Methods Name Description Axis State Increment Increments the internal counter value n Axis Statecounter. () Notice Is called by FB_Core Function. Axis State. Set . Axis State Reset() Resets the internal counter value n Axis Statecounter. Cyclic Counter Incre Increments the internal counter value n Cyclic Counter. ment() Notice Is called by FB_Core Function. Cyclic() . Cyclic Counter Reset Resets the internal counter value n Cyclic Counter. () Function Counter Inc Increments the internal counter value n Function Counter. rement() Notice Is called by FB_Core Function. Next Core. Set . Function Counter Re Resets the internal counter value n Function Counter. set() Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 7.7 Plc Mc Manager Support This class establishes the connection between Twin CAT 3 Plastic Technology Functions hydraulic axes and the Plc Mc Manager. Syntax: FUNCTION_BLOCK FB_Plc Mc Man Support Initialization parameters of the FB_init constructor Name Type Description Path STRING(172) File path under which the hydraulic configuration is to be saved. TF8560 Version: 1.4.0 305
## Page 306

Utilities Properties Name Type Access Description Path STRING(172) Get, Set File path under which the hydraulic configuration is to be saved. Methods Name Description Append(i Axis) Appends an axis from the internal list to be connected. Cyclic() Cycle method Prerequisites Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.56 PC or CX (x64, x86) Tc3_Plastic Functions (>= v12.8.2.0) Tc3_Plastic Hydraulic (>= v12.8.2.0) 7.8 External Hyd Axis Lib Ref This class represents a standard hydraulic axis of the Tc2_Hydraulic library (without using an FB_Axis Hydraulic Base). This allows standard hydraulic axes and TF8560-based hydraulic axes to communicate with the Plc Mc Manager in one application. Syntax: FUNCTION_BLOCK FB_External Hyd Axis Lib Ref VAR_INPUT st Axis Ref : AXIS_REF_Bk Plc Mc; END_VAR Inputs Name Type Description st Axis Ref AXIS_REF_Bk Plc Mc Reference to the hydraulic axis. Properties Name Type Access Description Next Hyd Axis I_External Hyd Axis Li Get, Set Interface to another hydraulic axis. b Ref Next Hyd Axis Chainl INT Get Length of the chain on hydraulic axes. ength Use Dat File BOOL Get, Set A TRUE here signals that the axis loads its parameters with function blocks of the hydraulics library from a file during startup. Notice A TRUE must be set before the first Cyclic call. 306 Version: 1.4.0 TF8560
## Page 307

Utilities Methods Name Description Get Hyd Axis Ref() Returns a POINTER to the AXIS_REF_Bk Plc Mc. [INTERNAL] Used internally. Leave Critical Sectio n() [INTERNAL] Used internally. Enter Critical Section () Interfaces Type Description I_External Hyd Axis Lib Ref Standard interface on FB_External Hyd Axis Lib Ref. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher Tc3_Plastic Hydraulic v3.12.4.26 or higher TF8560 Version: 1.4.0 307
## Page 308

Appendix 8 Appendix 8.1 Torque Limiting Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: Limiting [} 143] Original version: This function is responsible for the torque limitation of all axis functions. The following function blocks are automatically available internally for NC axes: • FB_Torque Limiting Co E - DS402 (AX8000) based Torque Limiting • FB_Torque Limitng So E - AX5000 based Torque Limiting No core function This function does not belong to any classification of core functions. It is only mentioned in the context of core functions, as it can be achieved via the properties of an axis. Syntax: FUNCTION_BLOCK FB_Torque Limiting Base EXTENDS FB_Message Base Properties Name Type Access Description Activate BOOL Get, Set Activates the use of the Actual Value as an active limit. Active Value LREAL Get Current torque value output. Actual Torque LREAL Get, Set Current actual torque value of the axis. Connected To Drive BOOL Get An internal connection to a drive unit has been established. Default Fb I_Torque Limiting Fb (Get, Set) Access to the standard function block for torque limitation if specific handling is used. Direction E_Adaptable Directio Get, Set Direction in which the torque limit should act. n Idle Value LREAL Get, Set The idle value for the torque limitation to which the axis returns after a command. Max Value LREAL Get, Set The effective limitation of the torque limit for each command. Nominal Value LREAL Get, Set The normalized value in relation to the Reference Value. Reference Value LREAL Get, Set Reference value for the maximum command value of the torque limit. 308 Version: 1.4.0 TF8560
## Page 309

Appendix Methods Name Description Return To Idle() [INTERNAL] Implements the behavior to end a command. Interfaces Type Description I_Torque Limiting Standard interface on FB_Torque Limiting Base. I_Torque Limiting Fb Extended interface for use as a core function. Requirements Development environ- Target platform PLC libraries to include ment Twin CAT v3.1.4024.35 PC or CX (x64, x86) Tc3_Plastic Functions v3.12.4.26 or higher 8.2 Pressure Control This section summarizes the obsolete elements of pressure control. Class is 'obsolete' This class is marked as obsolete and should not be used anymore! 8.2.1 I_Axis Base. Set Process Handler() Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: . Pressure Control. Supervisor. Set External() Original version: Reserved for extension: An interface to a FB for automatic pressure controller activation is entered. 8.2.2 PID. Enable Switch Over() Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: PID [} 154]. Allow Switch Over TF8560 Version: 1.4.0 309
## Page 310

Appendix This method can be used to enable or disable automatic activation by a pressure handler. Syntax: METHOD Enable Switch Over: HRESULT VAR_INPUT b Enable: BOOL; END_VAR Return value Name Type Description Enable Switch Over HRESULT See below Inputs Name Type Description b Enable BOOL The enable for automatic activation. 8.2.3 PID. Get Actual() Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: PID [} 154]. Actual Original version: The actual value of the controller is determined. Syntax: METHOD Get Actual : HRESULT VAR_INPUT f Actual: REFERENCE TO LREAL; END_VAR Return value Name Type Description Get Actual HRESULT See below Inputs Name Type Description f Actual REFERENCE TO A reference to the variable to be updated with the actual value. LREAL 310 Version: 1.4.0 TF8560
## Page 311

Appendix 8.2.4 PID. Get Params() Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: PID [} 154]. Parameters [} 158] Original version: An interface to the parameters of the controller is determined. Syntax: METHOD Get Params: HRESULT VAR_INPUT i Parameters: REFERENCE TO I_Pressure Control Params_PID; END_VAR Return value Name Type Description Get Params HRESULT See below Inputs Name Type Description i Parameters REFERENCE TO A reference to the variable to be updated with the I_Pressure Control Params_PID interface. 8.2.5 PID. Set Params() Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: PID [} 154]. Parameters [} 158] Original version: A parameter set is connected to the controller. Syntax: METHOD Set Params: HRESULT VAR_INPUT i Params: I_Pressure Control Params_PID [} 158]; END_VAR TF8560 Version: 1.4.0 311
## Page 312

Appendix Return value Name Type Description Set Params HRESULT See below Inputs Name Type Description i Parameters I_Pressure Control Params_PID An interface to the parameter set. 8.2.6 PID. Setpoint() Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: PID [} 154]. Target Original version: The setpoint of the controller is defined. Syntax: METHOD Setpoint: HRESULT VAR_INPUT f Value: LREAL; END_VAR Return value Name Type Description Setpoint HRESULT See below Inputs Name Type Description f Value LREAL The setpoint. 8.2.7 FB_Process Handler Base Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: Pressure Control. Supervisor [} 163] 312 Version: 1.4.0 TF8560
## Page 313

Appendix Original version: This function block is used in injection molding machines to switch from injection pressure to holding pressure. Syntax: FUNCTION_BLOCK FB_Process Handler Base IMPLEMENTS I_Process Handler VAR_INPUT END_VAR VAR_OUTPUT END_VAR Properties Name Type Description Axis I_Axis Base An interface to the axis to be monitored. Bad Switch Over BOOL TRUE if an undesired switchover occurred. Process Value LREAL The process value to be monitored. Switch Over BOOL TRUE if an expected switchover occurred. Methods Name Description Get Control Parameter This method can be used to get access to the parameter container of the axis pressure controller. [} 314] Get Process Values [} 314] This method is used to update the FB with a range of actual values (pressure, position, state) of the axis. This method is called cyclically by the axis. The application is not intended to call this method directly. Get Switch Enable [} 314] This method is used to read back the rules for the switchover. Get Switch Parameter [} 315] This method may be used to read back parameters of the switchover rules. Set Control Parameter This method can be used to assign a parameter container to the axis pressure controller. [} 315] Set Switch Enable [} 316] This method is used to define the rules for the switchover. See below for more information. Set Switch Parameter [} 316] This method may be used to define parameters of the switchover rules. If the monitored axis is in an inactive state (Init, Ready, Idle), the FB is inactive. An active command of the axis also activates the monitoring. The rules set with Set Switch Enable determine the response: If no faulty switchover has been detected yet: • If b Switch On Pressure is TRUE and the process value exceeds e Pressure Threshold and the axis was moved longer than e Garding Travel from the start point, an expected switchover is detected. • If b Switch On Travel is TRUE and the axis has traveled longer than e Travel Threshold from the start point, an expected switchover is detected. • If b Switch On Time is TRUE and the time since the start of monitoring exceeds the e Time Threshold, an expected switchover is detected. • If there is more than one active rule the first match will cause the expected switchover. TF8560 Version: 1.4.0 313
## Page 314

Appendix If there was still no switchover: • If e Timeout is set to more than 0.0 and the time since the start of monitoring exceeds e Timeout, a faulty switchover is detected. • If the axis position falls below e Alarm Position Limit, a faulty switchover is detected. • If e Alarm Pressure Limit is set to more than 0.0 and the process value exceeds e Alarm Pressure Limit, a faulty switchover is detected. 8.2.7.1 Get Control Parameter This method can be used to get access to the parameter container of the axis pressure controller. Syntax: METHOD Get Control Parameter : I_Pressure Control Params_PID VAR_INPUT END_VAR 8.2.7.2 Get Process Value This method is used to update the FB with a range of actual values (pressure, position, state) of the axis. This method is called cyclically by the axis. The application is not intended to call this method directly. Syntax: METHOD Get Process Values : HRESULT VAR END_VAR 8.2.7.3 Get Switch Enable This method is used to read back the rules for the switchover. Syntax: METHOD Get Switch Enable : HRESULT VAR_INPUT b Switch On Pressure: REFERENCE TO BOOL; b Switch On Travel: REFERENCE TO BOOL; b Switch On Time: REFERENCE TO BOOL; END_VAR 314 Version: 1.4.0 TF8560
## Page 315

Appendix Inputs Name Type Description b Switch On Pressure REFERENCE TO BOOL A reference to the variable to be updated with the parameter. b Switch On Travel REFERENCE TO BOOL A reference to the variable to be updated with the parameter. b Switch On Time REFERENCE TO BOOL A reference to the variable to be updated with the parameter. 8.2.7.4 Get Switch Parameter This method may be used to read back parameters of the switchover rules. Syntax: METHOD Set Switch Parameter : HRESULT VAR_INPUT e Select: E_Switchover Parameter; f Value: REFERENCE TO LREAL; END_VAR Inputs Name Type Description e Select E_Switchover Parameter [} 316] The selection of the parameter. f Value REFERENCE TO LREAL A reference to the variable to be updated with the parameter. 8.2.7.5 Set Control Parameter This method can be used to assign a parameter container to the axis pressure controller. Syntax: METHOD Set Control Parameter : HRESULT VAR_INPUT i Params: I_Pressure Control Params_PID; END_VAR Inputs Name Type Description i Params I_Pressure Control Params_PID An interface to a FB with a parameter set for a pressure controller. TF8560 Version: 1.4.0 315
## Page 316

Appendix 8.2.7.6 Set Switch Enable This method is used to define the rules for the switchover. See below for more information. Syntax: METHOD Set Switch Enable : HRESULT VAR_INPUT b Switch On Pressure: BOOL; b Switch On Travel: BOOL; b Switch On Time: BOOL; END_VAR Inputs Name Type Description b Switch On Pressure BOOL A TRUE enables the switchover by exceeding the pressure threshold. b Switch On Travel BOOL A TRUE enables the switchover by falling below a position threshold. b Switch On Time BOOL A TRUE enables the switchover by reaching a time threshold. 8.2.7.7 Set Switch Parameter This method may be used to define parameters of the switchover rules. Syntax: METHOD Set Switch Parameter : HRESULT VAR_INPUT e Select: E_Switchover Parameter; f Value: LREAL; END_VAR Inputs Name Type Description e Select E_Switchover Parameter [} 316] The selection of the parameter. f Value LREAL The value with which the parameter should be updated. 8.2.7.8 E_Switchover Parameter Values of this enumeration are use by Get Switch Parameter() and Set Switch Parameter() of FB_Process Handler Base [} 312]. TYPE E_Switchover Parameter : ( e Pressure Threshold := 0, e Garding Travel, e Travel Threshold, e Time Threshold, e Alarm Pressure Limit, e Alarm Position Limit, 316 Version: 1.4.0 TF8560
## Page 317

Appendix e Timeout ); END_TYPE 8.2.8 FB_Read Process Value Class is 'obsolete' This class is marked as obsolete and should not be used anymore! Alternative: Pressure Control. Supervisor [} 163] Original version: A function block of this type is used to supply a function block of type FB_Process Handler Base [} 312] with actual values. Syntax: FUNCTION_BLOCK FB_Read Process Value EXTENDS FB_Message Base IMPLEMENTS I_Read Process Value VAR_INPUT END_VAR VAR_OUTPUT f Actual Value: LREAL; END_VAR Outputs Name Type Description f Actual Value LREAL The current actual value. Properties Name Type Access Description Offset LREAL Get, Set The offset taken into account when calculating the actual value. Process Value LREAL Get The current process value calculated by the last call to Cyclic(). Weighting LREAL Get, Set The scaling factor. Methods Name Description Cyclic [} 318] This method must be called by the application once per cycle. It checks the Ether CAT connection and updates the Process Value with a filtered actual value. Do Reset [} 318] A call of this method with b Execute=TRUE resets the connected sensor interface and clears all local errors. TF8560 Version: 1.4.0 317
## Page 318

Appendix 8.2.8.1 Cyclic This method must be called by the application once per cycle. It checks the Ether CAT connection and updates the Process Value with a filtered actual value. Syntax: METHOD Cyclic VAR_INPUT END_VAR 8.2.8.2 Do Reset A call of this method with b Execute=TRUE resets the connected sensor interface and clears all local errors. Syntax: METHOD Do Reset : HRESULT VAR_INPUT b Execute: BOOL; END_VAR 318 Version: 1.4.0 TF8560
## Page 319

Trademark statements Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H.
## Page 320

More Information: www.beckhoff.com/tf8560.html Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
