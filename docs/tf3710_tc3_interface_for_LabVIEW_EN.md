---
title: "tf3710_tc3_interface_for_LabVIEW_EN"
product: "tf3710"
category: "Analytics"
tags: ["LAB", "VIEW"]
language: "EN"
document_type: "Manual"
version: "1.8.1"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/tf3710_tc3_interface_for_LabVIEW_EN.pdf"
release_date: "2025-10-13"
---
Manual | EN TF3710 Twin CAT 3 | Interface for Lab VIEW™ 2025-10-13 | Version: 1.8.1
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 1.4 Documentation issue status.............................................................................................................. 8 2 Overview.................................................................................................................................................... 9 3 Installation............................................................................................................................................... 11 4 Licensing................................................................................................................................................. 16 5 Quick start............................................................................................................................................... 19 6 Technical introduction............................................................................................................................ 23 6.1 Twin CAT ADS................................................................................................................................. 23 6.2 Communication modes................................................................................................................... 25 6.2.1 One-time reading............................................................................................................. 28 6.2.2 One-time writing............................................................................................................... 30 6.2.3 Reading data continuously............................................................................................... 31 6.2.4 Writing data continuously................................................................................................. 36 6.3 Type Resolving............................................................................................................................... 37 6.4 Heartbeat Connection Monitoring................................................................................................... 39 7 Lab VIEW™ VIs......................................................................................................................................... 42 7.1 ADS DAQ........................................................................................................................................ 47 7.2 ADS Flex DAQ................................................................................................................................. 56 7.3 ADS Write Assistant........................................................................................................................ 62 7.4 Symbol Interface............................................................................................................................. 67 7.5 Init................................................................................................................................................... 68 7.6 ADS-Read....................................................................................................................................... 69 7.7 ADS-Write....................................................................................................................................... 74 7.8 Type Resolver.................................................................................................................................. 76 7.9 Release........................................................................................................................................... 76 7.10 Utilities............................................................................................................................................. 77 7.10.1 Notification....................................................................................................................... 80 7.10.2 LVBuffer........................................................................................................................... 81 7.10.3 Co E.................................................................................................................................. 83 7.10.4 Heartbeat......................................................................................................................... 86 7.10.5 Project Automation........................................................................................................... 88 7.11 Low-Level........................................................................................................................................ 91 7.11.1 Init.................................................................................................................................... 91 7.11.2 Read................................................................................................................................. 93 7.11.3 Write................................................................................................................................. 95 7.11.4 Type Resolver................................................................................................................... 97 7.11.5 Sum Up........................................................................................................................... 103 7.12 With Type Resolving...................................................................................................................... 106 8 Samples................................................................................................................................................. 109 TF3710 Version: 1.8.1 3
## Page 4

Table of contents 8.1 Basic examples............................................................................................................................. 109 8.2 Application example...................................................................................................................... 118 9 Appendix................................................................................................................................................ 120 9.1 Overview of error codes................................................................................................................ 120 9.2 ADS Return Codes........................................................................................................................ 121 9.3 Data types..................................................................................................................................... 124 9.4 Runtime Return Codes.................................................................................................................. 126 9.5 Support Return Codes.................................................................................................................. 130 4 Version: 1.8.1 TF3710
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TF3710 Version: 1.8.1 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.8.1 TF3710
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF3710 Version: 1.8.1 7
## Page 8

Foreword 1.4 Documentation issue status Version Changes 1.8.1 Optimized VI icons 1.8.x New: • VIs that can be used to create a Heartbeat [} 86] connection monitoring between Lab VIEWTM and Twin CAT. • Project Automation [} 88]: VIs that can be used to create, configure, and activate a Twin CAT 3 project. 1.7.x • Supports Lab VIEW™ 2024 • Settings for displaying timestamps in UTC time format [} 125] • Further information on the Co E interface has been added, see Utilities > Co E [} 83]. 1.6.x • Adjustments in the ADS Flex DAQ [} 56] area • New: Description of the VIs Add Read/Write symbol [} 91] 1.5.x Twin CAT 3.1 Build 4026 • Brief information on installation [} 11] New: • Co E Read and Co E Write [} 83] ◦ VIs for reading and writing Co E objects from Lab VIEW™ • Sample Co E Reading or Writing [} 116] 8 Version: 1.8.1 TF3710
## Page 9

Overview 2 Overview The Twin CAT 3 interface for Lab VIEW™ enables data exchange between Lab VIEW™ and one or more Twin CAT runtime environments. The data exchange takes place via the Twin CAT ADS protocol. Product information TF3710 Twin CAT 3 interface for Lab VIEW™ combines the worlds of NI™ and Beckhoff. High-performance data exchange between a Twin CAT runtime environment and your Lab VIEW™ application gives you the option to implement part of your application in Twin CAT and another part in Lab VIEW™. The apportionment is up to the user. In a minimal configuration, you can use Twin CAT solely as a driver for your fieldbus devices and implement your application entirely in Lab VIEW™. Similarly, you can implement your application mainly in Twin CAT and use Lab VIEW™ only as an HMI. The Twin CAT 3 interface for Lab VIEW™ supports all Lab VIEW™ editions including Base, Full, Professional and also the Runtime Engine, so that you can optionally deliver your Lab VIEW™ application as a stand- alone application with the Lab VIEW™ application builder. The Windows operating systems on Beckhoff IPCs and Embedded PCs are ideally suited as a platform directly on the machine controller. Product components The product TF3710 Twin CAT 3 Interface for Lab VIEW™ consists of the following components: • Lab VIEW™ Virtual Instruments (VIs) for your Function palette, • Product-specific Dynamic Link Libraries (DLLs), • Example VIs. • Integration of VIs for configuration in the Toolbox menu. TF3710 Version: 1.8.1 9
## Page 10

Overview When installing on a system with Lab VIEW™ runtime, only the DLLs are installed; otherwise all components are installed. 10 Version: 1.8.1 TF3710
## Page 11

Installation 3 Installation System requirements The minimum requirements for using the TF3710 Twin CAT 3 Interface for Lab VIEW™ product are described below. Please observe the following distinction: the TF3710 license is required on the Twin CAT runtime environment. The components of the TF3710 Twin CAT 3 Interface for Lab VIEW™, on the other hand, are required on the system with the Lab VIEW™ installation. Engineering In your engineering environment you need a Twin CAT 3.1 ADS installation, in addition to Lab VIEW™. There is no need to install Twin CAT 3.1 ADS if you have a Twin CAT 3 Engineering environment or a Twin CAT Runtime installed on your engineering system. • Twin CAT 3.1 ADS • Lab VIEW™ 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025 ◦ Runtime, Base, Full, Community, Professional Edition ◦ 32-bit, 64-bit Runtime For the Twin CAT runtime you need the following components: • Twin CAT 3.1 XAR build 3.1.4024.12 or higher If a lower version is required, please contact Beckhoff Support. • Operating systems: Windows operating system, Twin CAT/BSD, Beckhoff RT Linux® (only from Twin CAT 3 Build 4026) • One license for TF3710 Twin CAT 3 Interface for Lab VIEW™ For testing purposes, a 7-day trial version can be activated repeatedly. For the Lab VIEW™ runtime the following components are required: • Lab VIEW™ Runtime Engine 2017, 2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025 • Windows NT-based operating system It should be noted that the Twin CAT and Lab VIEW™ runtimes can be installed on the same system or on separate systems connected via a network. Twin CAT Package Manager: Installation (Twin CAT 3.1 Build 4026) Detailed instructions on installing products can be found in the chapter Installing workloads in the Twin CAT 3.1 Build 4026 installation instructions. Install the following workload to be able to use the product: TF3710 Version: 1.8.1 11
## Page 12

Installation Twin CAT Package Manager UI: TF3710 | Twin CAT 3 Interface for Lab VIEW™ Twin CAT Package Manager CLI: tcpkg install TF3710. Interface For Lab VIEW. XAE Twin CAT setup: Installation (Twin CAT 3.1 Build 4024 and earlier) The following section describes the installation of the Twin CAT 3 Function Twin CAT 3 Interface for Lab VIEWTM for Windows-based operating systems. NOTICE Different setups for 32bit and 64bit Lab VIEW™ Two setups can be found on the download page of the Beckhoff website. The setup labeled "x86" integrates the interface for Lab VIEW™ into installed 32bit Lab VIEW™ environments. The setup labeled "x64" is suitable for 64bit Lab VIEW™ environments. ü The Twin CAT 3 function setup file was downloaded from the Beckhoff website. 1. Run the setup file as administrator. To do this, select the Run As Admin command in the context menu of the file. ð The installation dialog opens. 2. Accept the end user licensing agreement and click Next. 12 Version: 1.8.1 TF3710
## Page 13

Installation 3. Enter your user data. TF3710 Version: 1.8.1 13
## Page 14

Installation 4. If you want to install the full version of the Twin CAT 3 function, select Complete as installation type. This installs the product for each Lab VIEW™ found on the system. Select Custom if you only want to install the product for individual Lab VIEW™ environments. 14 Version: 1.8.1 TF3710
## Page 15

Installation 5. Click Next, then Install to start the installation. ð A dialog box informs you that the Twin CAT system must be stopped to proceed with the installation. 6. Confirm the dialog with Yes. 7. Click Finish to exit the setup. ð The Twin CAT 3 function has been successfully installed and can be licensed (see Licensing). Mass compile During installation, the Twin CAT 3 Interfaces for Lab VIEW™ library is added for the mass compilation of VIs. A Lab VIEW™ VI is started for this purpose. TF3710 Version: 1.8.1 15
## Page 16

Licensing 4 Licensing The Twin CAT 3 function can be activated as a full version or as a 7-day test version. Both license types can be activated via the Twin CAT 3 development environment (XAE). Licensing the full version of a Twin CAT 3 Function A description of the procedure to license a full version can be found in the Beckhoff Information System in the documentation "Twin CAT 3 Licensing". Licensing the 7-day test version of a Twin CAT 3 Function A 7-day test version cannot be enabled for a Twin CAT 3 license dongle. 1. Start the Twin CAT 3 development environment (XAE). 2. Open an existing Twin CAT 3 project or create a new project. 3. If you want to activate the license for a remote device, set the desired target system. To do this, select the target system from the Choose Target System drop-down list in the toolbar. ð The licensing settings always refer to the selected target system. When the project is activated on the target system, the corresponding Twin CAT 3 licenses are automatically copied to this system. 4. In the Solution Explorer, double-click License in the SYSTEM subtree. ð The Twin CAT 3 license manager opens. 5. Open the Manage Licenses tab. In the Add License column, check the check box for the license you want to add to your project (e.g. "TF3710 Twin CAT 3 Interface for Lab VIEW"). 16 Version: 1.8.1 TF3710
## Page 17

Licensing 6. Open the Order Information (Runtime) tab. ð In the tabular overview of licenses, the previously selected license is displayed with the status “missing”. 7. Click 7-Day Trial License... to activate the 7-day trial license. TF3710 Version: 1.8.1 17
## Page 18

Licensing ð A dialog box opens, prompting you to enter the security code displayed in the dialog. 8. Enter the code exactly as it is displayed and confirm the entry. 9. Confirm the subsequent dialog, which indicates the successful activation. ð In the tabular overview of licenses, the license status now indicates the expiry date of the license. 10. Restart the Twin CAT system. ð The 7-day trial version is enabled. Quick-Guide: license query fails Different error messages may occur during the license query in Lab VIEW™, e.g.: License state issue, No License found, License expired, License invalid, License invalid System id. Check the following: • If a license query failed previously, restart Lab VIEW™ so that the ADS client in Interface for Lab VIEW™ is completely unloaded. • Use the Twin CAT XAE to check the license status on the target system and adjust it if necessary. 18 Version: 1.8.1 TF3710
## Page 19

Quick start 5 Quick start The following describes how to set up the connection between Lab VIEWTM and Twin CAT using an exemplary measuring task. Thereby data is generated in Twin CAT, which is read by Lab VIEWTM. Activating a Twin CAT project ü Download this https://infosys.beckhoff.com/content/1033/TF3710_TC3_Interface_for_Lab VIEW/Resources/ 10083995531.zip. There is a tnzip file in the ZIP archive. 1. Open Twin CAT XAE and select File > Open > Open Solution From Archive... to load the tnzip. 2. If you do not already have a valid TF3710 license on the target system, go to System > License > Manage Licenses and select the checkbox for the TF3710 license. 3. Activate the project, e.g. on your local PC or on a remote target system and start the PLC. ð The Twin CAT project is now running on your target system. Creating Lab VIEW™ project ü Lab VIEW™ is open. 1. Create a new project and open an empty VI. 2. Save the VI. 3. Place an instance of the ADS DAQ VI on the block diagram. To do this, navigate in the Functions palette to User Libraries > Beckhoff Lab VIEW Interface > ADS DAQ. ð A user interface for configuring the connection to Twin CAT opens automatically. 4. Select Symbol Interface to create a new configuration. 5. Browse with the Target Browser in the middle field into your target on which you have activated the Twin CAT project. 6. Then select the ADS symbols to be read. Navigate to 851: Port851 > MAIN and select the ADS symbols a AM and a Sine. Drag and drop both icons to the right area (ADS Read area). TF3710 Version: 1.8.1 19
## Page 20

Quick start 7. Click OK. ð The Symbol Interface Configurator closes and you are shown further setting options. Don't change the default settings and select Finish. ð The user interface is closed and code is automatically generated on the block diagram according to the configuration. You can change and extend this individually. 20 Version: 1.8.1 TF3710
## Page 21

Quick start Extending block diagram ü Code was generated on the block diagram (see above). 8. Extend the block diagram, e.g. with a waveform graph. 9. Set your VI to Run mode. ð In this case, look at the two time signals on the front panel. TF3710 Version: 1.8.1 21
## Page 22

Quick start 22 Version: 1.8.1 TF3710
## Page 23

Technical introduction 6 Technical introduction Data exchange between Lab VIEW™ and Twin CAT 3 takes place using the Automation Device Specification (ADS) server-client protocol. With the Interface for Lab VIEW™ an ADS client is realized in Lab VIEW™, which enables a performant data exchange with Twin CAT runtimes. The Twin CAT runtimes implement the ADS server accordingly. 6.1 Twin CAT ADS Basic structure of ADS devices and ADS symbols Automation Device Specification (ADS) forms the basis for the Lab VIEW™ interface. ADS describes a device- and fieldbus-independent interface and enables communication between ADS devices. The ADS device concept and the identification of an ADS device are explained below. The modular system architecture of Twin CAT allows the individual parts of the software (e.g. Twin CAT PLC, Twin CAT NC ...) to be regarded as independent devices: there is a software module for each individual task. The servers in the system are the executing devices that provide certain services. The clients are programs that request the services of the servers. A client initially establishes a connection to the server and requests a service: for example, it requests reading the value of a variable or it requests writing a variable. The interface for Lab VIEW™ provides an ADS client interface, which enables data exchange (read and write) with Twin CAT runtimes. The Twin CAT runtime, or its ADS devices, thus provide their services as ADS servers and can be used from Lab VIEW™. ADS data exchange between ADS devices takes place via the ADS router. As shown in the diagram above, data exchange between ADS devices implemented on the same system takes place via the system memory. If two ADS devices, e.g. Lab VIEW™ and the Twin CAT runtime, are on different systems, a route can be created between two ADS routers. When creating the ADS route, the transport type (usually TCP/IP) for communication between the two ADS routers can be defined. Accordingly, an ADS device identifies itself via the AMS Net Id of the ADS router and a port number, which then specifies the ADS device on the system. For example, port 851 is the default port for the first PLC instance in the Twin CAT runtime. ADS services of an ADS device are then specified by two parameters, the Index Group and the Index Offset. For example, a PLC variable is accessible for reading or writing under a specific Index Group and Index Offset. If an application is to be created that is to be used on several target systems and in which Lab VIEWTM and Twin CAT run on the same system, the relative AMS Net Id can be used. The relative AMS Net Id always points to the local system. For this purpose, 0.0.0.0.0.0 is used for the address. TF3710 Version: 1.8.1 23
## Page 24

Technical introduction Summary • AMS Net Id: Identifies the ADS router, i.e. the system. • ADS Routes • Port: Identifies an ADS device. • Index Group/Offset: Specifies the ADS system service, e.g. a variable for reading and writing. In order to make the addressing of variables in a Twin CAT runtime more convenient for the user, Twin CAT creates ADS symbols, which can be searched with the Target Browser, for example. The Target Browser is also integrated into the interface for Lab VIEW™ in the VI Symbol Interface [} 67] so that ADS symbols can be selected easily and quickly. An ADS symbol for a variable in Twin CAT then contains the information mentioned above: AMS Net Id, Port, Index Group and Index Offset and furthermore the Bit Size as well as a symbol name and the data type of the variable. For more information on ADS, please see the following links: • AMS Net Id and Port: ADS device identification • Index Group and Index Offset: Specification for ADS devices • ADS Routes: System Node "Routes" and Add Route • Connecting Devices with same AMS Net Id: Ams NAT • Using MQTT and Message Broker with ADS: ADS-over-MQTT • TLS encrypted ADS: Secure ADS • Target Browser • Record ADS communication: ADS Monitor Basic ADS data communication Basically, there are three different possibilities/modes for data communication in ADS. Synchronous reading or writing • The ADS client in Lab VIEW™ waits for a response from the ADS server before proceeding with code execution. Asynchronous reading or writing • The ADS client in Lab VIEW™ sends a read or write request to the ADS server but does not wait for a response; instead, it continues to execute other parts of the program (for example, requests to other variables). Event-based communication (read only) • An ADS notification is only registered once on the server. The notification can be registered "on change" or "cyclic". After a notification has been registered at the server, it sends requested data to the server without any further requests from the client. 24 Version: 1.8.1 TF3710
## Page 25

Technical introduction The VIs ADS Read [} 69] and ADS Write [} 74] are polymorphic. The desired communication mode (sync, async or notification) can be selected there. The VIs also provide extensions to these basic modes that involve Lab VIEW™-side buffering of data and passing it to the Lab VIEW™ process. 6.2 Communication modes Initial classification The extensions to the basic functionalities (sync, async and notification) are explained below. Practical recommendations are also given as to which mode is a preferred choice for exemplary applications. The following table shows all provided modes with an initial classification. Mode Read Write Short description Sync Single [} 28] X X Read/write a variable in a self-contained one-time action. The client waits during the request to the server. Async Single [} 29] X X Read/write a variable in a self-contained one-time action. The client does not wait during the request to the server. Noti. Single [} 29] X Waiting for an "On Change" event in Twin CAT as a one-time action. The notification is unregistered after the event. Noti. Buffered [} 29] X One-time reading of a time series with a defined length. The notification is unregistered after receiving the time series. E-Noti. Single [} 33] X Continuous reading (cyclic or "on change"). The notification is not automatically unregistered; it runs until it is explicitly unregistered. The notifications received are forwarded to an event structure in Lab VIEW™. E-Noti. Buffered [} 35] X Buffered continuous reading (cyclic or "on change“). The notification is not automatically unregistered; it runs until it is explicitly unregistered. The notifications received are forwarded to an event structure in Lab VIEW™. The buffer enables higher data throughput, but causes latency. LVB-Noti. Single [} 31] X Continuous reading (cyclic or "on change"). The notification is not automatically unregistered; it runs until it is explicitly unregistered. On the Lab VIEW side, the data is written to a buffer to which the user has direct access. In the table above some modes are assigned the property "Buffered". The diagram below illustrates the system structure. For "Noti. Buffered" and "E-Noti. Buffered", the addressed buffer refers to a Lab VIEW™- side buffer of size LVBuffer Size. The buffer is filled with data read from Twin CAT and transferred to Lab VIEW™ when the buffer size is reached. In addition, there is a Twin CAT-side buffer from the standard ADS interface, which, however, can only be used with ADS notifications of the type Cyclic. By default the size of this buffer is Tc Buffer Size = 10 samples, although it can be adjusted. TF3710 Version: 1.8.1 25
## Page 26

Technical introduction In the following section, the above example is considered with the following parameters: Tc Buffer Size = 10 LVBuffer Size = 500 ADS notification of the Cyclic type with 1 ms sample time (corresponds here to the cycle time of the PLC). Every 1 ms a sample is now written into the Twin CAT-side buffer. After 10 ms the buffer is full and is transferred to the Lab VIEW™-side buffer. After receiving 50 messages with 10 samples each, i.e. after 500 ms (plus communication time), the Lab VIEW™-side buffer is full and then transfers the entire data packet of 500 samples to Lab VIEW™. Accordingly, there is a delay time of at least 500 ms until the data packet is received in Lab VIEW™. The minimum expected delay time is also displayed in the configuration dialog (Edit Symbol Parameters) in the lower part as "Expected min delay". Parameterizing and realizing the communication modes The parameters mentioned in the above section can be set in the User Interface (UI) of the Symbol Interface [} 67]. 26 Version: 1.8.1 TF3710
## Page 27

Technical introduction In addition to the parameterization of the ADS symbols, the basic structure of the Lab VIEW™ program must be observed, which is outlined below. The Symbol Interface [} 67] opens a dialog with the Target Browser and the possibility to parameterize each ADS symbol according to the above figure. The output of the Symbol Interface is a string in XML format describing all selected ADS symbols and their parameterization. This string is linked to the Init VI [} 68]. Alternatively, the Symbol Interface can export the XML. This XML file can then be passed directly to the Init VI. The Init VI then passes handles of the ADS symbols to a Read VI [} 69], which can be set as a polymorphic VI to the options described above. At the output there are data handles, which are linked with a Type Resolver VI [} 76]. The output of the Type Resolver VI is a Variant Type, which can be cast to the correct format. When writing, the order of Type Resolver and Write VI [} 74] is reversed accordingly. TF3710 Version: 1.8.1 27
## Page 28

Technical introduction The above diagram illustrates the structure with Low Level VIs. To simplify programming, several Low Level VIs are combined, depending on the communication mode. See Sync Read [} 28] or Async Read [} 29], for example. Practical considerations There are various options for reading data. In order to simplify the selection in practice, a table is provided below which describes exemplary application scenarios and suggests a communication mode. Signal type in Example Communication mode Twin CAT Quasi-static Read the current parameter set of a PID controller Sync Read [} 28], Async parameters or the ID of the current product in the machine. Read [} 29] Reading machine settings. Continuous Stream of one or more sensor signals (temperature, Fast response required: E- signal strain, force, …). There is no defined end of the Noti. Single [} 33] data stream. (Transmode "cyclic") High data throughput: E- General DAQ application Noti. Buffered [} 29] or LVB-Noti. Single [} 31] Event Waiting for Twin CAT event, e.g. start of a process: Noti. Single [} 29] b Start changes from FALSE to TRUE. (Transmode "on change") The event appears once. It is then no longer required and can be unregistered. Event Responding to changes in states, e.g. changing the E-Noti. Single [} 33] signals to be read depending on the state of the (Transmode "on change") machine: Viewing the n State variables. The event occurs frequently and this event should be observed throughout. Signal of defined length Reading of exactly 1000 samples of a specific Noti. Buffered [} 29] sensor signal. 6.2.1 One-time reading This communication mode is ideal, for reading a Twin CAT configuration or a completely filled data buffer in the PLC once, for example. In contrast to continuous reading [} 31], one-time reading requires no additional programming in Lab VIEW™. The TF3710 Twin CAT 3 Interface for Lab VIEW™ product categorizes one-time reading into four cases: 1. Synchronous reading 2. Asynchronous reading 3. Notification Single 4. Notification Buffered Synchronous reading With synchronous reading, after a request has been sent by the client, a response from the ADS server is awaited before the program code is executed further. The reader is released immediately after successful confirmation from the server. This type of reading is therefore suitable for calculating or displaying the data directly after it has been received from Twin CAT. The polymorphic "Sync Single" block is composed of several low-level VIs [} 91] and thus combines the creation of a handle, reading and releasing. 28 Version: 1.8.1 TF3710
## Page 29

Technical introduction Examples in Lab VIEW™: Simple Read with Type Resolving [} 109] Asynchronous reading With asynchronous reading, the client does not wait for a response from the ADS server. In this mode, there is no guarantee that the reader has already received the data packet or not. As a result, the reader cannot be released. The polymorphic VI "Async Single" therefore initializes the reader and sends the request to Twin CAT. The release is not part of the VI. Examples in Lab VIEW™: Read Async with Type Resolving [} 110] Notification Single Notification Single is only supported for Transmode "on change". Unlike Notification E-Single [} 33], the block "Noti. Single" does not require a user-programmed event structure. The notification is only intended for one-time use, i.e. to catch a one-time event. The notification is registered in the background, received and then removed. This block returns an array of two values, the last state before the value change and the new state after the value change, e.g. [FALSE, TRUE], if a variable has changed its value from FALSE to TRUE. Examples in Lab VIEW™: Simple Read with Type Resolving [} 109] Notification Buffered Unlike E-Buffered Notification [} 35], the block "Noti. Buffered" does not require a user-programmed event structure. The block uses a buffer of size LVBuffer Size to save the data received from Twin CAT in an intermediate layer. The notification is not removed until the buffer is full. The saved data are then passed to Lab VIEW™. Accordingly, reception of a time series with predefined length (LVBuffer Size samples) can easily be realized with this communication mode. TF3710 Version: 1.8.1 29
## Page 30

Technical introduction NOTICE LVBuffer Size The buffer size is determined by the parameter LVBuffer Size when creating the ADS symbol, see Symbol Interface [} 67] VI. Examples in Lab VIEW™: Simple Read with Type Resolving [} 109] 6.2.2 One-time writing The Twin CAT 3 Interface for Lab VIEW™ categorizes one-time writing as follows: 1. Synchronous writing 2. Asynchronous writing Synchronous writing During synchronous writing, the system waits for a response from the server (Twin CAT). The writer is released after the data packet has successfully been sent to Twin CAT. This process is performed in the background by the polymorphic VI "Sync Single". Examples in Lab VIEW™: Write Sync with Type Resolving [} 111] Asynchronous writing When writing asynchronously, the system does not wait for a positive acknowledgement from the server. In this mode, there is no guarantee that the Writer has already sent the data packet or not. As a result, the writer cannot be released. The polymorphic VI "Async Single" therefore initializes the writer and sends only the request to the server. A release is not executed in the VI. 30 Version: 1.8.1 TF3710
## Page 31

Technical introduction Examples in Lab VIEW™: Write Async with Type Resolving [} 111] 6.2.3 Reading data continuously When continuously reading a time series from Twin CAT, the client in Lab VIEW™ continuously receives data packets from the ADS server. The data packets can be requested cyclically through a polling procedure or event-based as ADS notification. Both options are explained below. Reading with polling cycle Simple reading With polling, the client sends requests to the server at a defined time interval. This can be easily built using the Low-Level [} 91] VIs, for example. The ADS reader is initialized only once and requests a new data packet from Twin CAT with each cycle of the loop. With each cycle a new request is sent to the server and a corresponding response is awaited. The ADS reader is released once the termination condition of the loop has been reached. The image below shows the complete procedure in Lab VIEW™. Example in Lab VIEW™: Continuos Read Sync Base [} 111] The procedure is error-prone in the sense that it cannot be guaranteed that a cyclically changing value in the PLC is sampled without gaps. For this use case, it is recommended to work with e-notifications, which are described below. Reading with LVB notification Compared to Event-driven reading [} 33], the ADS notifications can also be read continuously with a specific polling cycle. Reading in this case happens asynchronously, as described in the graphic below. Here the ADS notifications are registered by the Thread1 and written into the LVBuffer. Later the LVBuffer is read with the Thread2. TF3710 Version: 1.8.1 31
## Page 32

Technical introduction In contrast to Notification E-Buffered [} 35], no Lab VIEW™ events are used in this case. Accordingly, the Lab VIEW™ user has direct access to the LVBuffer. In Lab VIEW™ the block diagram looks like this: Examples in Lab VIEW™: Read Notification-LVBuffer Multiple [} 113] The block diagram uses the LVBuffer blocks (see Init LVBuffer Handle [} 82]): • Init LVBuffer Handle • Read From LVBuffer • LVBuffer status • Release LVBuffer Handle The block diagram uses the ADS notification blocks: • LVB-Noti. Single Symbol [} 73] • Unregister Notification [} 81] NOTICE Polling cycle If the polling cycle is slower than the notification cycle time, the LVBuffer may overflow and samples may be lost. 32 Version: 1.8.1 TF3710
## Page 33

Technical introduction 6.2.3.1 Event driven reading With event-driven reading, Lab VIEW™ events and ADS notifications are used together. An ADS notification only has to be registered once on the server. The server data are then received cyclically or on change (see "Transmode" in chapter Communication modes [} 25]) from the client. Accordingly, the client only needs to issue one request, and the server then controls whether a new message needs to be sent to the client. The ADS client in Lab VIEW™ forwards the received notifications (data packets) as Lab VIEW™ event to an event structure. See also the Lab VIEW™ documentation on User events. The event structure inserts the received Lab VIEW™ event into an internal queue. The events in the queue are processed by Lab VIEW™ using the FIFO principle. If the notifications are received faster than it is possible to process the event structure in Lab VIEW™, the queue becomes larger. This ensures that no notification is lost. It must be noted that this increases the amount of memory used. Accordingly, it must be taken into account that a point in time must be reached at which the memory requirement (the pending events) can be processed. We recommend using the Lab VIEW™ Event Inspector Window (View > Event Inspector Window) to observe the processing of Lab VIEW™ events. The interface for Lab VIEW™ offers two different modes of operation for continuously registering ADS notifications as Lab VIEW™ events: 1. E-Notification Single 2. E-Notification Buffered E-Notification Single The operation mode E-Notification Single immediately forwards the received ADS data packet to the Lab VIEW™ event structure, i.e. it directly generates a Lab VIEW™ event. A data packet can contain several samples. Transmode and TCBuffer Size are key parameters for this: Transmode "Cyclic" uses the Twin CAT-side buffer (of size TCBuffer Size). In this case notifications are first written to the TCBuffer and then bundled and sent to the Lab VIEW™ client when the buffer is full. This achieves higher data throughput, and there is less load on network thanks to fewer messages with low user data volume. TF3710 Version: 1.8.1 33
## Page 34

Technical introduction With Transmode "On Change" the TCBuffer is not used. Here, the individual notifications are forwarded directly to the client without buffering. The client receives any change of state with minimal latency and can respond directly. In Lab VIEW™ the block diagram corresponds in principle to the above picture. Here the Register Notification Block and the Event Structure run in two different threads. The event is registered only once. The system then waits for the notifications in the event structure. Each received notification contains: • Notification Handle • Number of samples • Array of notification data • Array of ADS timestamps If no notification is received, the event structure times out. 34 Version: 1.8.1 TF3710
## Page 35

Technical introduction Examples in Lab VIEW™: Read Notification-Event Single [} 112], Read Notification-Event Multiple [} 113] E-Notification Buffered The operation mode E-Notification Buffered uses a data buffer on Lab VIEW™ side in addition to the above structure. The buffer size is set by the parameter LVBuffer Size when the ADS symbol is created. The received ADS data packets are first written to the Lab VIEW™-side buffer in an intermediate layer and only forwarded to the event structure as a Lab VIEW™ event when the buffer has been filled. This approach generates Lab VIEW™ events less frequently than in the E-Notification Single variant. By submitting larger data packets to Lab VIEW™, processing can be made more efficient, resulting in higher overall data throughput. Buffer size The Twin CAT 3 interface for Lab VIEW™ reserves an additional 10% buffer memory when generating LVBuffer. Transmode and TCBuffer Size are also the key parameters for this operation mode: With Transmode "Cyclic" the TCBuffer and the LVBuffer are used. With Transmode "On Change" the TCBuffer is not used. The individual notifications are transferred directly to LVBuffer without buffering. TF3710 Version: 1.8.1 35
## Page 36

Technical introduction In Lab VIEW™ the block diagram is similar to the E-Notification Single mode. Each received notification has an additional field called Buffer Info. Buffer Info provides additional information about the LVBuffer: • Previous Overflow Samples: Describes a counter that indicates how often the created buffer was not sufficient. Example: The buffer has been created by the user with 50 samples. As described above, 10% more storage space is created internally, i.e. 55 samples. Several samples can be transferred for each notification thanks to Twin CAT-side buffering. If the buffer in Lab VIEW™ is already occupied with 45 samples and another packet with 10 samples arrives, the maximum buffer is not exceeded and the counter does not increment. If, on the other hand, the ADS packet was to contain more than 10 samples, data would be lost because the buffer would not be sufficient. Accordingly, the counter would increment by one. • Missing Samples: Describes the difference between received and expected samples. Example: The Lab VIEW™-side buffer has 50 samples, so 50 samples are expected. However, if only 48 samples are received, the value of Missing Samples is two. • Buffer Usage: in percent % Example in Lab VIEW™: Read Notification-Event Buffered [} 112], Read Notification-Event Multiple [} 113] 6.2.4 Writing data continuously During continuous writing Lab VIEW™ sends write requests to Twin CAT. Sending of requests is based on a polling cycle. 36 Version: 1.8.1 TF3710
## Page 37

Technical introduction Writing with polling cycle Writing with the ADS synchronous block uses so-called continuous polling. Here the low-level [} 91] writer blocks are used. The ADS writer is initialized only once. It sends a new Type Resolved data packet to the ADS server with each cycle (iteration). With each cycle a new request is sent to the server and an acknowledgement is awaited. The ADS writer is released once the condition for exiting the loop had been reached. The image below shows the complete procedure in Lab VIEW™. This type of writing from Lab VIEW™ to Twin CAT can be used to write values directly to an output terminal with short cycle times, for example. Example in Lab VIEW™: Continuos Write Sync Base [} 114] 6.3 Type Resolving The Twin CAT 3 Interface for Lab VIEW™ provides Type Resolver, to parse the ADS data stream from Lab VIEW™ data type to Twin CAT 3 data type or vice versa. A comparison is first made between the Lab VIEW™ data type and the Twin CAT 3 data type. If the data types are the same, the ADS data stream is parsed and copied appropriately. The Type Resolver supports the following operation modes: 1. Resolve ADS data stream from Twin CAT 3. 2. Resolve ADS data stream for Twin CAT 3. Resolve ADS data stream from Twin CAT 3 The block From TC initializes the Type Resolver, parses and converts the ADS data read from Twin CAT with ADS Read into the Lab VIEW™ data type Variant. The block Type Release releases the Type Resolver from memory. Variant is converted to the appropriate Lab VIEW™ data type via Variant-to-Data VI. The following graphic shows how the composition of Type Resolver from the Low Level VIs [} 97]. In this example we assume a structure in Twin CAT that consists of three elements. Definition of the structure: TYPE ST_to Lab VIEW : STRUCT TCSigned Word : INT; TCUnsigned Int : UINT; TCString Array : ARRAY [1..5] OF STRING; END_STRUCT END_TYPE The Twin CAT 3 data type and the Lab VIEW™ data type must match for the conversion process. In the appendix you will find a translation table [} 124] as an overview. On the right side of the block diagram is a Lab VIEW™ container that mirrors the above structure. Structure of the Lab VIEW™ container (not initialized, merely defined): • I16 • U16 • TCString Array is 1..n Elements and of type string (not further specified in Lab VIEW™) Copying data may fail for the following reasons: • The elements of the Lab VIEW™ container are not configured in the correct order. TF3710 Version: 1.8.1 37
## Page 38

Technical introduction • The entries of the structure and the container do not have the same data type. Resolve ADS data stream for Twin CAT 3 The block To TC initializes the Type Resolver, compares the Lab VIEW™ data type with the Twin CAT 3 data type and converts the Lab VIEW™ data into ADS raw data. The block then releases the Type Resolver from the memory. The converted ADS data can then be passed directly to an ADS Write [} 74] block. The diagram below shows a similar scenario as described earlier for From TC. In this case the data are converted from a Lab VIEW™ data type to a Twin CAT 3 data type. The conversion may fail for the following reasons: • The elements of the Lab VIEW™ container are not configured in the correct order. • The entries of the structure and the container do not have the same data type. • The elements in the structure are not initialized. Initialization of the Lab VIEW™ data type When converting from Lab VIEW™ to Twin CAT 3 data type, the Lab VIEW™ data type must be pre- initialized. For a complex data type, such as a structure, the complete data type must be initialized. For an array the individual elements must be initialized. 38 Version: 1.8.1 TF3710
## Page 39

Technical introduction For the diagram above, for example, the following Twin CAT structure is conceivable in the PLC as a target for writing: TYPE ST_from Lab VIEW : STRUCT TCSigned Double Int : DINT; TCUnsigned Long Int : ULINT; TCString Array : ARRAY [1..6] OF STRING(80); END_STRUCT END_TYPE The matching initialized Lab VIEW™ container is then structured as follows: • I32 • U64 • String array with 6 elements (80 characters per array element may be used here) Automatic type generation Manual creation of matching data types in Lab VIEW™ can be time consuming and error-prone. The Twin CAT Interface for Lab VIEW™ offers the possibility of automatic type generation. Use the Type Resolver [} 97] and the Generate Type [} 78] wrapper block for this purpose. See the chapter Examples [} 109] for several variations on how to use these VIs effectively: Example Type Resolver [} 78]. 6.4 Heartbeat Connection Monitoring To monitor the connection between Lab VIEWTM and Twin CAT, Heartbeat signals can be exchanged periodically between the two systems. This requires corresponding functions on both sides. PLC project required A PLC and a PLC license are required in the Twin CAT project to use Heartbeat Connection Monitoring. The following shows how the Heartbeat signals are used to detect an interruption in the connection. TF3710 Version: 1.8.1 39
## Page 40

Technical introduction The maximum expected Roundtrip Delay (RTD) is estimated in Lab VIEW™ for each Heartbeat signal. This is the time required for the transmitted signal to be received by Twin CAT and sent back again. The estimate is referred to as RTD Estimate. If the Heartbeat signal arrives back in Lab VIEW™ within the RTD Estimate (as shown in the figure on the left), the connection is OK. If this is not the case, the connection may be interrupted (as shown in the illustration on the right). To check this, another Heartbeat signal is sent out for validation. This increases the RTD estimate. If this Heartbeat signal also fails, an interruption is detected (timeout detected). The Heartbeat signals are sent periodically with the polling time T. This is used by Twin CAT 3 to determine the time until which the next Heartbeat signal is expected. If the Heartbeat signal arrives in Twin CAT before this time, the connection is OK. If the Heartbeat signal fails twice in succession, an interruption is also detected on the Twin CAT side (timeout detected). Roundtrip Delay (RTD) Estimation Estimating the next maximum expected RTD is central to connection monitoring. The estimation is used both in Lab VIEW™ and in Twin CAT. The underlying algorithm is identical in both systems. There are two ways of estimation: dynamic or static. Dynamic RTD Estimation: In dynamic estimation, the next expected RTD (RTD Estimate) is calculated on the basis of recorded RTDs. A combination of different algorithms is used here. An offset parameter (see below) can be used to influence the estimate. The configured offset is added to the result of the dynamic RTD estimation. This allows the risk of a falsely detected interruption and the response time to be individually adapted to the use case. A larger offset leads to a lower probability of an interruption being falsely detected and at the same time increases the response time of the monitoring. Static RTD estimation: With static estimation, a constant value is set as the maximum RTD. This value is set by the user via the offset parameter. Maximum delay until an interruption is detected The maximum delay until an interruption is detected depends on the estimation method for the RTD. The following approximation applies to the dynamic estimate: Response time ≈ Polling time + 3*RTD Estimate + Offset The following applies approximately to the static estimate: Response time ≈ polling time + 3* offset Parameterization The parameters can be used to influence the behavior of the connection monitoring. The following parameters are available for this purpose: Name Name Polling time Timespan in ms that elapses between two Heartbeat signals. 40 Version: 1.8.1 TF3710
## Page 41

Technical introduction Name Name Use Rtd Estimation? Selection of the method for estimating the RTD (TRUE: dynamic estimation; FALSE: static estimation) Offset Dynamic estimation: Additional waiting time in ms Static estimation: Constant RTD estimate in ms Parameterization only in Lab VIEWTM The parameters are configured in Lab VIEWTM and automatically adopted by Twin CAT. Parameterization in Twin CAT is not required. It makes sense to use the parameters to adjust the behavior of the monitoring to your individual use case. The following considerations should provide support here: Polling time: The longer the polling time, the longer the response time. At the same time, a shorter polling time leads to more Heartbeat signals being sent, which may increase the network load. The response time of the connection monitoring can be easily set via the polling time (please note that polling time != response time). The polling time has no influence on the risk of a falsely detected interruption. Offset: The offset can be used to reduce the risk of an incorrectly detected interruption at the expense of the response time. Creating a function block in Twin CAT For Heartbeat Connection Monitoring, an instance of the FB_Heartbeat function block must be created for each port in the Twin CAT project for which monitoring is to take place. To do this, the "Tc3_Interface For Lab VIEW" PLC library must be added in Twin CAT and then an instance of the FB_Heartbeat function block must be created and called. PROGRAM MAIN VAR fb Heartbeat : FB_Heartbeat; END_VAR fb Heartbeat(); The function block has outputs that display the status of the connection. Name Meaning b Connected Indicates whether there is a connection to the Lab VIEWTM system. b Timeout Detected Indicates whether the connection has been interrupted. b Stopped Indicates whether connection monitoring has been stopped from Lab VIEWTM. Ams Addr Specifies the target system to which the Heartbeat connection exists. Connection monitoring to multiple target systems A Heartbeat signal from a Lab VIEWTM project can be received for each instance of FB_Heartbeat, but a Lab VIEWTM project can realize connection monitoring to several Twin CAT systems. TF3710 Version: 1.8.1 41
## Page 42

Lab VIEW™ VIs 7 Lab VIEW™ VIs The Twin CAT 3 Interface for Lab VIEW™ provides controls and VIs for use in Lab VIEW™. The VIs are located in the block diagram in the functions palette: Functions > User Libraries > Beckhoff- Lab VIEW-Interface. The main folder contains the basic VIs that can be used to build a program for reading via ADS, writing via ADS, Type Resolving and releasing the ADS client. In addition, the main folder contains the subfolders: Low- Level, With Type Resolving and Utilities. Low-Level The Low-Level subfolder contains Low-Level-VIs. The low-level VIs operate based the same principle as the basic VIs. The low-level VIs involve a little more programming effort but offer higher performance (in terms of data throughput) than the basic VIs and more flexibility for realizing complex programs. Reading with Polling Cycle [} 31] is an example that uses low-level VIs for fast reading via ADS. Writing with polling cycle [} 37] is a similar example. Not only reading and writing can be accelerated in this way, but also Type Resolving, see Continous Read [} 111], for example. The table describes the subfolders and their contents and function: Subfolder VIs Function Init [} 91] Base Init Initializes the ADS client. Get List of Read Write Creates a list of ADS read and write symbols. Symbols Get List of Registered Creates a list of registered ADS target systems. Targets Read [} 93] Init Reader Initializes the ADS Reader. Send Reader-Request Sends a request to the ADS server. Register Notification Registers the notification on the ADS server. Try Read Data Checks the response from the server and reads the data stream. Release Reader Releases the reader from memory. Write Init Writer Initializes the ADS Writer. [} 95] Send Writer Request Sends a request to the ADS server. 42 Version: 1.8.1 TF3710
## Page 43

Lab VIEW™ VIs Subfolder VIs Function Check Write Status Checks for the response from the ADS server to ascertain whether the data packet was received. Release Writer Releases the writer from memory. Sum Up Init Sum Up Initializes the ADS-Sum Up. [} 103] Add Sub Command Adds a new command to the Sum Up. Put Data Puts new data to the initialized command that is to be written to Twin CAT. Get Data Gets data from a Sum Up command that was read from Twin CAT. Enable Autosend Enables automatic sending of Sum Up commands. Send Sump Up Sends all Sum Up commands to the Twin CAT runtime. Release Sum Up Releases the Sum Up handle in the memory. Type Resolve Init Type Initializes the Type Resolver. r [} 97] Resolve From TC Type Converts the Twin CAT 3 data type to a Lab VIEW™ data type variant. Resolve To TC Type Converts the Lab VIEW™ data type variant into a Twin CAT 3 data type. Release Type Releases the Type Resolver from memory. With Type Resolving The With Type Resolving subfolder contains two VIs for reading and writing via ADS with integrated Type Resolver block. Utilities The Utilities subfolder contains additional VIs for the following purposes: Subfolder VIs Function Notification ADS To Lab VIEW Converts ADS timestamps to Lab VIEW™ timestamps. Timestamp [} 80] Notification Data To Variant Builds an array of Lab VIEW™Variant from the notification data Array stream. Stop Notification Stops the ADS notifications. TF3710 Version: 1.8.1 43
## Page 44

Lab VIEW™ VIs Subfolder VIs Function Start Notification Starts the ADS notifications. Unregister Notification Unregisters the notification on the server. LVBuffer Init LVBuffer Handle Initializes a handle for reading an ADS notification using the Lab VIEW™-side data buffer. Read From LVBuffer Reading data from the data buffer LVBuffer status Reading the number of samples in the data buffer Release LVBuffer Handle Releases the handle to the data buffer Routes Get Routes Reads all target systems that are connected to the local Twin CAT system. Get Route Info Specifies all subsystems and ports for a target system. Co E Read Co E List Reads a Co E directory of a terminal and lists the available Co E objects. Read Co E Description Reads the description of a Co E object and specifies the sub- elements. Read Co E Entry Reads an entry from a Co E directory and outputs the properties. Read Co E Value Reads the value of a Co E entry. Write Co E Value Writes the value of a Co E entry. Project Init Project Initializes a Twin CAT 3 engineering project. Either an existing Automation project is opened or a new one is created. Create Task Creates a task in a Twin CAT 3 project or changes the task parameters. Scan IO Checks existing inputs and outputs on the target system and adds them to the project tree. Create PLC Creates a PLC within a Twin CAT 3 project. Activate Solution Activating a Twin CAT 3 project. Release Project Releases the handle to the Twin CAT 3 project. Heartbeat Init Heartbeat Creates a Heartbeat instance with a handle. Run Heartbeat Starts connection monitoring. Stop Heartbeat Stops connection monitoring. Release Heartbeat Releases the handle to the Heartbeat instance from memory. Get RTD Estimate Indicates the current estimate of the Round Trip Delay. Heartbeat Initializes, starts and stops connection monitoring in a VI. Generate Type Generates a corresponding constant or control with the Lab VIEW™ data types for a symbol using the Type Info of the Type Resolver. Check License Checks the license state on a given target system. Set Device State, Reads or changes the state of an ADS device. Get Device State Get Version Info Provides information regarding the product version. 44 Version: 1.8.1 TF3710
## Page 45

Lab VIEW™ VIs Controls The controls are located in the front panel in the controls palette under: User Controls > Beckhoff- Lab VIEW-Interface. TF3710 Version: 1.8.1 45
## Page 46

Lab VIEW™ VIs The Notification subfolder contains controls that are required when initializing the Lab VIEW™ event for ADS notifications. Furthermore, the subfolder “Type Generator” contains Type Generator [} 98] class objects to convert Twin CAT types into Lab VIEW™ types (see Generate Lab VIEW™ type [} 114]). The following table describes the function of the controls: Subfolder Controls Function Notification Single User-Event Control for initializing a Lab VIEW™ event for Single ADS Data notifications. 46 Version: 1.8.1 TF3710
## Page 47

Lab VIEW™ VIs Subfolder Controls Function Buffered User-Event Control for initializing a Lab VIEW™ event for Buffered ADS Data notifications. Type Generator CBase Class object; base class of the Type Generator CBool Class object; Boolean class of the Type Generator. CNumeric Class object; numeric class of the Type Generator. CString Class object; Lab VIEW™ string class of the Type Generator. CArray Class object; array class of the Type Generator. CTimestamp Class object; Lab VIEW™ timestamp class of the Type Generator. CCluster Class object; Lab VIEW™ cluster class of the Type Generator. 7.1 ADS DAQ The ADS DAQ (Data Acquisition) VI is a Lab VIEW™ Express VI for easy configuration of measuring tasks with Twin CAT 3, i.e. you can use this VI for read access to Twin CAT runtimes. The user interface of the ADS DAQ VI guides you step by step through the configuration of your measuring task: • Selection of the data points to be read (ADS symbols) • Configuration of the read mode (ADS notification) • Type generator configuration • Configuration of start and end condition of the measuring task The configuration window opens after placing the ADS DAQ instance in the Lab VIEW™ block diagram or by double-clicking. The configurations can be made with the help of the selection windows described below. After the configuration is complete, the instance creates all the necessary resources for reading the data. Save VI before using the ADS DAQ VI The ADS DAQ VI stores the configuration of an instance in the path of the current project/VI. Therefore, it is necessary to save the project/VI beforehand. Open ADS DAQ VI in an accelerated way ü The library must be precompiled. 1. Open the settings for "Mass Compile" in the Lab VIEW™ settings at Tools > Advanced. 2. Select the folder of the Twin CAT 3 Interfaces for Lab VIEW™ library, e.g. C:\Program Files\ National Instruments\Lab VIEW 2024\user.lib\Beckhoff-Lab VIEW-Interface. 3. Start "Mass Compile". Output Meaning [20] Handle Handle to the ADS client [25] Loaded Types An array of Lab VIEW™ Enums: • Describes which data types have been generated. [26] Selection Lab VIEW™ cluster consisting of two elements: • Symbol Name: The name of the ADS symbol • Notification Mode: Lab VIEW™ Enum ◦ Single Type Resolved Queue: Reads only one sample as notification and adds the sample to the Lab VIEW™ queue (only in Lab VIEW™ 32-bit). TF3710 Version: 1.8.1 47
## Page 48

Lab VIEW™ VIs Output Meaning ◦ Single Type Resolved Control: Reads only one sample as notification and writes the sample to the Lab VIEW™ display element (only in Lab VIEW™ 32-bit). ◦ Buffered Type Resolved Queue: Reads a number of samples as described by LVBuffer Size, and adds the samples to the Lab VIEW™ queue. ◦ Buffered Type Resolved Control: Reads a number of samples as described by LVBuffer Size, and writes the samples to the Lab VIEW™ display element. Number of symbols Currently, the ADS DAQ block supports reading a maximum of 10 ADS symbols per instance. Use multiple instances or the upgrade ADS Flex DAQ [} 56] if you want to read more than 10 ADS symbols. Generation of Twin CAT 3 data types To support all notification modes, all generated types are converted to arrays. Notifications Buffered as well as Notifications Single are supported in the same way. Symbol selection window This window is used to select the ADS symbols to be read with the ADS DAQ instance. The window offers three different ways to select the ADS symbols: 1. Symbol Interface [} 67]: Opens an additional graphical user interface for browsing ADS symbols. ◦ Browse into the connected targets. ◦ Select the desired ADS symbols and drag and drop them into the right field. ◦ Optionally, in the right field you can export the selected ADS symbols as a list and save them as an XML file. 2. Symbol File: Opens a Lab VIEW™ file dialog box to read in the ADS symbols using an XML file exported from the Symbol Interface. ◦ Reads only the symbols, but does not include all other settings of the ADS DAQ VI from the other configuration views. 3. Load Previous Configuration: Loads the last configuration (if existing) with which the ADS DAQ instance has already been configured. ◦ The configuration always opens as an empty configuration. If you want to adjust the existing configuration, select Load Previous Configuration. 48 Version: 1.8.1 TF3710
## Page 49

Lab VIEW™ VIs After selecting the ADS symbols, select Next. Click Finish in the dialog at any time to save and close the configuration. Notification selection window In this window the notification mode is specified for individual selected ADS symbols. The Notification Mode describes on one side the way of reading (single/buffered) and on the other side the display of the read data in Lab VIEW™ (control/queue). Default setting is Buffered Type Resolved Queued. The following table describes the different properties: Single Type Resolved Buffered Type Resolved Control The individual notifications are Notifications are first written to an displayed directly in a Lab VIEW™ intermediate buffer layer and passed into the (Only recommended if control. Lab VIEW™ process when the buffer is filled. the data do not need to The data are displayed in a Lab VIEW™ be processed or saved) control. Queued The individual notifications are Notifications are first written to an inserted directly into a Lab VIEW™ intermediate buffer layer and passed into the (Recommended if data queue. Lab VIEW™ process when the buffer is filled. are to be processed, The data are inserted into a Lab VIEW™ saved, ...) queue. For more information on single and buffered mode, see Communication modes [} 25] and Event driven reading [} 33]. TF3710 Version: 1.8.1 49
## Page 50

Lab VIEW™ VIs Click Modify to open the Symbol Interface and make changes to the ADS symbols to be read. Click Next to go to the next configuration page. Type generation selection window In this window you can select whether the respective data type of the ADS symbol to be read is to be generated as a Lab VIEW™ constant or as a control/display element. Both constants and control/display elements are automatically generated in the block diagram of the VI, where the ADS DAQ instance is also located. Default setting is Control/Indicator. Measurement Job configurator In this window the ADS DAQ instance can be configured with additional start/stop/record conditions. Default setting is at Start: Lab VIEW run and at Stop: Lab VIEW Abort, no Record. 50 Version: 1.8.1 TF3710
## Page 51

Lab VIEW™ VIs Start Job The control Start Job configures the start of the reading process. The parameter Start Condition describes the way of starting. Lab VIEW™ Run: The ADS notifications are both automatically registered and started after starting the VI. • On Signal: The ADS notifications are not started automatically in this case. The ADS DAQ instance waits for a specific trigger from Lab VIEW™ or Twin CAT. ◦ Trigger on Lab VIEW™ Event: With this selection the ADS DAQ instance generates a separate event logic to start the ADS notifications from Lab VIEW™. TF3710 Version: 1.8.1 51
## Page 52

Lab VIEW™ VIs ◦ Twin CAT Signal: The DAQ instance is triggered by an (additional) Twin CAT signal and therefore does not start the ADS notifications automatically. The button Browse Target opens the Symbol Interface. Drag an ADS symbol to the right onto the "Read" area. All primary data types are allowed. Furthermore, a signal condition has to be defined on which the ADS DAQ VI is to be triggered. The table below describes the transition (Last value ➔ New value) of different Twin CAT types with the definition of Rising and Falling Edge used here. Twin CAT type Rising Edge Falling Edge Last value New value Last value New value Boolean type 0 1 1 0 Numeric integer type (i8, i16, i32, < Threshold = Threshold > Threshold = Threshold i64, u8, u16, u32, u64) Numeric rational type (float32, < Threshold = Threshold > Threshold = Threshold float64) Epsilon: 1.0 e-7 Stop Job The control Stop Job configures the stopping of ADS notifications, i.e. the stopping of the reading process. The parameter Stop Condition describes the way of stopping. • Lab VIEW™ Abort: The ADS notifications are automatically unregistered as well as stopped after stopping the VI. • Measurement Duration: The ADS notifications stop automatically after the measurement time has elapsed. • On Signal: This option behaves identically to the selection On Signal in Start Job (see above). ◦ Click Copy from Start Signal to copy the start condition from Start to Stop Job (applies only to the Twin CAT signal). Record Job The recording of ADS DAQ measured data can be configured with the control Record Job. After configuration and clicking Finish, the ADS DAQ instance generates an additional Block To TDMS to save the received data as a Lab VIEW™ TDMS file under the specified file name and path. 52 Version: 1.8.1 TF3710
## Page 53

Lab VIEW™ VIs Click Finish to save the settings. The automatic code generation for your configuration starts. Automatically generated code in the block diagram In the following, two variants of the automatically generated code are explained as examples. In the first example, the ADS DAQ VI is generated with default settings, i.e. Buffered Type Resolved Queue, Control/Indicator, Start with Lab VIEW™ Run, Stop with Lab VIEW™ Stop. An ADS symbol MAIN.a Buffer is read. • 1a: A handle from Queue 1 goes from the instance of ADS DAQ VI to the underlying queue blocks. The queue of the ADS DAQ VI already contains Type-Resolved data packets. Each data packet is of size Lv Buffer Size (cf. settings in the Symbol Properties [} 25]), as Buffered Type Resolved Queue has been configured. • 2a: Initialization of the queue with a Lab VIEW™ Variant Array as data type. • 2b: While loop with start condition "Lab VIEW™ Run" and end condition "Timeout or error occurred". • 2b.1: Dequeue element: Waits for received data packets with specified timeout of 5 seconds (customizable). • 2b.2: For loop: Takes the individual elements of the Variant array and converts the data type to the corresponding Lab VIEW™ data type. Here, for example, the user can directly access the converted type and continue working with it. • 2b.3: Checks the current state of the queue, e.g. whether the queue is growing steadily. If this is the case, the data will arrive from ADS DAQ VI faster than it can be converted to the Lab VIEW™ data type. Optionally, the user can insert a display element or similar here to monitor the queue. • 2c: Releases the queue memory. After that the queue is released from the LV memory. Optionally, after these steps, the user can release the ADS client handle from memory. In the second example, the start condition is changed from Lab VIEW™-Run to Trigger on Lab VIEW™-Event and the recording to a TDMS file is enabled. TF3710 Version: 1.8.1 53
## Page 54

Lab VIEW™ VIs • The blocks already described in the first example remain identical in their function. Only the timeout was set to -1 in this case (wait infinitely), because the start of the measurement is triggered by Lab VIEW™. • 2b.4: The TDMS block is automatically generated based on the setting that a recording should take place. The user must manually link the data to be saved to the To Variant block. If the received data correspond to a Lab VIEW™ signal, they can be converted to a Lab VIEW™ waveform before the To Variant. The user can use the automatically generated constant dt which corresponds to the time distance between two data points (sampling period duration). • 3a: The ADS reader handles are regenerated with each new configuration of the ADS DAQ VI. The obsolete reader handles are automatically released from memory. • 3b: Logic is created that generates a trigger-event when a Boolean value change occurs. This is used to start the ADS notifications. • 3b.1: Starts the ADS Notification for the registered ADS symbols. Notes on the "To TDMS" in the block diagram The To TDMS block allows you to save ADS DAQ instance data to a Lab VIEW™ TDMS file (the NI TDMS file format). This block is automatically generated by the ADS DAQ instance, but only if Queued has been selected as the notification mode, cf. Notification selection window [} 49]. 54 Version: 1.8.1 TF3710
## Page 55

Lab VIEW™ VIs The TDMS file format provides TDMS objects and TDMS channels to hierarchically arrange data or properties (name, date, ...) among TDMS objects. The inputs Property-/Data Objects can be used to reference or classify both properties and data. The inputs Property-/Data Values help to enter measured values under TDMS objects and channels. Output Meaning [0] Path In The path to the TDMS file [1] Property Objects An array of a Lab VIEW™ string: • References a specific object (channel) for properties with the format described below: 1. Object and channels are separated with slash "/". 2. The list of properties is entered by a comma-separated string (","). 3. Items 1 and 2 are separated by a colon (":"). Sample: Property Object[0]=Object ABC/Channel XYZ:Name,Author,Date TDMS Object=Object ABC TDMS Channel=Channel XYZ Property[0]=name (string) Property[1]=author (string) Property[2]=date (timestamp) [2] Property Values An array of Lab VIEW™ variants: • Describes the values of properties. [3] Transpose Data? Flag to transpose the entered 2D of 3D arrays. [5] Data Objects An array of a Lab VIEW™ string: • References a specific object (channel) for data. The following format is used for referencing: 1. Object and channels are separated with slash ("/"). Sample: Data Object[0]=Object ABC/Channel XYZ [7] Data Values An array of Lab VIEW™ variants with the following supported Lab VIEW™ types: • Lab VIEW™ waveform • 1D, 2D, 3D array (2D, 3D array are internally converted to 1D): ◦ Boolean type ◦ Integer numeric types (i8 ... i64,u8 ... u64) ◦ Non-integer numeric types (float32, float64) ◦ Lab VIEW™ string The following graphic shows an example of the To TDMS block in use. TF3710 Version: 1.8.1 55
## Page 56

Lab VIEW™ VIs 7.2 ADS Flex DAQ The ADS Flex DAQ (Flexible Data Acquisition) VI is a further development of the ADS DAQ [} 47] VI. As with the ADS DAQ, this is a Lab VIEW™ Express VI that simplifies the configuration of measuring tasks with Twin CAT 3 and provides read access to the Twin CAT runtime. The ADS Flex DAQ VI also offers the following additional options: • Any number of ADS symbols can be read per instance. • A unique Loop-ID can be assigned to the symbols. Symbols with the same Loop-ID are read in the same while loop. • Each symbol can be assigned a corresponding TDMS flag to store the data to be read in a TDMS file. The user interface guides you step by step through the configuration of your measuring task: • Selection of the data points to be read (ADS symbols) • Configuration of the read mode (ADS notification) • Configuration of the Loop-IDs • Configuring the storage of measurement data in a TDMS file • Configuration of start and end condition of the measuring task The configuration window opens after placing the ADS Flex DAQ instance in the Lab VIEW™ block diagram or by double-clicking. The configurations can be made with the help of the selection windows described below. After the configuration is complete, the instance creates all the necessary resources for reading the data. Save VI before using the ADS Flex DAQ VI The ADS Flex DAQ VI stores the configuration of an instance in the path of the current project. Therefore, it is necessary to save the project beforehand. Open ADS Flex DAQ VI in an accelerated way ü The library must be precompiled. 1. Open the settings for "Mass Compile" in the Lab VIEW™ settings at Tools > Advanced. 2. Select the folder of the Twin CAT 3 Interfaces for Lab VIEW™ library, e.g. C:\Program Files\ National Instruments\Lab VIEW 2023\user.lib\Beckhoff-Lab VIEW-Interface . 3. Start "Mass Compile". 56 Version: 1.8.1 TF3710
## Page 57

Lab VIEW™ VIs Input/output Meaning [1] Reader handles Handles on the reading symbols [20] Handle Handle to the ADS client [26] Selection Lab VIEW™ cluster consisting of two elements: • Symbol Name: The name of the ADS symbol • Notification Mode: Lab VIEW™ Enum ◦ Single Type Resolved Queue: Reads only one sample as notification and adds the sample to the Lab VIEW™ queue (only in Lab VIEW™ 32-bit). ◦ Single Type Resolved Control: Reads only one sample as notification and writes the sample to the Lab VIEW™ display element (only in Lab VIEW™ 32-bit). ◦ Buffered Type Resolved Queue: Reads a number of samples as described by LVBuffer Size, and adds the samples to the Lab VIEW™ queue. ◦ Buffered Type Resolved Control: Reads a number of samples as described by LVBuffer Size, and writes the samples to the Lab VIEW™ display element. Twin CAT 3 data type generation To support all notification modes, all generated types are converted to arrays. Notifications Buffered as well as Notifications Single are supported in the same way. Symbol selection window Just as with ADS DAQ [} 47], the Symbol selection window is used to select the ADS symbols to be read with the ADS Flex DAQ instance. In addition, there is an option Import Configuration, which can be used to import a saved configuration. For this purpose, a Lab VIEW™ file dialog box opens, in which a path to an exported configuration can be selected. TF3710 Version: 1.8.1 57
## Page 58

Lab VIEW™ VIs Notification and Loop-ID selection window In this window the Notification Mode and the Loop-ID are selected. The possible notification modes can be found in section Notification selection window [} 49]. The Loop-ID is used to distribute the reading of the symbols to while loops. With the ADS Flex DAQ it is possible to assign the same Loop-ID to several symbols. These are then processed in the same while loop. This reduces the number of loops. Maximum Loop-IDs The number of inputs is limited to 23 for the ADS Flex DAQ instance. Consequently, a maximum of 23 different Loop-IDs can also be assigned. Save measured data For each symbol there is the option "Save To TDMS", which saves the respective symbol in a TDMS file when reading from Twin CAT. The block Notes on the "To TDMS" in the block diagram [} 54] is used for this purpose. 58 Version: 1.8.1 TF3710
## Page 59

Lab VIEW™ VIs Automatically generated code in the block diagram In the following, two variants of the automatically generated code are explained as examples. In the first example, the ADS Flex DAQ VI is generated with default settings, i.e. Buffered Type Resolved Queue, no storage of measured data, Start with Lab VIEW™ Run, Stop with Lab VIEW™ Stop. An ADS symbol MAIN.a AM is read. TF3710 Version: 1.8.1 59
## Page 60

Lab VIEW™ VIs • 1: ADS Reader handles are initialized for the selected ADS symbols. The ADS reader handles are regenerated with each new configuration of the ADS Flex DAQ VI. The obsolete reader handles are automatically released from memory. • 2: A handle from Simpe Queue1 goes from the instance of ADS Flex DAQ to the underlying queue blocks. The queue of the ADS Flex DAQ VI already contains Type-Resolved data packets. Each data packet is of size Lv Buffer Size (cf. settings in the Communication modes [} 25]), as Buffered Type Resolved Queue has been configured. • 3a: The queue is initialized with a Lab VIEW™ Cluster, Read Package. The cluster contains a data array as a variant (Type Resolved ADS notification data) and a numeric array (notification timestamps) as elements. • 3b: While loop with start condition "Lab VIEW™ Run" and without end condition. • 3b.1: Dequeue element: Waits for received data packets for an infinite time (customizable). • 3b.2: Unbundle element: Splits the cluster into data and ADS timestamps. • 3b.3: For loop: Takes the individual elements of the Variant array and converts the data type to the corresponding Lab VIEW™ data type. Here, for example, the user can directly access the converted type and continue working with it. • 3c and 3d: The queue memory is released. After that the queue is released from the Lab VIEW™ memory. Optionally, after these steps, the user can release the ADS client handle from memory. In the second example, the start condition is changed from Lab VIEW™-Run to "Trigger on Lab VIEW™ Event" and the data storage to a TDMS file is enabled. Two symbols are read: MAIN.a AM and MAIN.a Sine. These are assigned the same Loop-ID. Thus, both symbols are read in the same while loop. 60 Version: 1.8.1 TF3710
## Page 61

Lab VIEW™ VIs The blocks 1a, 2, 3b, 3b.2, 3b.4, 3c and 3d already described in the first example remain identical in their function. • 1b: Logic is created that generates a trigger-event when a Boolean value change occurs. This is used to start the ADS notifications. • 3a: The queue is initialized with a Lab VIEW™ cluster as data type with the member variables: ◦ Symbol Name: Identifies the read data packet ◦ Data: Type Resolved ADS notification data packet ◦ Timestamp: ADS notification timestamps • 3b.2: The read data packet is unpacked and distributed to the corresponding case structure. • 3b.3: Case structure that passes the ADS data for the unpacked symbol data to Lab VIEW™. In the example, the case structure manages two ADS symbols MAIN.a AM and MAIN.a Sine. • 3b.5: The TDMS block is generated automatically based on the setting that the data should be saved. The data to be saved is automatically linked to the To Variant block. If the received data correspond to a Lab VIEW™ signal, they can be converted to a Lab VIEW™ waveform before the To Variant. The user can use the automatically generated constant dt which corresponds to the time distance between two data points (sampling period duration). • 3e: Initialization of the handle to the TDMS file. TF3710 Version: 1.8.1 61
## Page 62

Lab VIEW™ VIs 7.3 ADS Write Assistant Like the ADS Flex DAQ [} 56], the ADS Write Assistant VI is a Lab VIEW™ Express VI that simplifies the configuration of transfer tasks. The ADS Write Assistant VI can be used to write data from Lab VIEW™ to Twin CAT 3. The user interface of the ADS Write Assistant VI guides you step by step through the configuration of your transfer task: • Selection of the data points to be written (ADS symbols) • Configuration of the Loop-IDs • Configuration of start and end condition of the write operation using the transfer job selection window The configuration window opens after placing the ADS Write Assistant instance in the Lab VIEW™ block diagram or by double-clicking. The configurations can be made with the help of the selection windows described below. After the configuration is complete, the instance creates all the necessary resources for writing the data. Save VI before using the ADS Write Assistant VI The ADS Write Assistant VI saves the instance configuration in the path of the current project. Therefore it is necessary that the project has been saved before. Open ADS Write Assistant VI in an accelerated way ü The library must be precompiled. 1. Open the settings for "Mass Compile" in the Lab VIEW™ settings at Tools > Advanced. 2. Select the folder of the Twin CAT 3 Interfaces for Lab VIEW™ library, e.g. C:\Program Files\ National Instruments\Lab VIEW 2024\user.lib\Beckhoff-Lab VIEW-Interface. 3. Start "Mass Compile". Input/output Meaning [1] Sum Up handle Handle to the Sum Up Writer [20] Handle Handle to the ADS client [26] Selection Control for Express VI Symbol selection window The symbol selection window at the ADS Write Assistant offers the same functionality as at ADS Flex DAQ [} 57]. Here one of the options can be selected to start a new configuration or to apply the settings of an existing configuration. If you start a new configuration via Symbol Interface, you will automatically move on to the next window. 62 Version: 1.8.1 TF3710
## Page 63

Lab VIEW™ VIs Loop-ID window In this window, the symbols are assigned a unique Loop-ID. This distributes the writing of the symbols to different while loops. If two symbols have the same Loop-ID, both symbols have used the same loop. The number of Loop-IDs determines the number of generated while loops in the Lab VIEW™ block diagram. Write operation configurator (selection window) In this window the start/stop condition for the data transport from Lab VIEW™ to Twin CAT 3 can be configured. The configurator behaves identically to Measurement Job selection window [} 50] except for the stop condition. TF3710 Version: 1.8.1 63
## Page 64

Lab VIEW™ VIs With the control Stop Job you configure the stopping of the writing process. The parameter Stop Condition describes the stop condition. • The options Lab VIEW™ Abort and On Signal are described in Measurement Job selection window [} 50]. • Duration: If Duration is selected as a stop condition, then the write operation is determined after a time. With this condition, the "Transition Condition" option is also available. This allows the write duration to be influenced by a trigger. The image below shows the different "Transition Condition" triggers. ◦ Single Trigger: Starts a new write duration only if no other write operation is present. ◦ New Trigger: Always starts a new write operation. ◦ Start-Stop Trigger: Starts a write operation if no other is present or, on the contrary, stops an existing write operation. Automatically generated code in the block diagram In the following, two variants of the automatically generated code are explained as examples. In the first example, the ADS Write Assistant VI is generated with default settings, i.e. Start with Lab VIEW™ Run, Stop with Lab VIEW™ Stop. An ADS symbol MAIN.a Sine is written. A sine signal generated by Lab VIEW™ and transferred to the Twin CAT 3 Runtime. 64 Version: 1.8.1 TF3710
## Page 65

Lab VIEW™ VIs • 1: The ADS Writer Sum Up handle is initialized and the flag b Autosend? is set to True. Thus, each new packet is automatically transported from Lab VIEW™ to the Twin CAT 3 Runtime. • 2: A handle goes from the ADS Write Assistant to the underlying queue blocks. The queue forwards each new data packet to the ADS Write Assistant. Until then, the data packet only contains raw data, which is then automatically converted into a Twin CAT 3 data type by the ADS Write Assistant using the Type Resolver and then transferred to Twin CAT using the ADS Sum Up. • 3a: The queue is initialized with a Lab VIEW™ variant as data type. • 3b: While loop with start condition "Lab VIEW™ Run" without end condition. • 3b.1: The ADS Write Assistant generates an event case with the property "value change" for each selected symbol. Only value changes are made available to the Sum Up handle. The image below shows an example of how the new data can be generated. This is about the so-called Lab VIEW™ block diagram events. • 4: The ADS symbol MAIN.a Sine is in this case a LREAL array of 20 elements. The generated sine signal therefore also contains only 20 data points. • 3b.2: Enqueue element: Waits for new data packets and inserts each new data packet into the queue. • 3c and 3d: Releases the queue memory. After that the queue is released from the Lab VIEW™ memory. Optionally, after these steps, the user can release the ADS client handle from memory. TF3710 Version: 1.8.1 65
## Page 66

Lab VIEW™ VIs In the second example, the start/stop conditions are set to Trigger on Lab VIEW™ Event. In addition, two symbols are written here with the Sum Up handle: MAIN.a Square and MAIN.a Sine. The two symbols are assigned the same Loop-ID. Thus, both symbols use a while loop and the same event structure. 66 Version: 1.8.1 TF3710
## Page 67

Lab VIEW™ VIs • The blocks 2, 3b, 3b.1, 3b.2, 3c and 3d already described in the first example remain identical in their function. • 1a: The ADS Writer Sum Up handle is initialized and the flag b Autosend? is set to False . The new packet must be sent explicitly to Twin CAT 3. In the example this is done by the separate event "Send Sum Up". • 1b: Logic is created that generates a trigger-event when a Boolean value change occurs. The value change starts the write process. • 1b.2: A write operation is started using a Sum Up handle. • 3a: The queue is initialized with a Lab VIEW™ cluster as data type with the following member variables: ◦ Symbol Name: Identifies the data packet to be written. ◦ Write Package: Contains the data packet to be transferred. 7.4 Symbol Interface The Symbol Interface block provides a graphical user interface (UI) for browsing ADS symbols. It simplifies the selection of different ADS symbols as read or write symbols and the parameterization of the symbols. The block creates, based on the configuration created by the user, a Lab VIEW™ string which can be passed to the Init VI. Likewise, an XML file of the created configuration can be saved from the UI so that the configuration can be loaded and passed to the Init VI without repeated manual configuration. TF3710 Version: 1.8.1 67
## Page 68

Lab VIEW™ VIs Input/output Meaning [0] Symbol Interface Mode Lab VIEW™ Enum consisting of three modes: • ADS symbols for read access only • ADS symbols for write access only • Read & Write: Reading and writing are allowed. [4] Port Info Lab VIEW™ string in XML with ADS read and/or write symbols. Microsoft Windows only The Symbol Interface block can be accessed only with a Windows operating system. Running the Symbol Interface will open the graphical user interface shown below. The Twin CAT Target Browser is integrated in the middle part. This is used to browse target systems or their ADS symbols. By drag and drop an ADS symbol (or by multi-select several ADS symbols at the same time) can be dragged to the right area for read accesses or to the left area for write accesses. For each selected ADS symbol a graphic element appears in the Write or Read area. By double-clicking on these graphical elements (multi- select is also possible here) another window appears. The window describes the information of the ADS symbol and offers the option to attach parameters to the ADS symbol, which are used for certain read or write commands. Manual addressing via Ams Net Id, Port, Index Group and Index Offset is also possible. To do this, create a new element under ADS-Read or ADS-Write with New and you can fill in the "Symbol Info" area manually. Cycle Time parameter The cycle time in which the selected ADS symbol is executed in the Twin CAT runtime is always offered as the default value for the Cycle Time. Only multiples of this cycle time are allowed, since an ADS notification with the new value is sent after each completed cycle. If a value other than Cycle Time is entered, it is always rounded up to the next permissible value. 7.5 Init The main task of the Init block is to initialize and connect the ADS client to the ADS router. After successful initialization, Lab VIEW™ receives a handle back to the ADS client. For this purpose the Init block uses the low-level Init [} 91] blocks in the background. In addition to its main task, the Init block performs the following other tasks: • Creates a list of ADS target systems based on the input XMLDescription. • Checks each individual target system for a valid TF3710 Twin CAT 3 Interface for Lab VIEW™ license. • Creates a list of target systems on which a valid TF3710 Twin CAT 3 Interface for Lab VIEW™ could be retrieved. Reading and writing is only possible on target systems with a valid license. • Creates a sorted list of ADS read symbols based on the input XMLDescription. • Creates a sorted list of ADS write symbols based on the input XMLDescription. 68 Version: 1.8.1 TF3710
## Page 69

Lab VIEW™ VIs Input/output Meaning [0] XMLDescription Lab VIEW™ XML string with ADS read and write symbols or the path as a string to an existing, already created (exported) XML file. [4] Handle Handle to the ADS client [6] License State List of license states of the Twin CAT target systems [8] Read Grp Symbols List of ADS reading symbols [10] Write Grp Symbols List of ADS writing symbols NOTICE Client Handle The handle to the ADS client in Lab VIEW™ is only released if a valid TF3710 Twin CAT 3 Interface for Lab VIEW™ license is found on at least one of the selected target systems. If no license could be found, the Init block returns an error via error out [15]. 7.6 ADS-Read The ADS-Read- block is a polymorphic VI and supports the following ADS communication modes [} 25] to read data from Twin CAT: • Sync Single [} 28] • Async Single [} 29] • Noti. Single [} 29] • Noti. Buffered [} 29] • E-Noti. Sinlge [} 33] • E-Noti Buffered [} 35] • E-Noti. Multiple Symbols [} 73] • LVB-Noti. Single Symbol [} 73] • LVB-Noti. Multiple Symbols [} 74] All modes use the low-level Read [} 93] blocks in the background to: 1. Initialize the ADS Reader. 2. To send the ADS request. 3. To wait for answer and 4. finally release the reader from the memory. The section Communication modes [} 25] provides further information as well as practical application recommendations. In the chapter Examples [} 109] you will find exemplary implementations in Lab VIEW™. Depending on the selected communication mode, the parameters configured in Symbol Interface [} 67] are used or remain unused. The relevant parameters are named below. Sync Single [} 28] In this operation mode, the ADS client (Lab VIEW™) sends a request to the ADS server (Twin CAT) and waits for a response from the server in the program sequence. Relevant parameter: Timeout TF3710 Version: 1.8.1 69
## Page 70

Lab VIEW™ VIs Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [8] Read status? Read status [10] Ads Read Data ADS raw data Async Single [} 29] In this operation mode, the ADS client (Lab VIEW™) sends a request to the ADS server (Twin CAT) and does not wait for a response from the server in the program sequence. Relevant parameter: Timeout Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [8] Read Status Read status [10] Read Hdl Handle to the ADS reader Noti. Single [} 29] In this operation mode of ADS Read.vi, ADS notifications are registered to the relevant ADS symbols in Twin CAT. Only "on change" registration is possible. The ADS notification is unregistered again from the ADS server when the first "on change" notification is received in Lab VIEW™. Relevant parameters: Timeout, Transmode (= on change) 70 Version: 1.8.1 TF3710
## Page 71

Lab VIEW™ VIs Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] Send Send flag, TRUE registers the ADS notification [8] Read Status Read status [10] Ads Read Data ADS raw data (array of two entries, previous value and current value) Noti. Buffered [} 29] In this communication mode of ADS Read.vi, ADS notifications are registered on the relevant ADS symbols in Twin CAT. The ADS client in Lab VIEW™ also uses a buffer memory, which is first filled with feedback messages from Twin CAT before the entire buffer memory is transferred to Lab VIEW™. After passing the buffered data to Lab VIEW™, the ADS notification is unregistered from the server. Both ADS notification types, "on change" and "cyclic", are supported. Relevant parameters: Timeout, Transmode, Sample Time, LVBuffer Size, TCBuffer Size With Transmode = "on change" the Sample Time and the TCBuffer Size are not relevant. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] Send Send flag, TRUE registers the ADS notification [8] Read Status Read status [10] Ads Read Data Buffered ADS raw data E-Noti. Single [} 33] In this operation mode of ADS Read.vi, ADS notifications are registered on the relevant ADS symbols in Twin CAT and then continuously transmitted to Lab VIEW™ as Lab VIEW™ event. The ADS notification reports after a defined time if Elapse Time Ms is greater than zero, or remains until it is actively unregistered. For the use of user events in Lab VIEW™, see Lab VIEW™ documentation. In contrast to E-Noti. Buffered (see below), no Lab VIEW™-side buffer memory is used in this case. Relevant parameters: Timeout, Transmode, Sample Time, TCBuffer Size With Transmode = "on change" the Sample Time and the TCBuffer Size are not relevant. TF3710 Version: 1.8.1 71
## Page 72

Lab VIEW™ VIs Input/output Meaning [0] [4] Handle Handle to the ADS client [1] Elapse Time Ms Measurement duration in milliseconds: • Elapse Time Ms > 0: The notifications stop after the time has elapsed. • Elapse Time Ms = 0: The notifications must be stopped from outside. [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] Start Notifications Send Flag, TRUE starts the ADS notification [9] Noti. E-Single Event Ref Reference to user event E-Noti Buffered [} 35] In this operation mode of ADS Read.vi, ADS notifications are registered on the relevant ADS symbols in Twin CAT and then continuously transmitted to Lab VIEW™ as Lab VIEW™ event. The ADS notification reports after a defined time if Elapse Time Ms is greater than zero, or remains until it is actively unregistered. For the use of user events in Lab VIEW™, see Lab VIEW™ documentation. In contrast to E-Noti. Single (see above), a Lab VIEW™-side buffer memory of size LVBuffer Size is used in this case. When the buffer is filled the collected data are passed to Lab VIEW™ via an event. Relevant parameters: Timeout, Transmode, Sample Time, TCBuffer Size, LVBuffer Size With Transmode = "on change" the Sample Time and the TCBuffer Size are not relevant. Input/output Meaning [0] [4] Handle Handle to the ADS client [1] Elapse Time Ms Measurement duration in milliseconds: • Elapse Time Ms > 0: The notifications stop after the time has elapsed. • Elapse Time Ms = 0: The notifications must be stopped from outside. [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var 72 Version: 1.8.1 TF3710
## Page 73

Lab VIEW™ VIs Input/output Meaning • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] Start Notifications Send Flag, TRUE starts the ADS notification [9] Noti. E-Single Event Ref Reference to user event E-Noti. Multiple Symbols This operation mode of ADS Read.vi works like E-Noti. Buffered [} 72], except that this VI can be used for several ADS symbols at the same time. Relevant parameters: Timeout, Transmode, Sample Time, TCBuffer Size, LVBuffer Size With Transmode = "on change" the Sample Time and the TCBuffer Size are not relevant. Input/output Meaning [0] [4] Handle Handle to the ADS client [1] Elapse Time Ms An array of U32 consisting of measurement duration in milliseconds: • Element of Elapse Time Ms > 0: The notifications stop after the time expires. • Element of Elapse Time Ms = 0: The notifications must be stopped externally. [5] [6] Symbols An array of Lab VIEW™ strings that specifies the ADS symbols. A symbol is named by the following elements: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] Noti. E-Buffered Event Refs An array of references to user event LVB-Noti. Single Symbol This operation mode of ADS Read.vi works like E-Noti. Buffered [} 72], except that this VI provides direct access to LVBuffer [} 81] instead of using Lab VIEW™ events. As a result, no Lab VIEW™ events are required to read the notifications. Relevant parameters: Timeout, Transmode, Sample Time, LVBuffer Size, TCBuffer Size With Transmode = "on change" the Sample Time and the TCBuffer Size are not relevant. Input/output Meaning [0] [4] Handle Handle to the ADS client [1] Elapse Time Ms An array of U32 consisting of measurement duration in milliseconds: TF3710 Version: 1.8.1 73
## Page 74

Lab VIEW™ VIs Input/output Meaning • Element of Elapse Time Ms > 0: The notifications stop after the time expires. • Element of Elapse Time Ms = 0: The notifications must be stopped externally. [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] LVBuffer Handle An array of U32 consisting of handle on LVBuffer LVB-Noti. Multiple Symbols This operation mode of ADS Read.vi works exactly like LVB-Noti. Single Symbol [} 73], with the difference that this VI can be used for several ADS symbols at the same time. Relevant parameters: Timeout, Transmode, Sample Time, LVBuffer Size, TCBuffer Size With Transmode = "on change" the Sample Time and the TCBuffer Size are not relevant. Input/output Meaning [0] [4] Handle Handle to the ADS client [1] Elapse Time Ms An array of U32 consisting of measurement duration in milliseconds: • Element of Elapse Time Ms > 0: The notifications stop after the time expires. • Element of Elapse Time Ms = 0: The notifications must be stopped externally. [5] [6] Symbols An array of Lab VIEW™ strings that specifies the ADS symbols. A symbol is named by the following elements: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] LVBuffer Handle An array of U32 consisting of handle on LVBuffer 7.7 ADS-Write The ADS-Write block is a polymorphic VI and supports the following ADS communication modes [} 25] to write data to Twin CAT: • Sync Single [} 30] • Async Single [} 30] 74 Version: 1.8.1 TF3710
## Page 75

Lab VIEW™ VIs For ADS-Write only one parameter is relevant, which can be set in the Symbol Interface [} 67] and that is the parameter Timeout. Sync Single [} 30] In this operation mode of ADS Write.vi, the ADS client in Lab VIEW™ sends a write request with the type- resolved ADS value to the ADS server in Twin CAT and waits for a response as to whether the value has been written. Input/output Meaning [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] Ads Write Data Type-resolved ADS value [8] Write Status Write status Async Single [} 30] In this operation mode of ADS Write.vi, the ADS client in Lab VIEW™ sends a write request with the type- resolved ADS value to the ADS server in Twin CAT and does not wait for a response as to whether the value has been written. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] Ads Write Data Type-resolved ADS value [8] Write Status Write status [10] Write Handle Handle to the ADS Writer TF3710 Version: 1.8.1 75
## Page 76

Lab VIEW™ VIs 7.8 Type Resolver The Type Resolver block is a polymorphic VI and supports the following operation modes to convert data types: • To TC (for writing from Lab VIEW™ to Twin CAT) • From TC (for reading from Twin CAT to Lab VIEW™) To TC The Type Resolver block in operation mode To TC initializes the Type Resolver, compares the Lab VIEW™ data type with the TC3 data type, and converts the Lab VIEW™ data to ADS raw data. The block then releases the Type Resolver from the memory. Further information can be found in the section Resolving ADS data stream for Twin CAT 3 [} 38]. Input/output Meaning [0] Handle Handle to the ADS client [5] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [9] WData Raw data for ADS-Write [4] Handle Handle to the ADS client [6] b Has Matched Flag (TRUE if Twin CAT 3 and Lab VIEW™ data type are identical, otherwise FALSE) [10] ADSWData Type-resolved ADS write value From TC The Type Resolver block in operation mode From TC initializes the Type Resolver, parses and converts the ADS data read by Twin CAT using ADS-Read into the Lab VIEW™ data type Variant. The Type Release block releases the Type Resolver from memory. Further information can be found in the section Resolving ADS data stream for Twin CAT 3 [} 37]. Input/output Meaning [0] Handle Handle to the ADS client [5] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [9] ADSRData Raw data from ADS-Read [4] Handle Handle to the ADS client [8] RData Array Type-resolved ADS read array for the Lab VIEW™ data type [10] RData Type-resolved ADS read value for the Lab VIEW™ data type 7.9 Release The Release block releases the handle to the ADS client from memory. 76 Version: 1.8.1 TF3710
## Page 77

Lab VIEW™ VIs Input/output Meaning [0] Handle Handle to the ADS client 7.10 Utilities Additional VIs can be found under Utilities. Check License The Check License block checks the target system for a valid TF3710 Twin CAT 3 Interface for Lab VIEW™ license. Input/output Meaning [0] Handle Handle to the ADS client [5] Target/Symbol ADS target as string consisting of AMSNet Id or ADS symbol as string consisting of AMSNet Id and symbol name [6] Target/Symbol ADS target as string consisting of AMSNet Id or ADS symbol as string consisting of AMSNet Id and symbol name [4] Handle Handle to the ADS client [8] License Info Lab VIEW™ cluster consisting of three elements: • Boolean flag (TRUE if license is valid, FALSE otherwise) • AMSNet Id of the target system • String with message about the license state, e.g. "license is valid" or "trial license denied“ Get Device State The Device State block is a polymorphic VI and can be operated as Get Device State and Set Device State. The operation mode Get Device State reads the current state of the target system and the PLC. The following table describes the ADS port and its meaning: ADS Port ADS State State Twin CAT 3 PLC Port > 851 ADS_STATE_RUN PLC is running. ADS_STATE_STOP PLC is stopped. ADS_STATE_RESET PLC is reset. System Port = 10000 ADS_STATE_RECONFIG Twin CAT is in Config mode. ADS_STATE_RESET Twin CAT is in Run mode. Input/output Meaning [0] Handle Handle to the ADS client [5] Target ADS target as string consisting of AMSNet Id [4] Handle Handle to the ADS client [6] Target ADS target as string consisting of AMSNet Id [8] Device State State of the target system (ENUM) TF3710 Version: 1.8.1 77
## Page 78

Lab VIEW™ VIs Input/output Meaning [10] ADS State State of the PLC (ENUM) Set Device State The Set Device State block changes the current state of the target system and the PLC. With a specific ADS Port and ADS State the PLC or Twin CAT can be set to a corresponding state. The following table describes the ADS port and its usage: ADS Port ADS State State Twin CAT 3 PLC Port > 851 ADS_STATE_RUN Starts the PLC. ADS_STATE_STOP Stops the PLC. ADS_STATE_RESET Resets the PLC. System Port = 10000 ADS_STATE_RECONFIG Puts Twin CAT in Config mode. ADS_STATE_RESET Puts Twin CAT in Run mode. Input/output Meaning [0] Handle Handle to the ADS client [5] Target ADS target as string consisting of AMSNet Id [7] Device State New state of the target system (numeric) [9] ADS State New state of the PLC (ENUM) [4] Handle Handle to the ADS client [6] Target ADS target as string consisting of AMSNet Id Get Version Info The Device State block in operation mode Get Version Info returns the current version of the TF3710 setup and the installed TF3710 library as a Lab VIEW™ string. Input/output Meaning [6] Product Version Setup version as string [8] File Version Version of the installed TF3710 library as string Generate Type The Generate Type block automatically generates the Lab VIEW™ data type based on a Type Info description from a Twin CAT 3 data type. The Lab VIEW™ type can be inserted as a constant or control on a block diagram or saved as a Lab VIEW™ ctl file. The Generate Type block is a wrapper VI and uses low-level class objects from Type Generator [} 98] together with the Type Resolver [} 97]. There are several ways in which the wrapper block can be parameterized. 1. The Type Resolver is already initialized externally and Lab VIEW™ already has a Type Handle. The b Auto Init flag has the value "False": ◦ The Type Resolver already has information regarding the Twin CAT 3 data type. ◦ The Wrapper block can generate the new type. 78 Version: 1.8.1 TF3710
## Page 79

Lab VIEW™ VIs ◦ The example Generate Type using Symbol Interface or Symbol's file [} 114] uses this method. 2. The Type Resolver is not initialized externally and Lab VIEW™ does not have a Type Handle. The b Auto Init flag has the value "True": ◦ The Type Resolver has no information regarding the Twin CAT 3 data type. ◦ The Wrapper block needs the Type Info to generate the type. ◦ The example Generate Type using Type Info file [} 115] uses this method. Input/output Meaning [0] Handle Handle to the ADS client [1] b Auto Init Boolean flag (True = Type Resolver is initialized internally, otherwise False) [2] Saving Info Lab VIEW™ cluster consisting of three elements: • Custom Dir: Boolean flag TRUE = Lab VIEW™ type is saved in a specific folder (Dir Name). If this folder does not exist, the block creates the folder. FALSE = Lab VIEW™ type is saved in the project folder, subfolder Ctl. • Dir Name: Lab VIEW™ string (name of the folder) • Control File Name: Lab VIEW™ string (name of the new Ctl. If empty, the block uses the name from the Type Info) [3] VI Refnum A static VI Refnum The block uses the VI Refnum to insert the Lab VIEW™ type as a Constant/Control/Indicator on the block diagram. [5] Type Hdl The handle to the Type Resolver [7] Symbol Group Lab VIEW™ Enum: • Read symbol: The block generates a control. • Write symbol: The block generates a control. [9] Type Info Lab VIEW™ string as XML description of Twin CAT 3 data type [12] Block Diagram Type Stype Lab VIEW™ Enum: • Constant • Control/Indicator [13] Control/Indicator/Constant Lab VIEW™ string. Name Empty string: Default name of the Type Info. Otherwise: Name of the Control/Indicator/Constant. [8] Generated Type Name Lab VIEW™ string as the name of the generated type [10] Loaded Type Lab VIEW™ Enum Describes which data type was generated. [14] Ctl path File path to the generated type control "Symbol Group" parameter The Symbol Group parameter can be used to select whether a control/display element must be generated. For the control, the Type Generator generates the type without name, because the Type Resolver supports the control without name. If the control is a Lab VIEW™ cluster, then the cluster members are also generated without names. TF3710 Version: 1.8.1 79
## Page 80

Lab VIEW™ VIs 7.10.1 Notification The Notification folder contains additional blocks that can be used with ADS notifications when reading. The folder contains the following VIs: • ADS To Lab VIEW Timestamp • Notification Data To Variant Array • Stop Notification • Unregister Notification ADS To Lab VIEW Timestamp The ADS To Lab VIEW Timestamp block is a polymorpohic VI and supports single and multiple ADS timestamps (as array). The block converts ADS timestamps, as transmitted by an ADS notification from Twin CAT, into Lab VIEW™ timestamps. Notification Timestamp Single The Notification Timestamp Single block converts single ADS timestamps to Lab VIEW™ timestamps. Input/output Meaning [1] Ads Timestamp Single ADS timestamp [0] Lab VIEW Timestamp Single converted Lab VIEW™ timestamp Notification Timestamp Buffered The Notification Timestamp Buffered block converts multiple ADS timestamps to Lab VIEW™ timestamps. Input/output Meaning [1] Ads Timestamp Array of ADS timestamps [0] Lab VIEW Timestamp Array of converted Lab VIEW™ timestamps Notification Data To Variant Array The Notification Data To Variant Array block converts ADS raw data that has been read with ADS notification into a suitable Lab VIEW™ Variant. Input/output Meaning [11] Notification Data ADS raw data [10] Samples Number of samples [3] Notification Data Converted raw data in Lab VIEW™ variant Stop Notification The Stop Notification block stops receiving ADS notifications. Input/output Meaning [5] Notification/Reader handle Handle to the ADS Notification/Reader 80 Version: 1.8.1 TF3710
## Page 81

Lab VIEW™ VIs Input/output Meaning [2] Notification/Reader handle Handle to the ADS notification/ADS reader [1] Has stopped? Boolean flag (TRUE if notification is stopped, FALSE otherwise) Start Notification The Start Notification block starts the registered notification. Input/output Meaning [5] Reader Handle Handle to the ADS reader [4] b Wait For Registered? True if the notification is to be started. [2] Reader Handle Handle to the ADS reader [1] Has started? Boolean flag (TRUE if notification is started, FALSE otherwise) Unregister Notification The Unregister Notification block unregisters the notification on the ADS server. Input/output Meaning [0] Handle The handle to the client (can also be left blank) [5] Reader Handle Handle to the ADS reader [4] Handle Handle to the ADS client [6] Reader Handle The handle to the ADS reader [8] Has unregistered? Boolean flag (TRUE if notification is registered, FALSE otherwise) 7.10.1.1 Notification controls These controls can be found at: Front Panel Palette > User Controls > Beckhoff Lab VIEW Interface > Notification. Single Buffer Info The Single Buffer Info control describes/defines the information needed for reading the Noti. Buffered [} 71]. Single User-Event Data The Single User-Event Data control describes/defines information needed for continuous reading of the E- Noti. Single [} 71] with Lab VIEW™ events. Buffered User-Event Data The Buffered User-Event Data control describes/defines information needed for continuous reading of the E- Noti. Buffered [} 72] with Lab VIEW™ events. 7.10.2 LVBuffer The LVBuffer folder contains blocks that can be used when reading an ADS notification. The folder contains the following VIs: • Init LVBuffer Handle TF3710 Version: 1.8.1 81
## Page 82

Lab VIEW™ VIs • Read From LVBuffer • LVBuffer status • Release LVBuffer Handle Init LVBuffer Handle The Init LVBuffer Handle block initializes a handle on the LVBuffer. Input/output Meaning [4] Buffer handle The handle to the LVBuffer Read From LVBuffer The Read from LVBuffer block waits for samples in the LVBuffer (Lab VIEW™-side data buffer, cf. Communication modes [} 25]). The Timeout Ms influences the waiting. The block waits for a defined time if Timeout Ms > 0, otherwise the block waits forever. If the LVBuffer receives a sample while waiting, the block reads the sample and passes it to Lab VIEW™. Relevant parameters: LVBuffer Size Input/output Meaning [0] Buffer handle The handle to the LVBuffer [5] Timeout Ms The waiting time in milliseconds: • Timeout Ms>0: Read From Buffer block waits for the defined time. • Timeout Ms<0: Read From Buffer block waits forever. [4] Buffer handle The handle to the LVBuffer [6] b Timeout Boolean flag: • True: if there is no sample in the LVBuffer in the defined time. • False: LVBuffer continuously gets new samples and the Read From Buffer block can read them. [10] Buffer Data Samples from the LVBuffer [14] Data Bytes Number of bytes in LVBuffer LVBuffer status The LVBuffer Status block returns the current state of the LVBuffer regarding samples in the LVBuffer. Input/output Meaning [0] Buffer handle The handle to the LVBuffer [4] Buffer handle The handle to the LVBuffer [6] Elements In Buffer Number of samples in LVBuffer that are still to be read. Release LVBuffer Handle The release LVBuffer Handle block releases the handle to the LVBuffer from memory. 82 Version: 1.8.1 TF3710
## Page 83

Lab VIEW™ VIs Input/output Meaning [0] Buffer handle The handle to the LVBuffer 7.10.3 Co E Some input and output components of control systems can be parameterized. For Ether CAT components, parameterization is based on the Can-Application-protocoll-over-Ether CAT (Co E) standard, see information on the Co E interface. VIs that enable you to read and write Co E objects from Lab VIEW™ are described below. The AMS address of the Ether CAT device is used here. The address is made up of the master AMS Net Id and AMS port of the client. The folder contains the following VIs: • Read Co E List • Read Co E Description • Read Co E Entry • Read Co E Value • Write Co E Value The example Co E Read or Write [} 116] describes the use of Co E blocks. Read Co E List The VI Read Co E List reads a Co E directory of a subscriber and lists all objects in an array that are available for the selected device. The objects are identified via indices that are used by subsequent Co E VIs for access. Input/output Meaning [0][4] Handle Handle to the ADS client [5][6] Device Address AMS address of the device consisting of: • AMS Net Id of the master • AMS port of the client [7] List Type Lab VIEW™ Enum Describes which indices from the directory are to be listed: • Total Number Of Lists: Lists the number of elements in the All Co EObjects, Rx PDOs, Tx PDOs, Stored For Device and Start Up directories. • All Co EObjects: List of all Co E objects • Rx PDOs: List of all Rx PDO objects • Tx PDOs: List of all Tx PDO objects • Setting Objects: List of all objects that are relevant when the device is replaced. • Start Up: List of objects that can be used as Start Up parameters. [8] List 1D array of the indices of the objects Read Co E Description The VI Read Co E Description calls up the Co E object description of the device and sends it to Lab VIEW™. The description includes the object name and the number of entries or subindices of the object. TF3710 Version: 1.8.1 83
## Page 84

Lab VIEW™ VIs Input/output Meaning [0][4] Handle Handle to the ADS client [5][6] Device Address AMS address of the device consisting of: • AMS Net Id of the master • AMS port of the client [7] Index Index of the object [8] Object Name Name of the object [10] Object Description Lab VIEW™ cluster consisting of the following elements: • Index: Index of the object • Data Type: Data type of the object • Max Sub Index: Number of subindices of the object Read Co E Entry The VI Read Co E Entry reads a Co E entry of an object. The object is referenced via the index and subindex. Information is returned, such as the name of the entry and the access. Input/output Meaning [0][4] Handle Handle to the ADS client [5][6] Device Address AMS address of the device consisting of: • AMS Net Id of the master • AMS port of the slave [7] Index Index of the object [8] Entry Name Type of entry [9] Sub Index Subindex of the entry [10] Co E Entry Lab VIEW™ cluster consisting of the following elements: • Index: Index of the object • Sub Index: Subindex of the entry • Bit Length: The length of the entry in bits • Object Access: Information on changeability, e.g. whether it can only be read or also written. Read Co E Value The VI Read Co E Value reads the value of a Co E entry. An array of the length Bit Length in bytes is returned. The array specifies the value in hexadecimal numbers in little-endian format. 84 Version: 1.8.1 TF3710
## Page 85

Lab VIEW™ VIs Input/output Meaning [1] Convert? Switches the conversion of the read Co E entry into the corresponding Lab VIEW™ data type on/off. If switched on, the converted data is located in "Lab VIEW™ Converted Data [10]". [0][4] Handle Handle to the ADS client [5][6] Device Address AMS address of the device consisting of: • AMS Net Id of the master • AMS port of the slave [7] Co E Entry Lab VIEW™ cluster consisting of the following elements: • Index: Index of the object • Sub Index: Subindex of the entry • Data Type: Data type of the entry • Bit Length: The length of the value of the entry in bits • Object Access: Describes the Ether CAT state in which the object can be accessed. [8] Data 1D byte array with the value of the Co E entry [10] Lab VIEW™ Converted Only available if "[1] Convert?" is set to True. Data Lab VIEW™ Cluster, which contains the Co E data converted to Lab VIEW™, consisting of: • Data as string: Data as string (e.g. numeric value 42 becomes "42") • Data as variant: Data as Lab VIEW™ Variant, which can be converted to the original Lab VIEW™ data type using "Variant To Data". The value of the Co E entry is displayed in hexadecimal and the bytes are transferred in little-endian order. Character strings and arrays are transferred from left to right, whereby the elements of the array are stored in little-endian. Write Co E Value The Write Co E Value block writes the value of the Co E entry. The value to be written is an array of bytes of the size Bit Length. The values must be specified in hexadecimal numbers in little-endian format. Input/output Meaning [1] Write Format Lab VIEW™ Enum Selects the format of the data to be written (Co E entry), which is provided via the "[9] Data" input: • Byte Array • String • Variant [0][4] Handle Handle to the ADS client [5][6] Device Address AMS address of the device consisting of: • AMS Net Id of the master • AMS port of the slave [7] Co E Entry Lab VIEW™ cluster consisting of the following elements: • Index: Index of the object • Sub Index: Sub Index of the entry TF3710 Version: 1.8.1 85
## Page 86

Lab VIEW™ VIs Input/output Meaning • Data Type: Data type of the entry • Bit Length: The length of the value of the entry in bits • Object Access: Describes the Ether CAT state in which the object can be accessed. [9] Data Lab VIEW™ Variant that contains the data to be written (Co E entry). The data can be in the following formats: • Byte array: 1D byte array of length "Co E Entry. Bit Length". Values must be specified in hexadecimal numbers in little-endian format. • String: Value is specified as a string and converted internally to "Co E Entry. Data Type". • Variant: Value is transferred as a Lab VIEW™ Variant and converted internally to "Co E Entry. Data Type". 7.10.4 Heartbeat In this chapter you will find a description of the VIs with which you can create a Heartbeat connection monitoring between Lab VIEWTM and Twin CAT. Further information on the parameters can be found in the Heartbeat Connection Monitoring section in the technical introduction [} 39]. Connection monitoring can be created from the following Low-Level VIs: • Init Heartbeat • Run Heartbeat • Stop Heartbeat • Release Hearbeat • Get RTD Estimate The folder also contains the Heartbeat basic VI, in which the connection monitoring is summarized in a VI. System requirements The Heartbeat function is available from Twin CAT 3.1 Build 4026. Init Heartbeat The "Init Heartbeat" block creates a Heartbeat instance. Based on the client handle (see Init), a scan is performed for each registered target to determine whether an instance of FB_Heartbeat exists. If this is the case, connection monitoring is prepared for each heartbeat found. If no instance of FB_Heartbeat is found at any target, the VI returns the error -8114. FB_Heartbeat The FB_Heartbeat function block can be found in the Tc3_Heartbeat Connection Monitoring library and must be created and called in the project for which connection monitoring is being set up. The block also creates a Heartbeat event. This can then be used to query the status of the connection. As soon as the status of the connection changes, a Heartbeat event is generated. The Heartbeat event has the following event dates: • Heartbeat Handle: Handle to the Heartbeat instance from which the event was generated. • Target Addr: String containing the AMS address (Net Id:Port) of the target from which the Heartbeat event was triggered. ◦ Connection State: Enum that specifies the reason for triggering the Heartbeat event. ◦ Waiting: Heartbeat initialized, connection monitoring not (yet) started. ◦ Connected: Connection monitoring started. ◦ Timeout detected: Connection monitoring has detected an interruption. ◦ Stopped: Connection monitoring has been stopped. 86 Version: 1.8.1 TF3710
## Page 87

Lab VIEW™ VIs ◦ Error: An error has occurred during connection monitoring (error code is provided at the Heartbeat output. If more than one target is monitored, only the connection monitoring for the corresponding target is stopped; the others continue to run). ◦ Reserved: reserved (ignore) Input/output Meaning [0][4] Handle Handle to the ADS client [5] Polling Time in ms Parameter Polling time in ms [6] Heartbeat Handle Handle to the Heartbeat instance [7] Use Rtd Estimation? Parameter Use Rtd Estimation [9] Offset in ms Parameter offset [10] Heartbeat Event User Event Refnum on the generated Heartbeat event Run Heartbeat The Run Heartbeat block is used to start and continuously execute connection monitoring. This block is executed until the connection monitoring is stopped with the Stop Heartbeat. Input/output Meaning [0][4] Handle Handle to the ADS client [5][6] Heartbeat Handle Handle to the Heartbeat instance Stop Heartbeat The Stop Heartbeat block is used to stop connection monitoring. Input/output Meaning [0][4] Heartbeat Handle Handle to the Heartbeat instance Release Heartbeat The Release Heartbeat block releases the handle to the Heartbeat connection monitoring from the memory. Input/output Meaning [0][4] Handle Handle to the ADS client [5] Heartbeat Handle Handle to the Heartbeat instance Get RTD Estimate The Get RTD Estimate block returns the current (maximum) roundtrip delay (RTD) estimate for the selected target. The target can be selected via the "Target Addr" string. If the string is empty, the target found first is automatically selected. To use this block, it is necessary to execute the Heartbeat connection monitoring (see VIs described above). TF3710 Version: 1.8.1 87
## Page 88

Lab VIEW™ VIs Input/output Meaning [0][4] Handle Handle to the ADS client [5][6] Heartbeat Handle Handle to the Heartbeat instance [7][8] Target Addr String with the address of the target [10] RTDEstimate Estimation of the maximum RTD in ms Heartbeat The Heartbeat block uses the Init Heartbeat, Run Heartbeat, Stop Heartbeat and Release Heartbeat blocks internally to enable the use of Heartbeat connection monitoring with just one block. The Heartbeat block also serves as an illustration of how Heartbeat connection monitoring can be used and edited. Heartbeat connection monitoring is carried out continuously until it is stopped via a control. If the connection monitoring detects an interruption (timeout), an attempt is made to call up a VI (vi path timeout detected). If it is not possible to call the VI, the block and Heartbeat connection monitoring are stopped. At the output of the VI, the target for which an interruption was detected is then displayed via Timeout detected and the Target Addr. If there are several interruptions, only the first interruption is displayed. Input/output Meaning [0][4] Handle Handle to the ADS client [1] Stop Heartbeat Reference to a Boolean control that is used to end the execution of the Heartbeat VI. [2] vi path timeout detected Path to a VI that is to be called if a connection interruption is detected. [5] Polling Time in ms Parameter Polling time in ms [6] Target Addr String that specifies the target to which the possible timeout belongs. [7] Use Rtd Estimation? Parameter Use Rtd Estimation [9] Offset in ms Parameter offset [10] Timeout detected Indicates whether a connection interruption was detected. 7.10.5 Project Automation The Project Automation section contains VIs that can be used to create, configure and activate a Twin CAT 3 project. The associated example is particularly suitable if you have no previous knowledge of Twin CAT 3. The folder contains the following blocks: 88 Version: 1.8.1 TF3710
## Page 89

Lab VIEW™ VIs Init Project The VI Init Project initializes a Twin CAT 3 Engineering project. If there is no solution file (*.sln) and no Twin CAT 3 project of the same name under the specified path, these are created, otherwise the existing ones are called. Each call of the block opens a new Twin CAT 3 XAE Shell, unless this is prevented via the Suppress UI parameter. Input/output Meaning [0] Solution Path An absolute path that specifies where the solution file should be stored or from where it should be opened. If the path is empty, the Lab VIEW™ Data directory is selected [1] Suppress UI? False (default): Open new XAE Shell True: Prevents the opening of a new XAE Shell [4] Handle The handle to the Twin CAT 3 Solution [5] Twin CAT Route Information Lab VIEW™ cluster consisting of the following elements: • Route Identification: Target system designation consisting of host name, IP address or AMS Net Id • Route Authentification: Route authentication consisting of user name and password [7] Solution Name Name of the solution file. If the name does not yet exist in the directory, a new solution is created; if the file already exists, it is used. [9] Project Name Name of the new Twin CAT 3 project. If the project already exists, no new one is created. Create Task The Create Task block initializes a Twin CAT 3 task with a name. If the task already exists in the project tree, the existing one is used. TF3710 Version: 1.8.1 89
## Page 90

Lab VIEW™ VIs Input/output Meaning [0][4] Handle The handle to the Twin CAT 3 Solution [1] With Image? True: Create Twin CAT 3 task with image, i.e. the task can contain one or more inputs/outputs that can be linked to real inputs/outputs [5] Task Name The name of the task [7] Cycle Time [ms] The cycle time of the task in milliseconds [9] Use Core No. The number of the CPU core on which the task is executed. Isolated and split cores Do one or more isolated cores already exist? These are then preferred over split cores. Scan IO The Scan IO block checks the target system for connected I/O devices (Ether CAT master or Ether CAT slave) in the network and adds them to the project tree. The following is taken into account: • If an Ether CAT master already exists in the project tree, the block checks whether the configuration of the master or the terminals has been changed. • If there is a second Ether CAT master that is not yet present in the project tree, it is added to the project tree with the associated terminal configuration. • If the route is changed that is not connected to any I/O devices but there are unnecessary I/O devices in the project tree, they are deleted. Input/output Meaning [0][4] Handle The handle to the Twin CAT 3 Solution [1] Enable ADS Server? True: Enables the ADS server for the process image so that all inputs and outputs can be accessed via ADS. This can be used, for example, to read terminal values with the TF3710. [5] Device Type Lab VIEW™ Enum consisting of two elements: • Ether CATMaster: Check new or existing Ether CAT masters and their terminal configuration • Ether CATSlave: Check changed terminal configuration of existing masters [9] Sync Master Task Name Name of the task that is responsible for the cyclic execution of the Ether CAT frame. Create PLC The block creates a new PLC project within the Twin CAT 3 project. If a PLC with the same name already exists in the directory, it will be used. 90 Version: 1.8.1 TF3710
## Page 91

Lab VIEW™ VIs Input/output Meaning [0][4] Handle The handle to the Twin CAT 3 Solution [5] PLC Name The name of the Twin CAT 3 PLC project [7] Autostart at Boot? True: After restarting the computer, the PLC program is started automatically Activate Solution The block activates the Twin CAT configuration and switches from Config to Run Mode. DANGER Controller is activated The controller is activated and the program code is executed by the hardware. Input/output Meaning [0][4] Handle The handle to the Twin CAT 3 Solution [6] ADS State Lab VIEW™ enum: Describes the current state of the Twin CAT system Release Project The block releases the handle to the Twin CAT 3 Solution from the memory. Input/output Meaning [0] Handle The handle to the Twin CAT 3 Solution [1] Close Solution? True: Close the Twin CAT 3 XAE Shell 7.11 Low-Level Low-Level VIs [} 42] can be used to provide more programming flexibility in certain situations, or to increase read or write speed. 7.11.1 Init The Init subfolder contains low-level blocks that are necessary for initializing and connecting the ADS client. Base Init The Base Init block initializes and establishes a connection between ADS client and ADS router. The block checks the licenses on the target systems after a successful connection. After successful verification the block returns a valid handle to the ADS client. TF3710 Version: 1.8.1 91
## Page 92

Lab VIEW™ VIs Input/output Meaning [0] XML Description Lab VIEW™ XML string with ADS read and write symbols or the path as a string to an existing, already created (exported) XML file. [4] Handle Handle to the ADS client [6] License State List of license states of the Twin CAT target systems [8] Read Grp Symbols List of symbols that are read via ADS [10] Write Grp Symbols List of symbols that are written via ADS Add Write Symbols The Add Read Write Symbols block adds further symbols to the Client Handle. If new Twin CAT target systems are added, the block checks whether a valid license is available for each of the target systems. The result can be checked via the License State output. Input/output Meaning [0][4] Handle Handle to the ADS client [5] XMLDescription Lab VIEW™ XML string with symbols to be read or written, or string of the path to an existing XML file [6] License State List of license states of the Twin CAT target systems [7] Add Options Options for dealing with multiple symbols: - No Duplicate Default: Checks whether a symbol with the same name, symbol name and symbol type already exists. If yes, this symbol is skipped. - Duplicate Default: Adds the new symbols to the list without checking for duplicates. - Update Duplicate Default: Checks whether a symbol with the same name, symbol name and symbol type already exists. If so, this symbol is updated. - No Duplicate By Name: Checks whether a symbol with the same name already exists. If yes, this symbol is skipped. - Update Duplicate By Name: Checks whether a symbol with the same name already exists. If so, this symbol is updated. - ... [8] Read Grp Symbols List of symbols that are read via ADS [10] Write Grp Symbols List of symbols that are written via ADS Get List of Registered Targets The Get List of Registered Targets block creates a list of ADS target systems which have been selected by the user in Symbol Interface [} 67] or entered in the directly loaded XML file. Input/output Meaning [0][4] Handle Handle to the ADS client [6] List of Registered Targets List of registered target systems 92 Version: 1.8.1 TF3710
## Page 93

Lab VIEW™ VIs Get List of Read Write Symbols The Get List of Read Write Symbols block creates a list of registered ADS read and write symbols, which have been selected by the user in Symbol Interface [} 67] or entered in the directly loaded XML file. Input/output Meaning [0][4] Handle Handle to the ADS client [5] List of Registered Targets List of registered target systems [8] Read Grp Symbols List of ADS reading symbols [10] Write Grp Symbols List of ADS writing symbols 7.11.2 Read The subfolder Read contains low-level blocks which are necessary for reading via ADS. Init Reader The Init Reader block initializes the ADS reader. When a call is successful the block returns a handle to the ADS reader. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] [8] Reader Mode The reading mode (ENUM: Sync/Async) [10] Read Handle Handle to the ADS reader Send Reader-Request The Send Reader-Request block sends a read request to the ADS server. The block waits for a response from the server if the reader has been initialized with the "Synchronous" operation mode. Otherwise the block does not wait for the response and passes the Read Handle. Input/output Meaning [0] [4] Handle Handle to the ADS client TF3710 Version: 1.8.1 93
## Page 94

Lab VIEW™ VIs Input/output Meaning [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] Reader Mode The reading mode (ENUM: Sync/Async) [8] [9] Read Handle Handle to the ADS reader [10] Read status? Read status [14] ADS-Read Data ADS raw data Register Notification The Register Notification block registers the ADS notification with the ADS server and waits until the notification is explicitly unregistered from the outside. The registration does not start the notifications automatically. They have to be started explicitly. Input/output Meaning [0] [4] Handle Handle to the ADS client [1] Elapse Time Ms ADS symbol consisting of AMSNet Id and symbol name [5] Reader Mode The type of reading: Lab VIEW™-ENUM: • Noti. Single [} 70] • Noti. Buffered [} 71] • E-Noti. Single [} 71] • E-Noti. Buffered [} 72] • LVB-Noti. Single Symbol [} 73] [7] Reader Argument Reader arguments vary with the Reader Mode: • Noti. Single: no argument • Noti. Buffered: Single Buffer Info [} 81] • E-Noti. Single: Lab VIEW™ Event Ref to Single User-Event Data [} 81] • E-Noti. Buffered: Lab VIEW™ Event Ref to Buffered User-Event Data [} 81] • LVB-Noti. Single Symbol: Handle to LVBuffer to type (UINT32) [9] [10] Read Handle Handle to the ADS reader Try Read Data In connection with the "Asynchronous" operation mode the Try Read Data block checks the successful receipt of a response (ADS data packet) from the ADS server. 94 Version: 1.8.1 TF3710
## Page 95

Lab VIEW™ VIs Input/output Meaning [0] [4] Handle Handle to the ADS client [5] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [6] [9] Read Handle Handle to the ADS reader [8] Read status? Read status [10] ADS-Read Data ADS raw data Release Reader The Release Reader releases the handle to the reader from memory. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] Read Handle Handle to the ADS reader 7.11.3 Write The subfolder Write contains low-level blocks that are necessary for writing via ADS. Init Writer The Init Writer block initializes the ADS writer. When a call is successful the block returns a handle to the ADS writer. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var TF3710 Version: 1.8.1 95
## Page 96

Lab VIEW™ VIs Input/output Meaning • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] [8] Writer Mode Writing mode (Sync/Async) [10] Write Handle Handle to the ADS Writer Send Writer Request The Send Writer-Request block sends a write request to the ADS server. The block waits for a response from the server if the writer has been initialized with the "Synchronous" operation mode. Otherwise the block does not wait for the response and passes the Write Handle. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [7] Writer Mode Writing mode (Sync/Async) [8] [9] Write Handle Handle to the ADS Writer [12] ADS-Write Data Type Resolved ADS data packet [10] Write status? Write status Check Write Status The Check Write Status block checks for successful write access to the ADS server in connection with the "Asynchronous" operation mode. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [6] [9] Write Handle Handle to the ADS Writer [8] Write status? Write status 96 Version: 1.8.1 TF3710
## Page 97

Lab VIEW™ VIs Release Writer The Release Writer releases the handle to the writer from memory. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] Write Handle Handle to the ADS Writer 7.11.4 Type Resolver The subfolder Type Resolver contains low-level blocks necessary for converting and comparing between the Lab VIEW™ data type and the Twin CAT 3 data type. Init Type The Init Type block initializes the Type Resolver based on Symbol Name and Handle. Upon successful initialization, the block passes the handle to the Type Resolver and the Twin CAT 3 data type of the ADS symbol as a Lab VIEW™ string in XML description to the Lab VIEW™ process. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] [6] Symbol Name Describes an ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [8] Type Hdl Handle to the Type Resolver [10] Type Size Data type size in bytes [14] Type Info Type Description in XML as Lab VIEW™ string Resolve From TC Type The Resolve From TC Type block compares and converts the raw data from the ADS read to the corresponding Lab VIEW™ data type "Variant". The conversion only takes place if the comparison between the two data types was successful. Input/output Meaning [0] [4] Handle Handle to the ADS client [6] [7] Type Hdl Handle to the Type Resolver TF3710 Version: 1.8.1 97
## Page 98

Lab VIEW™ VIs Input/output Meaning [9] ADSRData ADS data packet as raw data [8] RData Array Type Resolved ADS raw data as Variant array [10] RData Type Resolved ADS raw data as Variant Resolve To TC Type The block Resolve To TC Type converts the raw data for ADS-Read from a Lab VIEW™ data type "Variant" to the appropriate Twin CAT 3 data type. The conversion only takes place if the comparison between the two data types was successful. Input/output Meaning [0] [4] Handle Handle to the ADS client [6] [7] Type Hdl Handle to the Type Resolver [9] WData ADS data packet as raw data [8] b Has Matched Flag (True if Twin CAT 3 and Lab VIEW™ data type are identical, otherwise False) [10] ADSWData Type Resolved ADS raw data as Variant Release Type The Release Type releases the handle to the Type Resolver from memory. Input/output Meaning [0] [4] Handle Handle to the ADS client [5] Type Handle Handle to the Type Resolver 7.11.4.1 Type Generator The subfolder Type Generator contains Lab VIEW™ classes that are responsible for generating a supported Lab VIEW™-Data types [} 124]. The following graphic shows the relationship or inheritance between the Type Generator classes. 98 Version: 1.8.1 TF3710
## Page 99

Lab VIEW™ VIs Use of the classes The Type Gnerator classes of the respective data types were derived from the Base class and have inherited the functions. See also the information about the wrapper block Generate Type [} 78]. CBase Type Descriptor class The CBase Type Descriptor class is the top class in the hierarchy. This class provides general methods and properties for the other classes that inherit from it. The table presents general information about the public properties and methods. The Lab VIEW™ blocks provide further detailed information. VI Property/method Access (Scope) Meaning Read m_TCName Public Reads the property m_TCName (name of the loaded type) Write m_TCName Public Writes the property m_TCName (name of the loaded type) Read m_Type Code Public Reads the property m_Type Code (defines a numeric value for the loaded type) Read m_Type ID Public Reads the property m_Type ID (ID as GUID of the loaded type) Read m_Type Style Public Reads the property m_Type Style (Lab VIEW™ Enum: Describes how the loaded type should be generated) Write m_Type Style Public Writes the property m_Type Style (Lab VIEW™ Enum: Describes how the loaded type should be generated). Load Public, Static Loads Twin CAT3 type Dispatch information into memory based on Type Resolver or Type Info. Create Type Public, Dynamic The method is empty. The Dispatch classes that inherit from this class implement this method. Create Sub Type Public, Dynamic The method is empty. The Dispatch classes that inherit from this class implement this method. Unload and Save Public, Static Unloads the loaded type Dispatch from memory and saves the new type (if Ctl). CBoolean Type Descriptor class The CBoolean Type Descriptor class generates a Boolean type as a constant or control (in a block diagram) or as a ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. TF3710 Version: 1.8.1 99
## Page 100

Lab VIEW™ VIs Method Access (Scope) Meaning Init Public, Static Dispatch Initializes a Boolean type based on the loaded Type Info. Create Type Public, Static Dispatch Generates a Boolean type based on the loaded Twin CAT 3 type information. Create Sub Type Public, Static Dispatch Generates a Boolean type as a sub-type, e.g. the element of a cluster. IEC 61131-3 BIT data type The CBoolean Type Descriptor class supports BOOL and BIT data types and can therefore be used to generate both. CNumeric Type Descriptor class The CNumeric Type Descriptor class generates a numeric type with proper representation (I8, I16, I32, Single, ...) as constant or controls (in a block diagram) or as ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. Method Access (Scope) Meaning Init Public, Static Dispatch Initializes the numeric type, based on the loaded Type Info. Create Type Public, Static Dispatch Generates a numeric type based on the loaded Type Info. Create Sub Type Public, Static Dispatch Generates a numeric type as a sub-type, e.g. the element of a cluster. CString Type Descriptor class The CString Type Descriptor class generates a Lab VIEW™ string as a constant or control (in a block diagram) or as a ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. Property/method Access (Scope) Meaning Read m_Length Public Reads the property m_Length (length of the Twin CAT 3 string of the loaded Type Info). Init Public, Static Dispatch Initializes a Lab VIEW™ string based on the loaded Type Info. Create Type Public, Static Dispatch Generates a Lab VIEW™ string based on loaded Type Info. Create Sub Type Public, Static Dispatch Generates a Lab VIEW™ string as a sub-type, e.g. an element of a Lab VIEW™ cluster. 100 Version: 1.8.1 TF3710
## Page 101

Lab VIEW™ VIs CTimestamp Type Descriptor class The CTimestamp Type Descriptor class generates a timestamp Lab VIEW™ type as a constant or control (in a block diagram) or as a ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. Method Access (Scope) Meaning Init Public, Static Dispatch Initializes the timestamp based on the loaded Type Info. Create Type Public, Static Dispatch Generates a timestamp based on the loaded Type Info. Create Sub Type Public, Static Dispatch Generates a timestamp as a sub-type, e.g. an element of a Lab VIEW™ cluster. CArray Type Descriptor class The CArray Type Descriptor class generates an array Lab VIEW™ type as a constant or control (in a block diagram) or as a ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. Property/method Access (Scope) Meaning Read m_Array Info Public Reads the property m_Array Info (information regarding Twin CAT 3 Array Dimension elements) Read m_Base Type ID Public Reads the property m_Base Type ID (ID as GUID of the loaded base type) Read m_Dimensions Public Reads the property m_Dimensions (number of Twin CAT 3 Array Dimensions) Read m_Sub Types Public Reads the property m_Sub Types (for arrays of Lab VIEW™ clusters, this property specifies the number of cluster elements generated) Init Public, Static Dispatch Initializes the array based on the loaded Type Info. Create Type Public, Static Dispatch Generates an array based on the loaded Type Info. Create Sub Type Public, Static Dispatch Generates an array as a sub-type, e.g. an element of a Lab VIEW™ cluster. Get Tot Sub Types Public, Static Dispatch Returns information about the number of complex sub-types of the array and their IDs as GUID (e.g.: array with complex Base Type, where the TF3710 Version: 1.8.1 101
## Page 102

Lab VIEW™ VIs Property/method Access (Scope) Meaning Base Type contains further arrays with complex Base Types). Get Sub-Type Info Public, Static Dispatch Reads Type Info of the complex Base Type or Sub Type with entered ID as GUID. Create Type From Existing Public, Static Dispatch Generates an array of a Base Type ctl from a path. CCluster Type Descriptor class The CCluster Type Descriptor class generates a cluster Lab VIEW™ type as a constant or control (in a block diagram) or as a ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. Property/method Access (Scope) Meaning Read m_Sub Items Public Reads the property m_Sub Items (the number of elements in the current cluster). Read Public Reads the property m_Generated Sub Items m_Generated Sub Items (the number of generated elements in the current cluster). Read m_Nested Level Public Reads the property m_Nested Level (the nested level of the current cluster). Read Public Reads the property m_Remaining Sub Items m_Remaining Sub Items (the number of elements of the current cluster that are yet to be generated). Read m_Actual Position Public Reads the property m_Actual Position (iterator of the Sub Types in the cluster). Init C Public, Static Dispatch Initializes the clusters, based on the loaded Type Info. Create Type Public, Static Dispatch Generates a cluster based on the loaded Type Info. Create Sub Type Public, Static Dispatch Generates a cluster as a sub-type, e.g. an element of a Lab VIEW™ cluster. CEnum Type Descriptor class The CEnum Type Descriptor class generates an Enum Lab VIEW™ type as a constant or control (in a block diagram) or as a ctl on the hard disk. The table presents general information about public methods. The Lab VIEW™ blocks provide further detailed information. 102 Version: 1.8.1 TF3710
## Page 103

Lab VIEW™ VIs Property/method Access (Scope) Meaning Read m_Keys Public Reads the property m_Keys (All text elements of the Enum). Read m_Representation Public Reads the property m_Representation (The underlying memory of the Enum). Init Public, Static Dispatch Initializes the Enum, based on the loaded Type Info. Create Type Public, Static Dispatch Generates an Enum based on the loaded Type Info. Create Sub Type Public, Static Dispatch Generates an Enum as a sub-type, e.g. an element of a Lab VIEW™ cluster. 7.11.5 Sum Up The Sum Up subfolder contains low-level blocks that allow writing or reading multiple ADS symbols with one API call. Compared to simple ADS Read or Write statements, only one handle is needed for writing or reading multiple symbols with the Sum Up. The handle can in turn contain several subcommands that are sent simultaneously to the Twin CAT 3 Runtime. Init Sum Up The block Init Sum Up initializes the ADS Sum Up. If the call is successful, the block returns a handle to the ADS Sum Up. Input/output Meaning [0] [4] Handle Handle to the client [1] b Autosend Autosend flag enables automatic sending of the Sub Command [5] Sum Up mode Sum Up modes: TF3710 Version: 1.8.1 103
## Page 104

Lab VIEW™ VIs Input/output Meaning • Write • Read [6] Sum Up handle Handle on the Sum Up Add Sub Command The block Add Sub Command initializes a new subcommand and adds it to the Sum Up handle. Input/output Meaning [0] [4] Handle Handle to the client [5] [6] Sum Up Handle Handle on the Sum Up [7] [8] Symbol ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 Put Data The block Put Data adds new data to the initialized sub-command. For this, the block needs the symbol name to identify the sub-command. The block can only be used for writing Sum Up commands. Input/output Meaning [0] [4] Handle Handle to the client. [5] [6] Sum Up Handle Handle on the Sum Up [7] Symbol ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] Write Data Data that is to be written Get Data The block Get Data retrieves new data from the initialized sub-command. For this, the block needs the symbol name to identify the sub-command. The block can only be used for reading Sum Up commands. 104 Version: 1.8.1 TF3710
## Page 105

Lab VIEW™ VIs Input/output Meaning [0] [4] Handle Handle to the client [5] [6] Sum Up Handle Handle on the Sum Up [7] Symbol ADS symbol consisting of AMS address and symbol designation: • AMS address: A compilation of AMS Net Id and AMS port. • Symbol designation: Symbol name or index group/offset Examples of the symbol name: • AMS address and symbol name: 127.0.0.0.1.1:851::MAIN. Var • AMS address and index group/offset: 127.0.0.0.1.1:851::0x1234/0x12345 [9] Wait? Wait flag that defines whether to wait for the data to be read. • True: The block waits until the timeout to see if the new data has come in. • False: The block does not wait for the new data. [15] Read Data The data to be read Enable Autosend The block Enable Autosend enables the automatic sending of the Sum Up command. Input/output Meaning [0] [4] Handle Handle to the client [1] b Autosend The Autosend flag enables automatic sending of the Sub Command [5] [6] Sum Up Handle Handle on the Sum Up NOTICE Sub-commands without data Automatic sending fails for initialized sub-commands that do not contain any data. Send The Send block sends the sub-commands added to the Sum Up handle to the Twin CAT 3 runtime. In contrast to Enable Autosend [} 105], the Send Sum Up must be explicitly called cyclically to send the data to Twin CAT. Input/output Meaning [0] [4] Handle Handle to the client [5] [6] Sum Up Handle Handle on the Sum Up TF3710 Version: 1.8.1 105
## Page 106

Lab VIEW™ VIs NOTICE Sub-commands without data Sending fails for initialized sub-commands that do not contain any data. Release Sum Up The block Release Sum Up releases the Sum Up handle from memory. Input/output Meaning [0] [4] Handle Handle to the client [5] Sum Up Handle Handle on the Sum Up 7.12 With Type Resolving The folder With Type Resolving contains blocks that integrate reading and writing via ADS with Type Resolver and, accordingly, further simplify programming in Lab VIEW™. Read Type Resolved The Read Type Resolved block is a polymorphic block that integrates reading via ADS with Type Resolver. The block offers synchronous and asynchronous reading via ADS. Read Sync Single Type Resolved The Read Type Resolved block in operation mode Read Sync Single Type Resolved calls the ADS-Read [} 69] block to receive the ADS data packet (as ADS raw data) synchronously from the ADS server and then convert it into a Lab VIEW™ data type using the Get Type Resolver [} 76] block. Input/output Meaning [0] Handle Handle to the ADS client [5] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [4] Handle Handle to the ADS client [8] Read Status? Read status [10] RData Type Resolved ADS raw data as Variant Read Async Single Type Resolved In the operation mode Read Async Single Type Resolved, the Read Type Resolved block calls the Async Single [} 70] block to receive the ADS data packet (as ADS raw data) asynchronously from the ADS server and then convert it to a Lab VIEW™ data type using the Get Type Resolver [} 76] block. 106 Version: 1.8.1 TF3710
## Page 107

Lab VIEW™ VIs Input/output Meaning [0] Handle Handle to the ADS client [1] Wait? TRUE = wait for server response (sync) FALSE (default) = do not wait for server response (async) [5] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [4] Handle Handle to the ADS client [6] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [8] Read Status? Read status [10] RData Type Resolved ADS raw data as Variant [14] Read Hdl Handle to the ADS reader Write Type Resolved The Write Type Resolved block is a polymorphic block that integrates writing via ADS with Type Resolver. The block offers synchronous and asynchronous writing via ADS. Write Sync Single Type Resolved The Write Type Resolved block in operation mode Write Sync Single Type Resolved calls the Set Type Resolver [} 76] block to convert the Lab VIEW™ data type to a Twin CAT 3 data type and then sends the converted data packet to the ADS server synchronously by calling the Sync Single [} 75] block. Input/output Meaning [1] b Type With Labels True if the data type has a label. [0] Handle Handle to the ADS client [5] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [9] WData ADS data packet as raw data [4] Handle Handle to the ADS client [8] Write Status? Write status [10] Has Matched? Flag indicating whether conversion and comparison between Lab VIEW™ and Twin CAT 3 data type was successful. Write Async Single Type Resolved In operation mode Write Async Single Type Resolved, the Write Type Resolved block calls the Set Type Resolver [} 76] block to convert the Lab VIEW™ data type to a Twin CAT 3 data type and then sends the converted data packet asynchronously to the ADS server with the call from the Sync Single [} 75] block. Input/output Meaning [1] b Type With Labels True if the data type has a label. [0] Handle Handle to the ADS client TF3710 Version: 1.8.1 107
## Page 108

Lab VIEW™ VIs Input/output Meaning [1] Wait? TRUE = wait for server response (sync) FALSE (default) = do not wait for server response (async) [5] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [9] WData ADS data packet as raw data [4] Handle Handle to the ADS client [6] Symbol Name ADS symbol consisting of AMSNet Id and symbol name [8] Write Status? Write status [10] Has Matched? Flag indicating whether conversion and comparison between Lab VIEW™ and Twin CAT 3 data type was successful. [14] Write Handle Handle to the ADS Writer 108 Version: 1.8.1 TF3710
## Page 109

Samples 8 Samples The TF3710 Twin CAT 3 Interface for Lab VIEW™ product categorizes the examples into two different groups, which are described as follows: 8.1 Basic examples A large number of basic examples are included in the Lab VIEW™ environment during the installation of the Interface for Lab VIEW™. These can be found with the help of the NI Example Finder. The following keywords facilitate the search for the examples: • TC3 • Beckhoff • Beckhoff-Lab VIEW-Interface • ADS • Twin CAT • TF3710 The NI Example Finder can be started in Lab VIEW™ under Menu > Help > Find Examples. Likewise, you can find all examples via the Directory Structure at Beckhoff Automation > Beckhoff-Lab VIEW-Interface. The examples are categorized into the communication modes [} 25] described at the beginning of the documentation: • One-time reading • One-time writing • Reading data continuously • Writing data continuously • Generate Lab VIEW™ type • Sum Up Read or Write • Co E Read or Write One-time reading Simple Read with Type Resolving.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs from the Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the Symbol Interface [} 67] basic block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. TF3710 Version: 1.8.1 109
## Page 110

Samples ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. After initialization the polymorphic ADS-Read [} 69] block is called. The Read Choice input can be used to select which read mode is to be used. The Read Choice input is a Lab VIEW™ Enum and provides the following options: ◦ Read Sync: For this, a synchronous read request is first sent to the Twin CAT runtime and a response is waited for. The received ADS data packet is then converted from raw data to the Lab VIEW™ data type "Variant" using the Type Resolver. ◦ Noti. Single: For this, an ADS notification is registered and individual received notifications are passed on to Lab VIEW™. After reading the notification, the notifications are unregistered again. The received ADS data is then converted from raw data to the Lab VIEW™ data type "Variant" with the help of the Type Resolver. ◦ Noti. Buffered: For this, an ADS notification is registered and a block of received notifications is passed on to Lab VIEW™. The number of notifications buffered in the block is determined by the LVBuffer Size symbol parameter. After reading the notifications, they are unregistered. The received ADS data is then converted from raw data to the Lab VIEW™ data type "Variant" with the help of the Type Resolver. 5. Interaction: Variant-to-Data can be used to customize the example to translate the Variant to an appropriate data type. The data type depends on the ADS symbol selected in the Symbol Interface. See Type Resolving [} 37]. 6. In the last step, the Release [} 76] basic block is called and the ADS client is released from memory. NOTICE Noti. Single Noti. Single supports only the Transmode=On Change Read Async with Type Resolving.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of the ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. After initialization, the block Read Async Single Type Resolved [} 106] is called. An asynchronous read request is sent to the Twin CAT runtime for this purpose. The program code continues running without waiting for feedback. 5. In this example the low-level block Try Read Data [} 94] is called in a while loop and waits for a response from the requested ADS server. Please note that this is an illustrative example. The implementation in actual applications may differ considerably. Once feedback has been received, the received data packet is converted to the appropriate Lab VIEW™ data type "Variant". 6. Interaction: Variant-to-Data can be used to customize the example to translate the Variant to an appropriate data type. The data type depends on the ADS symbol selected in the Symbol Interface. See Type Resolving [} 37]. 7. The next step is to call the low-level block Release Reader [} 95] to release the reader from memory. 8. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. 110 Version: 1.8.1 TF3710
## Page 111

Samples One-time writing Write Sync with Type Resolving.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Write Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. Interaction: Insert the appropriate data type in the place marked in red. The data type depends on the ADS symbol selected in the Symbol Interface. See Data types [} 124]. 5. After initialization, the block Write Sync Single Type Resolved [} 107] is called. For this purpose, the raw data is first converted from the Lab VIEW™ data type to a suitable Twin CAT 3 data type and then a synchronous write request is sent to Twin CAT. The block waits for a response from the server to ensure that the data was sent successfully. 6. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. Write Async with Type Resolving.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Write Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. Interaction: Insert the appropriate data type in the place marked in red. The data type depends on the ADS symbol selected in the Symbol Interface. See Data types [} 124]. 5. After initialization, the block Write Async Single Type Resolved [} 107] is called. For this purpose, first the raw data is converted from the Lab VIEW™ data type to a suitable Twin CAT 3 data type and then an asynchronous write request is sent to Twin CAT. The block does not wait for a response from the ADS server. 6. In this example the low-level block Check Write Status [} 96] is called in a While loop and waits for a response from the requested ADS server. Please note that this is an illustrative example. The implementation in actual applications may differ considerably. 7. The next step is to call the low-level block Release Writer [} 97] to release the writer from memory. 8. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. Reading data continuously The examples in this group use the polling procedure or Lab VIEW™ event-based procedures to request the data packets cyclically. Continuos Read Sync Base.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: TF3710 Version: 1.8.1 111
## Page 112

Samples 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the low-level blocks Base Init [} 91], Get List of Read Write Symbols [} 93] and Get List of Registered Targets [} 92] are called to initialize the ADS client. 3. To speed up reading and type resolving, the ADS Reader, with the call of Init Reader [} 93], and the Type Resolver, with the call of Init Type [} 97], are initialized in advance and only once in the next step. 4. In the next step the Send Reader-Request [} 93] block requests a new data packet from Twin CAT with each cycle of the loop. The received data packet is converted to a suitable Lab VIEW™ data type "Variant" using the call Resolve From TC Type [} 97]. 5. Interaction: Variant-to-Data can be used to customize the example to translate the Variant to an appropriate data type. The data type depends on the ADS symbol selected in the Symbol Interface. See Type Resolving [} 37]. 6. When the termination condition for the loop is reached, the ADS reader is released from memory with the call Release Reader [} 95] and the Type Resolver with the call Release Type [} 98]. 7. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. Read Notification-Event Single The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. When selecting, note the parameter settings of the symbols for this operation mode: E-Noti. Single [} 71]. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. A User Event is created and registered. See also the Lab VIEW™ documentation on user events. 5. When E-Noti. Single [} 71] is called, an ADS notification is registered on the ADS server for the selected ADS symbol. 6. The next step is to wait for the ADS notifications in the event structure. If no notification is received, the event structure times out. Calling the block Stop Notification [} 80] stops the ADS notification. The stop occurs at the ADS server so that no more messages are sent. 7. Interaction: Type Resolving [} 37] is not implemented in the example. Two options are available. The Resolving type is either realized within the event loop or after the ADS notification has been completed/unregistered. The following items in the event structure are relevant: Data and Time Stamps. The latter are the ADS timestamps. 8. When the block Unregister Notification [} 81] is called, the ADS notification of the symbol is unregistered at the ADS server and the handle to the ADS notification is released from memory. 9. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. Read Notification-Event Buffered.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42]. The example is identical in structure to Read Notification-Event Single [} 112]. The only differences are: • The polymorphic VI is set to E-Noti. Buffered [} 72]. • At the Data point in the event loop an array of size LVBuffer Size is always passed. 112 Version: 1.8.1 TF3710
## Page 113

Samples Read Notification-Event Multiple The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42]. The example is identical in structure to Read Notification-Event Buffered [} 112]. The only differences are: • The polymorphic VI is set to E-Noti. Multiple Symbols [} 73]. • For each ADS symbol a corresponding measurement duration Elapse Time Ms (in milliseconds) can be selected. • Reading from each ADS symbol requires corresponding Lab VIEW™ event case. Read Notification-LVBuffer Multiple The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. When selecting, observe the parameter settings of the symbols for the operation mode LVB-Noti. Multiple Symbols [} 74]. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Array Subset selects the first 3 ADS symbols in the list. 4. For each selected ADS symbol, a handle to the LVBuffer is initialized with the call to Init LVBuffer Handle [} 82]. 5. When LVB-Noti. Multiple Symbols [} 74] is called, ADS notifications are registered on the ADS server for the selected ADS symbols. For this purpose the block takes an array of ADS symbols as input. In addition, the duration of the individual notification can be entered in milliseconds. Thus, the notifications are automatically stopped after the time expires. 6. In the next step, the individual symbols are read in a while loop. Reading can be waited for a defined time (timeout) or infinitely long. 7. When the block Unregister Notification [} 81] is called, the ADS notification of the symbol is unregistered at the ADS server and the handle to the ADS notification is released from memory. 8. When the block Release LVBuffer Handle [} 82] is called, the handle to the LVBuffer is released from memory. 9. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. Read Notification-LVBuffer Single The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. When selecting, observe the parameter settings of the symbols for the operation mode LVB-Noti. Single Symbol [} 73]. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. A handle to the LVBuffer is initialized for the selected ADS symbol, with the call of Init LVBuffer Handle [} 82]. TF3710 Version: 1.8.1 113
## Page 114

Samples 5. When LVB-Noti. Single Symbol [} 73] is called, ADS notifications are registered on the ADS server for the selected ADS symbol. In addition, the block allows to enter a measurement duration in milliseconds. Thus, the notifications are automatically stopped after the time expires. 6. In the next step, the selected symbol can be read in a while loop. Reading can be waited for a defined time (timeout) or infinitely long. It is important to consider whether the ADS notifications are sent Cyclic or On Change from the server. 7. When the block Unregister Notification [} 81] is called, the ADS notification of the symbol is unregistered at the ADS server and the handle to the ADS notification is released from memory. 8. When the block Release LVBuffer Handle [} 82] is called, the handle to the LVBuffer is released from memory. 9. In the last step the Release [} 76] basic block is called and thus the ADS client is released from memory. Writing data continuously Continuos Write Sync Base.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Write Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. To speed up writing and type resolving, the ADS Writer, with the call of Init Writer [} 95], and the Type Resolver, with the call of Init Type [} 97], are initialized in advance and only once in the next step. 5. In the next step the Send Writer-Request [} 96] block sends a new data packet to Twin CAT with each cycle of the loop. Before writing, the Lab VIEW™ data type Variant is converted to a suitable Twin CAT 3 data type by calling Resolve To TC Type [} 98] block. 6. After reaching the termination condition of the loop, the ADS reader is released from memory by calling Release Writer [} 97] and the Type Resolver by calling Release Type [} 98]. 7. In the last step, the Release [} 76] basic block is called and the ADS client is released from memory. Generate Lab VIEW™ type To automatically generate a Lab VIEW™ data type to an ADS symbol, the Type Resolver [} 97] and the Generate Type [} 78] wrapper block are used. The following examples describe two different ways to implement this: • Generate Type using Symbol Interface or Symbol's file • Generate Type using Type Info file Generate Type using Symbol Interface or Symbol's file The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols and Write Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). 114 Version: 1.8.1 TF3710
## Page 115

Samples 4. In a For loop is executed: ◦ Type Resolver: With Init Type [} 97] the type description is loaded in the Type Resolver and passed to the Lab VIEW™ process as XML string (Type Info). ◦ Type Generator: Calling the Generate Type [} 78] Wrapper VI generates a Lab VIEW™ type. ◦ Release-Type: Releases the handle to the Type Resolver from memory. 5. Releases the handle to the client. Generate Type using Type Info file In contrast to Generate Type using Symbol Interface or Symbol’s file [} 114], the example uses a pre- generated Type Info file to generate a Lab VIEW™ type. Sum Up Read or Write Read Sum Up with Type Resolving.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs from the Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the Symbol Interface [} 67] basic block is called. When the example is executed, the user interface opens and the user can select an ADS symbol from his Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can also select the exported file in the Front Panel before starting the VI, so that the XML is loaded rather than calling the UI. 2. In the second step, the Init [} 68] basic block is called and the ADS client is initialized. 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first and second ADS symbols of the list. 4. After initialization of the ADS client, the Type Resolvers [} 37] are initialized with the selected symbols. 5. After that the Sum Up handle is initialized for reading with the help of Init Sum Up [} 103]. Here the flag b Autosend is set to true so that new data is read automatically. 6. The Add Request block assembles the Sum Up sub-commands. 7. After that, the example splits into two different threads: ◦ Loop 1: Reads cyclically the new data one after the other from the sub-commands. The read data is converted to corresponding Lab VIEW™ data types using the initialized Type Resolver. ◦ Loop 2: Enables or disables the automatic sending of ADS requests. 8. In the last step, all initialized handles are released from memory. NOTICE ADS error message when reading symbols with b Autosend set to false ADS error messages may occur in Loop 1 if the flag b Autosend is set to false when initializing the Sum Up handle. In this case, the block Get Data starts reading the data from the sub-commands even though they have not yet been sent to the ADS server and therefore do not contain any data. Write Sum Up with Type Resolving.vi The example, like the other examples in Basic examples [} 109], uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Symbol Interface [} 67] block is called. When the example is executed, the user interface opens and the user can select an ADS symbol from his Twin CAT runtime. ◦ If you have already exported an XML description of the ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the basic Init [} 68] block is called and the ADS client is initialized. TF3710 Version: 1.8.1 115
## Page 116

Samples 3. The Write Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example two ADS symbols of the types timestamp and string are expected. With Index Array the first and the second ADS symbol of the list are selected. 4. After initialization, the Type Resolvers [} 37] are initialized to the selected symbols. Then it is checked whether the first symbol has the timestamp data type and the second has the string data type. 5. After that the Sum Up handle is initialized for writing with the help of Init Sum Up [} 103]. Here the flag b Autosend is set to false so that the new data is not written automatically. 6. After that, the example splits into two different threads: ◦ Loop 1: Waits in an event structure for new data generated by Loop 2. The new data is distributed to the appropriate sub-commands and waited to be sent. Before that the raw data is transformed into a Twin CAT 3 data type. If the sub-command already contains data, these are replaced by the new data. In the event structure, automatic sending can be enabled or disabled. ◦ Loop 2: Generates the block diagram events in a cycle of 250 ms. 7. In the last step, all initialized handles are released from memory. Co E Read or Write The example, like the other examples in this chapter, uses the basic VIs and the low-level VIs from Lab VIEW™ VIs [} 42] in the following steps: 1. In the first step, the basic Init [} 68] block is called up with an empty character string and the ADS client is initialized. 2. The Co E blocks [} 83] expect the AMS address as a string of the Ether CAT device from which the Co E configuration is to be read. The Device Address control element expects a character string with the following format: AMS Net-Id of the master and AMS Port of the device (AMS Net Id:Port). If the control element is left empty, the example opens a dialog box for selecting an Ether CAT device. 1. The example reads the Co E list from the Ether CAT device. 2. Interaction: ◦ Double-click on an object in the Co E list to select it and read the object description. This calls up the low-level VI. ◦ An entry with a subindex can be read using the Check Entry button. ◦ In the next step, various Co E entries can be read or written. 3. In the last step, the client handle is released from the memory. Heartbeat Connection Monitoring Continuous Read with Heartbeat.vi The example is based on the "Continuous Read Sync Base" example and extends it to include Heartbeat connection monitoring. The example, like the other examples, uses the basic VIs and the low-level VIs in the following steps: 1. In the first step the basic Symbol Interface block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the ADS client is initialized using Init. 3. Connection monitoring is then initialized using Init Heartbeat [} 86]. The parameters for connection monitoring are already defined here. Changing the parameters at runtime is not possible. The Init Heartbeat returns a Heartbeat event, which is used to query the status of the connection. 4. To speed up reading and type resolving, the ADS Reader, with the call of Read, and the Type Resolver, with the call of Init Type [} 97], are initialized in advance and only once in the next step. 5. In the next step, the While loop and the Run Heartbeat [} 87] block are executed in parallel. The Run Heartbeat block carries out connection monitoring and runs until the Stop Heartbeat block is called. Continuous reading and the reaction to Heartbeat events take place in the while loop. 116 Version: 1.8.1 TF3710
## Page 117

Samples 6. There is an event structure in the While loop. This waits for the duration defined by the user in "Polling time read in ms" for an event to occur. If no Heartbeat event occurs, the timeout case of the event structure is executed. 7. If the event structure times out, a read operation is carried out. In the event of an error, connection monitoring is aborted by calling the Stop Heartbeat [} 87] (timeout errors from the ADS read are ignored, as Heartbeat connection monitoring). 8. Interaction: Variant-to-Data can be used to customize the example to translate the Variant to an appropriate data type. The data type depends on the ADS symbol selected in the Symbol Interface. See Type Resolving. 9. If a Heartbeat event occurs, the Event data (Target address, Connection state, Heartbeat handle and Timestamp) is used to display the status of the connection in the front panel of the example VI. 10. Interaction: In the Heartbeat event case of the event structure, code can be implemented which is to be executed in the event of a change in the connection state. For example, it could be implemented here that a warning is issued to the user in the event of a timeout. 11. Once the termination condition of the loop has been reached, the ADS reader is released from the memory with the Read call, the Heartbeat connection monitoring with the Release Heartbeat [} 87] call and the Type Resolver with the Release Type [} 98] call. 12. In the last step the basic Release block is called to release the ADS client from memory. Continuous Write with Heartbeat.vi The example is based on the "Continuous Write Sync Base" example and extends this with Heartbeat connection monitoring. A minimum configuration for connection monitoring is shown here using the Heartbeat Wrapper VI. The process is carried out in the following steps: 1. In the first step the basic Symbol Interface block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the basic Init block is called and the ADS client is initialized. 3. The Write Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. To speed up writing and type resolving, the ADS Writer, with the call of Write, and the Type Resolver, with the call of Init Type [} 97], are initialized in advance and only once in the next step. 5. In the next step, connection monitoring is started using the Heartbeat Wrapper VI [} 88] and called up until either a connection interruption is detected or the value of the "boolean Controls Stop Heartbeat" is set to True. 6. At the same time, continuous writing takes place in the While loop. In the next step, the Write block sends a new data packet to Twin CAT with each cycle of the loop. Before writing, the Lab VIEW™ data type Variant, with the call to Type Resolver block, is converted to a suitable Twin CAT 3 data type. 7. Once the termination condition of the loop has been reached, the ADS reader is released from memory by calling Write, the Heartbeat connection monitoring is released via the Heartbeat Wrapper VI and the Type Resolver is released by calling Release Type [} 98]. 8. In the last step the basic Release block is called and the ADS client is released from memory. Read Notification-Event Single with Heartbeat.vi The example is based on the "Read Notification-Event Single" example and extends it to include Heartbeat connection monitoring. The example, like the other examples, uses the basic VIs and the low-level VIs in the following steps: 1. In the first step the basic Symbol Interface block is called. When the example is executed, the user interface opens and the user can select an ADS symbol in the Twin CAT runtime. When selecting, note the parameter settings of the symbols for this operation mode: ADS-Read. ◦ If you have already exported an XML description of your ADS symbols from the Symbol Interface, you can select it as a path so that the XML is loaded rather than calling the UI. 2. In the second step, the basic Init block is called and the ADS client is initialized. TF3710 Version: 1.8.1 117
## Page 118

Samples 3. The Read Grp Symbols output may contain more than one ADS symbol (if you selected more than one symbol in step 1). In the example, Index Array selects the first ADS symbol in the list. 4. Connection monitoring is then initialized using Init Heartbeat [} 86]. The parameters for connection monitoring are already defined here. Changing the parameters at runtime is not possible. The Init Heartbeat returns a Heartbeat event, which is used to query the status of the connection. 5. A user event is created for the notifications and then registered together with the Heartbeat event. 6. Calling ADS-Read registers an ADS notification at the ADS server for the selected ADS symbol. At the same time, connection monitoring is started with the Run Heartbeat [} 87] block. 7. The next step is to wait for the ADS notifications or a Heartbeat event in the event structure. If no event occurs, the event structure enters a timeout. If data arrives, a notification event is triggered and the received data is displayed in the front panel. If the connection status changes (Heartbeat event), the status of the connection is displayed. In addition, the notifications are stopped when an interruption is detected and restarted when the connection is re-established. 8. Interaction: Type Resolving is not implemented in the example. There are two ways: The Resolving type is either realized within the event loop or after the ADS notification has been completed/ unregistered. The points of contact in the event structure are Data and Time Stamps. The latter are the ADS timestamps. 9. When the Unregister Notification [} 81] block is called, the ADS notification of the symbol is unregistered at the ADS server and the handle to the ADS notification is released from memory. 10. In the last step, the Heartbeat connection monitoring is released from the memory with the Release Heartbeat [} 87] call and the ADS client with the basic Release block call. Read QMH with Heartbeat.vi The example is based on the example "Read Notifications using QMH" and extends it to include Heartbeat connection monitoring. It shows the integration of the Heartbeat low-level VIs into a more complex Lab VIEW™ project. In the example, the user can select any number of symbols to read. Either an xml file with the symbols is specified before the VI is started or the symbols are selected in the symbol interface when the VI is started. The symbols are then displayed in a list. Double-click on an icon to select it for reading. The "Read Noti Sgl." and "Read Noti Buff." buttons can be used to select between the continuous, event-controlled read modes Read Notification Single [} 33] and Read Notifications Buffered [} 35]. The corresponding Sub VI then opens and the data is read accordingly. Connection monitoring is initialized in "Initialize.vi". The Heartbeat event received during initialization is registered when the "Register List Events.vi" block is called and evaluated in the "Producer Loop". 8.2 Application example The Twin CAT Solution and the corresponding VI (for x86 and x64 Lab VIEW™ bit version) can be downloaded here: https://infosys.beckhoff.com/content/1033/TF3710_TC3_Interface_for_Lab VIEW/Resources/ 10083995531.zip. The VIs are currently compiled with Lab VIEW™ 2017 and can be used for subsequent Lab VIEW™ versions (2018, 2019, 2020, 2021, 2022, 2023, 2024, 2025) as well. Description of the example Twin CAT: The Twin CAT project generates signals in the PLC via signal generator function blocks (sine, amplitude modulated signal, triangle signal, ....). The PLC runs with a cycle time of 5 ms. The signal generator generates 10 values per cycle for the generated signals. Accordingly, an oversampling of 10 is simulated here with the Beckhoff measurement terminals. Lab VIEW™: The Lab VIEW™ project uses the Read Notification-Event Buffered [} 112] example to read the ADS notifications as Lab VIEW™ events. Two while loops are used in parallel. 1. The first while loop receives the ADS notifications and converts the raw ADS data to an appropriate Lab VIEW™ data type "Variant" using the Type Resolver. The converted raw data is then inserted into a queue. 118 Version: 1.8.1 TF3710
## Page 119

Samples 2. The second while loop reads the elements from the queue and uses the "Variant to Data" block to finally display the data in a graph. The received data and the ADS timestamps are displayed in two different graphs. Opening and starting the example The example contains a Twin CAT 3 folder and a Lab VIEW™ folder. In the Twin CAT 3 folder there is a tnzip, which you can open with Twin CAT 3 via File > Open > Open Solution From Archive and then save as Twin CAT Solution on your PC. You can start the Twin CAT Solution with activate configuration on the target system of your choice. Make sure that a TF3710 license is available on your target system. If you do not have a valid license, you can create a 7-day trial license. If your Twin CAT runtime is active, you can display the generated signals in Twin CAT with the Twin CAT 3 Scope. Depending on the selected target system, you only have to select your target system in the properties under TC Signals > Data Pool > a AM (a Noise_1, a Noise_2, a Sine). In the Lab VIEW folder select either 32bit (x86) or 64bit (x64) and open the VI contained in it. When you start the program the interface icon opens. Navigate to your target system and select one of the signals. TF3710 Version: 1.8.1 119
## Page 120

Appendix 9 Appendix 9.1 Overview of error codes Error checking in the TF3710 Twin CAT 3 interface for Lab VIEW™ product follows the standard Lab VIEW™ data flow model. During the execution of Lab VIEW™ VIs [} 42], error checking takes place at each executed node. The blocks only continue if no errors occur. If an error occurs in a block, it is passed to the next block and the affected part of the function or the block is no longer executed accordingly. The Lab VIEW™ error clusters are used for error checking, which then forwards the following information accordingly: • Status: a Boolean value that returns TRUE if an error occurred. • Error code: an error identifier in the form of a signed 32-bit integer. If the error code is not 0 and the status output is FALSE, it is a warning rather than an error. • Source: specifies the source of the error in the form of a Lab VIEW™ string. The description of the error code can be found in Lab VIEW™ Menu > Help > Describe Error. To avoid collision with existing Lab VIEW™ errors, all error codes are described in user-defined error codes. The following error codes may occur when running Lab VIEW™ VIs [} 42]. error value See… 16#FFFF_DE04 - 16#FFFF_DCD9 Listed in ADS Return Codes [} 121] (there without high-order WORD). Further information below on this page. 16#0000_1414 - 16#0000_1432 Listed in Support Return Codes [} 130]. 16#0000_1464 - 16#0000_157C Listed in Runtime Return Codes [} 126]. 16#FFFF_E05C – 16x FFFF_DFF9 120 Version: 1.8.1 TF3710
## Page 121

Appendix If an error occurs during initialization, the function block cannot be used. Further information on standard Twin CAT Error Codes: error value symbol Error description Remedy option 16#FFFF_DDFA NOMEMORY No memory Incorrect memory settings => Increase router memory. 16#FFFF_DDEB TIMEOUT Device has a timeout A timeout can occur while waiting for feedback or sending a request. This can often be the case if the network is overloaded. With One-time reading [} 28] or One-time writing [} 30] the timeout is not so critical, because here the data packet is read or written in one pass. 9.2 ADS Return Codes Grouping of error codes: Global error codes: 0x0000 [} 121]... (0x9811_0000 ...) Router error codes: 0x500 [} 122]... (0x9811_0500 ...) General ADS errors: 0x700 [} 122]... (0x9811_0700 ...) RTime error codes: 0x1000 [} 123]... (0x9811_1000 ...) Global error codes Hex Dec HRESULT Name Description 0x0 0 0x98110000 ERR_NOERROR No error. 0x1 1 0x98110001 ERR_INTERNAL Internal error. 0x2 2 0x98110002 ERR_NORTIME No real time. 0x3 3 0x98110003 ERR_ALLOCLOCKEDMEM Allocation locked – memory error. 0x4 4 0x98110004 ERR_INSERTMAILBOX Mailbox full – the ADS message could not be sent. Reducing the number of ADS messages per cycle will help. 0x5 5 0x98110005 ERR_WRONGRECEIVEHMSG Wrong HMSG. 0x6 6 0x98110006 ERR_TARGETPORTNOTFOUND Target port not found – ADS server is not started, not reachable or not installed. 0x7 7 0x98110007 ERR_TARGETMACHINENOTFOUND Target computer not found – AMS route was not found. 0x8 8 0x98110008 ERR_UNKNOWNCMDID Unknown command ID. 0x9 9 0x98110009 ERR_BADTASKID Invalid task ID. 0x A 10 0x9811000A ERR_NOIO No IO. 0x B 11 0x9811000B ERR_UNKNOWNAMSCMD Unknown AMS command. 0x C 12 0x9811000C ERR_WIN32ERROR Win32 error. 0x D 13 0x9811000D ERR_PORTNOTCONNECTED Port not connected. 0x E 14 0x9811000E ERR_INVALIDAMSLENGTH Invalid AMS length. 0x F 15 0x9811000F ERR_INVALIDAMSNETID Invalid AMS Net ID. 0x10 16 0x98110010 ERR_LOWINSTLEVEL Installation level is too low –Twin CAT 2 license error. 0x11 17 0x98110011 ERR_NODEBUGINTAVAILABLE No debugging available. 0x12 18 0x98110012 ERR_PORTDISABLED Port disabled – Twin CAT system service not started. 0x13 19 0x98110013 ERR_PORTALREADYCONNECTED Port already connected. 0x14 20 0x98110014 ERR_AMSSYNC_W32ERROR AMS Sync Win32 error. 0x15 21 0x98110015 ERR_AMSSYNC_TIMEOUT AMS Sync Timeout. 0x16 22 0x98110016 ERR_AMSSYNC_AMSERROR AMS Sync error. 0x17 23 0x98110017 ERR_AMSSYNC_NOINDEXINMAP No index map for AMS Sync available. 0x18 24 0x98110018 ERR_INVALIDAMSPORT Invalid AMS port. 0x19 25 0x98110019 ERR_NOMEMORY No memory. 0x1A 26 0x9811001A ERR_TCPSEND TCP send error. TF3710 Version: 1.8.1 121
## Page 122

Appendix Hex Dec HRESULT Name Description 0x1B 27 0x9811001B ERR_HOSTUNREACHABLE Host unreachable. 0x1C 28 0x9811001C ERR_INVALIDAMSFRAGMENT Invalid AMS fragment. 0x1D 29 0x9811001D ERR_TLSSEND TLS send error – secure ADS connection failed. 0x1E 30 0x9811001E ERR_ACCESSDENIED Access denied – secure ADS access denied. Router error codes Hex Dec HRESULT Name Description 0x500 1280 0x98110500 ROUTERERR_NOLOCKEDMEMORY Locked memory cannot be allocated. 0x501 1281 0x98110501 ROUTERERR_RESIZEMEMORY The router memory size could not be changed. 0x502 1282 0x98110502 ROUTERERR_MAILBOXFULL The mailbox has reached the maximum number of possible messages. 0x503 1283 0x98110503 ROUTERERR_DEBUGBOXFULL The Debug mailbox has reached the maximum number of possible messages. 0x504 1284 0x98110504 ROUTERERR_UNKNOWNPORTTYPE The port type is unknown. 0x505 1285 0x98110505 ROUTERERR_NOTINITIALIZED The router is not initialized. 0x506 1286 0x98110506 ROUTERERR_PORTALREADYINUSE The port number is already assigned. 0x507 1287 0x98110507 ROUTERERR_NOTREGISTERED The port is not registered. 0x508 1288 0x98110508 ROUTERERR_NOMOREQUEUES The maximum number of ports has been reached. 0x509 1289 0x98110509 ROUTERERR_INVALIDPORT The port is invalid. 0x50A 1290 0x9811050A ROUTERERR_NOTACTIVATED The router is not active. 0x50B 1291 0x9811050B ROUTERERR_FRAGMENTBOXFULL The mailbox has reached the maximum number for fragmented messages. 0x50C 1292 0x9811050C ROUTERERR_FRAGMENTTIMEOUT A fragment timeout has occurred. 0x50D 1293 0x9811050D ROUTERERR_TOBEREMOVED The port is removed. General ADS error codes Hex Dec HRESULT Name Description 0x700 1792 0x98110700 ADSERR_DEVICE_ERROR General device error. 0x701 1793 0x98110701 ADSERR_DEVICE_SRVNOTSUPP Service is not supported by the server. 0x702 1794 0x98110702 ADSERR_DEVICE_INVALIDGRP Invalid index group. 0x703 1795 0x98110703 ADSERR_DEVICE_INVALIDOFFSET Invalid index offset. 0x704 1796 0x98110704 ADSERR_DEVICE_INVALIDACCESS Reading or writing not permitted. Several causes are possible. For example, an incorrect password was entered when creating routes. 0x705 1797 0x98110705 ADSERR_DEVICE_INVALIDSIZE Parameter size not correct. 0x706 1798 0x98110706 ADSERR_DEVICE_INVALIDDATA Invalid data values. 0x707 1799 0x98110707 ADSERR_DEVICE_NOTREADY Device is not ready to operate. 0x708 1800 0x98110708 ADSERR_DEVICE_BUSY Device is busy. 0x709 1801 0x98110709 ADSERR_DEVICE_INVALIDCONTEXT Invalid operating system context. This can result from use of ADS blocks in different tasks. It may be possible to resolve this through multitasking synchronization in the PLC. 0x70A 1802 0x9811070A ADSERR_DEVICE_NOMEMORY Insufficient memory. 0x70B 1803 0x9811070B ADSERR_DEVICE_INVALIDPARM Invalid parameter values. 0x70C 1804 0x9811070C ADSERR_DEVICE_NOTFOUND Not found (files, ...). 0x70D 1805 0x9811070D ADSERR_DEVICE_SYNTAX Syntax error in file or command. 0x70E 1806 0x9811070E ADSERR_DEVICE_INCOMPATIBLE Objects do not match. 0x70F 1807 0x9811070F ADSERR_DEVICE_EXISTS Object already exists. 0x710 1808 0x98110710 ADSERR_DEVICE_SYMBOLNOTFOUND Symbol not found. 0x711 1809 0x98110711 ADSERR_DEVICE_SYMBOLVERSIONINVALID Invalid symbol version. This can occur due to an online change. Create a new handle. 0x712 1810 0x98110712 ADSERR_DEVICE_INVALIDSTATE Device (server) is in invalid state. 0x713 1811 0x98110713 ADSERR_DEVICE_TRANSMODENOTSUPP Ads Trans Mode not supported. 0x714 1812 0x98110714 ADSERR_DEVICE_NOTIFYHNDINVALID Notification handle is invalid. 0x715 1813 0x98110715 ADSERR_DEVICE_CLIENTUNKNOWN Notification client not registered. 0x716 1814 0x98110716 ADSERR_DEVICE_NOMOREHDLS No further handle available. 122 Version: 1.8.1 TF3710
## Page 123

Appendix Hex Dec HRESULT Name Description 0x717 1815 0x98110717 ADSERR_DEVICE_INVALIDWATCHSIZE Notification size too large. 0x718 1816 0x98110718 ADSERR_DEVICE_NOTINIT Device not initialized. 0x719 1817 0x98110719 ADSERR_DEVICE_TIMEOUT Device has a timeout. 0x71A 1818 0x9811071A ADSERR_DEVICE_NOINTERFACE Interface query failed. 0x71B 1819 0x9811071B ADSERR_DEVICE_INVALIDINTERFACE Wrong interface requested. 0x71C 1820 0x9811071C ADSERR_DEVICE_INVALIDCLSID Class ID is invalid. 0x71D 1821 0x9811071D ADSERR_DEVICE_INVALIDOBJID Object ID is invalid. 0x71E 1822 0x9811071E ADSERR_DEVICE_PENDING Request pending. 0x71F 1823 0x9811071F ADSERR_DEVICE_ABORTED Request is aborted. 0x720 1824 0x98110720 ADSERR_DEVICE_WARNING Signal warning. 0x721 1825 0x98110721 ADSERR_DEVICE_INVALIDARRAYIDX Invalid array index. 0x722 1826 0x98110722 ADSERR_DEVICE_SYMBOLNOTACTIVE Symbol not active. 0x723 1827 0x98110723 ADSERR_DEVICE_ACCESSDENIED Access denied. Several causes are possible. For example, a unidirectional ADS route is used in the opposite direction. 0x724 1828 0x98110724 ADSERR_DEVICE_LICENSENOTFOUND Missing license. 0x725 1829 0x98110725 ADSERR_DEVICE_LICENSEEXPIRED License expired. 0x726 1830 0x98110726 ADSERR_DEVICE_LICENSEEXCEEDED License exceeded. 0x727 1831 0x98110727 ADSERR_DEVICE_LICENSEINVALID Invalid license. 0x728 1832 0x98110728 ADSERR_DEVICE_LICENSESYSTEMID License problem: System ID is invalid. 0x729 1833 0x98110729 ADSERR_DEVICE_LICENSENOTIMELIMIT License not limited in time. 0x72A 1834 0x9811072A ADSERR_DEVICE_LICENSEFUTUREISSUE Licensing problem: time in the future. 0x72B 1835 0x9811072B ADSERR_DEVICE_LICENSETIMETOLONG License period too long. 0x72C 1836 0x9811072C ADSERR_DEVICE_EXCEPTION Exception at system startup. 0x72D 1837 0x9811072D ADSERR_DEVICE_LICENSEDUPLICATED License file read twice. 0x72E 1838 0x9811072E ADSERR_DEVICE_SIGNATUREINVALID Invalid signature. 0x72F 1839 0x9811072F ADSERR_DEVICE_CERTIFICATEINVALID Invalid certificate. 0x730 1840 0x98110730 ADSERR_DEVICE_LICENSEOEMNOTFOUND Public key not known from OEM. 0x731 1841 0x98110731 ADSERR_DEVICE_LICENSERESTRICTED License not valid for this system ID. 0x732 1842 0x98110732 ADSERR_DEVICE_LICENSEDEMODENIED Demo license prohibited. 0x733 1843 0x98110733 ADSERR_DEVICE_INVALIDFNCID Invalid function ID. 0x734 1844 0x98110734 ADSERR_DEVICE_OUTOFRANGE Outside the valid range. 0x735 1845 0x98110735 ADSERR_DEVICE_INVALIDALIGNMENT Invalid alignment. 0x736 1846 0x98110736 ADSERR_DEVICE_LICENSEPLATFORM Invalid platform level. 0x737 1847 0x98110737 ADSERR_DEVICE_FORWARD_PL Context – forward to passive level. 0x738 1848 0x98110738 ADSERR_DEVICE_FORWARD_DL Context – forward to dispatch level. 0x739 1849 0x98110739 ADSERR_DEVICE_FORWARD_RT Context – forward to real-time. 0x740 1856 0x98110740 ADSERR_CLIENT_ERROR Client error. 0x741 1857 0x98110741 ADSERR_CLIENT_INVALIDPARM Service contains an invalid parameter. 0x742 1858 0x98110742 ADSERR_CLIENT_LISTEMPTY Polling list is empty. 0x743 1859 0x98110743 ADSERR_CLIENT_VARUSED Var connection already in use. 0x744 1860 0x98110744 ADSERR_CLIENT_DUPLINVOKEID The called ID is already in use. 0x745 1861 0x98110745 ADSERR_CLIENT_SYNCTIMEOUT Timeout has occurred – the remote terminal is not responding in the specified ADS timeout. The route setting of the remote terminal may be configured incorrectly. 0x746 1862 0x98110746 ADSERR_CLIENT_W32ERROR Error in Win32 subsystem. 0x747 1863 0x98110747 ADSERR_CLIENT_TIMEOUTINVALID Invalid client timeout value. 0x748 1864 0x98110748 ADSERR_CLIENT_PORTNOTOPEN Port not open. 0x749 1865 0x98110749 ADSERR_CLIENT_NOAMSADDR No AMS address. 0x750 1872 0x98110750 ADSERR_CLIENT_SYNCINTERNAL Internal error in Ads sync. 0x751 1873 0x98110751 ADSERR_CLIENT_ADDHASH Hash table overflow. 0x752 1874 0x98110752 ADSERR_CLIENT_REMOVEHASH Key not found in the table. 0x753 1875 0x98110753 ADSERR_CLIENT_NOMORESYM No symbols in the cache. 0x754 1876 0x98110754 ADSERR_CLIENT_SYNCRESINVALID Invalid response received. 0x755 1877 0x98110755 ADSERR_CLIENT_SYNCPORTLOCKED Sync Port is locked. 0x756 1878 0x98110756 ADSERR_CLIENT_REQUESTCANCELLED The request was canceled. RTime error codes TF3710 Version: 1.8.1 123
## Page 124

Appendix Hex Dec HRESULT Name Description 0x1000 4096 0x98111000 RTERR_INTERNAL Internal error in the real-time system. 0x1001 4097 0x98111001 RTERR_BADTIMERPERIODS Timer value is not valid. 0x1002 4098 0x98111002 RTERR_INVALIDTASKPTR Task pointer has the invalid value 0 (zero). 0x1003 4099 0x98111003 RTERR_INVALIDSTACKPTR Stack pointer has the invalid value 0 (zero). 0x1004 4100 0x98111004 RTERR_PRIOEXISTS The request task priority is already assigned. 0x1005 4101 0x98111005 RTERR_NOMORETCB No free TCB (Task Control Block) available. The maximum number of TCBs is 64. 0x1006 4102 0x98111006 RTERR_NOMORESEMAS No free semaphores available. The maximum number of semaphores is 64. 0x1007 4103 0x98111007 RTERR_NOMOREQUEUES No free space available in the queue. The maximum number of positions in the queue is 64. 0x100D 4109 0x9811100D RTERR_EXTIRQALREADYDEF An external synchronization interrupt is already applied. 0x100E 4110 0x9811100E RTERR_EXTIRQNOTDEF No external sync interrupt applied. 0x100F 4111 0x9811100F RTERR_EXTIRQINSTALLFAILED Application of the external synchronization interrupt has failed. 0x1010 4112 0x98111010 RTERR_IRQLNOTLESSOREQUAL Call of a service function in the wrong context 0x1017 4119 0x98111017 RTERR_VMXNOTSUPPORTED Intel® VT-x extension is not supported. 0x1018 4120 0x98111018 RTERR_VMXDISABLED Intel® VT-x extension is not enabled in the BIOS. 0x1019 4121 0x98111019 RTERR_VMXCONTROLSMISSING Missing function in Intel® VT-x extension. 0x101A 4122 0x9811101A RTERR_VMXENABLEFAILS Activation of Intel® VT-x fails. Specific positive HRESULT Return Codes: HRESULT Name Description 0x0000_0000 S_OK No error. 0x0000_0001 S_FALSE No error. Example: successful processing, but with a negative or incomplete result. 0x0000_0203 S_PENDING No error. Example: successful processing, but no result is available yet. 0x0000_0256 S_WATCHDOG_TIMEOUT No error. Example: successful processing, but a timeout occurred. TCP Winsock error codes Hex Dec Name Description 0x274C 10060 WSAETIMEDOUT A connection timeout has occurred - error while establishing the connection, because the remote terminal did not respond properly after a certain period of time, or the established connection could not be maintained because the connected host did not respond. 0x274D 10061 WSAECONNREFUSED Connection refused - no connection could be established because the target computer has explicitly rejected it. This error usually results from an attempt to connect to a service that is inactive on the external host, that is, a service for which no server application is running. 0x2751 10065 WSAEHOSTUNREACH No route to host - a socket operation referred to an unavailable host. More Winsock error codes: Win32 error codes 9.3 Data types Twin CAT data type Memory requirement Lab VIEW™ data type BIT 1 bit Lab VIEW™ Boolean BOOL 8 bits Lab VIEW™ Boolean BYTE/USINT 8 bits Lab VIEW™ U8 WORD/UINT 16 bits Lab VIEW™ U16 DWORD/UDINT 32 bits Lab VIEW™ U32 ULINT 64 bits Lab VIEW™ U64 SINT 8 bits Lab VIEW™ I8 INT 16 bits Lab VIEW™ I16 DINT 32 bits Lab VIEW™ I32 124 Version: 1.8.1 TF3710
## Page 125

Appendix Twin CAT data type Memory requirement Lab VIEW™ data type LINT 64 bits Lab VIEW™ I64 REAL 32 bits Lab VIEW™ Single (sgl) LREAL 64 bits Lab VIEW™ Double (dbl) String - Lab VIEW™ String TIME - Lab VIEW™ Timestamp DATE - Lab VIEW™ Timestamp TOD/ TIME_OF_DAY - Lab VIEW™ Timestamp DT/DATE_AND_TIME - Lab VIEW™ Timestamp DCTIME - Lab VIEW™ Timestamp FILETIME - Lab VIEW™ Timestamp LTIME - Lab VIEW™ Timestamp ARRAY - Lab VIEW™ ARRAY STRUCT - Lab VIEW™ Cluster Enum 16 bits (Default) Lab VIEW™ Enum Display of timestamps in UTC time format Twin CAT and Lab VIEW™ generally measure time in Coordinated Universal Time (UTC). As soon as a timestamp is displayed in the Lab VIEW™ front panels, it is converted to the local time by default. ü If you want to display the Coordinated Universal Time (UTC) instead of the local time, you can format it as follows via the control settings: 1. Open Time Stamp Properties. 2. Open the Display Format tab. 3. Activate Advanced editing mode. 4. To use the UTC time format, insert a ^ in the default format string before the time container. ð The format string then looks like this, for example: %^<%X %x>T TF3710 Version: 1.8.1 125
## Page 126

Appendix 9.4 Runtime Return Codes Errors that occur during: initialization of the ADS client; establishing the connection; sending requests or receiving data packets; converting the Lab VIEW™ data type to Twin CAT 3 data type or vice versa are described as runtime errors. error value symbol Error description Remedy option 16#00001464 5220 TF3710_ERR_E_POINTER Invalid pointer 0 (null) 16#00001465 5221 TF3710_ERR_E_OUT_OF_ The value is not in the range. RANGE 16#00001466 5222 TF3710_ERR_E_INVALID_ The parameters are invalid. ARG 16#00001467 5223 TF3710_ERR_E_OUT_OF_ The memory is full. MEMORY 16#00001468 5224 TF3710_ERR_E_NOT_A_N Is not a number UMBER 16#00001469 5225 TF3710_ERR_E_BAD_ALL Wrong allocation OCATION 16#0000146A 5226 TF3710_ERR_E_NOT_A_S Is not a string TRING 16#0000146B 5227 TF3710_ERR_E_UNINITIA Timestamp is not initialized. LIZED_TIMESTAMP 16#0000146D 5229 TF3710_ERR_E_CONFIGU The configuration was not found. RATION_NON_EXISTENT 16#0000146E 5230 TF3710_ERR_E_FLOATIN Floating/Non-saved object (VI, G_OBJECT Project, ...) 126 Version: 1.8.1 TF3710
## Page 127

Appendix error value symbol Error description Remedy option 16#0000146F 5231 TF3710_ERR_E_INVALID_ The configuration is incorrect. CONFIGURATION 16#0000146C 5228 TF3710_ERR_E_LOCKFAI Lock has failed. LED 16#00001479 5241 TF3710_ERR_FAILED_WAI Waiting for the request has failed. T_ON_A_REQUEST 16#00001483 5251 TF3710_ERR_INVALID_PO Invalid ADS port type RT_GROUP 16#00001484 5252 TF3710_ERR_NEW_NODE The new node has failed _FAILED 16#00001485 5253 TF3710_ERR_APPEND_B Writing to the node has failed UFFER_FAILED 16#00001486 5254 TF3710_ERR_MISSING_N Node missing ODE 16#00001487 5255 TF3710_ERR_PARSE_ER Parsing has failed ROR 16#0000148D 5261 TF3710_ERR_PORT_ALRE ADS port is still present. ADY_EXIST 16#0000148E 5262 TF3710_ERR_PORT_OPE Opening the ADS port has failed. N_FAILED 16#0000148F 5263 TF3710_ERR_INVALID_TA Ams Net ID of the target system is RGET_ID invalid. 16#00001490 5264 TF3710_ERR_UNDEFINED ADS port of the target system is invalid. _TARGET_PORT 16#00001491 5265 TF3710_ERR_CONNECTI Failed to connect to the router. ON_FAILED 16#00001492 5266 TF3710_ERR_NO_PORT_ Port is not opened. OPENED 16#00001493 5267 TF3710_ERR_DISCONNE Disconnect from router has failed. CT_FAILED 16#00001494 5268 TF3710_ERR_READ_STAT Read state request has failed. E_REQUEST_FAILED 16#00001495 5269 TF3710_ERR_VARHANDL Loading Var handler has failed. E_FAILED 16#00001496 5270 TF3710_ERR_VARHANDL Var handler already exists. E_ALREADY_EXIST 16#00001497 5271 TF3710_ERR_VARHANDL Releasing Var handler has failed. E_RELEASE_FAILED 16#00001498 5272 TF3710_ERR_VARHANDL Var handler has already been released. E_ALREADY_RELEASED 16#00001499 5273 TF3710_ERR_INVALID_VA Var handler is invalid. R_HANDLER 16#0000149A 5274 TF3710_ERR_MISSING_R ADS route is not available. OUTE 16#0000149B 5275 TF3710_ERR_CONNECTI The connection is already established. ON_ALREADY_EXISTS 16#000014A6 5286 TF3710_ERR_EMPTY_SY Currently no symbols available in table. MBOL_TABLE 16#000014A7 5287 TF3710_ERR_MISSING_T Target systems are missing ARGETS 16#000014A8 5288 TF3710_ERR_TYPESYSTE The Type System provider has failed. M_PROVIDER_FAILED 16#000014A9 5289 TF3710_ERR_TYPERESO The Type Resolver Proxy has failed. LVERPROXY_FAILED TF3710 Version: 1.8.1 127
## Page 128

Appendix error value symbol Error description Remedy option 16#000014AA 5290 TF3710_ERR_TYPERESO Loading of TC-GUID has failed. LVERPROXY_LOAD_GUID _FAILED 16#000014AB 5291 TF3710_ERR_TYPERESO Loading of Type Collection has failed. LVERPROXY_LOAD_TYPE _COLLECTION_FAILED 16#000014AC 5292 TF3710_ERR_TYPERESO GUID is invalid. LVERPROXY_SYMBOL_G UID_ERROR 16#000014AD 5293 TF3710_ERR_LVTYPEDES Number of elements in the CRIPTOR_INVALID_ELEM Type Resolver do not match. ENT_RANGE 16#000014AE 5294 TF3710_ERR_LVTYPEDES Data type is currently not supported. CRIPTOR_TYPE_NOT_SU PPORTED 16#000014AF 5295 TF3710_ERR_LVTYPEDES Elements are missing in the array data CRIPTOR_INVALID_ARRA type. Y_SYMBOLINFO 16#000014B0 5296 TF3710_ERR_LVTYPEDES Symbol info for array data type is CRIPTOR_MISSING_ARRA invalid. Y_SYMBOLINFO_ELEMEN TS 16#000014B1 5297 TF3710_ERR_LVTYPEDES Array data type has no base type. CRIPTOR_MISSING_ARRA Y_BASE_TYPE 16#000014B2 5298 TF3710_ERR_LVTYPEDES Loading of Type Resolver has failed CRIPTOR_LOAD_FAILDED 16#000014B3 5299 TF3710_ERR_LVTYPEDES The primary data type is invalid. CRIPTOR_INVALID_PRIM ARY_TYPE 16#000014B4 5300 TF3710_ERR_LVTYPEDES Type Resolver is not initialized. CRIPTOR_TYPE_UNINITIA LIZED 16#000014C4 5316 TF3710_ERR_LVTYPEDES Symbol info for cluster data type is CRIPTOR_INVALID_CLUS invalid. TER_SYMBOLINFO 16#000014C5 5317 TF3710_ERR_LVTYPEDES Data type is not of the Lab VIEW™ CRIPTOR_NON_CLUSTER cluster data type. _TYPE 16#000014C6 5318 TF3710_ERR_LVTYPEDES Elements are missing in the cluster data CRIPTOR_INVALID_CLUS type. TER_SYMBOLPOSITION 16#000014D4 5331 TF3710_ERR_LVTYPEDES Invalid TC timestamp value CRIPTOR_INVALID_TIMES TAMP_VALUE 16#000014D5 5332 TF3710_ERR_LVTYPEDES This TC timestamp data type is CRIPTOR_UNSUPORTED_ currently not supported. TIMESTAMP 16#000014D9 5337 TF3710_ERR_LVTYPEDES Data types are not identical. CRIPTOR_TYPE_SIZE_MI SMATCH 16#000014DA 5338 TF3710_ERR_LVTYPEDES Data types are not identical. CRIPTOR_TYPE_MISMAT CH 128 Version: 1.8.1 TF3710
## Page 129

Appendix error value symbol Error description Remedy option 16#000014DB 5339 TF3710_ERR_LVTYPEDES Data type content does not match. CRIPTOR_DATA_SIZE_MI SMATCH 16#00001504 5380 TF3710_ERR_TYPEGENE Type Generator cannot find the RATOR_SUBTYPE_NOT_F Sub Type or the Base Type. OUND 16#00001519 5401 TF3710_ERR_READ_REQ Read request has failed UEST_FAILED 16#0000151A 5402 TF3710_ERR_INVALID_RE ADS raw data incorrectly packed AD_BUFFER 16#0000151B 5403 TF3710_ERR_INVALID_RE ADS raw data invalid AD_DATA_FORMAT 16#0000151C 5404 TF3710_ERR_NOTIFICATI Notification handler has failed. ON_HANDLER_FAILED 16#0000151D 5405 TF3710_ERR_ATLEAST_O At least one/several notifications is/are NE_MISSED_NOTIFICATI not received correctly ON 16#0000151E 5406 TF3710_ERR_NOTIFICATI Notification request has failed. ON_REQUEST_FAILED 16#0000151F 5407 TF3710_ERR_UNSUPPOR Notification mode is currently not TED_NOTIFICATION_MOD supported. E 16#00001520 5408 TF3710_ERR_NOTIFICATI Buffered notification has failed. ON_BUFFER_FAILED 16#00001534 5428 TF3710_ERR_WRITE_REQ Write request has failed. UEST_FAILED 16#00001565 5429 TF3710_ERR_WRITE_BUF Write buffer invalid FER 16#FFFFE05C -8100 TF3710_ERR_INVALID_HA Invalid handle NDLE 16#FFFFE05B -8101 TF3710_ERR_HANDLE_IN The handle is still in use. _USE 16#FFFFE052 -8110 TF3710_ERR_INVALID_AR Invalid array RAY 0x FFFFE051 -8111 TF3710_ERR_INVALID_AR Array size invalid RAY_SIZE 0x FFFFE050 -8112 TF3710_ERR_SYMBOL_N Symbol not found. OT_FOUND 0x FFFFE04F -8113 TF3710_ERR_LVBUFFER_ LVBuffer was not registered. NOT_REGISTERED 16#FFFFE04E -8114 TF3710_ERR_HEARTBEA No instance of FB_Heartbeat found at a T_NO_TARGET target. 16#FFFFE04D -8115 TF3710_ERR_HEARTBEA No instance of FB_Heartbeat with the T_TARGET_NOT_FOUND specified target address found. 16#FFFFE04C -8116 TF3710_ERR_HEARTBEA The instance of FB_Heartbeat is T_TARGET_ALREADY_IN_ already being used by another target. USE 16#FFFFE04B -8117 TF3710_ERR_HEARTBEA Heartbeat has already been initialized. T_ALREADY_INITIALIZED Only one instance is permitted per client handle. 16#FFFFE04A -8118 TF3710_ERR_HEARTBEA Heartbeat has already been launched. T_ALREADY_RUNNING Only one running instance is permitted per client handle. 16#FFFFE049 -8119 TF3710_ERR_HEARTBEA Heartbeat has not yet been initialized. T_NOT_INITIALIZED TF3710 Version: 1.8.1 129
## Page 130

Appendix error value symbol Error description Remedy option 16#FFFFE048 -8120 TF3710_ERR_HEARTBEA Heartbeat is not executed. T_NOT_RUNNING 9.5 Support Return Codes error value symbol Error description Remedy option 16#00001414 5140 TF3710_ERR_INVALID_RE The request is not currently supported QUEST 16#00001415 5141 TF3710_ERR_BETA_TRIA Beta trial period has expired L_EXPIRED 16#00001416 5142 TF3710_ERR_LICENSE_S The license state is invalid TATE_ISSUE 130 Version: 1.8.1 TF3710
## Page 131

Trademark statements Beckhoff®, ATRO®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. Third-party trademark statements Intel, the Intel logo, Intel Core, Xeon, Intel Atom, Celeron and Pentium are trademarks of Intel Corporation or its subsidiaries. The registered trademark Linux® is used pursuant to a sublicense from the Linux Foundation, the exclusive licensee of Linus Torvalds, owner of the mark on a worldwide basis. Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies. National Instruments® and Lab VIEW™ are trademarks of National Instruments. Neither Beckhoff, nor any software programs or other goods or services offered by Beckhoff, are affiliated with, endorsed by, or sponsored by National Instruments.
## Page 132

More Information: www.beckhoff.com/TF3710 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
