---
title: "TwinCAT_3_PLC_Lib_Tc2_IoFunctions_EN"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "FUNCTIONS", "LIB", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.5.3"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc2_IoFunctions_EN.pdf"
release_date: "2025-08-21"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc2_Io Functions 2025-08-21 | Version: 1.5.3
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 7 1.1 Notes on the documentation............................................................................................................. 7 1.2 For your safety.................................................................................................................................. 7 1.3 Notes on information security............................................................................................................ 9 2 Overview.................................................................................................................................................. 10 3 Function blocks....................................................................................................................................... 13 3.1 General IO FBs............................................................................................................................... 13 3.1.1 IOF_Device Reset............................................................................................................. 13 3.1.2 IOF_Get Box Addr By Name................................................................................................ 14 3.1.3 IOF_Get Box Addr By Name Ex............................................................................................ 15 3.1.4 IOF_Get Box Count............................................................................................................ 16 3.1.5 IOF_Get Box Name By Addr................................................................................................ 17 3.1.6 IOF_Get Box Net Id............................................................................................................. 18 3.1.7 IOF_Get Device Count....................................................................................................... 19 3.1.8 IOF_Get Device IDBy Name............................................................................................... 20 3.1.9 IOF_Get Device IDs........................................................................................................... 21 3.1.10 IOF_Get Device Info By Name............................................................................................. 23 3.1.11 IOF_Get Device Name....................................................................................................... 24 3.1.12 IOF_Get Device Net Id........................................................................................................ 25 3.1.13 IOF_Get Device Type........................................................................................................ 26 3.2 ASI master terminal......................................................................................................................... 27 3.2.1 Overview.......................................................................................................................... 27 3.2.2 FB_ASI_Addressing......................................................................................................... 28 3.2.3 FB_ASI_Slave Diag.......................................................................................................... 29 3.2.4 FB_ASI_Read Parameter................................................................................................. 31 3.2.5 FB_ASI_Write Parameter.................................................................................................. 32 3.2.6 FB_ASI_Processdata_digital........................................................................................... 33 3.2.7 FB_ASI_Parameter Control.............................................................................................. 35 3.2.8 FB_Read Input_analog..................................................................................................... 35 3.2.9 FB_Write Output_analog................................................................................................... 37 3.3 AX200x Profibus............................................................................................................................. 38 3.3.1 Overview.......................................................................................................................... 38 3.3.2 FB_AX2000_Parameter................................................................................................... 39 3.3.3 FB_AX2000_AXACT........................................................................................................ 41 3.3.4 FB_AX2000_Jog Mode..................................................................................................... 42 3.3.5 FB_AX2000_Reference................................................................................................... 43 3.3.6 FB_AX200X_Profibus...................................................................................................... 44 3.4 Beckhoff Lightbus............................................................................................................................ 46 3.4.1 IOF_LB_Break Location Test............................................................................................. 46 3.4.2 IOF_LB_Parity Check....................................................................................................... 47 3.4.3 IOF_LB_Parity Check With Reset....................................................................................... 49 3.5 Beckhoff UPS (configured with Windows UPS Service.................................................................. 51 3.5.1 FB_Get UPSStatus........................................................................................................... 51 3.6 Bus Terminal configuration............................................................................................................. 53 TE1000 Version: 1.5.3 3
## Page 4

Table of contents 3.6.1 FB_KL1501Config............................................................................................................ 53 3.6.2 FB_KL27x1Config............................................................................................................ 56 3.6.3 FB_KL320x Config............................................................................................................ 59 3.6.4 FB_KL3208Config............................................................................................................ 61 3.6.5 FB_KL3228Config............................................................................................................ 63 3.7 CANopen......................................................................................................................................... 65 3.7.1 IOF_CAN_Layer2Command............................................................................................ 65 3.8 NOV/DP-RAM................................................................................................................................. 67 3.8.1 FB_Nov Ram Read Write.................................................................................................... 67 3.8.2 FB_Nov Ram Read Write Ex............................................................................................... 69 3.8.3 FB_Get DPRAMInfo.......................................................................................................... 71 3.8.4 FB_Get DPRAMInfo Ex...................................................................................................... 73 3.9 Profibus DPV1 (Sinamics)............................................................................................................... 75 3.9.1 F_Create Dpv1Read Req Pkg............................................................................................ 75 3.9.2 F_Create Dpv1Write Req Pkg............................................................................................. 76 3.9.3 F_Split Dpv1Read Res Pkg................................................................................................ 77 3.9.4 F_Split Dpv1Write Res Pkg................................................................................................. 77 3.9.5 FB_Dpv1Read.................................................................................................................. 78 3.9.6 FB_Dpv1Write.................................................................................................................. 81 3.10 Profinet DPV1 (Sinamics)............................................................................................................... 83 3.10.1 F_Create Dpv1Read Req Pkg PNET................................................................................... 83 3.10.2 F_Create Dpv1Write Req Pkg PNET................................................................................... 84 3.10.3 F_Split Dpv1Read Res Pkg PNET....................................................................................... 85 3.10.4 F_Split Dpv1Write Res Pkg PNET....................................................................................... 86 3.10.5 FB_Dpv1Read PNET........................................................................................................ 86 3.10.6 FB_Dpv1Write PNET........................................................................................................ 89 3.11 RAID Controller............................................................................................................................... 91 3.11.1 FB_RAIDFind Cntlr........................................................................................................... 91 3.11.2 FB_RAIDGet Info.............................................................................................................. 92 3.11.3 FB_RAIDGet Status.......................................................................................................... 93 3.12 SERCOS......................................................................................................................................... 95 3.12.1 IOF_SER_Get Phase........................................................................................................ 95 3.12.2 IOF_SER_Save Flash....................................................................................................... 96 3.12.3 IOF_SER_Reset Err.......................................................................................................... 97 3.12.4 IOF_SER_Set Phase........................................................................................................ 98 3.12.5 IOF_SER_IDN_Read....................................................................................................... 99 3.12.6 IOF_SER_IDN_Write..................................................................................................... 101 3.12.7 IOF_SER_DRIVE_Backup............................................................................................. 102 3.12.8 IOF_SER_DRIVE_Backup Ex......................................................................................... 104 3.12.9 IOF_SER_DRIVE_Reset............................................................................................... 107 3.13 Tc Touch Lock................................................................................................................................. 108 3.13.1 FB_Tc Touch Lock_Acquire Focus................................................................................... 108 3.14 Third party devices........................................................................................................................ 110 3.14.1 Phoenix IBS SC/I-T........................................................................................................ 110 3.14.2 ads-tec........................................................................................................................... 121 4 Functions............................................................................................................................................... 123 4 Version: 1.5.3 TE1000
## Page 5

Table of contents 4.1 [Obsolete]...................................................................................................................................... 123 4.1.1 F_Get Version Tc Io Functions.......................................................................................... 123 4.1.2 F_Get Version RAIDController......................................................................................... 123 5 Data Types............................................................................................................................................. 125 5.1 E_PD_Dpv1Error.......................................................................................................................... 125 5.2 E_Battery Status............................................................................................................................ 126 5.3 E_PD_Datatype............................................................................................................................ 126 5.4 E_RAIDDrive Status....................................................................................................................... 127 5.5 E_RAIDDrive Usage...................................................................................................................... 128 5.6 E_RAIDStatus............................................................................................................................... 128 5.7 E_RAIDType................................................................................................................................. 129 5.8 E_Sercos Attrib Len........................................................................................................................ 129 5.9 E_Sercos Attrib Type...................................................................................................................... 129 5.10 E_Ups Comm Status....................................................................................................................... 130 5.11 E_Ups Power Status....................................................................................................................... 130 5.12 IODEVICETYPES......................................................................................................................... 131 5.13 ST_Ads Tec Sys Data...................................................................................................................... 133 5.14 ST_Dpv1Param Addr Ex................................................................................................................. 134 5.15 ST_Dpv1Value Header Ex.............................................................................................................. 135 5.16 ST_Nov Ram Addr Info.................................................................................................................... 135 5.17 ST_Nov Ram Addr Info Ex................................................................................................................ 136 5.18 ST_Parameter_IN......................................................................................................................... 136 5.19 ST_Parameter_OUT..................................................................................................................... 137 5.20 ST_Parameter Buffer..................................................................................................................... 137 5.21 ST_PD_Dpv1Error........................................................................................................................ 138 5.22 ST_PNET_CCDSTS..................................................................................................................... 138 5.23 ST_PNIOConfig Record................................................................................................................. 138 5.24 ST_PNIORecord........................................................................................................................... 139 5.25 ST_PNIOState.............................................................................................................................. 139 5.26 ST_PZD_IN................................................................................................................................... 139 5.27 ST_PZD_OUT............................................................................................................................... 139 5.28 ST_RAIDCntlr Found..................................................................................................................... 140 5.29 ST_RAIDConfig Req...................................................................................................................... 140 5.30 ST_RAIDDrive Status.................................................................................................................... 141 5.31 ST_RAIDInfo................................................................................................................................. 141 5.32 ST_RAIDStatus Res...................................................................................................................... 141 5.33 ST_Sercos Param Attrib................................................................................................................. 142 5.34 ST_Sercos Param Err List............................................................................................................... 143 5.35 ST_Sercos Param List.................................................................................................................... 143 5.36 ST_UPSStatus.............................................................................................................................. 144 5.37 ST_KL1501In Data......................................................................................................................... 147 5.38 ST_KL1501Out Data...................................................................................................................... 147 5.39 ST_KL27x1In Data......................................................................................................................... 147 5.40 ST_KL27x1Out Data...................................................................................................................... 147 5.41 ST_KL320x In Data......................................................................................................................... 148 5.42 ST_KL320x Out Data...................................................................................................................... 148 TE1000 Version: 1.5.3 5
## Page 6

Table of contents 5.43 ST_KL3208In Data......................................................................................................................... 148 5.44 ST_KL3208Out Data...................................................................................................................... 149 5.45 ST_KL3228In Data......................................................................................................................... 149 5.46 ST_KL3228Out Data...................................................................................................................... 149 6 Global constants................................................................................................................................... 150 6.1 Library version............................................................................................................................... 150 7 Appendix................................................................................................................................................ 151 7.1 SERCOS file format of the backup file.......................................................................................... 151 7.2 AX200x Profibus Parameter Number............................................................................................ 152 7.3 Errorcodes..................................................................................................................................... 155 7.4 ADS Return Codes........................................................................................................................ 156 7.5 Support and Service...................................................................................................................... 160 6 Version: 1.5.3 TE1000
## Page 7

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.5.3 7
## Page 8

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 8 Version: 1.5.3 TE1000
## Page 9

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.5.3 9
## Page 10

Overview 2 Overview The IO Functions library contains function blocks with which services/functions can be executed on the IO devices (fieldbus masters or slaves). General Device Functions Name Description IOF_Device Reset [} 13] Reset an I/O device IOF_Get Box Addr By Name [} 14] Find the fieldbus address of the box, knowing the device ID and the box identifier IOF_Get Box Addr By Name Ex Find the fieldbus address of the box, knowing the device identifier and the box identifier [} 15] IOF_Get Box Count [} 16] Read the number of boxes IOF_Get Box Name By Addr [} 17] Read the box identifier knowing the fieldbus address of the box and the device ID IOF_Get Box Net Id [} 18] Read the Ams Net Id of a box, knowing the fieldbus address of the box and the device ID IOF_Get Device Count [} 19] Read the number of I/O devices. IOF_Get Device IDBy Name Find the device ID knowing the device identifier [} 20] IOF_Get Device IDs [} 21] Read all device IDs IOF_Get Device Name [} 24] Read the device identifier knowing the device ID IOF_Get Device Net Id [} 25] Read the Ams Net Id, knowing the device ID IOF_Get Device Type [} 26] Read the device type, knowing the device ID IOF_Get Device Info By Name Determine the device ID and the Ams Net Id, knowing the device name [} 23] Fieldbus-specific and device-specific functions CANopen Name Description IOF_CAN_Layer2Command Carry out a layer 2 command [} 65] Beckhoff Lightbus Name Description IOF_LB_Break Location Test Optical fiber ring break location test [} 46] IOF_LB_Parity Check [} 47] Read parity counter IOF_LB_Parity Check With Reset Read and reset parity counter [} 49] SERCOS Name Description IOF_SER_Get Phase [} 95] Read the current phase IOF_SER_Reset Err [} 97] Reset the error buffer IOF_SER_Save Flash [} 96] Save parameter in flash IOF_SER_Set Phase [} 98] Set the current phase 10 Version: 1.5.3 TE1000
## Page 11

Overview Name Description IOF_SER_IDN_Read [} 99] Read Sercos drive parameters IOF_SER_IDN_Write [} 101] Write Sercos drive parameters IOF_SER_DRIVE_Backup [} 102] Backup and restore the Sercos drive parameters to/from a file IOF_SER_DRIVE_Backup Ex Backup and restore the Sercos drive parameters to/from a file (extended functionality) [} 104] IOF_SER_DRIVE_Reset [} 107] Drive reset of a Sercos drive by command on parameter S-0-0099 (IDN99) Profibus DPV1 (Sinamics Name Description F_Create Dpv1Read Req Pkg Generate DPV1 telegram for parameter reading [} 75] FB_Dpv1Read [} 78] Send DPV1 telegram for parameter reading F_Split Dpv1Read Res Pkg [} 77] Evaluate DPV1 response telegram for parameter reading F_Create Dpv1Write Req Pkg Generate DPV1 telegram for parameter writing [} 76] FB_Dpv1Write [} 81] Send DPV1 telegram for parameter writing F_Split Dpv1Write Res Pkg [} 77] Evaluate DPV1 response telegram for parameter writing Profinet DPV1 (Sinamics) Name Description F_Create Dpv1Read Req Pkg PNET Generate DPV1 telegram for parameter reading [} 83] FB_Dpv1Read PNET [} 86] Send DPV1 telegram for parameter reading F_Split Dpv1Read Res Pkg PNET Evaluate DPV1 response telegram for parameter reading [} 85] F_Create Dpv1Write Req Pkg PNET Generate DPV1 telegram for parameter writing [} 84] FB_Dpv1Write PNET [} 89] Send DPV1 telegram for parameter writing F_Split Dpv1Write Res Pkg PNET Evaluate DPV1 response telegram for parameter writing [} 86] NOV/DP-RAM Name Description FB_Nov Ram Read Write [} 67] Write data to the NOVRAM or read data from the NOVRAM FB_Nov Ram Read Write Ex [} 69] Write data to the NOVRAM or read data from the NOVRAM. Checks whether a special method of accessing the memory is necessary and copies the data accordingly in the correct way (e.g. when accessing the CX_9000 NOV-RAM). FB_Get DPRAMInfo [} 71] Read the address pointer and the configured size from the NOV/DP-RAM FB_Get DPRAMInfo Ex [} 73] Read the address pointer and the configured size from the NOV/DP-RAM (Extension) AX200x Profibus Function blocks for access to the AX200X via Profibus: overview [} 38]. TE1000 Version: 1.5.3 11
## Page 12

Overview ASI master terminal Function blocks for access to an ASI master terminal: overview [} 27]. Beckhoff UPS (under Windows UPS service) Name Description FB_Get UPSStatus [} 51] Read the status of the UPS from the PLC. Third-party vendor devices INTERBUS Phoenix IBS SC/I-T functions Phoenix IBS SC/I-T functions: overview [} 110]. Name Description SCIT_Activate Configuration Executes the Activate_Configuration command [} 112] SCIT_Deactivate Configuration Executes the Deactivate_Configuration command [} 113] SCIT_Start Data Transfer [} 114] Executes the Start_Data_Transfer command SCIT_Stop Data Transfer [} 115] Executes the Stop_Data_Transfer command SCIT_Alarm Stop [} 116] Executes the Alarm_Stop command SCIT_Control Active Configuratio Is used to affect the active configuration of the Interbus devices. This command can be executed in the PAR_READY state as well as when in n [} 117] the ACTIVE or RUN states. Single, dependent and grouped devices can be activated and deactivated in this way. SCIT_Get Error Info [} 119] Returns the error type and error location of an Interbus device after a bus error SCIT_Conf Dev Err All [} 120] Acknowledge periphery errors of all devices ads-tec Name Description FB_Read Ads Tec Sys Data [} 121] Reads the system data/diagnostic data RAID_Controller The following function blocks are available for RAID controller services. Name Description FB_RAIDFind Cntlr [} 91] Returns the number of RAID controllers and the corresponding RAID controller IDs FB_RAIDGet Info [} 92] Supplies RAID information containing the number of RAID controller sets and the maximum number of RAID drives per set. FB_RAIDGet Status [} 93] Returns the RAID set index, the RAID type, the RAID status, the number of RAID drives and the status of the RAID drives. 12 Version: 1.5.3 TE1000
## Page 13

Function blocks 3 Function blocks 3.1 General IO FBs 3.1.1 IOF_Device Reset The IOF_Device Reset function block resets an I/O device (e.g. a fieldbus card). The function corresponds to the online reset function from the Twin CAT->I/O->Devices->Device xyz context menu. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; RESET : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. RESET BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. TE1000 Version: 1.5.3 13
## Page 14

Function blocks Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.2 IOF_Get Box Addr By Name The IOF_Get Box Addr By Name function block determines the fieldbus address of a box (box = slave, module, station), knowing the box name and the device ID. If no fieldbus address is available, the function block returns a physical or a logical address. (In the case of the Beckhoff Lightbus, for instance, it is the physical box number in the optical fiber ring, while in Profibus it is the station address). The box identifier is passed as a string to the function block, and can be specified by the user during the configuration in the Twin CAT system. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; BOXNAME : T_Max String; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. BOXNAME T_Max String The box name as a string. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; BOXADDR : UINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. 14 Version: 1.5.3 TE1000
## Page 15

Function blocks Name Type Description ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. BOXADDR UINT The fieldbus address or logical address of the box. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.3 IOF_Get Box Addr By Name Ex The IOF_Get Box Addr By Name Ex function block determines the fieldbus address of a box (box = slave, module, station), knowing the box name and the device name. If no fieldbus address is available, the function block returns a physical or a logical address. (In the case of the Beckhoff Lightbus, for instance, it is the physical box number in the fiber-optic ring, while in Profibus it is the station address). The box name and the device name are passed as strings to the function block, and can be specified by the user during the configuration in the Twin CAT system. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICENAME : T_Max String; BOXNAME : T_Max String; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICENAME T_Max String The device name of an I/O device as a string. BOXNAME T_Max String The box name as a string. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; TE1000 Version: 1.5.3 15
## Page 16

Function blocks ERRID : UDINT; BOXADDR : UINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. BOXADDR UINT The fieldbus address or logical address of the box. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.4 IOF_Get Box Count The IOF_Get Box Count function block reads the number of configured and active boxes (box = slave, module, station) of an I/O device. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; 16 Version: 1.5.3 TE1000
## Page 17

Function blocks ERRID : UDINT; BOXCOUNT : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. BOXCOUNT UINT The number of boxes Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.5 IOF_Get Box Name By Addr The IOF_Get Box Name By Addr function block determines the box name, knowing the device ID and the fieldbus address of a box (box = slave, module, station). If no fieldbus address is available, a logical or physical address can be transferred to the function block as the fieldbus address (e.g. the physical box number in the fiber-optic ring for Beckhoff Lightbus). If successful the function block returns the box name configured in Twin CAT as a string. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; BOXADDR : UINT; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. BOXADDR UINT The fieldbus address of the box. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. TE1000 Version: 1.5.3 17
## Page 18

Function blocks Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; BOXNAME : T_Max String; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. BOXNAME T_Max String The box name as a string. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.6 IOF_Get Box Net Id Some boxes (slave modules) can be assigned an Ams Net Id during the configuration in Twin CAT. The Ams Net Id can then be used to execute firmware functions on the box. The IOF_Get Box Net Id function block determines the Twin CAT network address, knowing the device ID of the master and the fieldbus address or logical address in the fieldbus. The device IDs are specified by the Twin CAT system during the configuration and cannot be configured by the user. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; BOXADDR : WORD; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. 18 Version: 1.5.3 TE1000
## Page 19

Function blocks Name Type Description BOXADDR WORD The fieldbus address, or the logical address of the box (slave module) whose Ams Net Id is to be read. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; Box Net Id : T_Ams Net Id; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Box Net Id T_Ams Net ID The Twin CAT network address of the box as a string. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.7 IOF_Get Device Count The IOF_Get Device Count function block reads the number of configured and active I/O devices. Inputs VAR_INPUT NETID : T_Ams Net Id; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. START BOOL The function block is enabled by a positive edge at this input. TE1000 Version: 1.5.3 19
## Page 20

Function blocks Name Type Description TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; DEVICECOUNT : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. DEVICECOUNT UDINT Number of I/O devices Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.8 IOF_Get Device IDBy Name The IOF_Get Device IDBy Name function block determines the device ID of an I/O device, knowing the device name. If successful, the function block returns the device ID specified by the Twin CAT system during configuration. The device IDs cannot be configured by the user. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICENAME : T_Max String; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICENAME T_Max String The device name of an I/O device. START BOOL The function block is enabled by a positive edge at this input. 20 Version: 1.5.3 TE1000
## Page 21

Function blocks Name Type Description TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; DEVICEID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. DEVICEID UDINT The device ID of an I/O device. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.9 IOF_Get Device IDs The IOF_Get Device IDs function block reads the device IDs of all configured and active I/O devices into a data buffer. The data buffer can be defined as an array of Word variables. If successful, the function block returns the total number of the device IDs that exist in the first data word, while the remaining data words contain the corresponding device IDs of the individual I/O devices. The device IDs are specified by the Twin CAT system during the configuration and cannot be configured by the user. Inputs VAR_INPUT NETID : T_Ams Net Id; LEN : UDINT; DESTADDR : PVOID; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. TE1000 Version: 1.5.3 21
## Page 22

Function blocks Name Type Description LEN UINT The length in bytes of the data buffer into which the device IDs are to be read. DESTADDR PVOID Address of the data buffer into which the device IDs are to be read. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Sample: PROGRAM MAIN VAR IOF_Get Device Ids1 : IOF_Get Device IDs; Ids Data : ARRAY[1..201] OF WORD; Start Get Dev Ids : BOOL; Get Dev Ids_Busy : BOOL; Get Dev Ids_Err : BOOL; Get Dev Ids_Err Id : UDINT; END_VAR Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 22 Version: 1.5.3 TE1000
## Page 23

Function blocks 3.1.10 IOF_Get Device Info By Name The IOF_Get Device Info By Name function block determines the device ID of an I/O device and its Twin CAT network address, knowing the device name. The device IDs cannot be configured by the user. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICENAME : T_Max String; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICENAME T_Max String The device name of an I/O device. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; DEVICEID : UDINT; DEVICENETID : T_Ams Net Id; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. DEVICEID UDINT The device ID of an I/O device. DEVICENETID T_Ams Net ID The network address of an I/O device. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) TE1000 Version: 1.5.3 23
## Page 24

Function blocks 3.1.11 IOF_Get Device Name The IOF_Get Device Name function block reads the device name of an I/O device. The device name can be specified by the user during the configuration in the Twin CAT system. This is then sent as a string to the I/O driver at system startup and can be read using the ADS commands. The DEVICEID input variable is used to specify the I/O device whose device name is to be read. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; DEVICENAME : T_Max String; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. DEVICENAME T_Max String The device name of an I/O device as a string. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 24 Version: 1.5.3 TE1000
## Page 25

Function blocks 3.1.12 IOF_Get Device Net Id Some I/O devices can be assigned a Twin CAT network address during the configuration in the Twin CAT system (e.g. FC310x Profibus card or CP9030 card). The network address can then be used to execute firmware functions on the device. The IOF_Get Device Net Id function block determines the network address knowing the device ID. The device IDs are defined by the Twin CAT system during configuration and cannot be configured by the user. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; Device Net Id : T_Ams Net Id; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Device Net Id T_Ams Net ID The network address of an I/O device as a string. TE1000 Version: 1.5.3 25
## Page 26

Function blocks Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.1.13 IOF_Get Device Type The "IOF_Get Device Type" function block determines the device type knowing the device ID. The device IDs are defined by the Twin CAT system during configuration and cannot be configured by the user. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; IODevice Type : IODEVICETYPES; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. IODevice Type IODEVICETYPES [} 131] The device type constant. 26 Version: 1.5.3 TE1000
## Page 27

Function blocks Sample: PROGRAM MAIN VAR Get Device Type1 : IOF_Get Device Type; Start_Get Type : BOOL; Get Type_Busy : BOOL; Get Type_Err : BOOL; Get Type_Err Id : UDINT; Device Type : IODEVICETYPES; END_VAR Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 3.2 ASI master terminal 3.2.1 Overview Function blocks for accessing the ASI master terminal. Function blocks: Name Description FB_ASI_Addressing [} 28] Specify or modify addresses of the ASI slaves FB_ASI_Slave Diag [} 29] Cyclic slave diagnostics (e.g. counter states) FB_ASI_Read Parameter [} 31] Universal FB for reading all the parameters of an ASI slave FB_ASI_Write Parameter [} 32] Universal FB for setting all the parameters of an ASI slave FB_Read Input_analog [} 35] Read analog values FB_Write Output_analog [} 37] Write analog values FB_ASI_Processdata_digital [} 33] Read/write digital values FB_ASI_Parameter Control [} 35] Background communication. This block must always be called cyclically!!! Linking into the System Manager The library has one input structure: ST_Parameter_IN, and one output structure: ST_Parameter_OUT. These must be instanced and addressed, so that on the one hand they can be passed to the FB_Parameter Control function block as VAR_IN_OUT, and on the other hand can be linked into the System Manager. The terminals' process data contains 6 or 16 bytes, depending on which ASI module is linked into the System Manager. These can be linked directly. TE1000 Version: 1.5.3 27
## Page 28

Function blocks 3.2.2 FB_ASI_Addressing Inputs VAR_INPUT i Old Address : BYTE;(*old address*) i New Address : BYTE;(*new address*) b Start : BOOL;(*START*) END_VAR Name Type Description i Old Address BYTE Old address of the slave to be addressed (new slaves have the address 0). i New Address BYTE New address of the slave to be addressed. b Start BOOL Addressing is carried out with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR 28 Version: 1.5.3 TE1000
## Page 29

Function blocks Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; b Errornumber : DWORD; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 3.2.3 FB_ASI_Slave Diag Inputs VAR_INPUT i Slaveaddress : BYTE; i Counter : INT; b Read LES : BOOL; b Read LAS : BOOL; b Cyle Mode : BOOL; b Start : BOOL; END_VAR TE1000 Version: 1.5.3 29
## Page 30

Function blocks Name Type Description i Slaveaddress BYTE Slave address i Counter INT 1:Physical Fault Counter, 2:Timeout Counter, 3:Response Counter, 4:Leave-Data Exch Counter, 5:Data Exch-Failed Counter. b Counter Reset BOOL Resetting of the current counter. b Read LES BOOL List of the identified ASI slaves (LES). b Read LAS BOOL List of the activated ASI slaves (LAS). b Cycle Mode BOOL 0=continuous reading, 1= reading once. b Start BOOL The corresponding order is executed with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; i Errornumber : DWORD;(* Error code of ASI-Master *) i Counter Value : WORD;(*Counter of a slave*) i Slave List : DWORD;(*LES or LAS of all Slaves*) END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Name Type Description i Countervalue WORD Counter value i Slave List DWORD LES or LAS 30 Version: 1.5.3 TE1000
## Page 31

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 3.2.4 FB_ASI_Read Parameter Inputs VAR_INPUT i Parameternumber : WORD; b Cycle Mode : BOOL;(*0: Acyclic , 1:Cyclic (permanent Read/Write) *) b Start : BOOL; END_VAR Name Type Description i Parameter Number WORD Parameter number. b Cycle Mode BOOL 0: Acyclic , 1:Cyclic (permanent Read/Write) If this bit is set, the b Busy output is only canceled when the b Start input is set to FALSE. No current value is present at the output if the b Start input is set to FALSE too early. b Start BOOL The corresponding order is executed with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; i Errornumber : DWORD;(* Error code of ASI-Master *) i Parameter Readvalue : BYTE; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. TE1000 Version: 1.5.3 31
## Page 32

Function blocks Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Name Type Description i Parameter Readvalu BYTE I/O ID or ID code of the addressed slave. e Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 3.2.5 FB_ASI_Write Parameter Inputs VAR_INPUT i Parameternumber : WORD; i Parametervalue : DWORD; b Start : BOOL; END_VAR Name Type Description i Parameter Number WORD Parameter number i Parametervalue DWORD Parameter value b Start BOOL The corresponding order is executed with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; b Errornumber : DWORD; END_VAR 32 Version: 1.5.3 TE1000
## Page 33

Function blocks Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 3.2.6 FB_ASI_Processdata_digital Inputs VAR_INPUT i Slaveaddress : BYTE; i Slavevalue : WORD; b Parametermode : BOOL; b Cycle Mode : BOOL; b Comm Mode : BOOL; b Reg Comm : BOOL; bmask Access : BOOL; b Start : BOOL; END_VAR Name Type Description i Slaveaddress BYTE Slave address i Slavevalue WORD Process value b Parametermode BOOL 0: Read, 1: Write b Cycle Mode BOOL 0: Acyclic , 1:Cyclic (permanent Read/Write) If this bit is set, the b Busy output is only canceled when the b Start input is set to FALSE. No current value is present at the output if the b Start input is set to FALSE too early. TE1000 Version: 1.5.3 33
## Page 34

Function blocks Name Type Description b Comm Mode BOOL 0: Parameter access, 1: ADS (currently always 0) b Reg Comm BOOL Register communication: 0: Parameter access, 1: Register communication (currently always 0) bmask Access BOOL 0:normal access, 1:masked access b Start BOOL The corresponding order is executed with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; i Errornumber : DWORD;(* Error code of ASI-Master *) i Read Value : WORD; i Parametergroup : WORD; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Name Type Description i Readvalue WORD Process value i Parametergroup WORD Parameter group Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 34 Version: 1.5.3 TE1000
## Page 35

Function blocks 3.2.7 FB_ASI_Parameter Control The FB_ASI_Parameter Control realizes the background communication between the ASI master terminal and the individual function blocks of the Lib. Call the function block This function block must always be called cyclically. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; st Parameter_IN : ST_Parameter_IN; st Parameter_OUT : ST_Parameter_OUT; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] st Parameter_IN ST_Parameter_IN [} 136] Input data of the ASI terminal. st Parameter_OUT ST_Parameter_OUT [} 137] Input data of the ASI terminal. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 3.2.8 FB_Read Input_analog Inputs VAR_INPUT i Slaveaddress : BYTE; i Channel : BYTE; b Cycle Mode : BOOL;(*0: Acyclic , 1:Cyclic (permanent Read/Write) *) b Start : BOOL; END_VAR Name Type Description i Slaveaddress BYTE Slave address i Channel BYTE Slave channel TE1000 Version: 1.5.3 35
## Page 36

Function blocks Name Type Description b Cycle Mode BOOL 0: Acyclic , 1:Cyclic (permanent Read/Write) If this bit is set, the b Busy output is only canceled when the b Start input is set to FALSE. No current value is present at the output if the b Start input is set to FALSE too early. b Start BOOL The corresponding order is executed with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; i Errornumber : DWORD;(* Error code of ASI-Master *) b Valid : BOOL; b Overflow : BOOL; i Read Value : WORD; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Name Type Description b Valid BOOL Validity of the values read. b Overflow BOOL Slave has a value outside its value range. i Readvalue WORD Process value Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 36 Version: 1.5.3 TE1000
## Page 37

Function blocks 3.2.9 FB_Write Output_analog Inputs VAR_INPUT i Slaveaddress : BYTE; i Channel : BYTE; i Slavevalue : WORD; b Cycle Mode : BOOL;(*0: Acyclic , 1:Cyclic (permanent Read/Write) *) b Start : BOOL; END_VAR Name Type Description i Slaveaddress BYTE Slave address i Channel BYTE Slave channel i Slavevalue WORD Data to be written b Cycle Mode BOOL 0: Acyclic , 1:Cyclic (permanent Read/Write) If this bit is set, the b Busy output is only canceled when the b Start input is set to FALSE. No current value is present at the output if the b Start input is set to FALSE too early. b Start BOOL The corresponding order is executed with a positive edge at this Boolean input. Inputs/outputs VAR_IN_OUT st Parameter Buffer : ST_Parameter Buffer; END_VAR Name Type Description st Parameter Buffer ST_Parameter Buffer Data buffer for background communication. [} 137] Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; b Errornumber : DWORD; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Errornumber DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. TE1000 Version: 1.5.3 37
## Page 38

Function blocks Command-specific error code (decimal) Description 1 Communication timeout 2 ASI slave address not available 3 - 10 Reserved 11 ASI slave is not activated (slave is not in LAS). 12 An error occurred during communication. 13 Data exchange bit (CN.4) not set Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 3.3 AX200x Profibus 3.3.1 Overview Function blocks for access to the AX20XX via Profibus. The requirement for operation on the Profibus is the use of an FC310x with a firmware version higher than 1.20. Function blocks Name Description FB_AX2000_Parameter [} 39] Writing/reading of drive parameterization data. Please note that the "STOP" input of the AX2000AXACT function block must remain TRUE while writing a parameter to change the operation mode. FB_AX2000_AXACT [} 41] Start axis actions (must always be called cyclically) FB_AX2000_Jogmode [} 42] Jog mode FB_AX2000_Reference [} 43] Set the reference point or start a homing run FB_AX200X_Profibus [} 44] This function block combines the three preceding function blocks. It offers the complete interface to the AX2000 with access to all functions (except parameters). Linking into the System Manager The "AX2000" box is inserted in the Twin CAT System Manager into the I/O configuration under the corresponding Profibus card. The I/O variables can now be linked directly to the corresponding I/O variables in the PLC application in the "PZD" (process data) module for the AX2000 box. The "PKW" module is not linked, because the PKW data is transmitted by ADS. 38 Version: 1.5.3 TE1000
## Page 39

Function blocks Notes on use of the function blocks • Instances of the I/O structures st PZD_IN and st PZD_OUT must be created and addressed in order to be able to link them with the axis in the System Manager. • After first being switched on, the drive is in a safe operating mode, which means that the "positioning" mode must be set before the first axis actions can be executed. This is done by setting the "b Init" input at the AX200X_Profibus block. • The direction of travel in jog mode is specified by the arithmetic sign of "Jog Mode Basic Velo". • Every reference travel, and every setting of the reference point, must be ended by setting b Stop = TRUE. 3.3.2 FB_AX2000_Parameter The function block FB_AX2000_Parameter is used to write/read the data for parameterizing the drive. Please note that the "STOP" input of the AX2000AXACT function block must remain TRUE while writing a parameter to change the operation mode. Inputs VAR_INPUT i Slave Address : BYTE := 0;(* Station Address of the Slave *) i Pnu : WORD := 16#03A2;(* Parameter-Number *) n Axis : BYTE := 1;(* Number of Axis *) i Length : BYTE := 4;(* Length of the parameter (2 or 4) *) TE1000 Version: 1.5.3 39
## Page 40

Function blocks i Sub Index : BYTE; i Parameter Value : DWORD := 2;(* Parameter value *) i FC310x Device Id : WORD := 1;(* Device-ID of the FCxxxx *) b Start Read : BOOL;(* Start Flag to start the PKW-Read *) b Start Write : BOOL;(* Start Flag to start the PKW-Write *) t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description i Slave Address BYTE Station address i Pnu WORD Selection of the parameter to be read or written. List of the available parameter numbers [} 152]. n Axis BYTE Axis ID i Length BYTE Length of the parameter (2 or 4) i Sub Index BYTE i Parameter Value DWORD Value of the parameter to be read or written. i FC310x Device Id WORD Device-ID b Start Read BOOL A positive edge at this Boolean input sends a start command to the axis to read the parameter selected with 'Pnu'. b Start Write BOOL A positive edge at this Boolean input sends a start command to the axis to write the parameter selected with 'Pnu'. When changing the operation mode, the write command is only effective with Stop=TRUE on the FB_AX2000_AXACT [} 41] function block. t Time Out BOOL Maximum time allowed for the execution of the command. Outputs VAR_OUTPUT b Busy :BOOL; i Error Id :DWORD; i Read Value :DINT; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. i Error Id DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. i Read Value DINT Parameter value as a response to the "Start Read" command. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 40 Version: 1.5.3 TE1000
## Page 41

Function blocks 3.3.3 FB_AX2000_AXACT The FB_AX2000_AXACT function block is used to start axis actions (must always be called cyclically). Inputs VAR_INPUT i Velocity : DWORD;(*Velocity*) i Position : DINT;(*Position*) imotion_tasknumber : WORD;(*number of EEPROM-saved motion-task*) imotion_blocktype : WORD;(*optional Parameters of motion tasks*) b Start : BOOL;(*START*) b Stop : BOOL;(*STOP*) b Short Stop : BOOL;(*1: break of motion task, 0: continue same motion task*) b Error Resume : BOOL;(*Error resume*) t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description i Velocity DWORD The parameter contains the required velocity for a subsequent motion command, e.g. µm/s. i Position DINT Target position in physical magnitudes, e.g. µm, degrees. imotion_tasknumber WORD Motion block number. This input can be used to select a motion block previously stored in the drive's memory. imotion_blocktype WORD Motion block type (optional). This input can be used to modify properties of a direct motion command. b Start BOOL A start command is sent to the axis with a positive edge at this Boolean input. b Stop BOOL A stop command is sent to the axis with a positive edge at this Boolean input. The axle stops and goes into the “disabled” state. b Short Stop BOOL A stop command is sent to the axis with a positive edge at this Boolean input. The axle stops, but remains in the “enabled” state. b Error Resume BOOL An “AX200X error” is reset with a positive edge at this Boolean input (no Time Out error). t Time Out BOOL Maximum time allowed for the execution of the command. Inputs/outputs VAR_IN_OUT st PZDIN : ST_PZD_IN; st PZDOUT : ST_PZD_OUT; END_VAR Name Type Description st PZDIN ST_PZD_IN [} 139] Data words from the drive to the PLC. TE1000 Version: 1.5.3 41
## Page 42

Function blocks Name Type Description st PZDOUT ST_PZD_OUT [} 139] Data words from the PLC to the drive. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL;(*Errorstatus of Servo*) b Time Out Err : BOOL; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Error BOOL This output shows the error state. b Time Out Err BOOL Time Out error Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 3.3.4 FB_AX2000_Jog Mode The FB_AX2000_Jog Mode function block is used for jog mode. Inputs VAR_INPUT b Start : BOOL; b Stop : BOOL; i Basic Velo : INT;(*Basic Velocity*) t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description b Start BOOL Start jog mode b Stop BOOL Stop jog mode i Basic Velo INT Basic velocity; the actual velocity is derived from the basic velocity and the "v-jog mode" factor for the drive. t Time Out BOOL Maximum time allowed for the execution of the command. Inputs/outputs VAR_IN_OUT st PZDIN : ST_PZD_IN; st PZDOUT : ST_PZD_OUT; END_VAR 42 Version: 1.5.3 TE1000
## Page 43

Function blocks Name Type Description st PZDIN ST_PZD_IN [} 139] Data words from the drive to the PLC. st PZDOUT ST_PZD_OUT [} 139] Data words from the PLC to the drive. Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; b Time Out Err : BOOL; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. b Time Out Err BOOL Time Out error Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 3.3.5 FB_AX2000_Reference The FB_AX2000_Reference function block is used to set the reference point or start homing Inputs VAR_INPUT b Set Ref Point : BOOL;(* set Reference Point*) b Calibr Start : BOOL;(* start home running*) b Calibr Stop : BOOL;(* stop home running*) i Cal Velo : WORD;(* basic velocity of Calibration*) END_VAR Name Type Description b Set Ref Point BOOL Setting the reference point. b Calibr Start BOOL Start homing. b Calibr Stop BOOL Stop homing. i Cal Velo WORD Basic velocity for homing. The final velocity is composed of the basic velocity and the "v-jog mode" factor for the drive. TE1000 Version: 1.5.3 43
## Page 44

Function blocks Inputs/outputs VAR_IN_OUT st PZDIN : ST_PZD_IN; st PZDOUT : ST_PZD_OUT; END_VAR Name Type Description st PZDIN ST_PZD_IN [} 139] Data words from the drive to the PLC. st PZDOUT ST_PZD_OUT [} 139] Data words from the PLC to the drive. Outputs VAR_OUTPUT b Busy : BOOL; b Err : BOOL; END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Err BOOL This output shows the error state. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 3.3.6 FB_AX200X_Profibus The FB_AX200X_Profibus function block combines the three previous function blocks. It offers the complete interface to the AX2000 with access to all functions (except parameters). 44 Version: 1.5.3 TE1000
## Page 45

Function blocks Inputs VAR_INPUT b Init : BOOL;(*Initialization*) b Mode_Digital Speed : BOOL;(*OP-Mode digital speed instead of Positioning*) i Digital Speed : DWORD;(*digital speed if OP-Mode = digital speed*) i Velocity : DWORD;(*Velocity*) i Position : DINT;(*Position*) i Running Mode : BYTE;(*0:digital speed, 1: motiontask, 2: Jog Mode, 3: Calibration*) imotion_tasknumber : WORD;(*number of EEPROM-saved motion-task*) imotion_blocktype : WORD:=16#2000;(*optional Parameters of motion tasks, default:SI-values*) i Jog Mode Basic Value : INT;(*Basic Velocity for Jog Mode*) i Cal Velo : WORD;(* basic velocity of Calibration*) b Set Ref Point : BOOL;(* set Reference Point*) b Start : BOOL;(*START*) b Stop : BOOL;(*STOP*) b Short Stop : BOOL;(* break of motion task*) i Slave Address : BYTE;(* Station Address of the Slave *) i FC310x Device Id : WORD;(* Device-ID of the FCxxxx *) b Error Resume : BOOL;(*Error resume*) t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description b Init BOOL Initialization of the drive. If b Init is TRUE then operation mode 2, "positioning", is set in the drive. b Mode_Digital Speed BOOL This is set if the drive is to be set to ‘Digital speed’ operation mode during the initialization. i Digital Speed DWORD Speed in the ‘Digital speed’ operation mode. i Velocity DWORD The parameter contains the required velocity for a subsequent motion command, e.g. µm/s. i Position DINT Target position i Running Mode BYTE 0: Digital speed, 1: Motiontask, 2: Jog Mode, 3: Calibration. imotion_tasknumber WORD Motion block number. This input can be used to select a motion block previously stored in the drive's memory. imotion_blocktype WORD Motion block type (optional). This input can be used to modify properties of a direct motion command. i Jog Mode Basic Valu INT Basic velocity for jog mode; the actual velocity is derived e from the basic velocity and the "v-jog mode" factor for the drive. i Cal Velo WORD Basic velocity for homing. The final velocity is composed of the basic velocity and the "v-jog mode" factor for the drive. b Set Ref Point BOOL Setting the reference point b Start BOOL Starting the action, depending on the state of i Running Mode. b Stop BOOL Stopping the action, depending on the state of i Running Mode. b Short Stop BOOL i Slave Address BYTE Station address i FC310x Device Id WORD Device-ID b Error Resume BOOL An “AX200X error” is reset with a positive edge at this Boolean input (no Time Out error). t Time Out BOOL Maximum time allowed for the execution of the command. Inputs/outputs VAR_IN_OUT st PZDIN : ST_PZD_IN; st PZDOUT : ST_PZD_OUT; END_VAR TE1000 Version: 1.5.3 45
## Page 46

Function blocks Name Type Description st PZDIN ST_PZD_IN [} 139] Data words from the drive to the PLC. st PZDOUT ST_PZD_OUT [} 139] Data words from the PLC to the drive. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL;(*Errorstatus of Servo*) i Err ID : DWORD; b Time Out Err : BOOL; b Init OK : BOOL;(*Initialization OK*) iact Position : DINT;(*actual Position SI-value*) END_VAR Name Type Description b Busy BOOL This output remains TRUE until the function block has executed a command. While Busy = TRUE, no new command will be accepted at the inputs. Note that it is not the execution of the service that is monitored in terms of time, but only its acceptance. b Error BOOL This output shows the error state. i Err ID DWORD Contains the command-specific error code of the most recently executed command. Is reset to 0 by the execution of a command at the inputs. b Time Out Err BOOL Time Out error b Init OK BOOL Initialization state of the drive, b Init:= TRUE: Drive is initialized and in operation mode 2 'Positioning'. iact Position DINT Current position display in Running Mode 1: Motiontask. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 3.4 Beckhoff Lightbus 3.4.1 IOF_LB_Break Location Test The IOF_LB_Break Location Test function block carries out a break location test in a Beckhoff Lightbus fiber- optic ring and can locate possible break locations. If no break location is detected during the test, the output variable BOXNO returns the current number of Lightbus modules in the ring. If a break location is detected before the NN-th module in front of the receiver input, the BREAK flag is set and the module number is provided via the output variable BOXNO. If the BOXNO variable returns a value of 0x FF the break location is situated immediately in front of the receiver input, and cannot be located. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; 46 Version: 1.5.3 TE1000
## Page 47

Function blocks START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; BREAK : BOOL; BOXNO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. BREAK BOOL This flag is set if a break location is detected in the fiber- optic ring. BOXNO WORD The module number before the receiver input in front of which the break location has been detected. Requirements Development environ- Target plat- IO hard- PLC libraries to be integrated (category group) ment form ware Twin CAT v3.1.0 None. This Beckhoff Tc2_Io Functions (IO) functionality is Lightbus not supported Master: by Twin CAT 3 C1220 ISA; at present! FC200x PCI 3.4.2 IOF_LB_Parity Check TE1000 Version: 1.5.3 47
## Page 48

Function blocks The IOF_LB_Parity Check function block reads the parity error counters of the Beckhoff Lightbus modules (e.g. BK2000). In contrast to the IOF_LB_Parity Check With Reset [} 49] function block, the counter values are not reset. The master maintains an 8-bit error counter for each module. These counters work without overflow. A maximum of 256 bytes of data, and therefore 256 counters, can be read. The number of error counters to be read is specified by the input variables: LEN and DESTADDR. If, for instance, there are only 5 modules in the ring, then the DESTADDR parameter can be supplied with the address of a data buffer of 5 bytes, and the LEN parameter can be supplied with the value 5. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; LEN : UDINT; DESTADDR : PVOID; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. LEN UINT Length in bytes of the data to be read. DESTADDR PVOID The address of the data buffer into which the parity data is to be written. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Sample: PROGRAM MAIN VAR IOF_LB_Parity Check1 : IOF_LB_Parity Check; Parity Data : ARRAY[1..256] OF BYTE; Start Parity Check : BOOL; Parity Check_Busy : BOOL; Parity Check_Err : BOOL; Parity Check_Err Id : UDINT; END_VAR 48 Version: 1.5.3 TE1000
## Page 49

Function blocks Requirements Development environ- Target plat- IO hard- PLC libraries to be integrated (category group) ment form ware Twin CAT v3.1.0 None. This Beckhoff Tc2_Io Functions (IO) functionality is Lightbus not supported Master: by Twin CAT 3 C1220 ISA; at present! FC200x PCI 3.4.3 IOF_LB_Parity Check With Reset The IOF_LB_Parity Check With Reset function block reads the parity error counters of the Beckhoff Lightbus modules (e.g. BK2000). The counters are then reset. The master maintains an 8-bit error counter for each module. These counters work without overflow. A maximum of 256 bytes of data, and therefore 256 counters, can be read. The number of error counters to be read is specified by the input variables: LEN and DESTADDR. If, for instance, there are only 5 modules in the ring, then the DESTADDR parameter can be supplied with the address of a data buffer of 5 bytes, and the LEN parameter can be supplied with the value 5. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; LEN : UDINT; DESTADDR : PVOID; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the I/O device on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. LEN UINT Length in bytes of the data to be read. DESTADDR PVOID The address of the data buffer into which the parity data is to be written. TE1000 Version: 1.5.3 49
## Page 50

Function blocks Name Type Description START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Sample: PROGRAM MAIN VAR IOF_LB_Parity Check With Reset1 : IOF_LB_Parity Check With Reset; Parity Data : ARRAY[1..256] OF BYTE; Start Parity With Reset : BOOL; Parity Reset_Busy : BOOL; Parity Reset_Err : BOOL; Parity Reset_Err Id : UDINT; END_VAR Requirements Development environ- Target plat- IO hard- PLC libraries to be integrated (category group) ment form ware Twin CAT v3.1.0 None. This Beckhoff Tc2_Io Functions (IO) functionality is Lightbus not supported Master: by Twin CAT 3 C1220 ISA; at present! FC200x PCI 50 Version: 1.5.3 TE1000
## Page 51

Function blocks 3.5 Beckhoff UPS (configured with Windows UPS Service 3.5.1 FB_Get UPSStatus Requirements: • Beckhoff UPS software components have been installed: ◦ Windows 7, Windows Embedded Standard 7 and higher: Configuration dialog under "Start- >Programs->Beckhoff->UPS Software Components". ◦ NT4, Win2K, Win XP, Win XP embedded: Additional tab under “Control Panel->Power Options- >Beckhoff UPS Configuration” or “Control Panel->Power Options->UPS”. ◦ Beckhoff CE devices with 24 V UPS support are delivered with a special Beckhoff Battery Driver for Windows CE. The driver is included in the standard CE image for these devices. • The UPS has been activated and configured. You can find more information about UPS configuration in the corresponding advanced UPS software and device documentation. ◦ Windows 7, Windows Embedded Standard 7 and higher: Configuration dialog under "Start- >Programs->Beckhoff->UPS Software Components". ◦ NT4, Win2K, Win XP, Win XP embedded: Configuration dialog under “Control Panel->Power Options->Beckhoff UPS Configuration”. ◦ Windows CE: The UPS function is disabled by default and must be enabled via a Reg File. Newer images have a configuration dialog under "Start->Control Panel->BECKHOFF UPS Configuration". The FB_Get UPSStatus function block reads the status of the UPS hardware from the PLC. The function block is level triggered, which means that the status information of the UPS is only cyclically read while the b Enable input is set. To keep the system load low, the status information is read every ~4.5 s. When the b Valid output is set, the most recently read data is valid. The most recent read cycle was, in other words, executed without error. If an error occurs, the read cycle is repeated, and the error signal is automatically reset as soon as the cause of the error (e.g. no communication with the UPS) has been corrected. Inputs VAR_INPUT s Net Id : T_Ams Net Id; n Port : T_Ams Port;(* 0 = Windows UPS service / Windows Battery Driver *) b Enable : BOOL; END_VAR Name Type Description s Net Id T_Ams Net ID A string with the network address of the Twin CAT computer whose UPS status is to be read can be specified here. For the local computer an empty string may be specified. n Port T_Ams Port The ADS port number. Set this value to zero. Other port numbers are reserved for future applications. b Enable BOOL The UPS status is read cyclically if this input is set. Outputs VAR_OUTPUT b Valid :BOOL; b Error :BOOL; n Err Id :UDINT; st Status :ST_UPSStatus; END_VAR TE1000 Version: 1.5.3 51
## Page 52

Function blocks Name Type Description b Valid BOOL If this output is set, the data in the ST_UPSStatus structure are valid (no error occurred during the last reading cycle). b Error BOOL This output is set if an error occurred when executing the function. n Err Id UDINT Returns the ADS error number [} 156] or the command- specific error code (table) if the b Error output is set. Error codes Error description 0x0000 No error 0x8001 UPS configuration error. It is possible that the UPS is not configured correctly or that no UPS is configured at all. 0x8002 Communication error. Communication with the UPS was interrupted. 0x8003 Error during the reading of the status data. Name Type Description st Status ST_UPSStatus [} 144] Structure with the status information of the UPS. Not all UPS devices can provide all status information. Some devices, for example, cannot supply the Battery Life Time or Battery Replace status. Example: Online data with status information of a UPS: Requirements Development en- Target platform UPS hardware PLC libraries to be vironment integrated (cate- gory group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) • Beckhoff CU81x0-0xx0 Tc2_Io Functions (IO) • Beckhoff BAPI v1; 52 Version: 1.5.3 TE1000
## Page 53

Function blocks Development en- Target platform UPS hardware PLC libraries to be vironment integrated (cate- gory group) • Beckhoff P24Vxxxx; • Beckhoff CP903x card (PCI/ISA); • Beckhoff CX2100-09x4 models (e.g. CX2100-0904 or CX2100-0914 + "Smart Battery" CX2900-0192); • The APC devices that come supplied with Beckhoff Industrial PC support the Smart protocol and can be configured with the Windows UPS service. 3.6 Bus Terminal configuration 3.6.1 FB_KL1501Config The FB_KL1501Config function block is used to parameterize a KL1501: 1-channel counter terminal. This function block does not follow the alternative output format, since the process image shifts during conversion to this format. Inputs VAR_INPUT b Configurate : BOOL; b Read Config : BOOL; i Set Counter Type : INT; b Set Backward Counting : BOOL; t Timeout : TIME; END_VAR Name Type Description b Configurate BOOL A rising edge starts the configuration sequence. First, the general terminal data, i.e. "terminal name", "special version" and "firmware version", are read. Then, the specified settings are written to the corresponding registers and finally read again for verification and information. The read information is displayed at the function block outputs. During this sequence the output b Busy is TRUE, and no further command, e.g. b Read Config, is accepted. TE1000 Version: 1.5.3 53
## Page 54

Function blocks Name Type Description b Read Config BOOL A rising edge starts a read sequence. The general terminal data “terminal name”, “special version” and “firmware version” are read, followed by the set configuration parameters. The read information is displayed at the function block outputs. During the read sequence the output b Busy is TRUE, and no further command, e.g. b Configurate, is accepted. i Set Counter Type INT Counter type input. The setting is based on the table below. b Set Backward Count BOOL TRUE at this input reverses the count direction. ing t Timeout TIME The terminal configuration or reading of the configuration must be completed within the time entered here. Otherwise an error with a corresponding error number is issued at the outputs b Error and i Error Id. i Set Counter Type Counter type 0 32-bit up/down counter 1 2 x 16-bit up counter 2 32-bit gated counter, gate input Low disables the counter 3 32-bit gated counter, gate input High disables the counter Inputs/outputs VAR_IN_OUT st In Data : ST_KL1501In Data; st Out Data : ST_KL1501Out Data; END_VAR Name Type Description st In Data ST_KL1501In Data [} 147] Reference to the structure of the input process image. st Out Data ST_KL1501Out Data [} 147] Reference to the structure of the output process image. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; i Error Id : UDINT; i State : USINT; i Data In0 : UINT; i Data In1 : UINT; i Data In : UDINT; i Terminal Type : WORD; i Special Type : WORD; i Firmware Version : WORD; s Description : STRING; s Counter Type : STRING; b Backward Counting : BOOL; END_VAR Name Type Description b Busy BOOL As long as the read or configuration sequence is in progress, this output is TRUE. b Error BOOL This output is switched to TRUE, if an error occurred while a command (Configure or Read) is executed. The command-specific error code is contained in i Error Id. i Error Id UDINT Contains the command-specific error code of the most recently executed command. It is reset to 0 by activating the function block again via the inputs b Configurate or b Read Config. See error codes [} 155]. 54 Version: 1.5.3 TE1000
## Page 55

Function blocks Name Type Description i State USINT Corresponds to the status variable of the process data st In Data.i State, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output is set to 0. This output is therefore suitable for assessing the status of the terminal in normal operation. Interfering states during configuration and reading through the register communication are hidden. i Data In0 UINT Corresponds to the data variable of the process data st In Data.arr Data In[0], see VAR_IN_OUT. During command execution (b Busy = TRUE) this output retains the value it had before the command was called. This makes the output suitable for direct process data processing during normal operation of the terminal. Interfering states during configuration and reading through the register communication are hidden. i Data In1 UINT Corresponds to the data variable of the process data st In Data.arr Data In[1], see VAR_IN_OUT. During command execution (b Busy = TRUE) this output retains the value it had before the command was called. This makes the output suitable for direct process data processing during normal operation of the terminal. Interfering states during configuration and reading through the register communication are hidden. i Data In UDINT Corresponds to the data variable of the process data st In Data.i Data In, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output retains the value it had before the command was called. This makes the output suitable for direct process data processing during normal operation of the terminal. Interfering states during configuration and reading through the register communication are hidden. i Terminal Type WORD Contents of register 8 (terminal name). When used with the correct terminal, the content should be 0x05DD (1501dec). i Special Type WORD Contents of register 29 (special version) i Firmware Version WORD Contents of register 9 (firmware version) s Description STRING Terminal name, special version and firmware version as string (e.g. 'terminal KL1501-0000 / firmware 1C'). s Counter Type STRING Set counter type in plain text. b Backward Counting BOOL TRUE: The counting direction was reversed. Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL1501 Tc2_Io Functions from v3.3.5.0 TE1000 Version: 1.5.3 55
## Page 56

Function blocks 3.6.2 FB_KL27x1Config The FB_KL27x1Config function block is used to parameterize a KL2751 / KL2761: 1-channel dimmer terminal. Inputs VAR_INPUT b Configurate : BOOL; b Read Config : BOOL; b Set Dim Ramp Absolute : BOOL; i Set Ramp Time : INT; b Set Watchdog Disable : BOOL; i Set Watchdog Timeout : UINT; i Set Timeout On Value : UINT; i Set Timeout Off Value : UINT; i Set Dimmer Mode : INT; b Set On After Short Circuit : BOOL; b Set Line Frequency60Hz : BOOL; t Timeout : TIME; END_VAR Name Type Description b Configurate BOOL A rising edge starts the configuration sequence. First, the general terminal data, i.e. "terminal name", "special version" and "firmware version", are read. Then, the specified settings are written to the corresponding registers and finally read again for verification and information. The read information is displayed at the function block outputs. During this sequence the output b Busy is TRUE, and no further command, e.g. b Read Config, is accepted. b Read Config BOOL A rising edge starts a read sequence. The general terminal data “terminal name”, “special version” and “firmware version” are read, followed by the set configuration parameters. The read information is displayed at the function block outputs. During the read sequence the output b Busy is TRUE, and no further command, e.g. b Configurate, is accepted. b Set Dim Ramp Absol BOOL FALSE: The set ramp time i Set Ramp Time refers to the ute complete data area (0 - 32767). The smaller the discontinuity, the shorter the ramp time. TRUE: Each switching step, whatever the size, requires the same time, as entered under i Set Ramp Time. i Set Ramp Time INT Ramp time input. The setting is based on the table below. b Set Watchdog Disab BOOL The internal watchdog is disabled. le 56 Version: 1.5.3 TE1000
## Page 57

Function blocks Name Type Description i Set Watchdog Timeo ÚINT Setting the watchdog time as a multiple of 10 ms. ut i Set Timeout On Value UINT This input specifies the light value that is output when a fieldbus error occurs with current process data > 0. i Set Timeout Off Value UINT This input specifies the light value that is output when a fieldbus error occurs with current process data = 0. i Set Dimmer Mode INT This input is used to set the dimmer mode. The setting is based on the table below. b Set On After Short Cir BOOL FALSE: After a short circuit the light remains switched off. cuit TRUE: The light is switched on again after a short circuit. b Set Line Frequency6 BOOL FALSE: Mains frequency = 50 Hz. TRUE: Mains frequency 0Hz = 60 Hz. t Timeout TIME The terminal configuration or reading of the configuration must be completed within the time entered here. Otherwise an error with a corresponding error number is issued at the outputs b Error and i Error Id. i Set Ramp Time Element 0 50 ms 1 100 ms 2 200 ms 3 500 ms 4 1 s 5 2 s 6 5 s 7 10 s i Set Dimmer Mode Element 0 Automatic detection 1 Trailing edge phase control 2 Leading edge phase control 3 Rectifier mode, positive (positive half-wave with leading edge phase control) 4 Rectifier mode, negative (negative half-wave with leading edge phase control) Inputs/outputs VAR_IN_OUT st In Data : ST_KL1501In Data; st Out Data : ST_KL1501Out Data; END_VAR Name Type Description st In Data ST_KL1501In Data [} 147] Reference to the structure of the input process image. st Out Data ST_KL1501Out Data [} 147] Reference to the structure of the output process image. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; i Error Id : UDINT; i State : USINT; i Terminal Type : WORD; i Special Type : WORD; i Firmware Version : WORD; s Description : STRING; TE1000 Version: 1.5.3 57
## Page 58

Function blocks b Dim Ramp Absolute : BOOL; s Ramp Time : STRING; b Watchdog Disable : BOOL; t Watchdog Timeout : TIME; i Timeout On Value : UINT; i Timeoput Off Value : UINT; s Dimmer Mode : STRING; a After Short Circiut: STRING; s Line Frequency : STRING; END_VAR Name Type Description b Busy BOOL As long as the read or configuration sequence is in progress, this output is TRUE. b Error BOOL This output is switched to TRUE, if an error occurred while a command (Configure or Read) is executed. The command-specific error code is contained in i Error Id. i Error Id UDINT Contains the command-specific error code of the most recently executed command. It is reset to 0 by activating the function block again via the inputs b Configurate or b Read Config. See error codes [} 155]. i State USINT Corresponds to the status variable of the process data st In Data.i State, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output is set to 0. This output is therefore suitable for assessing the status of the terminal in normal operation. Interfering states during configuration and reading through the register communication are hidden. i Terminal Type WORD Contents of register 8 (terminal name). When used with the correct terminal, the content should be 0x05DD (1501dec). i Special Type WORD Contents of register 29 (special version) i Firmware Version WORD Contents of register 9 (firmware version) s Description STRING Terminal name, special version and firmware version as string (e.g. 'terminal KL1501-0000 / firmware 1C'). b Dim Ramp Absolute BOOL TRUE: The dimming ramp is set absolute, i.e. each switching step requires the same ramp time, as specified under i Set Ramp Time. s Ramp Time STRING Set ramp time in plain text. b Watchdog Disable BOOL TRUE: Watchdog is disabled. t Watchdog Timeout TIME Set watchdog time. i Timeout On Value UINT Set light value, which is output when a fieldbus error occurs with current process data > 0. i Timeout Off Value UINT Set light value, which is output when a fieldbus error occurs with current process data = 0. s Dimmer Mode STRING Set dimmer mode in plain text. s After Short Circuit STRING Set behaviour after short circuit in plain text. s Line Frequency STRING Set mains frequency in plain text. Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL2751, KL2761 Tc2_Io Functions from v3.3.5.0 58 Version: 1.5.3 TE1000
## Page 59

Function blocks 3.6.3 FB_KL320x Config The FB_KL320x Config function block is used to parameterize a KL3201, KL3202 or KL3204: input terminal for resistance sensors. The function block only parameterizes one terminal channel. For parameterizing all channels, the corresponding number of function blocks has to be instantiated. A mixed configuration (e.g. different sensor types) is possible. Inputs VAR_INPUT b Configurate : BOOL; b Read Config : BOOL; i Set Sensor Type : INT; t Timeout : TIME; END_VAR Name Type Description b Configurate BOOL A rising edge starts the configuration sequence. First, the general terminal data, i.e. "terminal name", "special version" and "firmware version", are read. Then, the specified settings are written to the corresponding registers and finally read again for verification and information. The read information is displayed at the function block outputs. During this sequence the output b Busy is TRUE, and no further command, e.g. b Read Config, is accepted. b Read Config BOOL A rising edge starts a read sequence. The general terminal data “terminal name”, “special version” and “firmware version” are read, followed by the set configuration parameters. The read information is displayed at the function block outputs. During the read sequence the output b Busy is TRUE, and no further command, e.g. b Configurate, is accepted. i Set Sensor Type INT This input is used to set the sensor. The setting is based on the table below. t Timeout TIME The terminal configuration or reading of the configuration must be completed within the time entered here. Otherwise an error with a corresponding error number is issued at the outputs b Error and i Error Id. i Set Sensor Type Element 0 PT100 1 NI100 2 PT1000 3 PT500 4 PT200 5 NI1000 TE1000 Version: 1.5.3 59
## Page 60

Function blocks i Set Sensor Type Element 6 NI120 7 Output 10.0 Ω – 5000.0 Ω 8 Output 10.0 Ω – 1200.0 Ω 9 PT1000 - two-wire connection - not permitted when using a KL3204! Inputs/outputs VAR_IN_OUT st In Data : ST_KL1501In Data; st Out Data : ST_KL1501Out Data; END_VAR Name Type Description st In Data ST_KL1501In Data [} 147] Reference to the structure of the input process image. st Out Data ST_KL1501Out Data [} 147] Reference to the structure of the output process image. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; i Error Id : UDINT; i State : USINT; i Data In : INT; i Terminal Type : WORD; i Special Type : WORD; i Firmware Version : WORD; s Description : STRING; s Sensor Type : STRING; b Two Wired Connection : BOOL; END_VAR Name Type Description b Busy BOOL As long as the read or configuration sequence is in progress, this output is TRUE. b Error BOOL This output is switched to TRUE, if an error occurred while a command (Configure or Read) is executed. The command-specific error code is contained in i Error Id. i Error Id UDINT Contains the command-specific error code of the most recently executed command. It is reset to 0 by activating the function block again via the inputs b Configurate or b Read Config. See error codes [} 155]. i State USINT Corresponds to the status variable of the process data st In Data.i State, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output is set to 0. This output is therefore suitable for assessing the status of the terminal in normal operation. Interfering states during configuration and reading through the register communication are hidden. i Data In UDINT Corresponds to the data variable of the process data st In Data.i Data In, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output retains the value it had before the command was called. This makes the output suitable for direct process data processing during normal operation of the terminal. Interfering states during configuration and reading through the register communication are hidden. i Terminal Type WORD Contents of register 8 (terminal name). When used with the correct terminal, the content should be 0x05DD (1501dec). i Special Type WORD Contents of register 29 (special version) 60 Version: 1.5.3 TE1000
## Page 61

Function blocks Name Type Description i Firmware Version WORD Contents of register 9 (firmware version) s Description STRING Terminal name, special version and firmware version as string (e.g. 'terminal KL1501-0000 / firmware 1C'). s Sensor Type STRING Set sensor type in plain text. b Two Wired Connecti BOOL Sensor type is parameterized in the 2-wire connection. on Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3201, KL3202, KL3204 Tc2_Io Functions from v3.3.5.0 3.6.4 FB_KL3208Config The FB_KL3208Config function block is used to parameterize a KL3208-0010: 8-channel input terminal for resistance sensors. The function block only parameterizes one terminal channel. For parameterizing all channels, the corresponding number of function blocks has to be instantiated. A mixed configuration (e.g. different sensor types) is possible. Inputs VAR_INPUT b Configurate : BOOL; b Read Config : BOOL; i Set Sensor Type : INT; t Timeout : TIME; END_VAR Name Type Description b Configurate BOOL A rising edge starts the configuration sequence. First, the general terminal data, i.e. "terminal name", "special version" and "firmware version", are read. Then, the specified settings are written to the corresponding registers and finally read again for verification and information. The read information is displayed at the function block outputs. During this sequence the output b Busy is TRUE, and no further command, e.g. b Read Config, is accepted. b Read Config BOOL A rising edge starts a read sequence. The general terminal data “terminal name”, “special version” and “firmware version” are read, followed by the set configuration parameters. The read information is displayed at the function block outputs. During the read sequence the output b Busy is TRUE, and no further command, e.g. b Configurate, is accepted. TE1000 Version: 1.5.3 61
## Page 62

Function blocks Name Type Description i Set Sensor Type INT This input is used to set the sensor. The setting is based on the table below. t Timeout TIME The terminal configuration or reading of the configuration must be completed within the time entered here. Otherwise an error with a corresponding error number is issued at the outputs b Error and i Error Id. i Set Sensor Type Element 0 PT1000 1 NI1000 2 RSNI1000 (NI1000 according to Landis&Staefa characteristics: 1000 Ω at 0 °C and 1500 Ω at 100 °C). 3 NTC1K8 4 NTC1K8_TK 5 NTC2K2 6 NTC3K 7 NTC5K 8 NTC10K 9 NTC10KPRE 10 NTC10K_3204 11 NTC10KTYP2 12 NTC10KTYP3 13 NTC10KDALE 14 NTC10K3A221 15 NTC20K 16 Potentiometer, resolution 0.1 Ω 17 Potentiometer, resolution 1 Ω 18 NTC100K Inputs/outputs VAR_IN_OUT st In Data : ST_KL1501In Data; st Out Data : ST_KL1501Out Data; END_VAR Name Type Description st In Data ST_KL1501In Data [} 147] Reference to the structure of the input process image. st Out Data ST_KL1501Out Data [} 147] Reference to the structure of the output process image. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; i Error Id : UDINT; i State : USINT; i Data In : INT; i Terminal Type : WORD; i Special Type : WORD; i Firmware Version : WORD; s Description : STRING; s Sensor Type : STRING; END_VAR Name Type Description b Busy BOOL As long as the read or configuration sequence is in progress, this output is TRUE. 62 Version: 1.5.3 TE1000
## Page 63

Function blocks Name Type Description b Error BOOL This output is switched to TRUE, if an error occurred while a command (Configure or Read) is executed. The command-specific error code is contained in i Error Id. i Error Id UDINT Contains the command-specific error code of the most recently executed command. It is reset to 0 by activating the function block again via the inputs b Configurate or b Read Config. See error codes [} 155]. i State USINT Corresponds to the status variable of the process data st In Data.i State, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output is set to 0. This output is therefore suitable for assessing the status of the terminal in normal operation. Interfering states during configuration and reading through the register communication are hidden. i Data In UDINT Corresponds to the data variable of the process data st In Data.i Data In, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output retains the value it had before the command was called. This makes the output suitable for direct process data processing during normal operation of the terminal. Interfering states during configuration and reading through the register communication are hidden. i Terminal Type WORD Contents of register 8 (terminal name). When used with the correct terminal, the content should be 0x05DD (1501dec). i Special Type WORD Contents of register 29 (special version) i Firmware Version WORD Contents of register 9 (firmware version) s Description STRING Terminal name, special version and firmware version as string (e.g. 'terminal KL1501-0000 / firmware 1C'). s Sensor Type STRING Set sensor type in plain text. Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3201, KL3202, KL3204 Tc2_Io Functions from v3.3.5.0 3.6.5 FB_KL3228Config The FB_KL3228Config function block is used to parameterize a KL3228: 8-channel input terminal for resistance sensors. The function block only parameterizes one terminal channel. For parameterizing all channels, the corresponding number of function blocks has to be instantiated. A mixed configuration (e.g. different sensor types) is possible. TE1000 Version: 1.5.3 63
## Page 64

Function blocks Inputs VAR_INPUT b Configurate : BOOL; b Read Config : BOOL; i Set Sensor Type : INT; t Timeout : TIME; END_VAR Name Type Description b Configurate BOOL A rising edge starts the configuration sequence. First, the general terminal data, i.e. "terminal name", "special version" and "firmware version", are read. Then, the specified settings are written to the corresponding registers and finally read again for verification and information. The read information is displayed at the function block outputs. During this sequence the output b Busy is TRUE, and no further command, e.g. b Read Config, is accepted. b Read Config BOOL A rising edge starts a read sequence. The general terminal data “terminal name”, “special version” and “firmware version” are read, followed by the set configuration parameters. The read information is displayed at the function block outputs. During the read sequence the output b Busy is TRUE, and no further command, e.g. b Configurate, is accepted. i Set Sensor Type INT This input is used to set the sensor. The setting is based on the table below. t Timeout TIME The terminal configuration or reading of the configuration must be completed within the time entered here. Otherwise an error with a corresponding error number is issued at the outputs b Error and i Error Id. i Set Sensor Type Element 0 PT1000 1 NI1000 2 RSNI1000 (NI1000 according to Landis&Staefa characteristics: 1000 Ω at 0 °C and 1500 Ω at 100 °C). Inputs/outputs VAR_IN_OUT st In Data : ST_KL1501In Data; st Out Data : ST_KL1501Out Data; END_VAR Name Type Description st In Data ST_KL1501In Data [} 147] Reference to the structure of the input process image. st Out Data ST_KL1501Out Data [} 147] Reference to the structure of the output process image. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; i Error Id : UDINT; i State : USINT; i Data In : INT; i Terminal Type : WORD; i Special Type : WORD; i Firmware Version : WORD; s Description : STRING; s Sensor Type : STRING; END_VAR 64 Version: 1.5.3 TE1000
## Page 65

Function blocks Name Type Description b Busy BOOL As long as the read or configuration sequence is in progress, this output is TRUE. b Error BOOL This output is switched to TRUE, if an error occurred while a command (Configure or Read) is executed. The command-specific error code is contained in i Error Id. i Error Id UDINT Contains the command-specific error code of the most recently executed command. It is reset to 0 by activating the function block again via the inputs b Configurate or b Read Config. See error codes [} 155]. i State USINT Corresponds to the status variable of the process data st In Data.i State, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output is set to 0. This output is therefore suitable for assessing the status of the terminal in normal operation. Interfering states during configuration and reading through the register communication are hidden. i Data In UDINT Corresponds to the data variable of the process data st In Data.i Data In, see VAR_IN_OUT. During command execution (b Busy = TRUE) this output retains the value it had before the command was called. This makes the output suitable for direct process data processing during normal operation of the terminal. Interfering states during configuration and reading through the register communication are hidden. i Terminal Type WORD Contents of register 8 (terminal name). When used with the correct terminal, the content should be 0x05DD (1501dec). i Special Type WORD Contents of register 29 (special version) i Firmware Version WORD Contents of register 9 (firmware version) s Description STRING Terminal name, special version and firmware version as string (e.g. 'terminal KL1501-0000 / firmware 1C'). s Sensor Type STRING Set sensor type in plain text. Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3201, KL3202, KL3204 Tc2_Io Functions from v3.3.5.0 3.7 CANopen 3.7.1 IOF_CAN_Layer2Command The IOF_CAN_Layer2Command function block sends a 10-byte command to layer 2 of a CAN master. TE1000 Version: 1.5.3 65
## Page 66

Function blocks Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; BOXADDR : WORD; START : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the function is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT Device Id specifies the device (CAN master) on which the function is to be executed. The device IDs are specified by the Twin CAT system during the hardware configuration. LEN UDINT The length of the layer 2 command in bytes. SRCADDR PVOID The address of the first data word in the CAN layer 2 command. START BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Sample: PROGRAM MAIN VAR IOF_CAN_Layer2Command1 : IOF_CAN_Layer2Command; Layer2Data : ARRAY[1..5] OF WORD; Start Layer2 : BOOL; Layer2_Busy : BOOL; Layer2_Err : BOOL; Layer2_Err Id : UDINT; END_VAR Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. 66 Version: 1.5.3 TE1000
## Page 67

Function blocks Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 None. This HILSCHER Tc2_Io Functions (IO) functionality is CIF3xx COM not supported master card by Twin CAT 3 at present! 3.8 NOV/DP-RAM 3.8.1 FB_Nov Ram Read Write The following description refers to Twin CAT Version 2.8. From Twin CAT version 2.9 [Build 927], a function block for writing or reading PLC data to be saved in NOVRAM is no longer required. The FB_Nov Ram Read Write function block accesses the NOV-RAM of the FCxxxx-0002 fieldbus cards from a PLC program. A rising edge at the b Read or b Write input activates the function block and a corresponding number of data bytes are read from or written to the NOV-RAM. If both inputs, b Read and b Write, are set simultaneously, the data are first written into the NOV-RAM and then read back. Comments: To determine the NOV-RAM address pointer, the FB_Nov Ram Read Write function block internally uses an instance of the ADSREAD function block. This address pointer is only determined when the FB_Nov Ram Read Write function block is called for the first time or in the event of a change in n Dev Id. Several PLC cycles are required for this. The MEMCPY function is used to write data into the NOV-RAM or to read data from the NOV-RAM. This enables data to be written or read in the same PLC cycle. Internally the maximum byte length of the NOV-RAM is also determined, and the maximum data length that can be read or written is limited to this length. Inputs VAR_INPUT n Dev Id : UDINT; b Read : BOOL; b Write : BOOL; cb Src Len : UDINT; cb Dest Len : UDINT; p Src Addr : PVOID; p Dest Addr : PVOID; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description n Dev Id UDINT The device ID of a NOVRAM card. The ID is used to specify the NOVRAM of an FCxxxx-0002 card that is to be accessed for writing or reading with the function block. The device IDs are specified by the Twin CAT system during the hardware configuration. TE1000 Version: 1.5.3 67
## Page 68

Function blocks Name Type Description b Read BOOL A positive edge at this input activates the function block and cb Dest Len data is copied from the NOVRAM (from address offset NULL) into the buffer with the address p Dest Addr. b Write BOOL A positive edge at this input activates the function block and copies cb Src Len data from the buffer with the address p Src Addr into the NOVRAM (from address offset NULL). cb Src Len UDINT The byte length of the data to be written to the NOVRAM. cb Dest Len UDINT The byte length of the data to be read from the NOVRAM. p Src Addr PVOID The address pointer to a data buffer containing the data to be written into the NOV-RAM. The address pointer can be determined via the ADR operator. p Dest Addr PVOID The address pointer to a data buffer into which the read NOV-RAM data is to be copied. t Time Out TIME Specifies the time-out period that must not be exceeded when executing the command/function. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; cb Read : UDINT; cb Write : UDINT; END_VAR Name Type Description b Busy BOOL This output is set when the function block is activated, and remains set until execution has been completed. b Error BOOL This output is set if an error occurs during execution. n Err Id UDINT Returns the ADS error number [} 156] when the b Error output is set. cb Read UDINT Number of successfully read data bytes. cb Write UDINT Number of successfully written data bytes. Sample: PROGRAM MAIN VAR fb Nov Ram Read Write : FB_Nov Ram Read Write; b Read : BOOL; b Write : BOOL; from Nov Ram : ARRAY[1..100] OF BYTE; to Nov Ram : ARRAY[1..100] OF BYTE; b Busy : BOOL; b Error : BOOL; n Err ID : UDINT; cb Read : UDINT; cb Write : UDINT; END_VAR 68 Version: 1.5.3 TE1000
## Page 69

Function blocks In the sample, a rising edge at the b Read input reads 100 bytes of data from the NOV-RAM and copies them into the from Nov Ram array. Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) FCxxxx cards with Tc2_Io Functions (IO) NOVRAM (FCxxxx-0002) 3.8.2 FB_Nov Ram Read Write Ex The FB_Nov Ram Read Write Ex function block accesses the NOV-RAM (e.g. of the FCxxxx-0002 fieldbus cards, CX9000 NOVRAM, etc.) from a PLC program. A rising edge at the b Read or b Write input activates the function block and a corresponding number of data bytes are read from the NOV-RAM or written to the NOVRAM. If both inputs: b Read and b Write are set at the same time, the data is first written to the NOVRAM and then read back. The difference to the FB_Nov Ram Read Write function block is that the address offset can be specified in the NOVRAM for write and read accesses. The function block also checks the permitted type of access to the NOVRAM memory and, if necessary, copies the data byte by byte into the NOVRAM memory instead of using a MEMCPY. The NOVRAM of the CX9000 only allows byte accesses, for example, and the FB_Nov Ram Read Write function block would return an error in this case. Comments: To determine the address pointer to the NOVRAM, an instance of the ADSREAD function block is used internally by the FB_Nov Ram Read Write Ex function block. However, this address pointer is only redetermined the first time the FB_Nov Ram Read Write Ex function block is called and when n Dev Id is changed. Several PLC cycles are required for this. The NOVRAM memory is accessed directly for writing data to or reading data from the NOVRAM. This enables data to be written or read in the same PLC cycle. The maximum byte length of the NOVRAM is also determined internally and the maximum length of the data that can be read or written is limited to this length. Inputs VAR_INPUT n Dev Id : UDINT; b Read : BOOL; b Write : BOOL; cb Src Len : UDINT; cb Dest Len : UDINT; p Src Addr : PVOID; p Dest Addr : PVOID; n Read Offs : UDINT; n Write Offs : UDINT; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR TE1000 Version: 1.5.3 69
## Page 70

Function blocks Name Type Description n Dev Id UDINT The device ID of a NOVRAM card. The ID is used to specify the NOVRAM of an FCxxxx-0002 card that is to be accessed for writing or reading with the function block. The device IDs are specified by the Twin CAT system during the hardware configuration. b Read BOOL A positive edge at this input activates the function block and cb Dest Len data is copied from the NOVRAM (from address offset NULL) into the buffer with the address p Dest Addr. b Write BOOL A positive edge at this input activates the function block and copies cb Src Len data from the buffer with the address p Src Addr into the NOVRAM (from address offset NULL). cb Src Len UDINT The byte length of the data to be written to the NOVRAM. cb Dest Len UDINT The byte length of the data to be read from the NOVRAM. p Src Addr PVOID The address pointer to a data buffer containing the data to be written into the NOV-RAM. The address pointer can be determined via the ADR operator. p Dest Addr PVOID The address pointer to a data buffer into which the read NOV-RAM data is to be copied. n Read Offs UDINT The address offset in the NOVRAM from which data are to be read. n Write Offs UDINT The address offset in the NOVRAM from which data are to be written. t Time Out TIME Specifies the time-out period that must not be exceeded when executing the command/function. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; cb Read : UDINT; cb Write : UDINT; END_VAR Name Type Description b Busy BOOL This output is set when the function block is activated, and remains set until execution has been completed. b Error BOOL This output is set if an error occurs during execution. n Err Id UDINT Returns the ADS error number [} 156] when the b Error output is set. cb Read UDINT Number of successfully read data bytes. cb Write UDINT Number of successfully written data bytes. Sample: PROGRAM MAIN VAR fb Nov Ram Read Write : FB_Nov Ram Read Write Ex; b Read : BOOL; b Write : BOOL; from Nov Ram : ARRAY[1..100] OF BYTE; to Nov Ram : ARRAY[1..100] OF BYTE; b Busy : BOOL; b Error : BOOL; n Err ID : UDINT; cb Read : UDINT; cb Write : UDINT; read Offs : UDINT :=0; write Offs : UDINT:=0; 70 Version: 1.5.3 TE1000
## Page 71

Function blocks cb To Write : UDINT := 100; cb To Read : UDINT := 100; END_VAR In the sample, a rising edge at the b Read input reads 100 bytes of data from the NOV-RAM and copies them into the from Nov Ram array. Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) FCxxxx cards with Tc2_Io Functions (IO) NOVRAM (FCxxxx-0002) 3.8.3 FB_Get DPRAMInfo The FB_Get DPRAMInfo function block determines the address pointer and the configured size of the NOV/ DP-RAM of a fieldbus card. The address pointer can be used, for example, for direct write or read access of the NOV-RAM of the FCxxx-0002 (Beckhoff) cards or the DPRAM of cards that are not supported by Twin CAT (third-party manufacturers). First, the card has to be configured as general NOV/DP-RAM within the Twin CAT system. The MEMCPY, MEMSET or MEMCMP functions of the PLC program can then be used for write/read access to any memory offset. This function block returns a Service Not Supported error (16#701) if the NOV/DP-RAM requires a special access method (e.g. BYTE, aligned WORD). In this case, the FB_Nov Ram Read Write Ex function block can be used to read data from the NOV/DP-RAM or to write data to the NOV/DP-RAM. For example, the NOV- RAM of the CX9000 only allows BYTE accesses, so that the FB_Nov Ram Read Write Ex function block should be used in this case. Inputs VAR_INPUT n Dev Id : UDINT; b Execute : BOOL; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description n Dev Id UDINT The device ID of a NOV/DPRAM card. The ID is used to specify the card from which information is to be read. The device IDs are specified by the Twin CAT system during the hardware configuration. TE1000 Version: 1.5.3 71
## Page 72

Function blocks Name Type Description b Execute BOOL The function block is activated on a positive edge at this input. t Time Out TIME Specifies the time-out period that must not be exceeded when executing the command/function. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; st Info : ST_Nov Ram Addr Info; END_VAR Name Type Description b Busy BOOL This output is set when the function block is activated, and remains set until execution has been completed. b Error BOOL This output is set if an error occurs during execution. n Err Id UDINT Returns the ADS error number [} 156] when the b Error output is set. st Info ST_Nov Ram Addr Info A structure with the address and size of the NOV/DP-RAM. [} 135] Sample: A pointer to an instance of the ST_NOVRAM structure variable is declared in MAIN. This pointer is initialized with the address of the NOV/DP-RAM at the start of the program. By referencing the pointer, the individual structure elements (and the NOV/DP-RAM) can be accessed for writing or reading. TYPE ST_NOVRAM : STRUCT dw Param_0 : DWORD; dw Param_1 : DWORD; dw Param_2 : DWORD; dw Param_3 : DWORD; cb Size : DWORD; w Counter : WORD; func : BYTE; s Msg : STRING(20); (* ...other NOV-/DP-RAM variables *) END_STRUCT END_TYPE PROGRAM MAIN VAR p NOVRAM : POINTER TO ST_NOVRAM; cb NOVRAM : DWORD; fb Get Info : FB_Get DPRAMInfo; state : INT := 0; b Init : BOOL := FALSE; timer : TON; b Reset : BOOL; END_VAR CASE state OF 0: IF NOT b Init THEN state := 1; END_IF 1: fb Get Info( b Execute := FALSE ); (* reset fb *) fb Get Info( n Dev Id:= 3, b Execute:= TRUE, (* start fb execution *) t Time Out:= T#10s ); state := 2; 2: fb Get Info( b Execute := FALSE ); IF NOT fb Get Info.b Busy THEN 72 Version: 1.5.3 TE1000
## Page 73

Function blocks IF NOT fb Get Info.b Error THEN IF fb Get Info.st Info.p Card Address <> 0 THEN p NOVRAM := fb Get Info.st Info.p Card Address; cb NOVRAM := fb Get Info.st Info.i Card Mem Size; b Init := TRUE; state := 0; (* ready, go to the idle step *) ELSE state := 100; (* error *) END_IF ELSE state := 100; (* error *) END_IF END_IF 100: ; (* error, stay here *) END_CASE IF b Init THEN (* read from or write to NOV-/DP-RAM*) IF b Reset THEN (* reset all bytes to 0 *) b Reset := FALSE; MEMSET( p NOVRAM, 0, cb NOVRAM ); END_IF timer( IN := TRUE, PT := T#1s ); IF timer. Q THEN timer( IN := FALSE ); p NOVRAM^.dw Param_0 := p NOVRAM^.dw Param_0 + 1; p NOVRAM^.dw Param_1 := p NOVRAM^.dw Param_1 - 1; END_IF END_IF Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) FCxxxx cards with Tc2_Io Functions (IO) NOVRAM (FCxxxx-0002) 3.8.4 FB_Get DPRAMInfo Ex The FB_Get DPRAMInfo Ex function block determines the address pointer and the configured size of the NOV/DP-RAM of a fieldbus card. The address pointer can be used, for example, for direct write or read access of the NOV-RAM of the Fcxxx-0002 (Beckhoff) cards or the DPRAM of cards that are not supported by Twin CAT (third-party manufacturers). First, the card has to be configured as general NOV/DP-RAM within the Twin CAT system. Along with the address (p Card Address) and the size (i Card Mem Size) of the NOV/DP-RAM the st Info output also returns the type of access (e Access Type). If the NOV/DP-RAM does not require special access (BYTE or WORD aligned), the MEMCPY, MEMSET or MEMCMP functions can be used in the PLC program to be able to have read/write access to a random memory offset. If the NOV/DP-RAM requires special access (BYTE or WORD aligned), then access is only possible with the appropriate data size. For this purpose use FB_Nov Ram Read Write Ex. Inputs VAR_INPUT n Dev Id : UDINT; b Execute : BOOL; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR TE1000 Version: 1.5.3 73
## Page 74

Function blocks Name Type Description n Dev Id UDINT The device ID of a NOV/DPRAM card. The ID is used to specify the card from which information is to be read. The device IDs are specified by the Twin CAT system during the hardware configuration. b Execute BOOL The function block is activated on a positive edge at this input. t Time Out TIME Specifies the time-out period that must not be exceeded when executing the command/function. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; st Info : ST_Nov Ram Addr Info Ex; END_VAR Name Type Description b Busy BOOL This output is set when the function block is activated, and remains set until execution has been completed. b Error BOOL This output is set if an error occurs during execution. n Err Id UDINT Returns the ADS error number [} 156] when the b Error output is set. st Info ST_Nov Ram Addr Info Ex A structure with the address and size of the NOV/DP-RAM. [} 136] Example In MAIN a pointer to a BYTE is declared. This pointer is initialized with the address of the NOV/DP-RAM at the start of the program. Referencing the pointer makes read/write access to the NOV/DP-RAM possible. PROGRAM MAIN VAR n Dev Id : UDINT := 1; //device 1, see ID of NOV/DP-RAM device p NOVRAM : POINTER TO BYTE; cb NOVRAM : DWORD; fb Get Info : FB_Get DPRAMInfo Ex; b Init : BOOL := FALSE; e Access Type : E_IOACCESSTYPE; b Byte Access : BOOL; b Word Access : BOOL; b DWord Access : BOOL; END_VAR IF NOT b Init THEN fb Get Info( n Dev Id := n Dev Id, b Execute := TRUE, t Time Out := T#5S ); IF NOT fb Get Info.b Busy THEN IF NOT fb Get Info.b Error THEN p NOVRAM := fb Get Info.st Info.p Card Address; cb NOVRAM := fb Get Info.st Info.i Card Mem Size; e Access Type := fb Get Info.st Info.e Access Type; b DWord Access := FALSE; b Byte Access := FALSE; b Word Access := FALSE; CASE e Access Type OF e IOAccess_Default: b DWord Access := TRUE; //access via MEMCPY, MEMSET, MEMCMP possible e IOAccess_Byte: b Byte Access := TRUE; //access via POINTER to BYTE possible 74 Version: 1.5.3 TE1000
## Page 75

Function blocks e IOAccess_Word Swap: b Word Access := TRUE; //access via POINTER to WORD + //swapping of high and low byte possible END_CASE b Init := TRUE; END_IF fb Get Info(b Execute := FALSE); END_IF END_IF Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) FCxxxx cards with Tc2_Io Functions (IO) NOVRAM (FCxxxx-0002) 3.9 Profibus DPV1 (Sinamics) 3.9.1 F_Create Dpv1Read Req Pkg The F_Create Dpv1Read Req Pkg function generates a DPV1 telegram for a FB_Dpv1Read [} 78] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1). As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Create Dpv1Read Req Pkg : USINT Inputs VAR_INPUT p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE;(* DPV1 read request *) i Num Of Params : USINT; (* 1..39; else: reserved *) i Drive Id : USINT; END_VAR Name Type Description p Dpv1Req Data ARRAY OF BYTE Pointer to an array of 240 bytes containing the DPV1 read telegram. This telegram is created by the function. i Num Of Params USINT Number of parameters to be read (1 to 39). A further limitation is the telegram size of 240 bytes. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) END_VAR TE1000 Version: 1.5.3 75
## Page 76

Function blocks Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters to be added to the DPV1 read telegram. [} 134] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731 3.9.2 F_Create Dpv1Write Req Pkg The F_Create Dpv1Write Req Pkg function generates a DPV1 telegram for a FB_Dpv1Write [} 81] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1). As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Create Dpv1Write Req Pkg : USINT Inputs VAR_INPUT p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE;(* DPV1 read request *) i Num Of Params : USINT; (* 1..39; else: reserved *) i Drive Id : USINT; END_VAR Name Type Description p Dpv1Req Data ARRAY OF BYTE Pointer to an array of 240 bytes containing the DPV1 write telegram. This telegram is created by the function. i Num Of Params USINT Number of parameters to be written (1 to 39). A further limitation is the telegram size of 240 bytes. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) st Dpv1Value Header Ex : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Value Header Ex;(* list of values *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters to be added to the DPV1 read telegram. [} 134] st Dpv1Value Header ST_Dpv1Value Header Ex Array of 39 parameter values to be added to the DPV1 Ex write telegram. [} 135] 76 Version: 1.5.3 TE1000
## Page 77

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731 3.9.3 F_Split Dpv1Read Res Pkg The F_Split Dpv1Read Res Pkg function evaluates a DPV1 telegram of a FB_Dpv1Read [} 78] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1). As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Split Dpv1Read Res Pkg : USINT Inputs VAR_INPUT p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; (* DPV1 read response *) END_VAR Name Type Description p Dpv1Res Data ARRAY OF BYTE Pointer to an array of 240 bytes containing the DPV1 read answer telegram. This telegram is evaluated by the function. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) st Dpv1Value Header Ex : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Value Header Ex;(* list of values *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters that were added to the DPV1 read telegram. [} 134]). st Dpv1Value Header ST_Dpv1Value Header Ex Array of 39 parameter values read from the drive. Ex [} 135] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731 3.9.4 F_Split Dpv1Write Res Pkg TE1000 Version: 1.5.3 77
## Page 78

Function blocks The F_Split Dpv1Write Res Pkg function evaluates a DPV1 telegram of a FB_Dpv1Write [} 81] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1). As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Split Dpv1Write Res Pkg : USINT Inputs VAR_INPUT p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; (* DPV1 read response *) END_VAR Name Type Description p Dpv1Res Data ARRAY OF BYTE Pointer to an array of 240 bytes containing the DPV1 write answer telegram. This telegram is evaluated by the function. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) st Dpv1Value Header Ex : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Value Header Ex;(* list of values *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters that were added to the DPV1 write telegram. [} 134]). st Dpv1Value Header ST_Dpv1Value Header Ex Array of 39 parameter values read from the drive. Ex [} 135] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731 3.9.5 FB_Dpv1Read The FB_Dpv1Read function block reads one or more parameters of a Sinamics Profidrive via DPV1 (Profidrive Specification 3.1). The DPV1 read telegram must be created with F_Create Dpv1Read Req Pkg [} 75] before a rising edge is present at b Execute. The DPV1 answer telegram must be evaluated with F_Split Dpv1Read Res Pkg [} 77] after a falling edge appears at b Busy. The execution of this function block requires some time, depending on the number of parameters to be read. The function block sends the DPV1 telegram and polls for an answer telegram. 78 Version: 1.5.3 TE1000
## Page 79

Function blocks Inputs VAR_INPUT b Execute : BOOL; a Net Id : T_Ams Net Id; (* Net ID of Profibus Master FC310x/EL6731 *) i Profibus Slave Adr : USINT; (* DP address of Profi Drive *) i Drive Id : USINT; (* 1..16 possible *) p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; i Dpv1Req Data Len : UDINT; p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; i Dpv1Res Data Len : UDINT; t Tm Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description b Execute BOOL The function block is enabled by a positive edge at this input. a Net Id T_Ams Net ID The network address of the Profibus master device (see ADS tab of the Profibus master device in the I/O configuration in the Twin CAT system) i Profibus Slave Adr USINT The Profibus slave DP address of the drive. This is an address for several axes, specified in the Twin CAT system in the I/O configuration. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. p Dpv1Req Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 read telegram. This telegram must be created by the F_Create Dpv1Read Req Pkg [} 75] function before the DPV1 read is activated via b Execute. i Dv1Req Data Len UDINT Maximum length of the DPV1 data buffer (240 bytes). p Dpv1Res Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 read answer telegram. This telegram must be evaluated by the F_Split Dpv1Read Res Pkg [} 77] function after a falling edge appears at b Busy. i Dpv1Res Data Len UDINT Maximum length of the DPV1 response data buffer (240 bytes). t Tm Out TIME Maximum time allowed for the execution of the command. Inputs/outputs VAR_OUTPUT i Request Ref : USINT; (* 1..127; 0: reserved *) END_VAR Name Type Description i Ref Request USINT Reference that is automatically incremented with each telegram. The reference is required for the allocation of the responses to the write/read requests. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; b Error Values : BOOL; i Err Id : UDINT; i Error Class : BYTE; i Error Code : BYTE; END_VAR TE1000 Version: 1.5.3 79
## Page 80

Function blocks Name Type Description b Busy BOOL This output goes TRUE as soon as the function block is activated via b Execute and remains TRUE as long as the function block has not received a response. b Error BOOL In case of errors this output goes TRUE and b Busy goes FALSE. b Error Values BOOL TRUE if the DPV1 Read was unsuccessful or only partly successful. The error causes are returned via the error ID (as well as Class and Code). i Err Id UDINT Returns the ADS error number [} 156] or function-block- specific error numbers if b Error = TRUE. i Err Class BYTE Profidrive error class i Err Code BYTE Profidrive error code Function-block-specific error codes Description 0x2 Incorrect response reference 0x3 DPV1 Read faulty or partially faulty 0x4 Incorrect response ID other error IDs See ADS error codes Error classes Description Error code 0x0 - 0x9 Reserved - 0x A Application errors 0x0: read error 0x1: write error 0x2: module error 0x3 - 0x7: reserved 0x8: version conflict 0x9: not supported 0x A - 0x F: user-dependent 0x B Access errors 0x0: invalid index (no data block DB47, parameter access is not supported) 0x1: write length error 0x2: invalid slot 0x3: type conflict 0x4: invalid range 0x5: state conflict (access to DB47 temporarily not possible due to internal process states) 0x6: access denied 0x7: invalid range (write error in DB47 header) 0x8: invalid parameter 0x9: invalid type 0x A - 0x F: user-dependent 0x C Resource errors 0x0: read conflict 0x1: write conflict 0x2: resource busy 0x3: resource not accessible 0x4 - 0x7: reserved 0x8 - 0x F: user-dependent 0x D - 0x F User-defined errors - Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731 80 Version: 1.5.3 TE1000
## Page 81

Function blocks 3.9.6 FB_Dpv1Write The FB_Dpv1Write function block writes one or more parameters of a Sinamics Profidrive via DPV1 (Profidrive Specification 3.1). The DPV1 write telegram must be created with F_Create Dpv1Write Req Pkg [} 76] before a rising edge is present at b Execute. The DPV1 answer telegram must be evaluated with F_Split Dpv1Write Res Pkg [} 77] after a falling edge appears at b Busy. The execution of this function block requires some time, depending on the number of parameters to be read. The function block sends the DPV1 telegram and polls for an answer telegram. Inputs VAR_INPUT b Execute : BOOL; a Net Id : T_Ams Net Id; (* Net ID of Profibus Master FC310x/EL6731 *) i Profibus Slave Adr : USINT; (* DP address of Profi Drive *) i Drive Id : USINT; (* 1..16 possible *) p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; i Dpv1Req Data Len : UDINT; p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; i Dpv1Res Data Len : UDINT; t Tm Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description b Execute BOOL The function block is enabled by a positive edge at this input. a Net Id T_Ams Net ID The network address of the Profibus master device (see ADS tab of the Profibus master device in the I/O configuration in the Twin CAT system) i Profibus Slave Adr USINT The Profibus slave DP address of the drive. This is an address for several axes, specified in the Twin CAT system in the I/O configuration. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. p Dpv1Req Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 write telegram. This telegram must be created by the function F_Create Dpv1Write Req Pkg [} 76] before the DPV1 Read is activated via b Execute. i Dv1Req Data Len UDINT Maximum length of the DPV1 data buffer (240 bytes). p Dpv1Res Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 write answer telegram. This telegram must be evaluated by the function F_Split Dpv1Write Res Pkg [} 77] after a negative edge appears on b Busy. i Dpv1Res Data Len UDINT Maximum length of the DPV1 response data buffer (240 bytes). t Tm Out TIME Maximum time allowed for the execution of the command. TE1000 Version: 1.5.3 81
## Page 82

Function blocks Inputs/outputs VAR_OUTPUT i Request Ref : USINT; (* 1..127; 0: reserved *) END_VAR Name Type Description i Ref Request USINT Reference that is automatically incremented with each telegram. The reference is required for the allocation of the responses to the write/read requests. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; b Error Values : BOOL; i Err Id : UDINT; i Error Class : BYTE; i Error Code : BYTE; END_VAR Name Type Description b Busy BOOL This output goes TRUE as soon as the function block is activated via b Execute and remains TRUE as long as the function block has not received a response. b Error BOOL In case of errors this output goes TRUE and b Busy goes FALSE. b Error Values BOOL TRUE if the DPV1 Read was unsuccessful or only partly successful. The error causes are returned via the error ID (as well as Class and Code). i Err Id UDINT Returns the ADS error number [} 156] or function-block- specific error numbers if b Error = TRUE. i Err Class BYTE Profidrive error class i Err Code BYTE Profidrive error code Function-block-specific error codes Description 0x2 Incorrect response reference 0x3 DPV1 Read faulty or partially faulty 0x4 Incorrect response ID other error IDs See ADS error codes Error classes Description Error code 0x0 - 0x9 Reserved - 0x A Application errors 0x0: read error 0x1: write error 0x2: module error 0x3 - 0x7: reserved 0x8: version conflict 0x9: not supported 0x A - 0x F: user-dependent 0x B Access errors 0x0: invalid index (no data block DB47, parameter access is not supported) 0x1: write length error 0x2: invalid slot 0x3: type conflict 0x4: invalid range 0x5: state conflict (access to DB47 temporarily not possible due to internal process states) 0x6: access denied 0x7: invalid range (write error in DB47 header) 0x8: 82 Version: 1.5.3 TE1000
## Page 83

Function blocks Error classes Description Error code invalid parameter 0x9: invalid type 0x A - 0x F: user-dependent 0x C Resource errors 0x0: read conflict 0x1: write conflict 0x2: resource busy 0x3: resource not accessible 0x4 - 0x7: reserved 0x8 - 0x F: user-dependent 0x D - 0x F User-defined errors - Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731 3.10 Profinet DPV1 (Sinamics) 3.10.1 F_Create Dpv1Read Req Pkg PNET The function F_Create Dpv1Read Req Pkg generates a DPV1 telegram for a FB_Dpv1Read PNET [} 86] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1) that is connected via Profinet. As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Create Dpv1Read Req Pkg PNET : USINT Inputs VAR_INPUT p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE;(* DPV1 read request *) i Num Of Params : USINT; (* 1..39; else: reserved *) i Drive Id : USINT; END_VAR Name Type Description p Dpv1Req Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 read telegram. This telegram must be created by the F_Create Dpv1Read Req Pkg [} 75] function before the DPV1 read is activated via b Execute. i Num Of Params USINT Number of parameters to be read (1 to 39). A further limitation is the telegram size of 240 bytes. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. TE1000 Version: 1.5.3 83
## Page 84

Function blocks Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters to be added to the DPV1 read telegram. [} 134] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 3.10.2 F_Create Dpv1Write Req Pkg PNET The function F_Create Dpv1Write Req Pkg PNET generates a DPV1 telegram for one FB_Dpv1Write PNET [} 89] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1) that is connected via Profinet. As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Create Dpv1Write Req Pkg PNET : USINT Inputs VAR_INPUT p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE;(* DPV1 read request *) i Num Of Params : USINT; (* 1..39; else: reserved *) i Drive Id : USINT; END_VAR Name Type Description p Dpv1Req Data ARRAY OF BYTE Pointer to an array of 240 bytes containing the DPV1 write telegram. This telegram is created by the function. i Num Of Params USINT Number of parameters to be written (1 to 39). A further limitation is the telegram size of 240 bytes. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) st Dpv1Value Header Ex : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Value Header Ex;(* list of values *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters that are to be added to the DPV1 write telegram. [} 134] 84 Version: 1.5.3 TE1000
## Page 85

Function blocks Name Type Description st Dpv1Value Header ST_Dpv1Value Header Ex Array of 39 parameter values to be added to the DPV1 Ex write telegram. [} 135] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 3.10.3 F_Split Dpv1Read Res Pkg PNET The function F_Split Dpv1Read Res Pkg PNET evaluates a DPV1 telegram of a FB_Dpv1Read PNET [} 86] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1) that is connected via Profinet. As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Split Dpv1Read Res Pkg PNET : USINT Inputs VAR_INPUT p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; (* DPV1 read response *) END_VAR Name Type Description p Dpv1Res Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 read answer telegram. This telegram must be evaluated by the function. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) st Dpv1Value Header Ex : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Value Header Ex;(* list of values *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters to be added to the DPV1 read telegram. [} 134] st Dpv1Value Header ST_Dpv1Value Header Ex Array of 39 parameter values to be read by the drive. Ex [} 135] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) TE1000 Version: 1.5.3 85
## Page 86

Function blocks 3.10.4 F_Split Dpv1Write Res Pkg PNET The function F_Split Dpv1Write Res Pkg PNET evaluates a DPV1 telegram of a FB_Dpv1Write PNET [} 89] of one or more parameters of a drive or the controller unit of a Sinamics Profidrive (Profidrive Specification 3.1) that is connected via Profinet. As Profidrives use the Motorola format and IPCs the Intel format, the function automatically swaps the byte order in the DPV1 telegram of parameters with data types with more than one byte. The function returns the actual length of the DPV1 telegram in bytes (max. 240 bytes). FUNCTION F_Split Dpv1Write Res Pkg PNET : USINT Inputs VAR_INPUT p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE] OF BYTE; (* DPV1 read response *) END_VAR Name Type Description p Dpv1Res Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 write answer telegram. This telegram is evaluated by the function. Inputs/outputs VAR_IN_OUT st Dpv1Parameter : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Param Addr Ex;(* list of parameters *) st Dpv1Value Header Ex : ARRAY [1..i MAX_DPV1_PARAMS] OF ST_Dpv1Value Header Ex;(* list of values *) END_VAR Name Type Description st Dpv1Parameter ST_Dpv1Param Addr Ex Array of 39 parameters that are to be added to the DPV1 write telegram. [} 134] st Dpv1Value Header ST_Dpv1Value Header Ex Array of 39 parameter values to be read by the drive. Ex [} 135] Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 3.10.5 FB_Dpv1Read PNET 86 Version: 1.5.3 TE1000
## Page 87

Function blocks The function block FB_Dpv1Read PNET reads one or more parameters of a Sinamics Profidrive via DPV1 (Profidrive specification 3.1) via Profinet. The DPV1 read telegram must be created with F_Create Dpv1Read Req Pkg PNET [} 83] before a rising edge is present at b Execute. The DPV1 answer telegram must be evaluated with F_Split Dpv1Read Res Pkg PNET [} 85], after which b Busy displays a falling edge. The execution of this function block requires some time, depending on the number of parameters to be read. The function block sends the DPV1 telegram and polls for an answer telegram. Inputs VAR_INPUT b Execute : BOOL;(* drive access info *) a Net Id : T_Ams Net Id; (* Net ID of Profibus Master EL6631 *) i Profinet Port : UINT; (* Port of Profi Drive *) i Drive Id : USINT; (* 0..255 possible *) p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE_PNET_REQ] OF BYTE; i Dpv1Req Data Len : UDINT; p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE_PNET_RES] OF BYTE; i Dpv1Res Data Len : UDINT; t Tm Out : TIME; END_VAR Name Type Description b Execute BOOL The function block is enabled by a positive edge at this input. a Net Id T_Ams Net ID The network address of the Profibus master device (see ADS tab of the Profibus master device in the I/O configuration in the Twin CAT system) i Profinet Port UINT The Profinet port number of the drive. This is an address for several axes, specified in the Twin CAT system in the I/ O configuration. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. p Dpv1Req Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 read telegram. This telegram must be created by the F_Create Dpv1Read Req Pkg [} 75] function before the DPV1 read is activated via b Execute. i Dv1Req Data Len UDINT Maximum length of the DPV1 data buffer (240 bytes). p Dpv1Res Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 read answer telegram. This telegram must be evaluated by the F_Split Dpv1Read Res Pkg [} 77] function after a falling edge appears at b Busy. i Dpv1Res Data Len UDINT Maximum length of the DPV1 response data buffer (240 bytes). t Tm Out TIME Maximum time allowed for the execution of the command. Inputs/outputs VAR_OUTPUT i Request Ref : USINT; (* 1..127; 0: reserved *) END_VAR Name Type Description i Ref Request USINT Reference that is automatically incremented with each telegram. The reference is required for the allocation of the responses to the write/read requests. TE1000 Version: 1.5.3 87
## Page 88

Function blocks Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; b Error Values : BOOL; i Err Id : UDINT; i Error Class : BYTE; i Error Code : BYTE; END_VAR Name Type Description b Busy BOOL This output goes TRUE as soon as the function block is activated via b Execute and remains TRUE as long as the function block has not received a response. b Error BOOL In case of errors this output goes TRUE and b Busy goes FALSE. b Error Values BOOL TRUE if the DPV1 Read was unsuccessful or only partly successful. The error causes are returned via the error ID (as well as Class and Code). i Err Id UDINT Returns the ADS error number [} 156] or function-block- specific error numbers if b Error = TRUE. i Err Class BYTE Profidrive error class i Err Code BYTE Profidrive error code Function-block-specific error codes Description 0x2 Incorrect response reference 0x3 DPV1 Read faulty or partially faulty 0x4 Incorrect response ID other error IDs See ADS error codes Error classes Description Error code 0x0 - 0x9 Reserved - 0x A Application errors 0x0: read error 0x1: write error 0x2: module error 0x3 - 0x7: reserved 0x8: version conflict 0x9: not supported 0x A - 0x F: user-dependent 0x B Access errors 0x0: invalid index (no data block DB47, parameter access is not supported) 0x1: write length error 0x2: invalid slot 0x3: type conflict 0x4: invalid range 0x5: state conflict (access to DB47 temporarily not possible due to internal process states) 0x6: access denied 0x7: invalid range (write error in DB47 header) 0x8: invalid parameter 0x9: invalid type 0x A - 0x F: user-dependent 0x C Resource errors 0x0: read conflict 0x1: write conflict 0x2: resource busy 0x3: resource not accessible 0x4 - 0x7: reserved 0x8 - 0x F: user-dependent 0x D - 0x F User-defined errors - 88 Version: 1.5.3 TE1000
## Page 89

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 3.10.6 FB_Dpv1Write PNET The function block FB_Dpv1Write PNET writes one or more parameters of a Sinamics Profidrive via DPV1 (Profidrive Specification 3.1) via Profinet. The DPV1 write telegram must be created with F_Create Dpv1Write Req Pkg PNET [} 84] before a rising edge is present at b Execute. The DPV1 answer telegram must be evaluated with F_Split Dpv1Write Res Pkg PNET [} 86] after b Busy indicates a falling edge. The execution of this function block requires some time, depending on the number of parameters to be read. The function block sends the DPV1 telegram and polls for an answer telegram. Inputs VAR_INPUT b Execute : BOOL;(* drive access info *) a Net Id : T_Ams Net Id; (* Net ID of Profibus Master EL6631 *) i Profinet Port : UINT; (* Port of Profi Drive *) i Drive Id : USINT; (* 0..255 possible *) p Dpv1Req Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE_PNET_REQ] OF BYTE; i Dpv1Req Data Len : UDINT; p Dpv1Res Data : POINTER TO ARRAY [1..i MAX_DPV1_SIZE_PNET_RES] OF BYTE; i Dpv1Res Data Len : UDINT; t Tm Out : TIME; END_VAR Name Type Description b Execute BOOL The function block is enabled by a positive edge at this input. a Net Id T_Ams Net ID The network address of the Profibus master device (see ADS tab of the Profibus master device in the I/O configuration in the Twin CAT system) i Profinet Port UINT The Profinet port number of the drive. This is an address for several axes, specified in the Twin CAT system in the I/ O configuration. i Drive ID USINT The ID is 1 for the Controller Unit, 2 for the drive object A, 3 for the drive object B of a double/triple drive. The drive ID is set in the starter software. 1..16 is possible. p Dpv1Req Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 write telegram. This telegram must be created by the function F_Create Dpv1Write Req Pkg [} 76] before the DPV1 Read is activated via b Execute. i Dv1Req Data Len UDINT Maximum length of the DPV1 data buffer (240 bytes). p Dpv1Res Data POINTER TO ARRAY Pointer to an array of 240 bytes containing the DPV1 write answer telegram. This telegram must be evaluated by the function F_Split Dpv1Write Res Pkg [} 77] after a negative edge appears on b Busy. TE1000 Version: 1.5.3 89
## Page 90

Function blocks Name Type Description i Dpv1Res Data Len UDINT Maximum length of the DPV1 response data buffer (240 bytes). t Tm Out TIME Maximum time allowed for the execution of the command. Inputs/outputs VAR_OUTPUT i Request Ref : USINT; (* 1..127; 0: reserved *) END_VAR Name Type Description i Ref Request USINT Reference that is automatically incremented with each telegram. The reference is required for the allocation of the responses to the write/read requests. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; b Error Values : BOOL; i Err Id : UDINT; i Error Class : BYTE; i Error Code : BYTE; END_VAR Name Type Description b Busy BOOL This output goes TRUE as soon as the function block is activated via b Execute and remains TRUE as long as the function block has not received a response. b Error BOOL In case of errors this output goes TRUE and b Busy goes FALSE. b Error Values BOOL TRUE if the DPV1 Write was unsuccessful or only partly successful. The error causes are returned via the error ID (as well as Class and Code). i Err Id UDINT Returns the ADS error number [} 156] or function-block- specific error numbers if b Error = TRUE. i Err Class BYTE Profidrive error class i Err Code BYTE Profidrive error code Function-block-specific error codes Description 0x2 Incorrect response reference 0x3 DPV1 Read faulty or partially faulty 0x4 Incorrect response ID other error IDs See ADS error codes Error classes Description Error code 0x0 - 0x9 Reserved - 0x A Application errors 0x0: read error 0x1: write error 0x2: module error 0x3 - 0x7: reserved 0x8: version conflict 0x9: not supported 0x A - 0x F: user-dependent 0x B Access errors 0x0: invalid index (no data block DB47, parameter access is not supported) 0x1: write length error 0x2: invalid slot 0x3: type conflict 90 Version: 1.5.3 TE1000
## Page 91

Function blocks Error classes Description Error code 0x4: invalid range 0x5: state conflict (access to DB47 temporarily not possible due to internal process states) 0x6: access denied 0x7: invalid range (write error in DB47 header) 0x8: invalid parameter 0x9: invalid type 0x A - 0x F: user-dependent 0x C Resource errors 0x0: read conflict 0x1: write conflict 0x2: resource busy 0x3: resource not accessible 0x4 - 0x7: reserved 0x8 - 0x F: user-dependent 0x D - 0x F User-defined errors - Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 3.11 RAID Controller 3.11.1 FB_RAIDFind Cntlr This function returns the counter value of the RAID controller and the corresponding controller IDs. NOTICE The function block should only be called once in a PLC program! The system performance can be dramatically affected by the cyclic calling of this function block. Inputs VAR_INPUT s NETID : T_Ams Net Id; b Wrt Rd : BOOL; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description s NETID T_Ams Net ID Is a string containing the AMS network ID of the target device to which the ADS command is sent. b Wrt Rd BOOL The ADS command is triggered by the rising edge of this input. t Time Out TIME Specifies the time-out period that must not be exceeded when the command is executed. TE1000 Version: 1.5.3 91
## Page 92

Function blocks Outputs VAR_OUTPUT st RAIDCntlr Found : ST_RAIDCntlr Found; n Bytes Read : UDINT; b Busy : BOOL; b Error : BOOL; n Error ID : UDINT; END_VAR Name Type Description st RAIDCntlr Found ST_RAIDCntlr Found Contains the number of RAID controllers found and their RAID controller IDs. [} 140] n Bytes Read UDINT Number of successfully returned data bytes. b Busy BOOL This output remains TRUE until the function block has executed a command, but no longer than the time present at the ‘Timeout’ input. No new command will be accepted at the inputs as long as b Busy = TRUE. Please note that it is not the execution of the service, but the time during which it be may executed that is monitored here. b Error BOOL This output is set to TRUE if an error occurs during the execution of a command. The command-specific error code is in 'n Error Id'. If the function block has an timeout error, ‘b Error’ is set to TRUE and ‘n Error Id’ is 1861 (hexadecimal 0x745). It is set to FALSE if a command is executed at the inputs. n Error ID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 3.11.2 FB_RAIDGet Info This function block returns a RAID info containing the number of RAID controller sets and the maximum number of drives per set. NOTICE The function block should only be called once in a PLC program! The system performance can be dramatically affected by the cyclic calling of this function block. Inputs VAR_INPUT s NETID : T_Ams Net Id; b Wrt Rd : BOOL; n RAIDCntlr ID : UDINT; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR 92 Version: 1.5.3 TE1000
## Page 93

Function blocks Name Type Description s NETID T_Ams Net ID Is a string containing the AMS network ID of the target device to which the ADS command is sent. b Wrt Rd BOOL The ADS command is triggered by the rising edge of this input. n RAIDCntlr ID UDINT The RAID controller ID (can be read with FB_RAIDCntlr Find). t Time Out TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT st RAIDInfo : ST_RAIDInfo; n Bytes Read : UDINT; b Busy : BOOL; b Error : BOOL; n Error ID : UDINT; END_VAR Name Type Description st RAIDInfo ST_RAIDInfo [} 141] Returns a RAID info containing the number of RAID controller sets and the maximum number of drives per set. n Bytes Read UDINT Number of successfully returned data bytes. b Busy BOOL This output remains TRUE until the function block has executed a command, but no longer than the time present at the ‘Timeout’ input. No new command will be accepted at the inputs as long as b Busy = TRUE. Please note that it is not the execution of the service, but the time during which it be may executed that is monitored here. b Error BOOL This output is set to TRUE if an error occurs during the execution of a command. The command-specific error code is in 'n Error Id'. If the function block has an timeout error, ‘b Error’ is set to TRUE and ‘n Error Id’ is 1861 (hexadecimal 0x745). It is set to FALSE if a command is executed at the inputs. n Error ID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 3.11.3 FB_RAIDGet Status This function block returns the RAID set index, the RAID type, the RAID status, the number of RAID drives and the status of the RAID drives. TE1000 Version: 1.5.3 93
## Page 94

Function blocks NOTICE Call once per second at the most! The system performance can be dramatically affected by the cyclic calling of this function block. Inputs VAR_INPUT s NETID : T_Ams Net Id; b Wrt Rd : BOOL; st RAIDConfig Req : ST_RAIDConfig Req; t Time Out : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description s NETID T_Ams Net ID Is a string containing the AMS network ID of the target device to which the ADS command is sent. b Wrt Rd BOOL The ADS command is triggered by the rising edge of this input. st RAIDConfig Req ST_RAIDConfig Req [} 140] RAID configuration request parameters are defined in this structure. It contains the controller ID and the index of the RAID set. t Time Out TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT st RAIDStatus Res : ST_RAIDStatus Res; n Bytes Read : UDINT; b Busy : BOOL; b Error : BOOL; n Error ID : UDINT; END_VAR Name Type Description st RAIDStatus Res ST_RAIDStatus Res [} 141] This structure contains the RAID status response, the RAID set index, the RAID type, the RAID status, the number of RAID drives, the status of the RAID drives. n Bytes Read UDINT Number of successfully returned data bytes. b Busy BOOL This output remains TRUE until the function block has executed a command, but no longer than the time present at the ‘Timeout’ input. No new command will be accepted at the inputs as long as b Busy = TRUE. Please note that it is not the execution of the service, but the time during which it be may executed that is monitored here. b Error BOOL This output is set to TRUE if an error occurs during the execution of a command. The command-specific error code is in 'n Error Id'. If the function block has an timeout error, ‘b Error’ is set to TRUE and ‘n Error Id’ is 1861 (hexadecimal 0x745). It is set to FALSE if a command is executed at the inputs. n Error ID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 94 Version: 1.5.3 TE1000
## Page 95

Function blocks 3.12 SERCOS 3.12.1 IOF_SER_Get Phase The IOF_SER_Get Phase function block determines the current communication phase on the SERCOS ring. The communication phases can have values from 0 to 4. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; GET : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT The Device Id is used to specify the SERCOS master whose communication phase is to be determined. The device IDs are specified by the Twin CAT system during the hardware configuration. GET BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; PHASE : BYTE; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. PHASE BYTE The current communication phase in the SERCOS ring. TE1000 Version: 1.5.3 95
## Page 96

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.2 IOF_SER_Save Flash The IOF_SER_Save Flash function block checks the system parameters located in the DPRAM memory. If no error is present it activates them and saves them in the EEPROM. The function block can adjust system parameters in the EEPROM of the controller to suit the application. NOTICE The EEPROM can be re-written up to 100,000 times. The PLC should not automatically activate this function block, but it should be called by the user for specific purposes. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; SAVE : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT The Device Id is used to specify the SERCOS master whose system parameters are to be stored. The device IDs are specified by the Twin CAT system during the hardware configuration. SAVE BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. 96 Version: 1.5.3 TE1000
## Page 97

Function blocks Name Type Description ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.3 IOF_SER_Reset Err The IOF_SER_Reset Err function block clears the following errors of a SERCOS master: • The errors in the existing drives; • The diagnostic status in the diagnostic channel of the existing drives; • The system error; Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; RESET : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT The Device Id is used to specify the SERCOS master whose errors are to be cleared. The device IDs are specified by the Twin CAT system during the hardware configuration. RESET BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR TE1000 Version: 1.5.3 97
## Page 98

Function blocks Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.4 IOF_SER_Set Phase The IOF_SER_Set Phase function block carries out the phase start-up in the SERCOS ring to a specific value. Inputs VAR_INPUT NETID : T_Ams Net Id; DEVICEID : UDINT; PHASE : BYTE; SET : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. DEVICEID UDINT The Device Id is used to specify the SERCOS master whose communication phase is to be set. The device IDs are specified by the Twin CAT system during the hardware configuration. PHASE BOOL The communication phase in the SERCOS ring that is to be set. SET BOOL The function block is enabled by a positive edge at this input. TMOUT TIME Specifies the time-out period that must not be exceeded when the command is executed. 98 Version: 1.5.3 TE1000
## Page 99

Function blocks Outputs VAR_OUTPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.5 IOF_SER_IDN_Read The IOF_SER_IDN_Read function block allows a value to be read from an S or P parameter of a Sercos drive. Data type and size are determined automatically on the basis of the attribute. Inputs VAR_INPUT s Net Id : T_Ams Net Id; n IDN : UINT; b Execute : BOOL; n Port : UINT; n Mode : DINT; n Attrib : DWORD; cb Len : UDINT; dw Dest Addr : PVOID; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description s Net Id T_Ams Net ID The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. TE1000 Version: 1.5.3 99
## Page 100

Function blocks Name Type Description n IDN UINT Contains the Sercos parameter number to be accessed for reading. n IDN must lie between 0 and 32767 for S parameters and between 32768 and 65535 for P parameters. b Execute BOOL The function block is enabled by a positive edge at this input. n Port UINT The port number n Port is assigned by the Twin CAT system during the hardware configuration. n Mode DINT The read mode determines which part of the parameter is to be read. n Mode = 0: Value n Mode = 2: Name n Mode = 3: Attribute (is always read to determine data type and size, unless n Attrib is <> 0) n Mode = 4: Unit (not available for every parameter) n Mode = 5: Minimum (not available for every parameter) n Mode = 6: Maximum (not available for every parameter) n Attrib DWORD Attribute of the parameter, if known. If n Attrib = 0, IOF_SER_IDN_Write first reads the parameter attribute of the drive before the value is written to the parameter of the drive. cb Len UDINT Maximum length of the data buffer that is to accept the value. dw Dest Addr PVOID Address of the data buffer that is to accept the value. t Timeout TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT cb Read : UDINT; n Attrib Rd : DWORD; s Attrib : ST_Sercos Param Attrib; b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; END_VAR Name Type Description cb Read UDINT Number of bytes read and copied to dw Dest Addr. n Attrib Rd DWORD Attribute of the parameter; can be saved for the next access (n Attrib) to the parameter. s Attrib ST_Sercos Param Attrib Contains the n Attrib Rd attribute of the Sercos parameter broken down into individual variables. [} 142] b Busy BOOL When the function block is enabled, this output is set and remains set until a feedback is received. b Error BOOL If an error should occur during the transfer of the command, then this output is set once the b Busy output was reset. n Err Id UDINT Returns the ADS error number [} 156] or the specific function block error number if the ERR output is set. specific function block error number Description 0x1003 Incorrect parameter mode 0x1004 Incorrect parameter data size 100 Version: 1.5.3 TE1000
## Page 101

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.6 IOF_SER_IDN_Write The IOF_SER_IDN_Write function block allows a value to be written to an S or P parameter of a Sercos drive. Data type and size are determined automatically on the basis of the attribute. Inputs VAR_INPUT s Net Id : T_Ams Net Id; n IDN : UINT; (* S: 0******* ********, P: 1******* ******** *) b Execute : BOOL; n Port : UINT; n Attrib : DWORD; cb Len : UDINT; dw Src Addr : PVOID; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description s Net Id T_Ams Net ID The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. n IDN UINT Contains the Sercos parameter number to be accessed for writing. n IDN must lie between 0 and 32767 for S parameters and between 32768 and 65535 for P parameters. b Execute BOOL The function block is enabled by a positive edge at this input. n Port UINT The port number n Port is assigned by the Twin CAT system during the hardware configuration. n Attrib DWORD Attribute of the parameter, if known. If n Attrib = 0, IOF_SER_IDN_Write first reads the parameter attribute of the drive before the value is written to the parameter of the drive. cb Len UDINT Length of the data buffer containing the value. dw Dest Addr PVOID Address of the data buffer containing the value. t Timeout TIME Specifies the time-out period that must not be exceeded when the command is executed. TE1000 Version: 1.5.3 101
## Page 102

Function blocks Outputs VAR_OUTPUT n Attrib Rd : DWORD; s Attrib : ST_Sercos Param Attrib; b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; END_VAR Name Type Description n Attrib Rd DWORD Attribute of the parameter; can be saved for the next access (n Attrib) to the parameter. s Attrib ST_Sercos Param Attrib Contains the n Attrib Rd attribute of the Sercos parameter broken down into individual variables. [} 142] b Busy BOOL When the function block is enabled, this output is set and remains set until a feedback is received. b Error BOOL If an error should occur during the transfer of the command, then this output is set once the b Busy output was reset. n Err Id UDINT Returns the ADS error number [} 156] or the specific function block error number if the ERR output is set. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.7 IOF_SER_DRIVE_Backup The IOF_SER_DRIVE_Backup function block allows the backup and restore of the drive data (S and P parameters) of the PLC in a binary file. The list of S and P parameter data to be backed up is taken from the Sercos parameter IDN192 by default. Backup and restore require the SERCOS parameter mode (phase 2). If b Std Backup List = TRUE (standard), the IDN192 parameter is taken as the list of the data to be backed up; otherwise IDN17, the list of all Sercos parameters, is taken. Restore requires a backup file that was created with the IDN192 parameter, since some parameters in the IDN17 list are read-only. Backup and restore create a CRC16-CCITT and a 16-bit checksum and save them in the IDN142 parameter, if available. The file format of the backup file is described in the backup file format [} 151]. 102 Version: 1.5.3 TE1000
## Page 103

Function blocks Inputs VAR_INPUT b Check : BOOL; b Backup : BOOL; b Restore : BOOL; b CRCEnable : BOOL := TRUE; b Std Backup List: BOOL := TRUE; s Net Id : T_Ams Net Id; n Port : UINT; s Comment : T_Max String; e Path : E_Open Path := PATH_BOOTPATH; s Path Name : T_Max String := 'DRIVEPAR. BIN'; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description b Check BOOL A positive edge at this input activates the CRC and checksum check. CRC and checksum are persistent and saved in the IDN142 parameter after a backup or restore. If the value from parameter IDN142 and the persistent data match, b Check OK is set to TRUE, otherwise b Check OK is set to FALSE. b Backup BOOL The backup is activated via a positive edge at this input. b Restore BOOL The restore is activated via a positive edge at this input. b CRCEnable BOOL The CRC16-CCITT and the 16-bit checksum are enabled via b CRCEnable = TRUE. The CRC and the checksum are saved in parameter IDN142 if b CRCEnable = TRUE. b Std Backup List BOOL Determines which parameter list is used for the backup. By default, IDN192 (b Std Backup List = TRUE) is used for the backup, if b Std Backup List = FALSE then the list of all parameters IDN017 is used. Restore requires a backup file that was created with the IDN192 list. s Net Id T_Ams Net ID The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. n Port UINT The port number n Port is assigned by the Twin CAT system during the hardware configuration. s Comment T_Max String Comment that is written to the file header of the backup file. e Path E_Open Path Determines the path of the backup file. If e Path = PATH_BOOTPATH, the Twin CAT BOOT path is used; if e Path = PATH_GENERIC, the path specified in s Path Name is used. s Path Name T_Max String Contains the file name (when using the boot path) or the complete path and file name when using the generic path. t Timeout TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; b Check OK : BOOL; END_VAR Name Type Description b Busy BOOL When the function block is enabled, this output is set and remains set until a feedback is received. TE1000 Version: 1.5.3 103
## Page 104

Function blocks Name Type Description b Error BOOL If an error should occur during the transfer of the command, then this output is set once the b Busy output was reset. n Err Id UDINT Returns the ADS error number [} 156] or the specific function block error number if the ERR output is set. specific function block error number Description 0x1003 Incorrect parameter mode 0x1004 Incorrect parameter data size 0x1005 Incorrect backup parameter type 0x1006 Backup parameter list was not IDN 192 Name Type Description b Check Ok BOOL Is TRUE if the checksum test was successful. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.8 IOF_SER_DRIVE_Backup Ex The IOF_SER_DRIVE_Backup Ex function block allows the drive data (S and P parameters) to be backed up and restored via the PLC to a binary file or back to the drive. The list of S and P parameter data to be backed up is taken from the Sercos parameter IDN192 by default. Backup and restore require the SERCOS parameter mode (phase 2). If b Std Backup List = TRUE (default), then the parameter IDN192 is used as the list of data to be backed up. If b User Backup List = TRUE, then the parameter list arr List is used as the list of data to be backed up. Otherwise IDN17 is used, the list of all SERCOS parameters. Restore requires a backup file that was created with the IDN192 parameter or with a user parameter list. Some parameters in the IDN17 list are read-only. Backup and restore can create a CRC16-CCITT and a 16-bit checksum and save them in the IDN142 parameter, if available. The b CRCEnable option is disabled (FALSE) by default. The file format of the backup file is described in the backup file format [} 151]. 104 Version: 1.5.3 TE1000
## Page 105

Function blocks Inputs VAR_INPUT b Check : BOOL; b Backup : BOOL; b Restore : BOOL; b CRCEnable : BOOL; b Std Backup List : BOOL := TRUE; b User Backup List : BOOL; s Net Id : T_Ams Net Id; n Port : UINT; s Comment : T_Max String; e Path : E_Open Path := PATH_BOOTPATH; s Path Name : T_Max String := 'DRIVEPAR. BIN'; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; b Ignore Param Err : BOOL; END_VAR Name Type Description b Check BOOL A positive edge at this input activates the CRC and checksum check. CRC and checksum are persistent and saved in the IDN142 parameter after a backup or restore. If the value from parameter IDN142 and the persistent data match, b Check OK is set to TRUE, otherwise b Check OK is set to FALSE. b Backup BOOL The backup is activated via a positive edge at this input. b Restore BOOL The restore is activated via a positive edge at this input. b CRCEnable BOOL The CRC16-CCITT and the 16-bit checksum are enabled via b CRCEnable = TRUE. The CRC and the checksum are saved in parameter IDN142 if b CRCEnable = TRUE. b Std Backup List BOOL Determines which parameter list is used for the backup. By default, IDN192 (b Std Backup List = TRUE) is used for the backup, if b Std Backup List = FALSE then the list of all parameters IDN017 is used. Restore requires a backup file that was created with the IDN192 list. b User Backup List BOOL Determines whether a user-defined parameter list arr List is used for the backup. By default IDN192 (b Std Backup List = TRUE) is used for the backup. arr List is used if b Std Backup List = FALSE and b User Backup List = TRUE. Restore requires a backup file that was created with the IDN192 list or a user-defined parameter list. s Net Id T_Ams Net ID The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. n Port UINT The port number n Port is assigned by the Twin CAT system during the hardware configuration. s Comment T_Max String Comment that is written to the file header of the backup file. e Path E_Open Path Determines the path of the backup file. If e Path = PATH_BOOTPATH, the Twin CAT BOOT path is used; if e Path = PATH_GENERIC, the path specified in s Path Name is used. s Path Name T_Max String Contains the file name (when using the boot path) or the complete path and file name when using the generic path. t Timeout TIME Specifies the time-out period that must not be exceeded when the command is executed. b Ignore Param Err BOOL Specifies whether to continue or abort the backup/restore in the event of a parameter read error or parameter write error. By default, the program is aborted in the event of errors (b Ignore Param Err = FALSE). If the ignoring of errors TE1000 Version: 1.5.3 105
## Page 106

Function blocks Name Type Description is activated (b Ignore Param Err = TRUE), the parameter number and the error numbers are stored in the list of skipped parameters arr Skipped List. Inputs/outputs VAR_IN_OUT arr List : ST_Sercos Param List; arr Skipped List : ST_Sercos Param Err List; END_VAR Name Type Description arr List ST_Sercos Param List In case of a standard backup via IDN192 (b Std Backup List = TRUE), this list contains the backup parameters from [} 143] IDN192 after the backup. In case of a user-defined backup (b User Backup List = TRUE and b Std Backup List = FALSE), this list must contain the list of parameters to be backed up before the backup. In case of a backup via IDN17 (b User Backup List = FALSE and b Std Backup List = FALSE), this list contains after the backup the list of existing parameters from IDN17. arr Skipped List ST_Sercos Param Err List Contains a list of the skipped parameters (the parameter number and the error numbers). [} 143] Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; b Check OK : BOOL; i Skipped Params : UINT; i Handled Params : UINT; END_VAR Name Type Description b Busy BOOL When the function block is enabled, this output is set and remains set until a feedback is received. b Error BOOL If an error should occur during the transfer of the command, then this output is set once the b Busy output was reset. n Err Id UDINT Returns the ADS error number [} 156] or the specific function block error number if the ERR output is set. specific function block error number Description 0x1003 Incorrect parameter mode 0x1004 Incorrect parameter data size 0x1005 Incorrect backup parameter type 0x1006 Backup parameter list was not IDN 192 Name Type Description b Check Ok BOOL Is TRUE if the checksum test was successful. i Skipped Params UINT Contains the number of skipped parameters (see arr Skipped List) if ignoring of parameter errors was active (b Ignore Param Err = TRUE). i Handled Params UINT Contains the number of the successfully backed up/ restored parameters. 106 Version: 1.5.3 TE1000
## Page 107

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.12.9 IOF_SER_DRIVE_Reset The IOF_SER_DRIVE_Reset function block resets a Sercos drive. Drive errors are cleared. Inputs VAR_INPUT s Net Id : T_Ams Net Id; n Port : UINT; b Reset : BOOL; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description s Net Id T_Ams Net ID The network address of the Twin CAT computer on which the ADS command is to be executed can be specified here. For the local computer an empty string may be specified. n Port UINT The port number n Port is assigned by the Twin CAT system during the hardware configuration. b Reset BOOL The function block is enabled by a positive edge at this input. t Timeout TIME Specifies the time-out period that must not be exceeded when the command is executed. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Err Id : UDINT; END_VAR Name Type Description b Busy BOOL When the function block is enabled, this output is set and remains set until a feedback is received. b Error BOOL If an error should occur during the transfer of the command, then this output is set once the b Busy output was reset. n Err Id UDINT Returns the ADS error number [} 156] or the specific function block error number if the ERR output is set. TE1000 Version: 1.5.3 107
## Page 108

Function blocks Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 3.13 Tc Touch Lock Tc Touch Lock is a function of Beckhoff IPC Panel. For more information, see the documentation Touch_Lock. The hardware requirements can also be found there, in the chapter Requirements. 3.13.1 FB_Tc Touch Lock_Acquire Focus The FB_Tc Touch Lock_Acquire Focus function block is used to prevent parallel, interfering inputs via several multi-touch control panels connected to one IPC. To this end, the focus is placed on one of the connected control panels, while inputs from all other connected control panels are blocked. The FB_Tc Touch Lock_Acquire Focus function block can be used to request and release the focus. If the focus is requested from a multi-touch control panel when another multi-touch control panel currently has the focus, the focus must first be released by this panel. Once the release has taken place, the focus is automatically set to the device that is waiting for it. The multi-touch control panels that are accessed by the function block must first be configured using the command line application Tc Touch Lock Service.exe. Each device must be assigned a specific identification number. Inputs VAR_INPUT b Enable : BOOL; s Set ID : STRING(32); t LEDTime : TIME := 200; END_VAR Name Type Description b Enable BOOL TRUE = request focus, FALSE = release focus s Set ID STRING ID of the device t LEDTime TIME The output LED flashes at the specified interval (100 ms – 1 s) while the focus is requested. Outputs VAR_OUTPUT b Acquired : BOOL := FALSE;(* Focus status information *) b LED : BOOL := FALSE;(* LED control output *) b Busy : BOOL;(* TRUE => function in progress *) b Error: : BOOL;(* Error flag *) n Err ID : UDINT;(* Error code *) END_VAR 108 Version: 1.5.3 TE1000
## Page 109

Function blocks Name Type Description b Acquired BOOL TRUE if the client has the focus; FALSE if the client loses the focus. b LED BOOL This output has the following meaning, depending on the mode: Mode Meaning Constant TRUE The panel has the focus Constant FALSE The panel does not have the focus Toggeles The panel is waiting for the focus Name Type Description b Busy BOOL When the function block is enabled, this output is set and remains set until a feedback is received. b Error BOOL If an error should occur during the transfer of the command, then this output is set once the b Busy output was reset. n Err Id UDINT Returns the ADS error number [} 156] or the specific function block error number if the ERR output is set. Error codes Error description 0x0000 No error 0x0006 Target port not found Example: control of touch focus via special key Manual setting of the focus can be controlled via a special key on the panel, for example. As the focus should also be requested via the touch screen when the input is locked, an input option outside the lockable touch screen must be considered. The special key is linked to the corresponding input variable in the PLC program through the Twin CAT System Manager. One FB_Tc Touch Lock_Aquire Focus instance is created per panel and configured with the panel ID. After pressing the special key on a panel, the function block R_TRIG detects the rising edge, and the PLC program tries to set the touch focus via the corresponding FB_Tc Touch Lock_Aquire Focus instance. The function block can also control an output (e.g. an LED), which signals whether the touch focus has been set successfully or whether an attempt is still being made to obtain the focus. Pressing the special key again resets the touch focus, allowing the touch focus to be set to another panel. For two panels the PLC program looks like this: PROGRAM MAIN VAR button1 AT%IX0.0 : BOOL; button2 AT%IX0.1 : BOOL; TE1000 Version: 1.5.3 109
## Page 110

Function blocks led1 AT%QX0.0 : BOOL; led2 AT%QX0.1 : BOOL; fb Panel1 : FB_Tc Touch Lock_Acquire Focus := ( s Set ID := 'A' ); fb Panel2 : FB_Tc Touch Lock_Acquire Focus := ( s Set ID := 'B' ); trigger1 : R_TRIG; trigger2 : R_TRIG; END_VAR (* Panel 1 *) trigger1( CLK := button1 ); IF trigger1. Q THEN fb Panel1.b Enable := NOT fb Panel1.b Enable; END_IF fb Panel1(b LED=>LED1); (* Panel 2 *) trigger2( CLK := button2 ); IF trigger2. Q THEN fb Panel2.b Enable := NOT fb Panel2.b Enable; END_IF fb Panel2(b LED=>LED2 ); Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1. >= 4022.31 PC or CX (x86, x64) Tc2_Io Functions (IO) 3.14 Third party devices 3.14.1 Phoenix IBS SC/I-T 3.14.1.1 Overview The library offers a convenient possibility to execute the most important firmware services of the Phoenix IBS SC/I-T interbus card for bus control from the Twin CAT PLC. The following diagram illustrates the states and the transition conditions of the bus control. 110 Version: 1.5.3 TE1000
## Page 111

Function blocks Bus Control SCIT_Activate Configuration [} 112]: Executes the Activate_Configuration command. SCIT_Deactivate Configuration [} 113]: Executes the Deactivate_Configuration command. SCIT_Start Data Transfer [} 114]: Executes the Start_Data_Transfer command. SCIT_Stop Data Transfer [} 115]: Executes the Stop_Data_Transfer command. SCIT_Alarm Stop [} 116]: Executes the Alarm_Stop command. Configuration SCIT_Control Active Configuration [} 117]: Is used to affect the active configuration of the Interbus devices. This command can be executed in the PAR_READY state as well as when in the ACTIVE or RUN states. Single, dependent and grouped devices can be activated and deactivated in this way. Error diagnosis SCIT_Get Error Info [} 119]: Returns the error type and error location of an Interbus device after a bus error. SCIT_Conf Dev Err All [} 120]: Acknowledge periphery errors of all devices. TE1000 Version: 1.5.3 111
## Page 112

Function blocks 3.14.1.2 SCIT_Activate Configuration The SCIT_Activate Configuration function block is used as an auxiliary function block to perform an Activate_Configuration on the Interbus card, which is addressed with the NETID and the PORT. An Activate_Configuration sets the card in the ACTIVE [} 110] state. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). 112 Version: 1.5.3 TE1000
## Page 113

Function blocks Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.3 SCIT_Deactivate Configuration The SCIT_Deactivate Configuration function block is used as an auxiliary function block to perform a Deactivate_Configuration on the Interbus card, which is addressed with the NETID and the PORT. A Deactivate_Configuration sets the card to the PAR_READY [} 110] state and resets all outputs. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. TE1000 Version: 1.5.3 113
## Page 114

Function blocks Name Type Description RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.4 SCIT_Start Data Transfer The SCIT_Start Data Transfer function block is used as an auxiliary function block to carry out a Start_Data_Transfer on the Interbus card, which is addressed with the NETID and the PORT. A Start_Data_Transfer places the card into the RUN [} 110] state. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR 114 Version: 1.5.3 TE1000
## Page 115

Function blocks Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.5 SCIT_Stop Data Transfer The SCIT_Stop Data Transfer function block is used as an auxiliary function block to perform a Stop_Data_Transfer on the Interbus card that is addressed with the NETID and the PORT. A Stop_Data_Transfer sets the card to the ACTIVE [} 110] state, the outputs are not reset. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. TE1000 Version: 1.5.3 115
## Page 116

Function blocks Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.6 SCIT_Alarm Stop The SCIT_Alarm Stop function block is used as an auxiliary function block to perform an Alarm_Stop on the Interbus card that is addressed with the NETID and the PORT. An Alarm_Stop sets the card to the PAR_READY [} 110] state and all outputs are reset. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. 116 Version: 1.5.3 TE1000
## Page 117

Function blocks Name Type Description PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.7 SCIT_Control Active Configuration The SCIT_Control Active Configuration function block is used as an auxiliary function block to perform a Control_Active_Configuration on the Interbus card, which is addressed with the NETID and the PORT. A Control_Active_Configuration can be used to change the state of a device (or several if the specified device is part of a group). TE1000 Version: 1.5.3 117
## Page 118

Function blocks Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; SWITCH_CODE : WORD; DEVICE_NO : WORD; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. SWITCH_CODE WORD Specifies the action to be carried out with the device: 0 = Segment Off 1 = Segment On 2 = Device_Off 3 = Device_On 4 = Device_Disable 5 = Device_Enable DEVICE_NO WORD Specifies the device number of the addressed device. For device 3.1, for example, a value of 16#0301 must be entered. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). 118 Version: 1.5.3 TE1000
## Page 119

Function blocks Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.8 SCIT_Get Error Info The SCIT_Get Error Info function block reads the exact error cause and the exact error location of a previously occurred bus error from the Interbus card, which is addressed with the NETID and the PORT. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ERRORCODE : WORD; ADDERRINFO : WORD; END_VAR Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. TE1000 Version: 1.5.3 119
## Page 120

Function blocks Name Type Description RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ERRORCODE WORD Provides information related to the error type (cf. the Phoenix card error descriptions). ADDERRINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.1.9 SCIT_Conf Dev Err All The SCIT_Conf Dev Err All function block acknowledges periphery errors of all existing devices simultaneously. The Control_Device_Function of the Interbus card is called internally. The interbus card is addressed with the NETID and the PORT. Inputs VAR_INPUT NETID : T_Ams Net Id; PORT : T_Ams Port; WRTRD : BOOL; TMOUT : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description NETID T_Ams Net Id The network address of the computer in which the card is installed can be entered here. If the card is on the same system, an empty string can also be specified. PORT T_Ams Port Contains the ADS port number of the card assigned by the Twin CAT system. WRTRD BOOL The function block is enabled by a positive edge at this value. TMOUT TIME Maximum time allowed for the execution of the command. Outputs VAR_INPUT BUSY : BOOL; ERR : BOOL; ERRID : UDINT; RESULT : WORD; ADDERRINFO : WORD; END_VAR 120 Version: 1.5.3 TE1000
## Page 121

Function blocks Name Type Description BUSY BOOL When the function block is enabled, this output is set and remains set until a feedback is received. ERR BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. ERRID UDINT Returns the ADS error number [} 156] when the ERR output is set. RESULT WORD Returns the result from the card (assuming an error-free ADS transport (ERR = FALSE)). RESULT = 0 identifies successful execution of the command. A value other than 0 contains the error number from the Phoenix card. ADDERRORINFO WORD Contains additional error information in the event of a negative feedback from the card (see Phoenix card command description). Requirements Development environ- Target platform IO Hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is Phoenix: IBS SC/I-T; IBS Tc2_Io Functions (IO) not supported by SC/RI/RT-LK Twin CAT 3 at present! 3.14.2 ads-tec 3.14.2.1 FB_Read Ads Tec Sys Data The FB_Read Ads Tec Sys Data function block reads the system data/diagnostic data of an ads-tec industrial PC. The function block is level-triggered, i.e. the system data is only read cyclically when the b Enable input is set. To keep the system load low, the read cycle is automatically repeated every ~100 ms (default value). When the b Valid output is set, the most recently read data is valid (i.e. the last read cycle was carried out without error). If an error occurs, the b Error output is set, and cyclic reading is stopped. With a new rising edge at the b Enable input, existing errors can be deleted and cyclical reading can be restarted. Inputs VAR_INPUT s Net Id : T_Ams Net Id; b Enable : BOOL; t Cycle Time : TIME := T#100ms; END_VAR Name Type Description s Net Id T_Ams Net ID A string with the network address of the Twin CAT computer whose system data are to be read can be specified here. For the local computer an empty string may be specified. b Enable BOOL The function block is reset with a rising edge (previous errors at output b Error and n Err Id deleted). The system data are read cyclically if the input is set. t Cycle Time TIME The cyclic reading interval. TE1000 Version: 1.5.3 121
## Page 122

Function blocks Outputs VAR_OUTPUT b Valid : BOOL; b Error : BOOL; n Err Id : UDINT; st Sys Data : ST_Ads Tec Sys Data; END_VAR Name Type Description b Valid BOOL When the function block is enabled, this output is set and remains set until a feedback is received. b Error BOOL If an error should occur during the transfer of the command, then this output is set once the BUSY output was reset. n Err Id UDINT Returns the ADS error number [} 156] when the b Error output is set. st Sys Data ST_Ads Tec Sys Data [} 133] Structure with the system data/diagnostic data. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is ads-tec PC Tc2_Io Functions (IO) not supported by Twin CAT 3 at present! 122 Version: 1.5.3 TE1000
## Page 123

Functions 4 Functions 4.1 [Obsolete] 4.1.1 F_Get Version Tc Io Functions This function is obsolete and should not be used. Please use the global constant st Lib Version_Tc2_Io Functions [} 150] in order to read version information from the PLC library. This function reads version information from the PLC library. FUNCTION F_Get Version Tc Io Functions : UINT Inputs VAR_INPUT n Version Element : INT; END_VAR Name Type Description n Version Element INT Version element to be read. Possible parameters: • 1 : major number; • 2 : minor number; • 3 : revision number; Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 4.1.2 F_Get Version RAIDController This function is obsolete and should not be used. Please use the global constant: st Lib Version_Tc2_Io Functions [} 150] to read version information from the PLC library. This function reads version information from the PLC library. FUNCTION F_Get Version RAIDController : UINT Inputs VAR_INPUT n Version Element : INT; END_VAR Name Type Description n Version Element INT Version element to be read. Possible parameters: • 1 : major number; TE1000 Version: 1.5.3 123
## Page 124

Functions Name Type Description • 2 : minor number; • 3 : revision number; Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 124 Version: 1.5.3 TE1000
## Page 125

Data Types 5 Data Types 5.1 E_PD_Dpv1Error E_PD_Dpv1Error lists the DPV1-Error IDs: TYPE E_PD_Dpv1Error : ( e PD_Err_Param Number := 0,(* Unzulässige Parameternummer *) e PD_Err_Param Read Only := 1,(* Parameterwert nicht änderbar *) e PD_Err_Value Out Of Range := 2,(* Untere oder obere Wertgrenze überschritten *) e PD_Err_Invalid Sub Index := 3,(* Fehlerhafter Subindex *) e PD_Err_No Array := 4,(* Kein Array *) e PD_Err_Wrong Data Type := 5,(* Falscher Datentyp *) e PD_Err_Only Reset Permitted := 6,(* Kein Setzen errlaubt (nur Rücksetzen) *) e PD_Err_Desc Not Changable := 7,(* Beschreibungselement nicht änderbar *) e PD_Err_Desc Not Found := 9,(* Beschreibungselement nicht vorhanden *) e PD_Err_No Permission To Change := 11,(* Keine Bedienhoheit *) e PD_Err_No Text Array := 15,(* Kein Textarray vorhanden *) e PD_Err_Job Not Executable := 17,(* Auftrag wegen Betriebszustand nicht ausführbar *) e PD_Err_Value Invalid := 20,(* Wert unzulässig *) e PD_Err_Response To Long := 21,(* Antwort zu lang *) e PD_Err_Param Addr Invalid := 22,(* Parameteradresse unzulässig *) e PD_Err_Format Invalid := 23,(* Format unzulässig *) e PD_Err_Num Of Values Invalid := 24,(* Anzahl Werte nicht konsistent *) e PD_Err_Drive Obj Not Existing := 25,(* Antriebsobjekt existiert nicht *) e PD_Err_Param Deactivated := 101,(* Parameter momentan deaktiviert *) e PD_Err_Param No Wr If Enabled := 107,(* Kein Schreibzugriff bei freigegebenem Regler *) e PD_Err_Param Invalid Unit := 108,(* Unbekannte Einheit *) e PD_Err_Param No Wr If Not Init Fbk := 109,(* Schreibzugriff nur in Inbetriebnahmezustand Geber *) e PD_Err_Param Wr If Init Mtr := 110,(* Schreibzugriff nur in Inbetriebnahmezustand Motor *) e PD_Err_Param Wr If Init Drv := 111, (* Schreibzugriff nur in Inbetriebnahmezustand Leistungsteil *) e PD_Err_Param Wr If Fast Init := 112,(* Schreibzugriff nur in Schnellinbetriebnahme *) e PD_Err_Param Wr If Ready := 113,(* Schreibzugriff nur in Bereit *) e PD_Err_Param Wr If Init Param Reset := 114, (* Schreibzugriff nur in Inbetriebnahmezustand Parameterreset *) e PD_Err_Param Wr If Init Safety := 115, (* Schreibzugriff nur in Inbetriebnahmezustand Safety *) e PD_Err_Param Wr If Init Tech App := 116, (* Schreibzugriff nur in Inbetriebnahmezustand Tech. Appl./Einheiten *) e PD_Err_Param Wr If Init := 117,(* Schreibzugriff nur in Inbetriebnahmezustand *) e PD_Err_Param Wr If Init Dwn Ld := 118, (* Schreibzugriff nur in Inbetriebnahmezustand Download *) e PD_Err_Param No Wrt If Dwn Ld := 119,(* Darf im Download nicht geschrieben werden *) e PD_Err_Param Wr If Init Drv Cfg := 120, (* Schreibzugriff nur in Inbetriebnahmezustand Antriebskonfiguration *) e PD_Err_Param Wr If Init Set Drv Type := 121, (* Schreibzugriff nur in Inbetriebnahmezustand Festlegung Antriebstyp *) e PD_Err_Param Wr If Init Dataset Cfg := 122, (* Schreibzugriff nur in Inbetriebnahmezustand Datensatz-Basiskonfiguration *) e PD_Err_Param Wr If Init Dev Cfg := 123, (* Schreibzugriff nur in Inbetriebnahmezustand Gerätekonfiguration *) e PD_Err_Param Wr If Init Dev Dwn Ld := 124, (* Schreibzugriff nur in Inbetriebnahmezustand Gerätedownload *) e PD_Err_Param Wr If Init Dev Prm Reset := 125, (* Schreibzugriff nur in Inbetriebnahmezustand Geräteparameterreset *) e PD_Err_Param Wr If Init Dev Ready := 126, (* Schreibzugriff nur in Inbetriebnahmezustand Gerät bereit *) e PD_Err_Param Wr If Init Device := 127,(* Schreibzugriff nur in Inbetriebnahmezustand Gerät *) e PD_Err_Param No Write If Dwn Ld := 129,(* darf im Download nicht geschrieben werden *) e PD_Err_Ctrl Take Over Blocked := 130,(* Übernahme der Steuerungshoheit über BICO gesperrt *) e PD_Err_Param Bico Set Invalid := 131,(* gewünschte BICO-Verschaltung unmöglich *) e PD_Err_Param Change Blocked := 132,(* Parameteränderung gesperrt *) e PD_Err_Param No Access Defined := 133,(* Keine Zugriffsmethode definiert *) e PD_Err_Below Defined Minimum := 200,(* Unterhalb aktuell gültiger Grenze *) e PD_Err_Above Defined Maximum := 201,(* Oberhalb aktuell gültiger Grenze *) e PD_Err_Write Not Permitted := 204(* Schreiben nicht erlaubt *) ); END_TYPE TE1000 Version: 1.5.3 125
## Page 126

Data Types Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731, EL6632 5.2 E_Battery Status Battery status. TYPE E_Battery Status : ( Battery Unknown Status, Battery Ok, Battery Replace ); END_TYPE Name Value Meaning Battery Unknown Status 0 The battery status is unknown. Battery Ok 1 The battery status is OK. Battery Replace 2 The battery should be replaced. Requirements Development en- Target platform UPS hardware PLC libraries to be vironment integrated (cate- gory group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) • Beckhoff CU81x0-0xx0 Tc2_Io Functions (IO) • Beckhoff BAPI v1; • Beckhoff P24Vxxxx; • Beckhoff CP903x card (PCI/ISA); • Beckhoff CX2100-09x4 models (e.g. CX2100-0904 or CX2100-0914 + "Smart Battery" CX2900-0192); • The APC devices that come supplied with Beckhoff Industrial PC support the Smart protocol and can be configured with the Windows UPS service. 5.3 E_PD_Datatype E_PD_Datatype contains the possible data types of a Profidrive parameter. TYPE E_PD_Datatype : ( e PD_UNDEFINED := 0, e PD_BOOL := 1,(* 0/1 (not impl.) *) e PD_INT08 := 2,(* -128 .. 127 *) e PD_INT16 := 3,(* -32768 .. 32767 *) e PD_INT32 := 4,(* -2147483648 .. 2147483647 *) e PD_UINT08 := 5,(* 0 .. 255 *) e PD_UINT16 := 6,(* 0 .. 65535 *) e PD_UINT32 := 7,(* 0 .. 4294967295 *) e PD_FLOAT := 8,(* IEEE 754 *) e PD_VSTRING := 9,(* ISO/IEC 646, variable length *) e PD_OCTSTRING := 10,(* bytearray, variable length *) e PD_TIMEOFDAY_WDI := 12,(* 6 Bytes: 4 bytes ms + 2 bytes day since 1.1.1984 *) 126 Version: 1.5.3 TE1000
## Page 127

Data Types e PD_TIMEDIFF := 13,(* 4|6 Bytes: 4 bytes ms + optional 2 bytes days*) e PD_N2_16BIT := 33, e PD_N4_32BIT := 34, e PD_V2_BITSEQ := 35, e PD_L2_NIBBLE := 36, e PD_R2_RECIP_TC := 37, e PD_T2_TC_16BIT := 38, e PD_T2_TC_32BIT := 39, e PD_D2_TC := 40, e PD_E2_FIXPT_16 := 41, e PD_C2_FIXPT_32 := 42, e PD_X2_NV_16 := 43, e PD_X4_NV_32 := 44, e PD_DATE := 50, (* 7 Bytes: 2 bytes ms + 2 bits (res.), 6 bits(minutes) + 1 bit (0: Std Time/ 1:Daylight Saving Time), 2 bits (res.), 5 bits(hours) + 3 bits (Day Of Week), 5 bits(Day Of Month) + 2 bit s (res.), 6 bits(month) + 1 bit (res.), 7 bits (year)*) e PD_TIMEOFDAY_NODI := 52, (* 0 .. 268435455 ms *) e PD_TIMEDIFF_WDI := 53,(* 6 Bytes: 4 bytes ms + 2 bytes days *) e PD_TIMEDIFF_NODI:= 54,(* 0 .. 4294967295 ms *) e PD_ZERO := 64, e PD_BYTE := 65, e PD_WORD := 66, e PD_DWORD := 67, e PD_ERROR := 68 ); END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731, EL6632 5.4 E_RAIDDrive Status TYPE E_RAIDDrive Status : ( e RAID_DRIVE_STATUS_OK := 0, e RAID_DRIVE_STATUS_REBUILDING := 1, e RAID_DRIVE_STATUS_FAILED := 2, e RAID_DRIVE_STATUS_DEGRADED := 3 ); END_TYPE Name Value Meaning e RAID_DRIVE_STATUS_OK 0 Indicates that the physical drive is ready for operation. e RAID_DRIVE_STATUS_DEGRADED 1 Indicates that the physical drive has sent a SMART message to the controller. e RAID_DRIVE_STATUS_REBUILDING 2 Indicates that the physical drive is the target drive of a RAID set rebuild. If the Rebuild has been successfully completed, the status changes to e RAID_DRIVE_STATUS_OK. The status is updated accordingly if the rebuild fails. e RAID_DRIVE_STATUS_FAILED 3 Indicates that the physical drive has signaled unrecoverable errors to the controller or that the drive has started a vendor-specific action in order to remove the drive from the RAID set. There is no guarantee of the readiness for operation of the drive and loss of data has occurred or threatens. TE1000 Version: 1.5.3 127
## Page 128

Data Types Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.5 E_RAIDDrive Usage TYPE E_RAIDDrive Usage : ( e RAID_DRIVE_CONFIG_NOT_USED := 0, e RAID_DRIVE_CONFIG_MEMBER := 1, e RAID_DRIVE_CONFIG_SPARE := 2 ); END_TYPE Name Value Meaning e RAID_DRIVE_CONFIG_NOT_USED 0 Indicates that the physical drive is not part of a RAID set. e RAID_DRIVE_CONFIG_MEMBER 1 Indicates that the physical drive is part of a RAID set. e RAID_DRIVE_CONFIG_SPARE 2 Indicates that the physical drive is part of this RAID set as a “hot swap spare”. “hot swap spare” -> if a drive within the RAID group fails, it is replaced by the reserve drive (hot spare) while operation continues (hot swap). Redundancy is thus restored as quickly as possible. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.6 E_RAIDStatus TYPE E_RAIDStatus : ( e RAID_SET_STATUS_OK := 0, e RAID_SET_STATUS_DEGRADED := 1, e RAID_SET_STATUS_REBUILDING := 2, e RAID_SET_STATUS_FAILED := 3 ); END_TYPE Name Value Meaning e RAID_SET_STATUS_OK 0 Indicates that the RAID set is ready for operation. e RAID_SET_STATUS_DEGRADED 1 Indicates that the RAID set is no longer operating in an error-tolerant mode. e RAID_SET_STATUS_REBUILDING 2 Indicates that the RAID set is rebuilding. This means that operation is restricted. Once the rebuild has been successfully completed, the status changes to e RAID_SET_STATUS_OK. The status is updated accordingly if the rebuild fails. e RAID_SET_STATUS_FAILED 3 Indicates that the RAID set has failed. There is no guarantee of the readiness for operation of the RAID set and loss of data has occurred or threatens. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 128 Version: 1.5.3 TE1000
## Page 129

Data Types 5.7 E_RAIDType TYPE E_RAIDType : ( e RAID_TYPE_NONE := 0, e RAID_TYPE_0 := 1, e RAID_TYPE_1 := 2, e RAID_TYPE_10 := 3, e RAID_TYPE_5 := 4, e RAID_TYPE_15 := 5, e RAID_TYPE_OTHER := 255 ); END_TYPE Name Value Meaning e RAID_TYPE_NONE 0 Indicates that the RAID set consists of a single drive. No set exists with the specified number. e RAID_TYPE_0 1 Indicates that the RAID set is a striped set without error tolerance. e RAID_TYPE_1 2 Indicates that the RAID set is a mirrored set. e RAID_TYPE_10 3 Indicates that the RAID set is a striped and mirrored set. e RAID_TYPE_5 4 Indicates that the RAID set is a parity set. e RAID_TYPE_15 5 Indicates that the RAID set is an advanced parity set. e RAID_TYPE_OTHER 255 Indicates that the configuration of the RAID set does not correspond to the standard types. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.8 E_Sercos Attrib Len TYPE E_Sercos Attrib Len : ( e LEN_2BYTE := 1, (* 2 bytes, fixed length *) e LEN_4BYTE := 2, (* 4 bytes, fixed length *) e LEN_8BYTE := 3, (* 8 bytes, fixed length *) e LEN_V1BYTE := 4, (* 1 bytes, variable length *) e LEN_V2BYTE := 5, (* 2 bytes, variable length *) e LEN_V4BYTE := 6, (* 4 bytes, variable length *) e LEN_V8BYTE := 7 (* 8 bytes, variable length *) ); END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 5.9 E_Sercos Attrib Type TYPE E_Sercos Attrib Type : ( e Type_BIN := 0, e Type_UNSIGNED := 1, e Type_SIGNED := 2, e Type_HEX := 3, e Type_ASCII := 4, e Type_ID := 5, e Type_FLOAT := 6 ); END_TYPE TE1000 Version: 1.5.3 129
## Page 130

Data Types Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 5.10 E_Ups Comm Status Status of communication with the UPS hardware. TYPE E_Ups Comm Status : ( Ups Comm Unknown Status, Ups Comm Ok, Ups Comm Failed ); END_TYPE Name Value Meaning Ups Comm Unknown Status 0 The communication status is unknown. Ups Comm Ok 1 Communication has been established with the UPS. Ups Comm Failed 2 Communication with the UPS was interrupted. Requirements Development en- Target platform UPS hardware PLC libraries to be vironment integrated (cate- gory group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) • Beckhoff CU81x0-0xx0 Tc2_Io Functions (IO) • Beckhoff BAPI v1; • Beckhoff P24Vxxxx; • Beckhoff CP903x card (PCI/ISA); • Beckhoff CX2100-09x4 models (e.g. CX2100-0904 or CX2100-0914 + "Smart Battery" CX2900-0192); • The APC devices that come supplied with Beckhoff Industrial PC support the Smart protocol and can be configured with the Windows UPS service. 5.11 E_Ups Power Status Status of the power supply. TYPE E_Ups Power Status : ( Power Unknown Status, Power On Line, Power On Battery ); END_TYPE Name Value Meaning Power Unknown Status 0 The status of the power supply is unknown Power On Line 1 Mains power supply. Power On Battery 2 Battery power supply. 130 Version: 1.5.3 TE1000
## Page 131

Data Types Requirements Development en- Target platform UPS hardware PLC libraries to be vironment integrated (cate- gory group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) • Beckhoff CU81x0-0xx0 Tc2_Io Functions (IO) • Beckhoff BAPI v1; • Beckhoff P24Vxxxx; • Beckhoff CP903x card (PCI/ISA); • Beckhoff CX2100-09x4 models (e.g. CX2100-0904 or CX2100-0914 + "Smart Battery" CX2900-0192); • The APC devices that come supplied with Beckhoff Industrial PC support the Smart protocol and can be configured with the Windows UPS service. 5.12 IODEVICETYPES TYPE IODEVICETYPES: ( IODEVICETYPE_UNKNOWN := 0,(* Unknown device *) IODEVICETYPE_C1220 := 1,(* Beckhoff Lightbus-Master *) IODEVICETYPE_C1200 := 2,(* Beckhoff Lightbus-Master *) IODEVICETYPE_SPC3 := 3,(* Profi Bus Slave (Siemens) *) IODEVICETYPE_CIF30DPM := 4,(* ISA Profi Bus-Master 2 k Byte (Hilscher) *) IODEVICETYPE_CIF40IBSM := 5,(* ISA Interbus-S-Master 2 k Byte (Hilscher) *) IODEVICETYPE_BKHFPC := 6,(* Beckhoff PC C2001*) IODEVICETYPE_CP5412A2 := 7,(* Profi Bus-Master (Siemens)*) IODEVICETYPE_SERCANSISA := 8,(* Sercos Master (Indramat)*) IODEVICETYPE_LPTPORT := 9,(* Lpt Port*) IODEVICETYPE_DPRAM := 10,(* Generic DPRAM*) IODEVICETYPE_COMPORT := 11,(* COM Port*) IODEVICETYPE_CIF30CAN := 12,(* ISA CANopen-Master (Hilscher)*) IODEVICETYPE_CIF30PB := 13,(* ISA Profi Bus-Master 8 k Byte (Hilscher)*) IODEVICETYPE_BKHFCP2030 := 14,(* Beckhoff CP2030 (Pannel-Link)*) IODEVICETYPE_IBSSCIT := 15,(* Interbus-S-Master (Phoenix)*) IODEVICETYPE_CIF30IBM := 16,(* ISA Interbus-S-Master (Hilscher)*) IODEVICETYPE_CIF30DNM := 17,(* ISA Device Net-Master (Hilscher)*) IODEVICETYPE_FCXXXX := 18,(* Beckhoff-Fieldbus card *) IODEVICETYPE_CIF50PB := 19,(* PCI Profi Bus-Master 8 k Byte (Hilscher)*) IODEVICETYPE_CIF50IBM := 20,(* PCI Interbus-S-Master (Hilscher)*) IODEVICETYPE_CIF50DNM := 21,(* PCI Device Net-Master (Hilscher)*) IODEVICETYPE_CIF50CAN := 22,(* PCI CANopen-Master (Hilscher)*) IODEVICETYPE_CIF60PB := 23,(* PCMCIA Profi Bus-Master (Hilscher)*) IODEVICETYPE_CIF60DNM := 24,(* PCMCIA Device Net-Master (Hilscher)*) IODEVICETYPE_CIF60CAN := 25,(* PCMCIA CANopen-Master (Hilscher)*) IODEVICETYPE_CIF104DP := 26,(* PC104 Profi Bus-Master 2 k Byte (Hilscher)*) IODEVICETYPE_C104PB := 27,(* PC104 Profi Bus-Master 8 k Byte (Hilscher)*) IODEVICETYPE_C104IBM := 28,(* PC104 Interbus-S-Master 2 k Byte (Hilscher)*) IODEVICETYPE_C104CAN := 29,(* PC104 CANopen-Master (Hilscher)*) IODEVICETYPE_C104DNM := 30,(* PC104 Device Net-Master (Hilscher)*) IODEVICETYPE_BKHFCP9030 := 31,(* Beckhoff CP9030 (Pannel-Link with UPS)*) IODEVICETYPE_SMB := 32,(* Motherboard System Management Bus*) IODEVICETYPE_PBMON := 33,(* Beckhoff-PROFIBUS-Monitor*) IODEVICETYPE_CP5613 := 34,(* PCI Profi Bus-Master (Siemens)*) IODEVICETYPE_CIF60IBM := 35,(* PCMCIA Interbus-S-Master (Hilscher)*) IODEVICETYPE_FC200X := 36,(* Beckhoff-Lightbus-I/II-PCI-Karte*) IODEVICETYPE_FC3100_OLD := 37,(* obsolete: dont use*) IODEVICETYPE_FC3100 := 38,(* Beckhoff-Profibus-PCI*) IODEVICETYPE_FC5100 := 39,(* Beckhoff-Can Open-PCI*) IODEVICETYPE_FC5200 := 41,(* Beckhoff-Device Net-PCI*) IODEVICETYPE_BKHFNCBP := 43,(* Beckhoff NC back plane*) IODEVICETYPE_SERCANSPCI := 44,(* Sercos Master (SICAN/IAM PCI)*) IODEVICETYPE_ETHERNET := 45,(* Virtual Ethernet Device*) IODEVICETYPE_SERCONPCI := 46,(* Sercon 410B or 816 Chip Master or Slave (PCI)*) IODEVICETYPE_IBSSCRIRTLK := 47,(* Interbus-S-Master with Slave-Module LWL Basis (Phoenix)*) IODEVICETYPE_FC7500 := 48,(* Beckhoff-SERCOS-PCI*) IODEVICETYPE_CIF30IBS := 49,(* ISA Interbus-S-Slave (Hilscher)*) TE1000 Version: 1.5.3 131
## Page 132

Data Types IODEVICETYPE_CIF50IBS := 50,(* PCI Interbus-S-Slave (Hilscher)*) IODEVICETYPE_C104IBS := 51,(* PC104 Interbus-S-Slave (Hilscher)*) IODEVICETYPE_BKHFCP9040 := 52,(* Beckhoff CP9040 (CP-PC) *) IODEVICETYPE_BKHFAH2000 := 53,(* Beckhoff AH2000 (Hydr. Backplane) *) IODEVICETYPE_BKHFCP9035 := 54,(* Beckhoff CP9035 (PCI, Pannel-Link with UPS) *) IODEVICETYPE_AH2000MC := 55,(* Beckhoff-AH2000 with Profibus-MC *) IODEVICETYPE_FC3100MON := 56,(* Beckhoff-Profibus-Monitor-PCI *) IODEVICETYPE_USB := 57,(* Virtual USB Device *) IODEVICETYPE_FC5100MON := 58,(* Beckhoff-CANopen-Monitor-PCI *) IODEVICETYPE_FC5200MON := 59,(* Beckhoff-Device Net-Monitor-PCI *) IODEVICETYPE_FC3100SLV := 60,(* Beckhoff-Profibus-PCI Slave *) IODEVICETYPE_FC5100SLV := 61,(* Beckhoff-Can Open-PCI Slave *) IODEVICETYPE_FC5200SLV := 62,(* Beckhoff-Device Net-PCI Slave *) IODEVICETYPE_IBSSCITPCI := 63,(* PCI Interbus-S-Master (Phoenix) *) IODEVICETYPE_IBSSCRIRTLKPCI := 64,(* PCI Interbus-S-Master with Slave- Module LWL Basis (Phoenix) *) IODEVICETYPE_CX1100_BK := 65,(* Beckhoff-CX1100 terminal bus power supply *) IODEVICETYPE_ENETRTMP := 66,(* Ethernet real time miniport *) IODEVICETYPE_CX1500_M200 := 67,(* PC104 Lightbus-Master *) IODEVICETYPE_CX1500_B200 := 68,(* PC104 Lightbus-Slave *) IODEVICETYPE_CX1500_M310 := 69,(* PC104 Profi Bus-Master *) IODEVICETYPE_CX1500_B310 := 70,(* PC104 Profi Bus-Slave *) IODEVICETYPE_CX1500_M510 := 71,(* PC104 CANopen-Master *) IODEVICETYPE_CX1500_B510 := 72,(* PC104 CANopen-Slave *) IODEVICETYPE_CX1500_M520 := 73,(* PC104 Device Net-Master *) IODEVICETYPE_CX1500_B520 := 74,(* PC104 Device Net-Slave *) IODEVICETYPE_CX1500_M750 := 75,(* PC104 Sercos-Master *) IODEVICETYPE_CX1500_B750 := 76,(* PC104 Sercos-Slave *) IODEVICETYPE_BX_BK := 77,(* BX terminal bus interface *) IODEVICETYPE_BX_M510 := 78,(* BX SSB-Master *) IODEVICETYPE_BX_B310 := 79,(* BX Profi Bus-Slave *) IODEVICETYPE_IBSSCRIRTPCI := 80,(* PCI Interbus-S- Master with slave module copper basis (Phoenix) *) IODEVICETYPE_BX_B510 := 81,(* BX CANopen Slave *) IODEVICETYPE_BX_B520 := 82,(* BX Device Net Slave *) IODEVICETYPE_BC3150 := 83,(* BCxx50 Profi Bus Slave *) IODEVICETYPE_BC5150 := 84,(* BCxx50 CANopen Slave *) IODEVICETYPE_BC5250 := 85,(* BCxx50 Device Net Slave *) IODEVICETYPE_EL6731 := 86,(* Beckhoff Profibus-Ether CAT Terminal *) IODEVICETYPE_EL6751 := 87,(* Beckhoff Can Open-Ether CAT Terminal *) IODEVICETYPE_EL6752 := 88,(* Beckhoff Device Net-Ether CAT Terminal *) IODEVICETYPE_COMPB := 89,(* COM Profi Bus Master 8 k Byte (Hilscher) *) IODEVICETYPE_COMIBM := 90,(* COM Interbus-S Master (Hilscher) *) IODEVICETYPE_COMDNM := 91,(* COM Device Net Master (Hilscher) *) IODEVICETYPE_COMCAN := 92,(* COM CANopen Master (Hilscher) *) IODEVICETYPE_COMIBS := 93,(* COM CANopen Slave (Hilscher) *) IODEVICETYPE_ETHERCAT := 94,(* Ether CAT in direct mode *) IODEVICETYPE_PROFINETIOCONTROLLER:= 95,(* PROFINET Master *) IODEVICETYPE_PROFINETIODEVICE := 96,(* PROFINET Slave *) IODEVICETYPE_EL6731SLV := 97,(* Beckhoff Profibus Slave Ether CAT Terminal *) IODEVICETYPE_EL6751SLV := 98,(* Beckhoff Can Open Slave Ether CAT Terminal *) IODEVICETYPE_EL6752SLV := 99,(* Beckhoff Device Net Slave Ether CAT Terminal *) IODEVICETYPE_C104PPB := 100,(* PC104+ Profi Bus Master 8 k Byte (Hilscher) *) IODEVICETYPE_C104PCAN := 101,(* PC104+ CANopen Master (Hilscher) *) IODEVICETYPE_C104PDNM := 102,(* PC104+ Device Net Master (Hilscher) *) IODEVICETYPE_BC8150 := 103,(* BCxx50 Serial Slave *) IODEVICETYPE_BX9000 := 104,(* BX9000 Ethernet Slave *) IODEVICETYPE_CX9000_BK := 105,(* Beckhoff-CX9000 K-Bus Power Supply *) IODEVICETYPE_EL6601 := 106,(* Beckhoff-RT-Ethernet-Ether CAT-Terminal *) IODEVICETYPE_BC9050 := 107,(* BC9050 Ethernet Slave *) IODEVICETYPE_BC9120 := 108,(* BC9120 Ethernet Slave *) IODEVICETYPE_ENETADAPTER := 109,(* Ethernet Miniport Adapter *) IODEVICETYPE_BC9020 := 110,(* BC9020 Ethernet Slave *) IODEVICETYPE_ETHERCATPROT := 111,(* Ether CAT Protocol in direct mode *) IODEVICETYPE_ETHERNETNVPROT := 112,(* *) IODEVICETYPE_ETHERNETPNMPROT := 113,(* Profinet Controller *) IODEVICETYPE_EL6720 := 114,(* Beckhoff-Lightbus-Ether CAT-Terminal *) IODEVICETYPE_ETHERNETPNSPROT := 115,(* Profinet Device*) IODEVICETYPE_BKHFCP6608 := 116,(* Beckhoff CP6608(IXP PC) *) IODEVICETYPE_PTP_IEEE1588 := 117,(* *) IODEVICETYPE_EL6631SLV := 118,(* EL6631-0010 Profinet Slave terminal *) IODEVICETYPE_EL6631 := 119,(* EL6631 Profinet Master terminal *) IODEVICETYPE_CX5000_BK := 120,(* Beckhoff-CX5100 K-Bus power supply *) IODEVICETYPE_PCIDEVICE := 121,(* Generic PCI DPRAM (TCOM) *) IODEVICETYPE_ETHERNETUPDPROT := 122,(* UDP Protocol *) IODEVICETYPE_ETHERNETAUTOPROT := 123,(* Automation Protocol *) IODEVICETYPE_CCAT := 124,(* CCAT *) IODEVICETYPE_CPLINK3 := 125,(* Virtuell USB Device (remote via CPLINK3) *) IODEVICETYPE_EL6632 := 126,(* EL6632 *) IODEVICETYPE_CCAT_PBM := 127,(* CCAT Profibus Master *) 132 Version: 1.5.3 TE1000
## Page 133

Data Types IODEVICETYPE_CCAT_PBS := 128,(* CCAT Profibus Slave *) IODEVICETYPE_CCAT_CNM := 129,(* CCAT CANopen Master *) IODEVICETYPE_ETHERCATSLAVE := 130,(* Ether CAT Slave *) IODEVICETYPE_BACNET := 131,(* BACnet device *) IODEVICETYPE_CCAT_CNS := 132,(* CCAT CANopen Slave *) IODEVICETYPE_ETHIP_SCANNER := 133,(* ETHERNET IP Master *) IODEVICETYPE_ETHIP_ADAPTER := 134,(* ETHERNET IP Slave (OLD) *) IODEVICETYPE_CX8000_BK := 135,(* Beckhoff-CX8100 K-Bus Power Supply - LEGACY use IODEVICETYPE_CX_BK *) IODEVICETYPE_ETHERNETUDPPROT := 136,(* Upd Protocol *) IODEVICETYPE_BC9191 := 137,(* BC9191 Ethernet Slave *) IODEVICETYPE_ENETPROTOCOL := 138,(* Real-Time Ethernet Protocol (BK90xx, AX2000-B900) *) IODEVICETYPE_ETHIP_ADAPTEREX := 139,(* ETHERNET IP Slave (NEW) *) IODEVICETYPE_PNCONTR_CCAT_RT := 140,(* Profinet Controller CCAT RT *) IODEVICETYPE_PNCONTR_CCAT_IRT := 141,(* Profinet Controller CCAT RT + IRT *) IODEVICETYPE_PNDEV_CCAT_RT := 142,(* Profinet Device CCAT RT *) IODEVICETYPE_PNDEV_CCAT_IRT := 143,(* Profinet Device CCAT RT + IRT *) IODEVICETYPE_ETHERCATSIMULATION := 144,(* Ether CAT-Simulation *) IODEVICETYPE_EL6652SLV := 145,(* EL6652-0010 *) IODEVICETYPE_PTP_VIA_CCAT := 146,(* PTP CLock via CCAT *) IODEVICETYPE_BACNETR9 := 147,(* BACnet Rev9 device *) IODEVICETYPE_ETHERCATXFC := 148,(* Ether CAT in xfc mode *) IODEVICETYPE_CX2500_0030 := 149,(* CX2500-0030 RS232 Serial Communication Port *) IODEVICETYPE_CX2500_0031 := 150,(* CX2500-0031 RS422/RS485 Serial Communication Port *) IODEVICETYPE_EL6652MST := 151,(* EL6652 *) (* Reserved for new devices*) IODEVICETYPE_MAX ); END_TYPE Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 5.13 ST_Ads Tec Sys Data TYPE ST_Ads Tec Sys Data STRUCT b Shift Key : BOOL;(* TRUE == Shift key pressed*) b RMouse Key : BOOL;(* TRUE == Right mouse key pressed *) b Hot Key : BOOL;(* TRUE == Hotkey pressed *) b Task Cha Key : BOOL;(* TRUE == Task change key pressed *) b ABCKey : BOOL;(* TRUE == ABC soft keyboard key pressed*) b Rsrv1 : BOOL; b Rsrv2 : BOOL; b Rsrv3 : BOOL; b Main Fan Err : BOOL;(* TRUE == Main fan error*) b Cpu Fan Err : BOOL;(* TRUE == CPU fan error*) b Temp Err : BOOL;(* TRUE == Internal temperature error ( temp > 50°C)*) b Battery Err : BOOL;(* TRUE == Battery error *) b Rsrv4 : BOOL; b Rsrv5 : BOOL; b Rsrv6 : BOOL; b Rsrv7 : BOOL; n Main Ntc Temp : SINT;(* Main NTC temperature (-127°C .. + 127°C) *) n Ext Ntc Temp : SINT;(* External NTC temperature (-127°C .. + 127°C) *) n Rsrv8 : ARRAY[1..12] OF BYTE; END_STRUCT END_TYPE Name Type Description b Shift Key BOOL “Shift” key pressed (key on the far right in the front) b RMouse Key BOOL “Right mouse” button pressed b Hot Key BOOL “Hotkey” pressed b Task Cha Key BOOL “Task change” key pressed TE1000 Version: 1.5.3 133
## Page 134

Data Types Name Type Description b ABCKey BOOL “ABC soft keyboard” key pressed b Main Fan Err BOOL Main fan error b Cpu Fan Err BOOL CPU fan error b Temp Err BOOL Temperature error (internal temperature > 50 °C) b Battery Err BOOL Battery error (currently reserved) n Main Ntc Temp SINT Temperature value 1 (soldered NTC -127 °C .. + 127 °C) n Ext Ntc Temp SINT Temperature value 2 (connectable NTC, not available with every device) b Rsrv1 - b Rsrv7 ARRAY OF BYTE Reserved n Rsrv8 ARRAY OF BYTE Reserved Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 None. This functionality is ads-tec PC Tc2_Io Functions (IO) not supported by Twin CAT 3 at present! 5.14 ST_Dpv1Param Addr Ex ST_Dpv1Param Addr Ex contains the data of a Profidrive parameter. TYPE ST_Dpv1Param Addr Ex : STRUCT i Attribute : USINT; i Num Of Elements : USINT; i Parameter Number : UINT; i Sub Index : UINT; i Data Addr : PVOID; i Data Size : UDINT; e Format : E_PD_Datatype; i Num Of Values : UINT; i Error Value : UDINT; st Error : ST_PD_Dpv1Error; END_STRUCT END_TYPE Name Type Description i Attribute USINT 0x10: Value; 0x20: Description; 0x30: Text; 0x80.. F0: Vendor-specific; other values are reserved. i Num Of Elements USINT 1..234: number of elements; 0: special functions; other values are reserved i Parameter Number UINT 1..65535: parameter number; 0: reserved i Sub Index UINT 0..65535: sub-index i Data Addr PVOID Address of the buffer/address of the PLC variables. i Data Size UDINT Size of the buffer/size of the PLC variables. e Format E_PD_Datatype 0x01..0x36: Data type; 0x40: ZERO; 0x41: BYTE; 0x42: WORD; 0x43: DWORD; 0x44: Error; other values are reserved. i Num Of Values UINT 0..234: number of values; other values are reserved i Error Value UDINT DPV1 error value st Error ST_PD_Dpv1Error DPV1 error flag, DPV1 error enumeration type 134 Version: 1.5.3 TE1000
## Page 135

Data Types Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731, EL6632 5.15 ST_Dpv1Value Header Ex ST_Dpv1Value Header Ex contains the data of a parameter in the DPV1 telegram and its string representation. TYPE ST_Dpv1Value Header Ex : STRUCT e Format : E_PD_Datatype; i Num Of Values : USINT; i Offset : USINT; i Data Len : UINT; str Data : STRING; END_STRUCT END_TYPE Name Type Description e Format E_PD_Datatype 0x01..0x36: Data type; 0x40: ZERO; 0x41: BYTE; 0x42: WORD; 0x43: DWORD; 0x44: Error; other values are reserved. i Num Of Values USINT 0..234: number of values; other values are reserved. i Offset USINT Offset in the DPV1 answer telegram i Data Len UINT Data length str Data STRING Data as STRING Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731, EL6632 5.16 ST_Nov Ram Addr Info TYPE ST_Nov Ram Addr Info: STRUCT p Card Address : POINTER TO DWORD; i Card Mem Size : UDINT; END_STRUCT END_TYPE Name Type Description p Card Address POINTER TO DWORD The address pointer of the NOV/DP-RAM i Card Mem Size UDINT The configured NOV/DP-RAM size in bytes. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) TE1000 Version: 1.5.3 135
## Page 136

Data Types 5.17 ST_Nov Ram Addr Info Ex TYPE ST_Nov Ram Addr Info Ex: STRUCT p Card Address : POINTER TO DWORD; i Card Mem Size : UDINT; e Access Type : E_IOACCESSTYPE END_STRUCT END_TYPE Name Type Description p Card Address POINTER TO DWORD The address pointer of the NOV/DP-RAM i Card Mem Size UDINT The configured NOV/DP-RAM size in bytes. e Access Type E_IOACCESSTYPE The access type to the NOV/DP-RAM. • e IOAccess_Default: normal access via MEMCPY function possible • e IOAccess_Byte: only BYTE access via FOR loop possible • e IOAccess_Word Swap: only WORD access + high/low byte swapping via FOR loop possible Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 5.18 ST_Parameter_IN Input data of the ASI terminal. TYPE ST_Parameter Buffer : STRUCT i Parameter Status : WORD; i Parameter Read Value : DWORD; END_STRUCT END_TYPE Byte Offset Bit Offset Description 0 0-5 Status bits (as with previous terminals) 0 6 0: no diagnosis, 1: diagnosis (as with previous terminals) 0 7 always 0: no register communication 1 0-3 0-3 reserved for extensions 1 4 Toggle bit for acknowledging order (in case of cyclic, bit 6 is copied from byte 0) 1 5 Acknowledgement (0: No Error, 1: Error) 1 6 0: Cyclic, 1: Acyclic 1 7 0: Parameter access, 1: ADS 2 Input data (cyclic), parameter value (acyclic) or error number bits 0-7 3 Input data (cyclic), parameter value (acyclic) or error number bits 8-15 4 Input data (cyclic), parameter value (acyclic) or error number bits 16-23 5 Input data (cyclic), parameter value (acyclic) or error number bits 24-31 136 Version: 1.5.3 TE1000
## Page 137

Data Types Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 5.19 ST_Parameter_OUT Output data to the ASI terminal. TYPE ST_Parameter Buffer : STRUCT Parameter Control : WORD; i Parametervalue : DWORD; END_STRUCT END_TYPE Byte Offset Bit Offset Description 0 0-5 Parameter number bits 0-5 (or parameter offset) 0 6 In case of Acyclic: 0: Read, 1:Write, in case of Cyclic (always Read/Write) the bit is copied into the input data to have a direct assignment (then the Cyclic data could also be changed) 0 7 0: Parameter access, 1: Register communication 1 0-5 Parameter number bits 6-11 (or parameter page) 1 6 0: Cyclic, 1: Acyclic 1 7 0: Parameter access, 1: ADS 2 Output data (cyclic) or parameter value (acyclic) bits 0-7 3 Output data (cyclic) or parameter value (acyclic) bits 8-15 4 Output data (cyclic) or parameter value (acyclic) bits 16-23 5 Output data (cyclic) or parameter value (acyclic) bits 24-32 Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) 5.20 ST_Parameter Buffer Data buffer for the I/O data of the ASI terminal TYPE ST_Parameter Buffer : STRUCT Parameter Control : ARRAY[0..50] OF WORD; i Parametervalue : ARRAY[0..50] OF DWORD; i Parameter Status : ARRAY[0..50] OF WORD; i Parameter Read Value : ARRAY[0..50] OF DWORD; icounter State : INT; icounter Control : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) ASI master terminal Tc2_Io Functions (IO) TE1000 Version: 1.5.3 137
## Page 138

Data Types 5.21 ST_PD_Dpv1Error TYPE ST_PD_Dpv1Error : STRUCT b Error : BOOL; e Error Id : E_PD_Dpv1Error; END_STRUCT END_TYPE Name Type Description b Error BOOL Error flag (TRUE => error, FALSE => no error) e Error ID E_PD_Dpv1Error [} 125] Error code Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Beckhoff FC310x PCI, Tc2_Io Functions (IO) CX1500-M310, EL6731, EL6632 5.22 ST_PNET_CCDSTS TYPE ST_PNET_CCDSTS : STRUCT i Cycle Counter : UINT; i Data State : USINT; i Transfer State : USINT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 5.23 ST_PNIOConfig Record TYPE ST_PNIOConfig Record : STRUCT i RW : UINT; i Num Of AR : UINT; i API : UDINT; i Slot : UINT; i Sub Slot : UINT; st PNIORecord : ST_PNIORecord; END_STRUCT END_TYPE Name Type Description i RW UINT 0: Read, 1: Write. i Num Of AR UINT Number of arguments. i API UDINT API number. i Slot UINT Slot number. i Sub Slot. UINT Sub Slot number. st PNIORecord ST_PNIORecord [} 139] Type: ST_PNIORecord [} 139] 138 Version: 1.5.3 TE1000
## Page 139

Data Types Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 5.24 ST_PNIORecord TYPE ST_PNIORecord : STRUCT i Index : UINT; i Length : UINT; (* 0 for READ *) i Transf Seq : UINT; i Aligned : UINT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 5.25 ST_PNIOState TYPE ST_PNIOState : STRUCT b In Data Exchange : BOOL; (* bit 0 *) b Appl Running : BOOL; (* bit 2 *) b Diag Indicator : BOOL; (* bit 3 *) END_STRUCT END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) Beckhoff EL6632 Tc2_Io Functions (IO) 5.26 ST_PZD_IN Data words from the drive to the PLC. TYPE ST_PZD_IN : STRUCT w STW :WORD; w HIW :WORD; PZD3 :WORD; PZD4 :WORD; PZD5 :WORD; PZD6 :WORD; END_STRUCT END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 5.27 ST_PZD_OUT Data words from the PLC to the drive. TE1000 Version: 1.5.3 139
## Page 140

Data Types TYPE ST_PZD_OUT : STRUCT w Ctrl W :WORD; PZD2 :WORD; PZD3 :WORD; PZD4 :WORD; PZD5 :WORD; PZD6 :WORD; END_STRUCT END_TYPE Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC or CX (x86) AX2000 Profibus box Tc2_Io Functions (IO) 5.28 ST_RAIDCntlr Found TYPE ST_RAIDCntlr Found : STRUCT n RAIDCntlr Count : UDINT; n RAIDCntlr Ids : ARRAY [1..g_n MAX_NUMBER_OF_RAID_CNTLRS] OF UDINT; END_STRUCT END_TYPE Name Type Description n RAIDCntlr Count UDINT Number of RAID controllers n RAIDCntlr Ids ARRAY OF UDINT ID of each RAID controller (default value is 4294967295 and therefore invalid). g_n MAX_NUMBER_OF_RAID_CNTLRS is the maximum number of RAID controllers and is defined as a global constant = 10. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.29 ST_RAIDConfig Req TYPE ST_RAIDConfig Req : STRUCT n RAIDCntlr ID : UDINT; n RAIDSet Index : UDINT; END_STRUCT END_TYPE Name Type Description n RAIDCntlr ID UDINT ID of the RAID controller n RAIDSet Index ARRAY OF UDINT Contains the number of the RAID set for which information is being requested. Please note that the set begins with index 0 in the case of Beckhoff CBx051 boards. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 140 Version: 1.5.3 TE1000
## Page 141

Data Types 5.30 ST_RAIDDrive Status TYPE ST_RAIDDrive Status : STRUCT e RAIDDrive Status : E_RAIDDrive Status; e RAIDDrive Usage : E_RAIDDrive Usage; n SATAPort : UINT; s RAIDDrive Serial : STRING [39]; END_STRUCT END_TYPE Name Type Description e RAIDDrive Status E_RAIDDrive Status [} 127] Contains the status of the physical drive. e RAIDDrive Usage E_RAIDDrive Usage [} 128] States whether the physical drive is part of the RAID set. n SATAPort UINT Contains the SAS address of the physical drive. If the drive has no SAS address, e.g. with a directly attached SATA drive, then this field should be filled with 0. s RAIDDrive Serial STRING Serial number of the RAID drive (40 letters). Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.31 ST_RAIDInfo TYPE ST_RAIDInfo : STRUCT n Num RAIDSets : UDINT; n Max Drives Per Set : UDINT; b Reserved : ARRAY [1..92] OF BYTE; END_STRUCT END_TYPE Name Type Description n Num RAIDSets UDINT Number of currently defined RAID sets. 0 is returned if no sets have been defined yet. n Max Driver Per Set UDINT Maximum number of physical drives in a logical RAID set. This can be an absolute maximum or the maximum currently defined for all sets. b Reserved UDINT Reserved for internal purposes. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.32 ST_RAIDStatus Res TYPE ST_RAIDStatus Res : STRUCT n RAIDSet Index : UDINT; e RAIDType : E_RAIDType; e RAIDStatus : E_RAIDStatus; n RAIDDrive Count : UINT; n Reserved : UINT; st RAIDDrive Status : ARRAY [1..g_n MAX_NUMBER_OF_RAID_DRIVES] OF ST_RAIDDrive Status; END_STRUCT END_TYPE Name Type Description n RAIDSet Index UDINT RAID set ID, as for the input. TE1000 Version: 1.5.3 141
## Page 142

Data Types Name Type Description e RAIDType E_RAIDType [} 129] Contains the basic RAID type of the RAID set e RAID_TYPE_NONE indicates that the RAID set consists of a single drive, i.e. no set with the specified number exists. e RAIDStatus E_RAIDStatus [} 128] Contains the status of the RAID set n RAIDDrive Count UINT Contains the number of drives in the RAID set n Reserved UINT Reserved st RAIDDrive Status ST_RAIDDrive Status Contains the status of the physical drive and information on whether the physical drive is part of the RAID set. [} 141] n RAIDSet Index ARRAY OF RAID set ID, as for the input. ST_RAIDDrive Status g_n MAX_NUMBER_OF_RAID_DRIVES is the number of RAID drive states that can be read and is defined as a global constant = 10. Requirements Development environment Target platform PLC libraries to be integrated (category group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) Tc2_Io Functions (IO) 5.33 ST_Sercos Param Attrib ST_Sercos Param Attrib contains the n Attrib attribute of the Sercos parameter, broken down into individual variables. TYPE ST_Sercos Param Attrib : STRUCT n Factor : UINT; e Length : E_Sercos Attrib Len; b Command : BOOL; e Type : E_Sercos Attrib Type; b Reserved1 : BOOL; n Comma : USINT; b Write Prot CP2 : BOOL; b Write Prot CP3 : BOOL; b Write Prot CP4 : BOOL; b Reserved2 : BOOL; END_STRUCT END_TYP Name Type Description n Factor UINT Bits 0..15. e Length E_Sercos Attrib Len [} 129] Bits 16..18. b Command BOOL Bit 19. e Type E_Sercos Attrib Type [} 129] Bits 20..22. b Reserved1 BOOL Bit 23. n Comma USINT Bits 24..27. b Write Prot CP2 BOOL Bit 28. b Write Prot CP3 BOOL Bit 29. b Write Prot CP4 BOOL Bit 30. b Reserved2 BOOL Bit 31. 142 Version: 1.5.3 TE1000
## Page 143

Data Types Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 5.34 ST_Sercos Param Err List TYPE ST_Sercos Param Err List : STRUCT i Act Count : UINT; i Max Count : UINT; i List : ARRAY [0..2047] OF UINT; i Error : ARRAY [0..2047] OF UDINT; END_STRUCT END_TYPE Name Type Description i Act Count UINT Number of parameters skipped (here 3 = 3 parameter errors). i Max Count UINT Number of parameters skipped (here 3 = 3 parameter errors). i List ARRAY OF UINT Field of up to 2048 parameter numbers where access errors occurred. i Error ARRAY OF UDINT Field of up to 2048 access error numbers. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 5.35 ST_Sercos Param List TYPE ST_Sercos Param List : STRUCT i Act Count : UINT; i Max Count : UINT; i List : ARRAY [0..2047] OF UINT; END_STRUCT END_TYPE Name Type Description i Act Count UNIT Current number of parameters in a list * 2. Sercos saves the number of bytes here; a parameter number consists of two bytes, e.g. 6 means 3 parameters. i Max Count UINT Maximum number of parameters in a list * 2. Sercos saves the number of bytes here, a parameter number consists of two bytes, e.g. 6 means 3 parameters. i List ARRAY OF UINT Field of up to 2048 parameter numbers. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI TE1000 Version: 1.5.3 143
## Page 144

Data Types 5.36 ST_UPSStatus TYPE ST_UPSStatus STRUCT Vendor : STRING; (* UPS vendor name *) Model : STRING; (* UPS model name *) Firmware Rev : STRING; (* UPS firmware revision *) Serial Number : STRING; (* UPS serial number *) Battery Life Percent : DWORD; (* The percent of battery capacity remaining in the UPS (0..100%) *) Battery Life Time : DWORD; (* Remaining UPS run time, in minutes *) e Battery Status : E_Battery Status; (* UPS battery state *) e Comm Status : E_Ups Comm Status; (* Status of the communication path to the UPS *) e Power Status : E_Ups Power Status; (* Status of utility-supplied power into the UPS *) n Power Fail Cnt : DWORD; (* Power Fail counter. Increments every time the UPS service detects power fail *) dw Charge Flags : DWORD; (* Battery charge status flags. This member can be one or more of th e following values. Bits0..7 := General battery status flags (if all bits are set to 0 => unknown status) Bit0 := High (bit set => high battery charge) Bit1 := Low (bit set => low battery charge) Bit2 := Critical (bit set => battery is near empty) Bit3 := Charging (bit set => battery is charging) Bits4..6 := reserved (all bits are 0) Bit7 := No Battery (bit set => battery not found or not connected, bit not set => battery is existing or unknown state) Bits8..15 := Special status information (if all bits are set to 0 => state ok or unknown state) Bit8 := UPS Fan Error (bit set => fan hardware reports an error, bit not set => fan is ok) Bit9 := Over Temperature (bit set => over temperature detected, bit not set => temperature i s ok) Bit10 := Service Interval Notify (bit set => service interval time expired, bit not set =>se rvice interval time not expired ) Bit11 := Under Temperature (bit set => under temperature detected , bit not set => temperatu re is ok ) Bit12 := Fuse Not Ok (bit set => fuse broken or missed, bit not set => fuse ok) Bit13 := Alarm1 (reserved for later use, bit is 0) Bit14 := Alarm2 (reserved for later use, bit is 0) Bit15 := Alarm3 (reserved for later use, bit is 0) Bits16..31 := (reserved for later use, all bits are 0) *) END_STRUCT END_TYPE Not all UPS models can supply every item of status information. X: The status information is available with this model. *) Available only if the model “Smart Signaling to any APC UPS & Twin CAT” has been configured. Status in- CU81x0-0xx0 Beckhoff BAPI Beckhoff Beckhoff 24V CX2100-09x4 APC APC Description formation v1 P24Vxxxx UPS UPS on the Back- Smart- CP903x card UPS Pro UPS 420 280 Vendor X X X X X X X Vendor name. Model X X X X X X X Model string. Empty string if no UPS has been configured. Firmware X X X X X X X UPS firmware Rev version information. Empty string if the UPS does not support this parameter. Serial Num X X X None X X X Serial number ber of the UPS. Empty string if the UPS does not support this parameter. Battery Lif X X X None X X X Remaining e Percent battery life in percent. The value is always 144 Version: 1.5.3 TE1000
## Page 145

Data Types Status in- CU81x0-0xx0 Beckhoff BAPI Beckhoff Beckhoff 24V CX2100-09x4 APC APC Description formation v1 P24Vxxxx UPS UPS on the Back- Smart- CP903x card UPS Pro UPS 420 280 zero if the UPS cannot supply this parameter. Battery Lif X X X None X X X Remaining e Time battery life in minutes. The value is always zero if the UPS cannot supply this parameter. e Battery St Battery Unkno Battery Ok Battery Unkno Battery Unkno Battery Unkno X X Battery status atus wn Status wn Status if no wn Status if no wn Status (type: when no battery exists; battery exists. when no E_Battery Statu battery is from UPS battery is s). present software present (applicable only version >= Battery Ok (applicable only for the model 2.0.0.6 and for the model with battery). UPS firmware with "Smart >= 25.1. I Battery" and Battery Ok not with capacitors) Battery Ok Battery Ok e Comm St X X X X X X X Status of the atus communication with the UPS (type: E_Ups Comm St atus). e Power St X X X X X X X Status of atus external power supply (type: E_Ups Power St atus). n Power Fa X X X X X *X *X Power-fail il Cnt counter. The counter is incremented if a voltage failure is detected by the UPS service. dw Charge No Battery (bit No Battery (bit No Battery (bit High (bit 0 set) No Battery (bit None None Battery charge Flags 7 set). No 7 set) from 7 set) from if battery is fully 7 set). No status flags and communication UPS firmware UPS software charged. communication special status to the battery >=33.12-0 if no version >= to the battery information. (applicable only battery 2.0.0.6 and (applicable only for the model isconnected. firmware >= Charging (bit 3 for the model with battery). 25.1. I. The set) with "Smart Service existence of the Battery" and Service Interval Notify battery is not with Interval Notify (bit 10 set). The checked every No Battery (bit capacitors). (bit 10 set). The configured minute. 7 set) if no configured battery change battery was battery service interval service found. Over interval has has expired UPS Fan Error Temperature expired. (bit 8 set) from (bit 9 set) was UPS software detected and version >= the charging of 2.0.0.7 and the battery was firmware >= interrupted. 40.1. I. The Requires a UPS fan status newer is checked (second) each minute. hardware Requires a revision. newer Implemented in (second) the UPS hardware software revision! version >= 3.0.0.18. TE1000 Version: 1.5.3 145
## Page 146

Data Types Status in- CU81x0-0xx0 Beckhoff BAPI Beckhoff Beckhoff 24V CX2100-09x4 APC APC Description formation v1 P24Vxxxx UPS UPS on the Back- Smart- CP903x card UPS Pro UPS 420 280 Service Service Interval Notify Interval Notify (bit 10 set). The (bit 10 set). The configured configured battery change battery service interval service interval has has expired. expired. Implemented in the UPS software Under version >= Temperature 3.0.0.8; (bit 11 set) was detected and the charging of the battery was interrupted. Requires a newer (second) hardware revision. Implemented in the UPS software version >= 3.0.0.18. Fuse Not Ok (bit 12 set). The "Smart Battery" fuse is defective or not available. Requires a newer (second) hardware revision. Implemented in the UPS software version >= 3.0.0.18. Requirements Development en- Target platform UPS hardware PLC libraries to be vironment integrated (cate- gory group) Twin CAT v3.1.0 PC or CX (x86, x64, ARM) • Beckhoff CU81x0-0xx0 Tc2_Io Functions (IO) • Beckhoff BAPI v1; • Beckhoff P24Vxxxx; • Beckhoff CP903x card (PCI/ISA); • Beckhoff CX2100-09x4 models (e.g. CX2100-0904 or CX2100-0914 + "Smart Battery" CX2900-0192); • The APC devices that come supplied with Beckhoff Industrial PC support the Smart protocol and can be configured with the Windows UPS service. 146 Version: 1.5.3 TE1000
## Page 147

Data Types 5.37 ST_KL1501In Data Structure for linking in the input process image. TYPE ST_KL1501In Data : STRUCT i Status : USINT; arr Data In : ARRAY[0..1] OF UINT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL1501 Tc2_Io Functions from v3.3.5.0 5.38 ST_KL1501Out Data Structure for linking in the output process image. TYPE ST_KL1501Out Data : STRUCT i Ctrl : USINT; arr Data Out : ARRAY[0..1] OF UINT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL1501 Tc2_Io Functions from v3.3.5.0 5.39 ST_KL27x1In Data Structure for linking in the input process image. TYPE ST_KL27x1In Data : STRUCT i Status : USINT; i Data In : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL2751, KL2761 Tc2_Io Functions from v3.3.5.0 5.40 ST_KL27x1Out Data Structure for linking in the output process image. TYPE ST_KL27x1Out Data : STRUCT i Ctrl : USINT; i Data Out : INT; END_STRUCT END_TYPE TE1000 Version: 1.5.3 147
## Page 148

Data Types Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL2751, KL2761 Tc2_Io Functions from v3.3.5.0 5.41 ST_KL320x In Data Structure for linking in the input process image. TYPE ST_KL320x In Data : STRUCT i Status : USINT; i Data In : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3201, KL3202, KL3204 Tc2_Io Functions from v3.3.5.0 5.42 ST_KL320x Out Data Structure for linking in the output process image. TYPE ST_KL320x Out Data : STRUCT i Ctrl : USINT; i Data Out : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3201, KL3202, KL3204 Tc2_Io Functions from v3.3.5.0 5.43 ST_KL3208In Data Structure for linking in the input process image. TYPE ST_KL3208In Data : STRUCT i Status : USINT; i Data In : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3208 Tc2_Io Functions from v3.3.5.0 148 Version: 1.5.3 TE1000
## Page 149

Data Types 5.44 ST_KL3208Out Data Structure for linking in the output process image. TYPE ST_KL3208Out Data : STRUCT i Ctrl : USINT; i Data Out : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3208 Tc2_Io Functions from v3.3.5.0 5.45 ST_KL3228In Data Structure for linking in the input process image. TYPE ST_KL3228In Data : STRUCT i Status : USINT; i Data In : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3228 Tc2_Io Functions from v3.3.5.0 5.46 ST_KL3228Out Data Structure for linking in the output process image. TYPE ST_KL3228Out Data : STRUCT i Ctrl : USINT; i Data Out : INT; END_STRUCT END_TYPE Requirements Development environ- Target platform IO Hardware PLC libraries to include ment Twin CAT v3.1.4018.26 PC/CX KL3228 Tc2_Io Functions from v3.3.5.0 TE1000 Version: 1.5.3 149
## Page 150

Global constants 6 Global constants 6.1 Library version All libraries have a certain version. This version is displayed in the repository of the PLC library. The version number of the library is stored in a global constant. Global_Version VAR_GLOBAL CONSTANT st Lib Version_Tc2_Io Functions : ST_Lib Version; END_VAR Name Type Description st Lib Version_Tc2_Io ST_Lib Version Version number of the Tc2_Io Functions library Functions The F_Cmp Lib Version function (in the Tc2_System library) is used to compare the existing and required version Compatibility with Twin CAT 2 Query options for Twin CAT 2 libraries are no longer available. Requirements Development environ- Target plat- IO hardware PLC libraries to be integrated (category group) ment form Twin CAT v3.1.0 PC or CX All IO devices Tc2_Io Functions (IO) (x86, x64, ARM) 150 Version: 1.5.3 TE1000
## Page 151

Appendix 7 Appendix 7.1 SERCOS file format of the backup file 1. File header of the type ST_Sercos File Header 2. n * data a) Parameter header of the type ST_Param Header b) Parameter data as bytes Sample for n parameters 1 * ST_Sercos File Header (268 Bytes) ----------------------------------------------------- n Version ( 4 Bytes) n List Type ( 4 Bytes) cb Comment Len ( 4 Bytes) s Comment ( 256 Bytes) n * (ST_Sercos Param Header + Data) ----------------------------------------------------- n IDN ( 2 Bytes) cb Size ( 2 Bytes) n Attrib ( 4 Bytes) arr Data (cb Size Bytes), kann für jeden Parameter verschieden groß sein, je nach Typ oder Listenlänge Sample for 3 parameters ST_Sercos File Header (268 Bytes) ---------------------------------------------------------------------------- n Version ( 4 Bytes), i.e. = 01 00 00 00 (= 1) n List Type ( 4 Bytes), i.e. = 00 00 00 00 cb Comment Len ( 4 Bytes), i.e. = 00 00 00 00 (= 0) s Comment ( 256 Bytes), i.e. = 00 00 00 00 00 00 00 ... 00 (256 * 00) 1st parameter ST_Sercos Param Header + Data (10 Bytes) ---------------------------------------------------------------------------- n IDN ( 2 Bytes), i.e. = nnnncb Size( 2 Bytes), i.e. = 02 00 (= 2)n Attrib ( 4 Bytes), i.e. = xx xx xx xx arr Data (2 Bytes), i.e. = 12 342nd parameter ST_Sercos Param Header + Data (16 Bytes) ---------------------------------------------------------------------------- n IDN ( 2 Bytes), i.e. = nnnncb Size( 2 Bytes), i.e. = 08 00 (= 8)n Attrib( 4 Bytes), i.e. = xx xx xx x x arr Data ( 8 Bytes), i.e. = 12 34 56 78 9a bc de f03rd parameter ST_Sercos Param Header + Data (12 Byte s) ---------------------------------------------------------------------------- n IDN ( 2 Bytes), i.e. = nn nncb Size ( 2 Bytes), i.e. = 04 00 (= 4)n Attrib ( 4 Bytes), i.e. = xx xx x x xx arr Data ( 4 Bytes), i.e. = 12 34 56 78 TYPE ST_Sercos File Header (268 bytes) The file header of the Sercos backup file is based on the ST_Sercos File Header structure. TYPE ST_Sercos File Header : STRUCT n Version : UDINT;(* 4 Bytes *) n List Type : UDINT;(* 4 Bytes *) TE1000 Version: 1.5.3 151
## Page 152

Appendix cb Comment Len : UDINT;(* 4 Bytes *) s Comment : T_Max String;(* 256 Bytes *) END_STRUCT END_TYPE Name Type Description n Version UDINT Contains the file version, momentarily 1. n List Type UDINT Contains the IDN parameter list that was used for the backup. The default value is 192 (list of all backup parameters), with a user-defined backup list this is 0. Alternatively, the list of all SERCOS parameters (IDN 17) can be used. However, the restore requires the list from parameter 192 or the user-defined list (0). cb Comment Len UDINT Length of the comment of the backup file. s Comment T_Max String Comment of the backup file. The string is written with all 256 characters. TYPE ST_Sercos Param Header (8 bytes) The file header is followed by a parameter header of type ST_Sercos Param Header for each parameter in the backup file. TYPE ST_Sercos Param Header : STRUCT n IDN : UINT;(* 2 Bytes *) cb Size : UINT;(* 2 Bytes *) n Attrib : DWORD;(* 4 Bytes *) END_STRUCT END_TYPE Name Type Description n IDN Sercos parameter number. cb Size Length of the data in bytes that follow this header. Can be different for each parameter, depending on the parameter type or list length. n Attrib ST_Sercos Param Data Attribute of the Sercos parameter, is required to determine the length and data type. [} 142] Parameter data (cb Size bytes) The data directly follow each Sercos parameter header in the backup file. The number of data bytes is saved in the parameter header in cb Size. Requirements Development environ- Target platform IO hardware PLC libraries to be inte- ment grated (category group) Twin CAT v3.1.0 PC (x86) Sercans SCS-P ISA; Tc2_Io Functions (IO) Sercans SCS-P PCI; Beckhoff FC750x PCI 7.2 AX200x Profibus Parameter Number PNU Data type Access Short description SER- VOSTAR™ASCII command Profile parameter 904 UINT32 ro Number of the supported PPO write, - always 2 911 UINT32 ro Number of the supported PPO read, - always 2 152 Version: 1.5.3 TE1000
## Page 153

Appendix PNU Data type Access Short description SER- VOSTAR™ASCII command 918 UINT32 ro Device address on the PROFIBUS ADDR 930 UINT32 r/w Selection switch for operating mode - 963 UINT32 ro PROFIBUS baud rate - 965 Octet-String2 ro Number of the PROFIDRIVE profile - (0302H) 970 UINT32 wo Load default parameter set RSTVAR 971 UINT32 wo Store parameter in non-volatile memory SAVE SERVOSTAR™ manufacturer-specific parameters General parameters 1000 Visible String4 ro Device identifier - 1001 UINT32 ro Manufacturer-specific error register ERRCODE 1002 UINT32 ro Manufacturer-specific status register - Speed controller parameters 1200 UINT32 r/w Kp - amplification factor of the speed GV controller 1201 UINT32 r/w Tn – integral-action time of the speed GVTN controller 1202 UINT32 r/w PID – T2 – time constant for the speed GVT2 controller 1203 UINT32 r/w Set value ramp+, speed controller ACC 1204 UINT32 r/w Set value ramp-, speed controller DEC 1205 UINT32 r/w Emergency ramp, speed controller DECSTOP 1206 UINT32 r/w Maximum rotation speed VLIM 1207 UINT32 r/w Overspeed VOSPD 1208 UINT32 r/w Counting direction DIR Position controller parameters 1250 UINT32 r/w Multiplier for speeds jogging/ref. VMUL 1251 UINT32 r/w Axis type POSCNFG 1251 INTEGER32 r/w In-position window PEINPOS 1253 INTEGER32 r/w Following error window PEMAX 1254 INTEGER32 r/w Position register 1 SWE1 1255 INTEGER32 r/w Position register 2 SWE2 1256 INTEGER32 r/w Position register 3 SWE3 1257 INTEGER32 r/w Position register 4 SWE4 1258 UINT32 r/w Resolution denominator PGEARO 1259 UINT32 r/w Resolution numerator PGEARI 1260 UINT32 r/w Minimum acceleration or braking time PTMIN 1261 UINT32 r/w Position controller feed-forward factor GPFFV 1262 UINT32 r/w Position controller KV factor GP 1263 UINT32 r/w Position controller KP factor GPV 1264 UINT32 r/w Tn - position controller integral-action time GPTN 1265 UINT32 r/w Maximum speed for positioning operation PVMAX 1266 UINT32 r/w Configuration variable for software switch SWCNFG 1267 UINT32 r/w Configuration variable 2 for software SWCNFG2 switch Positioning data for position controller mode 1300 INTEGER32 r/w Position O_P 1301 INTEGER16 r/w Velocity O_V TE1000 Version: 1.5.3 153
## Page 154

Appendix PNU Data type Access Short description SER- VOSTAR™ASCII command 1302 UINT32 r/w Transport instruction type O_C 1304 UINT32 r/w Starting up time (acceleration) O_ACC1 1305 UINT32 r/w Braking time (deceleration) O_DEC1 1306 UINT32 r/w Jerk limitation (acceleration) O_ACC2 1307 UINT32 r/w Jerk limitation (deceleration) O_DEC2 1308 UINT32 r/w Number of the subsequent transport O_FN instruction 1309 UINT32 r/w Start delay for subsequent transport O_FT instruction 1310 2 * UINT16 wo Copy a transport instruction OCOPY Setting-up mode, position 1350 UINT32 r/w Reference travel type NREF 1351 UINT32 r/w Reference travel direction DREF 1352 UINT32 r/w Acceleration ramp (jogging/referencing) ACCR 1353 UINT32 r/w Braking ramp DECR 1354 UINT32 r/w Reference offset ROFFS 1355 UINT32 ro Reference travel speed VREF 1356 UINT32 ro Jogging speed VJOG Actual values 1400 INTEGER32 ro Actual position represented with 20 bits/ PRD rotation 1401 INTEGER32 ro Speed - 1402 INTEGER32 ro Incremental actual position value - 1403 INTEGER32 ro SI - actual position value PFB 1404 INTEGER32 ro SI - actual speed value PV 1405 INTEGER32 ro SI - following error PE 1406 INTEGER32 ro Effective current I 1407 INTEGER32 ro SI - actual rotation speed V 1408 INTEGER32 ro Heatsink temperature TEMPH 1409 INTEGER32 ro Internal temperature TEMPE 1410 INTEGER32 ro DC link voltage VBUS 1411 INTEGER32 ro Ballast power PBAL 1412 INTEGER32 ro I2t - loading I2T 1413 INTEGER32 ro Period of operation TRUN Digital I/O-configuration 1450 UINT32 r/w Function of digital input 1 IN1MODE 1451 UINT32 r/w Function of digital input 2 IN2MODE 1452 UINT32 r/w Function of digital input 3 IN3MODE 1453 UINT32 r/w Function of digital input 4 IN4MODE 1454 INTEGER32 r/w Auxiliary variable for digital input 1 IN1TRIG 1455 INTEGER32 r/w Auxiliary variable for digital input 2 IN2TRIG 1456 INTEGER32 r/w Auxiliary variable for digital input 3 IN3TRIG 1457 INTEGER32 r/w Auxiliary variable for digital input 4 IN4TRIG 1458 INTEGER32 r/w Function of digital output 1 O1MODE 1459 INTEGER32 r/w Function of digital output 2 O2MODE 1460 UINT32 r/w Auxiliary variable for digital output 1 O1TRIG 1461 UINT32 r/w Auxiliary variable for digital output 2 O2TRIG 154 Version: 1.5.3 TE1000
## Page 155

Appendix PNU Data type Access Short description SER- VOSTAR™ASCII command 1462 UINT32 r/w State of 4 digital inputs, enable, 2 digital STATIO outputs Analog configuration 1500 UINT32 r/w Configuration of the analog input functions ANCNFG 1501 UINT32 r/w Configuration of monitor function for ANOUT1 analog output 1 1502 UINT32 r/w Offset voltage for analog input 1 ANOFF1 1503 UINT32 r/w Filter time constant for analog input 1 AVZ1 1504 UINT32 r/w Speed scaling factor for analog input 1 VSCALE1 1505 UINT32 r/w Current scaling factor for analog input 1 ISCALE1 1506 UINT32 r/w Configuration of monitor function for ANOUT2 analog output 2 1507 UINT32 r/w Offset voltage for analog input 2 ANOFF2 1508 UINT32 r/w Speed scaling factor for analog input 2 VSCALE2 1509 UINT32 r/w Current scaling factor for analog input 2 ISCALE2 Motor parameters 1550 UINT32 r/w Brake configuration MBRAKE 1551 UINT32 r/w Motor number from the motor database MNUMBER 7.3 Errorcodes Err Id Err Id Description (hex) (dez) 0x0 0 No error 0x8001 32769 Timeout-error during configuration 0x8002 32770 The configuration-FB and the terminal, which it is linked to, do not match. 0x8010 32784 FB_KL1501Config: Invalid counter type selected. See input i Set Counter Type. 0x8011 32785 FB_KL1501Config: Invalid counter type readouted. See output s Counter Type. 0x8018 32792 FB_KL27x1Config: Invalid ramp time selected. See input i Set Ramp Time. 0x8019 32793 FB_KL27x1Config: Invalid dimmer mode selected. See input i Set Dimmer Mode. 0x801A 32794 FB_KL27x1Config: Invalid ramp time readouted. See output s Ramp Time. 0x801B 32795 FB_KL27x1Config: Invalid dimmer mode readouted. See output s Dimmer Mode. 0x801C 32796 FB_KL27x1Config: Invalid after-shortcut-behaviour readouted. See output s After Short Circuit. 0x801D 32797 FB_KL27x1Config: Invalid line frequency readouted. See output s Line Frequency. 0x8020 32800 FB_KL3208Config: Invalid sensor type selected. See input i Set Sensor Type. 0x8021 32801 FB_KL3208Config: Invalid sensor type readouted. See output s Sensor Type. 0x8028 32808 FB_KL320x Config: Two-wired connection is not applicable for a KL3204. 0x8029 32809 FB_KL320x Config: Invalid sensor type selected. See input i Set Sensor Type. 0x802A 32810 FB_KL320x Config: Invalid sensor type readouted. See output s Sensor Type. TE1000 Version: 1.5.3 155
## Page 156

Appendix Err Id Err Id Description (hex) (dez) 0x8030 32816 FB_KL3228Config: Invalid sensor type selected. See input i Set Sensor Type. 0x8031 32817 FB_KL3228Config: Invalid sensor type readouted. See output s Sensor Type. 7.4 ADS Return Codes Grouping of error codes: Global error codes: 0x0000 [} 156]... (0x9811_0000 ...) Router error codes: 0x500 [} 156]... (0x9811_0500 ...) General ADS errors: 0x700 [} 157]... (0x9811_0700 ...) RTime error codes: 0x1000 [} 158]... (0x9811_1000 ...) Global error codes Hex Dec HRESULT Name Description 0x0 0 0x98110000 ERR_NOERROR No error. 0x1 1 0x98110001 ERR_INTERNAL Internal error. 0x2 2 0x98110002 ERR_NORTIME No real time. 0x3 3 0x98110003 ERR_ALLOCLOCKEDMEM Allocation locked – memory error. 0x4 4 0x98110004 ERR_INSERTMAILBOX Mailbox full – the ADS message could not be sent. Reducing the number of ADS messages per cycle will help. 0x5 5 0x98110005 ERR_WRONGRECEIVEHMSG Wrong HMSG. 0x6 6 0x98110006 ERR_TARGETPORTNOTFOUND Target port not found – ADS server is not started, not reachable or not installed. 0x7 7 0x98110007 ERR_TARGETMACHINENOTFOUND Target computer not found – AMS route was not found. 0x8 8 0x98110008 ERR_UNKNOWNCMDID Unknown command ID. 0x9 9 0x98110009 ERR_BADTASKID Invalid task ID. 0x A 10 0x9811000A ERR_NOIO No IO. 0x B 11 0x9811000B ERR_UNKNOWNAMSCMD Unknown AMS command. 0x C 12 0x9811000C ERR_WIN32ERROR Win32 error. 0x D 13 0x9811000D ERR_PORTNOTCONNECTED Port not connected. 0x E 14 0x9811000E ERR_INVALIDAMSLENGTH Invalid AMS length. 0x F 15 0x9811000F ERR_INVALIDAMSNETID Invalid AMS Net ID. 0x10 16 0x98110010 ERR_LOWINSTLEVEL Installation level is too low –Twin CAT 2 license error. 0x11 17 0x98110011 ERR_NODEBUGINTAVAILABLE No debugging available. 0x12 18 0x98110012 ERR_PORTDISABLED Port disabled – Twin CAT system service not started. 0x13 19 0x98110013 ERR_PORTALREADYCONNECTED Port already connected. 0x14 20 0x98110014 ERR_AMSSYNC_W32ERROR AMS Sync Win32 error. 0x15 21 0x98110015 ERR_AMSSYNC_TIMEOUT AMS Sync Timeout. 0x16 22 0x98110016 ERR_AMSSYNC_AMSERROR AMS Sync error. 0x17 23 0x98110017 ERR_AMSSYNC_NOINDEXINMAP No index map for AMS Sync available. 0x18 24 0x98110018 ERR_INVALIDAMSPORT Invalid AMS port. 0x19 25 0x98110019 ERR_NOMEMORY No memory. 0x1A 26 0x9811001A ERR_TCPSEND TCP send error. 0x1B 27 0x9811001B ERR_HOSTUNREACHABLE Host unreachable. 0x1C 28 0x9811001C ERR_INVALIDAMSFRAGMENT Invalid AMS fragment. 0x1D 29 0x9811001D ERR_TLSSEND TLS send error – secure ADS connection failed. 0x1E 30 0x9811001E ERR_ACCESSDENIED Access denied – secure ADS access denied. Router error codes Hex Dec HRESULT Name Description 0x500 1280 0x98110500 ROUTERERR_NOLOCKEDMEMORY Locked memory cannot be allocated. 0x501 1281 0x98110501 ROUTERERR_RESIZEMEMORY The router memory size could not be changed. 156 Version: 1.5.3 TE1000
## Page 157

Appendix Hex Dec HRESULT Name Description 0x502 1282 0x98110502 ROUTERERR_MAILBOXFULL The mailbox has reached the maximum number of possible messages. 0x503 1283 0x98110503 ROUTERERR_DEBUGBOXFULL The Debug mailbox has reached the maximum number of possible messages. 0x504 1284 0x98110504 ROUTERERR_UNKNOWNPORTTYPE The port type is unknown. 0x505 1285 0x98110505 ROUTERERR_NOTINITIALIZED The router is not initialized. 0x506 1286 0x98110506 ROUTERERR_PORTALREADYINUSE The port number is already assigned. 0x507 1287 0x98110507 ROUTERERR_NOTREGISTERED The port is not registered. 0x508 1288 0x98110508 ROUTERERR_NOMOREQUEUES The maximum number of ports has been reached. 0x509 1289 0x98110509 ROUTERERR_INVALIDPORT The port is invalid. 0x50A 1290 0x9811050A ROUTERERR_NOTACTIVATED The router is not active. 0x50B 1291 0x9811050B ROUTERERR_FRAGMENTBOXFULL The mailbox has reached the maximum number for fragmented messages. 0x50C 1292 0x9811050C ROUTERERR_FRAGMENTTIMEOUT A fragment timeout has occurred. 0x50D 1293 0x9811050D ROUTERERR_TOBEREMOVED The port is removed. General ADS error codes Hex Dec HRESULT Name Description 0x700 1792 0x98110700 ADSERR_DEVICE_ERROR General device error. 0x701 1793 0x98110701 ADSERR_DEVICE_SRVNOTSUPP Service is not supported by the server. 0x702 1794 0x98110702 ADSERR_DEVICE_INVALIDGRP Invalid index group. 0x703 1795 0x98110703 ADSERR_DEVICE_INVALIDOFFSET Invalid index offset. 0x704 1796 0x98110704 ADSERR_DEVICE_INVALIDACCESS Reading or writing not permitted. Several causes are possible. For example, an incorrect password was entered when creating routes. 0x705 1797 0x98110705 ADSERR_DEVICE_INVALIDSIZE Parameter size not correct. 0x706 1798 0x98110706 ADSERR_DEVICE_INVALIDDATA Invalid data values. 0x707 1799 0x98110707 ADSERR_DEVICE_NOTREADY Device is not ready to operate. 0x708 1800 0x98110708 ADSERR_DEVICE_BUSY Device is busy. 0x709 1801 0x98110709 ADSERR_DEVICE_INVALIDCONTEXT Invalid operating system context. This can result from use of ADS blocks in different tasks. It may be possible to resolve this through multitasking synchronization in the PLC. 0x70A 1802 0x9811070A ADSERR_DEVICE_NOMEMORY Insufficient memory. 0x70B 1803 0x9811070B ADSERR_DEVICE_INVALIDPARM Invalid parameter values. 0x70C 1804 0x9811070C ADSERR_DEVICE_NOTFOUND Not found (files, ...). 0x70D 1805 0x9811070D ADSERR_DEVICE_SYNTAX Syntax error in file or command. 0x70E 1806 0x9811070E ADSERR_DEVICE_INCOMPATIBLE Objects do not match. 0x70F 1807 0x9811070F ADSERR_DEVICE_EXISTS Object already exists. 0x710 1808 0x98110710 ADSERR_DEVICE_SYMBOLNOTFOUND Symbol not found. 0x711 1809 0x98110711 ADSERR_DEVICE_SYMBOLVERSIONINVALID Invalid symbol version. This can occur due to an online change. Create a new handle. 0x712 1810 0x98110712 ADSERR_DEVICE_INVALIDSTATE Device (server) is in invalid state. 0x713 1811 0x98110713 ADSERR_DEVICE_TRANSMODENOTSUPP Ads Trans Mode not supported. 0x714 1812 0x98110714 ADSERR_DEVICE_NOTIFYHNDINVALID Notification handle is invalid. 0x715 1813 0x98110715 ADSERR_DEVICE_CLIENTUNKNOWN Notification client not registered. 0x716 1814 0x98110716 ADSERR_DEVICE_NOMOREHDLS No further handle available. 0x717 1815 0x98110717 ADSERR_DEVICE_INVALIDWATCHSIZE Notification size too large. 0x718 1816 0x98110718 ADSERR_DEVICE_NOTINIT Device not initialized. 0x719 1817 0x98110719 ADSERR_DEVICE_TIMEOUT Device has a timeout. 0x71A 1818 0x9811071A ADSERR_DEVICE_NOINTERFACE Interface query failed. 0x71B 1819 0x9811071B ADSERR_DEVICE_INVALIDINTERFACE Wrong interface requested. 0x71C 1820 0x9811071C ADSERR_DEVICE_INVALIDCLSID Class ID is invalid. 0x71D 1821 0x9811071D ADSERR_DEVICE_INVALIDOBJID Object ID is invalid. 0x71E 1822 0x9811071E ADSERR_DEVICE_PENDING Request pending. 0x71F 1823 0x9811071F ADSERR_DEVICE_ABORTED Request is aborted. 0x720 1824 0x98110720 ADSERR_DEVICE_WARNING Signal warning. TE1000 Version: 1.5.3 157
## Page 158

Appendix Hex Dec HRESULT Name Description 0x721 1825 0x98110721 ADSERR_DEVICE_INVALIDARRAYIDX Invalid array index. 0x722 1826 0x98110722 ADSERR_DEVICE_SYMBOLNOTACTIVE Symbol not active. 0x723 1827 0x98110723 ADSERR_DEVICE_ACCESSDENIED Access denied. Several causes are possible. For example, a unidirectional ADS route is used in the opposite direction. 0x724 1828 0x98110724 ADSERR_DEVICE_LICENSENOTFOUND Missing license. 0x725 1829 0x98110725 ADSERR_DEVICE_LICENSEEXPIRED License expired. 0x726 1830 0x98110726 ADSERR_DEVICE_LICENSEEXCEEDED License exceeded. 0x727 1831 0x98110727 ADSERR_DEVICE_LICENSEINVALID Invalid license. 0x728 1832 0x98110728 ADSERR_DEVICE_LICENSESYSTEMID License problem: System ID is invalid. 0x729 1833 0x98110729 ADSERR_DEVICE_LICENSENOTIMELIMIT License not limited in time. 0x72A 1834 0x9811072A ADSERR_DEVICE_LICENSEFUTUREISSUE Licensing problem: time in the future. 0x72B 1835 0x9811072B ADSERR_DEVICE_LICENSETIMETOLONG License period too long. 0x72C 1836 0x9811072C ADSERR_DEVICE_EXCEPTION Exception at system startup. 0x72D 1837 0x9811072D ADSERR_DEVICE_LICENSEDUPLICATED License file read twice. 0x72E 1838 0x9811072E ADSERR_DEVICE_SIGNATUREINVALID Invalid signature. 0x72F 1839 0x9811072F ADSERR_DEVICE_CERTIFICATEINVALID Invalid certificate. 0x730 1840 0x98110730 ADSERR_DEVICE_LICENSEOEMNOTFOUND Public key not known from OEM. 0x731 1841 0x98110731 ADSERR_DEVICE_LICENSERESTRICTED License not valid for this system ID. 0x732 1842 0x98110732 ADSERR_DEVICE_LICENSEDEMODENIED Demo license prohibited. 0x733 1843 0x98110733 ADSERR_DEVICE_INVALIDFNCID Invalid function ID. 0x734 1844 0x98110734 ADSERR_DEVICE_OUTOFRANGE Outside the valid range. 0x735 1845 0x98110735 ADSERR_DEVICE_INVALIDALIGNMENT Invalid alignment. 0x736 1846 0x98110736 ADSERR_DEVICE_LICENSEPLATFORM Invalid platform level. 0x737 1847 0x98110737 ADSERR_DEVICE_FORWARD_PL Context – forward to passive level. 0x738 1848 0x98110738 ADSERR_DEVICE_FORWARD_DL Context – forward to dispatch level. 0x739 1849 0x98110739 ADSERR_DEVICE_FORWARD_RT Context – forward to real-time. 0x740 1856 0x98110740 ADSERR_CLIENT_ERROR Client error. 0x741 1857 0x98110741 ADSERR_CLIENT_INVALIDPARM Service contains an invalid parameter. 0x742 1858 0x98110742 ADSERR_CLIENT_LISTEMPTY Polling list is empty. 0x743 1859 0x98110743 ADSERR_CLIENT_VARUSED Var connection already in use. 0x744 1860 0x98110744 ADSERR_CLIENT_DUPLINVOKEID The called ID is already in use. 0x745 1861 0x98110745 ADSERR_CLIENT_SYNCTIMEOUT Timeout has occurred – the remote terminal is not responding in the specified ADS timeout. The route setting of the remote terminal may be configured incorrectly. 0x746 1862 0x98110746 ADSERR_CLIENT_W32ERROR Error in Win32 subsystem. 0x747 1863 0x98110747 ADSERR_CLIENT_TIMEOUTINVALID Invalid client timeout value. 0x748 1864 0x98110748 ADSERR_CLIENT_PORTNOTOPEN Port not open. 0x749 1865 0x98110749 ADSERR_CLIENT_NOAMSADDR No AMS address. 0x750 1872 0x98110750 ADSERR_CLIENT_SYNCINTERNAL Internal error in Ads sync. 0x751 1873 0x98110751 ADSERR_CLIENT_ADDHASH Hash table overflow. 0x752 1874 0x98110752 ADSERR_CLIENT_REMOVEHASH Key not found in the table. 0x753 1875 0x98110753 ADSERR_CLIENT_NOMORESYM No symbols in the cache. 0x754 1876 0x98110754 ADSERR_CLIENT_SYNCRESINVALID Invalid response received. 0x755 1877 0x98110755 ADSERR_CLIENT_SYNCPORTLOCKED Sync Port is locked. 0x756 1878 0x98110756 ADSERR_CLIENT_REQUESTCANCELLED The request was canceled. RTime error codes Hex Dec HRESULT Name Description 0x1000 4096 0x98111000 RTERR_INTERNAL Internal error in the real-time system. 0x1001 4097 0x98111001 RTERR_BADTIMERPERIODS Timer value is not valid. 0x1002 4098 0x98111002 RTERR_INVALIDTASKPTR Task pointer has the invalid value 0 (zero). 0x1003 4099 0x98111003 RTERR_INVALIDSTACKPTR Stack pointer has the invalid value 0 (zero). 0x1004 4100 0x98111004 RTERR_PRIOEXISTS The request task priority is already assigned. 0x1005 4101 0x98111005 RTERR_NOMORETCB No free TCB (Task Control Block) available. The maximum number of TCBs is 64. 158 Version: 1.5.3 TE1000
## Page 159

Appendix Hex Dec HRESULT Name Description 0x1006 4102 0x98111006 RTERR_NOMORESEMAS No free semaphores available. The maximum number of semaphores is 64. 0x1007 4103 0x98111007 RTERR_NOMOREQUEUES No free space available in the queue. The maximum number of positions in the queue is 64. 0x100D 4109 0x9811100D RTERR_EXTIRQALREADYDEF An external synchronization interrupt is already applied. 0x100E 4110 0x9811100E RTERR_EXTIRQNOTDEF No external sync interrupt applied. 0x100F 4111 0x9811100F RTERR_EXTIRQINSTALLFAILED Application of the external synchronization interrupt has failed. 0x1010 4112 0x98111010 RTERR_IRQLNOTLESSOREQUAL Call of a service function in the wrong context 0x1017 4119 0x98111017 RTERR_VMXNOTSUPPORTED Intel® VT-x extension is not supported. 0x1018 4120 0x98111018 RTERR_VMXDISABLED Intel® VT-x extension is not enabled in the BIOS. 0x1019 4121 0x98111019 RTERR_VMXCONTROLSMISSING Missing function in Intel® VT-x extension. 0x101A 4122 0x9811101A RTERR_VMXENABLEFAILS Activation of Intel® VT-x fails. Specific positive HRESULT Return Codes: HRESULT Name Description 0x0000_0000 S_OK No error. 0x0000_0001 S_FALSE No error. Example: successful processing, but with a negative or incomplete result. 0x0000_0203 S_PENDING No error. Example: successful processing, but no result is available yet. 0x0000_0256 S_WATCHDOG_TIMEOUT No error. Example: successful processing, but a timeout occurred. TCP Winsock error codes Hex Dec Name Description 0x274C 10060 WSAETIMEDOUT A connection timeout has occurred - error while establishing the connection, because the remote terminal did not respond properly after a certain period of time, or the established connection could not be maintained because the connected host did not respond. 0x274D 10061 WSAECONNREFUSED Connection refused - no connection could be established because the target computer has explicitly rejected it. This error usually results from an attempt to connect to a service that is inactive on the external host, that is, a service for which no server application is running. 0x2751 10065 WSAEHOSTUNREACH No route to host - a socket operation referred to an unavailable host. More Winsock error codes: Win32 error codes TE1000 Version: 1.5.3 159
## Page 160

Appendix 7.5 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 160 Version: 1.5.3 TE1000
## Page 161

Trademark statements Beckhoff®, ATRO®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. Third-party trademark statements Device Net and Ether Net/IP are trademarks of ODVA, Inc. Intel, the Intel logo, Intel Core, Xeon, Intel Atom, Celeron and Pentium are trademarks of Intel Corporation or its subsidiaries. Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies.
## Page 162

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
