---
title: "TwinCAT_3_PLC_Lib_Tc3_DynamicMemory_EN"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "DYNAMIC", "LIB", "MEMORY", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.0.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc3_DynamicMemory_EN.pdf"
release_date: "2025-09-22"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc3_Dynamic Memory 2025-09-22 | Version: 1.0.2
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Introduction............................................................................................................................................... 8 3 Function blocks......................................................................................................................................... 9 3.1 FB_Dyn Mem_Buffer.......................................................................................................................... 9 3.2 FB_Dyn Mem_Manager................................................................................................................... 10 3.3 FB_Dyn Mem_Manager2................................................................................................................. 11 4 Samples................................................................................................................................................... 13 TE1000 Version: 1.0.2 3
## Page 4

Table of contents 4 Version: 1.0.2 TE1000
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.0.2 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.0.2 TE1000
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.0.2 7
## Page 8

Introduction 2 Introduction The PLC library Tc3_Dynamic Memory simplifies the use of dynamic memory in the PLC. The memory allocations avail themselves of the Twin CAT Router memory. Function blocks are available for creating buffers for the most diverse data. They also automatically take care of the necessary release of the memory at the end of runtime. In addition, your own memory allocations can be monitored with a memory manager, which offers methods analogous to the operators __NEW() and __DELETE(). When using the library, therefore, you can and should refrain from using the two operators named above. This results in a better overview of the size of memory already allocated when using this PLC library. Advantages of dynamically allocated memory in the Twin CAT real-time Only the size of memory required at runtime needs to be allocated. The previous creation of large reserves is no longer necessary. It is possible to react during the runtime to an unexpectedly high memory requirement, e.g. during data exchange via a communication interface, and if necessary to make the memory available only temporarily. Disadvantages of dynamically allocated memory in the Twin CAT real-time - A memory allocation during the runtime is computationally intensive. - A memory allocation can fail if no block of an appropriate size is free in the memory. - Fragmentations in the Twin CAT Router memory are possible. - Explicit memory releases are necessary. - A type change of a dynamically allocated instance by Online Change is not possible. >>> Memory should be allocated dynamically in the Twin CAT real-time only in the case of high benefit and where there is no sensible alternative. System requirements Technical data Description Target System Win10 IPC or CX (x86, x64, Arm®) Min. Twin CAT version 3.1.4024.7 Min. Twin CAT level TC1200 TC3 PLC 8 Version: 1.0.2 TE1000
## Page 9

Function blocks 3 Function blocks 3.1 FB_Dyn Mem_Buffer This function block provides a buffer of dynamically allocated memory. This buffer can be used for individual data or data blocks. It cannot be used for dynamic instantiation of function blocks. During the declaration, an instance of the function block FB_Dyn Mem_Manager [} 10] is transferred to the function block, and the memory allocations are monitored as a result of this. Declaration fb My Buffer : FB_Dyn Mem_Buffer(ip Mem Man := fb My Mem Man); Properties b Available: is TRUE if the buffer is available. n Buffer Size: indicates the current size of the buffer in bytes. p Buffer: provides a pointer to the internal dynamically allocated buffer. Methods Create Buffer(): The method generates the buffer by allocating memory at runtime. In addition to the desired size in bytes, a specification is issued stating whether the memory block should be zeroed. The method returns TRUE if processing is successful. METHOD Create Buffer : BOOL VAR_INPUT n Size : UDINT; // buffer size [in bytes] b Reset : BOOL; // zero the allocated memory END_VAR Clear(): This method clears the buffer. The entire buffer memory is zeroed. The method returns TRUE if processing is successful. METHOD Clear : BOOL VAR_INPUT END_VAR Resize(): This method changes the size of the buffer. You can specify whether the previous buffer content should be retained. The method returns TRUE if processing is successful. METHOD Resize : BOOL VAR_INPUT n Size : UDINT; // new buffer size [in bytes] b Preserve : BOOL; // TRUE => preserve old content, FALSE=> don't preserve old content b Reset : BOOL; // zero the allocated memory (before preserving) END_VAR Changed pointer If the size of the buffer changes, the address of the buffer can also change. It is therefore absolutely necessary to obtain the new address before using the buffer. Delete Buffer(): The method removes the buffer by releasing the allocated memory. The method returns TRUE if processing is successful. TE1000 Version: 1.0.2 9
## Page 10

Function blocks METHOD Delete Buffer : BOOL VAR_INPUT END_VAR Invalid pointer After deleting the buffer, the previously used buffer address is invalid and may no longer be used. Any pointer variables that still exist should be explicitly set to ZERO. Sample The following sample code shows the use of FB_Dyn Mem_Buffer to allocate memory during the runtime. The allocated memory is used once as a structure instance and another time as an array. PROGRAM MAIN VAR b Allocate Once : BOOL := TRUE; fb Mem Man : FB_Dyn Mem_Manager; fb Buffer_Struct : FB_Dyn Mem_Buffer(ip Mem Man:=fb Mem Man); p Struct : POINTER TO ST_My Struct; fb Buffer_Array : FB_Dyn Mem_Buffer(ip Mem Man:=fb Mem Man); p Array : POINTER TO LREAL; n Array Length : UINT := 10; b Resize Array : BOOL; END_VAR IF b Allocate Once THEN b Allocate Once := FALSE; fb Buffer_Struct. Create Buffer(n Size:=SIZEOF(ST_My Struct), b Reset:=TRUE); // after successfully creating the buffer fb Mem Man shows an increased n Allocated Size [bytes] and n Buffer Count=1 p Struct := fb Buffer_Struct.p Buffer; fb Buffer_Array. Create Buffer(n Size:=n Array Length*SIZEOF(LREAL), b Reset:=TRUE); // after successfully creating the buffer fb Mem Man shows an increased n Allocated Size [bytes] and n Buffer Count=2 p Array := fb Buffer_Array.p Buffer; END_IF IF p Struct <> 0 THEN p Struct^.n Ctrl Value := 7; END_IF IF p Array <> 0 THEN p Array[3] := 7.5; END_IF IF b Resize Array THEN b Resize Array := FALSE; n Array Length := 15; fb Buffer_Array. Resize(n Size:=n Array Length*SIZEOF(LREAL), b Preserve:=TRUE, b Reset:=TRUE); // after successfully creating the buffer fb Mem Man shows an increased n Allocated Size [bytes] and n Buffer Count=2 p Array := fb Buffer_Array.p Buffer; END_IF Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.7 IPC or CX (x86, x64, ARM) Tc3_Dynamic Memory 3.2 FB_Dyn Mem_Manager This function block provides the possibility to dynamically allocate memory and to release it again. Integrated counters indicate the memory consumption and thus enable an overview of the already allocated memory. It is entirely up to the user to decide whether an instance is used across the entire application or whether several individual instances are used for different program parts. With larger applications, the latter may be advantageous in the case of diagnosis. This function block is capable of multi-tasking and an instance can thus be used from various task contexts. 10 Version: 1.0.2 TE1000
## Page 11

Function blocks If the function block determines that not all of the allocated memory has already been released when shutting down the PLC, an error message is sent as an event to the TC3 Event Logger. Properties n Allocated Size: indicates the current size in bytes of memory allocated with this function block instance. n Buffer Count: indicates the current size of buffer allocated with this function block instance. n Object Count: - future reserved - Methods Alloc(): This method dynamically allocates memory and returns a pointer to this memory block. If allocation fails, e.g. because no free memory is available, the method returns ZERO. An indication is given next to the desired size in bytes, stating whether the memory block should be zeroed. The dynamically allocated memory can be used for individual data or data blocks. It cannot be used for dynamic instantiation of function blocks. METHOD Alloc : PVOID VAR_INPUT n Size : UDINT; // requested size in bytes b Reset : BOOL; // zero the allocated memory END_VAR Free(): This method releases previously allocated memory again. The memory block must be allocated with the same function block instance beforehand and the size of this memory block must be specified. METHOD Free VAR_INPUT p : REFERENCE TO PVOID; // the given pointer is reset to zero after deletion n Size : UDINT; END_VAR Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.7 IPC or CX (x86, x64, ARM) Tc3_Dynamic Memory 3.3 FB_Dyn Mem_Manager2 This function block provides the possibility to dynamically allocate memory and to release it again. Integrated counters indicate the memory consumption and thus enable an overview of the already allocated memory. It is entirely up to the user to decide whether an instance is used across the entire application or whether several individual instances are used for different program parts. With larger applications, the latter may be advantageous in the case of diagnosis. This function block is capable of multi-tasking and an instance can thus be used from various task contexts. If the function block determines that not all of the allocated memory has already been released when shutting down the PLC, an error message is sent as an event to the TC3 Event Logger. The function block FB_Dyn Mem_Manager2 extends FB_Dyn Mem_Manager by the knowledge of the size of the allocated memory blocks. This simplifies the memory release by means of the method Free2(), because the size of the memory block does not need to be specified. Properties n Allocated Size: indicates the current size in bytes of memory allocated with this function block instance. n Buffer Count: indicates the current size of buffer allocated with this function block instance. TE1000 Version: 1.0.2 11
## Page 12

Function blocks n Object Count: - future reserved - Methods Alloc(): This method dynamically allocates memory and returns a pointer to this memory block. If allocation fails, e.g. because no free memory is available, the method returns ZERO. An indication is given next to the desired size in bytes, stating whether the memory block should be zeroed. The dynamically allocated memory can be used for individual data or data blocks. It cannot be used for dynamic instantiation of function blocks. METHOD Alloc : PVOID VAR_INPUT n Size : UDINT; // requested size in bytes b Reset : BOOL; // zero the allocated memory END_VAR Free2(): This method releases previously allocated memory again. The memory block must have been allocated with the same function block instance beforehand. METHOD Free2 VAR_INPUT p : REFERENCE TO PVOID; // the given pointer is reset to zero after deletion END_VAR Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.7 IPC or CX (x86, x64, ARM) Tc3_Dynamic Memory 12 Version: 1.0.2 TE1000
## Page 13

Samples 4 Samples The following sample code shows the use of FB_Dyn Mem_Buffer to allocate memory during the runtime. The allocated memory is used once as a structure instance and another time as an array. PROGRAM MAIN VAR b Allocate Once : BOOL := TRUE; fb Mem Man : FB_Dyn Mem_Manager; fb Buffer_Struct : FB_Dyn Mem_Buffer(ip Mem Man:=fb Mem Man); p Struct : POINTER TO ST_My Struct; fb Buffer_Array : FB_Dyn Mem_Buffer(ip Mem Man:=fb Mem Man); p Array : POINTER TO LREAL; n Array Length : UINT := 10; b Resize Array : BOOL; END_VAR IF b Allocate Once THEN b Allocate Once := FALSE; fb Buffer_Struct. Create Buffer(n Size:=SIZEOF(ST_My Struct), b Reset:=TRUE); // after successfully creating the buffer fb Mem Man shows an increased n Allocated Size [bytes] and n Buffer Count=1 p Struct := fb Buffer_Struct.p Buffer; fb Buffer_Array. Create Buffer(n Size:=n Array Length*SIZEOF(LREAL), b Reset:=TRUE); // after successfully creating the buffer fb Mem Man shows an increased n Allocated Size [bytes] and n Buffer Count=2 p Array := fb Buffer_Array.p Buffer; END_IF IF p Struct <> 0 THEN p Struct^.n Ctrl Value := 7; END_IF IF p Array <> 0 THEN p Array[3] := 7.5; END_IF IF b Resize Array THEN b Resize Array := FALSE; n Array Length := 15; fb Buffer_Array. Resize(n Size:=n Array Length*SIZEOF(LREAL), b Preserve:=TRUE, b Reset:=TRUE); // after successfully creating the buffer fb Mem Man shows an increased n Allocated Size [bytes] and n Buffer Count=2 p Array := fb Buffer_Array.p Buffer; END_IF TE1000 Version: 1.0.2 13
## Page 14

Trademark statements Beckhoff®, ATRO®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H.
## Page 15

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
