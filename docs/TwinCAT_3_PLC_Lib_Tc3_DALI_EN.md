---
title: "TE1000 Twin CAT 3"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.20.0"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc3_DALI_EN.pdf"
release_date: "2025-09-04"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc3_DALI 2025-09-04 | Version: 1.20.0
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Introduction............................................................................................................................................... 8 3 DALI............................................................................................................................................................ 9 3.1 IEC 62386......................................................................................................................................... 9 3.2 Communication............................................................................................................................... 10 3.3 Priorities.......................................................................................................................................... 11 3.4 Bus Timing...................................................................................................................................... 12 3.4.1 Structure data frame........................................................................................................ 12 3.4.2 Transmission length......................................................................................................... 14 3.4.3 Collision detection............................................................................................................ 14 3.4.4 Cycle times PLC tasks..................................................................................................... 15 3.4.5 Summary.......................................................................................................................... 16 3.5 Memory banks................................................................................................................................. 16 4 Programming........................................................................................................................................... 21 4.1 POUs............................................................................................................................................... 21 4.1.1 Applications...................................................................................................................... 21 4.1.2 Commands....................................................................................................................... 54 4.1.3 Communication.............................................................................................................. 614 4.1.4 Devices.......................................................................................................................... 624 4.1.5 Events............................................................................................................................ 890 4.1.6 Helper............................................................................................................................. 893 4.1.7 Simulation...................................................................................................................... 895 4.2 DUTs............................................................................................................................................. 901 4.2.1 Structures....................................................................................................................... 901 4.2.2 Enumerations................................................................................................................. 903 4.3 GVLs............................................................................................................................................. 914 4.3.1 Constants....................................................................................................................... 914 4.3.2 Parameter...................................................................................................................... 914 4.4 Integration into Twin CAT............................................................................................................... 915 4.4.1 EL6821 with CX5120..................................................................................................... 915 4.4.2 KL6821 with CX5120..................................................................................................... 919 4.5 Runtime messages....................................................................................................................... 923 5 Appendix................................................................................................................................................ 929 5.1 Commissioning and diagnosis...................................................................................................... 929 5.1.1 Commissioning KL6821................................................................................................. 929 5.1.2 Commissioning EL6821................................................................................................. 930 5.1.3 DALI PLC Commissioning Tool...................................................................................... 932 5.1.4 Event Logger.................................................................................................................. 937 5.1.5 Error evaluation.............................................................................................................. 939 5.1.6 Communication Monitor................................................................................................. 942 TE1000 Version: 1.20.0 3
## Page 4

Table of contents 5.2 Use of properties........................................................................................................................... 944 5.3 Transfer of the reference to the communication block.................................................................. 946 5.4 Tc2_DALI and Tc3_DALI in the same project............................................................................... 947 5.5 Creating an application function block.......................................................................................... 948 5.6 Creating a device function block................................................................................................... 951 5.7 Support and Service...................................................................................................................... 953 4 Version: 1.20.0 TE1000
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.20.0 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.20.0 TE1000
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.20.0 7
## Page 8

Introduction 2 Introduction The user of this library requires basic knowledge of the following: • Twin CAT XAE • Design and characteristics of Beckhoff IPCs and their bus terminal system • DALI technology and mode of operation • Relevant safety regulations for building technical equipment This software library is intended for building automation system partners of Beckhoff Automation Gmb H & Co. KG. The system partners operate in the field of building automation and are concerned with the installation, commissioning, expansion, maintenance and service of measurement, control and regulating systems for the technical equipment of buildings. The Tc3_DALI library is usable on all hardware platforms that support Twin CAT 3.1.4022.20 or higher. The EL6821 is supported from the Tc3_DALI library V3.16.1.0. 8 Version: 1.20.0 TE1000
## Page 9

DALI 3 DALI DALI (Digital Addressable Lighting Interface) is a definition for the standardization of digital interfaces between control gears (lamps) and control devices (sensors and application controllers). The standard (IEC 62386) allows the manufacturers of lighting components to implement complex lighting tasks easily and conveniently. The KL6811 (DALI version-1/DSI) and KL6821/EL6821 (DALI-2) Bus Terminals are integrated into the bus terminal system and are therefore fieldbus-independent. The DALI data is forwarded to the DALI devices via the respective bus coupler. Bus controllers also offer the option of running PLC programs locally in IEC 61131-3. To ensure the interoperability of DALI-2 devices with each other, the DALI Alliance (Dii A) provides a certification program. Products that have successfully completed the DALI-2 certification process may use the DALI-2 logo. All certified DALI-2 devices are entered in the Dii A product database. The product database can be accessed via the Dii A homepage: https://www.dali-alliance.org/products/4844/kl6821-dali-dali-2-multi-master-and-power-supply 3.1 IEC 62386 DALI is specified in the IEC 62386 standard and offers advantages such as flexibility, simplicity, user friendliness and robustness. IEC 62386 has been revised several times and was extended considerably in November 2014 with the publication of the second revision. While in the first revision only DALI control gears (lamps) were considered, from the second revision onwards DALI control devices (sensors and application controllers) are also included. These are described in the respective section of IEC 62386: IEC 62386-101 General system properties such as cabling, mains supply and frame structure IEC 62386-102 General properties of the DALI control gears IEC 62386-201: Fluorescent lamps (device type 0) IEC 62386-202: Emergency lighting (device type 1) IEC 62386-203: Discharge lamps (device type 2) IEC 62386-207: LED modules (device type 6) … IEC 62386-103 General properties of the DALI control devices IEC 62386-301: Push buttons IEC 62386-302: Absolute input devices IEC 62386-303: Occupancy sensor IEC 62386-304: Light sensor … The IEC 62386-101, IEC 62386-102 and IEC 62386-103 standards describe general properties, while the IEC 62386-2xx and IEC 62386-3xx standards specify the individual device types. IEC 62386-103 and IEC 62386-3xx were included in Revision 2 of the DALI standard. TE1000 Version: 1.20.0 9
## Page 10

DALI Up to 64 DALI control gears and up to 64 DALI control devices can be connected to the KL6821/EL6821 per DALI line. The KL6821/EL6821 represents the DALI controller. One such device exists for each DALI line. Up to 64 control gears, which have to be DALI/DSI devices, can be connected to the KL6811. Any number of DALI lines (KL6811, KL6821 or EL6821) can be operated with a single Twin CAT controller. 3.2 Communication With regard to the communication, a distinction is made between three frame types: • 16-bit query, configuration and control frame. • 24-bit query, configuration and control frame. • 24-bit event frame. BF: backward frame FF: forward frame 16-bit frames 16-bit frames are always sent from a DALI controller to a DALI control gear. They are used for configuring the devices, querying parameters or sending control commands. For certain DALI commands the DALI control gear sends an 8-bit backward frame. DALI control gears only send an 8-bit frame when requested. In the Tc3_DALI library these commands are identified by the PLC function blocks with the prefix FB_DALI102 or FB_DALI2xx, e.g. FB_DALI102Query Actual Level or FB_DALI207Query Features. 10 Version: 1.20.0 TE1000
## Page 11

DALI 24-bit frames 24-bit frames are always sent from a DALI controller to a DALI control device. They are used for configuring the devices, querying parameters or sending control commands. For certain DALI commands the DALI control device sends an 8-bit backward frame. In the Tc3_DALI library these commands are identified by the PLC function blocks with the prefix FB_DALI103 or FB_DALI3xx, e.g. FB_DALI103Query Operating Mode or FB_DALI303Set Hold Timer. 24-bit events DALI control devices are able to send events. They are always evaluated by the DALI controller and have a length of 24 bits. Individual events can be filtered out and further processed with the function blocks FB_DALIGet Input Notification [} 890] and FB_DALIGet Power Cycle Notification [} 892]. Further information on DALI can be found on the homepage of the DALI Alliance (https://www.dali- alliance.org) and in the IEC 62386 standard. The KL6811 only supports the first revision of the DALI standard. It is not possible to operate control devices with the KL6811. 3.3 Priorities If several DALI control devices are connected to a DALI line, priorities control concurrent access to the DALI bus. According to IEC 62386-103, all DALI-2 devices that can initiate sending of a DALI command (controllers) or sending of an event (input devices) on the DALI bus are referred to as DALI control device. All DALI-2 devices of a DALI line must share the same data line. To avoid collisions during sending, the sending device checks whether the DALI bus has already been assigned. Sending takes place after a certain settling time, once the DALI bus is free. For high-priority DALI commands the bus access takes place after a short settling time, for low-priority commands the settling time is longer. In other words, high-priority DALI commands are given preference over low-priority DALI commands. DALI control gears are defined in IEC 62386-102. They are not capable of sending DALI commands or events independently. DALI control gears may only return the 8-bit backward frame to forward frames sent by a DALI controller (see also Communication [} 10]). Since a DALI controller waits for the backward frame, the 8-bit backward frame has the shortest settling time. This settling time is shorter than for DALI commands with the highest priority. This means that DALI forward frames can be processed without interference from other DALI commands. The priorities used by a DALI controller for sending the DALI commands are referred to as command priorities and are mapped by the data type E_DALICommand Priority [} 906]. Command priorities can have 5 different values: • Low: DALI priority 5 • Middle low: DALI priority 4 • Middle: DALI priority 3 • Middle high: DALI priority 2 • High: DALI priority 1 Most function blocks referred to in chapter Part 102 (control gears) [} 21] have the input e Command Priority. This input is used to specify the priority with which the DALI commands are to be sent via the KL6821/ EL6821. TE1000 Version: 1.20.0 11
## Page 12

DALI Events also have a priority (event priority), which is represented by the data type E_DALIEvent Priority [} 908]. Event priorities can have 4 values in the range Low (DALI priority 5) to Middle high (DALI priority 2). The event priority is written as a parameter (see instance variable event Priority [} 238]) into the respective instances of the DALI devices. Priority High (DALI priority 1) is only allowed for DALI-2 commands and cannot be used for events. Tc3_DALI uses the following values for the priorities: E_DALICommand Priority/ Application E_DALIEvent Priority Low - Middle Low Light sensor events (Part 304). All other DALI commands. Middle Events of push buttons (Part 301), absolute input devices (Part 302) and occupancy sensors (Part 303). Middle High DALI commands for writing parameters and for addressing DALI devices. High DALI commands for transactions (from the second DALI command). When selecting priorities, care should always be taken to ensure that time-critical events that are important for switching the lighting have a higher priority than the DALI commands themselves. Non-system-critical DALI commands, such as the cyclic querying of states for the display in a visualization, should be sent with a lower priority. Priorities for DALI commands (E_DALICommand Priority [} 906]) are supported from Tc3_DALI V3.11.0.0. If the KL6821 is used, it must contain the firmware BD or newer. Older firmware versions always send DALI commands with the priority High. Neither the KL6811 nor the Tc2_DALI library support priorities for DALI commands. Priorities are always important in situations where DALI sensors (input devices) send events and DALI commands are sent in parallel via the KL6821/EL6821. If only DALI control gears and a DALI controller (KL6821/EL6821) are connected to a DALI line, the priorities of the DALI commands are of secondary importance. The priorities of the DALI commands can also be neglected if the DALI sensors on the DALI line do not send notifications. Further details about the DALI priorities can also be found in the following chapter Bus Timing [} 12]. 3.4 Bus Timing The following describes the structure and operation of the DALI protocol. This description focuses on the most important basic principles. For a full explanation, the IEC 62386 standard, in particular Part 101, should be consulted. 3.4.1 Structure data frame Each Forward Frame (FF) and Backward Frame (BF) basically consists of: • 1 start bit • n data bits • 1 stop condition The most significant bit (MSB) is transmitted at the beginning. 12 Version: 1.20.0 TE1000
## Page 13

DALI Transmission is via Manchester coding with a data transfer rate of 1200 bits per second. Thus, each bit has a length of 0.833 ms (1 / 1200 = 0.000833). The Stop condition has a length of at least 2.45 ms. A fixed time (settling time) must be waited between the sending of two data frames before the sending of the next data frame can be started. The length of the settling time depends on the DALI priority with which a data frame is sent. The higher the DALI priority, the smaller the settling time. Settling time Minimum Mean value Maximum between FF and BF 5.5 ms 8.0 ms 10.5 ms before each FF (DALI 13.5 ms 14.1 ms 14.7 ms priority High) before each FF (DALI 14.9 ms 15.5 ms 16.1 ms priority Middle high) before each FF (DALI 16.3 ms 17.0 ms 17.7 ms priority Middle) before each FF (DALI 17.9 ms 18.6 ms 19.3 ms priority Middle low) before each FF (DALI 19.5 ms 20.3 ms 21.2 ms priority Low) More information about DALI priorities is also available in the chapter Priorities [} 11]. Thus, data frames with a higher DALI priority (low settling time) occupy the DALI bus earlier, compared to data frames with a lower DALI priority (high settling time). Certain DALI commands must be sent twice within 100 ms (send-twice) without the receiver being allowed to receive another DALI command in the meantime. Only then will the DALI command be recognized as valid by the receiver. This is primarily used with DALI commands that are used to configure DALI devices. So that the two DALI commands are not interrupted by another DALI command, the 2nd DALI command is always sent with DALI priority High. The DALI priority High is reserved for these DALI commands and must not be used in any other context. TE1000 Version: 1.20.0 13
## Page 14

DALI 3.4.2 Transmission length The approximate transmission length can be determined from the bit length and the structure of the data frame. For further (simplified) consideration, a mean settling time of 17.0 ms is used for the forward frames (FF), and a mean settling time of 8 ms for the backward frames (BF). Between the two DALI commands sent within 100 ms (send-twice), a settling time of 14.1 ms is used. The number of bits results from the number of data bits (8, 16 or 24) plus the start bit. Thus 9, 17 or 25 bits are transmitted with the respective frames. 16-bit frame without backward frame: 17.0 ms + (17 x 0.833 ms) = 31.2 ms. 16-bit frame with backward frame: 17.0 ms + (17 x 0.833 ms) + 8.0 ms + (9 x 0.833 ms) = 46.7 ms. 16-bit frame send-twice: 17.0 ms + (17 x 0.833 ms) + 14.1 ms + (17 x 0.833 ms) = 59.4 ms. 24-bit frame without backward frame: 17.0 ms + (25 x 0.833 ms) = 37.8 ms. 24-bit frame with backward frame: 17.0 ms + (25 x 0.833 ms) + 8.0 ms + (9 x 0.833 ms) = 53.3 ms. 24-bit frame send-twice: 17.0 ms + (25 x 0.833 ms) + 14.1 ms + (25 x 0.833 ms) = 72.8 ms. The following table lists the average transmission lengths of the individual frames. This results in a maximum possible number of frames per second. The PLC program should be designed in such a way that the number of frames always falls below the maximum. Frame Transmission length Frames per second 16-bit frame without backward 31.2 ms approx. 32 frame 16-bit frame with backward frame 46.7 ms approx. 21 16-bit frame send-twice 59.4 ms approx. 16 24-bit frame without backward 37.8 ms approx. 26 frame 24-bit frame with backward frame 53.3 ms approx. 18 24-bit frame send-twice 72.8 ms approx. 13 3.4.3 Collision detection The generation of the DALI frames is achieved in a DALI device by changing between high and low level within defined times. At a low level, the DALI bus is pulled towards 0 V against a current limitation. With a high level, the DALI connection from the DALI device is high-resistance. With DALI-2, it may happen that several DALI devices try to send DALI frames independently of each other. For this reason, DALI-2 includes collision avoidance, collision detection and collision resolution. Collision avoidance is achieved by using the DALI priorities. Before a DALI device sends a DALI frame, it is checked whether the DALI bus is free. Only if the DALI bus is free (high level), a bus access may take place. Correct use of DALI priorities reduces the probability of simultaneous bus access and thus minimizes the number of collisions. Nevertheless, the DALI priorities cannot completely avoid collisions on the DALI bus, since DALI frames from different DALI devices may have the same DALI priority. For this reason, DALI-2 has collision detection and collision resolution. The following diagram explains the collision resolution. If several DALI devices send a high level, this cannot be detected by the DALI devices. The resulting voltage on the DALI bus is also a high level in this case. 14 Version: 1.20.0 TE1000
## Page 15

DALI At point A DALI device 1 detects a collision, because an attempt is made to generate a high signal at this point, but the DALI bus is pulled to low level by DALI device 2. DALI device 1 starts the break sequence for this reason. During this time the DALI device pulls the DALI bus to low level. At point B DALI device 2 tries to generate a high level. However, since the DALI bus is pulled to low level by DALI device 1, DALI device 2 also detects a collision and also starts the break sequence. At point C the break sequence of DALI device 1 has expired. Subsequently, it is checked whether the DALI bus is still at low level. Since this is the case, the system waits until the DALI bus is free again. DALI device 1 then starts sending the DALI frame again, including the settling time. If the break sequence is finished at DALI device 2, the DALI bus is not occupied by any other DALI device (point D). Therefore the recover sequence is started at DALI device 2 and then the DALI frame is sent again directly (without settling time). The break sequence has a length of 1.2 ms to 1.4 ms, while the recover sequence can be between 4.0 ms and 4.6 ms. Collisions on the DALI bus interrupt the transmission on the DALI bus for several milliseconds. This further reduces the data throughput. For this reason, a DALI system should be put together and configured in such a way that as few collisions as possible occur. 3.4.4 Cycle times PLC tasks For practical application, the cycle times of the PLC tasks should, if possible, always be set so that the maximum data transfer rate from the DALI bus is achieved. Tests were performed to determine the number of frames at different cycle times of the PLC tasks. For this purpose, a PLC program was used, which cyclically sends 6 frames independently of each other. Three 16- bit frames (2 x without backward frame, 1 x with backward frame) and three 24-bit frames (2 x without backward frame, 1 x with backward frame) were sent. Since the send-twice frames are only of importance for the configuration of DALI devices, they were not considered further. The total transmission length of the 6 frames was thus 238 ms (2 x 21.2 ms + 46.7 ms + 2 x 37.8 ms + 53.3 ms). This means that the sample program could send a maximum of 25 frames per second (1000 ms / 238 ms x 6). Events that are additionally sent by possible DALI sensors (input devices) are not taken into account. TE1000 Version: 1.20.0 15
## Page 16

DALI 80 ms 60 ms 40 ms 30 ms 20 ms 10 ms 8 ms 6 ms 4 ms 30 ms 6 7 7 8 8 8 8 8 8 15 ms 11 11 12 12 13 13 13 13 13 10 ms 15 15 16 17 17 17 17 17 17 8 ms 18 18 19 19 20 20 20 20 20 6 ms 20 21 21 22 22 22 22 22 22 4 ms 23 23 24 25 25 25 25 25 25 2 ms 23 24 25 25 25 25 25 25 25 The times in the top line (4 ms ... 80 ms) specify the cycle time of the PLC task from which the DALI commands are started. The times (2 ms ... 30 ms) in the first column specify the cycle time of the PLC task for background communication. 3.4.5 Summary Even though the test program is only representative, it can be clearly seen that the cycle time of the background communication has a decisive influence on the data throughput. If a maximum data transfer rate is required on the DALI bus, the following points must be observed: • K-bus and fieldbus should be arranged so that the cycle time for the PLC task accessing the DALI terminal (background communication) does not exceed 6 ms. • The number of events of the DALI sensors (input devices) should be as low as possible. The more events are sent, the higher the probability of collisions on the DALI bus. The DALI sensors should be configured so that the number of events is minimal. • To reduce the number of collisions on the DALI bus, the DALI priorities should be used. Recommendations for this can be found in the chapter DALI priorities [} 11]. • A large number of DALI control devices also increases the probability of collisions on the DALI bus. If necessary, the DALI control devices must be divided among different DALI lines. DALI control devices are DALI controllers and DALI sensors (see chapter Communication [} 10]). 3.5 Memory banks Memory banks are freely accessible memory areas in which device-specific information and properties can be stored. The contents of the memory banks can be read with FB_DALI10x Read Memory Location (see FB_DALI102Read Memory Location [} 129] and FB_DALI103Read Memory Location [} 215]) and, if enabled, written with FB_DALI10x Write Memory Location No Reply (see FB_DALI102Write Memory Location No Reply [} 146] and FB_DALI103Write Memory Location No Reply [} 232]). Part of the memory banks can be provided with write protection. A DALI device can support a maximum of 256 memory banks, each with up to 255 bytes, with memory banks 200 to 255 being reserved. Memory bank 0 and memory bank 1 are predefined by IEC 62386. Structure of memory bank 0: Memory bank 0 is read only and contains general, vendor-specific information about the DALI control gear or DALI control device. Every certified DALI device must implement memory bank 0. Up to offset 16#1A the fields are defined by IEC 62386 as follows. 16 Version: 1.20.0 TE1000
## Page 17

DALI Offset Description Default values 16#00 Offset of the last memory area inside the memory bank that can Vendor-specific be accessed. 16#01 Reserved, not implemented 16#02 Number of the last memory bank that can be accessed. Vendor-specific 16#03 GTIN byte 0 (MSB) Vendor-specific 16#04 GTIN byte 1 Vendor-specific 16#05 GTIN byte 2 Vendor-specific 16#06 GTIN byte 3 Vendor-specific 16#07 GTIN byte 4 Vendor-specific 16#08 GTIN byte 5 (LSB) Vendor-specific 16#09 Firmware Version (major) Vendor-specific 16#0A Firmware Version (minor) Vendor-specific 16#0B Identification number byte 0 (MSB) Vendor-specific 16#0C Identification number byte 1 Vendor-specific 16#0D Identification number byte 2 Vendor-specific 16#0E Identification number byte 3 Vendor-specific 16#0F Identification number byte 4 Vendor-specific 16#10 Identification number byte 5 Vendor-specific 16#11 Identification number byte 6 Vendor-specific 16#12 Identification number byte 7 (LSB) Vendor-specific 16#13 Hardware version (major) Vendor-specific 16#14 Hardware version (minor) Vendor-specific 16#15 101 Version number of the current DALI standard Vendor-specific 16#16 102 Version numbers of all integrated DALI control gears Vendor-specific 16#17 103 Version numbers of all integrated DALI control devices Vendor-specific 16#18 Number of logical control units in the device Vendor-specific 16#19 Number of logical control gears in the device Vendor-specific 16#1A Index number of this logical DALI control gear or DALI control Vendor-specific device 16#1B… Reserved, not implemented 16#7F 16#80… Additional device information Vendor-specific 16#FE 16#FF Reserved, not implemented Structure of memory bank 1: Memory bank 1 can be used by the device vendor to store further information in the DALI device. Up to offset 16#10 the fields are defined by IEC 62386 as follows. TE1000 Version: 1.20.0 17
## Page 18

DALI Offset Description Default values Memory 16#00 Offset of the last memory area inside the memory Vendor-specific bank that can be accessed. (16#10… 16#FE) 16#01 Indicator byte Vendor-specific 16#02 Lock byte for memory bank 1. Writeable bytes 16#FF become changeable through the value 16#55. No other values make writing possible. 16#03 OEM GTIN byte 0 (MSB) 16#FF Lockable by byte 16#02 16#04 OEM GTIN byte 1 16#FF Lockable by byte 16#02 16#05 OEM GTIN byte 2 16#FF Lockable by byte 16#02 16#06 OEM GTIN byte 3 16#FF Lockable by byte 16#02 16#07 OEM GTIN byte 4 16#FF Lockable by byte 16#02 16#08 OEM GTIN byte 5 (LSB) 16#FF Lockable by byte 16#02 16#09 OEM Identification number byte 0 (MSB) 16#FF Lockable by byte 16#02 16#0A OEM Identification number byte 1 16#FF Lockable by byte 16#02 16#0B OEM Identification number byte 2 16#FF Lockable by byte 16#02 16#0C OEM Identification number byte 3 16#FF Lockable by byte 16#02 16#0D OEM Identification number byte 4 16#FF Lockable by byte 16#02 16#0E OEM Identification number byte 5 16#FF Lockable by byte 16#02 16#0F OEM Identification number byte 6 16#FF Lockable by byte 16#02 16#10 OEM Identification number byte 7 (LSB) 16#FF Lockable by byte 16#02 16#11… Additional device information Vendor-specific 16#FE 16#FF Reserved, not implemented Structure of memory banks 2 to 199: The device vendor can use memory banks 2 to 199 to supply further parameters. The structure of the memory banks is always as shown below. The vendor of the DALI device must be consulted regarding the contents and the possibility to write individual bytes. Offset Description Default values Memory 16#00 Offset of the last memory area inside the memory Vendor-specific bank that can be accessed. (16#03… 16#FE) 16#01 Indicator byte Vendor-specific 16#02 Lock byte for the memory bank. Writeable bytes 16#FF become changeable through the value 16#55. No other values make writing possible. 16#03… Additional device information Vendor-specific Vendor-specific; lockable by 16#FE byte 16#02 if enabled by the vendor 16#FF Reserved, not implemented Access to memory bank 2 on the EL6821 Since the KL6821/EL6821 represents a DALI control device according to IEC 62386, the Bus Terminal must offer memory bank 0 and memory bank 1. Other DALI control devices can access these memory banks via the corresponding DALI commands. In addition, the EL6821 offers memory bank 2. In the EL6821 memory bank 2 is mapped by Co E object 16#8002. The first three fields (16#8002:01 ... 16#8002:03) are defined by IEC 62386 (see above). The fields 16#8002:04 to 16#8002:FF can be written and/or read individually. 18 Version: 1.20.0 TE1000
## Page 19

DALI Note that the offset in memory bank 2 and the subindex are shifted from the Co E. Thus, offset 10 in memory bank 2 corresponds to field 16#8002:0B. The function blocks FB_DALI102Read Memory Location [} 129]/FB_DALI103Read Memory Location [} 215] or FB_DALI102Write Memory Location No Reply [} 146]/FB_DALI103Write Memory Location No Reply [} 232] are available for accessing the memory banks of a DALI device via the DALI bus. If memory bank 2 of the own EL6821 is to be accessed from a PLC program, access is via the Ether CAT Co E interface. The Twin CAT library Tc2_Ether CAT offers the necessary function blocks for this (see FB_Ec Coe Sdo Read and FB_Ec Coe Sdo Write). The following example reads offset 3 (subindex 4) and writes offset 4 (subindex 5) of memory bank 2. The EL6821 must be located at the same controller where the PLC program is executed. VAR fb Co ERead : FB_Ec Co ESdo Read; fb Co EWrite : FB_Ec Co ESdo Write; n Value : USINT; b Execute Read : BOOL; b Execute Write : BOOL; END_VAR fb Co ERead(s Net Id := F_Create Ams Net Id(GVL.st EL6821In Data01.st Ads Addr.net Id), n Slave Addr := GVL.st EL6821In Data01.st Ads Addr.port, n Index := 16#8002, n Sub Index := 16#04, p Dst Buf := ADR(n Value), cb Buf Len := SIZEOF(n Value), b Execute := b Execute Read); IF (NOT fb Co ERead.b Busy) THEN b Execute Read := FALSE; END_IF fb Co EWrite(s Net Id := F_Create Ams Net Id(GVL.st EL6821In Data01.st Ads Addr.net Id), n Slave Addr := GVL.st EL6821In Data01.st Ads Addr.port, n Index := 16#8002, n Sub Index := 16#05, p Src Buf := ADR(n Value), cb Buf Len := SIZEOF(n Value), b Execute := b Execute Write); TE1000 Version: 1.20.0 19
## Page 20

DALI IF (NOT fb Co EWrite.b Busy) THEN b Execute Write := FALSE; END_IF 20 Version: 1.20.0 TE1000
## Page 21

Programming 4 Programming 4.1 POUs 4.1.1 Applications 4.1.1.1 Part 102 (control gears) 4.1.1.1.1 Addressing 4.1.1.1.1.1 FB_DALI102Addressing This function block addresses the DALI control gears at random. The user has no influence on which DALI control gear is assigned which short address. Short addresses are allocated in ascending order. Applying a positive edge to the b Start input starts the function block, and the b Busy output goes TRUE. Depending on the selected options (parameter n Options) the group membership and scenes are subsequently deleted. The terminal now addresses all DALI control gears independently. Once all DALI control gears have been addressed, the b Busy output goes back to FALSE. The n Addressed Devices output variable supplies information about how many DALI control gears have received a short address. Processing this function block can take several minutes, depending on how many DALI control gears are attached. Inputs VAR_INPUT b Start : BOOL; n Start With Short Address : BYTE := 0; n Options : DWORD := Tc3_DALI. GVL.c Optical Feedback; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Start With Short Addr BYTE Short address, assigned to the first DALI control gear ess (0...63). n Options DWORD Options for addressing the DALI control gears (see table below). The individual constants must be linked with OR operators. TE1000 Version: 1.20.0 21
## Page 22

Programming Constant Description Tc3_DALI. GVL.c Complete New Installation All DALI control gears are re-addressed, including control gears that already have a short address. Tc3_DALI. GVL.c Delete All Group Assignme Before addressing commences, any group assignments are nts deleted for all DALI control gears, including those that are not actually addressed. Tc3_DALI. GVL.c Delete All Scene Assignme Before addressing commences, any scene assignments are nts deleted for all DALI control gears, including those that are not actually addressed. Tc3_DALI. GVL.c Optical Feedback Prior to addressing, all control gears are set to min Level. Newly addressed DALI control gears are assigned max Level brightness after assignment of the short address. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Addressed Devices : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Addressed Devices BYTE If addressing has been completed (b Busy is FALSE), then the number of addressed control gears is shown at this output. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.1.1.1.2 FB_DALI102Change Addresses 22 Version: 1.20.0 TE1000
## Page 23

Programming This function block can be used to change the short addresses of several DALI control gears. A list of the DALI control gears for which the short address is to be changed is transferred in the array a Change Address List of type ST_DALIChange Address List [} 901]. The list has 64 entries from 0 to 63. Each entry contains a variable n Old Address and n New Address with which the address assignment is parameterized. The end of the list is programmed with a 255 entry at n Old Address, so that the whole list does not necessarily have to be filled in. If this entry is missing, however, then all entries are accepted. When the function block is started (positive edge on b Start), the list end is first determined on the basis of the described entry and afterwards the valid list range is examined for the following false entries: • Address entries > 63 • Double address entry on the source page n Old Address • Double address entry on the target page n New Address (leads to double assignment of an address and, hence, to errors) The function block then uses the short addresses to determine the internal long addresses of the DALI devices and enters them in the n Random Address parameter of the list. If an error occurs during queries or during reprogramming, this leads to an error entry for the respective device in the list element n Errors (see ST_DALIChange Address List [} 901]). The individual bits in the list element n Errors have the following meaning: Bit Error 0 Error during reading of the long address 1 - 2 - 3 - 4 - 5 Error during programming of the new short address 6 n Old Address and n New Address have the same values Inputs VAR_INPUT b Start : BOOL; n Options : DWORD := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Options DWORD Reserved for future extensions. Inputs/outputs VAR_IN_OUT a Change Address List : ARRAY [0..63] OF ST_DALIChange Address List; END_VAR Name Type Description a Change Address List ARRAY OF List of short addresses to be changed. ST_DALIChange Address Lis t [} 901] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 23
## Page 24

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.1.1.2 Power control 4.1.1.1.2.1 FB_DALI102Constant Light Control The FB_DALI102Constant Light Control function block provides the basic functions for implementing constant light regulation. The system attempts to regulate to a specified setpoint (n Setpoint Value) by dimming up and down cyclically. The control dynamics are determined by a dead time (t Dead Time). The dead time defines the settling time between the individual DALI commands for changing the output value (n Actual Level). The smaller the dead time, the faster the control. A freely definable hysteresis (n Hysteresis) prevents continuous oscillation around the setpoint. If the actual value is within the hysteresis range around the setpoint, the output value of the DALI control gears is not changed. 24 Version: 1.20.0 TE1000
## Page 25

Programming Operation The function block offers the option to address a single DALI control gear via a short address, several DALI control gears via a group address, or all DALI control gears of a DALI line via a broadcast. The variables min Level [} 155], max Level [} 155], fade Rate [} 155], fade Time [} 156], extended Fade Time Base [} 157] and extended Fade Time Multiplier [} 157] are parameters that are stored separately in each DALI control gear. These variables can be changed in the DALI control gears by writing to the respective properties and with a positive edge at the input b Initialize. Control The output value of the DALI control gears can be switched by positive edges at the inputs b On, b Off and b Toggle. If the DALI control gears are switched on and control is active (b Enable = TRUE), then they are regulated to the specified setpoint. If the control is not active (b Enable = FALSE), the output value of the DALI control gears remains unchanged. The step-by-step adaption of the output value of the DALI control gears is carried out with the DALI commands STEP UP/STEP DOWN or UP/DOWN. If the control deviation (n Deviation) is greater than n Hysteresis, the DALI command UP/DOWN is used to adjust the output value. The number of steps by which the output value changes is specified by the e Fade Rate property. If the control deviation is between n Hysteresis/2 and n Hysteresis, the DALI command STEP UP/STEP DOWN is used and thus the output value is only adjusted by one step. If the control deviation is smaller than n Hysteresis/2, the output value of the DALI control gears remains unchanged. The control deviation is calculated from n Setpoint Value - n Actual Brightness. The dead time (t Deadtime) specifies the time after which the output value is adapted. The DALI command STEP UP/STEP DOWN or UP/DOWN is called only once per control cycle. Operation via the inputs b On, b Off, and b Toggle The output value of the DALI control gears can be changed immediately by positive edges at the inputs b On, b Off, and b Toggle. This is independent of whether the control has been enabled or disabled (b Enable). The variables fade Time, extended Fade Time Base, and extended Fade Time Multiplier specify the speed at which the output value is changed when the DALI control gears are switched on via b On or b Toggle. Switching off the DALI control gears by b Off or b Toggle takes place immediately. In this case, n Switch On Level is used as the switch-on value. This value must lie in the range of the properties n Min Level and n Max Level. DALI short address reference device (n Reference Device Address) If several DALI control gears are addressed, the current output value of the reference DALI control gear is read out via n Reference Device Address. The DALI control gears are set to the desired output value, depending on the state of the reference DALI control gear. The parameter n Reference Device Address is also used if the output value of the reference DALI control gear is read out cyclically in the background (t Cycle Actual Level > 0 sec). No reference DALI control gear is required if a single DALI control gear is to be controlled with the function block (e Address Type = E_DALIAddress Type. Short). The output value of the individual DALI control gear is determined via n Address. The parameter n Reference Device Address has no meaning in this case. If n Reference Device Address is used, it must always contain the short address of a DALI control gear, which is also contained in the addressed DALI group. For a broadcast a DALI control gear with the corresponding short address must be present on the DALI line. TE1000 Version: 1.20.0 25
## Page 26

Programming Sample The following sample shows how a DALI light sensor can be combined with the FB_DALIConstant Light Control function block. In this sample, the PD11-BMS-FLAT DALI sensor from B. E. G. is used. Since only the measured brightness is required, the instance for the movement sensor is disabled (property b Enable Occupancy). The brightness is read out from the DALI sensor via the input b Query Brightness. Thus, the instance for the light sensor can also be disabled (property b Enable Brightness). At the end of the dead time, the output b Control Cycler Ending of the constant light regulation is set to TRUE. This positive edge is connected to the input b Query Brightness of the DALI sensor. This means that the current brightness value is read out immediately before calculating the control deviation (n Deviation). By deactivating both instances, the DALI sensor does not send any events and the DALI bus is not unnecessarily loaded. The properties are initialized directly when the instance is declared. This means that explicit assignment at runtime is no longer necessary. PROGRAM P_Constant Light Control VAR fb Brightness : FB_DALI_BEG_PD11_BMS_V8_Flat(Communication.fb KL6821Communication) := (b Enable Occupancy := FALSE, b Enable Brightness := FALSE); fb Constant Light Control : FB_DALI102Constant Light Control(Communication.fb KL6821Communication) := (n Min Level := 85, n Max Level := 254); b Initialize : BOOL; b Toggle : BOOL; n Brightness Level : UINT; n Actual Level : BYTE; n Deviation : DINT; END_VAR 26 Version: 1.20.0 TE1000
## Page 27

Programming Inputs VAR_INPUT b Initialize : BOOL := FALSE; b Enable : BOOL := TRUE; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Setpoint Value : UINT := 500; n Actual Brightness : UINT := 500; n Hysteresis : UINT := 30; t Deadtime : TIME := T#5S; b On : BOOL; b Off : BOOL; b Toggle : BOOL; n Switch On Level : BYTE := 254; n Reference Device Address : BYTE; t Cycle Actual Level : TIME := T#30S; n Options : DWORD := 0; END_VAR Name Type Description b Initialize BOOL A positive edge at this input writes the values of all properties to the DALI control gears. Writing the properties to the DALI control gears is only possible if no other functions are being executed by the function block (b Busy = FALSE). b Enable BOOL Activates constant light regulation as soon as this input is TRUE. If the input is FALSE, the constant light regulation is disabled. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Setpoint Value UINT The setpoint is applied to this input (0...65535). n Actual Brightness UINT The actual value is applied at this input. n Hysteresis UINT Control hysteresis (1...65535) around the setpoint. If the actual value is within this range, the output values of the DALI control gears are not changed. t Deadtime TIME After the dead time (2...3600 s) has elapsed, the control deviation is recalculated and, if necessary, the output values of the DALI control gears are reduced or increased. b On BOOL A positive edge at this input sets the DALI control gears to n Switch On Level. b Off BOOL The DALI control gears are switched off via a positive edge at this input. b Toggle BOOL A positive edge at this input toggles the DALI control gears between Off and n Switch On Level. n Switch On Level BYTE Output value (min Level...max Level) for switching on the DALI control gears by the b On and b Toggle inputs. n Reference Device A BYTE Short address (0...63) of the reference DALI control gear ddress for group call and broadcast. This parameter is not evaluated if e Address Type = E_DALIAddress Type. Short. In this case, the reference DALI control gear is read out via n Address. t Cycle Actual Level TIME Cycle time with which the current output value of the reference DALI control gear is read out in the background. Set the cycle time such that as few DALI commands as possible are sent. If the time is set to 0 sec, no reading takes place. n Options DWORD Reserved for future extensions. TE1000 Version: 1.20.0 27
## Page 28

Programming Constant Description Tc3_DALI. GVL.c Memory Mode Activates memory mode. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Initializing : BOOL; n Actual Level : BYTE; n Deviation : DINT; b Control Cycle Ending : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Initializing BOOL The output is set as soon as the initialization of the DALI control gears has been started, and remains active until all DALI commands have been executed. n Actual Level BYTE Current output value (0, min Level...max Level, 255) of the reference DALI control gear that is addressed via n Reference Device Address. If e Address Type = E_DALIAddress Type. Short, the reference DALI control gear is read out via n Address. A value of 255 (MASK) indicates that an error occurred while reading the output value from the reference DALI control gear. The cause could be, for example, a technical defect or that the DALI control gear is in the start-up phase. In this case b Error is not set to TRUE. n Deviation DINT Current control deviation (n Setpoint Value - n Actual Brightness) b Control Cycle Endin BOOL Before the dead time(t Deadtime) expires, this output is set g to TRUE for 500 ms. This output can be used, for example, to read the current brightness from a DALI light sensor. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 28 Version: 1.20.0 TE1000
## Page 29

Programming Name Type Access Initial Description value n Max Level BYTE Get, Set 254 See variable max Level [} 155]. n Min Level BYTE Get, Set 126 See variable min Level [} 155]. e Fade Rate E_DALIF Get, Set N045Ste See variable fade Rate [} 155]. ade Rate ps Per Sec e Fade Time E_DALIF Get, Set Disabled See variable fade Time [} 156]. ade Time e Extended Fade Ti E_DALIE Get, Set Base01 See variable extended Fade Time Base [} 157]. me Base xtended F ade Time Base e Extended Fade Ti E_DALIE Get, Set Disabled See variable extended Fade Time Multiplier [} 157]. me Multiplier xtended F ade Time Multiplier ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 4.1.1.1.2.2 FB_DALI102Dimmer1Switch The function block FB_DALI102Dimmer1Switch provides the main functions for implementing a push- dimmer. Operation The input b Switch is intended for linking with a push button. Pressing the button briefly switches the DALI control gears on or off. Pressing the button longer causes the output value of the DALI control gears to dim cyclically between the minimum and maximum values (see below). The output value of the DALI control gears can be changed by positive edges at the inputs b Recall Min Level, b Recall Max Level, b On, b Off, b Toogle, b Go To Scene and b Set Level (see below). The function block offers the option to address a single DALI control gear via a short address, several DALI control gears via a group address or all DALI control gears of a DALI line via a broadcast. TE1000 Version: 1.20.0 29
## Page 30

Programming The variables min Level [} 155], max Level [} 155], fade Rate [} 155], fade Time [} 156], extended Fade Time Base [} 157] and extended Fade Time Multiplier [} 157] are parameters that are stored separately in each DALI control gear. These variables can be changed in the DALI control gears via the properties and via the input b Initialize. If DALI commands are sent for setting the output values (b Busy = TRUE), further positive edges at the inputs are ignored. New commands can be executed as soon as b Busy has been reset again. Operation via the input b Switch A short signal at the input b Switch switches the DALI control gears on or off, depending on the state of the reference DALI control gear. If the signal is present for longer, the system switches to dimmer mode and the output values of the DALI control gears move cyclically between min Level and max Level until b Switch is FALSE again. If the output value of the reference DALI control gear reaches the limit value min Level or max Level, the function block changes its dimming direction. If b Switch is set to FALSE again, the current output values of the DALI control gears remain unchanged. A new pulse at the input b Switch sets the output values to 0. If the input b Switch is briefly deactivated in dimmer mode, the function block changes its dimming direction. The speed at which the output values of the DALI control gears change in dimmer mode is determined by the variable fade Rate in the individual DALI control gears. The speed at which the DALI control gears are switched on again is specified by the variables fade Time, extended Fade Time Base, and extended Fade Time Multiplier. Operation via the inputs b On, b Off, b Go To Scene and b Set Level The output value of the DALI control gears can be changed immediately by positive edges at the inputs b On, b Off, b Go To Scene, and b Set Level. For b On, b Go To Scene and b Set Level, the speed at which the specified value is to be reached is specified by the variables fade Time, extended Fade Time Base and extended Fade Time Multiplier. b Off switches the DALI control gears off immediately. Memory mode When switching on, a distinction must be made as to whether memory mode (see n Options) is active or not. If memory mode is active, the last set value is adopted as the output value for the DALI control gears when the device is switched on. If memory mode is not active, the output value from the parameter n Level Memory Mode is used for the DALI control gears. It is irrelevant whether the DALI control gears are switched via the input b On, b Toggle or b Switch. DALI short address reference device (n Reference Device Address) If several DALI control gears are addressed, the current output value of the reference DALI control gear is read out via n Reference Device Address. The DALI control gears are set to the desired value, depending on the state of the reference DALI control gear. The parameter n Reference Device Address is also used if the output value of the reference DALI control gear is read out cyclically in the background (t Cycle Actual Level > 0 sec). No reference DALI control gear is required if a single DALI control gear is to be controlled with the function block (e Address Type = E_DALIAddress Type. Short). The output value of the individual DALI control gear is determined via n Address. The parameter n Reference Device Address has no meaning in this case. If n Reference Device Address is used, it must always contain the short address of a DALI control gear, which is also contained in the addressed DALI group. For a broadcast a DALI control gear with the corresponding short address must be present on the DALI line. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; 30 Version: 1.20.0 TE1000
## Page 31

Programming b Switch : BOOL; b Recall Max Level : BOOL; b Recall Min Level : BOOL; b On : BOOL; b Off : BOOL; b Toggle : BOOL; b Go To Scene : BOOL; n Scene : BYTE; b Set Level : BOOL; n Level : BYTE := 254; n Level Memory Mode : BYTE := 254; n Reference Device Address : BYTE; t Cycle Actual Level : TIME := T#30S; n Options : DWORD := 0; END_VAR TE1000 Version: 1.20.0 31
## Page 32

Programming Name Type Description b Initialize BOOL A positive edge at this input writes the values of all properties to the DALI control gears. Writing the properties to the DALI control gears is only possible if no other functions are being executed by the function block (b Busy = FALSE). n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. b Switch BOOL A short signal at these inputs switches the DALI control gears on or off. If the signal is present for a longer period, the system switches to dimmer mode and the output values of the DALI control gears move to min Level or max Level. b Recall Max Level BOOL A positive edge at this input sets the DALI control gears to max Level b Recall Min Level BOOL A positive edge at this input sets the DALI control gears to min Level. b On BOOL If memory mode is active (see n Options), a positive edge at this input sets the DALI control gears to their output value before the last switching off. If memory mode is not active, the DALI control gears are set to n Level Memory Mode. b Off BOOL The DALI control gears are switched off via a positive edge at this input. The previous output value is stored internally to be used for switching on if memory mode is active (see n Options). b Toggle BOOL Each positive edge at this input causes the DALI control gears to switch between off and their output value before the last switch-off (memory mode active) or n Level Memory Mode (memory mode not active). b Go To Scene BOOL A positive edge at this input sets the output value of the DALI control gears to the value stored in n Scene. n Scene BYTE Scene (0...15) to be called up in the DALI control gears by b Go To Scene. Each DALI control gear has its own output value for each scene. b Set Level BOOL A positive edge at this input sets the output value of the DALI control gears to the value specified by n Level. n Level BYTE Output value (0, min Level...max Level, 255) to be called up in the DALI control gears by b Set Level. The output value remains unchanged if the value is 255 (MASK). n Level Memory Mode BYTE Output value (min Level...max Level) for switching on the DALI control gears when memory mode is not active. n Reference Device A BYTE Short address (0...63) of the reference DALI control gear ddress for group call and broadcast. This parameter is not evaluated if e Address Type = E_DALIAddress Type. Short. In this case, the reference DALI control gear is read out via n Address. t Cycle Actual Level TIME Cycle time with which the current output value of the reference DALI control gear is read out in the background. Set the cycle time such that as few DALI commands as possible are sent. If the time is set to 0 sec, no reading takes place. n Options DWORD Options that affect the behavior of the function block. The individual constants must be linked with OR operators. 32 Version: 1.20.0 TE1000
## Page 33

Programming Constant Description Tc3_DALI. GVL.c Memory Mode Activates memory mode. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Initializing : BOOL; n Actual Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Initializing BOOL The output is set as soon as the initialization of the DALI control gears has been started, and remains active until all DALI commands have been executed. n Actual Level BYTE Current output value (0, min Level...max Level, 255) of the reference DALI control gear that is addressed via n Reference Device Address. If e Address Type = E_DALIAddress Type. Short, the reference DALI control gear is read out via n Address. A value of 255 (MASK) indicates that an error occurred while reading the output value from the reference DALI control gear. The cause could be, for example, a technical defect or that the DALI control gear is in the start-up phase. In this case b Error is not set to TRUE. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 33
## Page 34

Programming Name Type Access Initial Description value n Max Level BYTE Get, Set 254 See variable max Level [} 155]. n Min Level BYTE Get, Set 126 See variable min Level [} 155]. e Fade Rate E_DALIF Get, Set N045Ste See variable fade Rate [} 155]. ade Rate ps Per Sec e Fade Time E_DALIF Get, Set Disabled See variable fade Time [} 156]. ade Time e Extended Fade Ti E_DALIE Get, Set Base01 See variable extended Fade Time Base [} 157]. me Base xtended F ade Time Base e Extended Fade Ti E_DALIE Get, Set Disabled See variable extended Fade Time Multiplier [} 157]. me Multiplier xtended F ade Time Multiplier ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 4.1.1.1.2.3 FB_DALI102Dimmer2Switch The function block FB_DALI102Dimmer2Switch provides the main functions for implementing a push- dimmer. Operation The inputs b Switch Up and b Switch Down are intended for linking with two push buttons. Pressing the button briefly switches the DALI control gears on or off. Pressing the button longer causes the output value of the DALI control gears to dim down to the minimum or up to the maximum values, respectively (see below). The output value of the DALI control gears can be changed by positive edges at the inputs b Recall Min Level, b Recall Max Level, b On, b Off, b Toogle, b Go To Scene and b Set Level (see below). 34 Version: 1.20.0 TE1000
## Page 35

Programming The function block offers the option to address a single DALI control gear via a short address, several DALI control gears via a group address or all DALI control gears of a DALI line via a broadcast. The variables min Level, max Level, fade Rate, fade Time, extended Fade Time Base and extended Fade Time Multiplier are parameters that are stored separately in each DALI control gear. These variables can be changed in the DALI control gears by writing to the properties and with a positive edge at the input b Initialize. If DALI commands are sent for setting the output values (b Busy = TRUE), further positive edges at the inputs are ignored. New commands can be executed as soon as b Busy has been reset again. Operation via the b Switch Up and b Switch Down inputs A short signal at the inputs b Switch Up or b Switch Down switches the DALI control gears on or off, depending on the state of the reference DALI control gear. If the signal is present for a longer time, the system switches to dimmer mode and the output values of the DALI control gears move up to min Level or max Level or until b Switch Up or b Switch Down are FALSE again. If b Switch Up or b Switch Down is set to FALSE again, the current output values of the DALI control gears remain unchanged. A new pulse at the input b Switch Up or b Switch Down sets the output values to 0. The speed at which the output values of the DALI control gears change in dimmer mode is determined by the variable fade Rate in the individual DALI control gears. The speed at which the DALI control gears are switched on again is specified by the variables fade Time, extended Fade Time Base, and extended Fade Time Multiplier. Operation via the inputs b On, b Off, b Go To Scene, and b Set Level The output value of the DALI control gears can be changed immediately by positive edges at the inputs b On, b Off, b Go To Scene, and b Set Level. For b On, b Go To Scene and b Set Level, the speed at which the specified value is to be reached is specified by the variables fade Time, extended Fade Time Base and extended Fade Time Multiplier. b Off switches the DALI control gears off immediately. Memory mode When switching on, a distinction must be made as to whether memory mode (see n Options) is active or not. If memory mode is active, the last set value is adopted as the output value for the DALI control gears when the device is switched on. If memory mode is not active, the output value from the parameter n Level Memory Mode is used for the DALI control gears. It is irrelevant whether the DALI control gears are switched via the input b On, b Toggle, b Switch Up, or b Switch Down. DALI short address reference device (n Reference Device Address) If several DALI control gears are addressed, the current output value of the reference DALI control gear is read out via n Reference Device Address. The DALI control gears are set to the desired value, depending on the state of the reference DALI control gear. The parameter n Reference Device Address is also used if the output value of the reference DALI control gear is read out cyclically in the background (t Cycle Actual Level > 0 sec). No reference DALI control gear is required if a single DALI control gear is to be controlled with the function block (e Address Type = E_DALIAddress Type. Short). The output value of the individual DALI control gear is determined via n Address. The parameter n Reference Device Address has no meaning in this case. If n Reference Device Address is used, it must always contain the short address of a DALI control gear, which is also contained in the addressed DALI group. For a broadcast a DALI control gear with the corresponding short address must be present on the DALI line. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; b Switch Up : BOOL; b Switch Down : BOOL; TE1000 Version: 1.20.0 35
## Page 36

Programming b Recall Max Level : BOOL; b Recall Min Level : BOOL; b On : BOOL; b Off : BOOL; b Toggle : BOOL; b Go To Scene : BOOL; n Scene : BYTE; b Set Level : BOOL; n Level : BYTE := 254; n Level Memory Mode : BYTE := 254; n Reference Device Address : BYTE; t Cycle Actual Level : TIME := T#30S; n Options : DWORD := 0; END_VAR 36 Version: 1.20.0 TE1000
## Page 37

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. b Switch Up/ BOOL A short signal at these inputs switches the DALI control b Switch Down gears on or off. If the signal is present for a longer period, the system switches to dimmer mode and the output values of the DALI control gears move to min Level or max Level. b Recall Max Level BOOL A positive edge at this input sets the DALI control gears to max Level b Recall Min Level BOOL A positive edge at this input sets the DALI control gears to min Level. b On BOOL If memory mode is active (see n Options), a positive edge at this input sets the DALI control gears to their output value before the last switching off. If memory mode is not active, the DALI control gears are set to n Level Memory Mode. b Off BOOL The DALI control gears are switched off via a positive edge at this input. The previous output value is stored internally to be used for switching on if memory mode is active (see n Options). b Toggle BOOL Each positive edge at this input causes the DALI control gears to switch between off and their output value before the last switch-off (memory mode active) or n Level Memory Mode (memory mode not active). b Go To Scene BOOL A positive edge at this input sets the output value of the DALI control gears to the value stored in n Scene. n Scene BYTE Scene (0...15) to be called up in the DALI control gears by b Go To Scene. Each DALI control gear has its own output value for each scene. b Set Level BOOL A positive edge at this input sets the output value of the DALI control gears to the value specified by n Level. n Level BYTE Output value (0, min Level...max Level, 255) to be called up in the DALI control gears by b Set Level. The output value remains unchanged if the value is 255 (MASK). n Level Memory Mode BYTE Output value (min Level...max Level) for switching on the DALI control gears when memory mode is not active. n Reference Device A BYTE Short address (0...63) of the reference DALI control gear ddress for group call and broadcast. This parameter is not evaluated if e Address Type = E_DALIAddress Type. Short. In this case, the reference DALI control gear is read out via n Address. t Cycle Actual Level TIME Cycle time with which the current output value of the reference DALI control gear is read out in the background. Set the cycle time such that as few DALI commands as possible are sent. If the time is set to 0 sec, no reading takes place. n Options DWORD Options that affect the behavior of the function block. The individual constants must be linked with OR operators. Constant Description Tc3_DALI. GVL.c Memory Mode Activates memory mode. TE1000 Version: 1.20.0 37
## Page 38

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Initializing : BOOL; n Actual Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Initializing BOOL The output is set as soon as the initialization of the DALI control gears has been started, and remains active until all DALI commands have been executed. n Actual Level BYTE Current output value (0, min Level...max Level, 255) of the reference DALI control gear that is addressed via n Reference Device Address. If e Address Type = E_DALIAddress Type. Short, the reference DALI control gear is read out via n Address. A value of 255 (MASK) indicates that an error occurred while reading the output value from the reference DALI control gear. The cause could be, for example, a technical defect or that the DALI control gear is in the start-up phase. In this case b Error is not set to TRUE. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 38 Version: 1.20.0 TE1000
## Page 39

Programming Name Type Access Initial Description value n Max Level BYTE Get, Set 254 See variable max Level [} 155]. n Min Level BYTE Get, Set 126 See variable min Level [} 155]. e Fade Rate E_DALIF Get, Set N045Ste See variable fade Rate [} 155]. ade Rate ps Per Sec e Fade Time E_DALIF Get, Set Disabled See variable fade Time [} 156]. ade Time e Extended Fade Ti E_DALIE Get, Set Base01 See variable extended Fade Time Base [} 157]. me Base xtended F ade Time Base e Extended Fade Ti E_DALIE Get, Set Disabled See variable extended Fade Time Multiplier [} 157]. me Multiplier xtended F ade Time Multiplier ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 4.1.1.1.3 Settings 4.1.1.1.3.1 FB_DALI102Get Settings This function block reads several variables (see table below [} 40]) from selected DALI control gears and saves them in the structure ST_DALIControl Gear Settings [} 901]. The DALI control gears that are to be read can be specified by the input variable n Devices. Each bit of this variable corresponds to a short address. Applying a positive edge to the b Start input starts the function block, and the b Busy output goes TRUE. A check is first made as to whether a DALI control gear is present at all. If this is the case, then the b Present bit is set in the respective structure (see ST_DALIControl Gear Settings [} 901]), after which the settings of the control gear are read one by one and written in the associated variables in the structure. If it is found that a device is not available, the reading is skipped and work continues with the next device. The structure index here reflects the address of the device. In other words, data for the device with short address 0 is located at arr DALIDevice Settings[0], and so on through to the device with short address 63 having its data at arr DALIDevice Settings[63]. If a read error occurs when reading from a device, the corresponding bit in n Errors is set for the respective structure without the function block itself switching to error mode. The following table shows which bit is set in the n Errors variable when an error occurs during the reading of a variable from a control gear. TE1000 Version: 1.20.0 39
## Page 40

Programming Bit Error 0 An error occurred while attempting to seek the DALI control gear. 1 Error while reading the variable actual Level [} 155]. 2 Error while reading the variable power On Level [} 155]. 3 Error while reading the variable system Failure Level [} 155]. 4 Error while reading the variable min Level [} 155]. 5 Error while reading the variable max Level [} 155]. 6 Error while reading the variable fade Rate [} 155]. 7 Error while reading the variable fade Time [} 156]. 8 Error while reading the variables extended Fade Time Base [} 157] and extended Fade Time Multiplier [} 157]. 9 Error while reading the variable random Address [} 158]. 10 Error while reading the variable gear Groups [} 159]. 11 Error while reading the variable scene0-scene15 [} 159]. 12 Error while reading the variable status Information [} 126]. 13 Error while reading the version number from the Memory Bank [} 16]. 14 Error while reading the supported device types. 15 Error while reading the variable physical Min Level [} 159]. Inputs VAR_INPUT b Start : BOOL; n Devices : LWORD; n Options : DWORD; b Cancel : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Devices LWORD Variable for selecting the DALI control gears to be read. Each bit of the variable represents a DALI control gear (0...63). All short addresses are queried with a setting of 16#FFFF_FFFF_FFFF_FFFF. n Options DWORD Options for reading the variables (see table below). The individual constants must be linked with OR operators. b Cancel BOOL A positive edge at this input will disable the function block and hence abort the reading of the variables. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] Options for reading the variables: 40 Version: 1.20.0 TE1000
## Page 41

Programming Constant Description Tc3_DALI. GVL.c Option Actual Dim Level Reads the current output value [} 155]. Tc3_DALI. GVL.c Option Power On Level Reads the current switch-on value [} 155]. Tc3_DALI. GVL.c Option System Failure Level Reads the current setting value [} 155] in case of a DALI bus error. Tc3_DALI. GVL.c Option Min Level Reads the minimum [} 155] output value. Tc3_DALI. GVL.c Option Max Level Reads the maximum [} 155] output value. Tc3_DALI. GVL.c Option Fade Rate Fade Time Reads the Fade Rate [} 155] and the Fade Time [} 156]. Tc3_DALI. GVL.c Option Extended Fade Time Reads the extended Fade Time Base [} 157] and the Fade Time Multiplier [} 157]. Tc3_DALI. GVL.c Option Random Address Reads the random address [} 158]. Tc3_DALI. GVL.c Option Groups Reads the group allocations [} 159]. Tc3_DALI. GVL.c Option Scene Levels Reads the scene settings [} 159]. Tc3_DALI. GVL.c Option Status Information Reads the status information [} 126]. Tc3_DALI. GVL.c Option Version Number Reads the version number [} 16] of the DALI control gear. Tc3_DALI. GVL.c Option Device Type Reads the device type [} 107]. Tc3_DALI. GVL.c Option Physical Min Level Reads the Physical Min Level [} 159]. Tc3_DALI. GVL.c Option All Reads all variables. e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Inputs/outputs VAR_IN_OUT arr DALIDevice Settings : ARRAY [0..63] of ST_DALIControl Gear Settings; END_VAR Name Type Description arr DALIDevice Settin ARRAY OF Array containing the read parameters of the individual gs ST_DALIControl Gear Settin DALI control gears. gs [} 901] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Current Short Address : BYTE; END_VAR TE1000 Version: 1.20.0 41
## Page 42

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Current Short Addre BYTE Indicates which short address is currently being queried. ss Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.1.1.1.3.2 FB_DALI102Observer The function block checks all DALI control gears on a DALI line for errors. Furthermore, it is checked whether there are unaddressed DALI control gears on the DALI line. For checking the DALI line, the function blocks FB_DALI102Query Control Gear Failure [} 104], FB_DALI102Query Lamp Failure [} 114] and FB_DALI102Query Missing Short Address [} 118] are called cyclically (see t Cycle). Here, all DALI commands are executed as a broadcast. This allows all DALI control gears of a DALI line to be checked with one DALI command. n Options specifies which checks are executed at the DALI line. The verification of the DALI line can also be started immediately by a positive edge at the input b Start Verification. If the error state of a DALI control gear changes, the current state is read out from all DALI control gears. The output a States contains the returned status information of the entire DALI line. Each element of a States contains the two error information of the respective DALI control gear. The meaning of the bits is defined as follows: Bit Meaning 0 Status of the DALI control gear (see control Gear Failure [} 158]) 1 Lamp failure (see lamp Failure [} 158]) Some error states can only be detected when the lamp is switched on. 42 Version: 1.20.0 TE1000
## Page 43

Programming If an unaddressed DALI control gear is detected, it is automatically addressed with the first free short address (starting at 0). Addressing is not executed if several DALI control gears without short address are detected. If several defective DALI control gears are to be replaced or additional DALI control gears are to be added, this can only be done device by device. Add an unaddressed DALI control gear and wait until it is addressed (by using the option Tc3_DALI. GVL.c Optical Feedback the newly addressed DALI control gear goes to the brightness max Level). Only then add the next unaddressed DALI control gear. The function block should only be used with the DALI-2 certified KL6821/EL6821. Inputs VAR_INPUT b Enable : BOOL := FALSE; b Start Verification : BOOL; t Cycle : TIME := T#1M; n Options : DWORD := GVL.c Optical Feedback OR GVL.c Check Control Gear Failure OR GVL.c Check L amp Failure OR GVL.c Check Unaddressed Control Gears; END_VAR Name Type Description b Enable BOOL If the input is TRUE, the verification of the DALI control gears is enabled. If the input is FALSE, the verification of the DALI control gears is disabled. b Start Verification BOOL A positive edge at this input starts immediately the verification of the DALI line. This is independent of whether the verification has been enabled or disabled (b Enable). t Cycle TIME Cycle time in which the DALI control gears are verified. Set the cycle time such that as few DALI commands as possible are sent. If the time is set to 0 s, the verification of the DALI line is not executed cyclically. n Options DWORD Options for checking the DALI line (see table below). The individual constants must be linked with OR operators. Options for verification Constant Description Tc3_DALI. GVL.c Check Control Gear Failure It is checked whether there are one or more defective DALI control gears on the DALI line. Tc3_DALI. GVL.c Check Lamp Failure It is checked whether there are one or more DALI control gears with a defective lamp on the DALI line. Tc3_DALI. GVL.c Check Unaddressed Control Gears It is checked whether there are one or more new DALI control gears (without short address) on the DALI line. Tc3_DALI. GVL.c Optical Feedback Prior to addressing, all control gears are set to min Level. Newly addressed DALI control gears are assigned max Level brightness after assignment of the short address. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; a States : ARRAY [0..63] OF BYTE; END_VAR TE1000 Version: 1.20.0 43
## Page 44

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. a States ARRAY OF BYTE Array containing the read states of all DALI control gears (see table above). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.1.1.1.3.3 FB_DALI102Set Settings This function block writes the values stored in the structure ST_DALIControl Gear Settings [} 901] to several variables (see table below [} 40]) of selected DALI control gears in a DALI line. The DALI control gears that are to be written to can be specified by the input variable n Devices. Each bit of this variable corresponds to a short address. Applying a positive edge to the b Start input starts the function block, and the b Busy output goes TRUE. A check is first made as to whether a DALI control gear is present at all. If this is the case, then the b Present bit is set in the respective structure (see ST_DALIControl Gear Settings [} 901]), after which the settings are written one by one to the control gear. If a device is detected as being missing, the writing is skipped and work continues with the next device. The structure index here reflects the address of the device. In other words, data for the device with short address 0 is located at arr DALIDevice Settings[0], and so on through to the device with short address 63 having its data at arr DALIDevice Settings[63]. If a device error occurs during writing, the corresponding bit in n Errors is set for the respective structure without the function block itself switching to error mode. The following table shows which bit is set in the n Errors variable when an error occurs during the reading of a variable from a control gear. 44 Version: 1.20.0 TE1000
## Page 45

Programming Bit Error 0 An error occurred while attempting to seek the DALI control gear. 2 Error while writing the variable power On Level [} 155]. 3 Error while writing the variable system Failure Level [} 155]. 4 Error while writing the variable min Level [} 155]. 5 Error while writing the variable max Level [} 155]. 6 Error while writing the variable fade Rate [} 155]. 7 Error while writing the variable fade Time [} 156]. 8 Error while writing the variables extended Fade Time Base [} 157] and extended Fade Time Multiplier [} 157]. 10 Error while writing the variable gear Groups [} 159]. 11 Error while writing the variable scene0-scene15 [} 159]. Inputs VAR_INPUT b Start : BOOL; n Devices : LWORD; n Options : DWORD; b Cancel : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Devices LWORD Variable for selecting the DALI control gears that are to be initialized. Each bit of the variable represents a DALI control gear (0...63). All short addresses are written to with a setting of 16#FFFF_FFFF_FFFF_FFFF. n Options DWORD Options for writing the variables (see table below). The individual constants must be linked with OR operators. b Cancel BOOL A positive edge at this input will disable the function block and hence abort the initialization of the variable. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] Options for writing to the variables: Constant Description Tc3_DALI. GVL.c Option Power On Level Initializes the current switch-on value [} 155]. Tc3_DALI. GVL.c Option System Failure Level Initializes the current setting value [} 155] in case of a DALI bus error. Tc3_DALI. GVL.c Option Min Level Initializes the maximum [} 155] output value. Tc3_DALI. GVL.c Option Max Level Initializes the minimum [} 155] output value. Tc3_DALI. GVL.c Option Fade Rate Initializes the Fade Rate [} 155]. Tc3_DALI. GVL.c Option Fade Time Initializes the Fade Time [} 156] Tc3_DALI. GVL.c Option Extended Fade Time Initializes the extended Fade Time Base [} 157] and the Fade Time Multiplier [} 157]. Tc3_DALI. GVL.c Option Groups Initializes the group allocations [} 159]. Tc3_DALI. GVL.c Option Scene Levels Initializes the scene settings [} 159]. Tc3_DALI. GVL.c Option All Initializes all variables. TE1000 Version: 1.20.0 45
## Page 46

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Inputs/outputs VAR_IN_OUT arr DALIDevice Settings : ARRAY [0..63] of ST_DALIControl Gear Settings; END_VAR Name Type Description arr DALIDevice Settin ARRAY OF Array containing the read parameters of the individual gs ST_DALIControl Gear Settin DALI control gears. gs [} 901] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Current Short Address : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Current Short Addre BYTE Indicates which short address is currently being written to. ss Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 46 Version: 1.20.0 TE1000
## Page 47

Programming 4.1.1.1.3.4 FB_DALI102Read Memory Bank The specified memory bank of the DALI control gear is read (see Memory banks [} 16]). The memory bank is specified by the parameter n Memory Bank. The range to be read can be limited with the help of the parameters n Sub Range Start and n Sub Range End. The function block changes the DTR0 and the DTR1 of all connected DALI control gears. While the function block is active (b Busy = TRUE), all function blocks that also have write access to the DTRs of the connected DALI control gears on the same DALI line are blocked. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Options : DWORD; b Cancel : BOOL; n Memory Bank : BYTE; n Sub Range Start : BYTE(0..254) := 2; n Sub Range End : BYTE := 255; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 47
## Page 48

Programming Name Type Description n Options DWORD Reserved for future extensions. b Cancel BOOL A rising edge at this input disables the function block and aborts the reading of the variables. n Memory Bank BYTE Specifies the memory bank for the read access. n Sub Range Start BYTE Offset inside the memory bank from which reading is to take place. n Sub Range End BYTE Offset inside the memory bank up to which reading is to take place. n Sub Range End Description 255 Offset 0 of the memory bank determines the offset up to which reading is to take place. 254 Offset 0 is not read at the beginning. Reading always takes place up to Offset 254. <= 253 n Sub Range End may not be greater than the value in Offset 0. The partial areas of the memory bank are read with this setting. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Current Offset : BYTE; n Last Offset : BYTE; a Values : ARRAY [0..254] OF BYTE; a Errors : ARRAY [0..254] OF BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Current Offset BYTE The offset that is currently being read is output at this output. n Last Offset BYTE Last valid offset of the memory bank that was read. a Values BYTE Array containing the read parameters of the memory bank. a Errors BOOL Array containing errors of the parameters of the memory bank that occurred during reading. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 48 Version: 1.20.0 TE1000
## Page 49

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.1.2 Part 103 (control devices) 4.1.1.2.1 Addressing 4.1.1.2.1.1 FB_DALI103Addressing This function block addresses the DALI control devices at random. The user has no influence on which control device is assigned which short address. Short addresses are allocated in ascending order. Applying a positive edge to the b Start input starts the function block, and the b Busy output goes TRUE. The terminal now addresses all DALI control devices independently. Once all DALI control devices have been addressed, the b Busy output goes back to FALSE. The output variable n Addressed Devices provides information on how many DALI control devices were assigned a short address. Depending on how many DALI control devices are connected, processing of this function block can take several minutes. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Start With Short Address : BYTE := 0; n Options : DWORD := Tc3_DALI. GVL.c Optical Feedback; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Start With Short Addr BYTE Short address assigned to the first DALI control device ess (0…63). n Options DWORD Options for addressing the DALI control devices (see table below). The individual constants must be linked with OR operators. Constant Description Tc3_DALI. GVL.c Complete New Installation All DALI control devices are readdressed, even those that already have a short address. Tc3_DALI. GVL.c Optical Feedback Newly addressed DALI control devices are allocated the DALI command IDENTIFY DEVICE once the short address has been assigned. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; TE1000 Version: 1.20.0 49
## Page 50

Programming b Busy : BOOL; n Addressed Devices : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Addressed Devices BYTE If addressing has been completed (b Busy is FALSE), then the number of addressed DALI control devices is shown at this output. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.1.2.1.2 FB_DALI103Change Addresses This function block can be used to change the short addresses of several DALI control devices. A list of the DALI control devices for which the short address is to be changed is transferred in the array a Change Address List of type ST_DALIChange Address List [} 901]. The list has 64 entries from 0 to 63. Each entry contains a variable n Old Address and n New Address with which the address assignment is parameterized. The end of the list is programmed with a 255 entry at n Old Address, so that the whole list does not necessarily have to be filled in. If this entry is missing, however, then all entries are accepted. When the function block is started (positive edge on b Start), the list end is first determined on the basis of the described entry and afterwards the valid list range is examined for the following false entries: • Address entries > 63 • Double address entry on the source page n Old Address • Double address entry on the target page n New Address (leads to double assignment of an address and, hence, to errors) The function block then uses the short addresses to determine the internal long addresses of the DALI devices and enters them in the n Random Address parameter of the list. 50 Version: 1.20.0 TE1000
## Page 51

Programming If an error occurs during queries or during reprogramming, this leads to an error entry for the respective device in the list element n Errors (see ST_DALIChange Address List [} 901]). The individual bits in the list element n Errors have the following meaning: Bit Error 0 Error during reading of the long address 1 - 2 - 3 - 4 - 5 Error during programming of the new short address 6 n Old Address and n New Address have the same values The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Options : DWORD := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Options DWORD Reserved for future extensions. Inputs/outputs VAR_IN_OUT a Change Address List : ARRAY [0..63] OF ST_DALIChange Address List; END_VAR Name Type Description a Change Address List ARRAY OF List of short addresses to be changed. ST_DALIChange Address Lis t [} 901] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 51
## Page 52

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.1.2.2 Settings 4.1.1.2.2.1 FB_DALI103Read Memory Bank The specified memory bank of the DALI control device is read (see Memory banks [} 16]). The memory bank is specified by the parameter n Memory Bank. The range to be read can be limited with the help of the parameters n Sub Range Start and n Sub Range End. The function block changes the DTR0 and the DTR1 of all connected DALI control devices. While the function block is active (b Busy = TRUE), all function blocks that also have write access to the DTRs of the connected DALI control devices on the same DALI line are blocked. The function block cannot be used when using the KL6811. 52 Version: 1.20.0 TE1000
## Page 53

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Options : DWORD; b Cancel : BOOL; n Memory Bank : BYTE; n Sub Range Start : BYTE(0..254) := 2; n Sub Range End : BYTE := 255; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Options DWORD Reserved for future extensions. b Cancel BOOL A rising edge at this input disables the function block and aborts the reading of the variables. n Memory Bank BYTE Specifies the memory bank for the read access. n Sub Range Start BYTE Offset inside the memory bank from which reading is to take place. n Sub Range End BYTE Offset inside the memory bank up to which reading is to take place. n Sub Range End Description 255 Offset 0 of the memory bank determines the offset up to which reading is to take place. 254 Offset 0 is not read at the beginning. Reading always takes place up to Offset 254. <= 253 n Sub Range End may not be greater than the value in Offset 0. The partial areas of the memory bank are read with this setting. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Current Offset : BYTE; n Last Offset : BYTE; a Values : ARRAY [0..254] OF BYTE; a Errors : ARRAY [0..254] OF BOOL; END_VAR TE1000 Version: 1.20.0 53
## Page 54

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Current Offset BYTE The offset that is currently being read is output at this output. n Last Offset BYTE Last valid offset of the memory bank that was read. a Values BYTE Array containing the read parameters of the memory bank. a Errors BOOL Array containing errors of the parameters of the memory bank that occurred during reading. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2 Commands 4.1.2.1 Part 102 (control gears) 4.1.2.1.1 Application extended commands 4.1.2.1.1.1 FB_DALI102Query Extended Version Number The function block reads the version number for the implemented, application extended commands from the DALI control gear. This command belongs to the application extended commands. 54 Version: 1.20.0 TE1000
## Page 55

Programming Since each DALI control gear can support several device types, the DALI command ENABLE DEVICE TYPE must be called before each application-related extension command. Application extended commands are defined in the IEC 62386-2xx standard. The function block FB_DALI102Query Extended Version Number independently executes the DALI command ENABLE DEVICE TYPE internally. The input variable e Device Type specifies for which device type the version number is to be read out The output n Extended Version Number contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Device Type : E_DALIDevice Type; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Device Type E_DALIDevice Type Identification of the device type (see E_DALIDevice Type [} 907]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Extended Version Number : BYTE; END_VAR TE1000 Version: 1.20.0 55
## Page 56

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Extended Version N BYTE Version number of the selected device type within the DALI umber control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.1.2 Configuration commands 4.1.2.1.2.1 FB_DALI102Add To Group The function block adds the DALI control gear to the n Group group. Internally, the group assignment is stored in the variable gear Groups [} 159]. The function block sends the DALI command ADD TO GROUP twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Group : BYTE; END_VAR 56 Version: 1.20.0 TE1000
## Page 57

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Group BYTE Group number (0…15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 57
## Page 58

Programming 4.1.2.1.2.2 FB_DALI102Identify Device The function block starts the identification routine for the DALI control gear. It takes approx. 10 seconds and ends automatically. The exact scope of the identification routine depends on the manufacturer of the DALI control gear. The function block sends the DALI command IDENTIFY DEVICE twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 58 Version: 1.20.0 TE1000
## Page 59

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.3 FB_DALI102Remove From Group The function block removes the DALI control gear from the group n Group. Internally, the group membership is stored in the variable gear Groups [} 159]. Each bit of gear Groups represents a group. Bit 0 corresponds to group 0 etc., up to bit 15 in group 15. If a bit is set, the DALI control gear belongs to the corresponding group. The function block sends the DALI command REMOVE FROM GROUP twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Group : BYTE; END_VAR TE1000 Version: 1.20.0 59
## Page 60

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Group BYTE Group number (0…15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 60 Version: 1.20.0 TE1000
## Page 61

Programming 4.1.2.1.2.4 FB_DALI102Remove From Scene The function block removes the DALI control gear from the scene n Scene. Internally, the scenes are stored in the variables scene0 to scene15 (see scene0…scene15 [} 159]) . The function block sends the DALI command REMOVE FROM SCENE twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Scene : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Scene BYTE Scene number (0…15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 61
## Page 62

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.5 FB_DALI102Reset The function block resets all variables of the DALI control gear to their reset values. Control gears can take up to 300 ms to execute the DALI command. Only then are further DALI commands executed by the respective DALI control gear. The function block sends the DALI command RESET twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 62 Version: 1.20.0 TE1000
## Page 63

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 63
## Page 64

Programming 4.1.2.1.2.6 FB_DALI102Reset Memory Bank The values of the selected memory bank of the DALI control gear are set to their respective default values by the function block (see Memory banks [} 16]). During the reset, the DALI control gear does not react to other commands. The function block also resets the values that are write-protected by the lock byte. The DALI commands ENABLE WRITE MEMORY, WRITE MEMORY LOCATION – NO REPLY and RESET MEMORY BANK are called internally. The function block changes the DTR0 and the DTR1 of all connected DALI control gears. The function block sends the DALI command RESET MEMORY BANK twice, as foreseen by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE := 2; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description Memory Bank BYTE Specification of the memory bank. If a 0 is specified, all memory banks are reset (except for memory bank 0, as this is read-only). For all other values, only the respective memory bank is reset. 64 Version: 1.20.0 TE1000
## Page 65

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.1.2.7 FB_DALI102Save Persistent Variables The function block immediately triggers the saving of variables in the persistent memory by the DALI command SAVE PRESISTENT VARIABLES. DALI control gears do not save the variables directly in the persistent memory. Instead, the values are copied to the persistent memory in the background. Since this happens over a longer period of time (a few seconds), the values can be lost if the DALI bus is disconnected. The SAVE PRESISTENT VARIABLES DALI command triggers immediate copying to the persistent memory. In most cases, no communication with the DALI device can take place during copying (up to 350 ms). The function block sends the DALI command SAVE PRESISTENT VARIABLES twice, as required by the DALI standard for certain DALI commands. TE1000 Version: 1.20.0 65
## Page 66

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 66 Version: 1.20.0 TE1000
## Page 67

Programming 4.1.2.1.2.8 FB_DALI102Set Extended Fade Time This function block writes the values e Extended Fade Time Base and e Extended Fade Time Multiplier to the variables extended Fade Time Base [} 157] and extended Fade Time Multiplier [} 157]. The Extended Fade Time is calculated from the product of the two variables extended Fade Time Base and extended Fade Time Multiplier. The value can be set between 100 ms and 16 min. With a value of 0 s, the lighting output reaches the required value as quickly as possible. The extended Fade Time is used in the function blocks FB_DALI102Direct Arc Power Control [} 82], FB_DALI102Go To Scene [} 87] and FB_DALI102Go To Last Active Level [} 85]. The two variables extended Fade Time Base and extended Fade Time Multiplier are used for the calculation only if fade Time [} 156] was set to E_DALIFade Time. Disabled and, if implemented, fast Fade Time [} 335] is equal to E_DALIFast Fade Time. Disabled. The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET EXTENDED FADE TIME twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Extended Fade Time Base : E_DALIExtended Fade Time Base := E_DALIExtended Fade Time Base. Base01; e Extended Fade Time Multiplier : E_DALIExtended Fade Time Multiplier := E_DALIExtended Fade Time Multiplier . No Fade; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 67
## Page 68

Programming Name Type Description e Extended Fade Time E_DALIExtended Fade Time Basis for calculating the Extended Fade Time. Base Base [} 909] e Extended Fade Time E_DALIExtended Fade Time Time multiplier for calculating Extended Fade Time. Multiplier Multiplier [} 909] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.1.2.1.2.9 FB_DALI102Set Fade Rate The function block sets the fade Rate [} 155] to the value e Fade Rate. The fade Rate determines the rate of change, in steps per second, of the output value. The fade Rate is used in the function blocks FB_DALI102Down [} 84] and FB_DALI102Up [} 97]. 68 Version: 1.20.0 TE1000
## Page 69

Programming The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET FADE RATE twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Fade Rate : E_DALIFade Rate := E_DALIFade Rate. N045Steps Per Sec; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Fade Rate E_DALIFade Rate Fade rate for the change of the output value (see E_DALIFade Rate [} 910]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 69
## Page 70

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.0 Tc3_DALI from v3.1.5.0 4.1.2.1.2.10 FB_DALI102Set Fade Time The function block sets the fade Time [} 156] to the value e Fade Time. The fade Time defines the time the current output value takes to reach the required value. The fade Time is used in the function blocks FB_DALI102Direct Arc Power Control [} 82], FB_DALI102Go To Scene [} 87] and FB_DALI102Go To Last Active Level [} 85]. The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET FADE TIME twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Fade Time : E_DALIFade Time := E_DALIFade Time. Disabled; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] 70 Version: 1.20.0 TE1000
## Page 71

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Fade Time E_DALIFade Time Fade time for the change of the output value (see E_DALIFade Time [} 910]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.0 Tc3_DALI from v3.1.5.0 4.1.2.1.2.11 FB_DALI102Set Max Level The function block stores the value n Max Level in the variable max Level [} 155] of the DALI control gear. If a value smaller than min Level is specified, the value is set to min Level. If the value 255 (MASK) is specified, max Level is automatically set to 254. TE1000 Version: 1.20.0 71
## Page 72

Programming The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET MAX LEVEL twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Max Level : BYTE := 254; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Max Level BYTE Maximum allowed output value (min Level...254). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 72 Version: 1.20.0 TE1000
## Page 73

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.12 FB_DALI102Set Min Level The function block stores the value n Min Level in the variable min Level [} 155] of the DALI control gear. If a value greater than max Level or 255 (MASK) is specified, the value is set to max Level . If a value smaller than physical Minimum is specified, the value is set to physical Minimum. The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET MIN LEVEL twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Min Level : BYTE := 128; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 73
## Page 74

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Min Level BYTE Minimum allowed output value (physical Minimum… max Level). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.13 FB_DALI102Set Power On Level The function block stores the value n Power On Level in the variable power On Level [} 155] of the DALI control gear. 74 Version: 1.20.0 TE1000
## Page 75

Programming The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET POWER ON LEVEL twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Power On Level : BYTE := 254; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Power On Level BYTE Switch-on value (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 75
## Page 76

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.14 FB_DALI102Set Scene The function block stores the value n Scene Level in the specified scene n Scene of the DALI control gear. If the value is greater than max Level and less than 255 (MASK), the value max Level is output when the scene is called. If a value less than min Level is specified, the value min Level is output when the scene is called. Internally, the scenes are stored in the variables scene0 to scene15 (see scene0…scene15 [} 159]). The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET SCENE twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Scene Level : BYTE := 255; n Scene : BYTE := 0; END_VAR 76 Version: 1.20.0 TE1000
## Page 77

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Scene Level BYTE Output value of the desired scene (0…255). n Scene BYTE Scene whose output value is to be changed (0…15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 77
## Page 78

Programming 4.1.2.1.2.15 FB_DALI102Set Short Address The function block stores the new short address n New Short Address in the short Address [} 158] variable of the DALI control gear. The existing short address in the DALI control gear is deleted if a value of 255 is entered at the input. To address a device without a known short address, the command must be sent as a broadcast (e Address Type = E_DALIAddress Type. Broadcast). This gives all DALI control gears connected to the DALI terminal the short address n New Short Address. Alternatively, the function block can be called with Broadcast unaddressed (e Address Type = E_DALIAddress Type. Broadcast Unaddr). In this case, only the DALI devices that do not yet have a short address are assigned a short address. The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET SHORT ADDRESS twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n New Short Address : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n New Short Address BYTE New short address (0…63, 255). 78 Version: 1.20.0 TE1000
## Page 79

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.16 FB_DALI102Set System Failure Level The function block stores the value n System Failure Level in the variable system Failure Level [} 155] of the DALI control gear. The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command SET SYSTEM FAILURE LEVEL twice, as required by the DALI standard for certain DALI commands. TE1000 Version: 1.20.0 79
## Page 80

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n System Failure Level : BYTE := 254; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n System Failure Leve BYTE Output value in the case of a system failure (0…255). l Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 80 Version: 1.20.0 TE1000
## Page 81

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.2.17 FB_DALI102Store Actual Level In DTR0 The function block writes the current output value of the DALI control gear to DTR0 [} 159]. The function block sends the DALI command STORE ACTUAL LEVEL IN DTR0 twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 81
## Page 82

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3 Control commands 4.1.2.1.3.1 FB_DALI102Direct Arc Power Control The function block switches the DALI control gear to the default output value n Arc Power Level. If n Arc Power Level is outside the specified variable max Level [} 155] or min Level [} 155] of the DALI control gear, it is set to the corresponding lowest or highest value. The DALI control gear is switched on by the command if it was previously off. If the value n Arc Power Level = 0, the DALI control gear is switched off and if n Arc Power Level = 255 (MASK), the DALI control gear retains its current value. The speed at which the specified value is to be reached is specified by the variable fade Time [} 156] . Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Arc Power Level : BYTE; END_VAR 82 Version: 1.20.0 TE1000
## Page 83

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Arc Power Level BYTE Output value for the DALI control gear (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 83
## Page 84

Programming 4.1.2.1.3.2 FB_DALI102Down The output value of the DALI control gear is reduced over the specified period of 200 ms. The variable fade Rate [} 155] determines the number of steps by which the output value is changed within the 200 ms. If the current output value is already at the min Level [} 155] value, the output value remains unchanged. This command does not switch off the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 84 Version: 1.20.0 TE1000
## Page 85

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.3 FB_DALI102Go To Last Active Level If the output value of the DALI control gear is 0, it is set to the last active output value (min Level...max Level) that was used before switching off. This function block is used to reset DALI control gears that have been switched off to their last output value (switched on). If the output value of the DALI control gear is greater than 0, the output value remains unchanged. Directly after applying the supply voltage to the DALI control gear, this function block sets the output value to max Level. The variable fade Time [} 156] defines the speed at which the last active output value is to be reached. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 85
## Page 86

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 86 Version: 1.20.0 TE1000
## Page 87

Programming 4.1.2.1.3.4 FB_DALI102Go To Scene The output value of the DALI control gear is set to the value stored in n Scene. The variable fade Time [} 156] determines the speed at which the specified value of the scene is to be reached. If the value of the selected scene in the DALI control gear is 255, the output of the DALI control gear retains its current value. If the DALI control gear is switched off and the value stored in n Scene is greater than 0 and less than 255, the DALI control gear is switched on with this command. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Scene : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Scene BYTE Scene to be called in the DALI control gear (0...15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 87
## Page 88

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.5 FB_DALI102Off The DALI control gear is switched off immediately. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] 88 Version: 1.20.0 TE1000
## Page 89

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.6 FB_DALI102On And Step Up The output value of the DALI control gear is increased by one step. If the DALI control gear is off, the command switches it on, and the output value is set to the stored value min Level [} 155]. If the output value has already reached the max Level [} 155] value, it retains its current value. TE1000 Version: 1.20.0 89
## Page 90

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 90 Version: 1.20.0 TE1000
## Page 91

Programming 4.1.2.1.3.7 FB_DALI102Recall Max Level The output value of the DALI control gear is set to max Level [} 155]. If the DALI control gear is switched off, this command switches it on. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 91
## Page 92

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.8 FB_DALI102Recall Min Level The output value of the DALI control gear is set to min Level [} 155] value. If the DALI control gear is switched off, this command switches it on. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 92 Version: 1.20.0 TE1000
## Page 93

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.9 FB_DALI102Step Down The output value of the DALI control gear is reduced by one step. If the output of the DALI control gear is already at the min Level [} 155] value, the value is not reduced further. The command does not switch off the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 93
## Page 94

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 94 Version: 1.20.0 TE1000
## Page 95

Programming 4.1.2.1.3.10 FB_DALI102Step Down And Off The output value of the DALI control gear is reduced by one step. If the output of the DALI control gear is already at the min Level [} 155] value, it is switched off. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 95
## Page 96

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.11 FB_DALI102Step Up The output value of the DALI control gear is increased by one step. If the output value of the DALI control gear is already at the max Level [} 155] value, the value remains unchanged. The command does not switch on the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 96 Version: 1.20.0 TE1000
## Page 97

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.3.12 FB_DALI102Up The output value of the DALI control gear is increased over the specified period of 200 ms. The variable fade Rate [} 155] determines the number of steps by which the output value is changed within the 200 ms. If the current output value is already at the max Level [} 155] value, the output value remains unchanged. This command does not switch on the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 97
## Page 98

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 98 Version: 1.20.0 TE1000
## Page 99

Programming 4.1.2.1.4 Query commands 4.1.2.1.4.1 FB_DALI102Query Actual Level The function block reads the current output value of the DALI control gear (see actual Level [} 155]). The current output value is 0 or lies within the value range from min Level [} 155] to max Level [} 155]. If the value 255 (MASK) is returned by the DALI control gear, b Error is set to TRUE. In this case the DALI control gear is in the start-up phase or there is a technical defect. The output n Actual Value contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Actual Level : BYTE; END_VAR TE1000 Version: 1.20.0 99
## Page 100

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Actual Level BYTE Current output value (0, min Level…max Level). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.2 FB_DALI102Query Content DTR0 The function block reads the contents of DTR0 [} 159] (Data Transfer Register 0) from the DALI control gear. The output n Content DTR0 contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 100 Version: 1.20.0 TE1000
## Page 101

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Content DTR0 : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Content DTR0 BYTE Content of the DTR0 (Data Transfer Register 0) (0…255). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 101
## Page 102

Programming 4.1.2.1.4.3 FB_DALI102Query Content DTR1 The function block reads the contents of DTR1 [} 159] (Data Transfer Register 1) from the DALI control gear. The output n Content DTR1 contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Content DTR1 : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Content DTR1 BYTE Content of the DTR1 (Data Transfer Register 1) (0…255). 102 Version: 1.20.0 TE1000
## Page 103

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.4 FB_DALI102Query Content DTR2 The function block reads the contents of DTR2 [} 159] (Data Transfer Register 2) from the DALI control gear. The output n Content DTR2 contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Content DTR2 : BYTE; END_VAR TE1000 Version: 1.20.0 103
## Page 104

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Content DTR2 BYTE Content of the DTR2 (Data Transfer Register 1) (0…255). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.5 FB_DALI102Query Control Gear Failure The function block checks whether there is a defect in one or more DALI control gears. This function block can be used to determine whether there are defective DALI control gears on a DALI line. For this purpose, the function block is called with the parameter e Address Type = E_DALIAddress Type. Broadcast. If the outputs b Control Gear Failure = FALSE and b Error = FALSE, there is no defect in any DALI control gear. If the output b Control Gear Failure = TRUE and b Error = FALSE, a DALI control gear is defective. If multiple DALI control gears are defective, a 27 (multiple DALI control gears have responded) is returned to ip Result Message.n Event Id. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 104 Version: 1.20.0 TE1000
## Page 105

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear Failure : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Control Gear Failure BOOL The output is set as soon as a defect has been detected in the queried DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 TE1000 Version: 1.20.0 105
## Page 106

Programming 4.1.2.1.4.6 FB_DALI102Query Control Gear Present The function block indicates whether the required DALI control gear can be reached via its short address. The output b Control Gear Present contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear Present : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Control Gear Pesent BOOL The output is set as soon as the queried DALI control gear is available. 106 Version: 1.20.0 TE1000
## Page 107

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.7 FB_DALI102Query Device Types The function block returns a list of all device types supported by the DALI control gear. The DALI commands QUERY DEVICE TYPE and QUERY NEXT DEVICE TYPE are called internally. As long as the function block is active (b Busy = TRUE), no further DALI commands may be sent. Otherwise, the list of supported device types may not be read completely. The output a Device Types contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 107
## Page 108

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; a Device Types : ARRAY [1..20] OF E_DALIDevice Type; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. a Device Types ARRAY OF List of supported device types. E_DALIDevice Type [} 907] Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.1.4.8 FB_DALI102Query Extended Fade Time This function block reads the variables extended Fade Time Base [} 157] and extended Fade Time Multiplier [} 157] from the DALI control gear. The Extended Fade Time (100 ms to 16 min) can be calculated from the product of the two variables. The extended Fade Time is used in the function blocks FB_DALI102Direct Arc Power Control [} 82], FB_DALI102Go To Scene [} 87] and FB_DALI102Go To Last Active Level [} 85]. The two variables extended Fade Time Base and extended Fade Time Multiplier are used for the calculation only if fade Time [} 156] was set to E_DALIFade Time. Disabled and, if implemented, fast Fade Time [} 335] is equal to E_DALIFast Fade Time. Disabled. 108 Version: 1.20.0 TE1000
## Page 109

Programming The outputs e Extended Fade Time Base and e Extended Fade Time Multiplier only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Extended Fade Time Base : E_DALIExtended Fade Time Base; e Extended Fade Time Multiplier : E_DALIExtended Fade Time Multiplier; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Extended Fade Time E_DALIExtended Fade Time Basis for calculating the Extended Fade Time Base Base [} 909] e Extended Fade Time E_DALIExtended Fade Time Time multiplier for calculating the Extended Fade Time Multiplier Multiplier [} 909] TE1000 Version: 1.20.0 109
## Page 110

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.1.2.1.4.9 FB_DALI102Query Fade Time Fade Rate The function block reads the variables fade Time [} 156] and fade Rate [} 155] from the DALI control gear. The fade Time is used in the function blocks FB_DALI102Direct Arc Power Control [} 82], FB_DALI102Go To Scene [} 87] and FB_DALI102Go To Last Active Level [} 85], while fade Rate is used with FB_DALI102Up [} 97] and FB_DALI102Down [} 84]. The outputs e Fade Time and e Fade Rate only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 110 Version: 1.20.0 TE1000
## Page 111

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Fade Time : E_DALIFade Time; e Fade Rate : E_DALIFade Rate; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Fade Time E_DALIFade Time Fade time for the change of the output value (see E_DALIFade Time [} 910]) e Fade Rate E_DALIFade Rate Fade rate for the change of the output value (see E_DALIFade Rate [} 910]) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.0 Tc3_DALI from v3.1.5.0 4.1.2.1.4.10 FB_DALI102Query Groups The function block reads the variable gear Groups [} 159] from the DALI control gear. Each bit represents one group. Bit 0 (group 0) to bit 15 (group 15). If the bit is set, the DALI control gear belongs to the corresponding group. The DALI commands QUERY GROUPS 0-7 and QUERY GROUPS 8-15 are called internally. The output n Groups contains a valid value only if the function block was executed without errors (b Error = FALSE). TE1000 Version: 1.20.0 111
## Page 112

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Groups : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Groups WORD Group assignment Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 112 Version: 1.20.0 TE1000
## Page 113

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.11 FB_DALI102Query Light Source Types The function block returns a list of all light source types supported by the DALI control gear. Internally the DALI commands QUERY LIGHT SOURCE TYPE, QUERY CONTENT DTR0, QUERY CONTENT DTR1 and QUERY CONTENT DTR2 are called. The output a Light Source Types contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; a Light Source Types : ARRAY [1..3] OF E_DALILight Source Type; END_VAR TE1000 Version: 1.20.0 113
## Page 114

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. a Light Source Types ARRAY OF List of supported light source types. E_DALILight Source Type [} 912] Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.1.2.1.4.12 FB_DALI102Query Lamp Failure The function block checks whether there is a defect in the lamp of a DALI control gear. This function block can be used to determine whether there are DALI control gears with defective lamps on a DALI line. For this purpose, the function block is called with the parameter e Address Type = E_DALIAddress Type. Broadcast. If the outputs b Lamp Failure = FALSE and b Error = FALSE, no defective lamp was detected on any DALI control gear. If the output b Lamp Failure = TRUE and b Error = FALSE, the lamp is defective in a DALI control gear. If the lamps are defective at several DALI control gears, a 27 (several DALI control gears have responded) is returned to ip Result Message.n Event Id. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 114 Version: 1.20.0 TE1000
## Page 115

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Lamp Failure : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Lamp Failure BOOL The output is set as soon as a defective lamp has been detected at the queried DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 TE1000 Version: 1.20.0 115
## Page 116

Programming 4.1.2.1.4.13 FB_DALI102Query Max Level The function block reads the variable max Level [} 155] from the DALI control gear. The output n Max Level contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Max Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Max Level BYTE Maximum allowed output value (min Level...254). 116 Version: 1.20.0 TE1000
## Page 117

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.14 FB_DALI102Query Min Level The function block reads the variable min Level [} 155] from the DALI control gear. The output n Min Level contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Min Level : BYTE; END_VAR TE1000 Version: 1.20.0 117
## Page 118

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Min Level BYTE Minimum allowed output value (physical Minimum… max Level). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.15 FB_DALI102Query Missing Short Address The function block checks whether one or more DALI control gears do not have a short address. This function block can be used to determine whether there are DALI control gears without short address on a DALI line (e.g. new DALI control gears). For this purpose, the function block is called with the parameter e Address Type = E_DALIAddress Type. Broadcast. If the outputs b Missing Short Address = FALSE and b Error = FALSE, all DALI control gears have a short address. If the output b Missing Short Address = TRUE and b Error = FALSE, there is one DALI control gear that has no short address. If multiple DALI control gears do not have a short address, a 27 (multiple DALI control gears have responded) is returned to ip Result Message.n Event Id. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 118 Version: 1.20.0 TE1000
## Page 119

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Missing Short Address : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Missing Short Addre BOOL The output is set as soon as the queried DALI control gear ss does not have a short address. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 TE1000 Version: 1.20.0 119
## Page 120

Programming 4.1.2.1.4.16 FB_DALI102Query Physical Minimum The function block reads the variable physical Minimum [} 159] from the DALI control gear. The value is read-only and is fixed by the manufacturer. The output n Physical Minimum contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Physical Minimum : BYTE; END_VAR 120 Version: 1.20.0 TE1000
## Page 121

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Physical Minimum BYTE Physically smallest possible output value (1...254). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.17 FB_DALI102Query Power On Level The function block reads the variable power On Level [} 155] from the DALI control gear. The output n Power On Level only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 121
## Page 122

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Power On Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Power On Level BYTE Switch-on value (0…255). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 122 Version: 1.20.0 TE1000
## Page 123

Programming 4.1.2.1.4.18 FB_DALI102Query Random Address The function block reads the variable random Address [} 158] from the DALI control gear. The DALI commands QUERY RANDOM ADDRESS (H), QUERY RANDOM ADDRESS (M) and QUERY RANDOM ADDRESS (L) are called internally. The output n Random Address contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Random Address : UDINT; END_VAR TE1000 Version: 1.20.0 123
## Page 124

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Random Address UDINT Random address (16#00_00_00…16#FF_FF_FE). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.19 FB_DALI102Query Scene Level The function block reads the output value from the DALI control gear for the specified scene n Scene. Internally, the scenes are stored in the variables scene0 to scene15 (see scene0…scene15 [} 159]). The output n Scene Level contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Scene : BYTE := 0; END_VAR 124 Version: 1.20.0 TE1000
## Page 125

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Scene BYTE Scene whose output value is to be read (0…15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Scene Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Scene Level BYTE Output value of the desired scene (0…255) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 125
## Page 126

Programming 4.1.2.1.4.20 FB_DALI102Query Status The function block reads the status of the DALI control gear. The status contains the eight most important status messages of a DALI control gear. The meaning of the bits is defined as follows: Bit Description 0 Fault of the DALI control gear (see control Gear Failure [} 158]) 1 Lamp failure (see lamp Failure [} 158]) 2 Lamp power ON (see lamp On [} 158]) 3 Limit value error (see limit Error [} 158]) 4 Dimming is active (see fade Running [} 158]) 5 Reset state (see reset State [} 159]) 6 Short address missing (variable short Address [} 158] is 255 (MASK)) 7 The power supply was enabled (see power Cycle Seen [} 159]) The output n Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Status : BYTE; END_VAR 126 Version: 1.20.0 TE1000
## Page 127

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Status BYTE Status information (see table above). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.4.21 FB_DALI102Query System Failure Level The function block reads the variable system Failure Level [} 155] from the DALI control gear. The output n System Failure Level only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 127
## Page 128

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n System Failure Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n System Failure Leve BYTE Output value in the case of a system failure (0…255). l Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 128 Version: 1.20.0 TE1000
## Page 129

Programming 4.1.2.1.4.22 FB_DALI102Read Memory Location One byte is read from the memory bank of the DALI control gear. The memory bank is specified by the parameter n Memory Bank and the address within the memory bank by the parameter n Offset. The function block changes the DTR0 and the DTR1 of all connected DALI control gears. The output n Value contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE; n Offset : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Memory Bank BYTE Specifies the memory bank for the read access (DTR1). n Offset BYTE Address from which a value within the memory bank is to be read (DTR0). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Value : BYTE; END_VAR TE1000 Version: 1.20.0 129
## Page 130

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Value BYTE Value read from the memory bank. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.1.2.1.5 Special commands 4.1.2.1.5.1 FB_DALI102Enable Device Type The function block must be called before an application extended command is called. This means that only the DALI control gears belonging to the corresponding device type respond. It is not necessary to use the function block for device type 0. It is also not required if a function block is called that represents an application extended command in the Tc3_DALI library. The DALI command ENABLE DEVICE TYPE is already executed internally in the corresponding function blocks. There is a corresponding note in the description of the respective function blocks. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Device Type : E_DALIDevice Type; END_VAR 130 Version: 1.20.0 TE1000
## Page 131

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Device Type E_DALIDevice Type Selection of the desired device type (see E_DALIDevice Type [} 907]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.1.5.2 FB_DALI102Initialise TE1000 Version: 1.20.0 131
## Page 132

Programming The function block prepares the addressing of the DALI control gears. This function block is required if addressing of the DALI control gears is to be implemented in the PLC. The function block FB_DALI102Addressing [} 21] can be used to assign the addresses from the PLC. n Parameter is used to define which DALI control gears are taken into account for addressing: Value (binary) Description 2#0000_0000 All DALI control gears respond. 2#0AAA_AAA1 DALI control gears with the address 2#00AA_AAAA respond. 2#1111_1111 DALI control gears without a short address respond. The function block sends the DALI command INITIALIZE twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Parameter : BYTE := 2#1111_1111; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Parameter BYTE Specifies which control gears should react to this command (see table above) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 132 Version: 1.20.0 TE1000
## Page 133

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.3 FB_DALI102Program Short Address The function block stores the value n Short Address as a short address in the variable short Address [} 158] for all selected DALI control gears. DALI control gears are selected if the random Address of the DALI control gear is the same as the search Address and the DALI command INITIALIZE (see FB_DALI102Initialise [} 131]) was executed previously. This function block is required if addressing of the DALI control gears is to be implemented in the PLC. The function block FB_DALI102Addressing [} 21] can be used to assign the addresses from the PLC. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Short Address : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Short Address BYTE Short address to be assigned (0…63, 255) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 133
## Page 134

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.4 FB_DALI102Query Short Address The function block reads the short address (short Address [} 158]) of the selected DALI control gear. DALI control gears are selected if the random Address [} 158] of the DALI control gear is the same as the search Address [} 158] and the DALI command INITIALIZE (see FB_DALI102Initialise [} 131]) was executed previously. The output n Short Address contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). 134 Version: 1.20.0 TE1000
## Page 135

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Short Address : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Short Address BYTE The output returns the short address (0…63, 255) from the selected DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.1.2.1.5.5 FB_DALI102Randomise The function block generates a new random address for all selected DALI control gears and writes it to the random Address [} 158] variable. DALI control gears are selected if the DALI command INITIALIZE (see FB_DALI102Initialise [} 131]) was executed previously. This function block is required if addressing of the DALI control gears is to be implemented in the PLC. The function block FB_DALI102Addressing [} 21] can be used to assign the addresses from the PLC. TE1000 Version: 1.20.0 135
## Page 136

Programming The function block sends the DALI command RANDOMIZE twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 136 Version: 1.20.0 TE1000
## Page 137

Programming 4.1.2.1.5.6 FB_DALI102Set DTR0 The function block writes to the DTR0 [} 159] (Data Transfer Register 0) of all DALI control gears. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n DTR0 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n DTR0 BYTE Value to be written to the DTR0 (Data Transfer Register 0) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 137
## Page 138

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.7 FB_DALI102Set DTR1 The function block writes to the DTR1 [} 159] (Data Transfer Register 1) of all DALI control gears. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n DTR1 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n DTR1 BYTE Value to be written to the DTR1 (Data Transfer Register 1) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 138 Version: 1.20.0 TE1000
## Page 139

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.8 FB_DALI102Set DTR2 The function block writes to the DTR2 [} 159] (Data Transfer Register 2) of all DALI control gears. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n DTR2 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 139
## Page 140

Programming Name Type Description n DTR2 BYTE Value to be written to the DTR2 (Data Transfer Register 2) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.9 FB_DALI102Set Search Address The function block stores the value n Search Address in the search Address [} 158] variable for all selected DALI control gears. DALI control gears are selected if the DALI command INITIALIZE (see FB_DALI102Initialise [} 131]) was executed previously. The DALI commands SEARCHADDRH, SEARCHADDRM and SEARCHADDRL are called internally. This function block is required if addressing of the DALI control gears is to be implemented in the PLC. The function block FB_DALI102Addressing [} 21] can be used to assign the addresses from the PLC. 140 Version: 1.20.0 TE1000
## Page 141

Programming Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Search Address : UDINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Search Address UDINT The value to be written to the search Address variable (16#00_00_00…16#FF_FF_FF). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 141
## Page 142

Programming 4.1.2.1.5.10 FB_DALI102Terminate The function block terminates addressing for all DALI control gears. The selection of the DALI control gears to be addressed by the FB_DALI102Initialise [} 131] function block is also canceled. This function block is required if addressing of the DALI control gears is to be implemented in the PLC. The function block FB_DALI102Addressing [} 21] can be used to assign the addresses from the PLC. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 142 Version: 1.20.0 TE1000
## Page 143

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.11 FB_DALI102Verify Short Address The function block checks whether the variable short Address [} 158] matches the value n Short Address for all selected DALI control gears. DALI control gears are selected if the random Address [} 158] of the DALI control gear is the same as the search Address [} 158] and the DALI command INITIALIZE (see FB_DALI102Initialise [} 131]) was executed previously. This function block is required if addressing of the DALI control gears is to be implemented in the PLC. The function block FB_DALI102Addressing [} 21] can be used to assign the addresses from the PLC. The output b Answer only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Short Address : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent (see E_DALICommand Priority [} 906]). e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Short Address BYTE Short address with which the own short address is compared TE1000 Version: 1.20.0 143
## Page 144

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Answer : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Answer BOOL Is TRUE if n Short Address is equal to its own short address. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.1.5.12 FB_DALI102Write Memory Location The value n Value is written in the memory bank of the DALI control gear. The corresponding memory bank is specified by the input variable n Memory Bank, the address within the memory bank by the input variable n Offset. The DALI commands ENABLE WRITE MEMORY and WRITE MEMORY LOCATION are called internally. In contrast to the function block FB_DALI102Write Memory Location No Reply [} 146], the function block FB_DALI102Write Memory Location checks that writing to the memory bank is correct. 144 Version: 1.20.0 TE1000
## Page 145

Programming The function block changes the DTR0 and the DTR1 of all connected DALI control gears. The function block sends the DALI command ENABLE WRITE MEMORY twice, as foreseen by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE := 0; n Offset : BYTE := 0; n Value : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Memory Bank BYTE Specifies the memory bank for the write access. n Offset BYTE Address within the memory bank selected with the variable n Memory Bank. n Value BYTE Value to be written to the address within the memory bank. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 145
## Page 146

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.1.5.13 FB_DALI102Write Memory Location No Reply The value n Value is written in the memory bank of the DALI control gear. The corresponding memory bank is specified by the input variable n Memory Bank, the address within the memory bank by the input variable n Offset. The DALI commands ENABLE WRITE MEMORY and WRITE MEMORY LOCATION – NO REPLY are called internally. In contrast to the function block FB_DALI102Write Memory Location [} 144], the function block FB_DALI102Write Memory Location No Reply does not check that writing to the memory bank is correct. The function block changes the DTR0 and the DTR1 of all connected DALI control gears. The function block sends the DALI command ENABLE WRITE MEMORY twice, as foreseen by the DALI standard for certain DALI commands. 146 Version: 1.20.0 TE1000
## Page 147

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE := 0; n Offset : BYTE := 0; n Value : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Memory Bank BYTE Specifies the memory bank for the write access. n Offset BYTE Address within the memory bank selected with the variable n Memory Bank. n Value BYTE Value to be written to the address within the memory bank. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 147
## Page 148

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.0 Tc3_DALI from v3.1.5.0 4.1.2.1.6 FB_DALI102Send Command The FB_DALI102Send Command function block sends the specified DALI command to the DALI control gear. An additional parameter can be transferred for certain DALI commands via the n Parameter input. The exact meaning of the parameter is defined in the DALI standard. These DALI commands are identified in the n Parameter column in the table below. The return value for the query commands is output at the n Response output. The exact meaning of the parameter is defined in the DALI standard. These DALI commands are identified in the n Response column in the table below. Some DALI commands are sent twice, as required by the DALI standard for certain DALI commands. These DALI commands are identified in the send twice column in the table below. If several instances of FB_DALI102Send Command send DALI commands via the same DALI terminal, the DALI commands of the individual instances are not synchronized with each other. This can lead to undesirable behavior, for example, if parameters in DALI control gears are changed. In most cases, several DALI commands must be sent to change a parameter. Among other things, the DALI command must also be used to set the DTR. As the DALI command for setting the DTR is always sent as a broadcast command, this has an effect on all DALI control gears in a DALI line. If several instances of FB_DALI102Send Command change the parameters of DALI control gears on a DALI line at the same time, this can lead to undesirable side effects. This means that only one instance of FB_DALI102Send Command should be created per DALI line. The DALI commands must then be synchronized in the application that accesses FB_DALI102Send Command. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Command : INT; n Parameter : USINT; END_VAR 148 Version: 1.20.0 TE1000
## Page 149

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Command INT DALI command to be sent. Possible DALI commands are listed in the table below. n Parameter USINT Additional parameter of a DALI command. Commands with additional parameters are listed in the table below. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Response : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Response BYTE Return value of the query command. The table below shows the commands with potential return values. TE1000 Version: 1.20.0 149
## Page 150

Programming Commands 150 Version: 1.20.0 TE1000
## Page 151

Programming n Command DALI command n Parameter n Response Send twice -1 DAPC + - - 0 OFF - - - 1 UP - - - 2 DOWN - - - 3 STEP UP - - - 4 STEP DOWN - - - 5 RECALL MAX - - - LEVEL 6 RECALL MIN - - - LEVEL 7 STEP DOWN AND - - - OFF 8 ON AND STEP UP - - - 9 ENABLE DAPC - - - SEQUENCE 10 GO TO LAST - - - ACTIVE LEVEL 11 CONTINUOUS UP - - - 12 CONTINUOUS - - - DOWN 16…31 GO TO SCENE - - - 32 RESET - - + 33 STORE ACTUAL - - + LEVEL IN DTR0 35 SET OPERATING - - + MODE 36 RESET MEMORY - - + BANK 37 IDENTIFY DEVICE - - + 42 SET MAX LEVEL - - + 43 SET MIN LEVEL - - + 44 SET SYSTEM - - + FAILURE LEVEL 45 SET POWER ON - - + LEVEL 46 SET FADE TIME - - + 47 SET FADE RATE - - + 48 SET EXTENDED - - + FADE TIME 64…79 SET SCENE - - + 80…95 REMOVE FROM - - + SCENE 96…111 ADD TO GROUP - - + 112…127 REMOVE FROM - - + GROUP 128 SET SHORT - - + ADDRESS 129 ENABLE WRITE - - + MEMORY 144 QUERY STATUS - + - 145 QUERY CONTROL - + - GEAR PRESENT TE1000 Version: 1.20.0 151
## Page 152

Programming n Command DALI command n Parameter n Response Send twice 146 QUERY LAMP - + - FAILURE 147 QUERY LAMP - + - POWER ON 148 QUERY LIMIT - + - ERROR 149 QUERY RESET - + - STATE 150 QUERY MISSING - + - SHORT ADDRESS 151 QUERY VERSION - + - NUMBER 152 QUERY CONTENT - + - DTR0 153 QUERY DEVICE - + - TYPE 154 QUERY PHYSICAL - + - MINIMUM 155 QUERY POWER - + - FAILURE 156 QUERY CONTENT - + - DTR1 157 QUERY CONTENT - + - DTR2 158 QUERY - + - OPERATING MODE 159 QUERY LIGHT - + - SOURCE TYPE 160 QUERY ACTUAL - + - LEVEL 161 QUERY MAX - + - LEVEL 162 QUERY MIN LEVEL - + - 163 QUERY POWER - + - ON LEVEL 164 QUERY SYSTEM - + - FAILURE LEVEL 165 QUERY FADE - + - TIME/FADE RATE 166 QUERY - + - MANUFACTURER SPECIFIC MODE 167 QUERY NEXT - + - DEVICE TYPE 168 QUERY EXTENDED - + - FADE TIME 170 QUERY CONTROL - + - GEAR FAILURE 176…191 QUERY SCENE - + - LEVEL 192 QUERY GROUPS - + - 0-7 193 QUERY GROUPS - + - 8-15 152 Version: 1.20.0 TE1000
## Page 153

Programming n Command DALI command n Parameter n Response Send twice 194 QUERY RANDOM - + - ADDRESS H 195 QUERY RANDOM - + - ADDRESS M 196 QUERY RANDOM - + - ADDRESS L 197 READ MEMORY - + - LOCATION 255 QUERY EXTENDED - + - VERSION NUMBER 256 TERMINATE - - - 257 DTR0 + - - 258 INITIALISE + - + 259 RANDOMISE - - + 260 COMPARE - + - 261 WITHDRAW - - - 264 SEARCHADDR H + - - 265 SEARCHADDR M + - - 266 SEARCHADDR L + - - 267 PROGRAM SHORT + - - ADDRESS 268 VERIFY SHORT + + - ADDRESS 269 QUERY SHORT - + - ADDRESS 272 ENABLE DEVICE + - - TYPE 273 DTR1 + - - 274 DTR2 + - - 275 WRITE MEMORY + + - LOCATION 276 WRITE MEMORY + + - LOCATION - NO REPLY Prerequisites Development environment Required PLC library Twin CAT from v3.1.4024.68 Tc3_DALI from v3.22.2.0 4.1.2.1.7 Variables Each DALI control gear has a certain number of variables (parameters). These variables are used to configure the DALI control gear and thus influence its behavior. The values of the variables are stored in the respective DALI control gear. TE1000 Version: 1.20.0 153
## Page 154

Programming Name Reset value Scope Size Comment actual Level [} 155] 254 0, min Level…max Level 1 byte power On Level [} 155] 254 0…255 1 byte system Failure Level 254 0…255 1 byte [} 155] min Level [} 155] PHM PHM…max Level 1 byte max Level [} 155] 254 min Level…254 1 byte fade Rate [} 155] E_DALIFade Rate. N04 E_DALIFade Rate. N003Steps Per 1 byte 5Steps Per Sec Sec ... E_DALIFade Rate. N358Steps Per Sec fade Time [} 156] E_DALIFade Time. Disa E_DALIFade Time. Disabled 1 byte bled … E_DALIFade Time. T90500ms extended Fade Time Bas E_DALIExtended Fade E_DALIExtended Fade Time Base. 1 byte Time Base. Base01 Base01 e [} 157] … E_DALIExtended Fade Time Base. Base15 extended Fade Time Mul E_DALIExtended Fade E_DALIExtended Fade Time Multipl 1 byte Time Multiplier. Disable ier. Disabled itiplier [} 157] d … E_DALIExtended Fade Time Multipl ier. Multiplier1min short Address [} 158] No change 0…63, 255 1 byte search Address [} 158] 16#FF_FF_FF 16#00_00_00…16#FF_FF_FF 3 bytes random Address [} 158] 16#FF_FF_FF 16#00_00_00…16#FF_FF_FF 3 bytes control Gear Failure The value can change TRUE, FALSE 1 byte Read only after a RESET [} 158] command. lamp Failure [} 158] The value can change TRUE, FALSE 1 byte Read only after a RESET command. lamp On [} 158] The value can change TRUE, FALSE 1 byte Read only after a RESET command. limit Error [} 158] FALSE TRUE, FALSE 1 byte Read only fade Running [} 158] FALSE TRUE, FALSE 1 byte Read only reset State [} 159] TRUE TRUE, FALSE 1 byte Read only power Cycle Seen FALSE TRUE, FALSE 1 byte Read only [} 159] gear Groups [} 159] 16#0000 16#0000…16#FFFF 2 byte scene0…scene15 255 0…255 1 byte [} 159] DTR0 [} 159] No change 0…255 1 byte DTR1 [} 159] No change 0…255 1 byte DTR2 [} 159] No change 0…255 1 byte physical Min Level No change 1…255 1 byte Read only (PHM) [} 159] 154 Version: 1.20.0 TE1000
## Page 155

Programming Name Reset value Scope Size Comment device Types [} 159] No change E_DALIDevice Type. DT00Fluores N bytes Read only cent Lamp … E_DALIDevice Type. DT52Diagnos tis Maintenance actual Level The variable contains the current output value of the DALI control gear. The value of the variable can be read out with the function block FB_DALI102Query Actual Level [} 99]. power On Level When the supply voltage is applied to the DALI control gear, the lamp is controlled with the output value stored in the variable power On Level. A prerequisite is that the DALI bus is supplied with power and that the quiescent level is maintained. If power On Level is set to 255 (MASK), then after applying the supply voltage the output value is set to the last active output value (min Level...max Level) before the supply voltage is switched off. If the output value is to be set to 0 after applying the supply voltage, power On Level must also be 0. If power On Level is greater than 0 and less than 255, the output value after applying the supply voltage is always limited by the variables min Level and max Level. The value of the variable can be queried with the function block FB_DALI102Query Power On Level [} 121] and changed with the function block FB_DALI102Set Power On Level [} 74]. system Failure Level If an error occurs on the DALI bus (open-circuit voltage below the permissible level range for more than 500 ms), the DALI control gear is controlled with the output value from the system Failure Level variable. If the variable value is 255 (MASK), the output value does not change. The value range is limited by the variables min Level and max Level. The value of the variable can be queried with the function block FB_DALI102Query System Failure Level [} 127] and changed with the function block FB_DALI102Set System Failure Level [} 79]. min Level / max Level The output value is limited within the DALI control gear by the variables min Level and max Level. Exceptions are the output values 0 (OFF) and 255 (MASK). The value of the respective variable can be read out with the function blocks FB_DALI102Query Min Level [} 117] / FB_DALI102Query Max Level [} 116] and changed with the function blocks FB_DALI102Set Min Level [} 73] / FB_DALI102Set Max Level [} 71]. fade Rate The fade Rate determines the rate of change (in steps per second) of the output value. The variable has an effect on the DALI commands FB_DALI102Up [} 97] and FB_DALI102Down [} 84]. The value of the variable can be read with the function block FB_DALI102Query Fade Time Fade Rate [} 110] and changed with the function block FB_DALI102Set Fade Rate [} 68]. The following values can be specified via E_DALIFade Rate [} 910]: TE1000 Version: 1.20.0 155
## Page 156

Programming E_DALIFade Rate Value N358Steps Per Sec 358 steps/s N253Steps Per Sec 253 steps/s N179Steps Per Sec 179 steps/s N127Steps Per Sec 127 steps/s N089Steps Per Sec 89.4 steps/s N063Steps Per Sec 63.3 steps/s N045Steps Per Sec 44.7 steps/s N032Steps Per Sec 31.6 steps/s N022Steps Per Sec 22.4 steps/s N016Steps Per Sec 15.8 steps/s N011Steps Per Sec 11.2 steps/s N008Steps Per Sec 7.9 steps/s N006Steps Per Sec 5.6 steps/s N004Steps Per Sec 4.0 steps/s N003Steps Per Sec 2.8 steps/s fade Time The fade Time defines the time the current output value takes to reach the required value. If the lamp is switched on, the preheating and ignition times are not included in the fade time. The variable has an effect on the commands FB_DALI102Direct Arc Power Control [} 82], FB_DALI102Go To Scene [} 87] and FB_DALI102Go To Last Active Level [} 85]. The value of the variable can be read with the function block FB_DALI102Query Fade Time Fade Rate [} 110] and changed with the function block FB_DALI102Set Fade Time [} 70]. The following values can be specified via E_DALIFade Time [} 910]: E_DALIFade Time Value Disabled If fade Time is set to E_DALIFade Time. Disabled, the Extended Fade Time is used. This is calculated from the product of extended Fade Time Base and extended Fade Time Multiplier. If the Extended Fade Time is to be used, fast Fade Time must also be set to E_DALIFast Fade Time. Disabled if available. T00707ms 0.7 s T01000ms 1.0 s T01400ms 1.4 s T02000ms 2.0 s T02800ms 2.8 s T04000ms 4.0 s T05700ms 5.7 s T08000ms 8.0 s T11300ms 11.3 s T16000ms 16.0 s T22600ms 22.6 s T32000ms 32.0 s T45300ms 45.3 s T64000ms 64.0 s T90500ms 90.5 s 156 Version: 1.20.0 TE1000
## Page 157

Programming extended Fade Time Base This variable is the basic value for the calculation of the Extended Fade Time (0 ms to 16 min). The Extended Fade Time is used if fade Time [} 156] was set to E_DALIFade Time. Disabled and, if present, fast Fade Time [} 335] is equal to E_DALIFast Fade Time. Disabled. The value of the variable can be read with the function block FB_DALI102Query Extended Fade Time [} 108] and changed with the function block FB_DALI102Set Extended Fade Time [} 67]. The Extended Fade Time is calculated as follows: Extended Fade Time = extended Fade Time Base x extended Fade Time Multiplier The following basic values are available: E_DALIExtended Fade Time Base Value Base01 1 Base02 2 Base03 3 Base04 4 Base05 5 Base06 6 Base07 7 Base08 8 Base09 9 Base10 10 Base11 11 Base12 12 Base13 13 Base14 14 Base15 15 Base16 16 extended Fade Time Multiplier This variable is the multiplier for the calculation of the Extended Fade Time (0 ms to 16 min). The Extended Fade Time is used if fade Time [} 156] was set to E_DALIFade Time. Disabled and, if present, fast Fade Time [} 335] is equal to E_DALIFast Fade Time. Disabled. If extended Fade Time Multiplier assumes the value E_DALIExtende Fade Time Multiplier. Disabled, the desired illuminance is reached as soon as possible. The value of the variable can be read with the function block FB_DALI102Query Extended Fade Time [} 108] and changed with the function block FB_DALI102Set Extended Fade Time [} 67]. The Extended Fade Time is calculated as follows: Extended Fade Time = extended Fade Time Base x extended Fade Time Multiplier The following multiplication values are available: E_DALIExtended Fade Time Multiplier Value Disabled Fade Time is not used Multiplier100ms x 100 ms Multiplier1s x 1 s Multiplier10s x 10 s Multiplier1min x 1 min TE1000 Version: 1.20.0 157
## Page 158

Programming short Address The short address is stored in this variable. A valid short address lies in the range between 0 and 63. With a value of 255 (MASK), the short address is considered deleted. The short address is set with the function block FB_DALI102Set Short Address [} 78]. search Address The search address is only required for the assignment of short addresses. The value of the variable can be changed with the function block FB_DALI102Set Search Address [} 140]. random Address The random address, also known as the long address, is only required when short addresses are assigned. With the help of the function block FB_DALI102Query Random Address [} 123] the 3 bytes long random address can be read. control Gear Failure The variable indicates whether the DALI control gear operates as intended. In the event of an error, the bit is set to TRUE after 30 s at the latest. The bit is reset once the device works properly again. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. lamp Failure The variable indicates whether the lamp is working correctly. In the event of an error, the bit is set to TRUE after 30 s at the latest. The fault may mean that the connection is faulty or that the lamp is defective. The error state can only be detected when the lamp is switched on. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. lamp On The variable indicates whether the lamp is switched on. This bit is set to FALSE when the lamp is off, during the startup phase and in the event of a total lamp failure. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. limit Error The variable indicates whether the desired output value (target Level) lies within the limits of min Level and max Level, or whether the target Level was changed by the values min Level or max Level. The bit is set to TRUE if one of the described cases occurs. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. fade Running This variable indicates whether dimming is active. The bit is TRUE when dimming starts (after the start phase of the light) until the expiry of fade Time. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. 158 Version: 1.20.0 TE1000
## Page 159

Programming reset State The variable indicates whether all device and instance variables have been set to their reset value (see table above). In this case, the bit is TRUE. Variables that show no change in the Reset Value column are not taken into account. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. power Cycle Seen The variable indicates whether the DALI control gear has been supplied with power without a command having been executed to change the output value. In this case, the bit is TRUE. The variable can be read out with the aid of the function block FB_DALI102Query Status [} 126]. gear Groups The variable indicates whether a particular DALI control gear is assigned to groups 0 to 15. If the bit is set, the control gear belongs to the corresponding group. The value of the variables can be read with the function block FB_DALI102Query Groups [} 111] and changed with the function blocks FB_DALI102Add To Group [} 56] and FB_DALI102Remove From Group [} 59]. scene0…scene15 Each DALI control gear can store output values for 16 different scenes. There is one output value per scene. If the command for calling a scene FB_DALI102Go To Scene [} 87] is called for a device, a group or all devices (broadcast), the output value of the corresponding DALI control gear is set to the stored value. The output is limited by the values of max Level, min Level and physical Min Level. The value of the variable can be read from the function block FB_DALI102Query Scene Level [} 124] and changed with the function blocks FB_DALI102Set Scene [} 76] and FB_DALI102Remove From Scene [} 61]. DTR0…DTR2 Data Transfer Registers (DTR) 0 to 2 serve as buffer for the execution of various DALI commands. The DTRs are used by different function blocks. The description of the respective function block indicates which DTRs are used. The values of the DTRs can be read out with the function blocks FB_DALI102Query Content DTRx [} 100] and changed with the function blocks FB_DALI102Set DTRx [} 137]. physical Min Level The physically smallest possible output value is stored by the vendor in the variable physical Min Level. The value can be read out with the function block FB_DALI102Query Physical Minimum [} 120]. device Types The variable contains the respective device types of a DALI control gear. The device types (see E_DALIDevice Type [} 907]) of a DALI control gear can be read using the function block FB_DALI102Query Device Types [} 107]. TE1000 Version: 1.20.0 159
## Page 160

Programming 4.1.2.2 Part 103 (control devices) 4.1.2.2.1 Configuration commands 4.1.2.2.1.1 FB_DALI103Disable Application Controller The function block deactivates the application controller (see application Active [} 235]). The application controller can be activated with the function block FB_DALI103Enable Application Controller [} 164]. The function block sends the DALI command DISABLE APPLICATION CONTROLLER twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 160 Version: 1.20.0 TE1000
## Page 161

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.2 FB_DALI103Disable Instance The function block disables the selected instance of the DALI control device (see instance Active [} 237]). The instance can be enabled with the function block FB_DALI103Enable Instance [} 166]. The function block sends the DALI command DISABLE INSTANCE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; TE1000 Version: 1.20.0 161
## Page 162

Programming e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 162 Version: 1.20.0 TE1000
## Page 163

Programming 4.1.2.2.1.3 FB_DALI103Disable Power Cycle Notification The function block locks the event Power Cycle Notification. The event can be enabled with the function block FB_DALI103Enable Power Cycle Notification [} 167]. The function block sends the DALI command DISABLE POWER CYCLE NOTIFICATION twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 163
## Page 164

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.4 FB_DALI103Enable Application Controller The function block enables the application controller (see application Active [} 235]). The application controller can be disabled with the function block FB_DALI103Disable Application Controller [} 160]. The function block sends the DALI command ENABLE APPLICATION CONTROLLER twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 164 Version: 1.20.0 TE1000
## Page 165

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 165
## Page 166

Programming 4.1.2.2.1.5 FB_DALI103Enable Instance The function block enables the selected instance of the DALI control device (see instance Active [} 237]). The instance can be disabled with the function block FB_DALI103Disable Instance [} 161]. The function block sends the DALI command ENABLE INSTANCE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 166 Version: 1.20.0 TE1000
## Page 167

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.6 FB_DALI103Enable Power Cycle Notification The function block enables the event Power Cycle Notification. The event can be disabled with the function block FB_DALI103Disable Power Cycle Notification [} 163]. The function block sends the DALI command ENABLE POWER CYCLE NOTIFICATION twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 167
## Page 168

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 168 Version: 1.20.0 TE1000
## Page 169

Programming 4.1.2.2.1.7 FB_DALI103Identify Device The function block starts the identification routine for a DALI control device. The routine takes approx. 10 s and ends automatically. The exact scope of the identification routine depends on the manufacturer of the DALI control device. The function block sends the DALI command IDENTIFY DEVICE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 169
## Page 170

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.8 FB_DALI103Reset The function block resets all device and instance variables of the DALI control device to their reset values (see reset State [} 236]). DALI control devices can take up to 300 ms to execute the DALI command. Only then are further DALI commands executed by the respective control device. The function block sends the DALI command RESET twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 170 Version: 1.20.0 TE1000
## Page 171

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 171
## Page 172

Programming 4.1.2.2.1.9 FB_DALI103Reset Memory Bank The values of the selected memory bank of the DALI control device are set to their respective default values by the function block (see Memory banks [} 16]). During the reset, the DALI control device does not react to other commands. The function block also resets the values that are write-protected by the lock byte. The DALI commands ENABLE WRITE MEMORY, WRITE MEMORY LOCATION – NO REPLY and RESET MEMORY BANK are called internally. The function block changes the DTR0 and the DTR1 of all connected DALI control devices. The function block sends the DALI command RESET MEMORY BANK twice, as foreseen by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE := 2; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 172 Version: 1.20.0 TE1000
## Page 173

Programming Name Type Description n Memory Bank BYTE Specification of the memory bank. If a 0 is specified, all memory banks are reset (except for memory bank 0, as this is read-only). For all other values, only the respective memory bank is reset. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.2.1.10 FB_DALI103Save Persistent Variables The function block immediately triggers the saving of variables in the persistent memory by the DALI command SAVE PRESISTENT VARIABLES. DALI control devices do not save the variables directly in the persistent memory. Instead, the values are copied to the persistent memory in the background. Since this happens over a longer period of time (a few seconds), the values can be lost if the DALI bus is disconnected. The SAVE PRESISTENT VARIABLES DALI command triggers immediate copying to the persistent memory. In most cases, no communication with the DALI device can take place during copying (up to 350 ms). TE1000 Version: 1.20.0 173
## Page 174

Programming The function block sends the DALI command SAVE PRESISTENT VARIABLES twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 174 Version: 1.20.0 TE1000
## Page 175

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.11 FB_DALI103Set Event Filter The function block sets the event filter (see event Filter [} 238]) for the corresponding instance of the DALI control device. Each bit of the input variable n Event Filter represents an event. If the bit is set, the associated event is enabled. The meanings of the individual bits for the respective instance types can be found here: Part 301 (push buttons) – Introduction [} 517] Part 302 (absolute input devices) - Introduction [} 537] Part 303 (occupancy sensors) - Introduction [} 548] Part 304 (light sensors) - Introduction [} 566] The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control devices. The function block sends the DALI command SET EVENT FILTER twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; TE1000 Version: 1.20.0 175
## Page 176

Programming e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Event Filter : DWORD := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Event Filter DWORD Each bit represents an event to be enabled or disabled. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 176 Version: 1.20.0 TE1000
## Page 177

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.12 FB_DALI103Set Event Priority This function block sets the event priority (see event Priority [} 238]) for the corresponding instance of the DALI control device. With DALI control devices the event priority affects all Input Notification Events that the respective instance of the DALI control device sends. With DALI control devices, the event priority can assume values from E_DALIEvent Priority. Low … E_DALIEvent Priority. Middle High. In most cases the reset value should be used. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET EVENT PRIORITY twice, as foreseen by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Event Priority : E_DALIEvent Priority := E_DALIEvent Priority. Middle; END_VAR TE1000 Version: 1.20.0 177
## Page 178

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Event Priority E_DALIEvent Priority Priority (low, middle low, middle, middle high) with which the Input Notification Events are sent from the instance of the DALI control device (see E_DALIEvent Priority [} 908]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 178 Version: 1.20.0 TE1000
## Page 179

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.2.1.13 FB_DALI103Set Event Scheme The function block determines the event scheme (see event Scheme [} 238]) for the events of the respective instance of the DALI control device. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET EVENT SCHEME twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Event Scheme : E_DALIEvent Scheme := E_DALIEvent Scheme. Device Instance; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 179
## Page 180

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Event Scheme E_DALIEvent Scheme Event scheme for the events (see E_DALIEvent Scheme [} 908]) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.14 FB_DALI103Set Operating Mode The function block sets the operating mode of the DALI control device (see operating Mode [} 235]). 180 Version: 1.20.0 TE1000
## Page 181

Programming The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET OPERATING MODE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Operating Mode : BYTE := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Operating Mode BYTE Operating mode entry Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 181
## Page 182

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.15 FB_DALI103Set Short Address The function block stores the new short address n New Short Address in the DALI control device (see short Address [} 234]). The existing short address in the DALI control device is deleted if a value of 255 is specified at the input. To address a device without a known short address, the command must be sent as a broadcast (e Address Type = E_DALIAddress Type. Broadcast). This gives all control devices connected to the DALI terminal the short address n New Short Address. Alternatively, the function block can be called with Broadcast unaddressed (e Address Type = E_DALIAddress Type. Broadcast Unaddr). In this case, only the devices that do not yet have a short address are assigned a short address. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET SHORT ADDRESS twice, as required by the DALI standard for certain DALI commands. 182 Version: 1.20.0 TE1000
## Page 183

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n New Short Address : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n New Short Address BYTE New short address (0…63, 255) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 183
## Page 184

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.16 FB_DALI103Start Quiescent Mode The function block enables the Quiescent Mode [} 235] for approx. 15 minutes. In Quiescent mode, no commands and events are sent from the DALI control device. Quiescent mode can be terminated prematurely with the function block FB_DALI103Stop Quiescent Mode [} 185]. The function block sends the DALI command START QUIESCENT MODE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] 184 Version: 1.20.0 TE1000
## Page 185

Programming The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.1.17 FB_DALI103Stop Quiescent Mode The function block interrupts the Quiescent mode [} 235] prematurely. Quiescent mode can be started with the function block FB_DALI103Start Quiescent Mode [} 184]. The function block sends the DALI command STOP QUIESCENT MODE twice, as required by the DALI standard for certain DALI commands. TE1000 Version: 1.20.0 185
## Page 186

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 186 Version: 1.20.0 TE1000
## Page 187

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2 Query commands 4.1.2.2.2.1 FB_DALI103Query Content DTR0 The function block reads the contents of DTR0 [} 235] (Data Transfer Register 0) from the DALI control device. The output n Content DTR0 contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Content DTR0 : BYTE; END_VAR TE1000 Version: 1.20.0 187
## Page 188

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Content DTR0 BYTE Content of the DTR0 (Data Transfer Register 0) (0…255) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.2 FB_DALI103Query Content DTR1 The function block reads the contents of DTR1 [} 235] (Data Transfer Register 1) from the DALI control device. The output n Content DTR1 contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 188 Version: 1.20.0 TE1000
## Page 189

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Content DTR1 : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Content DTR1 BYTE Content of the DTR1 (Data Transfer Register 1) (0…255) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 189
## Page 190

Programming 4.1.2.2.2.3 FB_DALI103Query Content DTR2 The function block reads the contents of DTR2 [} 235] (Data Transfer Register 2) from the DALI control device. The output n Content DTR2 contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Content DTR2 : BYTE; END_VAR 190 Version: 1.20.0 TE1000
## Page 191

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Content DTR2 BYTE Content of the DTR2 (Data Transfer Register 2) (0…255) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.4 FB_DALI103Query Device Status The function block reads the status of the DALI control device. The following status information is provided at output n Device Status. Bit Description 0 Status of the DALI control device (see input Device Error [} 236]) 1 Quiescent mode (see quiescent Mode [} 235]) 2 Short address missing (variable short Address [} 234] is 255 (MASK)) 3 Application controller active (see application Active [} 235]) 4 Application controller error (see application Controller Error [} 236]) 5 The power supply was enabled (see power Cycle Seen [} 236]) 6 Reset state (see reset State [} 236]) 7 Unused (default value is 0) The output n Device Status only contains a valid value if the function block was executed without errors (b Error = FALSE). TE1000 Version: 1.20.0 191
## Page 192

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Device Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Device Status BYTE Output value of the Device Status, see table above. 192 Version: 1.20.0 TE1000
## Page 193

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.5 FB_DALI103Query Event Filter The function block reads the event filter (see event Filter [} 238]) for the selected instance of the DALI control device. Each bit of the input variable n Event Filter represents an event. If the bit is set, the associated event is enabled. The meanings of the individual bits for the respective instance types can be found here: Part 301 (push buttons) – Introduction [} 517] Part 302 (absolute input devices) - Introduction [} 537] Part 303 (occupancy sensors) - Introduction [} 548] Part 304 (light sensors) - Introduction [} 566] The output n Event Filter contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 193
## Page 194

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Event Filter : DWORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Event Filter DWORD Each bit represents a manufacturer-specific event that has been enabled or disabled. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 194 Version: 1.20.0 TE1000
## Page 195

Programming 4.1.2.2.2.6 FB_DALI103Query Event Priority This function block reads the event priority (see event Priority [} 238]) for the selected instance of the DALI control device. With DALI control devices the event priority affects all Input Notification Events that the respective instance of the DALI control device sends. With DALI control devices, the event priority can assume values from E_DALIEvent Priority. Low … E_DALIEvent Priority. Middle High. The output e Event Priority contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; TE1000 Version: 1.20.0 195
## Page 196

Programming b Busy : BOOL; e Event Priority : E_DALIEvent Priority; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Event Priority E_DALIEvent Priority Returns the priority (low, middle low, middle, middle high) with which the Input Notification Events are sent from the instance of the DALI control device. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.2.2.7 FB_DALI103Query Event Scheme The function block reads the event scheme (see event Scheme [} 238]) for the events of the selected DALI control device instance. The output e Event Scheme contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; 196 Version: 1.20.0 TE1000
## Page 197

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Event Scheme : E_DALIEvent Scheme; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Event Scheme E_DALIEvent Scheme Event scheme for the events [} 908] Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 197
## Page 198

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.8 FB_DALI103Query Input Device Error The function block reads more detailed error information from the DALI control device (see input Device Error [} 236]). The meaning depends on the manufacturer of the DALI control device. The output n Input Device Error only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Input Device Error : BYTE; END_VAR 198 Version: 1.20.0 TE1000
## Page 199

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Input Device Error BYTE Output of the error information of the DALI control device (vendor-dependent). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.9 FB_DALI103Query Input Value The function block queries the input value (see input Value [} 238]) of the selected instance of the DALI control device. The parameter n Resolution specifies how high the resolution (in bits) of the input value is. The function block FB_DALI103Query Resolution [} 214] can be used to read the resolution. All bytes of the input value are read and subsequently decoded. The DALI commands QUERY INPUT VALUE and QUERY INPUT VALUE LATCH are called internally for this purpose Make sure that the parameter n Resolution corresponds to the actual resolution of the device, otherwise errors may occur during decoding. The possible input values for the respective instance types can be found here: Part 301 (push buttons) – Introduction [} 516] Part 302 (absolute input devices) - Introduction [} 537] Part 303 (occupancy sensors) - Introduction [} 548] TE1000 Version: 1.20.0 199
## Page 200

Programming Part 304 (light sensors) - Introduction [} 566] The output n Input Value and the property n Raw Input Value only contain a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Resolution : BYTE := 8; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Resolution BYTE Resolution of the input value in bits (1...64). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Input Value : LWORD; END_VAR 200 Version: 1.20.0 TE1000
## Page 201

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Input Value LWORD The input value of the selected instance of the DALI control device. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). n Raw Input Value LWORD Get - The uncoded input value of the selected instance of the DALI control device. Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.10 FB_DALI103Query Instance Enabled The function block queries whether the specified instance of the DALI control device is active (see instance Active [} 237]). The instance can be enabled with the function block FB_DALI103Enable Instance [} 166]. The instance can be disabled with the function block FB_DALI103Disable Instance [} 161]. The output b Instance Enabled contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 201
## Page 202

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Instance Enabled : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Instance Enabled BOOL Is TRUE if the instance is active. 202 Version: 1.20.0 TE1000
## Page 203

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.11 FB_DALI103Query Instance Error The function block reads more detailed error information for the selected instance from the DALI control device (see instance Error [} 239]). The meaning of the values depends on the selected instance type. The output n Instance Error contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 203
## Page 204

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Instance Error : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Instance Error BYTE Error information for the selected instance. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 204 Version: 1.20.0 TE1000
## Page 205

Programming 4.1.2.2.2.12 FB_DALI103Query Instance Status The function block reads the status of the selected instance from the DALI control device. Bit Description 0 Status of the instance (see instance Error [} 239]) 1 Events are enabled for the instance (see instance Active [} 237]) 2…7 Unused (default value is 0) The output n Instance Status only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 205
## Page 206

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Instance Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Instance Status BOOL Status of the selected instance Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.13 FB_DALI103Query Instance Type The function block reads the instance type (see instance Type [} 237]) for the selected instance from the DALI control device. The output e Instance Type only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. 206 Version: 1.20.0 TE1000
## Page 207

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Instance Type : E_DALIInstance Type; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Instance Type E_DALIInstance Type Output of the instance type (see instance Type [} 237]). [} 911] TE1000 Version: 1.20.0 207
## Page 208

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.2.2.14 FB_DALI103Query Number Of Instances The function block reads the number of existing instances from the DALI control device (see number Of Instances [} 235]). The output n Number Of Instances contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. 208 Version: 1.20.0 TE1000
## Page 209

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Number Of Instances : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Number Of Instance DALI Number of instances in the DALI control device. s Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.15 FB_DALI103Query Operatig Mode The function block reads the variable operating Mode [} 235] from the DALI control device. The meaning of this variable is defined by the manufacturer of the DALI control device. The output n Operating Mode only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 209
## Page 210

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Operating Mode : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Operating Mode BYTE Output of the variable operating Mode [} 235]. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 210 Version: 1.20.0 TE1000
## Page 211

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.16 FB_DALI103Query Power Cycle Notification The function block outputs whether the Power Cycle Notification event of a DALI control device is enabled. The event can be enabled with the function block FB_DALI103Enable Power Cycle Notification [} 167]. The event can be disabled with the function block FB_DALI103Disable Power Cycle Notification [} 163]. The output b Power Cycle Notification only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Power Cycle Notification : BOOL; END_VAR TE1000 Version: 1.20.0 211
## Page 212

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Power Cycle Notifica BOOL Is TRUE if the Power Cycle Notification event is enabled. tion Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.17 FB_DALI103Query Random Address The function block reads the variable random Address [} 235] from the DALI control device. The DALI commands QUERY RANDOM ADDRESS (H), QUERY RANDOM ADDRESS (M) and QUERY RANDOM ADDRESS (L) are called internally. The output n Random Address contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 212 Version: 1.20.0 TE1000
## Page 213

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Random Address : UDINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Random Address UDINT Random address (16#00_00_00…16#FF_FF_FE). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 213
## Page 214

Programming 4.1.2.2.2.18 FB_DALI103Query Resolution The function block reads the resolution of the input value for the selected instance from the DALI control device (see resolution [} 238]). The output n Resolution contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Resolution : BYTE; END_VAR 214 Version: 1.20.0 TE1000
## Page 215

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Resolution BYTE Number of bits with which the input value is resolved. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.2.19 FB_DALI103Read Memory Location The value n Value is read from the memory bank of the DALI control device. The corresponding memory bank is specified by the input variable n Memory Bank, the address within the memory bank by the input variable n Offset. The function block changes the DTR0 and the DTR1 of all connected DALI control devices. The output n Value contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 215
## Page 216

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE; n Offset : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Memory Bank BYTE Specifies the memory bank for the read access (DTR1). n Offset BYTE Address from which a value within the memory bank is to be read (DTR0). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Value : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Value BYTE Value read from the memory bank. 216 Version: 1.20.0 TE1000
## Page 217

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.1.2.2.3 Special commands 4.1.2.2.3.1 FB_DALI103Initialise The function block prepares the addressing of the DALI control devices. This function block is required if addressing of the DALI control devices is to be implemented in the PLC. The function block FB_DALI103Addressing [} 49] can be used to assign the addresses from the PLC. n Parameter is used to define which DALI control devices are taken into account for addressing: Value (binary) Description 2#0111_1111 DALI control devices without a short address respond. 2#00AA_AAAA DALI control devices with the address 2#00AA_AAAA respond. 2#1111_1111 All DALI control devices respond. The function block sends the DALI command INITIALIZE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n Parameter : BYTE := 2#0111 1111; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 217
## Page 218

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Parameter BYTE Specifies which control devices are to respond to this command (see table above). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.2 FB_DALI103Program Short Address The function block stores the value n Short Address as short address in the variable short Address [} 234] for all selected DALI control devices. DALI control devices are selected if the random Address of the DALI control device is the same as the search Address and the DALI command INITIALISE (see FB_DALI103Initialise [} 217]) was executed previously. 218 Version: 1.20.0 TE1000
## Page 219

Programming This function block is required if addressing of the DALI control devices is to be implemented in the PLC. The function block FB_DALI103Addressing [} 49] can be used to assign the addresses from the PLC. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n Short Address : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Short Address BYTE Short address to be assigned (0…63, 255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 219
## Page 220

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.3 FB_DALI103Randomise The function block generates a new random address for all selected DALI control devices and writes it to the random Address variable. DALI control devices are selected if the DALI command INITIALISE (see FB_DALI103Initialise [} 217]) was executed previously. This function block is required if addressing of the DALI control devices is to be implemented in the PLC. The function block FB_DALI103Addressing [} 49] can be used to assign the addresses from the PLC. The function block sends the DALI command RANDOMIZE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 220 Version: 1.20.0 TE1000
## Page 221

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.4 FB_DALI103Set DTR0 The function block writes to the DTR0 [} 235] (Data Transfer Register 0) of all DALI control devices. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n DTR0 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 221
## Page 222

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n DTR0 BYTE Value to be written to the DTR0 (Data Transfer Register 0) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.5 FB_DALI103Set DTR1 The function block writes to DTR1 [} 235] (Data Transfer Register 1) of all DALI control devices. The function block cannot be used when using the KL6811. 222 Version: 1.20.0 TE1000
## Page 223

Programming Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n DTR1 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n DTR1 BYTE Value to be written to the DTR1 (Data Transfer Register 1) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 223
## Page 224

Programming 4.1.2.2.3.6 FB_DALI103Set DTR1DTR0 The function block writes the DTR0 (Data Transfer Register 0) and the DTR1 (Data Transfer Register 1) of all DALI control devices. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n DTR0 : BYTE; n DTR1 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n DTR0 BYTE Value to be written to the DTR0 (Data Transfer Register 0) (0…255). n DTR1 BYTE Value to be written to the DTR1 (Data Transfer Register 1) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 224 Version: 1.20.0 TE1000
## Page 225

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.0 Tc3_DALI from v3.1.5.0 4.1.2.2.3.7 FB_DALI103Set DTR2 The function block writes to DTR2 [} 235] (Data Transfer Register 2) of all DALI control devices. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n DTR2 : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 225
## Page 226

Programming Name Type Description n DTR2 BYTE Value to be written to the DTR2 (Data Transfer Register 2) (0…255). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.8 FB_DALI103Set Search Address The function block stores the value n Search Address in the search Address [} 235] variable for all selected DALI control devices. DALI control devices are selected if the DALI command INITIALISE (see FB_DALI103Initialise [} 217]) was executed previously. The DALI commands SEARCHADDRH, SEARCHADDRM and SEARCHADDRL are called internally. This function block is required if addressing of the DALI control devices is to be implemented in the PLC. The function block FB_DALI103Addressing [} 49] can be used to assign the addresses from the PLC. 226 Version: 1.20.0 TE1000
## Page 227

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n Search Address : UDINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Search Address UDINT The value to be written to the search Address variable (16#00_00_00…16#FF_FF_FF). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 227
## Page 228

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.9 FB_DALI103Terminate The function block terminates addressing in all DALI control devices. The selection of the devices to be addressed by the function block FB_DALI103Initialise [} 217] is also canceled. This function block is required if addressing of the DALI control devices is to be implemented in the PLC. The function block FB_DALI103Addressing [} 49] can be used to assign the addresses from the PLC. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 228 Version: 1.20.0 TE1000
## Page 229

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.10 FB_DALI103Verify Short Address The function block checks whether the variable short Address [} 234] matches the value n Short Address for all selected DALI control devices. DALI control devices are selected if the DALI command INITIALISE (see FB_DALI103Initialise [} 217]) was executed previously. The DALI commands SEARCHADDRH, SEARCHADDRM and SEARCHADDRL are called internally. This function block is required if addressing of the DALI control devices is to be implemented in the PLC. The function block FB_DALI103Addressing [} 49] can be used to assign the addresses from the PLC. The output b Answer only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle; n Short Address : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 229
## Page 230

Programming Name Type Description n Short Address BYTE Short address with which the own short address is compared Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Answer : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Answer BOOL Is TRUE if n Short Address is equal to its own short address. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.2.3.11 FB_DALI103Write Memory Location The value n Value is written in the memory bank of the DALI control device. The corresponding memory bank is specified by the input variable n Memory Bank, the address within the memory bank by the input variable n Offset. The DALI commands ENABLE WRITE MEMORY and WRITE MEMORY LOCATION are called internally. 230 Version: 1.20.0 TE1000
## Page 231

Programming In contrast to the function block FB_DALI103Write Memory Location No Reply [} 232], the function block FB_DALI103Write Memory Location checks that writing to the memory bank is correct. The function block changes the DTR0 and the DTR1 of all connected DALI control devices. The function block sends the DALI command ENABLE WRITE MEMORY twice, as foreseen by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE := 0; n Offset : BYTE := 0; n Value : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Memory Bank BYTE Specifies the memory bank for the write access. n Offset BYTE Address within the memory bank selected with the variable n Memory Bank. n Value BYTE Value to be written to the address within the memory bank. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 231
## Page 232

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.2.3.12 FB_DALI103Write Memory Location No Reply The value n Value is written in the memory bank of the DALI control device. The corresponding memory bank is specified by the input variable n Memory Bank, the address within the memory bank by the input variable n Offset. The DALI commands ENABLE WRITE MEMORY and WRITE MEMORY LOCATION – NO REPLY are called internally. In contrast to the function block FB_DALI103Write Memory Location [} 230], the function block FB_DALI103Write Memory Location No Reply does not check that writing to the memory bank is correct. The function block changes the DTR0 and the DTR1 of all connected DALI control devices. The function block sends the DALI command ENABLE WRITE MEMORY twice, as foreseen by the DALI standard for certain DALI commands. 232 Version: 1.20.0 TE1000
## Page 233

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Memory Bank : BYTE := 0; n Offset : BYTE := 0; n Value : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Memory Bank BYTE Specifies the memory bank for the write access. n Offset BYTE Address within the memory bank selected with the variable n Memory Bank. n Value BYTE Value to be written to the address within the memory bank. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 233
## Page 234

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.0 Tc3_DALI from v3.1.5.0 4.1.2.2.4 Device variables Each DALI control device has a certain number of device variables (parameters). These device variables are used to configure the DALI control device and thus influence its behavior. The values of the device variables are stored in the respective DALI control device. Name Reset value Scope Size Comment short Address [} 234] No change 0…63, 255 1 byte 255 (MASK): no address search Address [} 235] 16#FF_FF_FF 16#00_00_00… 3 bytes 16#FF_FF_FF random Address 16#FF_FF_FF 16#00_00_00… 3 bytes 16#FF_FF_FF [} 235] DTR0 [} 235] No change 0…255 1 byte DTR1 [} 235] No change 0…255 1 byte DTR2 [} 235] No change 0…255 1 byte number Of Instances No change 0…32 1 byte Read only [} 235] operating Mode No change 0, 128…255 1 byte [} 235] quiescent Mode DISABLED ENABLED, 1 bit DISABLED [} 235] application Active No change TRUE, FALSE 1 bit [} 235] power Cycle Seen FALSE TRUE, FALSE 1 bit Read only [} 236] application Controller E FALSE TRUE, FALSE 1 bit Read only rror [} 236] input Device Error FALSE TRUE, FALSE 1 bit Read only [} 236] reset State [} 236] TRUE TRUE, FALSE 1 bit Read only short Address The short address is stored in this variable. A valid short address lies in the range between 0 and 63. With a value of 255 (MASK), the short address is considered deleted. The short address is set with the function block FB_DALI103Set Short Address [} 182]. 234 Version: 1.20.0 TE1000
## Page 235

Programming search Address The search address is only required for the assignment of short addresses. The value of the variable can be changed with the function block FB_DALI103Set Search Address [} 140]. random Address The random address, also known as the long address, is only required when short addresses are assigned. With the help of the function block FB_DALI103Query Random Address [} 212] the 3 bytes long random address can be read. DTR0…DTR2 Data Transfer Registers (DTR) 0 to 2 serve as buffer for the execution of various DALI commands. The DTRs are used by different function blocks. The description of the respective function block indicates which DTRs are used. The values of the DTRs can be read out with the function blocks FB_DALI103Query Content DTRx [} 187] and changed with the function blocks FB_DALI103Set DTRx [} 221]. number Of Instances The variable indicates how many instances a DALI control device supports. A device has at least one and a maximum of 32 instances. The number of instances is queried with the function block FB_DALI103Query Number Of Instances [} 208]. The type of instance is queried with the function block FB_DALI103Query Instance Type [} 206]. operating Mode The variable indicates the current operating mode of the DALI control device. The value 0 characterizes the standard operation mode, i.e. the device behaves according to its specification. The operating modes 0 to 127 are reserved and must not be used. The operating modes 128 to 255 are vendor-specific. The operation mode can be read out from the DALI control device with the function block FB_DALI103Query Operatig Mode [} 209] and changed with the function block FB_DALI103Set Operating Mode [} 180]. quiescent Mode The variable indicates whether the DALI control device is in quiescent mode. If the variable is TRUE, no commands and events are passed on. The mode is time-limited to 15 min +/- 1.5 min. The mode can be started with the function block FB_DALI103Start Quiescent Mode [} 184] and terminated prematurely with the function block FB_DALI103Stop Quiescent Mode [} 185]. The variable can be read out with the aid of the function block FB_DALI103Query Device Status [} 191]. application Active The variable specifies whether the application controller (DALI controller) is active. According to IEC 62386-103, DALI control devices can contain one or more DALI sensors (input devices) and optionally a DALI controller. If a DALI controller is contained within a DALI control device, it can independently send DALI commands to other control devices and/or DALI control gears (see DALI [} 9]). TE1000 Version: 1.20.0 235
## Page 236

Programming If the application controller is disabled, it does not send any DALI frames other than the Power Cycle Notification. The application controller can be enabled with the function block FB_DALI103Enable Application Controller [} 164] and disabled with the function block FB_DALI103Disable Application Controller [} 160]. power Cycle Seen The variable indicates whether the DALI control device was supplied with power. In this case, the bit is TRUE. The variable can be read out with the aid of the function block FB_DALI103Query Device Status [} 191]. application Controller Error This variable specifies whether an application controller (DALI controller) of a DALI control device has detected an error. In this case, the bit is TRUE. If the DALI control device does not contain an application controller, this variable is always FALSE. The variable can be read out with the aid of the function block FB_DALI103Query Device Status [} 191]. input Device Error The variable indicates whether a DALI control device has detected an error on a DALI sensor (input device). In this case, the bit is TRUE. The variable can be read out with the aid of the function block FB_DALI103Query Device Status [} 191]. The function block FB_DALI103Query Input Device Error [} 198] provides more detailed information about the present error. The output depends on the manufacturer. reset State The variable indicates whether all device and instance variables have been set to their reset value (see table above). In this case, the bit is TRUE. The variable can be read out with the aid of the function block FB_DALI103Query Device Status [} 191]. 4.1.2.2.5 Instance variables Each DALI control device has at least one and a maximum of 32 instances (see variable number Of Instances). Each instance has a certain number of instance variables (parameters), irrespective of the other instances. These instance variables are used to configure the respective instance in the DALI control device and thus influence its behavior. The values of the instance variables are stored in the respective DALI control device. 236 Version: 1.20.0 TE1000
## Page 237

Programming Name Reset value Scope Size Comment instance Active [} 237] No change TRUE, FALSE 1 bit instance Type [} 237] No change 0…31 1 byte Read only resolution [} 238] No change 1…255 1 byte Read only input Value [} 238] No change 0…(2N-1) N bytes Read only (max. 32 bytes) event Filter [} 238] 16#FF_FF_FF 16#00_00_00…16#FF_FF_FF 3 bytes Other values can be defined for individual instance types. Details can be taken from the IEC 62386-3xx standard. event Scheme [} 238] E_DALIEvent Scheme. E_DALIEvent Scheme. Instance 1 byte Instance … E_DALIEvent Scheme. Instance Gr oup event Priority [} 238] No change E_DALIEvent Priority. Low 1 byte Other values … can be E_DALIEvent Priority. Middle High defined for individual instance types. Details can be taken from the IEC 62386-3xx standard. instance Error [} 239] FALSE TRUE, FALSE 1 bit Read only N: resolution instance Active The variable indicates whether sending of events has been enabled for the respective instance. If the variable is FALSE, the instance does not send any events. This variable has no effect on the DALI commands sent to the instance by other DALI controllers. These will be answered even if instance Active is FALSE. The function block FB_DALI103Enable Instance [} 166] is used to enable the sending of events and the function block FB_DALI103Disable Instance [} 161] is used to disable the sending of events. The value of the variable can be read out with the function block FB_DALI103Query Instance Enabled [} 201]. instance Type The variable contains the respective instance type of an instance. Instance type IEC 62386- Application 0 103 General application and control devices; not defined further 1-31 301-331 These IEC 62386-3xx parts describe instance types from 301 to 331 The instance type (see E_DALIInstance Type [} 911]) of an instance can be read using the function block FB_DALI103Query Instance Type [} 206]. TE1000 Version: 1.20.0 237
## Page 238

Programming resolution The variable indicates the resolution of input Value [} 238]. The resolution corresponds to the number of bits through which the input value is mapped. The function block FB_DALI103Query Resolution [} 214] can be used to read the resolution. input Value The variable outputs the input value of an instance. The number of bits in which the input value is mapped can be queried through the variable resolution [} 238]. The input value can be read out with the function block FB_DALI103Query Input Value [} 199]. event Filter The event filter enables or disables specific events for each instance. The meanings of the individual bits for the respective instance types can be found here: Part 301 (push buttons) – Introduction [} 517] Part 302 (absolute encoder) - Introduction [} 537] Part 303 (occupancy sensors) - Introduction [} 548] Part 304 (light sensors) - Introduction [} 566] The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. event Scheme The variable contains the event scheme for the respective instance of a DALI control device. E_DALIEvent Scheme Description Instance Instance addressing with instance type and number. Device Device addressing with short address and instance type. Device Instance Device/instance addressing with short address and instance number. Device Group Device group addressing with device group and instance type. Instance Group Instance group addressing with instance group and type. The event scheme can be read with the function block FB_DALI103Query Event Scheme [} 196] and written with the function block FB_DALI103Set Event Scheme [} 179]. event Priority Different priorities [} 11] for sending events can be configured for each instance. The device function blocks use the following values for event priorities: E_DALIEvent Priority Application Middle High Middle Part 301 (push button), Part 302 (absolute encoder), Part 303 (occupancy sensor) Middle Low Part 304 (light sensors) Low The value of the event priority can be read with the function block FB_DALI103Query Event Priority [} 195] and written with the function block FB_DALI103Set Event Priority [} 177]. 238 Version: 1.20.0 TE1000
## Page 239

Programming instance Error The variable indicates whether an instance of a control device has detected an error. In this case, the bit is TRUE. The variable can be read out with the aid of the function block FB_DALI103Query Instance Status [} 205]. The function block FB_DALI103Query Instance Error [} 203] provides more detailed information about the present error. The output depends on the manufacturer. 4.1.2.3 Part 202 (emergency lighting) 4.1.2.3.1 Configuration commands 4.1.2.3.1.1 FB_DALI202Set Duration Test Interval The function block stores the value n Duration Test Interval in the variable duration Test Interval [} 287] of the DALI control gear. Prior to the DALI command SET DURATION TEST INTERVAL, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET DURATION TEST INTERVAL twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; n Duration Test Interval : BYTE := 52; END_VAR TE1000 Version: 1.20.0 239
## Page 240

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Duration Test Interv BYTE Interval time for the duration test (see duration Test Interval al [} 287]) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 240 Version: 1.20.0 TE1000
## Page 241

Programming 4.1.2.3.1.2 FB_DALI202Set Emergency Level The function block stores the value n Emergency Level in the variable emergency Level [} 285] of the DALI control gear. Prior to the DALI command SET EMERGENCY LEVEL, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET EMERGENCY LEVEL twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; n Emergency Level : BYTE := 254; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Emergency Level BYTE Output value from DALI control gear in emergency mode (see emergency Level [} 285]). TE1000 Version: 1.20.0 241
## Page 242

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.1.3 FB_DALI202Set Function Test Interval The function block stores the value n Function Test Interval in the variable function Test Interval [} 286] of the DALI control gear. Prior to the DALI command SET FUNCTION TEST INTERVAL, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET FUNCTION TEST INTERVAL twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. 242 Version: 1.20.0 TE1000
## Page 243

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; nfunction Test Interval : BYTE := 7; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Function Test Interv BYTE Interval time for the function test (see function Test Interval al [} 286]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 243
## Page 244

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.1.4 FB_DALI202Set Prolong Time The function block stores the value n Prolong Time in the variable prolong Time [} 286] of the DALI control gear. Prior to the DALI command SET PROLONG TIME, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET PROLONG TIME twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; n Prolong Time : BYTE := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Prolong Time BYTE Time period for prolongation of emergency mode after return of mains voltage (see prolong Time [} 286]). 244 Version: 1.20.0 TE1000
## Page 245

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 4.1.2.3.1.5 FB_DALI202Set Test Delay Time The function block stores the value n Delay Test Time in the variable test Delay Time [} 286] of the DALI control gear. Prior to the DALI commands SET TEST DELAY TIME LSB and SET TEST DELAY TIME MSB, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI commands SET TEST DELAY TIME LSB and SET TEST DELAY TIME MSB twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; TE1000 Version: 1.20.0 245
## Page 246

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; n Test Delay Time : UINT := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Test Delay Time UINT Value written to variable test Delay Time [} 286]. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 246 Version: 1.20.0 TE1000
## Page 247

Programming 4.1.2.3.1.6 FB_DALI202Set Test Execution Timeout The function block stores the value n Test Execution Timeout in the variable test Execution Timeout [} 287] of the DALI control gear. Prior to the DALI command SET TEST EXECUTION TIMEOUT, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET TEST EXECUTION TIMEOUT twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; n Test Execution Timeout : BYTE := 7; Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Test Execution Time BYTE Maximum execution time for the tests (see out test Execution Timeout [} 287]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 247
## Page 248

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.1.7 FB_DALI202Start Identification The function block starts or extends the identification routine of the DALI control gear. The routine takes approx. 10 s and ends automatically. The exact scope of the identification routine depends on the manufacturer of the DALI control gear. Prior to the DALI command START IDENTIFICATION, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command START IDENTIFICATION twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 248 Version: 1.20.0 TE1000
## Page 249

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 249
## Page 250

Programming 4.1.2.3.2 Control commands 4.1.2.3.2.1 FB_DALI202Inhibit This function block prevents the DALI control gear from switching to emergency mode for 15 minutes. The function block FB_DALI202Re Light Reset Inhibit [} 253] can be used to disable inhibition of emergency mode. Prior to the DALI command INHIBIT, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command INHIBIT twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 250 Version: 1.20.0 TE1000
## Page 251

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.2.2 FB_DALI202Perform Selected Function This function block executes certain actions in the DALI control gear depending on the input n Selected Function. The input n Selected Function currently defines the following actions: n Selected Function Description 0 All variables are reset to their respective reset values (see variables [} 285]). Prior to the DALI command PERFORM DTR SELECTED FUNCTION, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command PERFORM DTR SELECTED FUNCTION twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. TE1000 Version: 1.20.0 251
## Page 252

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Selected Function : BYTE; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Selected Function BYTE Defines the action that the function block should perform (see table above). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 252 Version: 1.20.0 TE1000
## Page 253

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.2.3 FB_DALI202Re Light Reset Inhibit This function block is used to switch the DALI control gear back to emergency mode in the absence of mains voltage. This deactivates the function of the function block FB_DALI202Inhibit [} 250]. Prior to the DALI command RE-LIGHT/RESET INHIBIT, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command RE-LIGHT/RESET INHIBIT twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 253
## Page 254

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.2.4 FB_DALI202Reset Duration Test Done Flag This function block resets bit 2 of the variable emergency Status [} 289]. Prior to the DALI command RESET DURATION TEST DONE FLAG, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command RESET DURATION TEST DONE FLAG twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 254 Version: 1.20.0 TE1000
## Page 255

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 255
## Page 256

Programming 4.1.2.3.2.5 FB_DALI202Reset Function Test Done Flag This function block resets bit 1 of the variable emergency Status [} 289]. Prior to the DALI command RESET FUNCTION TEST DONE FLAG, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command RESET FUNCTION TEST DONE FLAG twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 256 Version: 1.20.0 TE1000
## Page 257

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.2.6 FB_DALI202Reset Lamp Time The function block sets the variables lamp Emergency Time [} 287] and lamp Total Operation Time [} 288] to 0. Prior to the DALI command RESET LAMP TIME, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command RESET LAMP TIME twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 257
## Page 258

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 258 Version: 1.20.0 TE1000
## Page 259

Programming 4.1.2.3.2.7 FB_DALI202Rest This function block is used to switch off the lamp when the DALI control gear is in emergency mode. Otherwise the system switches to normal operation if mains voltage is available again, or if the function block FB_DALI202Re Light Reset Inhibit [} 253] was called. Prior to the DALI command REST, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command REST twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 259
## Page 260

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.2.8 FB_DALI202Start Duration Test The function block starts a duration test. If the duration test is started with a delay, this is indicated by bit 5 of the variable emergency Status [} 289]. Prior to the DALI command START DURATION TEST, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command START DURATION TEST twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 260 Version: 1.20.0 TE1000
## Page 261

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 261
## Page 262

Programming 4.1.2.3.2.9 FB_DALI202Start Function Test The function block starts a function test. If the function test is started with a delay, this is indicated by bit 4 of the variable emergency Status [} 289]. Prior to the DALI command START FUNCTION TEST, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command START FUNCTION TEST twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 262 Version: 1.20.0 TE1000
## Page 263

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.2.10 FB_DALI202Stop Test The function block stops a function or duration test. Since all tests are stopped by the function block, bit 4 and bit 5 are also reset in the variable emergency Status [} 289]. Prior to the DALI command STOP TEST, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command STOP TEST twice, as required by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 263
## Page 264

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 264 Version: 1.20.0 TE1000
## Page 265

Programming 4.1.2.3.3 Query commands 4.1.2.3.3.1 FB_DALI202Query Battery Charge The function block reads the variable battery Charge [} 287] from the DALI control gear. b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY BATTERY CHARGE, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Battery Charge only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Battery Charge : BYTE; END_VAR TE1000 Version: 1.20.0 265
## Page 266

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Battery Charge BYTE Battery charge status 0: empty / 254: full (see battery Charge [} 287]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.3.2 FB_DALI202Query Duration Test Result The function block reads the variable duration Test Result [} 287] from the DALI control gear. Prior to the DALI command QUERY DURATION TEST RESULT, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Duration Test Result only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 266 Version: 1.20.0 TE1000
## Page 267

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Duration Test Result : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Duration Test Result BYTE Result of the duration test in steps of 2 minutes (see duration Test Result [} 287]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 267
## Page 268

Programming 4.1.2.3.3.3 FB_DALI202Query Emergency Level The function block reads the variable emergency Level [} 285] from the DALI control gear. b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY EMERGENCY LEVEL, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Emergency Level contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Emergency Level : BYTE; END_VAR 268 Version: 1.20.0 TE1000
## Page 269

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Emergency Level BYTE Output value from DALI control gear in emergency mode (see emergency Level [} 285]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.3.4 FB_DALI202Query Emergency Max Level The function block reads the variable emergency Max Level [} 286] from the DALI control gear. b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY EMERGENCY MAX LEVEL, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Emergency Max Level contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 269
## Page 270

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Emergency Max Level : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Emergency Max Lev BYTE Maximum output value from DALI control gear in el emergency mode (see emergency Max Level [} 286]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 270 Version: 1.20.0 TE1000
## Page 271

Programming 4.1.2.3.3.5 FB_DALI202Query Emergency Min Level The function block reads the variable emergency Min Level [} 286] from the DALI control gear. b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY EMERGENCY MIN LEVEL, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Emergency Min Level contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Emergency Min Level : BYTE; END_VAR TE1000 Version: 1.20.0 271
## Page 272

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Emergency Min Lev BYTE Minimum output value of the DALI control gear in el emergency mode (see emergency Min Level [} 286]) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.3.6 FB_DALI202Query Emergency Mode The function block reads the variable emergency Mode [} 288] from the DALI control gear. Prior to the DALI command QUERY EMERCENCY MODE, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Emergency Mode contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 272 Version: 1.20.0 TE1000
## Page 273

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Emergency Mode : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Emergency Mode BYTE Information about the current operating mode of the DALI control gear (see emergency Mode [} 288]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 273
## Page 274

Programming 4.1.2.3.3.7 FB_DALI202Query Emergency Status The function block reads the variable emergency Status [} 289] from the DALI control gear. Prior to the DALI command QUERY EMERGENCY STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Emergency Status contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Emergency Status : BYTE; END_VAR 274 Version: 1.20.0 TE1000
## Page 275

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Emergency Status BYTE Current information on emergency mode (see emergency Status [} 289]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.3.8 FB_DALI202Query Failure Status The function block reads the variable failure Status [} 289] from the DALI control gear. Prior to the DALI command QUERY FAILURE STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Failure Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 275
## Page 276

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Failure Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Failure Status BYTE Returns the failure status (see failure Status [} 289]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 276 Version: 1.20.0 TE1000
## Page 277

Programming 4.1.2.3.3.9 FB_DALI202Query Features The function block reads the implemented properties from the DALI control gear (see features [} 288]). Prior to the DALI command QUERY FEATURES, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Features contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Features : BYTE; END_VAR TE1000 Version: 1.20.0 277
## Page 278

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Features BYTE Returns information about the implemented features (see features [} 288]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.3.10 FB_DALI202Query Lamp Emergency Time The function block reads the variable lamp Emergency Time [} 287] from the DALI control gear. The variable can be reset again using the function block FB_DALI202Reset Lamp Time [} 257]. Prior to the DALI command QUERY LAMP EMERGENCY TIME, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Lamp Emergency Time contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 278 Version: 1.20.0 TE1000
## Page 279

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Lamp Emergency Time : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Lamp Emergency Ti BYTE Emergency operation time of the lamp from the DALI me control gear (see lamp Emergency Time [} 287]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 279
## Page 280

Programming 4.1.2.3.3.11 FB_DALI202Query Lamp Total Operation Time The function block reads the variable lamp Total Operation Time [} 288] from the DALI control gear. The variable can be reset again using the function block FB_DALI202Reset Lamp Time [} 257]. Prior to the DALI command QUERY LAMP TOTAL OPERATING TIME, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Lamp Total Operation Time only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Lamp Total Operation Time : BYTE; END_VAR 280 Version: 1.20.0 TE1000
## Page 281

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Lamp Total Operatio BYTE Total operation time of the lamp from the DALI control gear n Time (see lamp Total Operation Time [} 288]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.3.3.12 FB_DALI202Query Rated Duration The function block reads the variable rated Duration [} 288] from the DALI control gear. Prior to the DALI command QUERY RATED DURATION, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Rated Duration only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 281
## Page 282

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Rated Duration : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Rated Duration BYTE Nominal operating time from DALI control gear (see rated Duration [} 288]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 282 Version: 1.20.0 TE1000
## Page 283

Programming 4.1.2.3.3.13 FB_DALI202Query Test Timing Depending on the input e Test Timing, this function block reads out the settings for the function and duration test from the DALI control gear. The e Test Timing input currently defines the following actions: e Test Timing Meaning Function Test Delay Time The value of the variable function Test Delay Time [} 286] is read. Duration Test Delay Time The value of the variable duration Test Delay Time [} 286] is read. Function Test Interval The value of the variable function Test Interval [} 286] is read. Duration Test Interval The value of the variable duration Test Interval [} 287] is read out. Test Execution Timeout The value of the variable test Execution Timeout [} 287] is read. Prolong Time The value of the variable prolong Time [} 286] is read. Prior to the DALI command QUERY TEST TIMING, the function block sends the DALI command ENABLE DEVICE TYPE 1, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0 of all connected DALI control gears. The output n Value contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Test Timing : E_DALITest Timing := E_DALITest Timing. Time Until Next Function Test MSB; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 283
## Page 284

Programming Name Type Description e Test Timing E_DALITest Timing [} 913] Defines the variable that the function block should read from the DALI control gear (see table above). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Value : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Value UINT The value that was read out (see table above). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 284 Version: 1.20.0 TE1000
## Page 285

Programming 4.1.2.3.4 Variables Name Reset value Scope Size Comment emergency Level No change emergency Min Level 1 byte … [} 285] emergency Max Level or 255 (MASK) emergency Min Leve No change 1… 1 byte read only emergency Max Level [} 286]l or 255 (MASK) emergency Max Level No change emergency Min Level 1 byte read only … 254 or 255 [} 286] (MASK)MASK prolong Time [} 286] No change 0…255 1 byte test Delay Time No change 0…65535 2 byte write only [} 286] function Test Delay Ti No change 0…65535 2 byte me [} 286] duration Test Delay Ti No change 0…65535 2 byte me [} 286] function Test Interval No change 0…255 1 byte [} 286] duration Test Interval No change 0…97 1 byte [} 287] test Execution Timeou No change 0…255 1 byte t [} 287] battery Charge No change 0…255 1 byte read only [} 287] duration Test Result No change 0…255 1 byte read only [} 287] lamp Emergency Time No change 0…255 1 byte [} 287] lamp Total Operation No change 0…255 1 byte Time [} 288] rated Duration No change 0…255 1 byte read only [} 288] emergency Mode No change 0…255 1 byte read only [} 288] features [} 288] No change 0…255 1 byte read only failure Status [} 289] No change 0…255 1 byte read only emergency Status No change 0…255 1 byte read only [} 289] emergency Level This variable contains the output value when the DALI control gear is in emergency mode. This value is limited by the variables emergency Min Level [} 286] and emergency Max Level [} 286]. If the DALI control gear cannot determine the value, this variable contains the value 255 (MASK). The value can be read out with the function block FB_DALI202Query Emergency Level [} 268] and specified with FB_DALI202Set Emergency Level [} 241]. TE1000 Version: 1.20.0 285
## Page 286

Programming emergency Min Level / emergency Max Level The output value in emergency mode is limited within the DALI control gear by the variables emergency Min Level and emergency Max Level. The values for emergency Min Level and emergency Max Level are fixed by the manufacturer of the DALI control gear and cannot be changed. If the DALI control gear cannot determine the value, the corresponding variable contains the value 255 (MASK). The value of the respective variable can be queried with the function blocks FB_DALI102Query Emergency Min Level [} 271] or FB_DALI102Query Emergency Max Level [} 269]. prolong Time The variable prolong Time defines how long emergency mode is extended after mains voltage is available again. The value is given in steps of 30 s. The permissible value range is 0 (0 s) to 255 (127.5 min). The value can be read out with the function block FB_DALI202Query Test Timing [} 283] and specified with FB_DALI202Set Prolong Time [} 244]. test Delay Time The variable test Delay Time is used to set the variables function Test Delay Time and duration Test Delay Time. This specifies the time behavior for the function test and the duration test. The value can be specified with the function block FB_DALI202Set Test Delay Time [} 245]. Bit 3 of features [} 288] can be used to query whether this variable is supported by the DALI control gear. function Test Delay Time This variable is used to specify the delay time for the function test. Once this time has elapsed, the function test is executed for the first time. The value is given in steps of 15 min. The permissible value range is 0 (0 min) to 65534 (16383.5 h). If automatic testing is not supported, the variable contains the value 65535 (MASK). This variable can be queried via the function block FB_DALI202Query Test Timing [} 283]. This variable is described via test Delay Time [} 286] and function Test Interval [} 286]. Bit 3 of features [} 288] can be used to query whether this variable is supported by the DALI control gear. duration Test Delay Time This variable is used to specify the delay time for the duration test. Once this time has elapsed, the duration test is executed for the first time. The value is given in steps of 15 min. The permissible value range is 0 (0 min) to 65534 (16383.5 h). If automatic testing is not supported, the variable contains the value 65535 (MASK). This variable can be queried via the function block FB_DALI202Query Test Timing [} 283]. This variable is described via test Delay Time [} 286] and duration Test Interval [} 287]. Bit 3 of features [} 288] can be used to query whether this variable is supported by the DALI control gear. function Test Interval This variable is used to specify the interval time for the function test. The function test is executed periodically at these intervals. 286 Version: 1.20.0 TE1000
## Page 287

Programming The value is given in steps of 1 day. The permissible value range is 1 (1 day) to 255 (255 days). The value 0 deactivates the automatic function test. If this variable is written with a value greater than 0, the value from test Delay Time is transferred to the variable function Test Delay Time and thus the delay time for the next function test is defined. The value can be read out with the function block FB_ DALI202Query Test Timing [} 283] and specified with FB_DALI202Set Function Test Interval [} 242]. Bit 3 of features [} 288] can be used to query whether this variable is supported by the DALI control gear. duration Test Interval This variable is used to specify the interval time for the duration test. The duration test is executed periodically at these intervals. The value is given in steps of 1 week. The permissible value range is 1 (1 week) to 255 (255 weeks). The value 0 disables the automatic duration test. If this variable is written with a value greater than 0, the value from test Delay Time is transferred to the variable duration Test Delay Time and thus the delay time for the next duration test is defined. The value can be read out with the function block FB_ DALI202Query Test Timing [} 283] and specified with FB_DALI202Set Duration Test Interval [} 239]. Bit 3 of features [} 288] can be used to query whether this variable is supported by the DALI control gear. test Execution Timeout This variable defines the maximum execution time in which the respective test must be completed. If the maximum execution time is exceeded during a test, this is indicated in bit 4 or bit 5 of the variable failure Status [} 289]. The value is given in steps of 1 day. The permissible value range is 1 (1 day) to 255 (255 days). The value 0 sets the maximum execution time to 15 min. The value can be read out with the function block FB_ DALI202Query Test Timing [} 283] and specified with FB_DALI202Set Test Execution Timeout [} 247]. battery Charge This variable contains the current state of charge of the battery. The permissible value range is from 0 (minimum charge) to 254 (maximum charge). If the DALI control gear cannot determine the state of charge, this variable contains the value 255 (MASK). The state of charge can only be queried after a duration test has been successfully completed. This variable can be read out with the function block FB_DALI202Query Battery Charge [} 265]. duration Test Result This variable contains the result of a duration test. The value is given in steps of 2 min. The permissible value range is 0 (0 min) to 255 (510 min or longer). The value is only valid if bit 2 is set in the variable emergency Status. This variable can be read out with the function block FB_DALI202Query Duration Test Result [} 266]. lamp Emergency Time This variable contains the operation time of the lamp in emergency mode (supply by means of the battery). TE1000 Version: 1.20.0 287
## Page 288

Programming The value is given in steps of 1 hour. The permissible value range is 0 (0 h) to 255 (255 h or longer). The variable is always incremented at the start of the 1-hour interval. This variable can be read out with the function block FB_DALI202Query Lamp Emergency Time [} 278] and reset with FB_DALI202Reset Lamp Time [} 257]. lamp Total Operation Time This variable contains the total operation time of the lamp. The value is given in steps of 4 hours. The permissible value range is 0 (0 h) to 255 (1020 h or longer). The variable is always incremented at the start of the 4-hour interval. This variable can be read out with the function block FB_DALI202Query Lamp Total Operation Time [} 280] and reset with FB_DALI202Reset Lamp Time [} 257]. rated Duration This variable contains the nominal operation time of the battery. The value is given in steps of 2 min. The permissible value range is 0 (0 min) to 255 (510 min or longer). The value is specified by the vendor of the DALI control gear and can only be read. This variable can be read out with the function block FB_DALI202Query Rated Duration [} 281]. emergency Mode This variable contains information about the current operation mode of the DALI control gear. The variable can be read out with the function block FB_DALI202Query Emergency Mode [} 272]. Bit Description 0 Reset mode 1 Emergency mode readiness (normal operation) 2 Emergency mode 3 Extended emergency mode once mains voltage is available again 4 Function test active 5 Duration test active 6 Connected suppress push button is active 7 Connected switch active features This variable contains information about the implemented optional properties. The variable can be read out with the function block FB_DALI202Query Features [} 277]. Bit Description 0 Integrated emergency lighting supply unit 1 Emergency lighting supply unit in continuous mode 2 Switchable emergency lighting supply unit 3 Automatic testing is supported 4 Intensity of the emergency lighting is adjustable 5 Connected suppress push button is supported 6 Addressing by physical selection is supported 7 Switching back to emergency mode is supported 288 Version: 1.20.0 TE1000
## Page 289

Programming failure Status This variable contains possible error states from the function test or the duration test. The variable can be read out with the function block FB_DALI202Query Failure Status [} 275]. Bit Description 0 Error in the DALI control gear circuit 1 Battery operation time fault 2 Battery fault 3 Emergency lamp fault 4 Timeout during function test 5 Timeout during duration test 6 Function test failed 7 Duration test failed emergency Status This variable contains current information about emergency operation from the DALI control gear. The variable can be read out with the function block FB_DALI202Query Emergency Status [} 274]. Bit Description 0 Inhibit mode 1 Function test is completed and result is valid 2 Duration test is completed and result is valid 3 Battery charger ready for operation 4 Start of function test delayed 5 Start of duration test delayed 6 Identification active 7 Selected during addressing by physical selection 4.1.2.4 Part 205 (incandescent lamps) 4.1.2.4.1 Configuration commands 4.1.2.4.1.1 FB_DALI205Select Dimming Curve The function block stores the value e Dimming Curve in the variable dimming Curve [} 308] of the DALI control gear. This also changes the value of the Delay Time. Prior to the DALI command SELECT DIMMING CURVE, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SELECT DIMMING CURVE twice, as required by the DALI standard for certain DALI commands. TE1000 Version: 1.20.0 289
## Page 290

Programming The function block changes the DTR0 of all connected DALI control gears. Inputs Var_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Dimming Curve E_DALIDimming Curve Linear or standard dimming curve (see E_DALIDimming Curve [} 908]) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 290 Version: 1.20.0 TE1000
## Page 291

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2 Query commands 4.1.2.4.2.1 FB_DALI205Query Dimmer Status The function block reads the current operation mode from the DALI control gear (see dimmer Status [} 308]). Prior to the DALI command QUERY DIMMER STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Dimmer Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 291
## Page 292

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Dimmer Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Dimmer Status BYTE Returns the current operation mode (see dimmer Status [} 308]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2.2 FB_DALI205Query Dimmer Temperature The function block reads the current operating temperature from the DALI control gear (see dimmer Temperature [} 310]). b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY DIMMER TEMPERATURE, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Dimmer Temperature only contains a valid value if the function block was executed without errors (b Error = FALSE). 292 Version: 1.20.0 TE1000
## Page 293

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Dimmer Temperature : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Dimmer Temperatur BYTE Returns the current operating temperature (see e dimmer Temperature [} 310]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 293
## Page 294

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2.3 FB_DALI205Query Dimming Curve The function block reads the set dimming curve from the DALI control gear (see dimming Curve [} 308]). Prior to the DALI command QUERY DIMMING CURVE, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output e Dimming Curve contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Dimming Curve : E_DALI_Dimming Curve; END_VAR 294 Version: 1.20.0 TE1000
## Page 295

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Dimming Curve BYTE Returns the currently set dimming curve (see E_DALIDimming Curve [} 908]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2.4 FB_DALI205Query Failure Status The function block reads the failure status from the DALI control gear (see failure Status [} 309]). Prior to the DALI command QUERY FAILURE STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Failure Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 295
## Page 296

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Failure Status : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Failure Status WORD Returns the failure status (see failure Status [} 309]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 296 Version: 1.20.0 TE1000
## Page 297

Programming 4.1.2.4.2.5 FB_DALI205Query Features The function block reads the implemented properties from the DALI control gear (see dimmer Features [} 309]). Prior to the DALI command QUERY FEATURES, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Features contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Features : DWORD; END_VAR TE1000 Version: 1.20.0 297
## Page 298

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Features DWORD Returns information about the implemented features (see dimmer Features [} 309]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2.6 FB_DALI205Query Load Rating The function block reads the maximum permissible root mean square of the load current from the DALI control gear (see load Rating [} 311]). b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY LOAD RATING, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Load Rating contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 298 Version: 1.20.0 TE1000
## Page 299

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Load Rating : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Load Rating BYTE Returns the maximum permissible root mean square of the load current (see load Rating [} 311]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 299
## Page 300

Programming 4.1.2.4.2.7 FB_DALI205Query Real Load Power The function block reads the current active power of the load from the DALI control gear (see real Load Power [} 311]). b Error is set to TRUE if the DALI control gear returns the value 65535 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY REAL LOAD POWER, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Real Load Power only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Real Load Power : UINT; END_VAR 300 Version: 1.20.0 TE1000
## Page 301

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Real Load Power UINT Returns the current active power of the load (see real Load Power [} 311]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2.8 FB_DALI205Query RMSLoad Current The function block reads the root mean square of the load current from the DALI control gear (rms Load Current [} 311]). b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY RMS LOAD CURRENT, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n RMSLoad Current only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 301
## Page 302

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n RMSLoad Current : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n RMSLoad Current BYTE Returns the root mean square of the load current (see rms Load Current [} 311]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 302 Version: 1.20.0 TE1000
## Page 303

Programming 4.1.2.4.2.9 FB_DALI205Query RMSLoad Voltage The function block reads the root mean square of the load voltage from the DALI control gear (see rms Load Voltage [} 310]). b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY RMS LOAD VOLTAGE, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n RMSLoad Voltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n RMSLoad Voltage : BYTE; END_VAR TE1000 Version: 1.20.0 303
## Page 304

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n RMSLoad Voltage BYTE Returns the root mean square of the load voltage (see rms Load Voltage [} 310]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.1.2.4.2.10 FB_DALI205Query RMSSupply Voltage The function block reads out the root mean square of the supply voltage from the DALI control gear (see rms Supply Voltage [} 310]). b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY RMS SUPPLY VOLTAGE, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n RMSSupply Voltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 304 Version: 1.20.0 TE1000
## Page 305

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n RMSSupply Voltage : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n RMSSupply Voltage BYTE Returns the root mean square of the supply voltage (see rms Supply Voltage [} 310]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 305
## Page 306

Programming 4.1.2.4.2.11 FB_DALI205Query Supply Frequency The function block reads the current frequency of the supply voltage from the DALI control gear (see supply Frequency [} 310]). b Error is set to TRUE if the DALI control gear returns the value 255 (MASK). In this case, the value cannot be determined by the DALI control gear. Prior to the DALI command QUERY SUPPLY FREQUENCY, the function block sends the DALI command ENABLE DEVICE TYPE 4, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Supply Frequency only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Supply Frequency : BYTE; END_VAR 306 Version: 1.20.0 TE1000
## Page 307

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Supply Frequency BYTE Returns the current frequency of the supply voltage (see supply Frequency [} 310]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 TE1000 Version: 1.20.0 307
## Page 308

Programming 4.1.2.4.3 Variables Name Reset value Scope Size Comments dimming Curve E_DALIDimming Cur E_DALIDimming Cur 1 byte ve. Standard ve. Standard, [} 308] E_DALIDimming Cur ve. Linear dimmer Status no change, except 16#00…16#FF 1 byte read only bit 4 is set to FALSE [} 308] dimmer Features No change 16#00_00_00… 3 bytes read only 16#FF_FF_FF [} 309] failure Status [} 309] No change 16#00_00… 2 byte read only 16#FF_FF dimmer Temperature No change 0…255 1 byte read only [} 310] rms Supply Voltage No change 0…255 1 byte read only [} 310] supply Frequency No change 0…255 1 byte read only [} 310] rms Load Voltage No change 0…255 1 byte read only [} 310] rms Load Current No change 0…255 1 byte read only [} 311] real Load Power No change 0…6535 2 byte read only [} 311] load Rating [} 311] No change 0…255 1 byte read only dimming Curve The variable specifies the type of dimming curve. The variable can be written with the function block FB_DALI205Select Dimming Curve [} 289] and read with the function block FB_DALI205Query Dimming Curve [} 294]. E_DALIDimming Curve Description Standard Standard dimming curve Linear Linear dimming curve dimmer Status The variable contains information about the current operation mode of the DALI control gear. The variable can be read with the function block FB_DALI205Query Dimmer Status [} 291]. Bit Description 0 Leading edge phase control active 1 Trailing edge phase control active 2 Reserve 3 Reserve 4 Linear dimming curve active 5 Reserve 6 Reserve 7 Reserve 308 Version: 1.20.0 TE1000
## Page 309

Programming dimmer Features The variable contains information about the implemented properties of the DALI control gear. The variable can be read with the function block FB_DALI205Query Features [} 297]. Bit Description 0 Load overcurrent shutdown can be queried 1 Idle detection (no load) can be queried 2 Reserve 3 Reserve 4 Reserve 5 Thermal shutdown can be queried 6 Reduction of the output level due to thermal overload can be queried 7 Reserve 8 Operating temperature can be queried 9 Supply voltage can be queried 10 Frequency of the supply voltage can be queried 11 Load voltage can be queried 12 Load current can be queried 13 Active power of the load can be queried 14 Maximum permissible load current can be queried 15 Reduction of the output level due to load overcurrent can be queried 16 Supported dimming methods (see table below) 17 Supported dimming methods (see table below) 18 Reserve 19 Linear dimming curve can be selected 20 Reserve 21 Reserve 22 Reserve 23 A load that is not compatible for the DALI control gear can be queried Bit 16 and bit 17 define the supported dimming methods: Bit 17 Bit 16 Meaning 0 0 Leading edge phase control and trailing edge phase control 0 1 Leading edge phase control 1 0 Trailing edge phase control 1 1 Sine curve failure Status The variable contains information about the failure status. The variable can be read with the function block FB_DALI205Query Failure Status [} 295]. TE1000 Version: 1.20.0 309
## Page 310

Programming Bit Description 0 Shutdown due to load overcurrent 1 Idle (no load) detected 2 Reserve 3 Reserve 4 Reserve 5 Thermal shutdown 6 Thermal overload with output level reduction 7 Reserve 8 Shutdown because the load is not suitable for the selected dimming method. 9 Limit violation supply voltage 10 Limit violation frequency of the supply voltage 11 Limit violation load voltage 12 Reduction of the output level due to load overcurrent 13 Reserve 14 Reserve 15 Reserve dimmer Temperature The variable contains the operating temperature. The value is given in steps of 1 °C. The permissible value range is 0 (-40 °C) to 254 (214 °C). If the value 255 (MASK) is returned, the operating temperature is unknown. The variable can be read with the function block FB_DALI205Query Dimmer Temperature [} 292]. Bit 8 of dimmer Features [} 309] can be used to query whether reading of the operating temperature is supported. rms Supply Voltage The variable contains the root mean square of the supply voltage. The value is given in steps of 2 V. The permissible value range is 0 (0 V) to 254 (508 V). If the value 255 (MASK) is returned, the supply voltage is unknown. The variable can be read with the function block FB_DALI205Query RMSSupply Voltage [} 304]. Bit 9 of dimmer Features [} 309] can be used to query whether reading of the supply voltage is supported. supply Frequency The variable contains the current frequency of the supply voltage. The value is given in steps of 0.5 Hz. The permissible value range is 0 (0 Hz) to 254 (127 Hz). If the value 255 (MASK) is returned, the frequency is unknown. The variable can be read with the function block FB_DALI205Query Supply Frequency [} 306]. Bit 10 of dimmer Features [} 309] can be used to query whether reading of the frequency is supported. rms Load Voltage The variable contains the root mean square of the load voltage. The value is given in steps of 2 V. The permissible value range is 0 (0 V) to 254 (508 V). If the value 255 (MASK) is returned, the load voltage is unknown. 310 Version: 1.20.0 TE1000
## Page 311

Programming The variable can be read with the function block FB_DALI205Query RMSLoad Voltage [} 303]. Bit 11 of dimmer Features [} 309] can be used to query whether reading of the load voltage is supported. rms Load Current The variable contains the root mean square of the load current in relation to the maximum load current (see load Rating [} 311]). The value is given in steps of 0.5 %. The permissible value range is 0 (0 %) to 254 (127 %). If the value 255 (MASK) is returned, the load current is unknown. The variable can be read with the function block FB_DALI205Query RMSLoad Current [} 301]. Bit 12 of dimmer Features [} 309] can be used to query whether reading of the load current is supported. real Load Power The variable contains the active power of the load. The value is given in steps of 0.25 W. The permissible value range is 0 (0 W) to 65534 (16383.5 W). If the value 65535 (MASK) is returned, the active power is unknown. The variable can be read with the function block FB_DALI205Query Real Load Power [} 300]. Bit 13 of dimmer Features [} 309] can be used to query whether reading of the active power is supported. load Rating The variable contains the maximum permissible root mean square of the load current. The value is given in steps of 150 m A. The permissible value range is 0 (0 A) to 254 (38.1 A). If the value 255 (MASK) is returned, the maximum permissible load current is unknown. The variable can be read with the function block FB_DALI205Query Real Load Rating [} 298]. Bit 14 of dimmer Features [} 309] can be used to query whether reading of the maximum permissible load current is supported. 4.1.2.5 Part 207 (LED modules) 4.1.2.5.1 Introduction IEC 62386-207 describes DALI control gears for controlling LED modules. This part includes functions that go beyond IEC 62386-102 for controlling LED modules. Functionality The Tc3_DALI library offers function blocks for setting various parameters: • Referencing system performance to detect a significant increase or drop. • Dimming curve (standard or linear) • Fast Fade Time (see fast Fade Time [} 335]) Furthermore, the Tc3_DALI library contains function blocks for querying various parameters: • Device type (see Control Gear Type [} 335]) • Dimming curve (see dimming Curve [} 336]) • Querying the failure status (see failure Status [} 335]) • Fast Fade Time (see fast Fade Time [} 335] or min Fast Fade Time [} 334]) TE1000 Version: 1.20.0 311
## Page 312

Programming • Device-specific features (see Features [} 335]) • Checking the load deviation • Querying the referencing 4.1.2.5.2 Configuration commands 4.1.2.5.2.1 FB_DALI207Reference System Power The DALI control gear measures and stores the performance level of the system, in order to detect load increase and decrease. Prior to the DALI command REFERENCE SYSTEM POWER, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command REFERENCE SYSTEM POWER twice, as foreseen by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 312 Version: 1.20.0 TE1000
## Page 313

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.2.2 FB_DALI207Select Dimming Curve The function block saves the value e Dimming Curve in the variable dimming Curve [} 336] of the DALI control gear. Prior to the DALI command SELECT DIMMING CURVE, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SELECT DIMMING CURVE twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; TE1000 Version: 1.20.0 313
## Page 314

Programming e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Dimming Curve : E_DALIDimming Curve := E_DALIDimming Curve. Standard; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Dimming Curve E_DALIDimming Curve Standard or linear dimming curve [} 908] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 314 Version: 1.20.0 TE1000
## Page 315

Programming 4.1.2.5.2.3 FB_DALI207Set Fast Fade Time The function block saves the value e Fast Fade Time in the variable fast Fade Time [} 335] of the DALI control gear. The fast Fade Time is used in the function blocks FB_DALI102Direct Arc Power Control [} 82] and FB_DALI102Go To Scene [} 87]. Prior to the DALI command SET FAST FADE TIME, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET FAST FADE TIME twice, as required by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Fast Fade Time : E_DALIFast Fade Time := E_DALIFast Fade Time. Disabled; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Fast Fade Time E_DALIFast Fade Time Fast fade time for changing the output value. [} 910] TE1000 Version: 1.20.0 315
## Page 316

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3 Query commands 4.1.2.5.3.1 FB_DALI207Query Control Gear Type The function block reads the variable control Gear Type [} 335] from the DALI control gear. Prior to the DALI command QUERY CONTROL GEAR TYPE, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Control Gear Type contains a valid value only if the function block was executed without errors (b Error = FALSE). 316 Version: 1.20.0 TE1000
## Page 317

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Type : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Type BYTE Outputs the value of the variable control Gear Type (0… 255). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 317
## Page 318

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3.2 FB_DALI207Query Dimming Curve The function block reads the set dimming curve from the DALI control gear (see dimming Curve [} 336]). Prior to the DALI command QUERY DIMMING CURVE, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output e Dimming Curve contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Dimming Curve : E_DALIDimming Curve; END_VAR 318 Version: 1.20.0 TE1000
## Page 319

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Dimming Curve E_DALIDimming Curve Returns the currently set dimming curve. [} 908] Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3.3 FB_DALI207Query Failure Status The function block reads the failure status from the DALI control gear (see failure Status [} 335]). Prior to the DALI command QUERY FAILURE STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Failure Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 319
## Page 320

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Failure Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Failure Status BYTE Returns the failure status (see failure Status [} 335]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 320 Version: 1.20.0 TE1000
## Page 321

Programming 4.1.2.5.3.4 FB_DALI207Query Fast Fade Time The function block reads the variable fast Fade Time [} 335] from the DALI control gear. The fast Fade Time is used in the function blocks FB_DALI102Direct Arc Power Control [} 82] and FB_DALI102Go To Scene [} 87]. Prior to the DALI command QUERY FAST FADE TIME, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output e Fast Fade Time contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Fast Fade Time : E_DALIFast Fade Time; END_VAR TE1000 Version: 1.20.0 321
## Page 322

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Fast Fade Time E_DALIFast Fade Time Output value of fast Fade Time. [} 910] Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3.5 FB_DALI207Query Features The function block reads the variable features [} 335] from the DALI control gear. Prior to the DALI command QUERY FEATURES, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Features contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 322 Version: 1.20.0 TE1000
## Page 323

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Features : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Features BYTE Returns information about the implemented features (see features [} 335]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 323
## Page 324

Programming 4.1.2.5.3.6 FB_DALI207Query Load Decrease The function block queries whether a significant load decrease (in comparison with the reference power of the system) has been detected. Prior to the DALI command QUERY LOAD DECREASE, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output b Load Decrease contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Load Decrease : BOOL; END_VAR 324 Version: 1.20.0 TE1000
## Page 325

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Type BOOL Detection of a significant load decrease. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3.7 FB_DALI207Query Load Increase The function block queries whether a significant load increase (in comparison with the reference power of the system) has been detected. Prior to the DALI command QUERY LOAD INCREASE, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output b Load Increase contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 325
## Page 326

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Load Increase : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Load Increase BOOL Detection of a significant load increase. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 326 Version: 1.20.0 TE1000
## Page 327

Programming 4.1.2.5.3.8 FB_DALI207Query Min Fast Fade Time The function block reads the variable min Fast Fade Time [} 334] from the DALI control gear. Prior to the DALI command MIN FAST FADE TIME, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output e Min Fast Fade Time contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; e Min Fast Fade Time : E_DALIFast Fade Time; END_VAR TE1000 Version: 1.20.0 327
## Page 328

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. e Min Fast Fade Time E_DALIFast Fade Time Outputs the minimum value of fast Fade Time. [} 910]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3.9 FB_DALI207Query Reference Measurement Failed The function block queries whether a started reference measurement has failed. Prior to the DALI command QUERY REFERENCE MEASUREMENT FAILED, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output b Reference Measurement Failed contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 328 Version: 1.20.0 TE1000
## Page 329

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Reference Measurement Failed : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Reference Measure BOOL Indicates whether the reference measurement failed. ment Failed Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 329
## Page 330

Programming 4.1.2.5.3.10 FB_DALI207Query Reference Running The function block queries whether a reference measurement of the system power is activated. Prior to the DALI command QUERY REFERENCE RUNNING, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output b Reference Running contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Reference Running : BOOL; END_VAR 330 Version: 1.20.0 TE1000
## Page 331

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Reference Running BOOL Indicates whether the reference measurement of the system performance is performed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.3.11 FB_DALI207Query Thermal Overload The function block queries whether there is a thermal overload with reduction of the output level. Prior to the DALI command QUERY THERMAL OVERLOAD, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output b Thermal Overload contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 331
## Page 332

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Thermal Overload : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Thermal Overload BOOL Indicates whether thermal overload is present. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 332 Version: 1.20.0 TE1000
## Page 333

Programming 4.1.2.5.3.12 FB_DALI207Query Thermal Shutdown The function block queries whether a thermal shutdown has taken place. Prior to the DALI command QUERY THERMAL SHUTDOWN, the function block sends the DALI command ENABLE DEVICE TYPE 6, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output b Thermal Shutdown contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Thermal Shutdown : BOOL; END_VAR TE1000 Version: 1.20.0 333
## Page 334

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Thermal Shutdown BOOL Indicates whether a thermal shutdown has taken place. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.5.4 Variables Name Reset value Scope Size Comment min Fast Fade Time No change E_DALIFast Fade Time. T100ms 1 byte Read only … [} 334] E_DALIFast Fade Time. T700ms fast Fade Time [} 335] E_DALIFast Fade Time. E_DALIFast Fade Time. Disabled, 1 byte Disabled min Fast Fade Time … E_DALIFast Fade Time. T700ms control Gear Type No change 0…255 1 byte Read only [} 335] features [} 335] No change 0…255 1 byte Read only failure Status [} 335] No change 0…255 1 byte Read only dimming Curve [} 336] E_DALIDimming Curve E_DALIDimming Curve. Standard, 1 byte . Standard E_DALIDimming Curve. Linear min Fast Fade Time The min Fast Fade Time specifies the shortest fade Time within which the output value of a DALI control gear behaves according to the selected dimming curve. Its value can lie between E_DALIFast Fade Time. T100ms and E_DALIFast Fade Time. T700ms. The value of the variable can be read out with the function block FB_DALI207Query Min Fast Fade Time [} 327]. 334 Version: 1.20.0 TE1000
## Page 335

Programming fast Fade Time The fastfade Time is used instead of the fade Time if the fade Time is equal to E_DALIFast Fade Time. Disabled. The fast Fade Time can be programmed to E_DALIFast Fade Time. Disabled or any value in the range between the value in the variable min Fast Fade Time and E_DALIFast Fade Time. T700ms. Programming the fast Fade Time to E_DALIFast Fade Time. Disabled means the fastest possible change of the output value. The variable has an effect on the DALI commands FB_DALI102Direct Arc Power Control [} 82], FB_DALI102Go To Scene [} 87] and FB_DALI102Go To Last Active Level [} 85]. The value of the variable can be read with the function block FB_DALI207Query Fast Fade Time [} 321] and changed with the function block FB_DALI207Set Fast Fade Time [} 315]. control Gear Type The variable contains information about the device type. The value of the variable can be read out with the function block FB_DALI207Query Control Gear Type [} 316]. Bit Description 0 Reserve 1 LED module integrated 2 Reserve 3 Reserve 4 Reserve 5 Reserve 6 Reserve 7 Reserve features The variable contains information about the implemented optional properties. The value of the variable can be read out with the function block FB_DALI207Query Features [} 322]. Bit Description 0 Reserve 1 Reserve 2 Detection of the load decrease can be queried 3 Detection of the load increase can be queried 4 Reserve 5 Thermal shutdown can be queried 6 Reduction of the output level due to thermal overload can be queried 7 Reserve failure Status The variable contains information about the failure status. The value of the variable can be read out with the function block FB_DALI207Query Failure Status [} 319]. TE1000 Version: 1.20.0 335
## Page 336

Programming Bit Description 0 Reserve 1 Reserve 2 Load decrease 3 Load increase 4 Reserve 5 Thermal shutdown 6 Thermal overload with output level reduction 7 Reference measurement failed dimming Curve The variable specifies the type of dimming curve. The value of the variable can be read out with the function block FB_DALI207Query Dimming Curve [} 318] and changed with the function block FB_DALI207Select Dimming Curve [} 313]. E_DALIDim- Description ming Curve Standard Standard dimming curve Linear Linear dimming curve 4.1.2.6 Part 208 (device for switching functions) 4.1.2.6.1 Introduction IEC 62386-208 describes DALI control gears with switching function. DALI control gears with switching function have a digital output (e.g. a relay). The digital output is switched via the DALI commands for changing the output value (DAPC, OFF, RECALL MIN LEVEL, RECALL MAX LEVEL, UP, DOWN, STEP UP, STEP DOWN, ...). These DALI commands do not directly change the actual Level [} 155] variable, but a virtual output value. Four different threshold values are used to determine at which value of the virtual output value the digital output is set or reset. If the digital output is active (TRUE), actual Level = 254. If this is inactive (FALSE), actual Level = 0. The value of the virtual output value cannot be queried. The reset values of the variables [} 355] are set so that setting the virtual output value to 0 resets the digital output and a value of 1...254 sets the digital output. The value 255 (MASK) has no effect on the digital output. Threshold values A total of four threshold values are available. Two threshold values (up Switch On Level [} 355] and up Switch Off Level [} 355]) define the switching points at an increasing virtual output value. While the other two threshold values (down Switch On Level [} 355] and down Switch Off Level [} 355]) determine when the output switches on a falling virtual output value. If a threshold value is not to have a function, it is set to 255 (MASK). In most applications, it is not practical to use all four threshold values. The following example shows how the digital output value behaves when the threshold values down Switch Off Level and up Switch On Level are used. The two threshold values down Switch On Level and up Switch Off Level have the value 255 (MASK) and are therefore without function. 336 Version: 1.20.0 TE1000
## Page 337

Programming The control direction can also be reversed by using the threshold values down Switch On Level and up Switch Off Level. In this case, down Switch Off Level and up Switch On Level are disabled. Note that the value of min Level according to IEC 62386-208 is 254, which is the same as max Level. This means that the virtual output value can only assume the values 0 and 254. Depending on the threshold value, it may also be necessary to adjust min Level. TE1000 Version: 1.20.0 337
## Page 338

Programming 4.1.2.6.2 Configuration commands 4.1.2.6.2.1 FB_DALI208Set Down Switch Off Threshold The function block stores the value n Down Switch Off Threshold in the variable down Switch Off Threshold [} 355] of the DALI control gear. The output from the DALI control gear is reset as soon as the falling virtual output value reaches or falls below the threshold value down Switch Off Threshold. With the value n Down Switch Off Threshold = 255 (MASK) the threshold is disabled. The DALI command is only supported by the DALI control gear if bit 3 of features [} 355] is set. Prior to the DALI command SET DOWN SWITCH-OFF THRESHOLD, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET DOWN SWITCH-OFF THRESHOLD twice, as foreseen by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Down Switch Off Threshold : BYTE := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 338 Version: 1.20.0 TE1000
## Page 339

Programming Name Type Description n Down Switch Off Thr BYTE Threshold value (0…255) for switching off the output with a eshold falling virtual output value. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.2.2 FB_DALI208Set Down Switch On Threshold The function block stores the value n Down Switch On Threshold in the variable down Switch On Threshold [} 355] of the DALI control gear. The output from the DALI control gear is set as soon as the falling virtual output value reaches or falls below the threshold value down Switch On Threshold. With the value n Down Switch On Threshold = 255 (MASK) the threshold is disabled. The DALI command is only supported by the DALI control gear if bit 3 of features [} 355] is set. TE1000 Version: 1.20.0 339
## Page 340

Programming Prior to the DALI command SET DOWN SWITCH-ON THRESHOLD, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET DOWN SWITCH-ON THRESHOLD twice, as foreseen by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Down Switch On Threshold : BYTE := 255; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Down Switch On Thr BYTE Threshold value (0…255) for switching on the output with a eshold falling virtual output value. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 340 Version: 1.20.0 TE1000
## Page 341

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.2.3 FB_DALI208Set Up Switch Off Threshold The function block stores the value n Up Switch Off Threshold in the variable up Switch Off Threshold [} 355] of the DALI control gear. The output from the DALI control gear is reset as soon as the rising virtual output value reaches or exceeds the threshold value up Switch Off Threshold. With the value n Up Switch Off Threshold = 255 (MASK) the threshold is disabled. The DALI command is only supported by the DALI control gear if bit 3 of features [} 355] is set. Prior to the DALI command SET UP SWITCH-OFF THRESHOLD, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET UP SWITCH-OFF THRESHOLD twice, as foreseen by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. TE1000 Version: 1.20.0 341
## Page 342

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Up Switch Off Threshold : BYTE := 255; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Up Switch Off Thresh BYTE Threshold value (0…255) for switching off the output with a old rising virtual output value. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 342 Version: 1.20.0 TE1000
## Page 343

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.2.4 FB_DALI208Set Up Switch On Threshold The function block stores the value n Up Switch On Threshold in the variable up Switch On Threshold [} 355] of the DALI control gear. The output from the DALI control gear is set as soon as the rising virtual output value reaches or exceeds the threshold value up Switch On Threshold. With the value n Up Switch On Threshold = 255 (MASK) the threshold is disabled. The DALI command is only supported by the DALI control gear if bit 3 of features [} 355] is set. Prior to the DALI command SET UP SWITCH-ON THRESHOLD, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block sends the DALI command SET UP SWITCH-ON THRESHOLD twice, as foreseen by the DALI standard for certain DALI commands. The function block changes the DTR0 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Up Switch On Threshold : BYTE := 255; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 343
## Page 344

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Up Switch On Thresh BYTE Threshold value (0…255) for switching on the output with a old rising virtual output value. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.3 Query commands 4.1.2.6.3.1 FB_DALI208Query Down Switch Off Threshold The function block reads the variable down Switch Off Threshold [} 355] from the DALI control gear. The output from the DALI control gear is reset as soon as the falling virtual output value reaches or falls below the threshold value down Switch Off Threshold. 344 Version: 1.20.0 TE1000
## Page 345

Programming Prior to the DALI command QUERY DOWN SWITCH-OFF, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Down Switch Off Threshold only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Down Switch Off Threshold : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Down Switch Off Thr BYTE Threshold value (0…255) for switching off the output with a eshold falling virtual output value. TE1000 Version: 1.20.0 345
## Page 346

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.3.2 FB_DALI208Query Down Switch On Threshold The function block reads the variable down Switch On Threshold [} 355] from the DALI control gear. The output from the DALI control gear is set as soon as the falling virtual output value reaches or falls below the threshold value down Switch On Threshold. Prior to the DALI command QUERY DOWN SWITCH-ON, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Down Switch On Threshold only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 346 Version: 1.20.0 TE1000
## Page 347

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Down Switch On Threshold : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Down Switch On Thr BYTE Threshold value (0…255) for switching on the output with a eshold falling virtual output value. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.3.3 FB_DALI208Query Features The function block reads the variable features [} 355] from the DALI control gear. Prior to the DALI command QUERY FEATURES, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Features contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; TE1000 Version: 1.20.0 347
## Page 348

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Features : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Features BYTE Contains information about the implemented features (see features [} 355]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 348 Version: 1.20.0 TE1000
## Page 349

Programming 4.1.2.6.3.4 FB_DALI208Query Gear Type The function block reads the variable gear Type [} 356] from the DALI control gear. Prior to the DALI command QUERY GEAR TYPES, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Gear Type only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Gear Type : BYTE; END_VAR TE1000 Version: 1.20.0 349
## Page 350

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Gear Type BYTE Contains information about the properties of the DALI control gear (see gear Type [} 356]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.3.5 FB_DALI208Query Switch Status The function block reads the variable switch Status [} 356] from the DALI control gear. Prior to the DALI command QUERY SWITCH STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Switch Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 350 Version: 1.20.0 TE1000
## Page 351

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Switch Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Switch Status BYTE Returns additional information on the current status of the DALI control gear (see switch Status [} 356]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 TE1000 Version: 1.20.0 351
## Page 352

Programming 4.1.2.6.3.6 FB_DALI208Query Up Switch Off Threshold The function block reads the variable up Switch Off Threshold [} 355] from the DALI control gear. The output from the DALI control gear is reset as soon as the rising virtual output value reaches or exceeds the threshold value up Switch Off Threshold. The threshold value is disabled if a value of 255 (MASK) is returned. Prior to the DALI command QUERY UP SWITCH-OFF, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Up Switch Off Threshold only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Up Switch Off Threshold : BYTE; END_VAR 352 Version: 1.20.0 TE1000
## Page 353

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Up Switch Off Thresh BYTE Threshold value (1…255) for switching off with a rising old virtual output value. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.2.6.3.7 FB_DALI208Query Up Switch On Threshold The function block reads the variable up Switch On Threshold [} 355] from the DALI control gear. The output from the DALI control gear is set as soon as the rising virtual output value reaches or exceeds the threshold value up Switch On Threshold. The threshold value is disabled if a value of 255 (MASK) is returned. Prior to the DALI command QUERY UP SWITCH-ON, the function block sends the DALI command ENABLE DEVICE TYPE 7, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Up Switch On Threshold only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 353
## Page 354

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Up Switch On Threshold : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Up Switch On Thresh BYTE Threshold value (1…255) for switching on with a rising old virtual output value. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 354 Version: 1.20.0 TE1000
## Page 355

Programming 4.1.2.6.4 Variables Name Reset value Scope Size Comment up Switch On Level 1 1…255 1 byte [} 355] up Switch Off Level 255 1…255 1 byte [} 355] down Switch On Level 255 0…255 1 byte [} 355] down Switch Off Level 0 0…255 1 byte [} 355] features [} 355] No change 0…255 1 byte Read only gear Type [} 356] No change 0…255 1 byte Read only switch Status [} 356] No change 0…255 1 byte Read only up Switch On Level This variable is the threshold value (1…255) for switching on the output with a rising virtual output value. The threshold value is disabled with the value 255 (MASK). If bit 3 of features is set, the variable up Switch On Level can be set with the function block FB_DALI208Set Up Switch On Threshold [} 343]. The variable can be read with the function block FB_DALI208Query Up Switch On Threshold [} 353]. up Switch Off Level This variable is the threshold value (1…255) for switching off the output with a rising virtual output value. The threshold value is disabled with the value 255 (MASK). If bit 3 of features is set, the variable up Switch Off Level can be set with the function block FB_DALI208Set Up Switch Off Threshold [} 341]. The variable can be read with the function block FB_DALI208Query Up Switch Off Threshold [} 352]. down Switch On Level This variable is the threshold value (0…255) for switching on the output with a falling virtual output value. The threshold value is disabled with the value 255 (MASK). If bit 3 of features is set, the variable down Switch On Level can be set with the function block FB_DALI208Set Down Switch On Threshold [} 339]. The variable can be read with the function block FB_DALI208Query Down Switch On Threshold [} 346]. down Switch Off Level This variable is the threshold value (0…255) for switching off the output with a falling virtual output value. The threshold value is disabled with the value 255 (MASK). If bit 3 of features is set, the variable down Switch Off Level can be set with the function block FB_DALI208Set Down Switch Off Threshold [} 338]. The variable can be read with the function block FB_DALI208Query Down Switch Off Threshold [} 344]. features The variable contains information about the implemented properties of the DALI control gear. The variable can be read with the function block FB_DALI208Query Features [} 347]. TE1000 Version: 1.20.0 355
## Page 356

Programming Bit Description 0 reserve 1 reserve 2 reserve 3 Changeable threshold values. 4 reserve 5 reserve 6 reserve 7 Addressing of the physical selection is supported. gear Type The variable contains information about the properties of the DALI control gear. The variable can be read with the function block FB_DALI208Query Gear Type [} 349]. Bit Description 0 The output is an electronic switch. 1 The output is a relay with make contact. 2 The output is a relay with break contact. 3 The output has electronic voltage protection. 4 The input inrush current is limited. 5 Reserve 6 Reserve 7 Reserve switch Status The variable returns additional information on the current state of the DALI control gear. The variable can be read with the function block FB_DALI208Query Switch Status [} 350]. Bit Description 0 reserve 1 reserve 2…3 Last threshold value that was reached or exceeded: 00: up Switch On Threshold 01: up Switch Off Threshold 10: down Switch On Threshold 11: down Switch Off Threshold 4 reserve 5 reserve 6 reserve 7 reserve 4.1.2.7 Part 209 (color/color temperature control) 4.1.2.7.1 Introduction IEC 62386-209 describes DALI control gears for color or color temperature control. 356 Version: 1.20.0 TE1000
## Page 357

Programming Representation of the color temperature The black-body line (BBL) or Planck curve runs within the CIE standard color chart, which represents the possible color space. Values on this curve correspond to a white hue specified in Kelvin. The higher the value, the colder the light is perceived. Light sources from this range combine LEDs of different color temperatures on one board. This allows the lighting effect of, for example, Human Centric Lighting (HCL) to be adjusted throughout the day. It may be necessary to use different color temperatures for the presentation of different goods (e.g. food, colorful or bright backgrounds). Mirek and Kelvin In IEC 62386, the Mirek unit is used to specify the color temperature T . The function blocks of the Tc3_DALI C library also use this unit. The color temperature values can be converted using the functions KELVIN_TO_MIREK [} 419] and MIREK_TO_KELVIN [} 419]. 4.1.2.7.2 Configuration commands 4.1.2.7.2.1 FB_DALI209Assign Colour To Linked Channel Linked output channels are assigned to the defined color (see table). The linked channels are specified by bits 0 to 5 of the variable temporary RGBWAFControl [} 425]. The channel assignment is not changed if temporary RGBWAFControl [} 425] contains the value 255 (MASK). All TEMPORARY COLOUR SETTINGS are set to MASK after the use of this command. TE1000 Version: 1.20.0 357
## Page 358

Programming Value Description 0 No color assigned 1 Red 2 Green 3 Blue 4 White 5 Amber 6 Freely selectable color The function block changes the DTR0 of all connected DALI control gears. The function block supports the following color representations: • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Colour : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Colour USINT Color value that is assigned to a channel (see table). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 358 Version: 1.20.0 TE1000
## Page 359

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.2.2 FB_DALI209Set Power On Values The function block saves the values n Power On Level and e Colour Type in the variables power On Level [} 155] and power On Colour Type [} 424] of the DALI control gear. In addition, depending on the value of e Colour Type, the values of the inputs are written to the corresponding variables. Prior to the DALI command SET POWER ON LEVEL, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). TE1000 Version: 1.20.0 359
## Page 360

Programming The function block changes the DTR0 and the DTR1 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Power On Level : USINT := 254; e Colour Type : E_DALIColour Type := E_DALIColour Type. MASK; n XCoordinate : UINT; n YCoordinate : UINT; n Colour Temperature Tc : UINT := 65534; n Primary Colour0 : UINT; n Primary Colour1 : UINT; n Primary Colour2 : UINT; n Primary Colour3 : UINT; n Primary Colour4 : UINT; n Primary Colour5 : UINT; n Red Dim Level : USINT; n Green Dim Level : USINT; n Blue Dim Level : USINT; n White Dim Level : USINT; n Amber Dim Level : USINT; n Free Colour Dim Level : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 360 Version: 1.20.0 TE1000
## Page 361

Programming Name Type Description n Power On Level USINT Switch-on value (0…255) e Colour Type E_DALIColour Type Defines the color setting with which the function block is operated (see colour Type [} 424]). MASK prevents the color representation from being changed. n XCoordinate UINT Input of the x-value of the color representation according to xy color type (see X-coordinate [} 423]) in the color setting Xy coordinates (see color representation [} 423]). n YCoordinate UINT Input of the y-value of the color representation according to xy color type (see Y-coordinate [} 424]) in the color setting Xy coordinates (see color representation [} 423]). n Colour Temperature UINT Input of the desired color temperature (see Tc colour Temperature Tc [} 424]) in the setting Color temperature Tc (see color representation [} 423]). n Primary Colour N UINT Input of the color representation on the corresponding output channel on the operating device in the color setting Primary color N (see color representation [} 423]). n Red Dim Level USINT Setting of the red dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Green Dim Level USINT Setting of the green dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Blue Dim Level USINT Setting of the blue dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n White Dim Level USINT Setting of the white dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Amber Dim Level USINT Setting of the amber dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Free Colour Dim Lev USINT Setting of the dimming level of the freely selectable color el (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 361
## Page 362

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.2.3 FB_DALI209Set Scene The function block can be used to assign a specific lighting value to a scene. Prior to the DALI command SET SCENE, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see FB_DALI102Enable Device Type [} 130]) and SET TEMPORARY COLOUR TEMPERATURE TC. 362 Version: 1.20.0 TE1000
## Page 363

Programming The function block changes the DTR0 and the DTR1 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Scene Level : USINT; n Scene : USINT; e Colour Type : E_DALIColour Type := E_DALIColour Type. MASK; n XCoordinate : UINT; n YCoordinate : UINT; n Colour Temperature Tc : UINT := 65534; n Primary Colour0 : UINT; n Primary Colour1 : UINT; n Primary Colour2 : UINT; n Primary Colour3 : UINT; n Primary Colour4 : UINT; n Primary Colour5 : UINT; n Red Dim Level : USINT; n Green Dim Level : USINT; n Blue Dim Level : USINT; n White Dim Level : USINT; n Amber Dim Level : USINT; n Free Colour Dim Level : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 363
## Page 364

Programming Name Type Description n Scene Level USINT Output value of the desired scene (0…255). n Scene USINT Scene whose output value is to be changed (0…15). e Colour Type E_DALIColour Type Defines the color setting with which the function block is operated (see colour Type [} 424]). MASK prevents the color representation from being changed. n XCoordinate UINT Input of the x-value of the color representation according to xy color type (see X-coordinate [} 423]) in the color setting Xy coordinates (see color representation [} 423]). n YCoordinate UINT Input of the y-value of the color representation according to xy color type (see Y-coordinate [} 424]) in the color setting Xy coordinates (see color representation [} 423]). n Colour Temperature UINT Input of the desired color temperature (see Tc colour Temperature Tc [} 424]) in the setting Color temperature Tc (see color representation [} 423]). n Primary Colour N UINT Input of the color representation on the corresponding output channel on the operating device in the color setting Primary color N (see color representation [} 423]). n Red Dim Level USINT Setting of the red dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Green Dim Level USINT Setting of the green dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Blue Dim Level USINT Setting of the blue dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n White Dim Level USINT Setting of the white dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Amber Dim Level USINT Setting of the amber dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Free Colour Dim Lev USINT Setting of the dimming level of the freely selectable color el (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 364 Version: 1.20.0 TE1000
## Page 365

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.2.4 FB_DALI209Set System Failure Values The function block writes the color representation and light intensity (n System Failure Level) of the light source to be used in the case of a system failure to the DALI control gear. Prior to the DALI command SET SYSTEM FAILURE LEVEL, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see FB_DALI102Enable Device Type [} 130]) and SET TEMPORARY COLOUR TEMPERATURE TC. TE1000 Version: 1.20.0 365
## Page 366

Programming The function block changes the DTR0 and the DTR1 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n System Failure Level : USINT := 254; e Colour Type : E_DALIColour Type := E_DALIColour Type. MASK; n XCoordinate : UINT; n YCoordinate : UINT; n Colour Temperature Tc : UINT := 65534; n Primary Colour0 : UINT; n Primary Colour1 : UINT; n Primary Colour2 : UINT; n Primary Colour3 : UINT; n Primary Colour4 : UINT; n Primary Colour5 : UINT; n Red Dim Level : USINT; n Green Dim Level : USINT; n Blue Dim Level : USINT; n White Dim Level : USINT; n Amber Dim Level : USINT; n Free Colour Dim Level : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. 366 Version: 1.20.0 TE1000
## Page 367

Programming Name Type Description n System Failure Leve USINT Output value in the case of a system failure (0…255). l e Colour Type E_DALIColour Type Defines the color setting with which the function block is operated (see colour Type [} 424]). MASK prevents the color representation from being changed. n XCoordinate UINT Input of the x-value of the color representation according to xy color type (see X-coordinate [} 423]) in the color setting Xy coordinates (see color representation [} 423]). n YCoordinate UINT Input of the y-value of the color representation according to xy color type (see Y-coordinate [} 424]) in the color setting Xy coordinates (see color representation [} 423]). n Colour Temperature UINT Input of the desired color temperature (see Tc colour Temperature Tc [} 424]) in the setting Color temperature Tc (see color representation [} 423]). n Primary Colour N UINT Input of the color representation on the corresponding output channel on the operating device in the color setting Primary color N (see color representation [} 423]). n Red Dim Level USINT Setting of the red dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Green Dim Level USINT Setting of the green dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Blue Dim Level USINT Setting of the blue dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n White Dim Level USINT Setting of the white dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Amber Dim Level USINT Setting of the amber dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Free Colour Dim Lev USINT Setting of the dimming level of the freely selectable color el (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 367
## Page 368

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.2.5 FB_DALI209Start Auto Calibration The calibration procedure is started in order to measure the x-coordinate, the y-coordinate and the TY value of all supported primary colors. The command starts a 15-minute timer or initiates it again. Bit 2 of the colour Status [} 425] variable is 1 as long as the timer is active (see FB_DALI209Query Colour Status [} 403]). On expiry of the timer the last color representation, the last color value and the last lamp power level are directly saved again. During the timer period the DALI control gear carries out a calibration procedure in order to measure the x- coordinate, the y-coordinate and the TY value of all supported primary colors. Whilst the calibration procedure is running, the DALI control gear does not react to any commands apart from TERMINATE, QUERY COLOUR STATUS and START AUTO CALIBRATION. In addition, bit 3 in the variable colour Status [} 425] is set to 0 at the start of the calibration. The TERMINATE command ends the procedure and stops the timer. If the calibration was successful, bit 3 in colour Status [} 425] is set to 1 and the timer is stopped. If the calibration was not successful, then the last successful calibration data are restored if the DALI control gear is able to do so. Bit 3 of color Status [} 425] is then set to 1. The ability to restore the last successful calibration data is a feature of the operating device (see FB_DALI209Query Gear Features Status [} 407] command). Due to the fact that the calibration can take longer than 15 minutes, the status of the automatic calibration should be checked periodically using the QUERY COLOR STATUS command and the calibration timer restarted with the START AUTO CALIBRATION command. The calibration procedure is started in order to measure the x-coordinate, the y-coordinate and the TY value of all supported primary colors. 368 Version: 1.20.0 TE1000
## Page 369

Programming The command starts a 15-minute timer or initiates it again. Bit 2 of the colour Status [} 425] variable is 1 as long as the timer is active (see FB_DALI209Query Colour Status [} 403]). On expiry of the timer the last color representation, the last color value and the last lamp power level are directly saved again. During the timer period the DALI control gear carries out a calibration procedure in order to measure the x- coordinate, the y-coordinate and the TY value of all supported primary colors. Whilst the calibration procedure is running, the DALI control gear does not react to any commands apart from TERMINATE, QUERY COLOUR STATUS and START AUTO CALIBRATION. In addition, bit 3 in the variable colour Status [} 425] is set to 0 at the start of the calibration. The TERMINATE command ends the procedure and stops the timer. If the calibration was successful, bit 3 in colour Status [} 425] is set to 1 and the timer is stopped. If the calibration was not successful, then the last successful calibration data are restored if the DALI control gear is able to do so. Bit 3 of color Status [} 425] is then set to 1. The ability to restore the last successful calibration data is a feature of the operating device (see FB_DALI209Query Gear Features Status [} 407] command). Due to the fact that the calibration can take longer than 15 minutes, the status of the automatic calibration should be checked periodically using the QUERY COLOR STATUS command and the calibration timer restarted with the START AUTO CALIBRATION command (if necessary). The function block supports the following color representations: • xy coordinates • Color temperature Tc • Primary (color) N • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 369
## Page 370

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.2.6 FB_DALI209Store Colour Temperature Tc Limit Depending on the specification of e Select Limit Value, the function block saves the value n Colour Temperature Tc Limit in the variables colour Temperature Tc Coolest, colour Temperature Tc Warmest, colour Temperature Tc Physical Coolest or colour Temperature Tc Physical Warmest of the DALI control gear. The values can be read with function block FB_DALI209Query Colour Value [} 406]. Prior to the DALI command STORE COLOUR TEMPERATURE Tc LIMIT, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control gears. The function block sends the DALI command STORE COLOUR TEMPERATURE Tc LIMIT twice, as foreseen by the DALI standard for certain DALI commands. 370 Version: 1.20.0 TE1000
## Page 371

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Select Limit Value : E_DALIColour Temperature Tc Limit; n Colour Temperature Tc Limit : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Select Limit Value E_DALIColour Temperature Specifies the limit value to be set. Tc Limit [} 904] n Colour Temperature UINT The value that is written into the selected variable. Tc Limit Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 371
## Page 372

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.2.7 FB_DALI209Store Gear Features Status The function block saves the value n Gear Features Status in the variable gear Features/Status [} 425] of the DALI control gear. The value can be read with the function block FB_DALI209Query Gear Features Status [} 407]. If Bit 0 is set to 1, all commands for controlling the lamp power – with the exception of ENABLE DAPC SEQUENCE – automatically initiate a color transition. Prior to the DALI command STORE GEAR FEATURES/STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0 of all connected DALI control gears. The function block sends the DALI command STORE GEAR FEATURES/STATUS twice, as foreseen by the DALI standard for certain DALI commands. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Gear Features Status : BYTE; END_VAR 372 Version: 1.20.0 TE1000
## Page 373

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Gear Features Statu BYTE Value written to the variable gear Features/Status [} 425]. s Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 373
## Page 374

Programming 4.1.2.7.2.8 FB_DALI209Store TYPrimary N The function block stores the value n TYPrimary N in the variable ty Primary N [} 424] of the DALI control gear. The value is expressed in units of 0.5 lm, which results in a possible range of TYmin = 0 lm to TYmax = 32767 lm. A value of 65535 (MASK) means "unknown". The n Primary Colour parameter specifies the primary color and must be within the range of 0 to 5, depending on the available number of primary colors. The command is ignored for every other value. The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control gears. The function block supports the following color representations: • Primary (color) N Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Primary Colour : USINT; n TYPrimary N : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Primary Colour USINT Primary color (0...5). n Ty Primary N UINT Value written to variable ty Primary N [} 424]. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 374 Version: 1.20.0 TE1000
## Page 375

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.2.9 FB_DALI209Store Xy Coordinate Primary N The function block copies the value from the variables temporary XCoordinate [} 423] and temporary YCoordinate [} 424] to the variables x Coordinate Primary N [} 424] and y Coordinate Primary N [} 424]. The n Primary Colour parameter specifies the primary color and must be within the range of 0 to 5, depending on the available number of primary colors. The command is ignored for every other value. This command can be used to store the current xy coordinates associated with the primary color. xy coordinates outside the color space chromaticity diagram are not meaningful and should therefore be avoided. The function block changes the DTR2 of all connected DALI control gears. The function block supports the following color representations: • Primary (color) N TE1000 Version: 1.20.0 375
## Page 376

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Primary Colour : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Primary Colour USINT Primary color (0...5). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 376 Version: 1.20.0 TE1000
## Page 377

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3 Control commands 4.1.2.7.3.1 FB_DALI209Activate The function block causes the buffered values of the temporary registers to be transferred to the lamp. It ends a running cross-fade and starts a new cross-fade for the respective color/color temperature. Prior to the DALI command ACTIVATE, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 377
## Page 378

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.3.2 FB_DALI209Colour Temperature Tc Step Cooler Due to the function block the value colour Temperature Tc [} 424] is reduced by 1 Mirek without cross-fading. If the colour Temperature Tc [} 424] value already has the same value as colour Temperature Tc Coolest [} 424], no change takes place. Bit 1 (Colour temperature Tc out of range) is set in colour Status [} 425] if the color temperature cannot be reached by the DALI control gear. This command is executed by the DALI control gear only if bit 5 (Colour type color temperature Tc active) is set in the variable colour Status [} 425]. The functions KELVIN_TO_MIREK [} 419] and MIREK_TO_KELVIN [} 419] are available for converting from or to Kelvin. Prior to the DALI command COLOUR TEMPERATURE Tc STEP COOLER, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 378 Version: 1.20.0 TE1000
## Page 379

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 379
## Page 380

Programming 4.1.2.7.3.3 FB_DALI209Colour Temperature Tc Step Warmer Due to the function block the value colour Temperature Tc [} 424] is increased by 1 Mirek without cross- fading. If the colour Temperature Tc [} 424] value already has the same value as colour Temperature Tc Warmest [} 424], no change takes place. Bit 1 (Colour temperature Tc out of range) is set in colour Status [} 425] if the color temperature cannot be reached by the DALI control gear. This command is executed by the DALI control gear only if bit 5 (Colour type color temperature Tc active) is set in the variable colour Status [} 425]. The functions KELVIN_TO_MIREK [} 419] and MIREK_TO_KELVIN [} 419] are available for converting from or to Kelvin. Prior to the DALI command COLOUR TEMPERATURE Tc STEP WARMER, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 380 Version: 1.20.0 TE1000
## Page 381

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.3.4 FB_DALI209Copy Report To Temporary The function block copies the contents of the variables with the color settings to the variables for the temporary color settings. Prior to the DALI command COPY REPORT TO TEMPORARY, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application-related extension commands (see also FB_DALI102Enable Device Type [} 130]). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 381
## Page 382

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 382 Version: 1.20.0 TE1000
## Page 383

Programming 4.1.2.7.3.5 FB_DALI209Set Colour Temperature Tc The function block saves the value n Colour Temperature Tc in the variable colour Temperature Tc [} 424] of the DALI control gear and causes the set color temperature to be applied to the lamp by executing the ACTIVATE command. The value can be read with function block FB_DALI209Query Colour Value [} 406]. The value is expressed in units of 1 Mirek. A value of 0 is ignored and therefore not saved. The color temperature Tc can vary from 1 Mirek (1000000 K) to 65534 Mirek (15.26 K). The functions KELVIN_TO_MIREK [} 419] and MIREK_TO_KELVIN [} 419] are available for converting from or to Kelvin. Prior to the DALI command SET TEMPORARY COLOUR TEMPERATURE Tc, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). To activate the color temperature, the function block sends the command ACTIVATE (see FB_DALI209Activate [} 377]). The function block changes the DTR0 and the DTR1 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Colour Temperature Tc : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Colour Temperature UINT The value written to the variable Colour Temperature Tc and Tc transferred directly to the output value (0...65534 Mirek, 65535). TE1000 Version: 1.20.0 383
## Page 384

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.3.6 FB_DALI209Set Temporary Colour Temperature Tc The function block saves the value n Temporary Colour Temperature Tc in the variable temporary Temperature Tc [} 424] of the DALI control gear. The value can be read with function block FB_DALI209Query Colour Value [} 406]. The value is expressed in units of 1 Mirek. A value of 0 is ignored and therefore not saved. The color temperature Tc can vary from 1 Mirek (1000000 K) to 65534 Mirek (15.26 K). The functions KELVIN_TO_MIREK [} 419] and MIREK_TO_KELVIN [} 419] are available for converting from or to Kelvin. Prior to the DALI command SET TEMPORARY COLOUR TEMPERATURE Tc, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). 384 Version: 1.20.0 TE1000
## Page 385

Programming The function block changes the DTR0 and the DTR1 of all connected DALI control gears. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Temporary Colour Temperature Tc : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Temporary Colour T UINT The value that is written to the variable emperature Tc temporary Colour Temperature Tc [} 424] (0…65534 Mirek, 65535). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 385
## Page 386

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.3.7 FB_DALI209Set Temporary Primary NDim Level The function block saves the value n Temporary Primary NDim Level in the variable temporary Primary NDim Level [} 424] of the DALI control gear. The value can be read with function block FB_DALI209Query Colour Value [} 406]. The value is expressed in steps of 1 / 65536. The maximum value of the variable temporary Primary NDim Level is 0.99997 and is mapped on a linear scale. The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control gears. The function block supports the following color representations: • Primary (color) N Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Primary Colour : USINT; n Temporary Primary NDim Level : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] 386 Version: 1.20.0 TE1000
## Page 387

Programming e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Primary Colour USINT Primary color (0...5). n Temporary Primary UINT The value that is written to the variable NDim Level temporary Primary NDim Level [} 424]. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3.8 FB_DALI209Set Temporary RGBDim Level The function block saves the values n Temporary Red Dim Level, n Temporary Green Dim Level and n Temporary Blue Dim Level in the variables temporary Red Dim Level [} 424], temporary Green Dim Level [} 424] and temporary Blue Dim Level [} 424] of the DALI control gear. TE1000 Version: 1.20.0 387
## Page 388

Programming The values can be read with function block FB_DALI209Query Colour Value [} 406]. The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control gears. The function block supports the following color representations: • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Temporary Red Dim Level : USINT; n Temporary Green Dim Level : USINT; n Temporary Blue Dim Level : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Temporary Red Dim USINT The value that is written to the variable Level temporary Red Dim Level [} 424]. n Temporary Green Di USINT The value that is written to the variable m Level temporary Green Dim Level [} 424]. n Temporary Blue Dim USINT The value that is written to the variable Level temporary Blue Dim Level [} 424]. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 388 Version: 1.20.0 TE1000
## Page 389

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3.9 FB_DALI209Set Temporary RGBWAFControl The function block saves the value n Temporary RGBWAFControl in the variable temporary RGBWAFControl [} 425] of the DALI control gear. The value can be read with function block FB_DALI209Query Colour Value [} 406]. The n Temporary RGBWAFControl input thereby contains the new assignment. The function block changes the DTR0 of all connected DALI control gears. The function block supports the following color representations: • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Temporary RGBWAFControl : BYTE; END_VAR TE1000 Version: 1.20.0 389
## Page 390

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Temporary RGBWA BYTE Contains the channel assignment (see FControl temporary RGBWAFControl [} 425]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 390 Version: 1.20.0 TE1000
## Page 391

Programming 4.1.2.7.3.10 FB_DALI209Set Temporary WAFDim Level The function block saves the values n Temporary White Dim Level, n Temporary Amber Dim Level and n Temporary Free Colour Dim Level in the variables temporary White Dim Level [} 424], temporary Amber Dim Level [} 424] and temporary Free Colour Dim Level [} 424] of the DALI control gear. The values can be read with function block FB_DALI209Query Colour Value [} 406]. The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control gears. The function block supports the following color representations: • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Temporary White Dim Level : USINT; n Temporary Amber Dim Level : USINT; n Temporary Free Colour Dim Level : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Temporary White Di USINT The value that is written to the variable m Level temporary White Dim Level [} 424]. n Temporary Amber Di USINT The value that is written to the variable m Level temporary Amber Dim Level [} 424]. n Temporary Free Col USINT The value that is written to the variable our Dim Level temporary Free Colour Dim Level [} 424]. TE1000 Version: 1.20.0 391
## Page 392

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3.11 FB_DALI209Set Temporary XCoordinate The function block saves the value n Temporary XCoordinate in the variable temporary XCoordinate [} 423] of the DALI control gear. The value can be read with function block FB_DALI209Query Colour Value [} 406]. The function block changes the DTR0 and the DTR1 of all connected DALI control gears. The function block supports the following color representations: • xy coordinates • Primary (color) N 392 Version: 1.20.0 TE1000
## Page 393

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Temporary XCoordinate : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Temporary XCoordi UINT The value that is written to the variable nate temporary XCoordinate [} 423]. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 393
## Page 394

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3.12 FB_DALI209Set Temporary YCoordinate The function block saves the value n Temporary YCoordinate in the variable temporary YCoordinate [} 424] of the DALI control gear. The value can be read with function block FB_DALI209Query Colour Value [} 406]. The function block changes the DTR0 and the DTR1 of all connected DALI control gears. The function block supports the following color representations: • xy coordinates • Primary (color) N Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Temporary YCoordinate : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Temporary YCoordi UINT The value that is written to the variable nate temporary YCoordinate [} 424]. 394 Version: 1.20.0 TE1000
## Page 395

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3.13 FB_DALI209XCoordinate Step Down The function block reduces the variable x Coordinate [} 423] by 256 steps (256 / 65536) without cross-fading. If the new color value does not correspond to a color that can be achieved by the DALI control gear, this must be indicated by bit 0 of colour Status [} 425] (xy-coordinate color point lies outside the valid range). The command is executed only if bit 4 of colour Status [} 425] (color representation xy-coordinate active) is set. The function block supports the following color representations: • xy coordinates Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; TE1000 Version: 1.20.0 395
## Page 396

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 396 Version: 1.20.0 TE1000
## Page 397

Programming 4.1.2.7.3.14 FB_DALI209XCoordinate Step Up The function block increases the variable x Coordinate [} 423] by 256 steps (256 / 65536) without cross- fading. If the new color value does not correspond to a color that can be achieved by the DALI control gear, this must be indicated by bit 0 of colour Status [} 425] (xy-coordinate color point lies outside the valid range). The command is executed only if bit 4 of colour Status [} 425] (color representation xy-coordinate active) is set. The function block supports the following color representations: • xy coordinates Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 397
## Page 398

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.3.15 FB_DALI209YCoordinate Step Down The function block reduces the variable y Coordinate [} 424] by 256 steps (256 / 65536) without cross-fading. If the new color value does not correspond to a color that can be achieved by the DALI control gear, this must be indicated by bit 0 of colour Status [} 425] (xy-coordinate color point lies outside the valid range). The command is executed only if bit 4 of colour Status [} 425] (color representation xy-coordinate active) is set. The function block supports the following color representations: • xy coordinates Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 398 Version: 1.20.0 TE1000
## Page 399

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 TE1000 Version: 1.20.0 399
## Page 400

Programming 4.1.2.7.3.16 FB_DALI209YCoordinate Step Up The function block increases the variable y Coordinate [} 424] by 256 steps (256 / 65536) without cross- fading. If the new color value does not correspond to a color that can be achieved by the DALI control gear, this must be indicated by bit 0 of colour Status [} 425] (xy-coordinate color point lies outside the valid range). The command is executed only if bit 4 of colour Status [} 425] (color representation xy-coordinate active) is set. The function block supports the following color representations: • xy coordinates Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 400 Version: 1.20.0 TE1000
## Page 401

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.4 Query commands 4.1.2.7.4.1 FB_DALI209Query Assigned Colour The function block reads the variable assigned Colour [} 424] from the DALI control gear. This contains the color assigned to the specified output channel (0...5). If a non-existent channel number is specified, 255 (MASK) is returned. The function block changes the DTR0 of all connected DALI control gears. The function block supports the following color representations: • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; TE1000 Version: 1.20.0 401
## Page 402

Programming e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Channel : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input n Address has no [} 903] meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Pri Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. ority [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Channel USINT Channel number (0 - 5). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Assigned Colour : USINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Assigned Colour USINT Assigned color of the channel (see table above). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 402 Version: 1.20.0 TE1000
## Page 403

Programming 4.1.2.7.4.2 FB_DALI209Query Colour Status The function block reads the variable colour Status [} 425] from the DALI control gear. Prior to the DALI command QUERY COLOUR STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Colour Status contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Colour Status : BYTE; END_VAR TE1000 Version: 1.20.0 403
## Page 404

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Colour Status BYTE Output of the status information (see colour Status [} 425]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.4.3 FB_DALI209Query Colour Type Features The function block reads the variable colour Type Features [} 425] from the DALI control gear. This contains the color representations supported by the DALI control gear. Prior to the DALI command QUERY COLOUR TYPE FEATURES, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Colour Type Features contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 404 Version: 1.20.0 TE1000
## Page 405

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Colour Type Features : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Colour Type Feature BYTE Information about the color representations supported by s the DALI control gear (see colour Type Features [} 425]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 405
## Page 406

Programming 4.1.2.7.4.4 FB_DALI209Query Colour Value The function block reads the specified variable (color value) from the DALI control gear. The value to be read is defined by e Colour Value. Certain variables can be read directly by DALI commands (e.g. FB_DALI209Query Colour Status [} 403]). Further details on the variables can be found in section Variables [} 420]. The response must be 255 (MASK) if the DALI control gear does not know the coordinates or if the primary color is not present. Prior to the DALI command QUERY COLOUR VALUE, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0 of all connected DALI control gears. The output n Colour Value contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Colour Value : E_DALIColour Value; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Colour Value E_DALIColour Value [} 905] Variable to be read from the DALI control gear. 406 Version: 1.20.0 TE1000
## Page 407

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Colour Value : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Colour Value UINT Contains the value of the read variable. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.4.5 FB_DALI209Query Gear Features Status The function block reads the variable gear Features/Status [} 425] from the DALI control gear. Prior to the DALI command QUERY GEAR FEATURES/STATUS, the function block sends the DALI command ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see also FB_DALI102Enable Device Type [} 130]). The output n Gear Features Status only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; TE1000 Version: 1.20.0 407
## Page 408

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Gear Feature Status : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Gear Feature Status BYTE Output of the status information (see gear Features/Status [} 425]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 408 Version: 1.20.0 TE1000
## Page 409

Programming 4.1.2.7.4.6 FB_DALI209Query Power On Values The function block reads the variables power On Level [} 155] and the supported values of the color settings from the DALI control gear. In addition to the DALI command QUERY POWER ON LEVEL, the function block sends the DALI commands QUERY COLOUR VALUE and ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0 of all connected DALI control gears. The outputs only contain valid values if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 409
## Page 410

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Power On Level : USINT; e Colour Type : E_DALIColour Type; n XCoordinate : UINT; n YCoordinate : UINT; n Colour Temperature Tc : UINT; n Primary Colour0 : UINT; n Primary Colour1 : UINT; n Primary Colour2 : UINT; n Primary Colour3 : UINT; n Primary Colour4 : UINT; n Primary Colour5 : UINT; n Red Dim Level : USINT; n Green Dim Level : USINT; n Blue Dim Level : USINT; n White Dim Level : USINT; n Amber Dim Level : USINT; n Free Colour Dim Level : USINT; END_VAR 410 Version: 1.20.0 TE1000
## Page 411

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Power On Level USINT Output of the switch-on value (see power On Level [} 155]) from the DALI control gear (0...255). e Colour Type E_DALIColour Type Specifies the color setting with which the DALI control gear is operated (see colour Type [} 424]). n XCoordinate UINT Output of the x-value of the color representation according to xy color type (see X-coordinate [} 423]) in the color setting Xy coordinates (see color representation [} 423]). n YCoordinate UINT Output of the y-value of the color representation according to xy color type (see Y-coordinate [} 424]) in the color setting Xy coordinates (see color representation [} 423]). n Colour Temperature UINT Output of the color temperature (see colour Temperature Tc Tc [} 424]) in the setting Color temperature Tc (see color representation [} 423]). n Primary Colour N UINT Output of the color representation on the corresponding output channel on the operating device in the color setting Primary color N (see color representation [} 423]). n Red Dim Level USINT Output of the red dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Green Dim Level USINT Output of the green dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Blue Dim Level USINT Output of the blue dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n White Dim Level USINT Output of the white dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Amber Dim Level USINT Output of the amber dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Free Colour Dim Lev USINT Output of the dimming level of the freely selectable color el (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). TE1000 Version: 1.20.0 411
## Page 412

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.4.7 FB_DALI209Query RGBWAFControl The function block reads the variable RGBWAFControl [} 425] from the DALI control gear. If an output channel or a color is not supported, then the corresponding bit is FALSE. The function block supports the following color representations: • RGBWAF Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; 412 Version: 1.20.0 TE1000
## Page 413

Programming b Busy : BOOL; n RGBWAFColour : USINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n RGBWAFColour USINT Information about the channel assignment (see RGBWAFControl [} 425]). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.55 Tc3_DALI from v3.18.1.0 4.1.2.7.4.8 FB_DALI209Query Scene Values The function block reads the output values from the DALI control gear for the specified scene n Scene. TE1000 Version: 1.20.0 413
## Page 414

Programming In addition to the DALI command QUERY SCENE LEVEL, the function block sends the DALI commands QUERY COLOUR VALUE and ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0 of all connected DALI control gears. The outputs only contain valid values if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Scene : USINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Scene USINT Scene whose output value is to be read (0…15). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Scene Level : USINT; e Colour Type : E_DALIColour Type; n XCoordinate : UINT; n YCoordinate : UINT; n Colour Temperature Tc : UINT; n Primary Colour0 : UINT; n Primary Colour1 : UINT; n Primary Colour2 : UINT; n Primary Colour3 : UINT; n Primary Colour4 : UINT; n Primary Colour5 : UINT; n Red Dim Level : USINT; n Green Dim Level : USINT; n Blue Dim Level : USINT; n White Dim Level : USINT; n Amber Dim Level : USINT; n Free Colour Dim Level : USINT; END_VAR 414 Version: 1.20.0 TE1000
## Page 415

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Scene Level USINT Output value of the desired scene (0…255). e Colour Type E_DALIColour Type Specifies the color setting with which the DALI control gear is operated (see colour Type [} 424]). n XCoordinate UINT Output of the x-value of the color representation according to xy color type (see X-coordinate [} 423]) in the color setting Xy coordinates (see color representation [} 423]). n YCoordinate UINT Output of the y-value of the color representation according to xy color type (see Y-coordinate [} 424]) in the color setting Xy coordinates (see color representation [} 423]). n Colour Temperature UINT Output of the color temperature (see colour Temperature Tc Tc [} 424]) in the setting Color temperature Tc (see color representation [} 423]). n Primary Colour N UINT Output of the color representation on the corresponding output channel on the operating device in the color setting Primary color N (see color representation [} 423]). n Red Dim Level USINT Output of the red dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Green Dim Level USINT Output of the green dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Blue Dim Level USINT Output of the blue dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n White Dim Level USINT Output of the white dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Amber Dim Level USINT Output of the amber dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Free Colour Dim Lev USINT Output of the dimming level of the freely selectable color el (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). TE1000 Version: 1.20.0 415
## Page 416

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.4.9 FB_DALI209Query System Failure Values The function block reads the variable system Failure Level [} 155] and the corresponding color/color temperature settings from the DALI control gear. In addition to the DALI command QUERY SYSTEM FAILURE LEVEL, the function block sends the DALI commands QUERY COLOUR VALUE and ENABLE DEVICE TYPE 8, as is necessary for application extended commands (see FB_DALI102Enable Device Type [} 130]). The function block changes the DTR0 of all connected DALI control gears. The outputs only contain valid values if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 416 Version: 1.20.0 TE1000
## Page 417

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n System Failure Level : USINT; e Colour Type : E_DALIColour Type; n XCoordinate : UINT; n YCoordinate : UINT; n Colour Temperature Tc : UINT; n Primary Colour0 : UINT; n Primary Colour1 : UINT; n Primary Colour2 : UINT; n Primary Colour3 : UINT; n Primary Colour4 : UINT; n Primary Colour5 : UINT; n Red Dim Level : USINT; n Green Dim Level : USINT; n Blue Dim Level : USINT; n White Dim Level : USINT; n Amber Dim Level : USINT; n Free Colour Dim Level : USINT; END_VAR TE1000 Version: 1.20.0 417
## Page 418

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n System Failure Leve USINT Output value in the case of a system failure (0…255). l e Colour Type E_DALIColour Type Specifies the color setting with which the DALI control gear is operated (see colour Type [} 424]). n XCoordinate UINT Output of the x-value of the color representation according to xy color type (see X-coordinate [} 423]) in the color setting Xy coordinates (see color representation [} 423]). n YCoordinate UINT Output of the y-value of the color representation according to xy color type (see Y-coordinate [} 424]) in the color setting Xy coordinates (see color representation [} 423]). n Colour Temperature UINT Output of the color temperature (see colour Temperature Tc Tc [} 424]) in the setting Color temperature Tc (see color representation [} 423]). n Primary Colour N UINT Output of the color representation on the corresponding output channel on the operating device in the color setting Primary color N (see color representation [} 423]). n Red Dim Level USINT Output of the red dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Green Dim Level USINT Output of the green dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Blue Dim Level USINT Output of the blue dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n White Dim Level USINT Output of the white dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Amber Dim Level USINT Output of the amber dimming level (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). n Free Colour Dim Lev USINT Output of the dimming level of the freely selectable color el (see Dim Level [} 424]) in the color setting RGBWAF (see color representation [} 423]). 418 Version: 1.20.0 TE1000
## Page 419

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.2.7.5 Help Functions 4.1.2.7.5.1 KELVIN_TO_MIREK Conversion of the color temperature from Kelvin to Mirek. Mirek is a color temperature unit used by most DALI commands. The return value of the function is limited to the value range 0…65535 (see table). Mirek = 1000000 / (color temperature in Kelvin). Kelvin Mirek 0.0 65535 15.0 65535 16.0 62500 1000.0 1000 10000.0 100 1000000.0 1 1000001.0 0 Inputs VAR_INPUT f Kelvin : LREAL; END_VAR Name Type Description f Kelvin LREAL Color temperature in Kelvin Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.5.2 MIREK_TO_KELVIN TE1000 Version: 1.20.0 419
## Page 420

Programming Conversion of the color temperature from Mirek to Kelvin. Mirek is a color temperature unit used by most DALI commands. The return value of the function is limited to the value range 0…1000001 (see table). Kelvin = 1000000 / (color temperature in Mirek). Mirek Kelvin 0 1000001.0 1 1000000.0 100 10000.0 1000 1000.0 10000 100.0 65534 15.259 65535 0.0 Inputs VAR_INPUT n Mirek : UINT; END_VAR Name Type Description n Mirek UINT Color temperature in Mirek Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.7.6 Variables Every DALI control gear for color/color temperature control has a certain number of variables (parameters ) from which it is possible to read a variety of information or to modify individual parameters. Some variables can be read directly by DALI commands (e.g. FB_DALI209Query Colour Status [} 403]). The function block FB_DALI209Query Colour Value [} 406] can be used to read out further variables. 420 Version: 1.20.0 TE1000
## Page 421

Programming Name Reset value Scope Size Necessary color Comment representation [} 423] temporary XCoordi 65535 0…65535 2 bytes 0, 2 nate [} 423] report XCoordinate 65535 0…65535 2 bytes 0 x Coordinate [} 423] No change 0…65535 2 bytes 0 temporary YCoordin 65535 0…65535 2 bytes 0, 2 ate [} 424] report YCoordinate 65535 0…65535 2 bytes 0 y Coordinate [} 424] No change 0…65535 2 bytes 0 temporary Colour Te 65535 1…65535 2 bytes 1 mperature Tc [} 424] report Colour Tempe 65535 1…65535 2 bytes 1 rature Tc colour Temperature No change 1…65535 2 bytes 1 Tc [} 424] colour Temperature colour Temperature colour Temperature 2 bytes 1 Tc Coolest Tc Physical Coolest Tc Physical Coolest … colour Temperature Tc Warmest, 65535 colour Temperature colour Temperature colour Temperature 2 bytes 1 Tc Warmest Tc Physical Warmes Tc Coolest t … colour Temperature Tc Physical Warmes t, 65535 colour Temperature No change 1 2 bytes 1 Tc Physical Coolest … colour Temperature Tc Physical Warmes t, 65535 colour Temperature No change colour Temperature 2 bytes 1 Tc Physical Warmes Tc Physical Coolest t … 65534, 65535 temporary Primary N 65535 0...65535 2 bytes 2 Dim Level [} 424] report Primary NDim 65535 0…65535 2 bytes 2 Level primary NDim Level No change 0…65535 2 bytes 2 [} 424] x Coordinate Primar No change 0…65535 2 bytes 0, 2 Read only y N [} 424] y Coordinate Primar No change 0…65535 2 bytes 0, 2 Read only y N [} 424] ty Primary N [} 424] No change 0…65535 2 bytes 0, 2 Read only TE1000 Version: 1.20.0 421
## Page 422

Programming Name Reset value Scope Size Necessary color Comment representation [} 423] temporary Red Dim L 255 0…255 1 byte 3 evel [} 424] report Red Dim Level 255 0…255 1 byte 3 red Dim Level No change 0…255 1 byte 3 [} 424] temporary Green Di 255 0…255 1 byte 3 m Level [} 424] report Green Dim Le 255 0…255 1 byte 3 vel green Dim Level No change 0…255 1 byte 3 [} 424] temporary Blue Dim 255 0…255 1 byte 3 Level [} 424] report Blue Dim Leve 255 0…255 1 byte 3 l blue Dim Level No change 0…255 1 byte 3 [} 424] temporary White Di 255 0…255 1 byte 3 m Level [} 424] report White Dim Lev 255 0…255 1 byte 3 el white Dim Level No change 0…255 1 byte 3 [} 424] temporary Amber Di 255 0…255 1 byte 3 m Level [} 424] report Amber Dim Le 255 0…255 1 byte 3 vel amber Dim Level No change 0…255 1 byte 3 [} 424] temporary Free Colo 255 0…255 1 byte 3 ur Dim Level [} 424] report Free Colour Di 255 0…255 1 byte 3 m Level free Colour Dim Leve No change 0…255 1 byte 3 l [} 424] temporary RGBWAF 255 0…255 1 byte 3 Control [} 425] report RGBWAFCo 255 0…255 1 byte 3 ntrol RGBWAFControl No change 0…255 1 byte 3 [} 425] assigned Colour 16#0102_0304_05 16#0000_0000_00 6 bytes 3 Read only 06 00 [} 424] MSB: channel … 0 16#0606_0606_06 06 LSB: channel 5 422 Version: 1.20.0 TE1000
## Page 423

Programming Name Reset value Scope Size Necessary color Comment representation [} 423] temporary Colour Ty 255 16#10, 16#20, 1 byte 0, 1, 2, 3 16#40, 16#80, pe [} 424] 16#FF report Colour Type 255 16#10, 16#20, 1 byte 0, 1, 2, 3 16#40, 16#80, [} 424] 16#FF scene0-15Colour Ty 65535 16#10, 16#20, 1 byte 0, 1, 2, 3 Read only 16#40, 16#80, pe [} 424] 16#FF scene0-15Colour V 65535 0…65535 32 bytes… 0, 1, 2, 3 Read only alue 192 bytes power On Colour Typ Manufacturer- 16#10, 16#20, 1 byte 0, 1, 2, 3 Read only dependent 16#40, 16#80, e [} 424] 16#FF power On Colour Val Manufacturer- 0…65535 2 bytes… 0, 1, 2, 3 Read only ue dependent 12 bytes system Failure Colou Manufacturer- 16#10, 16#20, 1 byte 0, 1, 2, 3 Read only dependent 16#40, 16#80, r Type [} 424] 16#FF system Failure Colo Manufacturer- 0…65535 2 bytes… 0, 1, 2, 3 Read only ur Value dependent 12 bytes gear Features/ 2#XX00_0001 2#XX00_0000, 1 byte 0, 1, 2, 3 2#XX00_0001 Status [} 425] colour Status No change 0…255 1 byte 0, 1, 2, 3 [} 425] colour Type Features No change 0…255 1 byte 0, 1, 2, 3 Read only [} 425] X: undetermined In the case of 1-byte values the value 255 is also called MASK. In the case of 2-byte values the value 65,535 is also called MASK. Necessary color representation Specifies the color representation that the DALI control gear must support so that it contains the appropriate variables: Value Description 0 xy coordinates 1 Color temperature Tc 2 Primary (color) N 3 RGBWAF x Coordinate / temporary XCoordinate Chromaticity coordinate x in the xy color type. The x-Coordinate is specified in Mirek [} 419]. It can vary from 0 Mirek (0 K) to 65534 Mirek (15.26 K). At a value of 65535 (MASK), the value is not defined. TE1000 Version: 1.20.0 423
## Page 424

Programming y Coordinate / temporary YCoordinate Chromaticity coordinate y in the xy color type. The y-Coordinate is specified in Mirek [} 419]. It can vary from 0 Mirek (0 K) to 65534 Mirek (15.26 K). At a value of 65535 (MASK), the value is not defined. colour Temperature Tc / temporary Colour Temperature Tc The variable colour Temperature Tc / temporary Colour Temperature Tc defines the color temperature. It is adjustable in the range between colour Temperature Tc Warmest and colour Temperature Tc Coolest. The colour Temperature Tc is specified in Mirek [} 419]. It can vary from 1 Mirek (1000000 K) to 65534 Mirek (15.26 K). colour Temperature Tc Coolest / colour Temperature Tc Warmest dim Level / temporary Dim Level Setting of the dimming level of the corresponding color (red, green, blue, white, amber or a freely selectable color) from 0 to 255. primary NDim Level / temporary primary NDim Level assigned Colour The association between output channel and color is defined in the variable assigned Colour. Each byte contains the color of the corresponding channel. The function block FB_DALI209Query Assigned Colour [} 401] can be used to read out the value. Value Description 0 No color assigned 1 Red 2 Green 3 Blue 4 White 5 Amber 6 Freely selectable color colour Type The variable colour Type defines the color representations supported by the DALI control gear. The values can be read out with the function block FB_DALI209Query Colour Value [} 406]. E_DALIColour- Description Type [} 904] Xy Coordinate xy coordinates Colour Temperat Color temperature Tc ure Tc Primary NDim Le Primary (color) N vel RGBWAFContro RGBWAF l MASK No color change 424 Version: 1.20.0 TE1000
## Page 425

Programming colour Status colour Status contains information about the current status of the DALI control gear. The function block FB_DALI209Query Colour Status [} 403] can be used to read out the values Bit Description 0 xy coordinate color point is outside the valid range. 1 Color temperature Tc lies outside the valid range 2 Automatic calibration is active. 3 Automatic calibration was successful. 4 Color representation xy-coordinate active. 5 Color representation color temperature Tc active. 6 Color representation primary N active. 7 Color representation RGBWAF active. gear Features / Status gear Features / Status contains information about the current status of the DALI control gear. The values can be read with the function block FB_DALI209Query Gear Features Status [} 407] and written with the function block FB_DALI209Store Gear Features Status [} 372]. Bit Description 0 Automatic activation 1…5 reserved 6 Automatic calibration is supported 7 Restoration of the automatic calibration is supported RGBWAFControl / temporary RGBWAFControl RGBWAFControl contains further information about the assignment between output channel and color. Bit Description 0 Output channel 0 / red 1 Output channel 1 / green 2 Output channel 2 / blue 3 Output channel 3 / white 4 Output channel 4 / amber 5 Output channel 5 / free selectable color 6…7 00 = channel control 01 = color control 10 = standardized color control 11 = reserved colour Type Features colour Type Features defines the color representations supported by the DALI control gear. The values can be read out with the function block FB_DALI209Query Colour Type Features [} 404]. TE1000 Version: 1.20.0 425
## Page 426

Programming Bit Description 0 The DALI control gear supports color representation through xy coordinates. 1 The DALI control gear supports color representation through color temperature Tc. 2…4 Number of primary colors supported by the DALI control gear. A value of 0 means that this color representation by primary colors is not supported. 5…7 Number of RGBWAF channels supported by the DALI control gear. A value of 0 means that this color representation by RGBWAF is not supported. 4.1.2.8 Part 251 (memory bank 1 extension) 4.1.2.8.1 Introduction In specifications that go beyond the current DALI-2 standard, the DALI Alliance (Dii A) describes additional DALI parts for the operation of intelligent luminaires. These new parts are combined under the term D4i. The current Tc3_DALI library supports Parts 251 (DT50), 252 (DT51) and 253 (DT52). These parts contain functions that can be forwarded to the higher-level DALI network for evaluation and control. They describe the location, type and format of the data in the memory banks of the DALI control gears. In addition, they describe the exchange of data with DALI control devices. DALI Part 251 – memory bank 1 extension Part 251 extends previously unoccupied areas of memory bank 1 for vendor-specific information. This information does not change the functionality of the control gear. The data stored here are directly available to the DALI network for technical management, e.g. in large properties. Part 251 provides information about the inventory, such as device number, date of manufacture and color of the device. Information on rated power, rated illuminance, rated voltage, minimum power consumption, color rendering index and correlated color temperature are also available. The values in Part 251 are read-only. The entire contents of memory bank 1 are read via the function block FB_DALI102Read Memory Bank [} 47]. Part 251 also provides the function blocks described below for reading the individual parameters. 4.1.2.8.2 FB_DALI251Query Colour Rendering Index The function block reads the color rendering index from the DALI control gear. The output n Colour Rendering Index contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; 426 Version: 1.20.0 TE1000
## Page 427

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Colour Rendering Index : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Colour Rendering In BYTE Outputs the color rendering index (0…100). dex Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 427
## Page 428

Programming 4.1.2.8.3 FB_DALI251Query Correlated Colour Temperature The function block reads the correlated color temperature from the DALI control gear. The output n Correlated Colour Temperature only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Correlated Colour Temperature : UINT; END_VAR 428 Version: 1.20.0 TE1000
## Page 429

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Correlated Colour T UINT Outputs the correlated color temperature [K] (0…17000). If emperature the value 16#FFFE is returned, then Part 209 is not implemented in the DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.8.4 FB_DALI251Query Luminaire Colour The function block reads the luminaire color from the DALI control gear. The output s Luminaire Colour contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 429
## Page 430

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; s Luminaire Colour : STRING(24); END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. s Luminaire Colour STRING Outputs the luminaire color. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 430 Version: 1.20.0 TE1000
## Page 431

Programming 4.1.2.8.5 FB_DALI251Query Luminaire Date Of Manufacture The function block reads the year and week of production from the DALI control gear. The outputs n Year and n Week only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Year : UINT; n Week : BYTE; END_VAR TE1000 Version: 1.20.0 431
## Page 432

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Year UINT Year of production (2000…2099). n Week BYTE Week of production (1…53). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.8.6 FB_DALI251Query Luminaire Identification The function block reads the identification designation of the luminaire from the DALI control gear. The output s Luminaire Identification contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 432 Version: 1.20.0 TE1000
## Page 433

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; s Luminaire Identification : STRING(60); END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. s Luminaire Identificat STRING Identification designation ion Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 433
## Page 434

Programming 4.1.2.8.7 FB_DALI251Query Nominal Input Power The function block reads the nominal input power of the luminaire from the DALI control gear. The output n Nominal Input Power contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Nominal Input Power : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Nominal Input Power UINT Nominal output [W] (0…65534). 434 Version: 1.20.0 TE1000
## Page 435

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.8.8 FB_DALI251Query Nominal Light Output The function block reads the nominal light output of the luminaire from the DALI control gear. The output n Nominal Light Output contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Nominal Light Output : UDINT; END_VAR TE1000 Version: 1.20.0 435
## Page 436

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Nominal Light Outpu UDINT Nominal illuminance [Lm] (0…16777214). t Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.8.9 FB_DALI251Query Nominal Maximum ACMains Voltage The function block reads the maximum nominal input voltage of the DALI control gear. The output n Nominal Maximum ACMains Voltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 436 Version: 1.20.0 TE1000
## Page 437

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Nominal Maximum ACMains Voltage : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Nominal Maximum A UINT Maximum nominal input voltage [V] (90…480). CMains Voltage Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 437
## Page 438

Programming 4.1.2.8.10 FB_DALI251Query Nominal Minimum ACMains Voltage The function block reads the minimum nominal input voltage of the DALI control gear. The output n Nominal Minimum ACMains Voltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Nominal Minimum ACMains Voltage : UINT; END_VAR 438 Version: 1.20.0 TE1000
## Page 439

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Nominal Minimum A UINT Minimum nominal input voltage [V] (90…480). CMains Voltage Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.8.11 FB_DALI251Query Power At Minimum Dim Level The function block reads the power consumption at the minimum dimming value of the DALI control gear. The output n Power At Minimum Dim Level only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 439
## Page 440

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Power At Minimum Dim Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Power At Minimum D UINTE Power consumption [W] at the minimum dimming value im Level (0…65534). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 440 Version: 1.20.0 TE1000
## Page 441

Programming 4.1.2.9 Part 252 (energy reporting) 4.1.2.9.1 Introduction In specifications that go beyond the current DALI-2 standard, the DALI Alliance (Dii A) describes additional DALI parts for the operation of intelligent luminaires. These new parts are combined under the term D4i. The current Tc3_DALI library supports Parts 251 (DT50), 252 (DT51) and 253 (DT52). These parts contain functions that can be forwarded to the higher-level DALI network for evaluation and control. They describe the location, type and format of the data in the memory banks of the DALI control gears. In addition, they describe the exchange of data with DALI control devices. Part 252 – Energy reporting Part 252 describes additional memory banks in which energy and consumption data can be read. Memory bank 202 contains information about active energy and active power. This information is obligatory and is provided by DALI control gears that support Part 252. Memory bank 203 contains information on apparent energy and apparent power. Memory bank 204 contains information on output energy and output power. The information from memory banks 203 and 204 is optional and does not need to be provided by DALI control gears that support Part 252. The values in Part 252 are read-only. The entire contents of memory banks 202, 203 and 204 are read via the function block FB_DALI102Read Memory Bank [} 47]. Part 252 also provides the function blocks described below for reading the individual parameters. The actual value of the read parameter is calculated from the read output value and the scaling factor. The function blocks output both values for further calculation. 4.1.2.9.2 FB_DALI252Query Active Energy The function block reads the active energy from the DALI control gear. It is calculated as follows: The outputs n Active Energy and n Scale Factor For Active Energy only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; TE1000 Version: 1.20.0 441
## Page 442

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Active Energy : ULINT; n Scale Factor For Active Energy : SINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Active Energy ULINT Active energy [Wh] (0…281474976710653). n Scale Factor For Acti SINT Scaling factor for the active energy (-6...6). ve Energy Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 442 Version: 1.20.0 TE1000
## Page 443

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.9.3 FB_DALI252Query Active Energy Loadside The function block reads the load-side active energy from the DALI control gear. It is calculated as follows: The outputs n Active Energy Loadside and n Scale Factor For Loadside Energy only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Active Energy Loadside : ULINT; n Scale Factor For Loadside Energy: SINT; END_VAR TE1000 Version: 1.20.0 443
## Page 444

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Active Energy Loads ULINT Load-side active energy [Wh] (0…281474976710653). ide n Scale Factor For Loa SINT Scaling factor for the load-side active energy (-6...6). dside Energy Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.9.4 FB_DALI252Query Active Power The function block reads the active power from the DALI control gear. It is calculated as follows: The outputs n Active Power and n Scale Factor For Active Power only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 444 Version: 1.20.0 TE1000
## Page 445

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Active Power : UDINT; n Scale Factor For Active Power : SINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Active Power UDINT Active power [W] (0…4294967293). n Scale Factor For Acti SINT Scaling factor for the active power (-6...6). ve Power Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 445
## Page 446

Programming 4.1.2.9.5 FB_DALI252Query Active Power Loadside The function block reads the load-side active power from the DALI control gear. It is calculated as follows: The outputs n Active Power Loadside and n Scale Factor For Loadside Power only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Active Power Loadside : UDINT; n Scale Factor For Loadside Power : SINT; END_VAR 446 Version: 1.20.0 TE1000
## Page 447

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Active Power Loadsi UDINT Load-side active power [W] (0…4294967293). de n Scale Factor For Loa SINT Scaling factor for the load-side active power (-6...6). dside Power Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.9.6 FB_DALI252Query Apparent Energy The function block reads the apparent energy from the DALI control gear. It is calculated as follows: The outputs n Apparent Energy and n Scale Factor For Apparent Energy only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 447
## Page 448

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Apparent Energy : ULINT; n Scale Factor For Apparent Energy: SINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Apparent Energy ULINT Apparent energy [VAh] (0…281474976710653). n Scale Factor For App SINT Scaling factor for the apparent energy (-6...6). arent Energy Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 448 Version: 1.20.0 TE1000
## Page 449

Programming 4.1.2.9.7 FB_DALI252Query Apparent Power The function block reads the apparent power from the DALI control gear. It is calculated as follows: The outputs n Apparent Power and n Scale Factor For Apparent Power only contain a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Apparent Power : UDINT; n Scale Factor For Apparent Power : SINT; END_VAR TE1000 Version: 1.20.0 449
## Page 450

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Apparent Power ULINT Apparent power [VA] (0…4294967293). n Scale Factor For App SINT Scaling factor for the apparent power (-6...6). arent Power Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10 Part 253 (diagnostics and maintenance) 4.1.2.10.1 Introduction In specifications that go beyond the current DALI-2 standard, the DALI Alliance (Dii A) describes additional DALI parts for the operation of intelligent luminaires. These new parts are combined under the term D4i. The current Tc3_DALI library supports Parts 251 (DT50), 252 (DT51) and 253 (DT52). These parts contain functions that can be forwarded to the higher-level DALI network for evaluation and control. They describe the location, type and format of the data in the memory banks of the DALI control gears. In addition, they describe the exchange of data with DALI control devices. Part 253 – Diagnostics and maintenance Part 252 writes additional memory banks in which diagnostic and maintenance data can be read and partly specified. Memory bank 205 contains information on diagnostics and maintenance of the DALI control gear. Memory bank 206 contains information on the diagnostics and maintenance of the light source. Memory bank 207 contains maintenance information on the luminaire. This information is obligatory and is provided by DALI control gears that support Part 253. 450 Version: 1.20.0 TE1000
## Page 451

Programming The entire contents of memory banks 205, 206 and 207 are read via the function block FB_DALI102Read Memory Bank [} 47]. Part 253 also provides the function blocks described below for reading the individual parameters. 4.1.2.10.2 FB_DALI253Query Control Gear External Supply Overvoltage The function block indicates whether an overvoltage has been detected in the external supply voltage of the DALI control gear. The output b Control Gear External Supply Overvoltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear External Supply Overvoltage : BOOL; END_VAR TE1000 Version: 1.20.0 451
## Page 452

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Control Gear Extern BOOL The output is set as soon as an overvoltage has been al Supply Overvoltage detected in the external supply voltage of the DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.3 FB_DALI253Query Control Gear External Supply Overvoltage Counter The function block reads the counter for the detected overvoltage events of the external supply voltage of the DALI control gear. The output n Control Gear External Supply Overvoltage Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 452 Version: 1.20.0 TE1000
## Page 453

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear External Supply Overvoltage Counter : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Extern BYTE Number of detected overvoltage events of the external al Supply Overvoltage supply voltage (0...253). Counter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 453
## Page 454

Programming 4.1.2.10.4 FB_DALI253Query Control Gear External Supply Undervoltage The function block indicates whether an undervoltage has been detected in the external supply voltage of the DALI control gear. The output b Control Gear External Supply Undervoltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear External Supply Undervoltage : BOOL; END_VAR 454 Version: 1.20.0 TE1000
## Page 455

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Control Gear Extern BOOL The output is set as soon as an overvoltage has been al Supply Overvoltage detected in the external supply voltage of the DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.5 FB_DALI253Query Control Gear External Supply Undervoltage Counter The function block reads the counter for the detected undervoltage events of the external supply voltage of the DALI control gear. The output n Control Gear External Supply Undervoltage Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 455
## Page 456

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear External Supply Undervoltage Counter : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Extern BYTE Number of detected undervoltage events of the external al Supply Undervoltag supply voltage (0...253). e Counter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 456 Version: 1.20.0 TE1000
## Page 457

Programming 4.1.2.10.6 FB_DALI253Query Control Gear External Supply Voltage The function block reads the effective value of the external supply voltage from the DALI control gear. The output f Control Gear External Supply Voltage only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; f Control Gear External Supply Voltage : LREAL; END_VAR TE1000 Version: 1.20.0 457
## Page 458

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. f Control Gear Externa LREAL RMS value of the external supply voltage [Vrms] (0.0… l Supply Voltage 6553.3). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.7 FB_DALI253Query Control Gear External Supply Voltage Frequency The function block reads the frequency of the external supply voltage from the DALI control gear. The output f Control Gear External Supply Voltage Frequency only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 458 Version: 1.20.0 TE1000
## Page 459

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; f Control Gear External Supply Voltage Frequency : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. f Control Gear Externa BYTE Frequency of the external supply voltage [Hz] (0…253). l Supply Voltage Frequ ency Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 459
## Page 460

Programming 4.1.2.10.8 FB_DALI253Query Control Gear Operating Time The function block reads the operating time of the DALI control gear. The output n Control Gear Operating Time only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Operating Time : UDINT; END_VAR 460 Version: 1.20.0 TE1000
## Page 461

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Operati UDINT Operating time [s] (0…4294967293) ng Time Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.9 FB_DALI253Query Control Gear Output Current Percent The function block reads the output current as a percentage of the nominal current from the DALI control gear. The output n Control Gear Output Current Percent only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 461
## Page 462

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Output Current Percent : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Output BYTE Percentage output current [%] (0…100) Current Percent Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 462 Version: 1.20.0 TE1000
## Page 463

Programming 4.1.2.10.10 FB_DALI253Query Control Gear Output Power Limitation The function block indicates whether the limit value of the output power of the DALI control gear was exceeded. The output b Control Gear Output Power Limitation contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear Output Power Limitation : BOOL; END_VAR TE1000 Version: 1.20.0 463
## Page 464

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Control Gear Output BOOL The output is set as soon as the output power of the DALI Power Limitation control gear is higher than the set limit value. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.11 FB_DALI253Query Control Gear Output Power Limitation Counter The function block reads the counter of the number of exceedances of the output power limit value at the DALI control gear. The output n Control Gear Output Power Limitation Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 464 Version: 1.20.0 TE1000
## Page 465

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Output Power Limitation Counter : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Output BYTE Number of times the output power was exceeded (0…253). Power Limitation Cou nter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 465
## Page 466

Programming 4.1.2.10.12 FB_DALI253Query Control Gear Overall Failure Condition The function block outputs the status of control Gear Failure [} 158] at the DALI control gear. The output b Control Gear Overall Failure Condition contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear Overall Failure Condition : BOOL; END_VAR 466 Version: 1.20.0 TE1000
## Page 467

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Control Gear Overall F BOOL The output is set as soon as an error has been detected in ailure Condition the DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.13 FB_DALI253Query Control Gear Overall Failure Condition Counter The function block reads the counter of the error events that have occurred in the DALI control gear. The output n Control Gear Overall Failure Condition Counter contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 467
## Page 468

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Overall Failure Condition Counter: BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Overall BYTE Number of errors detected (0...253). Failure Condition Cou nter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 468 Version: 1.20.0 TE1000
## Page 469

Programming 4.1.2.10.14 FB_DALI253Query Control Gear Power Factor The function block outputs the power factor of the DALI control gear. The output f Control Gear Power Factor contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; f Control Gear Power Factor : LREAL; END_VAR TE1000 Version: 1.20.0 469
## Page 470

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. f Control Gear Power F LREAL Power factor (0.0…1.0) actor Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.15 FB_DALI253Query Control Gear Start Counter The function block outputs the number of starts of the DALI control gear. The value is incremented after switching on the external power supply. The output n Control Gear Start Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 470 Version: 1.20.0 TE1000
## Page 471

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Start Counter : UDINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Start C UDINT Number of starts of the DALI control gear (0…16777213). ounter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 471
## Page 472

Programming 4.1.2.10.16 FB_DALI253Query Control Gear Temperature The function block outputs the internal temperature of the DALI control gear. The output n Control Gear Temperature only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Temperature : INT; END_VAR 472 Version: 1.20.0 TE1000
## Page 473

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Tempe INT Internal temperature [°C] (-60…193) rature Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.17 FB_DALI253Query Control Gear Thermal Derating The function block indicates whether the internal temperature is higher than the specified limit value in the DALI control gear. The output b Control Gear Thermal Derating only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 473
## Page 474

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear Thermal Derating : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Control Gear Therm BOOL The output is set as soon as the internally measured al Derating temperature of the DALI control gear is higher than the specified limit value. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 474 Version: 1.20.0 TE1000
## Page 475

Programming 4.1.2.10.18 FB_DALI253Query Control Gear Thermal Derating Counter The function block reads the counter that counts the number of times the temperature limit value inside the DALI control gear is exceeded. The output n Control Gear Thermal Derating Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Thermal Derating Counter : BYTE; END_VAR TE1000 Version: 1.20.0 475
## Page 476

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Therm BYTE Number of times the internal temperature was exceeded al Derating Counter (0…253) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.19 FB_DALI253Query Control Gear Thermal Shutdown The function block indicates whether there is a thermal shutdown of the DALI control gear. The output b Control Gear Thermal Shutdown only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 476 Version: 1.20.0 TE1000
## Page 477

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Control Gear Thermal Shutdown : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Control Gear Therm BOOL The output is set as soon as the condition for a thermal al Shutdown shutdown of the DALI control gear is satisfied. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 477
## Page 478

Programming 4.1.2.10.20 FB_DALI253Query Control Gear Thermal Shutdown Counter The function block reads the counter of the number of thermal shutdowns of the DALI control gear. The output n Control Gear Thermal Shutdown Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Control Gear Thermal Shutdown Counter : BYTE; END_VAR 478 Version: 1.20.0 TE1000
## Page 479

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Control Gear Therm BYTE Number of thermal shutdowns (0…253) al Shutdown Counter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.21 FB_DALI253Query Internal Control Gear Reference Temperature The function block outputs the internal reference temperature of the DALI control gear. The output n Internal Control Gear Reference Temperature only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 479
## Page 480

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Internal Control Gear Reference Temperature: INT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Internal Control Gea INT Internal reference temperature [°C] (-60...193) r Reference Temperat ure Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 480 Version: 1.20.0 TE1000
## Page 481

Programming 4.1.2.10.22 FB_DALI253Query Light Source Current The function block reads the current consumption of the light source. The output f Light Source Current contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; f Light Source Current : LREAL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. f Light Source Current LREAL Current consumption [A] (0.0…65.533) TE1000 Version: 1.20.0 481
## Page 482

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.23 FB_DALI253Query Light Source On Time The function block reads the non-resettable operating hour counter of the light source. If the light source is switched on, the non-resettable operating hour counter is incremented by one every second. The non-resettable operating hour counter cannot be reset or changed. The output n Light Source On Time contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; 482 Version: 1.20.0 TE1000
## Page 483

Programming b Busy : BOOL; n Light Source On Time : UDINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source On Tim UDINT Current value of the non-resettable operating hours e counter [s] (0…4294967293) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.24 FB_DALI253Query Light Source On Time Resettable The function block reads the resettable operating hour counter of the light source. If the light source is switched on, the resettable operating hour counter is incremented by one every second. The resettable operating hours counter can be changed by the function block FB_DALI253Set Light Source On Time Resettable [} 510]. The output n Light Source On Time Resettable contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 483
## Page 484

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source On Time Resettable : UDINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source On Tim UDINT Current value of the resettable operating hours counter of e Resettable the light source [s] (0…4294967293) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 484 Version: 1.20.0 TE1000
## Page 485

Programming 4.1.2.10.25 FB_DALI253Query Light Source Open Circuit The function block indicates whether there is an open circuit to the light source. The output b Light Source Open Circuit contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Light Source Open Circuit : BOOL; END_VAR TE1000 Version: 1.20.0 485
## Page 486

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Light Source Open Ci BOOL The output is set as soon as an open circuit to the light rcuit source is detected. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.26 FB_DALI253Query Light Source Open Circuit Counter The function block reads the counter of the number of open circuits to the light source. The output n Light Source Open Circuit Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 486 Version: 1.20.0 TE1000
## Page 487

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Open Circuit Counter : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Open Ci BYTE Number of open circuits (0…253) rcuit Counter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 487
## Page 488

Programming 4.1.2.10.27 FB_DALI253Query Light Source Overall Failure Condition The function block outputs the status of lamp Failure [} 158] at the DALI control gear. The output b Light Source Overall Failure Condition contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Light Source Overall Failure Condition : BOOL; END_VAR 488 Version: 1.20.0 TE1000
## Page 489

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Light Source Overall BOOL The output is set as soon as a light source error has been Failure Condition detected in the DALI control gear. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.28 FB_DALI253Query Light Source Overall Failure Condition Counter The function block reads the counter of the light source error events. The output n Light Source Overall Failure Condition Counter contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 489
## Page 490

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Overall Failure Condition Counter: BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Overall BYTE Number of errors detected (0...253) Failure Condition Cou nter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 490 Version: 1.20.0 TE1000
## Page 491

Programming 4.1.2.10.29 FB_DALI253Query Light Source Short Circuit The function block indicates whether there is a short-circuit at the light source. The output b Light Source Short Circuit contains a valid value only if the function block was executed without errors (b Error = FALSE) Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Light Source Short Circuit : UDINT; END_VAR TE1000 Version: 1.20.0 491
## Page 492

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Light Source Short Ci UDINT The output is set as soon as a short circuit is detected at rcuit the light source. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.30 FB_DALI253Query Light Source Short Circuit Counter The function block reads the counter that counts the number of light source short-circuits. The output n Light Source Short Circuit Counter only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 492 Version: 1.20.0 TE1000
## Page 493

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Short Circuit Counter : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Short Ci BYTE Number of short-circuits that have occurred (0…253) rcuit Counter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 493
## Page 494

Programming 4.1.2.10.31 FB_DALI253Query Light Source Start Counter The function block reads the non-resettable counter for the switching on of the light source. The non- resettable counter is incremented by one each time the light source changes from the Off state to the On state. The non-resettable counter cannot be reset or changed. The output n Light Source Start Counter contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Start Counter : UDINT; END_VAR 494 Version: 1.20.0 TE1000
## Page 495

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Start Co BOOL Current value of the non-resettable counter for the unter switching on of the light source (0...16777213). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.32 FB_DALI253Query Light Source Start Counter Resettable The function block reads the resettable counter for the switching on of the light source. The resettable counter is incremented by one each time the light source changes from the Off state to the On state. The resettable counter is writable by the function block FB_DALI253Set Light Source Start Counter Resettable [} 512]. The output n Light Source Start Counter Resettable contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 495
## Page 496

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Start Counter Resettable : UDINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Start Co UDINT Current value of the resettable counter for the switching on unter Resettable of the light source (0...16777213). Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 496 Version: 1.20.0 TE1000
## Page 497

Programming 4.1.2.10.33 FB_DALI253Query Light Source Temperature The function block indicates the temperature of the light source. The output n Light Source Temperature only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Temperature : INT; END_VAR TE1000 Version: 1.20.0 497
## Page 498

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Tempe INT Temperature of the light source [°C] (-60…193) rature Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.34 FB_DALI253Query Light Source Thermal Derating The function block indicates whether the light source temperature is higher than the specified limit value. The output b Light Source Thermal Derating contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 498 Version: 1.20.0 TE1000
## Page 499

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Light Source Thermal Derating : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Light Source Therm BOOL The output is set as soon as the temperature measured at al Derating the light source is higher than the specified limit value. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 499
## Page 500

Programming 4.1.2.10.35 FB_DALI253Query Light Source Thermal Derating Counter The function block reads the counter that counts the number of times the light source temperature exceeded the limit value. The output n Light Source Thermal Derating Counter contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Thermal Derating Counter : BYTE; END_VAR 500 Version: 1.20.0 TE1000
## Page 501

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Therm BYTE Number of times the light source temperature was al Derating Counter exceeded (0…253) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.36 FB_DALI253Query Light Source Thermal Shutdown The function block indicates whether there is a thermal shutdown on the DALI control gear due to the light source. The output b Light Source Thermal Shutdown contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 501
## Page 502

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Light Source Thermal Shutdown : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Light Source Therm BOOL The output is set as soon as the condition for a thermal al Shutdown shutdown of the light source is satisfied. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 502 Version: 1.20.0 TE1000
## Page 503

Programming 4.1.2.10.37 FB_DALI253Query Light Source Thermal Shutdown Counter The function block reads the counter that counts the number of thermal shutdowns of the light source. The output n Light Source Thermal Shutdown Counter contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Light Source Thermal Shutdown Counter : BYTE; END_VAR TE1000 Version: 1.20.0 503
## Page 504

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Light Source Therm BYTE Number of thermal shutdowns (0…253) al Shutdown Counter Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.38 FB_DALI253Query Light Source Voltage The function block reads the output voltage at the DALI control gear. The output f Light Source Voltage contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 504 Version: 1.20.0 TE1000
## Page 505

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; f Light Source Voltage : LREAL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. f Light Source Voltage LREAL Output voltage [V] (0.0…6553.3) Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 505
## Page 506

Programming 4.1.2.10.39 FB_DALI253Query Rated Median Useful Life Of Luminaire The function block indicates the estimated average lifetime of the complete luminaire, including all individual components. The function block FB_DALI253Set Rated Median Useful Life Of Luminaire [} 513] writes the value to the DALI control gear. The output n Rated Median Useful Life Of Luminaire contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Rated Median Useful Life Of Luminaire : BYTE; END_VAR 506 Version: 1.20.0 TE1000
## Page 507

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Rated Median Usefu BYTE Estimated average service life [1000 h]. The value lies l Life Of Luminaire within the range 0...253 as a multiple of the step size of 1000 h. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.40 FB_DALI253Query Rated Median Useful Light Source Starts The function block indicates the average number of possible starts of the complete luminaire, including all individual components. The function block FB_DALI253Set Rated Median Useful Light Source Starts [} 515] writes the value to the DALI control gear. The output n Rated Median Useful Light Source Starts contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 507
## Page 508

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Rated Median Useful Light Source Starts : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Rated Median Usefu UINT Number of average possible starts [100]. The value lies l Light Source Starts within the range 0...65533 as a multiple of the step size of 100. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 508 Version: 1.20.0 TE1000
## Page 509

Programming 4.1.2.10.41 FB_DALI253Set Internal Control Gear Reference Temperature The function block writes the internal reference temperature to the DALI control gear. The function block FB_DALI253Query Internal Control Gear Reference Temperature [} 479] reads the value from the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Lo w; n Internal Control Gear Reference Temperature : INT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Internal Control Gea INT Internal reference temperature [°C] (-60...193) r Reference Temperat ure Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 509
## Page 510

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.42 FB_DALI253Set Light Source On Time Resettable The function block sets the resettable operating hour counter of the light source to any desired value. If the light source is switched on, the resettable operating hour counter is incremented by one every second. The resettable operating hour counter can be read using the function block FB_DALI253Query Light Source On Time Resettable [} 483]. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Light Source On Time Resettable : UDINT; END_VAR 510 Version: 1.20.0 TE1000
## Page 511

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Light Source On Tim UDINT New value of the resettable operating hours counter [s] e Resettable (0…4294967293) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 TE1000 Version: 1.20.0 511
## Page 512

Programming 4.1.2.10.43 FB_DALI253Set Light Source Start Counter Resettable The function block sets the resettable counter for the switching on of the light source to any desired value. The resettable counter is incremented by one each time the light source changes from the Off state to the On state. The resettable counter can be read using the function block FB_DALI253Query Light Source Start Counter Resettable [} 495]. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Light Source Start Counter Resettable : UDINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Light Source Start Co UDINT New value of the resettable counter for the switching on of unter Resettable the light source (0...16777213) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 512 Version: 1.20.0 TE1000
## Page 513

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.10.44 FB_DALI253Set Rated Median Useful Life Of Luminaire The function block writes the estimated average lifetime of the complete luminaire to the DALI control gear. The function block FB_DALI253Query Rated Median Useful Life Of Luminaire [} 506] reads the value from the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Rated Median Useful Life Of Luminaire : BYTE; END_VAR TE1000 Version: 1.20.0 513
## Page 514

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Rated Median Usefu BYTE Estimated average service life [1000 h]. The input value is l Life Of Luminaire between 0 and 253, as a multiple of the step size of 1000 h. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 514 Version: 1.20.0 TE1000
## Page 515

Programming 4.1.2.10.45 FB_DALI253Set Rated Median Useful Light Source Starts The function block writes the average number of possible starts of the complete luminaire to the DALI control gear. The function block FB_DALI253Query Rated Median Useful Light Source Starts [} 507] reads the value from the DALI control gear. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Rated Median Useful Light Source Starts : UINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…15). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] e Command Priority has no function with the KL6811. The DALI command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Rated Median Usefu UINT Number of average possible starts. The input value is l Light Source Starts between 0 and 65533, as a multiple of the step size of 100. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 515
## Page 516

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.11 Part 301 (push button) 4.1.2.11.1 Introduction IEC 62386-301 describes DALI control devices that are defined as push buttons. DALI control devices according to IEC 62386-301 correspond to instance type 1. The type of an instance can be queried with the function block FB_DALI103Query Instance Type [} 206]. Input value The current state (input Value) of the push button can be queried via the function block FB_DALI103Query Input Value [} 199]. The value is 16#FF when the push button is actuated. The value is 16#00 when it is not actuated. Timer IEC 62386-301 defines specific timers with which the sending of the different events can be influenced. The respective time is calculated from 516 Version: 1.20.0 TE1000
## Page 517

Programming Time Multiplier Preset value T incre- T default T lowest T highest incr default min max of the multi- mental value value possible set possible set plier value value T t Short Max (25, t Sho 20 ms Max (25, t Sho t Short Min * 2 5100 ms short rt Min) rt Min) * 20 ms 0 ms T t Double 0 20 ms t Double Min * t Double Min * 2000 ms double 20 ms 20 ms T t Repeat 8 20 ms 160 ms 100 ms 2000 ms repeat T t Stuck 20 1 s 20 s 5 s 255 s stuck t Short Min: Vendor-specific (see t Short Min [} 536]). t Double Min: Vendor-specific (see t Double Min [} 537]). Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. Event filter DALI control devices are capable of sending different events. The event filter consists of an 8-bit value, where each individual bit defines whether an event is disabled or enabled. The event is enabled if the corresponding bit is set, otherwise it is disabled. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. The event filter (see event Filter [} 536]) must be configured accordingly in order to trigger time-controlled events. Bit Event Description 0 Button Released The push button was released. 1 Button Pressed The push button was pressed. 2 Short Press The push button was pressed and quickly released again without being pressed again (short button press). 3 Double Press The push button was pressed, released and quickly pressed again (double button press). 4 Long Press Start The push button was pressed without being released in between times (long button press). 5 Long Press Repeat If the push button was pressed for a long period (Long Press Start) without being released in between times, this event is sent at regular intervals. 6 Long Press Stop This event is sent if the push button is released after a long button press. 7 Button Free / Button Stuck If the push button is pressed for a very long time, it is assumed that it has stuck and the Button Stuck event is sent. Button Free is sent when the push button is detected as not pressed again. Release only those events that you need for the application. If too many events are sent, this can have a negative effect on the behavior of the application. Input Notification event With instance type 1 it is possible to release different events with the help of the event filter. All events are sent from the DALI control device by a Input Notification and can be received with FB_DALIGet Input Notification [} 890]. TE1000 Version: 1.20.0 517
## Page 518

Programming The possible events (Event Name column) and their binary representation (Event Information column) are listed in the following table. Event Name Event Information Description Button Released 2#00_0000_0000 The push button was released. Button Pressed 2#00_0000_0001 The push button was pressed. Short Press 2#00_0000_0010 The push button was pressed and quickly released again without being pressed again (short button press). Double Press 2#00_0000_0101 The push button was pressed, released and quickly pressed again (double button press). Long Press Start 2#00_0000_1001 The push button was pressed without being released in between times. Long Press Repeat 2#00_0000_1011 If the push button was pressed for a long period (Long Press Start) without being released in between times, this event is sent at regular intervals. Long Press Stop 2#00_0000_1100 This event is sent if the push button is released after a long button press. Button Free 2#00_0000_1110 Button Free is sent when the push button is detected as not pressed again following the Button Stuck event. Button Stuck 2#00_0000_1111 If the push button is pressed for a very long time, it is assumed that it has stuck and the Button Stuck event is sent. Short Press event The Short Press event is triggered when the push button is released again within the time T and not short pressed again for at least the time T . If the push button is pressed again within the time T , a new double double Short Press event can be triggered. Double Press event 518 Version: 1.20.0 TE1000
## Page 519

Programming The Double Press event is triggered when the push button is released within the time T and pressed short again before expiry of the time T . double Long Press Start, Long Press Repeat and Long Press Stop events The Long Press event is triggered when the push button still remains pressed after expiry of the time T . short The time T subsequently starts. The Long Press Repeat event is triggered if this time has expired. If the repeat push button remains pressed, the time T starts again and the Long Press Repeat event is triggered after repeat each expiry. The Long Press Stop event is triggered by releasing the push button. Button Free and Button Stuck events The Button Stuck event is triggered as soon as the push button was pressed for the time T without being stuck released in between times. The Button Free event occurs immediately if the push button is released after the Button Stuck event. The minimum set value for this time is 5 s; the default value is 20 s (see table above). Note that the Long Press event does not temporally overlap the Button Stuck event, therefore the value should not be set too small. TE1000 Version: 1.20.0 519
## Page 520

Programming 4.1.2.11.2 FB_DALI301Query Double Timer The function block reads the variable t Double [} 536]. The value is read in steps of 20 ms. The maximum permissible value is 2000 ms or 100. The value 0 disables the timer. The minimum permissible value can be queried with FB_DALI301Query Double Timer Min [} 521]. The output n Double contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; 520 Version: 1.20.0 TE1000
## Page 521

Programming b Busy : BOOL; n Double : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Double BYTE Value of the variable t Double [20 ms]. The maximum output value is 100, as a multiple of the step size of 20 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.3 FB_DALI301Query Double Timer Min The function block reads the variable t Double Min [} 537]. The value is read in steps of 20 ms. The output n Double Min contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 521
## Page 522

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Double Min : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Double Min BYTE Value of the variable t Double Min [20 ms]. 522 Version: 1.20.0 TE1000
## Page 523

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.4 FB_DALI301Query Repeat Timer The function block reads the variable t Repeat [} 537]. The value is read in steps of 20 ms. The permissible value range is from 100 ms to 2000 ms. It is output in numbers from 5 to 100. The output n Repeat only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 523
## Page 524

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Repeat : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Repeat BYTE Value of the variable t Repeat [20 ms]. The output value is between 5 and 100, as a multiple of the step size of 20 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 524 Version: 1.20.0 TE1000
## Page 525

Programming 4.1.2.11.5 FB_DALI301Query Short Timer The function block reads the variable t Short [} 536]. The value is read in steps of 20 ms. The maximum permissible value is 5100 ms, or 255. The minimum permissible value can be queried with FB_DALI301Query Short Timer Min [} 526]. The output n Short contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Short : BYTE; END_VAR TE1000 Version: 1.20.0 525
## Page 526

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Short BYTE Value of the variable t Short [20 ms]. The maximum output value is 255, as a multiple of the step size of 20 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.6 FB_DALI301Query Short Timer Min The function block reads the variable t Short Min [} 536]. The value is read in steps of 20 ms. The output n Short Min contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; 526 Version: 1.20.0 TE1000
## Page 527

Programming e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Short Min : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Short Min BYTE Value of the variable t Short Min [20 ms]. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 527
## Page 528

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.7 FB_DALI301Query Stuck Timer The function block reads the variable t Stuck [} 537]. The value is read in steps of 1 s. The permissible value range is 5 s to 255 s. The output n Stuck contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. 528 Version: 1.20.0 TE1000
## Page 529

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Stuck : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Stuck BYTE Value of the variable t Stuck [s]. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.8 FB_DALI301Set Double Timer The function block stores the value of n Double in the variable t Double [} 536] of the DALI control device. The value is written in steps of 20 ms. The maximum permissible value is 2000 ms, or 100. The value 0 disables the timer. The smallest permitted value can be queried with the function block FB_DALI301Query Double Timer Min [} 521]. The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 529
## Page 530

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Double : BYTE := 0; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Double BYTE Value of the variable t Double [20 ms]. The maximum input value is 100, as a multiple of the step size of 20 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 530 Version: 1.20.0 TE1000
## Page 531

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.9 FB_DALI301Set Repeat Timer The function block stores the value of n Repeat in the variable t Repeat [} 537] of the DALI control device. The value is written in steps of 20 ms. The permissible value range is 100 ms to 2000 ms, i.e. from 5 to 100. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Repeat : BYTE := 8; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 531
## Page 532

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Repeat BYTE Value of the variable t Repeat [20 ms]. The input value is between 2 and 100, as a multiple of the step size of 20 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.10 FB_DALI301Set Short Timer The function block stores the value of n Short in the variable t Short [} 536] of the DALI control device. The value is written in steps of 20 ms. The maximum permissible value is 5100 ms, or 255. The smallest permitted value can be queried with the function block FB_DALI301Query Short Timer Min [} 526]. 532 Version: 1.20.0 TE1000
## Page 533

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Short : BYTE := 25; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Short BYTE Value of the variable t Short [20 ms]. The maximum input value is 255, as a multiple of the step size of 20 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 533
## Page 534

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.11.11 FB_DALI301Set Stuck Timer The function block stores the value of n Stuck in the variable t Stuck [} 537] of the DALI control device. The value is read in steps of 1 s. The permissible value range is 5 s to 255 s. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Stuck : BYTE := 20; END_VAR 534 Version: 1.20.0 TE1000
## Page 535

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Stuck BYTE Value of the variable t Stuck [s] (5…255 s) Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 535
## Page 536

Programming 4.1.2.11.12 Variables Each instance of a DALI control device has a certain number of variables (parameters). These variables are used to configure the instance and thus influence its behavior. The values of the variables are stored in the respective DALI control device. Name Reset value Scope Size Comment resolution [} 536] No change 1 1 byte Read only event Filter [} 536] 2#1111_0100 2#XXXX_XXXX 1 byte t Short [} 536] Max(25, Short Min) t Short Min…255 1 byte t Short Min [} 536] No change 10…255 1 byte Read only t Double [} 536] 0 0, t Double Min…100 1 byte t Double Min [} 537] No change 10…100 1 byte Read only t Repeat [} 537] 8 5…100 1 byte t Stuck [} 537] 20 5…255 1 byte X: undetermined resolution Manufacturer-dependent value for the resolution of the input values. The value of the variable can be read out with the function block FB_DALI103Query Resolution [} 214]. event Filter Specific events for each instance are enabled or disabled with the event filter (see Event filter [} 517]). If the respective bit is set, the corresponding event is enabled, otherwise it is disabled. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. t Short The variable defines the time value for a short keystroke. After the time has elapsed, a long keystroke is detected. The value must be >= the value t Short Min. If t Short Min is < 25, then 25 is automatically adopted. According to the DALI standard, 25 (500 ms) is the physical minimum. The value is processed in steps of 20 ms. The function block FB_DALI301Query Short Timer [} 525] can be used to query the value, the function block FB_DALI301Set Short Timer [} 532] can be used to specify it. t Short Min The variable t Short Min is a minimum value specified by the manufacturer for detecting a short keystroke. The value can be queried with the function block FB_DALI301Query Short Timer Min [} 526]. t Double The variable t Double represents the time interval in which a repeated short keystroke must occur to be recognized as a double keystroke. If the value is 0, the double keystroke event is disabled. The value must be >= the value t Double Min. 100 is the maximum value of the variable. It corresponds to a time of 2000 ms for a step size of 20 ms. 536 Version: 1.20.0 TE1000
## Page 537

Programming The function block FB_DALI301Query Double Timer [} 520] can be used to query the value, the function block FB_DALI301Set Double Timer [} 529] can be used to specify it. t Double Min The variable t Double Min is a minimum value specified by the manufacturer for detecting a double keystroke. The value can be queried with the function block FB_DALI301Query Double Timer Min [} 521]. t Repeat The variable t Repeat specifies the interval for repeating an event when a long keystroke is executed. The value is given in steps of 20 ms. The permissible value range is 5 (100 ms) to 100 (2000 ms). The function block FB_DALI301Query Repeat Timer [} 523] can be used to query the value, the function block FB_DALI301Set Repeat Timer [} 531] can be used to specify it. t Stuck The variable t Stuck indicates the time after a keystroke from which the key is considered to be stuck or defective. The value is read in steps of 1 s. The permissible value range is 5 s to 255 s. The function block FB_DALI301Query Stuck Timer [} 528] can be used to query the value, the function block FB_DALI301Set Stuck Timer [} 534] can be used to specify it. 4.1.2.12 Part 302 (absolute input device) 4.1.2.12.1 Introduction IEC 62386-302 describes DALI control devices that are defined as absolute input device. DALI control devices according to IEC 62386-302 correspond to instance type 2. The type of an instance can be queried with the function block FB_DALI103Query Instance Type [} 206]. Input value The current state (input Value) of the absolute encoder can be queried via the function block FB_DALI103Query Input Value [} 199]. The variable can assume different values: input Value Slide resistor Analog input Switch or binary input 0 Minimum position Lower limit value Opened 1, 2resolution -2 Linear position display Linear display of the value Closed between the minimum and within the upper and lower maximum position (with a limits. resolution >2) 2resolution -1 Maximum position Upper limit value Closed Depending on the connected DALI control device, the input Value can assume values that depend on the resolution (see Samples [} 880]). Timer IEC 62386-302 defines specific timers with which the sending of the different events can be influenced. The respective time is calculated from TE1000 Version: 1.20.0 537
## Page 538

Programming Time Multiplier Preset value T Incre- T Default T lowest T highest incr default min max of the multi- mental value value possible set possible set plier value value T t Deadtime 2 50 ms 100 ms 0 s 12.75 s deadtime T t Report 0 1 s Vendor- 1 s 4 min 15 s report specific Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. Event filter DALI control devices are capable of sending different events. The event filter consists of an 8-bit value, where each individual bit defines whether an event is blocked or released. The event is released if the corresponding bit is set, otherwise it is blocked. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. The event filter (see event Filter [} 547]) must be configured accordingly in order to trigger time-controlled events. Bit Event Description 0 Position Report input Value has changed or the Report Timer has expired. 1 - Reserved 2 - Reserved 3 - Reserved 4 - Reserved 5 - Reserved 6 - Reserved 7 - Reserved Input Notification event With instance type 2 there is the possibility to release the event with the help of the event filter. The event is sent from the DALI control device by a Input Notification and can be received with FB_DALIGet Input Notification [} 890]. The following table lists the event. Event Name Event Information Description Position Report position If the resolution is less than or equal to 10, this event contains the current position (10 bits). If the resolution is greater than 10, the 10 MSB are transmitted with this event. Deadtime timer Several events may not be sent from an instance at the same time. To avoid this a dead time (T ) can deadtime be activated (see t Deadtime [} 547]). If the Deadtime Timer is active, an instance should not send any further events until the timer T has deadtime expired. The timer is restarted after the sending of an event. 538 Version: 1.20.0 TE1000
## Page 539

Programming If a new event occurs before the current event is sent, then the new event replaces the existing one. This can happen if the bus is not available or if the timer T is in use. deadtime If T < T , then T = T , regardless of which value T had before. report deadtime report deadtime report 4.1.2.12.2 FB_DALI302Query Deadtime Timer The function block reads the variable t Deadtime [} 547]. The value is read in steps of 50 ms. The permissible value range is from 0 s to 12.75 s. It is output in numbers from 0 to 255. The output n Deadtime contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 539
## Page 540

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Deadtime : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Deadtime BYTE Value of the variable t Deadtime [50 ms]. The output value is between 0 and 255, as a multiple of the step size of 50 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.12.3 FB_DALI302Query Report Timer The function block reads the variable t Report [} 547]. The value is read in steps of 1 s. The permissible value range is from 0 s to 4 min 15 s. It is output in numbers from 0 to 255. The output n Report contains a valid value only if the function block was executed without errors (b Error = FALSE). 540 Version: 1.20.0 TE1000
## Page 541

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Report : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Report BYTE Value of the variable t Report [1 s]. The output value is between 0 and 255, as a multiple of the step size of 1 s. TE1000 Version: 1.20.0 541
## Page 542

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.12.4 FB_DALI302Query Switch The function block queries whether the instance represents a switch. The output b Switch only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] 542 Version: 1.20.0 TE1000
## Page 543

Programming The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Switch : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Switch BOOL The output is set if the instance represents a switch. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.12.5 FB_DALI302Set Deadtime Timer The function block stores the value of n Deadtime in the variable t Deadtime [} 547] of the DALI control device. The value is written in steps of 50 ms. The permissible value range is 0 s to 12.75 s. It is entered in numbers from 0 to 255. TE1000 Version: 1.20.0 543
## Page 544

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Deadtime : BYTE := 2; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Deadime BYTE Value of the variable t Deadtime [50 ms]. The input value is between 0 and 255, as a multiple of the step size of 50 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 544 Version: 1.20.0 TE1000
## Page 545

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.12.6 FB_DALI302Set Report Timer The function block stores the value of n Report in the variable t Report [} 547] of the DALI control device. The value is written in steps of 1 s. The permissible value range is 0 s to 4 min 15 s. It is entered in numbers from 0 to 255. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Report : BYTE := 0; END_VAR TE1000 Version: 1.20.0 545
## Page 546

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Report BYTE Value of the variable t Report [1 s]. The input value is between 0 and 255, as a multiple of the step size of 1 s. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 546 Version: 1.20.0 TE1000
## Page 547

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.1.2.12.7 Variables Each instance of a DALI control device has a certain number of variables (parameters). These variables are used to configure the instance and thus influence its behavior. The values of the variables are stored in the respective DALI control device. Name Reset value Scope Size Comment even Filter [} 547] 2#0000_0001 2#0000_000X 1 byte t Deadtime [} 547] 2 0…255 1 byte t Report [} 547] 0 0…255 1 byte X: undetermined event Filter Specific events for each instance are enabled or disabled with the event filter (see Event filter [} 538]). If the respective bit is set, the corresponding event is enabled, otherwise it is disabled. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. t Deadtime The variable t Deadtime defines the time value for a dead time in which no new event is sent until the dead time has expired. If this timer is active, it is restarted after each transmitted event. If the value is 0, the dead time event is disabled. The value is given in steps of 50 ms. The permissible value range is 0 to 255 (12.75 s). The function block FB_DALI302Query Deadtime Timer [} 539] can be used to query the value, the function block FB_DALI302Set Deadtime Timer [} 543] can be used to specify it. t Report The variable t Report specifies the report time of an absolute input device after the occurrence of an event. On expiry of the time specified in the variable t Report, an event is triggered and the time is restarted. If an event was triggered before the expiry of the time t Report, the time starts over. The value is given in steps of 1 s. The permissible value range is 0 (0 s) to 255 (4 min 15 s). The function block FB_DALI302Query Report Timer [} 540] can be used to query the value, the function block FB_DALI302Set Report Timer [} 545] can be used to specify it. 4.1.2.13 Part 303 (occupancy sensor) 4.1.2.13.1 Introduction IEC 62386-303 describes DALI control devices that are defined as occupancy sensors. DALI control devices according to IEC 62386-303 correspond to instance type 3. The type of an instance can be queried with the function block FB_DALI103Query Instance Type [} 206]. TE1000 Version: 1.20.0 547
## Page 548

Programming Input value The current state (input Value) of the light sensor can be queried via the function block FB_DALI103Query Input Value [} 199]. The variable can assume four values: input Value Occupancy Movement 16#00 No No 16#55 No Yes 16#AA Yes No 16#FF Yes Yes For simplification the graphics below only show whether an area is occupied or vacant. Timer IEC 62386-303 defines specific timers with which the sending of the different events can be influenced. The respective time is calculated from Time Multiplier Preset value T Incre- T Default T lowest T highest incr default min max of the multi- mental value value possible set possible set plier value value T t Deadtime 2 50 ms 100 ms 0 s 12.75 s deadtime T t Hold 90 10 s 15 min 1 s 42 min 20 s hold T t Report 20 1 s 20 s 1 s 4 min 15 s report Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. Event filter DALI control devices are capable of sending different events. The event filter consists of an 8-bit value, where each individual bit defines whether an event is blocked or released. The event is released if the corresponding bit is set, otherwise it is blocked. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. The event filter (see event Filter [} 565]) must be configured accordingly in order to trigger time-controlled events. Bit Event Description 0 Occupied Occupancy detection 1 Vacant Area vacant detection 2 Repeat Event repeat 3 Movement Movement detection 4 No Movement No Movement detection 5 - reserved 6 - reserved 7 - reserved 548 Version: 1.20.0 TE1000
## Page 549

Programming Release only those events that you need for the application. If too many events are sent, this can have a negative effect on the behavior of the application. Input Notification event With instance type 3 it is possible to release different events with the help of the event filter. All events are sent from the DALI control device by a Input Notification and can be received with FB_DALIGet Input Notification [} 890]. The possible events (Event Name column) and their binary representation (Event Information column) are listed in the following table. Event Name Event Information Description No Movement 2#00_0000_XXX0 No movement detected. Movement 2#00_0000_XXX1 Movement detected. Vacant 2#00_0000_X00X The area is not occupied. Still Vacant 2#00_0000_X10X The area is vacant over a lengthy period. The event occurs at regular intervals as long as the vacant condition is satisfied. Occupied 2#00_0000_X01X The area is occupied. Still Occupied 2#00_0000_X11X The area is occupied over a lengthy period. The event occurs at regular intervals as long as the occupied condition is satisfied. Presence Sensor 2#00_0000_0XXX The current event was triggered by an occupancy sensor. Movement Sensor 2#00_0000_1XXX The current event was triggered by a movement sensor. The points marked with X can assume a value of either 0 or 1 and thus combine several events with one another. Motion sensor The instance detects exclusively whether there is movement in the room or not. If no movement was detected within a certain time, the area is regarded as vacant. Occupancy sensor The instance detects occupancy of the room. Some devices detect occupancy and movement. Further information can be found in IEC 62386-303. TE1000 Version: 1.20.0 549
## Page 550

Programming Events with HOLD TIMER On expiry, the time T triggers the "Repeat" event (bit 2 of the event filter) (see t Report [} 566]). The time report then starts over. The previous event remains active during the time T . T is restarted by a newly report report detected event. T provides for a hold time following the detection of movement (see t Hold [} 565]). Not all devices support hold this variable. Events with CANCEL HOLD TIMER If the DALI device supports the hold timer, it can be deactivated via the command FB_DALI303Cancel Hold Timer [} 551]. The hold timer was deactivated before the expiry of its set time. The Vacant und No Movement events are triggered immediately at this moment. Deadtime timer Several events may not be sent from an instance at the same time. To avoid this a dead time (T ) can deadtime be activated (see t Deadtime [} 565]). If the Deadtime Timer is active, an instance should not send any further events until the timer T has deadtime expired. The timer is restarted after the sending of an event. 550 Version: 1.20.0 TE1000
## Page 551

Programming If a new event occurs before the current event is sent, then the new event replaces the existing one. This can happen if the bus is not available or if the timer T is in use. Deadtime If T < T , then T should be equal to T regardless of the value that T previously had. report deadtime report deadtime report 4.1.2.13.2 FB_DALI303Cancel Hold Timer The function block ends the Hold Timer prematurely if the latter was implemented in the DALI control device. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 551
## Page 552

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.3 FB_DALI303Catch Movement Catching is activated for the DALI control devices by this function block. If the DALI control device detects motion, an event is sent once and the Catching is reset. The Event Filter [} 565] should be set so that the Movement event is disabled. This ensures that the event is only sent once as soon as Catching is active and movement is detected. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 552 Version: 1.20.0 TE1000
## Page 553

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 553
## Page 554

Programming 4.1.2.13.4 FB_DALI303Query Catching The function block queries whether Catching is active. The Catching can be enabled by FB_DALI303Catch Movement [} 552]. The output b Catching contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; b Catching : BOOL; END_VAR 554 Version: 1.20.0 TE1000
## Page 555

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. b Catching BOOL Catching is active. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.5 FB_DALI303Query Deadtime Timer The function block reads the variable t Deadtime [} 565]. The value is read in steps of 50 ms. The permissible value range is from 0 s to 12.75 s. It is output in numbers from 0 to 255. The output n Deadtime contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR TE1000 Version: 1.20.0 555
## Page 556

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Deadtime : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Deadtime BYTE Value of the variable t Deadtime [50 ms]. The output value is between 0 and 255, as a multiple of the step size of 50 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 556 Version: 1.20.0 TE1000
## Page 557

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.6 FB_DALI303Query Hold Timer The function block reads the variable t Hold [} 565]. The value is read in steps of 10 s. The permissible value range is from 1 s to 42.5 min. It is output in numbers from 0 to 254. The output n Hold only contains a valid value if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 557
## Page 558

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Hold : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Hold BYTE Value of the variable t Hold [10 s]. The output value is between 1 s and 42.5 min, as a multiple of the step size of 10 s. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.7 FB_DALI303Query Report Timer The function block reads the variable t Report [} 566]. The value is read in steps of 1 s. The permissible value range is from 0 s to 4 min 15 s. It is output in numbers from 0 to 255. The output n Report contains a valid value only if the function block was executed without errors (b Error = FALSE). The function block cannot be used when using the KL6811. 558 Version: 1.20.0 TE1000
## Page 559

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Report : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Report BYTE Value of the variable t Report [1 s]. The output value is between 0 and 255, as a multiple of the step size of 1 s. TE1000 Version: 1.20.0 559
## Page 560

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.8 FB_DALI303Set Deadtime Timer The function block stores the value of n Deadtime in the variable t Deadtime [} 565] of the DALI control device. The value is written in steps of 50 ms. The permissible value range is 0 s to 12.75 s. It is entered in numbers from 0 to 255. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Deadtime : BYTE := 2; END_VAR 560 Version: 1.20.0 TE1000
## Page 561

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Deadime BYTE Value of the variable t Deadtime [50 ms]. The input value is between 0 and 255, as a multiple of the step size of 50 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 561
## Page 562

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.9 FB_DALI303Set Hold Timer The function block stores the value of n Hold in the variable t Hold [} 565] of the DALI control device. The value is written in steps of 10 s. The permissible value range is 1 s to 42.3 min. It is entered in numbers from 0 to 254. If the value 0 is passed, the variable t Hold is set to 1 s. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Hold : BYTE := 90; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Hold BYTE Value of the variable t Hold [10 s]. The input value is between 0 and 254, as a multiple of the step size of 10 s. 562 Version: 1.20.0 TE1000
## Page 563

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.10 FB_DALI303Set Report Timer The function block stores the value of n Report in the variable t Report [} 566] of the DALI control device. The value is written in steps of 1 s. The permissible value range is 0 s to 4 min 15 s. It is entered in numbers from 0 to 255. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; TE1000 Version: 1.20.0 563
## Page 564

Programming e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Report : BYTE := 20; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Report BYTE Value of the variable t Report [5 s]. The input value is between 0 and 255, as a multiple of the step size of 5 s. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 564 Version: 1.20.0 TE1000
## Page 565

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.13.11 Variables Each instance of a DALI control device has a certain number of variables (parameters). These variables are used to configure the instance and thus influence its behavior. The values of the variables are stored in the respective DALI control device. Name Reset value Scope Size Comment resolution [} 565] No change 2 1 byte Read only event Filter [} 565] 2#0000_0011 2#000X_XXXX 1 byte t Deadtime [} 565] 2 0…255 1 byte t Hold [} 565] 90 0…254 1 byte t Report [} 566] 20 0…255 1 byte X: not specified resolution Manufacturer-dependent value for the resolution of the input values. The value of the variable can be read out with the function block FB_DALI103Query Resolution [} 214]. event Filter Specific events for each instance are enabled or disabled with the event filter (see Event filter [} 548]). If the respective bit is set, the corresponding event is enabled, otherwise it is disabled. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. t Deadtime The variable defines the time value for a dead time in which no new event is sent until the dead time has elapsed. If this timer is active, it is restarted after each transmitted event. If the value is 0, the dead time event is disabled. The value is given in steps of 50 ms. The permissible value range is 0 to 255 (12.75 s). The function block FB_DALI303Query Deadtime Timer [} 555] can be used to query the value, the function block FB_DALI303Set Deadtime Timer [} 560] can be used to specify it. t Hold The variable t Hold specifies the hold time of an occupancy sensor after presence detection. Not all devices support this variable. TE1000 Version: 1.20.0 565
## Page 566

Programming The value is given in steps of 10 s. The permissible value range is 0 (1 s) to 254 (42.5 min). The function block FB_DALI303Query Hold Timer [} 557] can be used to query the value, the function block FB_DALI303Set Hold Timer [} 562] can be used to specify it. The hold time t Hold can be terminated prematurely with the function block FB_DALI303Cancel Hold Timer [} 551]. t Report The variable t Report specifies the report time of an occupancy sensor after the occurrence of an event. After the time specified in the variable t Report has elapsed, the repeat event from the event filter is enabled. This keeps the occupied event active. The value is given in steps of 1 s. The permissible value range is 0 (0 s) to 255 (4 min 15 s). The function block FB_DALI303Query Report Timer [} 558] can be used to query the value, the function block FB_DALI303Set Report Timer [} 563] can be used to specify it. 4.1.2.14 Part 304 (light sensors) 4.1.2.14.1 Introduction IEC 62386-304 describes DALI control devices that are defined as brightness sensors. DALI control devices according to IEC 62386-304 correspond to instance type 4. The type of an instance can be queried with the function block FB_DALI103Query Instance Type [} 206]. Input value The current state (input Value) of the light sensor can be queried via the function block FB_DALI103Query Input Value [} 199]. Timer IEC 62386-304 defines various timers for triggering device-specific events. The event for the instance type 4 in conjunction with the associated timers is explained below. The respective time is calculated from Time Multiplier Preset value T Incre- T Default T lowest T highest incr default min max of the multi- mental value value possible set possible set plier value value T t Deadtime 30 50 ms 1.5 s 0 s 12.75 s deadtime T t Report 30 1 s 30 s 1 s 4 min 15 s report Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. Event filter DALI control devices are capable of sending different events. The event filter consists of an 8-bit value, where each individual bit defines whether an event is blocked or released. The event is released if the corresponding bit is set, otherwise it is blocked. 566 Version: 1.20.0 TE1000
## Page 567

Programming The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. The event filter (see event Filter [} 582]) must be configured accordingly in order to trigger time-controlled events. Bit Event Description 0 Illuminance level report Illuminance event 1 - reserved 2 - reserved 3 - reserved 4 - reserved 5 - reserved 6 - reserved 7 - reserved Input Notification event With instance type 4 there is the possibility to release the event with the help of the event filter. The event is sent from the DALI control device by a Input Notification and can be received with FB_DALIGet Input Notification [} 890]. The following table lists the event. Event Name Event Information Description Illuminance Level Event position If the resolution is less than or equal to 10, this event contains the current input value (10 bits). If the resolution is greater than 10, only a change of the input value is communicated with this event. This can then be read with FB_DALI103Query Input Value [} 199]. Hysteresis To avoid too frequent, disruptive changes of the illuminance, it is possible with DALI devices with the instance type 4 to define a hysteresis. A percentage value can be specified via the hysteresis [} 583] variable for the calculation of a hysteresis band. The value can be queried with the function block FB_DALI304Query Hysteresis [} 570] and specified with FB_DALI304Set Hysteresis [} 577]. Since the percentage hysteresis can also lead to wide fluctuations at low illuminance, a minimum hysteresis can be specified via the variable hysteresis Min [} 582]. The minimum hysteresis is an absolute value with a range from 0 to 255. The reset value depends on the resolution of the input values specified by the vendor. TE1000 Version: 1.20.0 567
## Page 568

Programming resolution Vendor-dependent reset value 1…6 0 7 1 8 2 9 5 10 10 11 20 12 40 13 81 14 163 > 15 255 The value can be queried with the function block FB_DALI304Query Hysteresis Min [} 572] and specified manually with FB_DALI304Set Hysteresis Min [} 578]. Event Illuminance Level Report The illuminance event is triggered each time an input Value lies outside of the hysteresis band. As described above, the hysteresis band is calculated from the percentage hysteresis of the input value and the value of the minimum hysteresis. The upper and lower points of the hysteresis band are called hysteresis Band High and hysteresis Band Low respectively. The illuminance event is generated when the input Value is greater than the calculated value hysteresis Band High or smaller than hysteresis Band Low. It is also generated when the time T has expired, irrespective of the current input value. report The example shows the change in the input value with the resulting hysteresis band and the report timer T . The value for hysteresis is 10% and the value for hysteresis Min is 50. report The Illuminance Level Report event is generated at the measuring points 1, 2, 4, 5, 6, 8 and 10 through the change in the input value beyond the limits of the defined hysteresis band. No illuminance event is generated at the measuring points 3, 7 and 9 because the measured illuminance is within the hysteresis band and the timer T (see t Report [} 566]) has not yet expired. On expiry of the timer T the event is generated at a report report later time (between the measuring points 3 and 4, 7 and 8, 9 and 10). 568 Version: 1.20.0 TE1000
## Page 569

Programming Deadtime timer Several events may not be sent from an instance at the same time. To avoid this a dead time (T ) can deadtime be activated (see t Deadtime [} 565]). If the Deadtime Timer is active, an instance should not send any further events until the timer T has deadtime expired. The timer is restarted after the sending of an event. If a new event occurs before the current event is sent, then the new event replaces the existing one. This can happen if the bus is not available or if the timer T is in use. Deadtime If T < T , then T should be equal to T regardless of the value that T previously had. report deadtime report deadtime report 4.1.2.14.2 FB_DALI304Query Deadtime Timer The function block reads the variable t Deadtime [} 582]. The value is read in steps of 50 ms. The permissible value range is 0 s to 12.75 s. It is output in numbers from 0 to 255. The function block cannot be used when using the KL6811. The output n Deadtime contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 569
## Page 570

Programming The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Deadtime : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Deadtime BYTE Value of the variable t Deadtime [50 ms]. The output value is between 0 and 255, as a multiple of the step size of 50 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.3 FB_DALI304Query Hysteresis The function block reads the variable hysteresis [} 583]. The value is stated in %. The permissible value range is between 0% and 25%. 570 Version: 1.20.0 TE1000
## Page 571

Programming The function block cannot be used when using the KL6811. The output n Hysteresis contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Hysteresis : BYTE; END_VAR TE1000 Version: 1.20.0 571
## Page 572

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Hysteresis BYTE Value of the variable hysteresis in %. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.4 FB_DALI304Query Hysteresis Min The function block reads the variable hysteresis Min [} 582]. The permissible value range is between 0 and 255. Since the hysteresis is given as a percentage, the absolute value of the hysteresis depends on the actual measured value. For very small measured values, the hysteresis is therefore also very small. This causes unnecessary events to be sent. For this reason, a minimum possible hysteresis can be set. The function block cannot be used when using the KL6811. The output n Hysteresis Min contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; 572 Version: 1.20.0 TE1000
## Page 573

Programming n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Hysteresis Min : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Hysteresis Min BYTE Value of the smallest possible hysteresis. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 573
## Page 574

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.5 FB_DALI304Query Report Timer The function block reads the variable t Report [} 582]. The value is read in steps of 1 s. The permissible value range is 0 s to 4 min 15 s. It is output in numbers from 0 to 255. The function block cannot be used when using the KL6811. The output n Report contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. 574 Version: 1.20.0 TE1000
## Page 575

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Report : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Report BYTE Value of the variable t Report [1 s]. The output value is between 0 and 255, as a multiple of the step size of 1 s. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.6 FB_DALI304Set Deadtime Timer The function block stores the value of n Deadtime in the variable t Deadtime [} 582] of the DALI control device. The value is written in steps of 50 ms. The permissible value range is 0 s to 12.75 s. It is entered in numbers from 0 to 255. The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 575
## Page 576

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Deadtime : BYTE := 30; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Deadime BYTE Value of the variable t Deadtime [50 ms]. The input value is between 0 and 255, as a multiple of the step size of 50 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 576 Version: 1.20.0 TE1000
## Page 577

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.7 FB_DALI304Set Hysteresis The function block stores the value n Hysteresis in the variable hysteresis [} 583] of the DALI control device. The value is stated in %. The permissible value range is between 0% and 25%. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Hysteresis : BYTE := 5; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 577
## Page 578

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Hysteresis BYTE Input value of the variable hysteresis in % (0…25 %). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.8 FB_DALI304Set Hysteresis Min The function block stores the value n Hysteresis Min in the variable hysteresis Min [} 582] of the DALI control device. 578 Version: 1.20.0 TE1000
## Page 579

Programming Since the hysteresis is given as a percentage, the absolute value of the hysteresis depends on the actual measured value. For very small measured values, the hysteresis is therefore also very small. This causes unnecessary events to be sent. For this reason, a minimum possible hysteresis can be set. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Hysteresis Min : BYTE := 10; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Hysteresis Min BYTE Value of the smallest possible hysteresis hysteresis Min. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 579
## Page 580

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.9 FB_DALI304Set Report Timer The function block stores the value of n Report in the variable t Report [} 582] of the DALI control device. The value is written in steps of 1 s. The permissible value range is 0 s to 4 min 15 s. It is entered in numbers from 0 to 255. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Report : BYTE := 30; END_VAR 580 Version: 1.20.0 TE1000
## Page 581

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Report BYTE Value of the variable t Report [5 s]. The input value is between 0 and 255, as a multiple of the step size of 5 s. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 581
## Page 582

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.2.14.10 Variables Each instance of a DALI control device has a certain number of variables (parameters). These variables are used to configure the instance and thus influence its behavior. The values of the variables are stored in the respective DALI control device. Name Reset value Scope Size Comment event Filter [} 582] 2#0000_0001 2#0000_000X 1 byte t Report [} 582] 30 0…255 1 byte t Deadtime [} 582] 30 0…255 1 byte hysteresis Min [} 582] See table 0…255 1 byte hysteresis [} 583] 5 0…25 1 byte X: not specified event Filter Specific events for each instance are enabled or disabled with the event filter (see Event filter [} 566]). If the respective bit is set, the corresponding event is enabled, otherwise it is disabled. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. t Report The variable t Report specifies the report time of a brightness sensor after the occurrence of an event. The report time is restarted when a new event is sent. The value is given in steps of 1 s. The permissible value range is 0 (0 s) to 255 (4 min 15 s). The function block FB_DALI304Query Report Timer [} 574] can be used to query the value, the function block FB_DALI304Set Report Timer [} 580] can be used to specify it. t Deadtime The variable defines the time value for a dead time in which no new event is sent until the dead time has elapsed. If this timer is active, it is restarted after each transmitted event. If the value is 0, the dead time event is disabled. The value is given in steps of 50 ms. The permissible value range is 0 to 255 (12.75 s). The function block FB_DALI304Query Deadtime Timer [} 569] can be used to query the value, the function block FB_DALI304Set Deadtime Timer [} 575] can be used to specify it. hysteresis Min The variable hysteresis Min prevents large fluctuations in the illumination at low illuminance and thus low- percentage hysteresis. The variable is an absolute value with a value range between 0 and 255. The reset value depends on the resolution of the input values specified by the vendor. 582 Version: 1.20.0 TE1000
## Page 583

Programming Resolution Vendor-dependent reset value 1…6 0 7 1 8 2 9 5 10 10 11 20 12 40 13 81 14 163 >= 15 255 The function block FB_DALI304Query Hysteresis Min [} 572] can be used to query the value, the function block FB_DALI304Set Hysteresis Min [} 578] can be used to specify it. hysteresis The variable hysteresis indicates a percentage value of the hysteresis around a measured illuminance. A value of 0 disables the hysteresis. The function block FB_DALI304Query Hysteresis [} 570] can be used to query the value, the function block FB_DALI304Set Hysteresis [} 577] can be used to specify it. 4.1.2.15 Part 306 (general purpose sensors) 4.1.2.15.1 Introduction IEC 62386-306 describes DALI control devices that are defined as general purpose sensors. DALI control devices according to IEC 62386-306 correspond to instance type 6. The type of an instance can be queried with the function block FB_DALI103Query Instance Type [} 206]. Input value The function block FB_DALI103Query Input Value [} 199] can be used to query the current state (input Value) of the general purpose sensor. Timer IEC 62386-306 defines various timers for triggering device-specific events. The event for the instance type 6 in conjunction with the associated timers is explained below. The respective time is calculated from Time Multiplier Preset value T Incre- T Default T lowest T highest incr default min max of the multi- mental value value possible set possible set plier value value T t Deadtime 30 50 ms 1.5 s 0 s 12.75 s deadtime T t Report 30 5 s 2 min 30 s 5 s 21 min 15 s report T t Alarm Report 30 5 s 2 min 30 s 5 s 21 min 15 s alarm Report TE1000 Version: 1.20.0 583
## Page 584

Programming Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. Event filter DALI control devices are capable of sending different events. The event filter consists of an 8-bit value, where each individual bit defines whether an event is blocked or released. The event is released if the corresponding bit is set, otherwise it is blocked. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. The event filter (see event Filter [} 612]) must be configured accordingly in order to trigger time-controlled events. Bit Event Description 0 Measured value report Measured Value Report event activated. 1 Alarm 0 activated Alarm 0 activated-Event is active. 2 Alarm 0 deactivated Alarm 0 deactivated-Event is active. 3 Alarm 1 activated Alarm 1 activated-Event is active. 4 Alarm 1 deactivated Alarm 1 deactivated-Event is active. 5 Alarm 2 activated Alarm 2 activated-Event is active. 6 Alarm 2 deactivated Alarm 2 deactivated-Event is active. 7 Alarm 3 activated Alarm 3 activated-Event is active. 8 Alarm 3 deactivated Alarm 3 deactivated-Event is active. 9…15 - Reserved Input Notification event With instance type 6 there is the possibility to release the event with the help of the event filter. The event is sent from the DALI control device by a Input Notification and can be received with FB_DALIGet Input Notification [} 890]. The events are listed in the following table. 584 Version: 1.20.0 TE1000
## Page 585

Programming Event Name Event Information Description Measured Value 2#1X_XXXX_XXXX The event contains the current measured value (9 bits). If the resolution is greater than 9, only a change of the input value is communicated with this event. This can then be read with FB_DALI103Query Input Value [} 199]. If the resolution is less than or equal to 9, this event contains the current input value. Alarm 0 2#00_XXXX_XX00 alarm Is Activated[0] is 0 and has not changed since the last alarm event transmission. 2#00_XXXX_XX01 alarm Is Activated[0] is 1 and has not changed since the last alarm event transmission. 2#00_XXXX_XX10 alarm Is Activated[0] is 0 and has changed since the last alarm event transmission. 2#00_XXXX_XX11 alarm Is Activated[0] is 1 and has changed since the last alarm event transmission. Alarm 1 2#00_XXXX_00XX alarm Is Activated[1] is 0 and has not changed since the last alarm event transmission. 2#00_XXXX_01XX alarm Is Activated[1] is 1 and has not changed since the last alarm event transmission. 2#00_XXXX_10XX alarm Is Activated[1] is 0 and has changed since the last alarm event transmission. 2#00_XXXX_11XX alarm Is Activated[1] is 1 and has changed since the last alarm event transmission. Alarm 2 2#00_XX00_XXXX alarm Is Activated[2] is 0 and has not changed since the last alarm event transmission. 2#00_XX01_XXXX alarm Is Activated[2] is 1 and has not changed since the last alarm event transmission. 2#00_XX10_XXXX alarm Is Activated[2] is 0 and has changed since the last alarm event transmission. 2#00_XX11_XXXX alarm Is Activated[2] is 1 and has changed since the last alarm event transmission. Alarm 3 2#00_00XX_XXXX alarm Is Activated[3] is 0 and has not changed since the last alarm event transmission. 2#00_01XX_XXXX alarm Is Activated[3] is 1 and has not changed since the last alarm event transmission. 2#00_10XX_XXXX alarm Is Activated[3] is 0 and has changed since the last alarm event transmission. 2#00_11XX_XXXX alarm Is Activated[3] is 1 and has changed since the last alarm event transmission. The points marked with X can either assume the value 0 or 1 and thus combine several events or output the measured value. Hysteresis To avoid too frequent, disturbing changes of the output value, it is possible to define a hysteresis for DALI devices with instance type 6. A percentage value can be specified via the hysteresis [} 613] variable for the calculation of a hysteresis band. The function block FB_DALI306Query Hysteresis [} 589] can be used to query the value, the function block FB_DALI306Set Hysteresis [} 604] can be used to specify it. As the percentage hysteresis can lead to strong fluctuations with a low measured value, a minimum hysteresis can be specified via the variable hysteresis Min [} 613]. The minimum hysteresis is an absolute value with a range from 0 to 255. TE1000 Version: 1.20.0 585
## Page 586

Programming The reset value depends on the resolution of the input values specified by the vendor. resolution Vendor-dependent reset value 1…6 0 7 1 8 2 9 5 10 10 11 20 12 40 13 81 14 163 > 15 255 The function block FB_DALI306Query Hysteresis Min [} 591] can be used to query the value, the function block FB_DALI306Set Hysteresis Min [} 606] can be used to specify it manually. Deadtime timer Several events may not be sent from an instance at the same time. To avoid this a dead time (T ) can deadtime be activated (see t Deadtime [} 612]). If the Deadtime Timer is active, an instance should not send any further events until the timer T has deadtime expired. The timer is restarted after the sending of an event. If a new event occurs before the current event is sent, then the new event replaces the existing one. This can happen if the bus is not available or if the timer T is in use. Deadtime If T < T , then T = T , regardless of which value T had before. report deadtime report deadtime report If T < T , then T = T , regardless of the previous value of T . alarm Report deadtime alarm Report deadtime alarm Report 4.1.2.15.2 FB_DALI306Query Alarm Report Timer The function block reads the variable t Alarm Report. The value is read in steps of 1 s. The permissible value range is from 0 s to 4 min 15 s. It is output in numbers from 0 to 255. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR 586 Version: 1.20.0 TE1000
## Page 587

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Alarm Report : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Alarm Report BYTE Value of the variable t Alarm Report [1 s]. The output value is between 0 and 255, as a multiple of the step size of 1 s. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 TE1000 Version: 1.20.0 587
## Page 588

Programming 4.1.2.15.3 FB_DALI306Query Deadtime Timer The function block reads the variable t Deadtime [} 612]. The value is read in steps of 50 ms. The permissible value range is from 0 s to 12.75 s. It is output in numbers from 0 to 255. The function block cannot be used when using the KL6811. The output n Deadtime contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Deadtime : BYTE; END_VAR 588 Version: 1.20.0 TE1000
## Page 589

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Deadtime BYTE Value of the variable t Deadtime [50 ms]. The output value is between 0 and 255, as a multiple of the step size of 50 ms. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.4 FB_DALI306Query Hysteresis The function block reads the variable hysteresis [} 613]. The value is stated in %. The permissible value range is between 0% and 25%. The function block cannot be used when using the KL6811. The output n Hysteresis contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; TE1000 Version: 1.20.0 589
## Page 590

Programming e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Hysteresis : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Hysteresis BYTE Value of the variable hysteresis [} 613] in %. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 590 Version: 1.20.0 TE1000
## Page 591

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.5 FB_DALI306Query Hysteresis Min The function block reads the variable hysteresis Min [} 613]. The permissible value range is between 0 and 255. Since the hysteresis is given as a percentage, the absolute value of the hysteresis depends on the actual measured value. For very small measured values, the hysteresis is therefore also very small. This causes unnecessary events to be sent. For this reason, a minimum possible hysteresis can be set. The function block cannot be used when using the KL6811. The output n Hysteresis Min contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. TE1000 Version: 1.20.0 591
## Page 592

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Hysteresis Min : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Hysteresis Min BYTE Value of the smallest possible hysteresis. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.6 FB_DALI306Query Measurement Variable The function block reads a measured value defined by the e Measurement Variable parameter from the DALI control device and outputs the value at the output n Measurement Variable. The function block changes the DTR0 of all connected DALI control devices. The function block cannot be used when using the KL6811. 592 Version: 1.20.0 TE1000
## Page 593

Programming The output n Measurement Variable only contains a valid value if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Measurement Variable : E_DALIMeasurement Variable; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Measurement Varia E_DALIMeasurement Varia Variable to be read from the DALI control device. ble ble [} 913] Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Measurement Variable : BYTE; END_VAR TE1000 Version: 1.20.0 593
## Page 594

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Measurement Varia BYTE Contains the value of the read variable. ble Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.7 FB_DALI306Query Report Timer The function block reads the variable t Report [} 612]. The value is read in steps of 5 s. The permissible value range is from 0 s to 21 min 15 s. It is output in numbers from 0 to 255. The function block cannot be used when using the KL6811. The output n Report contains a valid value only if the function block was executed without errors (b Error = FALSE). Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; 594 Version: 1.20.0 TE1000
## Page 595

Programming e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Report : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Report BYTE Value of the variable t Report [5 s]. The output value is between 0 and 255, as a multiple of the step size of 5 s. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 595
## Page 596

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.8 FB_DALI306Set Alarm The function block saves the value n Alarm Level in the DALI control device. The input e Alarm Number specifies for which alarm (Alarm 0 ... Alarm 3) the alarm level is to be saved. The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control devices. The function block sends the DALI command SET ALARM twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Alarm Number : E_DALIAlarm Number; n Alarm Level : DINT := 16#3F_FF_FF; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] 596 Version: 1.20.0 TE1000
## Page 597

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Alarm Number E_DALI_Alarm Number Defines for which alarm (alarm0...alarm3) the alarm level is written. [} 904] n Alarm Level DINT Input value of the alarm level (0...4194303). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Report : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Report BYTE Value of the variable t Report [1 s]. The output value is between 0 and 255, as a multiple of the step size of 1 s. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.9 FB_DALI306Set Alarm Hysteresis TE1000 Version: 1.20.0 597
## Page 598

Programming The function block saves the value n Alarm Hysteresis in the DALI control device. The input e Alarm Number specifies for which alarm (Alarm 0 ... Alarm 3) the alarm hysteresis is to be saved. The function block changes the DTR0, DTR1 and DTR2 of all connected DALI control devices. The function block sends the DALI command SET ALARM HYSTERESIS twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Alarm Hysteresis : E_DALIAlarm Hysteresis; n Alarm Hysteresis : DINT; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Alarm Hysteresis E_DALIAlarm Hysteresis Defines for which alarm (alarm0...alarm3) the hysteresis is written. [} 904] n Alarm Hysteresis DINT Input value of the alarm hysteresis (0...4194303). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR 598 Version: 1.20.0 TE1000
## Page 599

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.10 FB_DALI306Set Alarm Report Timer The function block saves the value n Alarm Report in the variable t Alarm Report of the DALI control device. The value is written in steps of 5 s. The permissible value range is from 0 s to 21 min 15 s. It is entered in numbers from 0 to 255. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET ALARM REPORT twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 599
## Page 600

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Alarm Report : BYTE := 30; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Alarm Report BYTE Value of the variable t Alarm Report [5 s]. The input value is between 0 and 255, as a multiple of the step size of 5 s. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. 600 Version: 1.20.0 TE1000
## Page 601

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.11 FB_DALI306Set Alarm Type The function block saves the value e Alarm NType in the variable alarm Type [} 613] of the DALI control device. The value specifies whether the alarm is activated when the alarm level is exceeded (E_DALIAlarm Type. High Limit) or when it falls below (E_DALIAlarm Type. Low Limit). The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET ALARM TYPE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; e Alarm0Type : E_DALIAlarm Type := E_DALIAlarm Type. High Limit; e Alarm1Type : E_DALIAlarm Type := E_DALIAlarm Type. High Limit; e Alarm2Type : E_DALIAlarm Type := E_DALIAlarm Type. High Limit; e Alarm3Type : E_DALIAlarm Type := E_DALIAlarm Type. High Limit; END_VAR TE1000 Version: 1.20.0 601
## Page 602

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description e Alarm0Type… E_DALIAlarm Type [} 904] Alarm type for alarms 0...3. e Alarm3Type Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). 602 Version: 1.20.0 TE1000
## Page 603

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.12 FB_DALI306Set Deadtime Timer The function block stores the value of n Deadtime in the variable t Deadtime [} 612] of the DALI control device. The value is written in steps of 50 ms. The permissible value range is from 0 s to 12.75 s. It is entered in numbers from 0 to 255. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET DEADTIME TIMER twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Deadtime : BYTE := 30; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] TE1000 Version: 1.20.0 603
## Page 604

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Deadime BYTE Value of the variable t Deadtime [50 ms]. The input value is between 0 and 255, as a multiple of the step size of 50 ms. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.13 FB_DALI306Set Hysteresis The function block stores the value n Hysteresis in the variable hysteresis [} 613] of the DALI control device. The value is stated in %. The permissible value range is between 0% and 25%. 604 Version: 1.20.0 TE1000
## Page 605

Programming The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET HYSTERESIS twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Hysteresis : BYTE := 5; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Hysteresis BYTE Input value of the variable hysteresis in % (0…25 %). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR TE1000 Version: 1.20.0 605
## Page 606

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.14 FB_DALI306Set Hysteresis Min The function block stores the value n Hysteresis Min in the variable hysteresis Min [} 613] of the DALI control device. Since the hysteresis is given as a percentage, the absolute value of the hysteresis depends on the actual measured value. For very small measured values, the hysteresis is therefore also very small. This causes unnecessary events to be sent. For this reason, a minimum possible hysteresis can be set. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET HYSTERESIS MIN twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. 606 Version: 1.20.0 TE1000
## Page 607

Programming Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Hysteresis Min : BYTE := 10; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Hysteresis Min BYTE Value of the smallest possible hysteresis hysteresis Min. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. TE1000 Version: 1.20.0 607
## Page 608

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.15 FB_DALI306Set Magnitude The function block saves the value n Magnitude in the variable magnitude [} 613] of the DALI control device. If a value smaller than magnitude Ph Min [} 613] is specified, the value is set to magnitude Ph Min. If a value greater than magnitude Ph Max [} 613] is specified, the value is set to magnitude Ph Max. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET MAGNITUDE twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Magnitude : BYTE := 5; END_VAR 608 Version: 1.20.0 TE1000
## Page 609

Programming Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Magnitude BYTE Input value of the variable magnitude (magnitude Ph Min [} 613]...magnitude Ph Max [} 613]). Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). TE1000 Version: 1.20.0 609
## Page 610

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.16 FB_DALI306Set Report Timer The function block stores the value of n Report in the variable t Report [} 612] of the DALI control device. The value is written in steps of 5 s. The permissible value range is from 0 s to 21 min 15 s. It is entered in numbers from 0 to 255. The function block changes the DTR0 of all connected DALI control devices. The function block sends the DALI command SET REPORT TIMER twice, as required by the DALI standard for certain DALI commands. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Start : BOOL; n Address : BYTE; e Address Type : E_DALIAddress Type := E_DALIAddress Type. Short; n Instance Address : BYTE := 0; e Instance Address Type : E_DALIInstance Address Type := E_DALIInstance Address Type. Instance Number; e Command Priority : E_DALICommand Priority := E_DALICommand Priority. Middle Low; n Report : BYTE := 30; END_VAR Name Type Description b Start BOOL Execution of the DALI commands is triggered via a positive edge at this input. n Address BYTE Address of a DALI control gear or a DALI group. e Address Type E_DALIAddress Type Defines whether the input n Address contains a short address (0…63) or a group address (0…31). The input [} 903] n Address has no meaning if a broadcast or a broadcast to unaddressed devices (Broadcast Unaddr) has been selected. n Instance Address BYTE Instance number within a DALI control device. A DALI control device can support multiple instance numbers. e Instance Address Ty E_DALIInstance Address Ty Defines the access mode to the desired instance within the pe DALI control device. pe [} 911] e Command Priority E_DALICommand Priority Priority (low, middle low, middle, middle high, high) with which the DALI commands are sent. [} 906] 610 Version: 1.20.0 TE1000
## Page 611

Programming The command priorities are supported by the KL6821 from the firmware version BD. Name Type Description n Report BYTE Value of the variable t Report [5 s]. The input value is between 0 and 255, as a multiple of the step size of 5 s. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.2.15.17 Variables Each instance of a DALI control device has a certain number of variables (parameters). These variables are used to configure the instance and thus influence its behavior. The values of the variables are stored in the respective DALI control device. TE1000 Version: 1.20.0 611
## Page 612

Programming Name Reset value Scope Size Comment event Filter [} 612] 2#0000_0000_0000 2#0000_000X_XXX 2 bytes _0001 X_XXXX t Report [} 612] 30 0…255 1 byte t Alarm Report [} 612] 30 0…255 1 byte t Deadtime [} 612] 30 0…255 1 byte hysteresis Min [} 613] See table 0…255 1 byte hysteresis [} 613] 5 0…25 1 byte magnitude Ph Max Vendor-dependent magnitude Ph Min...2 1 byte 54 [} 613] magnitude Ph Min Vendor-dependent 0...magnitude Ph Max 1 byte [} 613] magnitude [} 613] Vendor-dependent magnitude Ph Min... 1 byte magnitude Ph Max alarm Type [} 613] 2#0000 1111 2#0000_XXXX 1 byte event Filter Specific events for each instance are enabled or disabled with the event filter (see Event filter [} 584]). If the respective bit is set, the corresponding event is enabled, otherwise it is disabled. The function block FB_DALI103Query Event Filter [} 193] can be used to read the value of the event filter; the function block FB_DALI103Set Event Filter [} 175] can be used to write to it. t Report The variable t Report specifies the report time of a general purpose sensor after the occurrence of an event. The report time is restarted when a new event is sent. The value is given in steps of 1 s. The permissible value range is 0 (0 s) to 255 (4 min 15 s). The function block FB_DALI306Query Report Timer [} 594] can be used to query the value, the function block FB_DALI306Set Report Timer [} 610] can be used to specify it. t Alarm Report The variable t Alarm Report specifies the report time of a general purpose sensor after the occurrence of an alarm event. The alarm report time is restarted when a new alarm event is sent. The value is given in steps of 1 s. The permissible value range is 0 (0 s) to 255 (4 min 15 s). The function block FB_DALI306Query Alarm Report Timer [} 586] can be used to query the value, the function block FB_DALI306Set Alarm Report Timer [} 599] can be used to specify it. t Deadtime The variable defines the time value for a dead time in which no new event is sent until the dead time has elapsed. If this timer is active, it is restarted after each transmitted event. If the value is 0, the dead time event is disabled. The value is given in steps of 50 ms. The permissible value range is 0 to 255 (12.75 s). The function block FB_DALI306Query Deadtime Timer [} 588] can be used to query the value, the function block FB_DALI306Set Deadtime Timer [} 603] can be used to specify it. 612 Version: 1.20.0 TE1000
## Page 613

Programming hysteresis Min The variable hysteresis Min prevents large fluctuations in the output of values if the measured value is low and the percentage hysteresis is therefore low. The variable is an absolute value with a value range between 0 and 255. The reset value depends on the resolution of the input values specified by the vendor. resolution Vendor-dependent reset value 1…6 0 7 1 8 2 9 5 10 10 11 20 12 40 13 81 14 163 >= 15 255 The function block FB_DALI306Query Hysteresis Min [} 591] can be used to query the value, the function block FB_DALI306Set Hysteresis Min [} 606] can be used to specify it. hysteresis The variable hysteresis specifies a percentage value of the hysteresis around a measured value. A value of 0 disables the hysteresis. The function block FB_DALI306Query Hysteresis [} 589] can be used to query the value, the function block FB_DALI306Set Hysteresis [} 604] can be used to specify it. magnitude Ph Max The variable magnitude Ph Max defines the maximum magnitude of the measured value in connection with the resolution. The value magnitude Ph Max is vendor-dependent. magnitude Ph Min The variable magnitude Ph Min defines the minimum magnitude of the measured value in connection with the resolution. The value magnitude Ph Min is vendor-dependent. magnitude The variable magnitude is used to scale the input signal. If the value can be set, it should be between magnitude Ph Min and magnitude Ph Max. The value can be specified with the function block FB_DALI306Set Magnitude [} 608]. alarm Type The variable alarm Type is used to configure alarms 0 to 3. It is possible to trigger an alarm when an input value is exceeded or not reached. The value can be specified with the function block FB_DALI306Set Alarm Type [} 601]. TE1000 Version: 1.20.0 613
## Page 614

Programming 4.1.3 Communication 4.1.3.1 FB_EL6821Communication The function blocks for the DALI commands do not directly access the process image of the EL6821, but place the individual DALI commands in a command buffer. The function block FB_EL6821Communication sequentially reads the DALI commands from the command buffer and forwards them to the EL6821. This prevents multiple function blocks accessing the EL6821 process image at the same time. The function block also reads the events of the DALI control devices from the EL6821 and stores them in a special table. The function blocks FB_DALIGet Input Notification [} 890] and FB_DALIGet Power Cycle Notification [} 892] are used to filter out the desired events from this table. One instance of the function block FB_EL6821Communication must be created for each EL6821. This instance must be called in a separate, faster task. This faster communication task must have a higher priority than the task in which the function blocks for the individual DALI commands are called. The utilization rate of the command buffer can be determined using the outputs of the function block. If you find that the command buffer is overflowing regularly, you should take the following steps: • How heavily are the individual PLC tasks utilized? Twin CAT provides suitable analysis tools. • Try to reduce the cycle time of the task in which the function block FB_EL6821Communication is called. The value should not be greater than 6 ms. The optimum value is 2 ms or less. • If possible avoid polling (regular reading) of values. Only read values when they are actually required. • Distribute the individual DALI devices evenly over several DALI lines. Since several DALI lines are processed simultaneously in each PLC cycle, this increases the data throughput. For more information, see the chapter Bus Timing [} 12]. Inputs VAR_INPUT b Reset Maximum Demand Counter : BOOL; b Reset Overflow Counter : BOOL; n Options : DWORD := 0; b Reset Inactive Process Image : BOOL; b Initialise : BOOL := FALSE; e Command EBus Watchdog : E_DALIConfiguration Command := E_DALIConfiguration Command. Do Nothing; e Command DI1Rising Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Off; e Command DI1Falling Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Do Nothing; e Command DI2Rising Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Recall Max Lev el; e Command DI2Falling Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Do Nothing; b Do Not Lock Process Image : BOOL := FALSE; b Disable Internal Power Supply: BOOL := FALSE; END_VAR 614 Version: 1.20.0 TE1000
## Page 615

Programming Name Type Description b Reset Maximum De BOOL A positive edge resets the stored value for the maximum mand Counter utilization of the command buffer, n Buffer Maximum Demand Meter (0…100 %). b Reset Overflow Cou BOOL A positive edge resets the stored value for the number of nter overflows of the command buffer, n Buffer Overflow Counter. n Options DWORD Reserved for future extensions. b Reset Inactive Proce BOOL A positive edge cancels the blocking of the process image ss Image of the terminal. The output b Process Image Inactive is reset to FALSE. The blocking is activated as soon as one of the two digital inputs on the terminal has been actuated and the input parameter b Do Not Lock Process Image is FALSE. b Initialise BOOL Configuration of the bus terminal is started by a positive edge at this input. Initialization is also carried out automatically when the controller is started. During this time no DALI commands are processed. e Command EBus Wa E_DALIConfiguration Com Defines the DALI command that is sent as soon as the bus tchdog mand terminal is no longer addressed via the E-bus. The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. e Command DI1Risin E_DALIConfiguration Com Defines the DALI command that is sent as soon as a rising g Edge, mand edge is detected at the respective input of the bus terminal. e Command DI2Risin The value is written to the terminal by a positive edge at g Edge input b Initialise and stored there persistently. e Command DI1Fallin E_DALIConfiguration Com Defines the DALI command that is sent as soon as a falling g Edge, mand edge is detected at the respective input of the bus terminal. e Command DI2Fallin The value is written to the terminal by a positive edge at g Edge input b Initialise and stored there persistently. b Do Not Lock Process BOOL Defines whether the process image for the PLC is not Image blocked by actuating the digital inputs (see also b Inactive Process Image). The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. b Disable Internal Pow BOOL Defines the operation mode of the internal DALI power er Supply supply unit. The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. Inputs/outputs VAR_IN_OUT st In Data : ST_EL6821In Data; st Out Data : ST_KL6821Out Data; END_VAR Name Type Description st In Data ST_EL6821In Data [} 902] Structure in the input process image of the EL6821. It is used for communication from the EL6821 to the PLC. st Out Data ST_EL6821Out Data [} 902] Structure in the output process image of the EL6821. It is used for communication from the PLC to the EL6821. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Buffer Demand Meter : BYTE; n Buffer Maximum Demand Meter : BYTE; n Buffer Overflow Counter : UINT; b Digital Inputn Active : BOOL; b Process Image Inactive : BOOL; TE1000 Version: 1.20.0 615
## Page 616

Programming b Collision Error : BOOL; b Power Supply Error : BOOL; b Short Circuit : BOOL; b Initialising : BOOL; b Quiescent Mode Active : BOOL; s Terminal Description : STRING(10); s Firmware Version : STRING(10); END_VAR 616 Version: 1.20.0 TE1000
## Page 617

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Buffer Demand Mete BYTE Utilization rate of the command buffer (0…100 %). r n Buffer Maximum De BYTE Maximum utilization rate of the command buffer reached mand Meter so far (0…100 %). The counter can be reset via the input b Reset Maximum Demand Counter. n Buffer Overflow Cou UINT Number of command buffer overflows to date. The counter nter can be reset via the input b Reset Overflow Counter. b Digital Input1Active, BOOL One of the digital inputs at the terminal was actuated or is b Digital Input2Active actuated (see also terminal documentation). If the input b Do Not Lock Process Image is not set, the output b Process Image Inactive is set and no further DALI commands can be sent via the bus terminal. b Process Image Inact BOOL One of the two digital inputs on the bus terminal was ive actuated and b Do Not Lock Process Image is initialized with FALSE. No further DALI commands can be sent from the PLC via the bus terminal. The blockage can be released again via the input b Reset Inactive Process Image. b Collision Error BOOL A data collision was detected on the DALI bus while a DALI command was sent. b Power Supply Error BOOL When using the internal DALI power supply unit: Power supply unit fault detected. b Short Circuit BOOL The 24 V DC supply voltage at connections 1 and 5 of the EL6821 is missing, or a short circuit has been detected on the DALI bus. b Initialising BOOL During initialization of the bus terminal, the output is set and remains active until initialization has been completed. Initialization is also carried out automatically when the controller is started. During this time no DALI commands are processed. b Quiescent Mode Acti BOOL If the EL6821 receives the DALI command START ve QUIESCENT MODE, this output is set to TRUE. This tells the PLC program that the Quiescent mode is active. This remains active for approx. 15 min or until the DALI command STOP QUIESCENT MODE has been received. s Terminal Descriptio STRING Contains the Terminal Name (e.g. EL6821). This n information is contained in Co E object 16#1008 of the bus terminal. s Firmware Version STRING Contains the firmware version. This information is contained in Co E object 16#100A of the bus terminal. TE1000 Version: 1.20.0 617
## Page 618

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). n Invalid Frame Count UDINT Get 0 Counter for the invalid data frames received by the er terminal. If a valid data frame is received, the counter is reset. Requirements Development environment Required PLC library Twin CAT from v3.1.4024.47 Tc3_DALI from v3.16.1.0 4.1.3.2 FB_KL6811Communication The function blocks for the DALI commands do not directly access the process image of the KL6811, but place the individual DALI commands in a command buffer. The function block FB_KL6811Communication sequentially reads the DALI commands from the command buffer and forwards them to the KL6811. This prevents multiple function blocks accessing the KL6811 process image at the same time. Most function blocks have the input e Command Priority, which has no function when using the KL6811. Priorities for the DALI commands are only supported from DALI-2 onwards. One instance of the function block FB_KL6811Communication is required per KL6811. This instance must be called in a separate, faster task. This faster communication task must have a higher priority than the task in which the function blocks for the individual DALI commands are called. The utilization rate of the command buffer can be determined using the outputs of the function block. If you find that the command buffer is overflowing regularly, you should take the following steps: • How heavily are the individual PLC tasks utilized? Twin CAT provides suitable analysis tools. • Try to reduce the cycle time of the task in which the function block FB_KL6811Communication is called. The value should not be greater than 6 ms. The optimum value is 2 ms or less. • If possible avoid polling (regular reading) of values. Only read values when they are actually required. • Distribute the individual DALI control gears evenly over several DALI lines. Since several DALI lines are processed simultaneously in each PLC cycle, this increases the data throughput. For more information, see the chapter Bus Timing [} 12]. 618 Version: 1.20.0 TE1000
## Page 619

Programming Inputs VAR_INPUT b Reset Maximum Demand Counter : BOOL; b Reset Overflow Counter : BOOL; n Options : DWORD; b Initialise : BOOL := FALSE; b Disable Internal Power Supply : BOOL := FALSE; END_VAR Name Type Description b Reset Maximum De BOOL A positive edge resets the stored value for the maximum mand Counter utilization of the command buffer, n Buffer Maximum Demand Meter (0…100%). b Reset Overflow Cou BOOL A positive edge resets the stored value for the number of nter overflows of the command buffer, n Buffer Overflow Counter. n Options DWORD Reserved for future extensions. b Initialise BOOL Configuration of the bus terminal is started by a positive edge at this input. Initialization is also carried out automatically when the controller is started. During this time no DALI commands are processed. b Disable Internal Pow BOOL Defines the operation mode of the internal DALI power er Supply supply. The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. Inputs/outputs VAR_IN_OUT st In Data : ST_KL6811In Data; st Out Data : ST_KL6811Out Data; END_VAR Name Type Description st In Data ST_KL6811In Data [} 902] Structure in the input process image of the KL6811. It is used for communication from the KL6811 to the PLC. st Out Data ST_KL6811Out Data [} 903] Structure in the output process image of the KL6811. It is used for communication from the PLC to the KL6811. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Buffer Demand Meter : BYTE; n Buffer Maximum Demand Meter : BYTE; n Buffer Overflow Counter : UINT; b Collision Error FC : BOOL; b Collision Error BC : BOOL; b Power Supply Error : BOOL; b Initialising : BOOL; n Terminal Description : WORD; n Firmware Version : WORD; END_VAR TE1000 Version: 1.20.0 619
## Page 620

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Buffer Demand Mete BYTE Utilization rate of the command buffer (0…100 %). r n Buffer Maximum De BYTE Maximum utilization rate of the command buffer reached mand Meter so far (0…100 %). The counter can be reset via the input b Reset Maximum Demand Counter. n Buffer Overflow Cou UINT Number of command buffer overflows to date. The counter nter can be reset via the input b Reset Overflow Counter. b Collision Error FC BOOL If the output is TRUE, a DALI collision was detected on the forward channel. This can mean that a collision with the send data of another DALI control device was detected during the transmission of a DALI frame. The output is automatically set to FALSE again as soon as no collision has occurred on the forward channel during transmission. b Collision Error BC BOOL If the output is TRUE, a DALI collision was detected on the backward channel. This can mean that a collision with the send data of another DALI device was detected during the transmission of a DALI frame. The output is automatically set to FALSE again as soon as no collision has occurred on the backward channel during transmission. b Power Supply Error BOOL If the output is TRUE, an overload was detected when using the internal DALI power supply unit of the bus terminal (bus undervoltage). b Initialising BOOL During initialization of the bus terminal, the output is set and remains active until initialization has been completed. Initialization is also carried out automatically when the controller is started. During this time no DALI commands are processed. n Terminal Descriptio WORD Contains the Terminal Name (e.g. 6811). This information n is contained in register 8 of the bus terminal. n Firmware Version WORD Contains the firmware version. This information is contained in register 9 of the bus terminal. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 620 Version: 1.20.0 TE1000
## Page 621

Programming 4.1.3.3 FB_KL6821Communication The function blocks for the DALI commands do not directly access the process image of the KL6821, but place the individual DALI commands in a command buffer. The function block FB_KL6821Communication sequentially reads the DALI commands from the command buffer and forwards them to the KL6821. This prevents multiple function blocks accessing the KL6821 process image at the same time. The function block also reads the events of the DALI control devices from the KL6821 and stores them in a special table. The function blocks FB_DALIGet Input Notification [} 890] and FB_DALIGet Power Cycle Notification [} 892] are used to filter out the desired events from this table. One instance of the function block FB_KL6821Communication must be created for each KL6821. This instance must be called in a separate, faster task. This faster communication task must have a higher priority than the task in which the function blocks for the individual DALI commands are called. The utilization rate of the command buffer can be determined using the outputs of the function block. If you find that the command buffer is overflowing regularly, you should take the following steps: • How heavily are the individual PLC tasks utilized? Twin CAT provides suitable analysis tools. • Try to reduce the cycle time of the task in which the function block FB_KL6821Communication is called. The value should not be greater than 6 ms. The optimum value is 2 ms or less. • If possible avoid polling (regular reading) of values. Only read values when they are actually required. • Distribute the individual DALI devices evenly over several DALI lines. Since several DALI lines are processed simultaneously in each PLC cycle, this increases the data throughput. For more information, see the chapter Bus Timing [} 12]. Inputs VAR_INPUT b Reset Maximum Demand Counter : BOOL; b Reset Overflow Counter : BOOL; n Options : DWORD := 0; b Reset Inactive Process Image : BOOL; b Initialise : BOOL := FALSE; e Command KBus Watchdog : E_DALIConfiguration Command := E_DALIConfiguration Command. Do Nothing; e Command DI1Rising Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Off; e Command DI1Falling Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Do Nothing; e Command DI2Rising Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Recall Max Lev el; e Command DI2Falling Edge : E_DALIConfiguration Command := E_DALIConfiguration Command. Do Nothing; b Do Not Lock Process Image : BOOL := FALSE; b Disable Internal Power Supply: BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 621
## Page 622

Programming Name Type Description b Reset Maximum De BOOL A positive edge resets the stored value for the maximum mand Counter utilization of the command buffer, n Buffer Maximum Demand Meter (0…100 %). b Reset Overflow Cou BOOL A positive edge resets the stored value for the number of nter overflows of the command buffer, n Buffer Overflow Counter. n Options DWORD Reserved for future extensions. b Reset Inactive Proce BOOL A positive edge cancels the blocking of the process image ss Image of the terminal. The output b Process Image Inactive is reset to FALSE. The blocking is activated as soon as one of the two digital inputs on the terminal has been actuated and the input parameter b Do Not Lock Process Image is FALSE. b Initialise BOOL Configuration of the bus terminal is started by a positive edge at this input. Initialization is also carried out automatically when the controller is started. During this time no DALI commands are processed. e Command KBus Wa E_DALIConfiguration Com Defines the DALI command that is sent as soon as the bus tchdog mand terminal is no longer addressed via the K-bus. The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. e Command DI1Risin E_DALIConfiguration Com Defines the DALI command that is sent as soon as a rising g Edge, mand edge is detected at the respective input of the bus terminal. e Command DI2Risin The value is written to the terminal by a positive edge at g Edge input b Initialise and stored there persistently. e Command DI1Fallin E_DALIConfiguration Com Defines the DALI command that is sent as soon as a falling g Edge, mand edge is detected at the respective input of the bus terminal. e Command DI2Fallin The value is written to the terminal by a positive edge at g Edge input b Initialise and stored there persistently. b Do Not Lock Process BOOL Defines whether the process image for the PLC is not Image blocked by actuating the digital inputs (see also b Inactive Process Image). The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. b Disable Internal Pow BOOL Defines the operation mode of the internal DALI power er Supply supply unit. The value is written to the terminal by a positive edge at input b Initialise and stored there persistently. Inputs/outputs VAR_IN_OUT st In Data : ST_KL6821In Data; st Out Data : ST_KL6821Out Data; END_VAR Name Type Description st In Data ST_KL6821In Data [} 903] Structure in the input process image of the KL6821. It is used for communication from the KL6821 to the PLC. st Out Data ST_KL6821Out Data [} 903] Structure in the output process image of the KL6821. It is used for communication from the PLC to the KL6821. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Buffer Demand Meter : BYTE; n Buffer Maximum Demand Meter : BYTE; n Buffer Overflow Counter : UINT; b Digital Inputn Active : BOOL; b Process Image Inactive : BOOL; 622 Version: 1.20.0 TE1000
## Page 623

Programming b Collision Error : BOOL; b Power Supply Error : BOOL; b Short Circuit : BOOL; b Initialising : BOOL; n Terminal Description : WORD; n Firmware Version : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Buffer Demand Mete BYTE Utilization rate of the command buffer (0…100 %). r n Buffer Maximum De BYTE Maximum utilization rate of the command buffer reached mand Meter so far (0…100 %). The counter can be reset via the input b Reset Maximum Demand Counter. n Buffer Overflow Cou UINT Number of command buffer overflows to date. The counter nter can be reset via the input b Reset Overflow Counter. b Digital Input1Active, BOOL One of the digital inputs at the terminal was actuated or is b Digital Input2Active actuated (see also terminal documentation). If the input b Do Not Lock Process Image is not set, the output b Process Image Inactive is set and no further DALI commands can be sent via the bus terminal. b Process Image Inact BOOL One of the two digital inputs on the bus terminal was ive actuated and b Do Not Lock Process Image is initialized with FALSE. No further DALI commands can be sent from the PLC via the bus terminal. The blockage can be released again via the input b Reset Inactive Process Image. b Collision Error BOOL A data collision was detected on the DALI bus while a DALI command was sent. b Power Supply Error BOOL When using the internal DALI power supply unit: Power supply unit fault detected. b Short Circuit BOOL The 24 V DC supply voltage at connections 1 and 5 of the KL6821 is missing, or a short circuit has been detected on the DALI bus. b Initialising BOOL During initialization of the bus terminal, the output is set and remains active until initialization has been completed. Initialization is also carried out automatically when the controller is started. During this time no DALI commands are processed. n Terminal Descriptio WORD Contains the Terminal Name (e.g. 6821). This information n is contained in register 8 of the bus terminal. n Firmware Version WORD Contains the firmware version. This information is contained in register 9 of the bus terminal. TE1000 Version: 1.20.0 623
## Page 624

Programming Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). n Invalid Frame Count UDINT Get 0 Counter for the invalid data frames received by the er terminal. If a valid data frame is received, the counter is reset. Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4 Devices All certified DALI-2 devices are listed in a product database on the homepage of the DALI Alliance (https:// www.dali-alliance.org/products). Each certified DALI-2 device has a unique GTIN (Global Trade Item Number). This GTIN can be read via memory bank 0 within the addresses 16#03 to 16#08 with the help of the function blocks FB_DALI102Read Memory Bank [} 47] and FB_DALI103Read Memory Bank [} 52]. Furthermore, the memory bank can also be read out with the DALI PLC Commissioning Tool (see DALI PLC Commissioning Tool [} 932]) and the KS2000 (see Commissioning KL6821 [} 929]). The devices that are supported by a function block in the library are listed below: B. E. G. Name Function block name GTIN Indoor 180-BMS DALI-2 FB_DALI_BEG_Indoor_180_BMS_V8 [} 631] 4007529935406 LC-Mini 120-BMS DALI-2 FB_DALI_BEG_LC_Mini_120_BMS_V8 [} 634] 4007529935413 PD11-BMS-FLAT DALI-2 FB_DALI_BEG_PD11_BMS_V8_Flat [} 637] 4007529935420 PD2N-BMS-FC DALI-2 FB_DALI_BEG_PD2N_BMS_V8_FC [} 640] 4007529935437 PD2N-BMS-FM DALI-2 FB_DALI_BEG_PD2N_BMS_V8_FM [} 643] 4007529935444 PD4N-BMS DALI-2 FB_DALI_BEG_PD4N_BMS_V8 [} 646] 4007529935468 PD4-BMS-GH-SM DALI-2 FB_DALI_BEG_PD4_BMS_V8_GH_SM [} 649] 4007529935451 PICO-BMS DALI-2 FB_DALI_BEG_PICO_BMS_V8 [} 652] 4007529935475 624 Version: 1.20.0 TE1000
## Page 625

Programming Esylux Name Function block name GTIN PD-C 360/8 BMS DALI-2 FB_DALI_Esylux_PD_C_360_BMS [} 655] 4015120428203 PD-C 360/24 BMS DALI-2 FB_DALI_Esylux_PD_C_360_BMS [} 655] 4015120428210 PD-C 360/32 BMS DALI-2 FB_DALI_Esylux_PD_C_360_BMS [} 655] 4015120424885 PD-C 360/8 mini BMS DALI-2 FB_DALI_Esylux_PD_C_360_Mini_BMS [} 659] 4015120423048 PD-FLAT 360/8 RW BMS FB_DALI_Esylux_PD_FLAT_360_BMS [} 663] 4015120423031 DALI-2 PD-FLAT 360/8 SW BMS FB_DALI_Esylux_PD_FLAT_360_BMS [} 663] 4015120423024 DALI-2 PD-FLAT-L 360/8 RW BMS FB_DALI_Esylux_PD_FLAT_360_BMS [} 663] 4015120423055 DALI-2 Glamox Name Function block name GTIN LMS DALI-2 PB8 SWITCH FB_DALI_Glamox_LMS_PB8_Switch Panel [} 667] 7020940423762 PANEL Helvar Name Function block name GTIN 142WD2 2-Button Module white FB_DALI_Helvar_2Button Module [} 670] 5030797801424 137WD2 4-Button Module white FB_DALI_Helvar_4Button Module [} 673] 5030797821378 137BD2 4-Button Module black FB_DALI_Helvar_4Button Module [} 673] 5030797811379 144WD2 4-Button Module FB_DALI_Helvar_4Button Module [} 673] 5030797801448 White 134WD2 5-Button Module white FB_DALI_Helvar_5Button Module [} 676] 5030797821347 134BD2 5-Button Module black FB_DALI_Helvar_5Button Module [} 676] 5030797811348 146WD2 6-Button Module white FB_DALI_Helvar_6Button Module [} 679] 5030797801462 135WD2 7-Button Module white FB_DALI_Helvar_7Button Module [} 682] 5030797821354 135BD2 7-Button Module black FB_DALI_Helvar_7Button Module [} 682] 5030797811355 136WD2 8-Button Module white FB_DALI_Helvar_8Button Module [} 685] 5030797821361 136BD2 8-Button Module black FB_DALI_Helvar_8Button Module [} 685] 5030797811362 148WD2 8-Button Module white FB_DALI_Helvar_8Button Module [} 685] 5030797801486 325D2 Multisensor High Bay FB_DALI_Helvar_Multisensor_R60_High Bay [} 688] 5030797803251 DALI-2 R60 Loytec Name Function block name GTIN LDALI-BM2 FB_DALI_Loytec_LDALI_BM2 [} 692] 4710901730512 LDALI-MS4-BT FB_DALI_Loytec_LDALI_MS4_BT [} 701] 4710901730741 LDALI-MS2-BT FB_DALI_Loytec_LDALI_MS2 [} 696] 4710901730734 LDALI-MS2 FB_DALI_Loytec_LDALI_MS2 [} 696] 4710901730505 TE1000 Version: 1.20.0 625
## Page 626

Programming Lunatone Name Function block name GTIN DALI-2 CS Integration FB_DALI_Lunatone_CS [} 705] 9010342013546 DALI-2 CS Integration THP FB_DALI_Lunatone_CS_THP [} 709] 9010342013546 DALI-2 CS Integration THP-AQ FB_DALI_Lunatone_CS_THP_AQ [} 713] 9010342013546 DALI-2 MC FB_DALI_Lunatone_MC [} 718] 9010342012730 DALI-2 MC4L FB_DALI_Lunatone_MC4L [} 721] 9010342012754 DALI-2 Cross Switch FB_DALI_Lunatone_Cross_Switch [} 723] 9010342010224 Niko Name Function block name GTIN P46LR for surface mounting FB_DALI_Niko_P46LR [} 726] 5413736374195 P46LR for Snap Fit flush FB_DALI_Niko_P46LR [} 726] 5413736374164 mounting P46LR for flush-mounting box FB_DALI_Niko_P46LR [} 726] 5413736374140 P46MR for surface mounting FB_DALI_Niko_P46MR [} 730] 5413736374393 P46MR for Snap Fit flush FB_DALI_Niko_P46MR [} 730] 5413736374362 mounting P46MR for flush-mounting box FB_DALI_Niko_P46MR [} 730] 5413736374348 Osram Name Function block name GTIN DALI COUPLER E G2 FB_DALI_Osram_Coupler_E_G2 [} 733] 4062172072212 DALI COUPLER HF G2 FB_DALI_Osram_Coupler_HF_G2 [} 736] 4062172072199 DALI COUPLER LS HIGHBAY FB_DALI_Osram_Coupler_LS_Highbay_G2 [} 739] 4062172072137 G2 DALI COUPLER MULTI3 G2 FB_DALI_Osram_Coupler_Multi3_G2 [} 742] 4062172072113 DALI COUPLER PB G2 FB_DALI_Osram_Coupler_Push B_G2 [} 745] 4062172087575 LS/PD CI G2 FB_DALI_Osram_LS_PD_CI_G2 [} 747] 4062172072069 LS/PD LI G2 FB_DALI_Osram_LS_PD_LI_G2 [} 751] 4062172072069 LS/PD LI UF G2 FB_DALI_Osram_LS_PD_LI_UF_G2 [} 754] 4062172072045 626 Version: 1.20.0 TE1000
## Page 627

Programming Steinel TE1000 Version: 1.20.0 627
## Page 628

Programming Name Function block name GTIN Dual HF FB_DALI_Steinel_Control Pro Dual HF [} 757] 4007841057459 Dual Tech US FB_DALI_Steinel_Control Pro Dual Tech [} 760] 4007841057473 Dual US FB_DALI_Steinel_Control Pro Dual US [} 763] 4007841057466 IR Quattro HD FB_DALI_Steinel_Control Pro IRQuattro HD [} 766] 4007841057497 Single US FB_DALI_Steinel_Control Pro Single US [} 769] 4007841057503 US 360 FB_DALI_Steinel_Control Pro US360 [} 772] 4007841057534 Dual Light Sensor AP FB_DALI_Steinel_Dual Light Sensor [} 775] 4007841066291 Dual Light Sensor AP square FB_DALI_Steinel_Dual Light Sensor [} 775] 4007841057411 shape Dual Light Sensor AP round FB_DALI_Steinel_Dual Light Sensor [} 775] 4007841057428 shape Dual Light Sensor UP FB_DALI_Steinel_Dual Light Sensor [} 775] 4007841066369 Dual Light Sensor UP square FB_DALI_Steinel_Dual Light Sensor [} 775] 4007841057435 shape Dual Light Sensor UP round FB_DALI_Steinel_Dual Light Sensor [} 775] 4007841057442 shape Hallway IPD UP FB_DALI_Steinel_Hallway_IPD [} 777] 4007841064532 Hallway IPD AP FB_DALI_Steinel_Hallway_IPD [} 777] 4007841064549 Hallway IPD ECO UP FB_DALI_Steinel_Hallway_IPD_ECO [} 783] 4007841079048 Hallway IPD ECO AP FB_DALI_Steinel_Hallway_IPD_ECO [} 783] 4007841079031 HF 3360 AP FB_DALI_Steinel_HF3360 [} 788] 4007841066284 HF 3360 AP square shape FB_DALI_Steinel_HF3360 [} 788] 4007841057312 HF 3360 AP round shape FB_DALI_Steinel_HF3360 [} 788] 4007841057329 HF 3360 UP FB_DALI_Steinel_HF3360 [} 788] 4007841066352 HF 3360 UP square shape FB_DALI_Steinel_HF3360 [} 788] 4007841057336 HF 3360 UP round shape FB_DALI_Steinel_HF3360 [} 788] 4007841057343 HF 360 FB_DALI_Steinel_HF360 [} 791] 4007841057480 HF 360 II IPD UP FB_DALI_Steinel_HF360_II_IPD [} 794] 4007841064280 HF 360 II IPD AP FB_DALI_Steinel_HF360_II_IPD [} 794] 4007841064297 HF 360 II IPD ECO UP FB_DALI_Steinel_HF360_II_IPD_ECO [} 798] 4007841067465 HF 360 II IPD ECO AP FB_DALI_Steinel_HF360_II_IPD_ECO [} 798] 4007841067458 IR Micro FB_DALI_Steinel_IRMicro [} 801] 4007841057732 IR Quattro Micro FB_DALI_Steinel_IRQuattro Micro [} 804] 4007841053871 IR Quattro Slim XS FB_DALI_Steinel_IRQuattro Slim XS [} 807] 4007841065034 IR Quattro Slim XS square FB_DALI_Steinel_IRQuattro Slim XS [} 807] 4007841057510 shape IR Quattro Slim XS round shape FB_DALI_Steinel_IRQuattro Slim XS [} 807] 4007841057527 IS 345 AP FB_DALI_Steinel_IS345 [} 810] 4007841066253 IS 345 AP square shape FB_DALI_Steinel_IS345 [} 810] 4007841057275 IS 345 AP round shape FB_DALI_Steinel_IS345 [} 810] 4007841057299 IS 345 UP FB_DALI_Steinel_IS345 [} 810] 4007841066321 IS 345 UP square shape FB_DALI_Steinel_IS345 [} 810] 4007841057282 IS 345 UP round shape FB_DALI_Steinel_IS345 [} 810] 4007841057305 IS 345 MX AP FB_DALI_Steinel_IS345MX [} 813] 4007841066260 IS 345 MX AP square shape FB_DALI_Steinel_IS345MX [} 813] 4007841057398 628 Version: 1.20.0 TE1000
## Page 629

Programming Name Function block name GTIN IS 345 MX UP FB_DALI_Steinel_IS345MX [} 813] 4007841066338 IS 3180 AP FB_DALI_Steinel_IS3180 [} 816] 4007841066277 IS 3180 AP square shape FB_DALI_Steinel_IS3180 [} 816] 4007841057350 IS 3180 UP FB_DALI_Steinel_IS3180 [} 816] 4007841066345 IS 3180 UP square shape FB_DALI_Steinel_IS3180 [} 816] 4007841057367 IS 3360 AP FB_DALI_Steinel_IS3360 [} 819] 4007841066239 IS 3360 AP square shape FB_DALI_Steinel_IS3360 [} 819] 4007841057237 IS 3360 AP round shape FB_DALI_Steinel_IS3360 [} 819] 4007841057251 IS 3360 UP FB_DALI_Steinel_IS3360 [} 819] 4007841066307 IS 3360 UP square shape FB_DALI_Steinel_IS3360 [} 819] 4007841057244 IS 3360 UP round shape FB_DALI_Steinel_IS3360 [} 819] 4007841057268 IS 3360 MX AP FB_DALI_Steinel_IS3360MX [} 822] 4007841066246 IS 3360 MX AP square shape FB_DALI_Steinel_IS3360MX [} 822] 4007841057374 IS 3360 MX UP FB_DALI_Steinel_IS3360MX [} 822] 4007841066314 IS 3360 MX UP square shape FB_DALI_Steinel_IS3360MX [} 822] 4007841057381 Sunricher Name Function block name GTIN Push Button Coupler FB_DALI_Sunricher_Push Button Coupler [} 825] 6971542121819 Theben Name Function block name GTIN Plano Spot 360 FB_DALI_Theben_Plano Spot_360 [} 828] 4003468200360 the Passa P360 FB_DALI_Theben_the Passa_P360 [} 832] 4003468200353 the Ronda P360 FB_DALI_Theben_the Ronda_P360 [} 837] 4003468200353 the Ronda S360 FB_DALI_Theben_the Ronda_S360 [} 842] 4003468200384 TA 4 S DALI-2 FB_DALI_Theben_TA_4_S [} 846] 4003468491584 Tridonic Name Function block name GTIN MSensor G3 SRC 30 PIR 5DPI FB_DALI_Tridonic_MSensor G3_SRC_30_PIR [} 855] 9006210666693 MSensor G3 SFI 30 PIR 5DPI FB_DALI_Tridonic_MSensor G3_SFI_30_PIR [} 851] 9006210672540 BK MSensor G3 SFI 30 PIR 5DPI FB_DALI_Tridonic_MSensor G3_SFI_30_PIR [} 851] 9006210672502 WH MSensor G3 SFI 30 PIR 16DPI FB_DALI_Tridonic_MSensor G3_SFI_30_PIR [} 851] 9006210656205 WH MSensor G3 SFI 30 PIR 10DPI FB_DALI_Tridonic_MSensor G3_SFI_30_PIR [} 851] 9006210648149 WH DALI XC G3 CWM 30 DA2 FB_DALI_Tridonic_XC_G3_CWM30 [} 859] 9006210708881 PCell SSI 31 PC DA2 SA FB_DALI_Tridonic_PCell_SSI_31_PC_DA2_SA [} 862] 9006210734873 TE1000 Version: 1.20.0 629
## Page 630

Programming Zencontrol Name Function block name GTIN PIR FB_DALI_Zencontrol_PIR [} 864] 9336462199091 Scenepanel Switch FB_DALI_Zencontrol_Scenepanel_Switch [} 868] 6971103530319 Switch 1 Button FB_DALI_Zencontrol_Switch_1Button [} 870] 9336462191897 As an alternative to the device function blocks, individual instances of DALI control devices can be addressed via the general function blocks. Each of the general function blocks refers to a specific part of IEC 62386. IEC 62386-XXX Function Function block name 103 General properties of the control devices FB_DALI103Control Device [} 872] 301 Push button FB_DALI301Push Button [} 876] 302 Absolute encoder FB_DALI302Absolute Input Dev ice [} 878] 303 Occupancy sensor FB_DALI303Occupancy Sensor [} 881] 304 Light sensor FB_DALI304Light Sensor [} 883] Further function blocks to simplify the application of device function blocks Function block name Function FB_DALI_To Push Button State Determines the static state from the events of a push button. [} 888] 4.1.4.1 Introduction Device function blocks Various manufacturers offer devices that combine several DALI parts in one device. For simple integration into projects, the Tc3_DALI library contains a constantly growing number of function blocks for certified DALI-2 devices. Additional information on the certification of DALI-2 devices can be found on the homepage of the DALI Alliance (www.dali-alliance.org). Individual manufacturers frequently offer further information on the devices that describe each parameter in more detail. All parameters of a DALI control device are mapped on the device function block via properties and can be written to the DALI control device. The properties contain internally specified values. Therefore, it is not absolutely necessary to change the properties of a device function block. For additional information on properties, see the chapter Use of properties [} 944]. 630 Version: 1.20.0 TE1000
## Page 631

Programming 4.1.4.2 B. E. G. 4.1.4.2.1 FB_DALI_BEG_Indoor_180_BMS_V8 The function block represents the Indoor 180-BMS DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 631
## Page 632

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 632 Version: 1.20.0 TE1000
## Page 633

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 TE1000 Version: 1.20.0 633
## Page 634

Programming 4.1.4.2.2 FB_DALI_BEG_LC_Mini_120_BMS_V8 The function block represents the LC-Mini 120-BMS DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 634 Version: 1.20.0 TE1000
## Page 635

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 635
## Page 636

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 636 Version: 1.20.0 TE1000
## Page 637

Programming 4.1.4.2.3 FB_DALI_BEG_PD11_BMS_V8_Flat The function block represents the PD11-BMS-FLAT DALI-2 DALI sensor from B. E. G. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 637
## Page 638

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 638 Version: 1.20.0 TE1000
## Page 639

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 TE1000 Version: 1.20.0 639
## Page 640

Programming 4.1.4.2.4 FB_DALI_BEG_PD2N_BMS_V8_FC The function block represents the PD2N-BMS-FC DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 640 Version: 1.20.0 TE1000
## Page 641

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 641
## Page 642

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 642 Version: 1.20.0 TE1000
## Page 643

Programming 4.1.4.2.5 FB_DALI_BEG_PD2N_BMS_V8_FM The function block represents the PD2N-BMS-V8-FM DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 643
## Page 644

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 644 Version: 1.20.0 TE1000
## Page 645

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 TE1000 Version: 1.20.0 645
## Page 646

Programming 4.1.4.2.6 FB_DALI_BEG_PD4N_BMS_V8 The function block represents the PD4N-BMS DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 646 Version: 1.20.0 TE1000
## Page 647

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 647
## Page 648

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 648 Version: 1.20.0 TE1000
## Page 649

Programming 4.1.4.2.7 FB_DALI_BEG_PD4_BMS_V8_GH_SM The function block represents the PD4-BMS-GH-SM DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 649
## Page 650

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 650 Version: 1.20.0 TE1000
## Page 651

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 TE1000 Version: 1.20.0 651
## Page 652

Programming 4.1.4.2.8 FB_DALI_BEG_PICO_BMS_V8 The function block represents the PICO-BMS DALI-2 DALI sensor from B. E. G.. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 652 Version: 1.20.0 TE1000
## Page 653

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 653
## Page 654

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 0 Setting the sensitivity (0...3) of the occupancy detector (0 ancy (high), 1 (medium), 2 (low), 3 (off)). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 654 Version: 1.20.0 TE1000
## Page 655

Programming 4.1.4.3 Esylux 4.1.4.3.1 FB_DALI_Esylux_PD_C_360_BMS The function block FB_DALI_Esylux_PD_C_360_BMS represents the DALI sensors PD-C 360/8 BMS DALI-2, PD-C 360/24 BMS DALI-2 and PD-C 360/32 BMS DALI-2 from Esylux. This outputs two push button signals (instances 0 to 1), an occupancy signal (instance 2) and a measured brightness value (instance 3). Further information on the supported instance types can be found here: Part 301 (push buttons) – Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Push Button N, b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. ALS correction factor During commissioning, it may be necessary to calibrate the brightness measurement. The ALS (ambient light sensor) parameters required for this can be changed via the properties. The function block transmits the individual ALS parameters (0.1...5.0) to the light sensor integrated in the DALI control device, where they are also stored. The correction factor of a light sensor is determined at 100 and 500 lux on the floor. For details on calibration, please refer to the vendor's documentation. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : USINT := 0; TE1000 Version: 1.20.0 655
## Page 656

Programming n Options : DWORD := 0; b Query Push Button1 : BOOL := FALSE; b Query Push Button2 : BOOL := FALSE; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address USINT Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Push Button N BOOL The state of the push button is queried immediately by a positive edge at this input. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Push Button1 : BOOL; b Reading Push Button2 : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; n Push Button1Event : WORD n Push Button2Event : WORD b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Push Butto BOOL The output is TRUE as long as values of the instance of n N the push button are being read by the DALI control device. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the motion sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. n Push Button NEvent WORD The output outputs the events for the corresponding push button via one bit for one cycle. 656 Version: 1.20.0 TE1000
## Page 657

Programming Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Name Type Description b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 657
## Page 658

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Push Butt BOOL Get, Set FALSE Push button input 1 or 2, which can be enabled or on N disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty f ALS0Correction F LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor 0 at a actor100 measured value of 100 lux on the surface to be measured. f ALS0Correction F LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor 0 at a actor500 measured value of 500 lux on the surface to be measured. f ALS1Correction F LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor 1 at a actor100 measured value of 100 lux on the surface to be measured. f ALS1Correction F LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor 1 at a actor500 measured value of 500 lux on the surface to be measured. n Report Timer Brig USINT Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright USINT Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri USINT Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. 658 Version: 1.20.0 TE1000
## Page 659

Programming Name Type Access Initial Description value n Report Timer Occ USINT Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup USINT Get, Set 95 Adjustment of the sensitivity of the occupancy sensor ancy instance from 0 (low sensitivity) to 100 (high sensitivity). n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 238]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push USINT Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. b Mode LED BOOL Get, Set TRUE LED mode: FALSE: LED disabled TRUE: LED enabled n Brightness LED USINT Get, Set 50 LED brightness (5...100 %). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.50 Tc3_DALI from v3.17.1.0 4.1.4.3.2 FB_DALI_Esylux_PD_C_360_Mini_BMS The function block FB_DALI_Esylux_PD_C_360_Mini_BMS represents the DALI sensor PD-C 360/8 mini BMS DALI-2 from Esylux. This outputs an occupancy signal (instance 0) and the measured brightness value (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. TE1000 Version: 1.20.0 659
## Page 660

Programming The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. ALS correction factor During commissioning, it may be necessary to calibrate the brightness measurement. The ALS (ambient light sensor) parameters required for this can be changed via the properties. The function block transmits the individual ALS parameters (0.1...5.0) to the light sensor integrated in the DALI control device, where they are also stored. The correction factor of a light sensor is determined at 100 and 500 lux on the floor. For details on calibration, please refer to the vendor's documentation. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : USINT := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address USINT Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR 660 Version: 1.20.0 TE1000
## Page 661

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the motion sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 661
## Page 662

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty f ALSCorrection Fa LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor at a ctor100 measured value of 100 lux on the surface to be measured. f ALSCorrection Fa LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor at a ctor500 measured value of 500 lux on the surface to be measured. n Report Timer Brig USINT Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright USINT Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri USINT Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ USINT Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup USINT Get, Set 95 Adjustment of the sensitivity of the occupancy sensor ancy instance from 0 (low sensitivity) to 100 (high sensitivity). b Mode LED BOOL Get, Set TRUE LED mode: FALSE: LED disabled TRUE: LED enabled ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). 662 Version: 1.20.0 TE1000
## Page 663

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.50 Tc3_DALI from v3.17.1.0 4.1.4.3.3 FB_DALI_Esylux_PD_FLAT_360_BMS The function block FB_DALI_Esylux_PD_FLAT_360_BMS represents the DALI sensors PD-FLAT 360/8 RW BMS DALI-2, PD-FLAT 360/8 SW BMS DALI-2 and PD-FLAT-L 360/8 RW BMS DALI-2 from Esylux. This outputs a push button signal (instance 0), an occupancy signal (instance 1) and the measured brightness value (instance 2). Further information on the supported instance types can be found here: Part 301 (push buttons) – Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Push Button, b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. ALS correction factor During commissioning, it may be necessary to calibrate the brightness measurement. The ALS (ambient light sensor) parameters required for this can be changed via the properties. The function block transmits the individual ALS parameters (0.1...5.0) to the light sensor integrated in the DALI control device, where they are also stored. The correction factor of a light sensor is determined at 100 and 500 lux on the floor. For details on calibration, please refer to the vendor's documentation. TE1000 Version: 1.20.0 663
## Page 664

Programming Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : USINT := 0; n Options : DWORD := 0; b Query Push Button : BOOL := FALSE; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address USINT Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Push Button BOOL The state of the push button is queried immediately by a positive edge at this input. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Push Button : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; n Push Button Event : WORD b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Push Butto BOOL The output is TRUE as long as values of the instance of n the push button are being read by the DALI control device. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the motion sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. n Push Button Event WORD The output outputs the events for the corresponding push button via one bit for one cycle. 664 Version: 1.20.0 TE1000
## Page 665

Programming Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Name Type Description b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 665
## Page 666

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Push Butt BOOL Get, Set FALSE Push button input 1 or 2, which can be enabled or on disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty f ALSCorrection Fa LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor at a ctor100 measured value of 100 lux on the surface to be measured. f ALSCorrection Fa LREAL Get, Set 1.0 Correction factor (0.1…5.0) of light sensor at a ctor500 measured value of 500 lux on the surface to be measured. n Report Timer Brig USINT Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright USINT Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri USINT Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ USINT Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup USINT Get, Set 95 Adjustment of the sensitivity of the occupancy sensor ancy instance from 0 (low sensitivity) to 100 (high sensitivity). n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 238]. Button 0011 666 Version: 1.20.0 TE1000
## Page 667

Programming Name Type Access Initial Description value e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push USINT Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button longer represents a long button press. The push button is stuck. b Mode LED BOOL Get, Set TRUE LED mode: FALSE: LED disabled TRUE: LED enabled n Brightness LED USINT Get, Set 50 LED brightness (5...100 %). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.50 Tc3_DALI from v3.17.1.0 4.1.4.4 Glamox 4.1.4.4.1 FB_DALI_Glamox_LMS_PB8_Switch Panel The function block represents the LMS DALI-2 PB8 Switch Panel DALI push button interface from Glamox. Up to eight push buttons (instances 0 to 7) can be connected directly via the device. TE1000 Version: 1.20.0 667
## Page 668

Programming For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; b Query Input Value5 : BOOL := FALSE; b Query Input Value6 : BOOL := FALSE; b Query Input Value7 : BOOL := FALSE; b Query Input Value8 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; b Reading Input Value5 : BOOL; b Reading Input Value6 : BOOL; b Reading Input Value7 : BOOL; b Reading Input Value8 : BOOL; n Push Button1Event : WORD; 668 Version: 1.20.0 TE1000
## Page 669

Programming n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; n Push Button5Event : WORD; n Push Button6Event : WORD; n Push Button7Event : WORD; n Push Button8Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 669
## Page 670

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE A TRUE on this property releases the instance. FALSE on N on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.4.5 Helvar 4.1.4.5.1 FB_DALI_Helvar_2Button Module The function block represents the 2 Button DALI push button interface module from Helvar. Up to eight push buttons (instances 0 to 1) can be connected directly via the DALI device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. 670 Version: 1.20.0 TE1000
## Page 671

Programming The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; END_VAR TE1000 Version: 1.20.0 671
## Page 672

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 672 Version: 1.20.0 TE1000
## Page 673

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.4.5.2 FB_DALI_Helvar_4Button Module The function block represents the 4 Button DALI push button interface module from Helvar. Up to eight push buttons (instances 0 to 3) can be connected directly via the DALI device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] TE1000 Version: 1.20.0 673
## Page 674

Programming The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR 674 Version: 1.20.0 TE1000
## Page 675

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 675
## Page 676

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.4.5.3 FB_DALI_Helvar_5Button Module The function block represents the 5 Button DALI push button interface module from Helvar. Up to eight push buttons (instances 0 to 4) can be connected directly via the DALI device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: 676 Version: 1.20.0 TE1000
## Page 677

Programming Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; b Query Input Value5 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; b Reading Input Value5 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; n Push Button5Event : WORD; END_VAR TE1000 Version: 1.20.0 677
## Page 678

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 678 Version: 1.20.0 TE1000
## Page 679

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.4.5.4 FB_DALI_Helvar_6Button Module The function block represents the 6 Button DALI push button interface module from Helvar. Up to eight push buttons (instances 0 to 5) can be connected directly via the DALI device. TE1000 Version: 1.20.0 679
## Page 680

Programming For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; b Query Input Value5 : BOOL := FALSE; b Query Input Value6 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; b Reading Input Value5 : BOOL; b Reading Input Value6 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; 680 Version: 1.20.0 TE1000
## Page 681

Programming n Push Button5Event : WORD; n Push Button6Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 681
## Page 682

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.4.5.5 FB_DALI_Helvar_7Button Module The function block represents the 7 Button DALI push button interface module from Helvar. Up to eight push buttons (instances 0 to 6) can be connected directly via the DALI device. 682 Version: 1.20.0 TE1000
## Page 683

Programming For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; b Query Input Value5 : BOOL := FALSE; b Query Input Value6 : BOOL := FALSE; b Query Input Value7 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; b Reading Input Value5 : BOOL; b Reading Input Value6 : BOOL; b Reading Input Value7 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; TE1000 Version: 1.20.0 683
## Page 684

Programming n Push Button4Event : WORD; n Push Button5Event : WORD; n Push Button6Event : WORD; n Push Button7Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 684 Version: 1.20.0 TE1000
## Page 685

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.4.5.6 FB_DALI_Helvar_8Button Module The function block represents the 8 Button DALI push button interface module from Helvar. TE1000 Version: 1.20.0 685
## Page 686

Programming Up to eight push buttons (instances 0 to 7) can be connected directly via the DALI device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; b Query Input Value5 : BOOL := FALSE; b Query Input Value6 : BOOL := FALSE; b Query Input Value7 : BOOL := FALSE; b Query Input Value8 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; b Reading Input Value5 : BOOL; b Reading Input Value6 : BOOL; b Reading Input Value7 : BOOL; 686 Version: 1.20.0 TE1000
## Page 687

Programming b Reading Input Value8 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; n Push Button5Event : WORD; n Push Button6Event : WORD; n Push Button7Event : WORD; n Push Button8Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 687
## Page 688

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.4.5.7 FB_DALI_Helvar_Multisensor_R60_High Bay The function block represents the Multisensor High Bay DALI-2 R60. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. 688 Version: 1.20.0 TE1000
## Page 689

Programming The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR TE1000 Version: 1.20.0 689
## Page 690

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 690 Version: 1.20.0 TE1000
## Page 691

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 40 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.64 Tc3_DALI from v3.20.3.0 TE1000 Version: 1.20.0 691
## Page 692

Programming 4.1.4.6 Loytec 4.1.4.6.1 FB_DALI_Loytec_LDALI_BM2 The function block represents the LDALI-BM2 DALI push button interface from Loytec. Up to four push buttons (instances 0, 3, 6 and 7) can be connected directly via the device. The first two inputs are configurable and it is therefore also possible to use NTC/PTC temperature sensors (instances 1 and 4) or potentiometers/slide resistors (instances 2 and 5) instead of push buttons. These functions can be configured via the properties e Input1Configuration and e Input2Configuration (see E_DALILoytec Input Configuration [} 912]). The resistance value is read directly on setting one of the two inputs as Generic Input (resistance thermometer). This reading takes place when a positive edge is detected at the respective input b Query Input Value1 or b Query Input Value2. The resistance value is read in % when setting one of the two inputs as Absolute Input (potentiometer). The corresponding channel is configured via the property e Resistance Value Absolute Input1 or e Resistance Value Absolute Input2 on the connected resistor (1 kΩ or 10 kΩ) (see Use of properties [} 944]). The output value lies between 0 (0 %) and 31 (100 %). The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. In addition, the time-dependent querying of these values is possible. The properties n Report Timer Absolute Input1 and n Report Timer Absolute Input2 are used for this. The value is read again on expiry of the set time [s]. To prevent events following one another too quickly, a dead time [ms] can be set via the properties n Deadtime Timer Absolute Input1 and n Deadtime Timer Absolute Input2. The push button inputs 3 and 4 can be disabled via the properties b Enable Input3 and b Enable Input4. The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. 692 Version: 1.20.0 TE1000
## Page 693

Programming Set the event priorities on the properties e Event Priority Input1 and e Event Priority Input2 to the value Middle Low if the inputs are not used as push buttons. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Values of resistance sensors (setting of the input as Generic Input) can only be queried manually and not event-driven. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Generic Input1 : UINT; n Absolute Input1 : BYTE; n Push Button2Event : WORD; n Generic Input2 : UINT; n Absolute Input2 : BYTE; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR TE1000 Version: 1.20.0 693
## Page 694

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent BOOL The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Name Type Description n Generic Input N UINT Outputs containing the measured values of the connected resistance sensors (NTC/PTC). n Absolute Input N BYTE Outputs containing the measured values of the connected potentiometers or slide resistors. The individual ranges are scaled from 0 to 100%, with the following output values: 0 = 0% and 31 = 100%. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 694 Version: 1.20.0 TE1000
## Page 695

Programming Name Type Ac- Initial Description cess value e Input NConfigurat E_DALILo Get, Push Butt Configuration of input 1 or 2 as a push button or analog ion Set on input for the connection of potentiometers or resistance ytec Input sensors, e.g. NTC/PTC. Configura tion [} 912] e Resistance Value E_DALILo Get, Resistanc Configuration of the resistance value of the potentiometer Absolute Input N Set e10k Ohm or slide resistor at input 1 or 2. ytec Resist ance Conf iguration [} 912] b Enable Push Butt BOOL Get, TRUE Push button input 3 or 4, which can be enabled or disabled on N Set on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, 2#1000_ Setting of the event filter [} 517]. Button N Set 0011 e Event Priority Inp E_DALIE Get, Middle Setting of the event priority [} 238]. ut N vent Priori Set ty n Deadtime Timer A UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many bsolute Input N Set events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Report Timer Abs BYTE Get, 0 s Time [0…255 s] after which the pending event of the olute Input N Set absolute encoder is repeated if no other event has occurred in the meantime. n Double Timer Pus UINT Get, 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N Set single and a double button press. n Repeat Timer Pus UINT Get, 160 ms Interval (100…2000 ms) of repetitive events in the case of h Button N Set a long button press. n Short Timer Push UINT Get, 500 ms Time (t Short Min...5100 ms) to distinguish between a long Button N Set and a short button press. t Short Min is a manufacturer- specific value. n Stuck Timer Push BYTE Get, 20 s Time (5…255 s) after whose expiry the push button no Button N Set longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, 0 Interface pointer to the communication block (see Transfer ation mmunicat Set of the reference to the communication block [} 946]). ion Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 695
## Page 696

Programming 4.1.4.6.2 FB_DALI_Loytec_LDALI_MS2 The function block FB_DALI_Loytec_LDALI_MS2 represents the LDALI-MS2-BT or LDALI-MS2 DALI sensor from Loytec. This outputs a brightness value (instance 0), an occupancy signal (instance 1), a temperature value (instance 2), a relative humidity value (instance 3), three hardware push button signals (instances 4 to 6) and 18 infrared remote control push button signals (instances 7 to 24). The infrared push button instances can be used via remote control from the vendor. For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) – Introduction [} 516] Part 303 (occupancy sensors) - Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The temperature measurement and humidity measurement are executed as Generic Inputs. These values can only be queried via a positive edge at the inputs b Query Temperature and b Query Humidity. For the other instances, the reading can also be triggered directly via the inputs b Query Brightness and b Query Occupancy, even if the corresponding instance is not enabled. 696 Version: 1.20.0 TE1000
## Page 697

Programming Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Query Temperature : BOOL := FALSE; b Query Humidity : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Query Temperature BOOL The temperature is queried immediately by a positive edge at this input. The DALI device does not support transmission of the temperature per event. b Query Humidity BOOL The relative humidity is queried immediately by a positive edge at this input. The DALI device does not support transmission of the relative humidity per event. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Reading Temperature : BOOL; b Reading Humidity : BOOL; b Occupied : BOOL; n Brightness Level : UINT; f Temperature : LREAL; n Humidity : USINT; n Push Button HWNEvent : WORD; n Push Button IRNEvent : WORD; END_VAR TE1000 Version: 1.20.0 697
## Page 698

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description f Temperature LREAL Measured temperature value (-5.0…60.0 °C) of the temperature sensor. n Humidity USINT Measured value of the relative humidity (0…100%). n Push Button HWNEv WORD The outputs (1…3) output the events for the corresponding ent push button via one bit for one cycle. n Push Button IRNEve WORD The outputs (1...18) output the events for the nt corresponding infrared button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 698 Version: 1.20.0 TE1000
## Page 699

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Temperat BOOL Get, Set FALSE TRUE at this property enables the instance for ure temperature measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Temperature. b Enable Humidity BOOL Get, Set FALSE A TRUE on this property enables the instance to measure relative humidity. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Humidity. b Enable Push Butt BOOL Get, Set FALSE Push button input 1 to 3, which can be enabled or on HWN disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. b Enable Push Butt BOOL Get, Set FALSE Infrared buttons input 1 to 18, which can be enabled or on IRN disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 255 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. TE1000 Version: 1.20.0 699
## Page 700

Programming Name Type Access Initial Description value n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button HWN vent Priori ty n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button HWN 0011 n Double Timer Pus UINT Get, Set 0 s Time (0, t Double Min…2000 ms) to distinguish between a h Button HWN single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button HWN of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button HWN long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button HWN longer represents a long button press. The push button is stuck. e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button IRN vent Priori ty n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button IRN 0011 n Double Timer Pus UINT Get, Set 0 s Time (0, t Double Min…2000 ms) to distinguish between a h Button IRN single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button IRN of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button IRN long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button IRN longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 700 Version: 1.20.0 TE1000
## Page 701

Programming 4.1.4.6.3 FB_DALI_Loytec_LDALI_MS4_BT The function block FB_DALI_Loytec_LDALI_MS4 represents the LDALI-MS4-BT DALI sensor from Loytec. This outputs a brightness value (instance 0), an occupancy signal (instance 1), a temperature value (instance 2), a relative humidity value (instance 3), three hardware push button signals (instances 4 to 6) and 18 infrared remote control push button signals (instances 7 to 24). The infrared push button instances can be used via remote control from the vendor. For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) – Introduction [} 516] Part 303 (occupancy sensors) - Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The temperature measurement and humidity measurement are executed as Generic Inputs. These values can only be queried via a positive edge at the inputs b Query Temperature and b Query Humidity. For the other instances, the reading can also be triggered directly via the inputs b Query Brightness and b Query Occupancy, even if the corresponding instance is not enabled. TE1000 Version: 1.20.0 701
## Page 702

Programming Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Query Temperature : BOOL := FALSE; b Query Humidity : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Query Temperature BOOL The temperature is queried immediately by a positive edge at this input. The DALI device does not support transmission of the temperature per event. b Query Humidity BOOL The relative humidity is queried immediately by a positive edge at this input. The DALI device does not support transmission of the relative humidity per event. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Reading Temperature : BOOL; b Reading Humidity : BOOL; b Occupied : BOOL; n Brightness Level : UINT; f Temperature : LREAL; n Humidity : USINT; n Push Button HWNEvent : WORD; n Push Button IRNEvent : WORD; END_VAR 702 Version: 1.20.0 TE1000
## Page 703

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description f Temperature LREAL Measured temperature value (-5.0…60.0 °C) of the temperature sensor. n Humidity USINT Measured value of the relative humidity (0…100%). n Push Button HWNEv WORD The outputs (1…3) output the events for the corresponding ent push button via one bit for one cycle. n Push Button IRNEve WORD The outputs (1...18) output the events for the nt corresponding infrared button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 703
## Page 704

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Temperat BOOL Get, Set FALSE TRUE at this property enables the instance for ure temperature measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Temperature. b Enable Humidity BOOL Get, Set FALSE A TRUE on this property enables the instance to measure relative humidity. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Humidity. b Enable Push Butt BOOL Get, Set FALSE Push button input 1 to 3, which can be enabled or on HWN disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. b Enable Push Butt BOOL Get, Set FALSE Infrared buttons input 1 to 18, which can be enabled or on IRN disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 255 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. 704 Version: 1.20.0 TE1000
## Page 705

Programming Name Type Access Initial Description value n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button HWN vent Priori ty n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button HWN 0011 n Double Timer Pus UINT Get, Set 0 s Time (0, t Double Min…2000 ms) to distinguish between a h Button HWN single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button HWN of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button HWN long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button HWN longer represents a long button press. The push button is stuck. e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button IRN vent Priori ty n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button IRN 0011 n Double Timer Pus UINT Get, Set 0 s Time (0, t Double Min…2000 ms) to distinguish between a h Button IRN single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button IRN of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button IRN long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button IRN longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.15 Tc3_DALI from v3.6.2.0 4.1.4.7 Lunatone 4.1.4.7.1 FB_DALI_Lunatone_CS TE1000 Version: 1.20.0 705
## Page 706

Programming The function block FB_DALI_Lunatone_CS represents the DALI-2 sensor CS Integration from Lunatone. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). The order number is stored in memory bank 0 [} 16] from offset 143 (MSB) to offset 146 (LSB). The addition of the order number (e.g. "-HS") is in the ASCII code from offset 147 to 162. For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; 706 Version: 1.20.0 TE1000
## Page 707

Programming b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the motion sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value (0...2046 lux) of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 707
## Page 708

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 20 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 708 Version: 1.20.0 TE1000
## Page 709

Programming 4.1.4.7.2 FB_DALI_Lunatone_CS_THP The function block FB_DALI_Lunatone_CS_THP represents the DALI-2 sensor CS Integration THP from Lunatone. This outputs an occupancy signal (instance 0), a brightness value (instance 1), a temperature value (instance 2), a relative humidity value (instance 3) and an air pressure value (instance 4). The order number is stored in memory bank 0 [} 16] from offset 143 (MSB) to offset 146 (LSB). The addition of the order number (e.g. "-HS") is in the ASCII code from offset 147 to 162. For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy, b Query Brightness, b Query Temperature, b Query Humidity and b Query Air Pressure , even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Query Temperature : BOOL := FALSE; b Query Humidity : BOOL := FALSE; b Query Air Pressure : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 709
## Page 710

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Query Temperature BOOL The temperature is queried immediately by a positive edge at this input. Temperature transmission by event is not supported. b Query Humidity BOOL The relative humidity is queried immediately by a positive edge at this input. Relative humidity transmission per event is not supported. b Query Air Pressure BOOL The air pressure is queried immediately by a positive edge at this input. Air pressure transmission per event is not supported. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Reading Temperature : BOOL; b Reading Humidity : BOOL; b Reading Air Pressure : BOOL; b Occupied : BOOL; n Brightness Level : UINT; f Temperature : LREAL; n Humidity : USINT; n Air Pressure : UINT; END_VAR 710 Version: 1.20.0 TE1000
## Page 711

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the motion sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Reading Temperatu BOOL The output is TRUE as long as values of the instance of re the temperature sensor are being read by the DALI control device. b Reading Humidity BOOL The output is TRUE as long as values of the instance of the humidity sensor are being read by the DALI control device. b Reading Air Pressur BOOL The output is TRUE as long as values of the instance of e the air pressure sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value (0...2046 lux) of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description f Temperature LREAL Measured temperature value (-20.0…80.0 °C) of the temperature sensor. n Humidity USINT Measured value of the relative humidity (0…100%). n Air Pressure UINT Measured value of air pressure (600...1100 h Pa). Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 711
## Page 712

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Temperat BOOL Get, Set FALSE TRUE at this property enables the instance for ure temperature measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Temperature. b Enable Humidity BOOL Get, Set FALSE A TRUE on this property enables the instance to measure relative humidity. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Humidity. b Enable Air Pressu BOOL Get, Set FALSE TRUE at this property enables the instance for air re pressure measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Air Pressure. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 20 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. 712 Version: 1.20.0 TE1000
## Page 713

Programming Name Type Access Initial Description value ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.47 Tc3_DALI from v3.16.1.0 4.1.4.7.3 FB_DALI_Lunatone_CS_THP_AQ The function block FB_DALI_Lunatone_CS_THP_AQ represents the DALI-2 Sensor CS Integration THP-AQ from Lunatone. This outputs an occupancy signal (instance 0), a brightness value (instance 1), a temperature value (instance 2), a value for the relative humidity (instance 3), a value for the air pressure (instance 4), a value for the air quality (instance 5) and a value for the calculated CO equivalent (instance 6). 2 The order number is stored in memory bank 0 [} 16] from offset 143 (MSB) to offset 146 (LSB). The addition of the order number (e.g. "-HS") is in the ASCII code from offset 147 to 162. For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy, b Query Brightness, b Query Temperature, b Query Humidity, b Query Air Pressure, b Query Air Quality and b Query CO2Equivalent, even if the corresponding instance is not enabled. TE1000 Version: 1.20.0 713
## Page 714

Programming Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Query Temperature : BOOL := FALSE; b Query Humidity : BOOL := FALSE; b Query Air Pressure : BOOL := FALSE; b Query Air Quality : BOOL := FALSE; b Query CO2Equivalent : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Query Temperature BOOL The temperature is queried immediately by a positive edge at this input. Temperature transmission by event is not supported. b Query Humidity BOOL The relative humidity is queried immediately by a positive edge at this input. Relative humidity transmission per event is not supported. b Query Air Pressure BOOL The air pressure is queried immediately by a positive edge at this input. Air pressure transmission per event is not supported. b Query Air Quality BOOL The air quality is queried immediately by a positive edge at this input. Air quality transmission per event is not supported. b Query CO2Equivale BOOL The CO2 equivalent is queried immediately by a positive nt edge at this input. CO2 equivalent transmission per event is not supported. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Reading Temperature : BOOL; b Reading Humidity : BOOL; b Reading Air Pressure : BOOL; 714 Version: 1.20.0 TE1000
## Page 715

Programming b Reading Air Quality : BOOL; b Reading CO2Equivalent : BOOL; b Occupied : BOOL; n Brightness Level : UINT; f Temperature : LREAL; n Humidity : USINT; n Air Pressure : UINT; n Air Quality : UINT; n CO2Equivalent : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the motion sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Reading Temperatu BOOL The output is TRUE as long as values of the instance of re the temperature sensor are being read by the DALI control device. b Reading Humidity BOOL The output is TRUE as long as values of the instance of the humidity sensor are being read by the DALI control device. b Reading Air Pressur BOOL The output is TRUE as long as values of the instance of e the air pressure sensor are being read by the DALI control device. b Reading Air Quality BOOL The output is TRUE as long as values of the instance of the air quality sensor are being read by the DALI control device. b Reading CO2Equiv BOOL The output is TRUE as long as values of the instance of alent the sensor for the CO2 equivalent are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value (0...2046 lux) of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. TE1000 Version: 1.20.0 715
## Page 716

Programming Name Type Description f Temperature LREAL Measured temperature value (-20.0…80.0 °C) of the temperature sensor. n Humidity USINT Measured value of the relative humidity (0…100%). n Air Pressure UINT Measured value of air pressure (600...1100 h Pa). n Air Quality UINT Measured value of the air quality (0...500). n CO2equivalent UINT Measured value CO2 equivalent (0...8000 ppm). Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 716 Version: 1.20.0 TE1000
## Page 717

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Temperat BOOL Get, Set FALSE TRUE at this property enables the instance for ure temperature measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Temperature. b Enable Humidity BOOL Get, Set FALSE A TRUE on this property enables the instance to measure relative humidity. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Humidity. b Enable Air Pressu BOOL Get, Set FALSE TRUE at this property enables the instance for air re pressure measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Air Pressure. b Enable Air Quality BOOL Get, Set FALSE TRUE at this property enables the instance for measuring the air quality. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Air Quality. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 20 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. TE1000 Version: 1.20.0 717
## Page 718

Programming Name Type Access Initial Description value n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Prerequisites Development environment Required PLC library Twin CAT from v3.1.4024.68 Tc3_DALI from v3.22.2.0 4.1.4.7.4 FB_DALI_Lunatone_MC The function block FB_DALI_Lunatone_MC represents the MC DALI push button interface from Lunatone. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. 718 Version: 1.20.0 TE1000
## Page 719

Programming Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. TE1000 Version: 1.20.0 719
## Page 720

Programming Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 720 Version: 1.20.0 TE1000
## Page 721

Programming 4.1.4.7.5 FB_DALI_Lunatone_MC4L The function block represents the MC4L DALI push button interface from Lunatone. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 721
## Page 722

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. 722 Version: 1.20.0 TE1000
## Page 723

Programming Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 4.1.4.7.6 FB_DALI_Lunatone_Cross_Switch The function block represents the Cross Switch DALI push button interface from Lunatone. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: TE1000 Version: 1.20.0 723
## Page 724

Programming Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR 724 Version: 1.20.0 TE1000
## Page 725

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 725
## Page 726

Programming Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 4.1.4.8 Niko 4.1.4.8.1 FB_DALI_Niko_P46LR The function block represents the DALI sensors P46LR for surface mounting, P46LR for Snap Fit flush mounting and P46LR for flush-mounting box from Niko. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). The light sensor is divided into three segments (A, B and C). The sensitivity can be set for each of these segments. It supports two different value ranges. This can be set to 0...1023 lux (10 bits) or 0...10360 lux (14 bits) via the n Lux Range Brightness property. The smaller value range (10 bits) has the advantage that the DALI bus is slightly less loaded than with the larger value range (14 bits). For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: 726 Version: 1.20.0 TE1000
## Page 727

Programming Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR TE1000 Version: 1.20.0 727
## Page 728

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 728 Version: 1.20.0 TE1000
## Page 729

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. n Lux Range Bright BYTE Get, Set 0 Specifies the measuring range with which the brightness ness is measured. (0: 0...1023 lux, 1: 0...10360 lux). e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 3 (high) Setting the sensitivity of the occupancy sensor instance ancy A for segment A (0: off, 1: min, 2: low, 3: high and 4: max). n Sensitivity Occup BYTE Get, Set 3 (high) Setting the sensitivity of the occupancy sensor instance ancy B for segment B (0: off, 1: min, 2: low, 3: high and 4: max). n Sensitivity Occup BYTE Get, Set 3 (high) Setting the sensitivity of the occupancy sensor instance ancy C for segment C (0: off, 1: min, 2: low, 3: high and 4: max). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). TE1000 Version: 1.20.0 729
## Page 730

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.1.4.8.2 FB_DALI_Niko_P46MR The function block represents the DALI sensors P46MR for surface mounting, P46MR for Snap Fit flush mounting and P46MR for flush-mounting box from Niko. This outputs an occupancy signal (instance 0) and a brightness value (instance 1). The light sensor supports two different value ranges. This can be set to 0...1023 lux (10 bits) or 0...10360 lux (14 bits) via the n Lux Range Brightness property. The smaller value range (10 bits) has the advantage that the DALI bus is slightly less loaded than with the larger value range (14 bits). For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 730 Version: 1.20.0 TE1000
## Page 731

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 731
## Page 732

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. n Lux Range Bright BYTE Get, Set 0 Specifies the measuring range with which the brightness ness is measured. (0: 0...1023 lux, 1: 0...10360 lux). e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 3 (high) Setting the sensitivity of the occupancy sensor instance ancy from (0: off, 1: min, 2: low, 3: high and 4: max). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 732 Version: 1.20.0 TE1000
## Page 733

Programming 4.1.4.9 Osram 4.1.4.9.1 FB_DALI_Osram_Coupler_E_G2 The function block represents the DALI COUPLER E G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 733
## Page 734

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 734 Version: 1.20.0 TE1000
## Page 735

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 TE1000 Version: 1.20.0 735
## Page 736

Programming 4.1.4.9.2 FB_DALI_Osram_Coupler_HF_G2 The function block represents the DALI COUPLER HF G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 736 Version: 1.20.0 TE1000
## Page 737

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 737
## Page 738

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 738 Version: 1.20.0 TE1000
## Page 739

Programming 4.1.4.9.3 FB_DALI_Osram_Coupler_LS_Highbay_G2 The function block represents the DALI COUPLER LS HIGHBAY G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 739
## Page 740

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 740 Version: 1.20.0 TE1000
## Page 741

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 TE1000 Version: 1.20.0 741
## Page 742

Programming 4.1.4.9.4 FB_DALI_Osram_Coupler_Multi3_G2 The function block represents the DALI COUPLER MULTI3 G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 742 Version: 1.20.0 TE1000
## Page 743

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 743
## Page 744

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 744 Version: 1.20.0 TE1000
## Page 745

Programming 4.1.4.9.5 FB_DALI_Osram_Coupler_Push B_G2 The function block represents the DALI COUPLER Push B G2 DALI push button interface from Osram. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 745
## Page 746

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. 746 Version: 1.20.0 TE1000
## Page 747

Programming Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 4.1.4.9.6 FB_DALI_Osram_LS_PD_CI_G2 The function block represents the LS/PD CI G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. TE1000 Version: 1.20.0 747
## Page 748

Programming The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR 748 Version: 1.20.0 TE1000
## Page 749

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 749
## Page 750

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 750 Version: 1.20.0 TE1000
## Page 751

Programming 4.1.4.9.7 FB_DALI_Osram_LS_PD_LI_G2 The function block represents the LS/PD LI G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 751
## Page 752

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 752 Version: 1.20.0 TE1000
## Page 753

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 753
## Page 754

Programming 4.1.4.9.8 FB_DALI_Osram_LS_PD_LI_UF_G2 The function block represents the LS/PD LI UF G2 DALI sensor from Osram. This outputs the measured brightness value (instance 1) and an occupancy signal (instance 0). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 754 Version: 1.20.0 TE1000
## Page 755

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 755
## Page 756

Programming Name Type Ac- Initial Description cess value b Enable Brightn BOOL Get, TRUE TRUE at this property enables the instance for brightness ess Set measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occup BOOL Get, TRUE TRUE at this property enables the instance for motion detection. ancy Set FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority B E_DAL Get, Middle Low Setting of the event priority [} 238]. rightness IEvent Set Priority n Report Timer B BYTE Get, 30 s Time (0…255 s) after which the pending event of the light rightness Set sensor is repeated if no other event has occurred in the meantime. n Deadtime Tim UINT Get, 1500 ms Dead time (0...12750 ms) to ensure that not too many events er Brightness Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, 5 % Value (0…25 %) for calculating a hysteresis value in order to htness Set prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, 10 As the percentage hysteresis can also lead to large fluctuations Brightness Set at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DAL Get, Middle Setting of the event priority [} 238]. ccupancy IEvent Set Priority n Deadtime Tim UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many events er Occupancy Set are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, 900 s Hold time (1...2538 s) during which the occupancy is still active upancy Set after no further motion was detected by the sensor. n Report Timer O BYTE Get, 60 s Time (0…255 s) after which the pending event of the occupancy ccupancy Set sensor is repeated if no other event has occurred in the meantime. ip DALICommu I_DALI Get, 0 Interface pointer to the communication block (see Transfer of the nicaion Comm Set reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 756 Version: 1.20.0 TE1000
## Page 757

Programming 4.1.4.10 Steinel 4.1.4.10.1 FB_DALI_Steinel_Control Pro Dual HF The function block represents the Control Pro Dual HF DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 757
## Page 758

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 758 Version: 1.20.0 TE1000
## Page 759

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Range BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 759
## Page 760

Programming 4.1.4.10.2 FB_DALI_Steinel_Control Pro Dual Tech The function block represents the Control Pro Dual Tech US Dali sensor from Steinel. This outputs the measured brightness value (instance 0) and two independent occupancy signals (instance 1 and instance 2). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy1, b Query Occupancy2 and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy1 : BOOL := FALSE; b Query Occupancy2 : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Motion1 : BOOL := FALSE; b Cancel Hold Timer Motion2 : BOOL := FALSE; END_VAR 760 Version: 1.20.0 TE1000
## Page 761

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy N BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer M BOOL A positive edge at this input prematurely ends the hold otion timer of the respective instance and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy1 : BOOL; b Reading Occupancy2 : BOOL; b Reading Brightness : BOOL; b Occupied1 : BOOL; b Occupied2 : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of N the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties Some parameters of the function block are executed as properties whose values can be changed if necessary. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 761
## Page 762

Programming Name Type Access Initial Description value b Enable Brightne BOOL Get, Set TRUE TRUE at this property enables the instance for ss brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupa BOOL Get, Set TRUE TRUE at this property enables the instance for motion ncy N detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Br E_DALIE Get, Set Middle Low Setting of the event priority [} 238]. ightness vent Priori ty n Report Timer Bri BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the ghtness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many Brightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in htness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, Set 10 As the percentage hysteresis can also lead to large Brightness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DALIE Get, Set Middle Setting of the event priority [} 238]. ccupancy N vent Priori ty n Deadtime Timer UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many Occupancy N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still upancy N active after no further motion was detected by the sensor. n Report Timer Oc BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the cupancy N occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occu BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from pancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Rang BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor e Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommuni I_DALICo Get, Set 0 Interface pointer to the communication block (see cation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 762 Version: 1.20.0 TE1000
## Page 763

Programming 4.1.4.10.3 FB_DALI_Steinel_Control Pro Dual US The function block represents the Control Pro Dual US DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 763
## Page 764

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 764 Version: 1.20.0 TE1000
## Page 765

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Range BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 765
## Page 766

Programming 4.1.4.10.4 FB_DALI_Steinel_Control Pro IRQuattro HD The function block represents the Control Pro IR Quattro HD DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 766 Version: 1.20.0 TE1000
## Page 767

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 767
## Page 768

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 768 Version: 1.20.0 TE1000
## Page 769

Programming 4.1.4.10.5 FB_DALI_Steinel_Control Pro Single US The function block represents the DALI Control Pro Single US DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 769
## Page 770

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 770 Version: 1.20.0 TE1000
## Page 771

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Range BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 771
## Page 772

Programming 4.1.4.10.6 FB_DALI_Steinel_Control Pro US360 The function block represents the Control Pro US 360 DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 772 Version: 1.20.0 TE1000
## Page 773

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 773
## Page 774

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Range BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 774 Version: 1.20.0 TE1000
## Page 775

Programming 4.1.4.10.7 FB_DALI_Steinel_Dual Light Sensor The function block represents the Dual Light Sensor AP/UP DALI sensor from Steinel. The function block has two light sensors (instance 0 and instance 1). These two sensors each output a brightness value. Further information on the supported instance type can be found here: Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Brightness1 and b Query Brightness2, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Brightness1 : BOOL := FALSE; b Query Brightness2 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Brightness N BOOL The brightness is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; TE1000 Version: 1.20.0 775
## Page 776

Programming b Reading Brightness1 : BOOL; b Reading Brightness2 : BOOL; n Brightness Level1 : UINT; n Brightness Level2 : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Brightness BOOL The output is TRUE as long as values of the instance of N the light sensor are being read by the DALI control device. n Brightness Level N UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 776 Version: 1.20.0 TE1000
## Page 777

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s N brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness N vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness N light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness N order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness N fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.10.8 FB_DALI_Steinel_Hallway_IPD The function block represents the Hallway IPD DALI sensor from Steinel. This outputs the measured brightness value (instance 0), three occupancy signals (instances 1 to 3), a temperature value (instance 4) and a relative humidity value (instance 5). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) - Introduction [} 547] TE1000 Version: 1.20.0 777
## Page 778

Programming Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The DALI sensor contains three occupancy sensors. One occupancy sensor (instance 2) is aligned in the direction "S" of the STEINEL lettering on the device, while the second occupancy sensor (instance 3) is aligned in the direction "L". The third occupancy sensor (instance 1) combines both sensors into a single instance. Never activate all three instances at the same time, as this places an unnecessary load on the DALI bus. Either the two instances for direction "S" and "L" are active or the combined instance is active (default setting). Thus either the properties n Xyz Direction S / n Xyz Direction L or the properties n Xyz Combined should be set, but not all at the same time. Setting the properties n Xyz Combined overwrites the values of n Xyz Direction S / n Xyz Direction L. The temperature measurement and humidity measurement are executed as Generic Inputs. These values can only be queried via a positive edge at the inputs b Query Temperature and b Query Humidity. For the other instances, the reading can also be triggered directly via the inputs b Query Brightness, b Query Occupancy Combined, b Query Occupancy Direction S and b Query Occupancy Direction L, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy Combined : BOOL := FALSE; b Query Occupancy Direction S : BOOL := FALSE; b Query Occupancy Direction L : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Query Temperature : BOOL := FALSE; b Query Humidity : BOOL := FALSE; b Cancel Hold Timer Occupancy Combined : BOOL := FALSE; b Cancel Hold Timer Occupancy Direction S : BOOL := FALSE; b Cancel Hold Timer Occupancy Direction L : BOOL := FALSE; END_VAR 778 Version: 1.20.0 TE1000
## Page 779

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy C BOOL The value of the combined occupancy sensor is queried ombined immediately by a positive edge at this input. b Query Occupancy Di BOOL The value of the occupancy sensor for direction "S" is rection S queried immediately by a positive edge at this input. b Query Occupancy Di BOOL The value of the occupancy sensor for direction "L" is rection L queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Query Temperature BOOL The temperature is queried immediately by a positive edge at this input. The DALI device does not support transmission of the temperature per event. b Query Humidity BOOL The relative humidity is queried immediately by a positive edge at this input. The DALI device does not support transmission of the relative humidity per event. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the hold ccupancy Combined timer of the combined occupancy sensor and resets the output b Occupied Combined. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the hold ccupancy Direction S timer of the occupancy sensor for direction "S" and resets the output b Occupied Direction S. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the hold ccupancy Direction L timer of the occupancy sensor for direction "L" and resets the output b Occupied Direction L. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy Combined : BOOL; b Reading Occupancy Direction S : BOOL; b Reading Occupancy Direction L : BOOL; b Reading Brightness : BOOL; b Reading Temperature : BOOL; b Reading Humidity : BOOL; b Occupied Combined : BOOL; b Occupied Direction S : BOOL; b Occupied Direction L : BOOL; n Brightness Level : UINT; f Temperature : LREAL; n Humidity : USINT; END_VAR TE1000 Version: 1.20.0 779
## Page 780

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of Combined the combined movement sensor are being read by the DALI control device. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of Direction S the movement sensor for direction "S" are being read by the DALI control device. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of Direction L the movement sensor for direction "L" are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Reading Temperatu BOOL The output is TRUE as long as values of the instance of re the temperature sensor are being read by the DALI control device. b Reading Humidity BOOL The output is TRUE as long as values of the instance of the humidity sensor are being read by the DALI control device. b Occupied Combine BOOL If the output is TRUE, then occupancy has been detected d in the detection range of the combined occupancy sensor. b Occupied Direction BOOL If the output is TRUE, then occupancy has been detected S in the detection range of the occupancy sensor for direction "S". b Occupied Direction L BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor for direction "L". n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description f Temperature LREAL Measured temperature value (-5.0…60.0 °C) of the temperature sensor. n Humidity USINT Measured value of the relative humidity (0…100%). Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 780 Version: 1.20.0 TE1000
## Page 781

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE A TRUE at this property enables the instance for the y Combined combined occupancy sensor. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy Combined. b Enable Occupanc BOOL Get, Set FALSE TRUE at this property enables the instance for motion y Direction S detection in direction "S". FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy Direction S. b Enable Occupanc BOOL Get, Set FALSE TRUE at this property enables the instance for motion y Direction L detection in direction "L". FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy Direction L. b Enable Temperat BOOL Get, Set FALSE TRUE at this property enables the instance for ure temperature measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Temperature. b Enable Humidity BOOL Get, Set FALSE A TRUE on this property enables the instance to measure relative humidity. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Humidity. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0...255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ BYTE Get, Set Middle Setting of the event priority [} 238]. upancy Combined n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy Combine events are sent in succession. An event is only sent after d expiry of the dead time timer. The dead time timer is restarted each time an event is sent. TE1000 Version: 1.20.0 781
## Page 782

Programming Name Type Access Initial Description value n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy Combi from 0 % (small detection range) to 100 % (large ned detection range). Setting this property overwrites n Detection Range Occupancy Direction S and n Detection Range Occupancy Direction L . n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy Combined active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy Combined occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy Combined % (low sensitivity) to 100 % (high sensitivity). Setting this property overwrites n Sensitivity Occupancy Direction S and n Sensitivity Occupancy Direction L . e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy Direction S vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy Direction events are sent in succession. An event is only sent after S expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy Directi from 0 % (small detection range) to 100 % (large on S detection range). n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy Direction S active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy Direction S occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy Direction S % (low sensitivity) to 100 % (high sensitivity). e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy Direction L vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy Direction events are sent in succession. An event is only sent after L expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy Directi from 0 % (small detection range) to 100 % (large on L detection range). n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy Direction L active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy Direction L occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy Direction L % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). 782 Version: 1.20.0 TE1000
## Page 783

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 4.1.4.10.9 FB_DALI_Steinel_Hallway_IPD_ECO The function block represents the Hallway IPD ECO DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and three occupancy signals (instances 1 to 3). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) - Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The DALI sensor contains three occupancy sensors. One occupancy sensor (instance 2) is aligned in the direction "S" of the STEINEL lettering on the device, while the second occupancy sensor (instance 3) is aligned in the direction "L". The third occupancy sensor (instance 1) combines both sensors into a single instance. Never activate all three instances at the same time, as this places an unnecessary load on the DALI bus. Either the two instances for direction "S" and "L" are active or the combined instance is active (default setting). Thus either the properties n Xyz Direction S / n Xyz Direction L or the properties n Xyz Combined should be set, but not all at the same time. Setting the properties n Xyz Combined overwrites the values of n Xyz Direction S / n Xyz Direction L. The reading can be triggered immediately via the input variables b Query Brightness, b Query Occupancy Combined, b Query Occupancy Direction S and b Query Occupancy Direction L, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. TE1000 Version: 1.20.0 783
## Page 784

Programming Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy Combined : BOOL := FALSE; b Query Occupancy Direction S : BOOL := FALSE; b Query Occupancy Direction L : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy Combined : BOOL := FALSE; b Cancel Hold Timer Occupancy Direction S : BOOL := FALSE; b Cancel Hold Timer Occupancy Direction L : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy C BOOL The value of the combined occupancy sensor is queried ombined immediately by a positive edge at this input. b Query Occupancy Di BOOL The value of the occupancy sensor for direction "S" is rection S queried immediately by a positive edge at this input. b Query Occupancy Di BOOL The value of the occupancy sensor for direction "L" is rection L queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the hold ccupancy Combined timer of the combined occupancy sensor and resets the output b Occupied Combined. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the hold ccupancy Direction S timer of the occupancy sensor for direction "S" and resets the output b Occupied Direction S. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the hold ccupancy Direction L timer of the occupancy sensor for direction "L" and resets the output b Occupied Direction L. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy Combined : BOOL; b Reading Occupancy Direction S : BOOL; b Reading Occupancy Direction L : BOOL; b Reading Brightness : BOOL; b Occupied Combined : BOOL; b Occupied Direction S : BOOL; b Occupied Direction L : BOOL; n Brightness Level : UINT; END_VAR 784 Version: 1.20.0 TE1000
## Page 785

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of Combined the combined movement sensor are being read by the DALI control device. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of Direction S the movement sensor for direction "S" are being read by the DALI control device. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of Direction L the movement sensor for direction "L" are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Reading Temperatu BOOL The output is TRUE as long as values of the instance of re the temperature sensor are being read by the DALI control device. b Occupied Direction BOOL If the output is TRUE, then occupancy has been detected S in the detection range of the occupancy sensor for direction "S". b Occupied Direction L BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor for direction "L". n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 785
## Page 786

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE A TRUE at this property enables the instance for the y Combined combined occupancy sensor. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy Combined. b Enable Occupanc BOOL Get, Set FALSE TRUE at this property enables the instance for motion y Direction S detection in direction "S". FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy Direction S. b Enable Occupanc BOOL Get, Set FALSE TRUE at this property enables the instance for motion y Direction L detection in direction "L". FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy Direction L. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0...255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ BYTE Get, Set Middle Setting of the event priority [} 238]. upancy Combined n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy Combine events are sent in succession. An event is only sent after d expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy Combi from 0 % (small detection range) to 100 % (large ned detection range). Setting this property overwrites n Detection Range Occupancy Direction S and n Detection Range Occupancy Direction L . n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy Combined active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy Combined occupancy sensor is repeated if no other event has occurred in the meantime. 786 Version: 1.20.0 TE1000
## Page 787

Programming Name Type Access Initial Description value n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy Combined % (low sensitivity) to 100 % (high sensitivity). Setting this property overwrites n Sensitivity Occupancy Direction S and n Sensitivity Occupancy Direction L. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy Direction S vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy Direction events are sent in succession. An event is only sent after S expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy Directi from 0 % (small detection range) to 100 % (large on S detection range). n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy Direction S active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy Direction S occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy Direction S % (low sensitivity) to 100 % (high sensitivity). e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy Direction L vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy Direction events are sent in succession. An event is only sent after L expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy Directi from 0 % (small detection range) to 100 % (large on L detection range). n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy Direction L active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy Direction L occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy Direction L % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 TE1000 Version: 1.20.0 787
## Page 788

Programming 4.1.4.10.10 FB_DALI_Steinel_HF3360 The function block represents the HF 3360 AP/UP DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 788 Version: 1.20.0 TE1000
## Page 789

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 789
## Page 790

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Range BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 790 Version: 1.20.0 TE1000
## Page 791

Programming 4.1.4.10.11 FB_DALI_Steinel_HF360 The function block represents the HF 360 DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 791
## Page 792

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 792 Version: 1.20.0 TE1000
## Page 793

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). n Detection Range BYTE Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 793
## Page 794

Programming 4.1.4.10.12 FB_DALI_Steinel_HF360_II_IPD The function block represents the HF 360 II IPD DALI sensor from Steinel. This outputs the measured brightness value (instance 0), an occupancy signal (instance 1), a temperature value (instance 2) and a value for the relative humidity (instance 3). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) - Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The temperature measurement and humidity measurement are executed as Generic Inputs. These values can only be queried via a positive edge at the inputs b Query Temperature and b Query Humidity. For the other instances, the reading can also be triggered directly via the inputs b Query Brightness and b Query Occupancy, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Query Temperature : BOOL := FALSE; b Query Humidity : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 794 Version: 1.20.0 TE1000
## Page 795

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Query Temperature BOOL The temperature is queried immediately by a positive edge at this input. The DALI device does not support transmission of the temperature per event. b Query Humidity BOOL The relative humidity is queried immediately by a positive edge at this input. The DALI device does not support transmission of the relative humidity per event. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Reading Temperature : BOOL; b Reading Humidity : BOOL; b Occupied : BOOL; n Brightness Level : UINT; f Temperature : LREAL; n Humidity : USINT; END_VAR TE1000 Version: 1.20.0 795
## Page 796

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Reading Temperatu BOOL The output is TRUE as long as values of the instance of re the temperature sensor are being read by the DALI control device. b Reading Humidity BOOL The output is TRUE as long as values of the instance of the humidity sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description f Temperature LREAL Measured temperature value (-5.0…60.0 °C) of the temperature sensor. n Humidity USINT Measured value of the relative humidity (0…100%). Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 796 Version: 1.20.0 TE1000
## Page 797

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE A TRUE at this property enables the instance for the y occupancy sensor. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Temperat BOOL Get, Set FALSE TRUE at this property enables the instance for ure temperature measurement. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Temperature. b Enable Humidity BOOL Get, Set FALSE A TRUE on this property enables the instance to measure relative humidity. FALSE at this property causes the instance not to be configured during initialization. The actual value of the instance can only be queried via the input b Query Humidity. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0...255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ BYTE Get, Set Middle Setting of the event priority [} 238]. upancy n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy % (low sensitivity) to 100 % (high sensitivity). TE1000 Version: 1.20.0 797
## Page 798

Programming Name Type Access Initial Description value ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 4.1.4.10.13 FB_DALI_Steinel_HF360_II_IPD_ECO The function block represents the HF 360 II IPD ECO DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR 798 Version: 1.20.0 TE1000
## Page 799

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 799
## Page 800

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE A TRUE at this property enables the instance for the y occupancy sensor. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0...255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ BYTE Get, Set Middle Setting of the event priority [} 238]. upancy n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Detection Range UINT Get, Set 100 % Setting of the detection range of the occupancy sensor Occupancy from 0 % (small detection range) to 100 % (large detection range). n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from 0 ancy % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 800 Version: 1.20.0 TE1000
## Page 801

Programming 4.1.4.10.14 FB_DALI_Steinel_IRMicro The function block represents the IR Micro DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 801
## Page 802

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 802 Version: 1.20.0 TE1000
## Page 803

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 803
## Page 804

Programming 4.1.4.10.15 FB_DALI_Steinel_IRQuattro Micro ☺The function block represents the IR Quattro Micro DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 804 Version: 1.20.0 TE1000
## Page 805

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 805
## Page 806

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 806 Version: 1.20.0 TE1000
## Page 807

Programming 4.1.4.10.16 FB_DALI_Steinel_IRQuattro Slim XS The function block represents the IR Quattro Slim XS DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 807
## Page 808

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 808 Version: 1.20.0 TE1000
## Page 809

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 809
## Page 810

Programming 4.1.4.10.17 FB_DALI_Steinel_IS345 The function block represents the IS 345 AP/UP DALI☺ sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 810 Version: 1.20.0 TE1000
## Page 811

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 811
## Page 812

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 812 Version: 1.20.0 TE1000
## Page 813

Programming 4.1.4.10.18 FB_DALI_Steinel_IS345MX The function block represents the IS 345 MX AP/UP DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 813
## Page 814

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 814 Version: 1.20.0 TE1000
## Page 815

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 815
## Page 816

Programming 4.1.4.10.19 FB_DALI_Steinel_IS3180 The function block represents the IS 3180 AP/UP DALI☺ sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 816 Version: 1.20.0 TE1000
## Page 817

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 817
## Page 818

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 818 Version: 1.20.0 TE1000
## Page 819

Programming 4.1.4.10.20 FB_DALI_Steinel_IS3360 The function block represents the IS 3360 AP/UP DALI☺ sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. TE1000 Version: 1.20.0 819
## Page 820

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 820 Version: 1.20.0 TE1000
## Page 821

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 821
## Page 822

Programming 4.1.4.10.21 FB_DALI_Steinel_IS3360MX The function block represents the IS 3360 MX AP/UP DALI sensor from Steinel. This outputs the measured brightness value (instance 0) and an occupancy signal (instance 1). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. 822 Version: 1.20.0 TE1000
## Page 823

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 823
## Page 824

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 20 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occup BYTE Get, Set 100 % Setting of the sensitivity of the occupancy sensor from ancy 0 % (low sensitivity) to 100 % (high sensitivity). ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 824 Version: 1.20.0 TE1000
## Page 825

Programming 4.1.4.11 Sunricher 4.1.4.11.1 FB_DALI_Sunricher_Push Button Coupler The function block represents the Push Button Coupler DALI push button interface from Sunricher. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR TE1000 Version: 1.20.0 825
## Page 826

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. 826 Version: 1.20.0 TE1000
## Page 827

Programming Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 TE1000 Version: 1.20.0 827
## Page 828

Programming 4.1.4.12 Theben 4.1.4.12.1 FB_DALI_Theben_Plano Spot_360 The function block represents the Plano Spot 360 DALI sensor from Theben. This outputs two occupancy signals (instances 0 and 1), four measured brightness values (instances 2 to 5) and eight push button signals (instances 6 to 13). The push button instances can be used via an infrared remote control from the vendor. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy Standard, b Query Occupancy Reduced, b Query Brightness Integral, b Query Brightness Inside, b Query Brightness Center and b Query Brightness Window, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. 828 Version: 1.20.0 TE1000
## Page 829

Programming Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy Standard : BOOL := FALSE; b Query Occupancy Reduced : BOOL := FALSE; b Query Brightness Integral : BOOL := FALSE; b Query Brightness Inside : BOOL := FALSE; b Query Brightness Center : BOOL := FALSE; b Query Brightness Window : BOOL := FALSE; b Cancel Hold Timer Occupancy Standard : BOOL := FALSE; b Cancel Hold Timer Occupancy Reduced : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy N BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness N BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy N Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy Standard : BOOL; b Reading Occupancy Reduced : BOOL; b Reading Brightness Integral : BOOL; b Reading Brightness Inside : BOOL; b Reading Brightness Center : BOOL; b Reading Brightness Window : BOOL; b Occupied Standard : BOOL; b Occupied Reduced : BOOL; n Brightness Level Integral : UINT; n Brightness Level Inside : UINT; n Brightness Level Center : UINT; n Brightness Level Window : UINT; n Push Button Event1On : WORD; n Push Button Event1Off : WORD; n Push Button Event2On : WORD; n Push Button Event2Off : WORD; n Push Button Event3On : WORD; n Push Button Event3Off : WORD; n Push Button Event Scene1 : WORD; n Push Button Event Scene2 : WORD; END_VAR TE1000 Version: 1.20.0 829
## Page 830

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of N the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of N the light sensor are being read by the DALI control device. b Occupied N BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level N UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description n Push Button Event N WORD The output outputs the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 830 Version: 1.20.0 TE1000
## Page 831

Programming Name Type Access Initial Description value b Enable Brightn BOOL Get, Set TRUE TRUE at this property enables the instance for brightness ess N measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness N. b Enable Occupa BOOL Get, Set TRUE TRUE at this property enables the instance for motion ncy N detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy N. b Enable Push B BOOL Get, Set FALSE Push button input that can be enabled or disabled on the utton N DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority B E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. rightness N vent Priori w ty n Room Correcti BYTE Get, Set 30 The room correction factor (5…200) specifies the on Factor N difference in brightness measurement on the ceiling and at the workplace. It can be calculated using a luxmeter with the following equation: The value can also be determined by a remote control and with an appropriate app. The preset value of 0.3 (30) is suitable for most applications. n Report Timer Br BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the light ightness N sensor is repeated if no other event has occurred in the meantime. n Deadtime Time UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many r Brightness N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in order htness N to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, Set 163 As the percentage hysteresis can also lead to large Brightness N fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DALIE Get, Set Middle Setting of the event priority [} 238]. ccupancy N vent Priori ty n Deadtime Time UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many r Occupancy N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still upancy N active after no further motion was detected by the sensor. n Report Timer O BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the ccupancy N occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occ BYTE Get, Set 3 Adjustment of the sensitivity of both occupancy sensor upancy instances from 0 (low sensitivity) to 5 (high sensitivity). TE1000 Version: 1.20.0 831
## Page 832

Programming Name Type Access Initial Description value e Event Priority P E_DALIE Get, Set Middle Setting of the event priority [} 238]. ush Button N vent Priori ty n Double Timer P UINT Get, Set 0 ms Time [0, t Double Min…2000 ms] to distinguish between a ush Button N single and a double button press. n Repeat Timer P UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case of ush Button N a long button press. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. n Short Timer Pu UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a long sh Button N and a short button press. n Stuck Timer Pu BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no sh Button N longer represents a long button press. The push button is stuck. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. ip DALICommun I_DALICo Get,Set 0 Interface pointer to the communication block (see Transfer ication mmunicat of the reference to the communication block [} 946]). ion Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.12.2 FB_DALI_Theben_the Passa_P360 The function block represents the Passa P360 DALI sensor from Theben. This outputs three occupancy signals (instances 0 to 2), three measured brightness values (instances 3 to 5) and eight push button signals (instances 6 to 13). The push button instances can be used via an infrared remote control from the vendor. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. 832 Version: 1.20.0 TE1000
## Page 833

Programming Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy Overall, b Query Occupancy Zone1, b Query Occupancy Zone1, b Query Brightness Zone1and2, b Query Brightness Zone1 and b Query Brightness Zone2, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy Overall : BOOL := FALSE; b Query Occupancy Zone1 : BOOL := FALSE; b Query Occupancy Zone2 : BOOL := FALSE; b Query Brightness Zone1and2 : BOOL := FALSE; b Query Brightness Zone1 : BOOL := FALSE; b Query Brightness Zone2 : BOOL := FALSE; b Cancel Hold Timer Occupancy Overall : BOOL := FALSE; b Cancel Hold Timer Occupancy Zone1 : BOOL := FALSE; b Cancel Hold Timer Occupancy Zone2 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy N BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness N BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy N Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy Standard : BOOL; b Reading Occupancy Reduced : BOOL; TE1000 Version: 1.20.0 833
## Page 834

Programming b Reading Brightness Integral : BOOL; b Reading Brightness Inside : BOOL; b Reading Brightness Center : BOOL; b Reading Brightness Window : BOOL; b Occupied Standard : BOOL; b Occupied Reduced : BOOL; n Brightness Level Integral : UINT; n Brightness Level Inside : UINT; n Brightness Level Center : UINT; n Brightness Level Window : UINT; n Push Button Event1On : WORD; n Push Button Event1Off : WORD; n Push Button Event2On : WORD; n Push Button Event2Off : WORD; n Push Button Event3On : WORD; n Push Button Event3Off : WORD; n Push Button Event Scene1 : WORD; n Push Button Event Scene2 : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of N the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of N the light sensor are being read by the DALI control device. b Occupied N BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level N UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description n Push Button Event N WORD The output outputs the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. 834 Version: 1.20.0 TE1000
## Page 835

Programming The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 835
## Page 836

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s N brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness N. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y N detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy N. b Enable Push Butt BOOL Get, Set FALSE Push button input that can be enabled or disabled on the on N DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness N vent Priori w ty n Room Correction BYTE Get, Set 30 The room correction factor (5…200) specifies the Factor N difference in brightness measurement on the ceiling and at the workplace. It can be calculated using a luxmeter with the following equation: The value can also be determined by a remote control and with an appropriate app. The preset value of 0.3 (30) is suitable for most applications. n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness N light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness N order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 163 As the percentage hysteresis can also lead to large ghtness N fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy N vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy N active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy N occupancy sensor is repeated if no other event has occurred in the meantime. 836 Version: 1.20.0 TE1000
## Page 837

Programming Name Type Access Initial Description value n Sensitivity Occup BYTE Get, Set 3 Adjustment of the sensitivity of both occupancy sensor ancy instances from 0 (low sensitivity) to 5 (high sensitivity). e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.12.3 FB_DALI_Theben_the Ronda_P360 The function block represents the Ronda P360 DALI sensor from Theben. This outputs one occupancy signal (instance 0), four measured brightness values (instances 1 to 5) and eight push button signals (instances 5 to 12). The push button instances can be used via an infrared remote control from the vendor. TE1000 Version: 1.20.0 837
## Page 838

Programming For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy, b Query Brightness Integral, b Query Brightness Inside, b Query Brightness Center and b Query Brightness Window , even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness Integral : BOOL := FALSE; b Query Brightness Inside : BOOL := FALSE; b Query Brightness Center : BOOL := FALSE; b Query Brightness Window : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness N BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy Standard : BOOL; b Reading Occupancy Reduced : BOOL; 838 Version: 1.20.0 TE1000
## Page 839

Programming b Reading Brightness Integral : BOOL; b Reading Brightness Inside : BOOL; b Reading Brightness Center : BOOL; b Reading Brightness Window : BOOL; b Occupied Standard : BOOL; b Occupied Reduced : BOOL; n Brightness Level Integral : UINT; n Brightness Level Inside : UINT; n Brightness Level Center : UINT; n Brightness Level Window : UINT; n Push Button Event1On : WORD; n Push Button Event1Off : WORD; n Push Button Event2On : WORD; n Push Button Event2Off : WORD; n Push Button Event3On : WORD; n Push Button Event3Off : WORD; n Push Button Event Scene1 : WORD; n Push Button Event Scene2 : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of N the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of N the light sensor are being read by the DALI control device. b Occupied N BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level N UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description n Push Button Event N WORD The output outputs the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. TE1000 Version: 1.20.0 839
## Page 840

Programming The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 840 Version: 1.20.0 TE1000
## Page 841

Programming Name Type Access Initial Description value b Enable Brightn BOOL Get, Set TRUE TRUE at this property enables the instance for brightness ess N measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness N. b Enable Occupa BOOL Get, Set TRUE TRUE at this property enables the instance for motion ncy detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy N. b Enable Push B BOOL Get, Set FALSE Push button input that can be enabled or disabled on the utton N DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority B E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. rightness N vent Priori w ty n Room Correcti BYTE Get, Set 30 The room correction factor (5…200) specifies the on Factor N difference in brightness measurement on the ceiling and at the workplace. It can be calculated using a luxmeter with the following equation: The value can also be determined by a remote control and with an appropriate app. The preset value of 0.3 (30) is suitable for most applications. n Report Timer Br BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the light ightness N sensor is repeated if no other event has occurred in the meantime. n Deadtime Time UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many r Brightness N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in order htness N to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, Set 163 As the percentage hysteresis can also lead to large Brightness N fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DALIE Get, Set Middle Setting of the event priority [} 238]. ccupancy vent Priori ty n Deadtime Time UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many r Occupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still upancy active after no further motion was detected by the sensor. n Report Timer O BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the ccupancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occ BYTE Get, Set 3 Adjustment of the sensitivity of both occupancy sensor upancy instances from 0 (low sensitivity) to 5 (high sensitivity). TE1000 Version: 1.20.0 841
## Page 842

Programming Name Type Access Initial Description value e Event Priority P E_DALIE Get, Set Middle Setting of the event priority [} 238]. ush Button N vent Priori ty n Double Timer P UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a ush Button N single and a double button press. n Repeat Timer P UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case of ush Button N a long button press. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. n Short Timer Pu UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a long sh Button N and a short button press. t Short Min is a manufacturer- specific value. n Stuck Timer Pu BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no sh Button N longer represents a long button press. The push button is stuck. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. ip DALICommun I_DALICo Get, Set 0 Interface pointer to the communication block (see Transfer ication mmunicat of the reference to the communication block [} 946]). ion Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.12.4 FB_DALI_Theben_the Ronda_S360 The function block represents the the Ronda S360 DALI sensor from Theben. This outputs an occupancy signal (instance 0), a measured brightness value (instance 1) and eight push button signals (instances 5 to 12). The push button instances can be used via an infrared remote control from the vendor. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] 842 Version: 1.20.0 TE1000
## Page 843

Programming The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, , even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; n Push Button Event1On : WORD; n Push Button Event1Off : WORD; n Push Button Event2On : WORD; n Push Button Event2Off : WORD; n Push Button Event3On : WORD; n Push Button Event3Off : WORD; n Push Button Event Scene1 : WORD; n Push Button Event Scene2 : WORD; END_VAR TE1000 Version: 1.20.0 843
## Page 844

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description n Push Button Event N WORD The output outputs the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 844 Version: 1.20.0 TE1000
## Page 845

Programming Name Type Access Initial Description value b Enable Brightn BOOL Get, Set TRUE TRUE at this property enables the instance for brightness ess measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupa BOOL Get, Set TRUE TRUE at this property enables the instance for motion ncy detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Push Bu BOOL Get, Set FALSE Push button input that can be enabled or disabled on the tton N DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority Br E_DALI Get, Set Middle Lo Setting of the event priority [} 238]. ightness Event P w riority n Room Correctio BYTE Get, Set 30 The room correction factor (5…200) specifies the difference n Factor in brightness measurement on the ceiling and at the workplace. It can be calculated using a luxmeter with the following equation: The value can also be determined by a remote control and with an appropriate app. The preset value of 0.3 (30) is suitable for most applications. n Report Timer Bri BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the light ghtness sensor is repeated if no other event has occurred in the meantime. n Deadtime Time UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many r Brightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Brig BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in order htness N to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min BYTE Get, Set 163 As the percentage hysteresis can also lead to large Brightness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority O E_DALI Get, Set Middle Setting of the event priority [} 238]. ccupancy Event P riority n Deadtime Time UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many r Occupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occ UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still upancy active after no further motion was detected by the sensor. n Report Timer O BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the ccupancy occupancy sensor is repeated if no other event has occurred in the meantime. n Sensitivity Occ BYTE Get, Set 3 Adjustment of the sensitivity of both occupancy sensor upancy instances from 0 (low sensitivity) to 5 (high sensitivity). TE1000 Version: 1.20.0 845
## Page 846

Programming Name Type Access Initial Description value e Event Priority P E_DALI Get, Set Middle Setting of the event priority [} 238]. ush Button N Event P riority n Double Timer P UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a ush Button N single and a double button press. n Repeat Timer P UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case of a ush Button N long button press. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. n Short Timer Pus UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a long h Button N and a short button press. t Short Min is a manufacturer- specific value. n Stuck Timer Pus BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no h Button N longer represents a long button press. The push button is stuck. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. ip DALICommuni I_DALI Get, Set 0 Interface pointer to the communication block (see Transfer cation Commu of the reference to the communication block [} 946]). nication Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.12.5 FB_DALI_Theben_TA_4_S This function block represents the DALI push button interface TA 4 S DALI-2 from Theben. Up to four push buttons (instances 2 to 5) and two sliders/temperature sensors (instances 0 and 1) can be connected via the device. The push button inputs are configured as NO contacts in the delivery state. You can change the contact type to break contact (NC) via the properties [} 848]. You can set the parameters of the two absolute inputs in the properties [} 848]. 100 k Ohm variable resistances can be directly connected in the delivery state. For further information on configuration, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) – Introduction [} 516] 846 Version: 1.20.0 TE1000
## Page 847

Programming Part 302 (absolute input devices) - Introduction [} 537] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. All inputs can be queried immediately via a positive edge at b Query Input Value N and b Query Absolute Input N, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; b Query Absolute Input1 : BOOL := FALSE; b Query Absolute Input2 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL Immediate query of the values at the push button inputs 1 to 4. b Query Absolute Inpu BOOL Immediate query of the values at the absolute value inputs t N 1 to 2. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; b Reading Absolute Input Value1 : BOOL; b Reading Absolute Input Value2 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; n Absolute Input1 : BYTE; n Absolute Input2 : BYTE; END_VAR TE1000 Version: 1.20.0 847
## Page 848

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Value N BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Name Type Description n Absolute Input N BYTE Outputs that contain the measured values, [°C] or [Ω], of the connected variable resistances. Please refer to the manufacturer's documentation for the TA 4 S DALI-2 for the appropriate scaling of the output value. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. 848 Version: 1.20.0 TE1000
## Page 849

Programming Name Type Ac- Initial Description cess value b Enable Push Butt BOOL Get, TRUE Push button input 1 to 4, which can be enabled or disabled on N Set on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, 2#1000_ Setting of the event filter [} 517]. Button N Set 0011 e Event Priority Inp E_DALIE Get, Middle Setting of the event priority [} 238]. ut N vent Priori Set ty n Deadtime Timer A UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many bsolute Input N Set events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Report Timer Abs BYTE Get, 0 s Time [s] after which the pending event of the absolute olute Input N Set encoder is repeated if no other event has occurred in the meantime. n Double Timer Pus UINT Get, 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N Set single and a double button press. n Repeat Timer Pus UINT Get, 160 ms Interval (100…2000 ms) of repetitive events in the case of h Button N Set a long button press. n Short Timer Push UINT Get, 500 ms Time (t Short Min...5100 ms) to distinguish between a long Button N Set and a short button press. t Short Min is a manufacturer- specific value. n Stuck Timer Push BYTE Get, 20 s Time (5…255 s) after whose expiry the push button no Button N Set longer represents a long button press. The push button is stuck. n Contact Type Pus BYTE Get, 16#00 Push button contact type: h Button N Set 16#00: NO contact (delivery state) 16#FF: NC contact b Enable Absolute I BOOL Get, FALSE Absolute value input 1 or 2, which can each be enabled or nput N Set disabled on the DALI control device. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Absolute Input N. e Event Priority Abs E_DALIE Get, Middle Setting of the event priority [} 238]. olute Input N vent Priori Set ty n Deadtime Timer A UINT Get, 100 ms Dead time (0...12750 ms) to ensure that not too many bsolute Input N Set events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Report Timer Abs BYTE Get, 0 s Time [s] after which the pending event of the absolute olute Input N Set encoder is repeated if no other event has occurred in the meantime. n Sensor Type Abs BYTE Get, 16#03 Sensor type: olute Input N Set 16#00: Theben sensors (9070321, 9070459, 9070489, 9070496). 16#01: Theben sensor (9070191). 16#02: any 100 kΩ NTC with known B or Beta [K] (see also value range parameter Beta Low / Beta High below). 16#03: 100 kΩ variable resistance (delivery state). TE1000 Version: 1.20.0 849
## Page 850

Programming Name Type Ac- Initial Description cess value n Beta High Absolut BYTE Get, 16#11 If the sensor type 16#02 was selected, the associated B or e Input N Set Beta [K] should be set here. The B or Beta is a four-digit number in [K], which can be found on the data sheet for the NTC sensor. For storage in the memory bank, the four-digit number must first be converted to hex format and then stored in the Beta Low and Beta High bytes. Example: B or Beta = 4580, this corresponds to 16#11E4 • Beta Low = 16#E4, delivery state • Beta High = 16#11, delivery state • The adjustment range is 16#00…16#FF. n Beta Low Absolut BYTE Get, 16#E4 See n Beta High Absolute Input N e Input N Set n Filter Absolute Inp BYTE Get, 16#00 A filter can be set for noise suppression. The adjustment ut N Set range is 16#00…16#0B. 16#00: each measured value is transmitted unchanged (delivery state) 16#01: average of 2 measured values (21). 16#02: average of 4 measured values (22). 16#03: average of 8 measured values (23). … 16#09: average of 512 measured values (29). 16#0A: average of 1024 measured values (210). 16#0B: average of 2048 measured values (211). Attention: The filter delays the measurement! n Hysteresis Absol BYTE Get, 16#00 Hysteresis value for the avoidance of frequent events. The ute Input N Set adjustment range is 16#00...16#FF. This corresponds to a value range of 0.1 °C...25.5 °C for sensor types 16#00...16#02 or a value range of 100 Ω...25.5 kΩ for sensor type 16#03. The hysteresis step size is equivalent to 0.1 °C or 100 Ω. n Offset Absolute In BYTE Get, 16#80 The adjustment range of the offset is 16#01...16#FF. This put N Set corresponds to a value range of -12.7 °C...+12.7 °C for sensor types 16#00...16#02 or a value range of -12.7 kΩ... +12.7 kΩ for sensor type 16#03. The offset step size is equivalent to 0.1 °C or 100 Ω. The 16#80s in the delivery state correspond to 0 °C or 0 Ω respectively. n Range Absolute I BYTE Get, 16#00 Setting the parameter range: nput N Set 16#00: Temperature sensors with a positive temperature range (delivery state). 16#01: Temperature sensors with a negative temperature range. ip DALICommunic I_DALICo Get, 0 Interface pointer to the communication block (see Transfer ation mmunicat Set of the reference to the communication block [} 946]). ion Requirements Development environment Required PLC library Twin CAT from v3.1.4024.20 Tc3_DALI from v3.8.0.0 850 Version: 1.20.0 TE1000
## Page 851

Programming 4.1.4.13 Tridonic 4.1.4.13.1 FB_DALI_Tridonic_MSensor G3_SFI_30_PIR The function block represents the MSensor G3 SFI 30 PIR 5DPI, MSensor G3 SFI 30 PIR 10DPI or MSensor G3 SFI 30 PIR 16DPI DALI sensor from Tridonic. This outputs an occupancy signal (instance 0), a measured brightness value (instance 1) and six push button signals (instances 2 to 7). The push button instances can be used via an infrared remote control from the vendor. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; TE1000 Version: 1.20.0 851
## Page 852

Programming b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; n Push Button5Event : WORD; n Push Button6Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. 852 Version: 1.20.0 TE1000
## Page 853

Programming Name Type Description n Push Button NEvent WORD The output outputs the events of the push buttons via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 853
## Page 854

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Push Butt BOOL Get, Set FALSE Push button input that can be enabled or disabled on the on N DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 255 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517] Button Intern N 0011 n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. 854 Version: 1.20.0 TE1000
## Page 855

Programming Name Type Access Initial Description value n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.13.2 FB_DALI_Tridonic_MSensor G3_SRC_30_PIR The function block represents the MSensor G3 SRC 30 PIR 5DPI DALI sensor from Tridonic. This outputs an occupancy signal (instance 0), a measured brightness value (instance 1) and six push button signals (instances 2 to 7). The push button instances can be used via an infrared remote control from the vendor. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. TE1000 Version: 1.20.0 855
## Page 856

Programming Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; n Push Button5Event : WORD; n Push Button6Event : WORD; END_VAR 856 Version: 1.20.0 TE1000
## Page 857

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Name Type Description n Push Button NEvent WORD The output outputs the events of the push buttons via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 857
## Page 858

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. b Enable Push Butt BOOL Get, Set FALSE Push button input that can be enabled or disabled on the on N DALI control device. FALSE on this property causes sending of events from this instance to be disabled. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 255 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517] Button Intern N 0011 n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. 858 Version: 1.20.0 TE1000
## Page 859

Programming Name Type Access Initial Description value n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. This property does not apply to the instances Push Button Scene1 and Push Button Scene2. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.13.3 FB_DALI_Tridonic_XC_G3_CWM30 The function block represents the DALI XC G3 CWM 30 DA2 DALI push button interface from Tridonic. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. TE1000 Version: 1.20.0 859
## Page 860

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. 860 Version: 1.20.0 TE1000
## Page 861

Programming Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 861
## Page 862

Programming 4.1.4.13.4 FB_DALI_Tridonic_PCell_SSI_31_PC_DA2_SA The function block represents the DALI light sensor PCell SSI 31 PC DA2 SA from Tridonic. This outputs four brightness values (instances 0 to 3). For information on the exact functions of the individual instances, please refer to the vendor's device documentation. Further information on the supported instance types can be found here: Part 304 (light sensors) - Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Brightness N, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Brightness1 : BOOL := FALSE; b Query Brightness2 : BOOL := FALSE; b Query Brightness3 : BOOL := FALSE; b Query Brightness4 : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Brightness N BOOL The brightness is queried immediately by a positive edge at this input. 862 Version: 1.20.0 TE1000
## Page 863

Programming Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Brightness1 : BOOL; b Reading Brightness2 : BOOL; b Reading Brightness3 : BOOL; b Reading Brightness4 : BOOL; n Brightness Level1 : UINT; n Brightness Level2 : UINT; n Brightness Level3 : UINT; n Brightness Level4 : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Brightness BOOL The output is TRUE as long as values of the instance of N the light sensor are being read by the DALI control device. n Brightness Level N UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. TE1000 Version: 1.20.0 863
## Page 864

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s N brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness N. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness N vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness N light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness N events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness N order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 255 As the percentage hysteresis can also lead to large ghtness N fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.64 Tc3_DALI from v3.20.3.0 4.1.4.14 Zencontrol 4.1.4.14.1 FB_DALI_Zencontrol_PIR The function block represents the PIR DALI-2 sensor from Zencontrol. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] Part 304 (light sensors) – Introduction [} 566] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. 864 Version: 1.20.0 TE1000
## Page 865

Programming The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading can be triggered immediately via the input variables b Query Occupancy and b Query Brightness, even if the corresponding instance is not enabled. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Occupancy : BOOL := FALSE; b Query Brightness : BOOL := FALSE; b Cancel Hold Timer Occupancy : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Occupancy BOOL The occupancy is queried immediately by a positive edge at this input. b Query Brightness BOOL The brightness is queried immediately by a positive edge at this input. b Cancel Hold Timer O BOOL A positive edge at this input prematurely ends the Hold ccupancy Timer and resets the output b Occupied. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR TE1000 Version: 1.20.0 865
## Page 866

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Occupancy BOOL The output is TRUE as long as values of the instance of the movement sensor are being read by the DALI control device. b Reading Brightness BOOL The output is TRUE as long as values of the instance of the light sensor are being read by the DALI control device. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. 866 Version: 1.20.0 TE1000
## Page 867

Programming Name Type Access Initial Description value b Enable Brightnes BOOL Get, Set TRUE TRUE at this property enables the instance for s brightness measurement. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Brightness. b Enable Occupanc BOOL Get, Set TRUE TRUE at this property enables the instance for motion y detection. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Occupancy. e Event Priority Brig E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. htness vent Priori w ty n Report Timer Brig BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the htness light sensor is repeated if no other event has occurred in the meantime. n Deadtime Timer B UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many rightness events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hysteresis Bright BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in ness order to prevent frequent and disturbing changes when measuring the brightness. n Hysteresis Min Bri BYTE Get, Set 10 As the percentage hysteresis can also lead to large ghtness fluctuations at low brightness, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. e Event Priority Occ E_DALIE Get, Set Middle Setting of the event priority [} 238]. upancy vent Priori ty n Deadtime Timer O UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many ccupancy events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time after an event has been sent. n Hold Timer Occup UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still ancy active after no further motion was detected by the sensor. n Report Timer Occ BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the upancy occupancy sensor is repeated if no other event has occurred in the meantime. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 TE1000 Version: 1.20.0 867
## Page 868

Programming 4.1.4.14.2 FB_DALI_Zencontrol_Scenepanel_Switch The function block represents the Scenepanel Switch DALI push button interface from Zencontrol. Up to four push buttons (instances 0 to 3) can be connected directly via the device. For information on the exact functions of the individual instances, please refer to the manufacturer's device documentation. Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value N, even if the corresponding instance is not enabled. The properties b Enable Push Button N make it possible to disable individual instances. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value1 : BOOL := FALSE; b Query Input Value2 : BOOL := FALSE; b Query Input Value3 : BOOL := FALSE; b Query Input Value4 : BOOL := FALSE; END_VAR 868 Version: 1.20.0 TE1000
## Page 869

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value N BOOL The state of the corresponding push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value1 : BOOL; b Reading Input Value2 : BOOL; b Reading Input Value3 : BOOL; b Reading Input Value4 : BOOL; n Push Button1Event : WORD; n Push Button2Event : WORD; n Push Button3Event : WORD; n Push Button4Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The outputs are set as soon as the manual reading of the N corresponding input has been triggered. n Push Button NEvent WORD The outputs output the events for the corresponding push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. TE1000 Version: 1.20.0 869
## Page 870

Programming Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. The properties of instances of the same type are listed only once in the table and marked with N at the end. Name Type Access Initial Description value b Enable Push Butt BOOL Get, Set TRUE FALSE on this property causes sending of events from on N this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button N. n Event Filter Push BYTE Get, Set 2#1000_ Setting of the event filter [} 517]. Button N 0011 e Event Priority Pus E_DALIE Get, Set Middle Setting of the event priority [} 238]. h Button N vent Priori ty n Double Timer Pus UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a h Button N single and a double button press. n Repeat Timer Pus UINT Get, Set 160 ms Interval (100…2000 ms) of repetitive events in the case h Button N of a long button press. n Short Timer Push UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a Button N long and a short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Push BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no Button N longer represents a long button press. The push button is stuck. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 4.1.4.14.3 FB_DALI_Zencontrol_Switch_1Button The function block represents the Switch 1 Button DALI push button interface from Zencontrol. One push button (instance 0) can be connected directly via the device. For information on the exact functions of the instance, please refer to the vendor's device documentation. Further information on the supported instance type can be found here: Part 301 (push buttons) - Introduction [} 516] The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. 870 Version: 1.20.0 TE1000
## Page 871

Programming The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The reading of the corresponding instance can be triggered immediately via the input variable b Query Input Value, even if the corresponding instance is not enabled. It is possible to disable the instance via the property b Enable Push Button. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Options : DWORD := 0; b Query Input Value : BOOL := FALSE; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Options DWORD Reserved for future extensions. b Query Input Value BOOL The state of the push button is queried immediately by a positive edge at this input. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value : BOOL; n Push Button Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The output is set as soon as the manual reading of the input has been triggered. n Push Button Event WORD The output outputs the events for the push button via one bit for one cycle. TE1000 Version: 1.20.0 871
## Page 872

Programming Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. Name Type Ac- Initial Description cess value b Enable Push B BOOL Get, TRUE Push button input that can be enabled or disabled on the DALI utton Set control device. FALSE on this property causes sending of events from this instance to be disabled. However, the actual value of the instance can still be queried via the input b Query Push Button. n Event Filter Pu BYTE Get, 2#100 Setting of the event filter [} 517]. sh Button Set 0_001 1 e Event Priority P E_DALIE Get, Middle Setting of the event priority [} 238]. ush Button vent Priori Set ty n Double Timer P UINT Get, 0 ms Time (0, t Double Min…2000 ms) to distinguish between a single ush Button Set and a double button press. n Repeat Timer P UINT Get, 160 m Interval (100…2000 ms) of repetitive events in the case of a long ush Button Set s button press. n Short Timer Pu UINT Get, 500 m Time (t Short Min...5100 ms) to distinguish between a long and a sh Button Set s short button press. t Short Min is a manufacturer-specific value. n Stuck Timer Pu BYTE Get, 20 s Time (5…255 s) after whose expiry the push button no longer sh Button Set represents a long button press. The push button is stuck. ip DALI_Comm I_DALIC Get, 0 Interface pointer to the communication block (see Transfer of the unication ommunic Set reference to the communication block [} 946]). ation Requirements Development environment Required PLC library Twin CAT from v3.1.4024.22 Tc3_DALI from v3.9.0.0 4.1.4.15 FB_DALI103Control Device 872 Version: 1.20.0 TE1000
## Page 873

Programming The function block is used for the configuration and operation of a DALI control device that supports Part 103 (control devices). The application controller can be activated, the operation mode specified and the event Power Cycle Notification enabled. The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; b Get Power Cycle Notifications : BOOL := TRUE; n Options : DWORD := 0; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. b Get Power Cycle Noti BOOL A TRUE at this input causes the received Power Cycle fications Notification to be output at the output. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Power Cycle Notification : BOOL; n Power Cycle Notification Short Address : BYTE; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI device has been started, and remains active until all DALI commands have been executed. b Power Cycle Notifica BOOL As soon as a Power Cycle Notification Event matches the tion desired filter criteria, this output is set to TRUE for one PLC cycle. n Power Cycle Notifica BYTE This output contains the short address (0…63) of the DALI tion Short Address control device that sent the Power Cycle Notification Event. TE1000 Version: 1.20.0 873
## Page 874

Programming Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. Name Type Access Initial value Description b Enable Application BOOL Get, FALSE If this property is TRUE, the application controller (see Controller Set application Active [} 235]) is enabled. b Enable Power Cycl BOOL Get, FALSE TRUE at this property enables the Power Cycle e Notification Set Notification event. n Operating Mode BYTE Get, 0 Specification of the operation mode (0…255) of the Set DALI control device (see operating Mode [} 235]). ip DALICommunicat I_DALI Get, 0 Interface pointer to the communication block (see ion Commu Set Transfer of the reference to the communication block nication [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.16 FB_DALI300Generic Instance The function block is used for the direct reading of generic values of an instance of a DALI control device that supports Part 103 (instance type 0). The input variable b Enable Instance can be used to configure whether the instance is enabled. If necessary, the output value can also be queried immediately via the variable b Query Input Value, even if the corresponding instance is not enabled. The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Instance Number : BYTE := 0; n Resolution : BYTE := 10; b Query Input Value : BOOL := FALSE; n Options : DWORD := 0; END_VAR 874 Version: 1.20.0 TE1000
## Page 875

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Instance Number BYTE Number of the instance (0…31) of the DALI control device to be addressed. n Resolution BYTE Vendor-specific resolution (1...64) of the input value. The value specifies the number of bits with which the input value is scaled. b Query Input Value BOOL Immediate query of the measured value. A query is possible even if the instance is disabled via the b Enable Instance property. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value : BOOL; n Value : ULINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see Error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The output is set as soon as the manual reading of the measured value has been started and remains active until all DALI commands have been processed. n Value ULINT Outputs the measured value. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 875
## Page 876

Programming Name Type Access Initial Description value b Enable Instance BOOL Get, Set TRUE The instance can be enabled or disabled on the DALI control device. If this property is FALSE, sending events from this instance is disabled. However, the actual value of the instance can still be queried via the input b Query Input Value. n Event Filter DWORD Get, Set 16#00_0 Setting of the event filter. 0_00_00 e Event Priority E_DALIE Get, Set Middle Lo Setting of the event priority [} 238]. vent Priori w ty ip DALICommunic I_DALICo Get, Set 0 Interface pointer to communication block (see Transfer of ation mmunicat the reference to the communication block [} 946]). ion Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.17 FB_DALI301Push Button The function block is used for the configuration and operation of an instance of a DALI control device that supports Part 301 (push buttons). Further information on the supported instance types can be found here: Part 301 (push buttons) - Introduction [} 516] If necessary, the output value can also be queried immediately via the variable b Query Input Value, even if the corresponding instance is not enabled. The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; 876 Version: 1.20.0 TE1000
## Page 877

Programming n Instance Number : BYTE := 0; b Query Input Value : BOOL := FALSE; b Get Input Notifications : BOOL := TRUE; n Options : DWORD := 0; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Instance Number BYTE Number of the instance (0…31) of the DALI control device to be addressed. b Query Input Value BOOL The state of the input is queried immediately by a positive edge at this input. A query is possible even if the instance is disabled via the b Enable Instance property. b Get Input Notificatio BOOL A TRUE at this input causes the received Input Notification ns Events to be output at the output. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value : BOOL; n Push Button Event : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The output is set as soon as the manual reading of the input has been triggered. n Push Button Event WORD The output outputs the events for the push button via one bit for one cycle. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. TE1000 Version: 1.20.0 877
## Page 878

Programming The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. Name Type Access Initial Description value b Enable Insta BOOL Get, Set TRUE The instance can be enabled or disabled on the DALI nce control device. If this property is FALSE, sending events from this instance is disabled. However, the actual value of the instance can still be queried via the input b Query Input Value. n Event Filter BYTE Get, Set 2#1000_00 Setting of the event filter [} 517]. 11 e Event Priority E_DALIEve Get, Set Middle Setting of the event priority [} 238]. nt Priority n Repeat Time UINT Get, Set 160 ms Time (100...2000 ms) after which the pending push r button event is repeated in case of a long button press. n Short Timer UINT Get, Set 500 ms Time (t Short Min...5100 ms) to distinguish between a long and a short button press. n Double Timer UINT Get, Set 0 ms Time (0, t Double Min…2000 ms) to distinguish between a single and a double button press. n Stuck Timer BYTE Get, Set 20 s Time (5…255 s) after whose expiry the push button no longer represents a long button press. The push button is stuck. ip DALIComm I_DALICom Get, Set 0 Interface pointer to the communication block (see unication munication Transfer of the reference to the communication block [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.18 FB_DALI302Absolute Input Device The function block is used for the configuration and operation of an instance of a DALI control device that supports Part 302 (absolute encoder). If necessary, the output value can also be queried immediately via the variable b Query Input Value, even if the corresponding instance is not enabled. The output variable n Input Level is written depending on the specified resolution n Resolution (application and vendor-specific). The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. 878 Version: 1.20.0 TE1000
## Page 879

Programming The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Instance Number : BYTE := 0; n Resolution : BYTE := 1; b Query Input Value : BOOL := FALSE; b Get Input Notifications : BOOL := TRUE; n Options : DWORD := 0; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Instance Number BYTE Number of the instance (0…31) of the DALI control device to be addressed. n Resolution BYTE Vendor-specific resolution (1...64) of the input value. The value specifies the number of bits with which the input value is scaled. b Query Input Value BOOL The state of the input is queried immediately by a positive edge at this input. A query is possible even if the instance is disabled via the b Enable Instance property. b Get Input Notificatio BOOL A TRUE at this input causes the received Input Notification ns Events to be output at the output. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value : BOOL; n Input Level : BYTE; END_VAR TE1000 Version: 1.20.0 879
## Page 880

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The output is set as soon as the manual reading of the input has been triggered. n Input Level BYTE Outputs the measured value of the resistance measurement. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. Name Type Access Initial Description value b Enable Insta BOOL Get, Set TRUE The instance can be enabled or disabled on the DALI nce control device. If this property is FALSE, sending events from this instance is disabled. However, the actual value of the instance can still be queried via the input b Query Input Value. e Event Priority E_DALIEve Get, Set Middle Setting of the event priority [} 238]. nt Priority n Report Timer BYTE Get, Set 0 Time (0…255 s) after which the pending event of the measurement is repeated if no other event has occurred in the meantime. n Deadtime Ti UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many mer events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. ip DALIComm I_DALICom Get, Set 0 Interface pointer to the communication block (see unication munication Transfer of the reference to the communication block [} 946]). Examples of the setting of the resolution: Simple switch (make contact) n Resolution := 1; When the contact is open, the output has the following value: n Input Level := 0; When closed, the output has the following value: n Input Level := 1; Switch with two positions n Resolution := 2; When contact 1 is closed, the output has the following value: n Input Level := 1; 880 Version: 1.20.0 TE1000
## Page 881

Programming When contact 2 is closed, the output has the following value: n Input Level := 2; Switch with two positions and a neutral center position: n Resolution := 2; When contact 1 is closed, the output has the following value: n Input Level := 1; In the center position, the output has the following value: n Input Level := 0 When contact 2 is closed, the output has the following value: n Input Level := 2; Rotary switch: When using a rotary switch with latching positions, the resolution n Resolution depends on the number of available positions. The output of the value n Input Level also corresponds to this. Slide resistor, potentiometer (absolute encoder): When using an absolute encoder, the resolution n Resolution and the output of the variable n Input Level are vendor-dependent. Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.19 FB_DALI303Occupancy Sensor The function block is used for the configuration and operation of an instance of a DALI control device that supports Part 303 (occupancy sensor). Further information on the supported instance types can be found here: Part 303 (occupancy sensors) – Introduction [} 547] If necessary, the output value can also be queried immediately via the variable b Query Input Value, even if the corresponding instance is not enabled. The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. TE1000 Version: 1.20.0 881
## Page 882

Programming The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Instance Number : BYTE := 0; b Query Input Value : BOOL := FALSE; b Get Input Notifications : BOOL := TRUE; b Cancel Hold Timer : BOOL := FALSE; n Options : DWORD := 0; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Instance Number BYTE Number of the instance (0…31) of the DALI control device to be addressed. b Query Input Value BOOL The state of the input is queried immediately by a positive edge at this input. A query is possible even if the instance is disabled via the b Enable Instance property. b Get Input Notificatio BOOL A TRUE at this input causes the received Input Notification ns Events to be output at the output. b Cancel Hold Timer BOOL A positive edge at this input prematurely ends the Hold Timer and resets the output b Occupied. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Value : BOOL; b Occupied : BOOL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see Error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The output is set as soon as the manual reading of the measured value has been started and remains active until all DALI commands have been processed. b Occupied BOOL If the output is TRUE, then occupancy has been detected in the detection range of the occupancy sensor. 882 Version: 1.20.0 TE1000
## Page 883

Programming Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. Name Type Access Initial Description value b Enable Instance BOOL Get, Set TRUE The instance can be enabled or disabled on the DALI control device. If this property is FALSE, sending events from this instance is disabled. However, the actual value of the instance can still be queried via the input b Query Input Value. n Event Filter BYTE Get, Set 2#0000_ Setting of the event filter [} 548]. 0111 e Event Priority E_DALIE Get, Set Middle Setting of the event priority [} 238]. vent Priori ty n Deadtime Timer UINT Get, Set 100 ms Dead time (0...12750 ms) to ensure that not too many events are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hold Timer UINT Get, Set 900 s Hold time (1...2538 s) during which the occupancy is still active after no further motion was detected by the sensor. n Report Timer BYTE Get, Set 60 s Time (0…255 s) after which the pending event of the occupancy sensor is repeated if no other event has occurred in the meantime. ip DALICommunic I_DALICo Get, Set 0 Interface pointer to the communication block (see ation mmunicat Transfer of the reference to the communication block ion [} 946]). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.20 FB_DALI304Light Sensor The function block is used for the configuration and operation of an instance of a DALI control device that supports Part 304 (light sensor). Further information on the supported instance types can be found here: Part 304 (light sensor) - Introduction [} 566] If necessary, the output value can also be queried immediately via the variable b Query Input Value, even if the corresponding instance is not enabled. The output variable n Brightness Level is written depending on the specified resolution n Resolution (application and vendor-specific). TE1000 Version: 1.20.0 883
## Page 884

Programming The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. Set the times so that as few events as possible are sent. If too many events are sent, this can have a negative effect on the behavior of the application. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Instance Number : BYTE := 0; n Resolution : BYTE := 10; b Query Input Value : BOOL := FALSE; b Get Input Notifications : BOOL := TRUE; n Options : DWORD := 0; END_VAR Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Instance Number BYTE Number of the instance (0…31) of the DALI control device to be addressed. n Resolution BYTE Vendor-specific resolution (1...64) of the input value. The value specifies the number of bits with which the input value is scaled. b Query Input Value BOOL Immediate query of the measured value. A query is possible even if the instance is disabled via the b Enable Instance property. b Get Input Notificatio BOOL A TRUE at this input causes the received Input Notification ns Events to be output at the output. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Occupancy : BOOL; b Reading Brightness : BOOL; b Occupied : BOOL; n Brightness Level : UINT; END_VAR 884 Version: 1.20.0 TE1000
## Page 885

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Value BOOL The output is set as soon as the manual reading of the measured value has been started and remains active until all DALI commands have been processed. n Brightness Level UINT Measured brightness value of the light sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. Name Type Access Initial value Description b Enable Inst BOOL Get, Set TRUE The instance can be enabled or disabled on the DALI control ance device. If this property is FALSE, sending events from this instance is disabled. However, the actual value of the instance can still be queried via the input b Query Input Value. e Event Priori E_DAL Get, Set Middle Low Setting of the event priority [} 238]. ty IEvent Priority n Deadtime T UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many events imer are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hysteresis BYTE Get, Set 5 % Value (0…25 %) for calculating a hysteresis value in order to prevent frequent and disturbing changes when measuring the illuminance. n Hysteresis BYTE Get, Set 10 Since the percentage hysteresis can lead to strong fluctuations Min when the illuminance is low, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. The value depends on the resolution. n Report Tim BYTE Get, Set 30 s Time (0…255 s) after which the pending event of the light er sensor is repeated if no other event has occurred in the meantime. ip DALICom I_DALI Get, Set 0 Interface pointer to the communication block (see Transfer of munication Comm the reference to the communication block [} 946]). unicati on TE1000 Version: 1.20.0 885
## Page 886

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.1.4.21 FB_DALI306General Purpose Sensor The function block is used for the configuration and operation of an instance of a DALI control device that supports Part 306 (general purpose sensor). Further information on the supported instance types can be found here: Part 306 (General purpose sensors) - Introduction [} 583] If necessary, the output value can also be queried immediately via the variable b Query Input Signal, even if the corresponding instance is not enabled. The output variable f Input Signal is written depending on the specified resolution n Resolution (application and vendor-specific). The existing parameters can be overwritten by changing the properties listed below. All parameters are written to the DALI control device by a positive edge at b Initialize and stored there. The outputs with the output values of the DALI device only contain valid values if the function block was executed without errors (b Error = FALSE). If the output b Error = TRUE, the outputs with the output values must not be evaluated. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Initialize : BOOL := FALSE; n Short Address : BYTE := 0; n Instance Number : BYTE := 0; n Resolution : BYTE := 10; n Magnitude : BYTE := 0; b Input Signal Signed : BOOL := FALSE; b Query Input Signal : BOOL := FALSE; b Get Input Notifications : BOOL := TRUE; b Get Alarm Notifications : BOOL := TRUE; n Options : DWORD := 0; END_VAR 886 Version: 1.20.0 TE1000
## Page 887

Programming Name Type Description b Initialize BOOL The configuration of the DALI control device is started by a positive edge at this input. During this time no DALI commands are processed. n Short Address BYTE Short address (0…63) of the DALI control device. n Instance Number BYTE Number of the instance (0…31) of the DALI control device to be addressed. n Resolution BYTE Vendor-specific resolution (1...64) of the input value. The value specifies the number of bits with which the input value is scaled. n Magnitude BYTE Magnitude (magnitude Ph Min [} 613]...magnitude Ph Max [} 613]). b Input Signal Signed BOOL Signed input signal. b Query Input Signal BOOL Immediate query of the measured value. A query is possible even if the instance is disabled via the b Enable Instance property. b Get Input Notificatio BOOL A TRUE at this input causes the received Input Notification ns Events to be output at the output. b Get Alarm Notificatio BOOL A TRUE at this input causes the received Alarm ns Notification Events to be output at the output. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Initializing : BOOL; b Reading Input Signal : BOOL; f Input Signal : LREAL; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Initializing BOOL The output is set as soon as the initialization of the DALI control device has been started, and remains active until all DALI commands have been executed. b Reading Input Signal BOOL The output is TRUE as long as values of the instance of the sensor are being read by the DALI control device. f Input Signal LREAL Measured and scaled value of the sensor. This measured value must be compared with the measured reference values at the place of operation of the DALI control device. Properties All parameters that are written to the DALI control device via b Initialize are available as properties [} 944]. TE1000 Version: 1.20.0 887
## Page 888

Programming Name Type Access Initial Description value b Enable Inst BOOL Get, Set TRUE The instance can be enabled or disabled on the DALI control ance device. If this property is FALSE, sending events from this instance is disabled. However, the actual value of the instance can still be queried via the input b Query Input Value. e Alarm0Typ E_DAL Get, Set E_DALIAlar The value defines whether the alarm is activated when the e...e Alarm3 IAlarm m Type. High value exceeds (E_DALIAlarm Type. High Limit) or falls below Type Type Limit (E_DALIAlarm Type. Low Limit) of n Alarm NLevel. e Event Prior E_DAL Get, Set Middle Low Setting of the event priority [} 238]. ity IEvent Priority n Alarm0Hy DINT Get, Set 0 Value (0…25 %) for calculating a hysteresis in order to prevent steresis...n frequent and disturbing changes when recording alarms. Alarm3Hyst eresis n Alarm0Lev DINT Get, Set MASK Specifies the threshold value above which an alarm becomes el… active. The value of e Alarm NType defines whether the alarm is n Alarm3Lev activated when the limit is exceeded el (E_DALIAlarm Type. High Limit) or when it falls below the limit (E_DALIAlarm Type. Low Limit). n Alarm Rep UINT Get, Set 150 s Time (0...1275 s) after which the pending alarm event is ort Timer repeated if no other event has occurred in the meantime. n Deadtime UINT Get, Set 1500 ms Dead time (0...12750 ms) to ensure that not too many events Timer are sent in succession. An event is only sent after expiry of the dead time timer. The dead time timer is restarted each time an event is sent. n Hysteresis BYTE Get, Set 5 % Value (0...25 %) for calculating a hysteresis to prevent frequent and disturbing changes when recording the measured value. n Hysteresis BYTE Get, Set 10 As the percentage hysteresis can also lead to large fluctuations Min if the measured value is too low, a minimum hysteresis can be specified via this property. The minimum hysteresis is an absolute value with a range from 0 to 255. The value depends on the resolution. n Report Tim BYTE Get, Set 150 s Time (0...255 s) after which the pending event of the measured er value is repeated if no other event has occurred in the meantime. ip DALICom I_DALI Get, Set 0 Interface pointer to the communication block (see Transfer of munication Comm the reference to the communication block [} 946]). unicati on Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.1.4.22 FB_DALI_To Push Button State Determines the static state from the events of a button. For correct evaluation, the events Button Released (Bit 0) and Button Pressed (Bit 1) must be activated via the event filter. 888 Version: 1.20.0 TE1000
## Page 889

Programming Release only those events that you need for the application. If too many events are sent, this can have a negative effect on the behavior of the application. Inputs VAR_INPUT n Push Button Event : UINT; END_VAR Name Type Description n Push Button Event UINT This variable contains the individual events of the push button, which are represented by the respective bits. Bit Description 0 Push button released. 1 Push button pressed. 2 Short keystroke. 3 Double keystroke. 4 Start long keystroke. 5 Repeat long keystroke. 6 Stop long keystroke. 7 Push button free again; was previously blocked. 8 Push button blocked. The function block FB_DALI_To Push Button State [} 888] can be used to convert the state of a push button into a BOOL variable. Outputs VAR_OUTPUT b Push Button : BOOL; END_VAR Name Type Description n Push Button BOOL This variable reflects the static state of the push button. The state was determined on the basis of the individual events. Example The example shows how the events of a 4-fold DALI push button are converted into four individual variables. PROGRAM Demo_ST VAR fb Switch Panel : FB_DALI_Lunatone_Cross_Switch(Communication.fb KL6821Communication); b Initialize : BOOL; b Error : BOOL; b Initializing : BOOL; a To Push Button State : ARRAY [1..4] OF FB_DALI_To Push Button State(); a Push Button : ARRAY [1..4] OF BOOL; END_VAR Program part in structured text: fb Switch Panel( b Initialize := b Initialize, n Short Address := 0, b Initializing => b Initializing, b Error => b Error); a To Push Button State[1](n Push Button Event := fb Switch Panel.n Push Button1Event, b Push Button => a Push Button[1]); a To Push Button State[2](n Push Button Event := fb Switch Panel.n Push Button2Event, b Push Button => a Push Button[2]); a To Push Button State[3](n Push Button Event := fb Switch Panel.n Push Button3Event, TE1000 Version: 1.20.0 889
## Page 890

Programming b Push Button => a Push Button[3]); a To Push Button State[4](n Push Button Event := fb Switch Panel.n Push Button4Event, b Push Button => a Push Button[4]); Program part in the Continuous Function Chart (CFC): Requirements Development environment Required PLC library Twin CAT from v3.1.4024.25 Tc3_DALI from v3.10.5.0 4.1.5 Events 4.1.5.1 FB_DALIGet Input Notification The function block filters all received Input Notification Events according to certain filter criteria. Each Input Notification contains the address of the sender and further information about the event (output n Event Info). The address of the sender consists of two fields. The meaning of these fields is defined in the DALI control device by the event scheme (see E_DALIEvent Scheme [} 908]). The function block FB_DALI103Query Event Scheme [} 196] can be used to read the value of the event scheme; the function block FB_DALI103Set Event Scheme [} 179] can be used to write to it. The two fields are a combination of the short address, instance number, instance type, instance group or device group. The source of the Input Notification is defined by the inputs e Event Scheme, n Address Info1 and n Address Info2. As soon as an Input Notification is received from this source, the output b New Data is set and the event information is output on the output n Event Info. For each Input Notification Event, which is to be received and processed further, an instance of FB_DALIGet Input Notification must be created and configured with the correct filter criteria. Moreover, this information can also be obtained at runtime with the help of the Twin CAT Communication Monitor [} 942] extension. The function block cannot be used when using the KL6811. 890 Version: 1.20.0 TE1000
## Page 891

Programming Inputs VAR_INPUT b Enable : BOOL; e Event Scheme : E_DALIEvent Scheme := E_DALIEvent Scheme. Device Instance; n Address Info1 : BYTE; n Address Info2 : BYTE; END_VAR Name Type Description b Enable BOOL If this input is TRUE, all received Input Notification Events of the DALI control devices are output according to the specified filter criteria. The filter criteria are defined by the inputs e Event Scheme, n Address Info1 and n Address Info2. e Event Scheme E_DALIEvent Scheme This input specifies the event scheme that the expected event must have. The event scheme also determines the [} 908] meaning of the two inputs n Address Info1 and n Address Info2. n Address Info1, BYTE see table below n Address Info2 e Event Scheme n Address Info1 n Address Info2 E_DALIEvent Scheme. Instance Instance type (0…31) Instance number (0..31) E_DALIEvent Scheme. Device Short address (0…63) Instance type (0…31) E_DALIEvent Scheme. Device Instan Short address (0…63) Instance number (0…31) ce E_DALIEvent Scheme. Device Grou Device group (0…31) Instance type (0…31) p E_DALIEvent Scheme. Instance Gro Instance group (0…31) Instance type (0…31) up Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b New Data : BOOL; n Event Info : WORD; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b New Data BOOL As soon as a Input Notification Event matches the desired filter criteria, this output is set to TRUE for one PLC cycle. n Event Info WORD If the output b New Data is TRUE, further information about the event can be found at this output. The exact meaning depends on the device type and is described in the respective Part 3xx of IEC 62386. The possible values of the events for the respective instance types can be found here: Part 301 (push buttons) - Input Notification [} 517] Part 302 (absolute input devices) - Input Notification [} 538] TE1000 Version: 1.20.0 891
## Page 892

Programming Part 303 (occupancy sensors) - Input Notification [} 549] Part 304 (light sensors) - Input Notification [} 567] Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.5.2 FB_DALIGet Power Cycle Notification The function block B_DALIGet Power Cycle Notification filters out all received Power Cycle Notification Events. Each Power Cycle Notification Event sent by a DALI control device contains two fields that provide information about the event source. These two fields are the short address and the smallest group address to which the DALI control device belongs. An instance of FB_DALIGet Power Cycle Notification must be created for each KL6821/EL6821 through which Power Cycle Notification Events are to be received and processed. If a Power Cycle Notification Event is detected, the output b New Data is set to TRUE for one PLC cycle. The two outputs n Short Address and n Lowest Device Group provide information about the exact source of the event. The function block cannot be used when using the KL6811. Inputs VAR_INPUT b Enable : BOOL; END_VAR Name Type Description b Enable BOOL If this input is TRUE, all received Power Cycle Notification Events of the DALI control devices are output. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b New Data : BOOL; n Short Address : BYTE; n Lowest Device Group : BYTE; END_VAR 892 Version: 1.20.0 TE1000
## Page 893

Programming Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b New Data BOOL As soon as a Power Cycle Notification Event matches the desired filter criteria, this output is set to TRUE for one PLC cycle. n Short Address BYTE This output contains the short address (0…63) of the DALI control device that sent the Power Cycle Notification Event. If the DALI control device does not have a short address, 255 (MASK) is output. n Lowest Device Grou BYTE This output contains the lowest group address (0…31) of p the DALI control device that sent the Power Cycle Notification Event. If the DALI control device is not assigned to a group, 255 (MASK) is output. Properties Name Type Access Initial Description value ip DALICommunicati I_DALICo Get,Set 0 Interface Pointer to the communication block (see on mmunicati Transfer of the reference to the communication block on [} 946]). Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.1.6 Helper 4.1.6.1 DALI_TO_PERCENT Conversion of the output value of a DALI control gear from 0...254 to 0...100 %. The conversion is logarithmic, as described in IEC 62386. A special feature is the output value 255 (MASK). If the value 255 (MASK) is passed to the function, the value 255.0 is returned. The following table shows some example values: TE1000 Version: 1.20.0 893
## Page 894

Programming n DALI Return value 0 0.0 % 1 0.100 % 10 0.128 % 85 0.991 % 100 1.492 % 128 3.206 % 150 5.845 % 200 22.892 % 254 100 % 255 (MASK) 255.0 Inputs VAR_INPUT n DALI : BYTE; END_VAR Name Type Description n DALI BYTE Output value for the DALI control gear (0…254). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.6.2 PERCENT_TO_DALI Conversion of the output value of a DALI control gear from 0...100 % to 0...254. The conversion is logarithmic, as described in IEC 62386. A special feature is the output value 255 (MASK). If the value 255.0 is passed to the function, the value 255 (MASK) is returned. The following table shows some example values: f Percent Return value <= 0.0 0 0.100 1 0.128 10 0.991 85 1.492 100 3.206 128 5.845 150 22.892 200 100.0 <= f Percent < 255.0 254 >= 255.0 255 (MASK) Inputs VAR_INPUT f Percent : LREAL; END_VAR 894 Version: 1.20.0 TE1000
## Page 895

Programming Name Type Description f Percent LREAL Output value for the DALI control gear (0…100%). Requirements Development environment Required PLC library Twin CAT from v3.1.4024.32 Tc3_DALI from v3.12.0.0 4.1.7 Simulation Lighting technology applications have become increasingly extensive and complex in recent years. On the one hand, the demands for more flexibility have increased and, on the other hand, additional performance features such as Tunable White (color temperature control), dynamic scene management or diagnostic functions have been added. At the same time, the time and effort required to create the application program and commission the system should be kept to a minimum. By simulating the DALI devices used, an application program can be completely created, extensively tested and optimized even before commissioning. Deficits in the design of the hardware are detected at an early stage and cost-intensive conversion measures are prevented. The effort for commissioning at the real plant is reduced. In addition to the preparation of commissioning, the simulation blocks are also well suited for training or presentations. Thus, even larger DALI lines can be mapped without the need for additional hardware. The simulation blocks are also a prerequisite for automated testing of function blocks (unit tests). The Tc3_DALI library provides function blocks for simulating DALI lines with the associated DALI control gears. The simulation is completely transparent for the application program. Simulated DALI lines are mapped by the function block FB_DALIVirtual Communication [} 896]. As with FB_KL6811Communication [} 618], FB_KL6821Communication [} 621] and FB_EL6821Communication [} 614], FB_DALIVirtual Communication also creates one instance per DALI line and calls it cyclically in a fast task. fb DALISimulation Communication : FB_DALIVirtual Communication; This instance is passed to the respective application function blocks. fb Dimmer2Switch : FB_DALI102Dimmer2Switch(Communication.fb DALISimulated Communication); The individual DALI control gears are represented by the function block FB_DALIVirtual Control Gear [} 897]. One instance is required per DALI control gear. The individual parameters such as short address, group assignments, scenes, etc. are set via Properties. When the instances are declared, they are also assigned to the simulated DALI line. fb SUT : ARRAY [1..6] OF FB_DALIVirtual Control Gear(fb Virtual Communication) := [(n Short Address := 0, n Groups := 2#0010_0000_0100_1100, n Max Level := 254, n Min Level := 85), (n Short Address := 1, n Groups := 2#0000_0100_0000_0000, n Max Level := 254, n Min Level := 85), (n Short Address := 2, n Groups := 2#0000_0100_0000_0000, n Max Level := 254, n Min Level := 85), (n Short Address := 3, n Groups := 2#0000_0000_0100_1111, n Max Level := 254, n Min Level := 85), (n Short Address := 4, n Groups := 2#0010_0000_0000_1010, n Max Level := 254, n Min Level := 85), (n Short Address := 5, n Groups := 2#0010_0100_0000_0100, n Max Level := 254, n Min Level := 85)]; The properties can be changed at runtime of the simulation. Hereby e.g. error states can be simulated (see property b Lamp Failure [} 898]) and the behavior of the application can be checked for these errors. For the visual representation of the individual simulated DALI control gears, the Twin CAT PLC HMI can be used, for example. For this purpose, the ready-to-use sample application DALI PLC Simulation Tool is provided. TE1000 Version: 1.20.0 895
## Page 896

Programming 4.1.7.1 FB_DALIVirtual Communication The individual DALI commands are temporarily stored in a command buffer within the Tc3_DALI library before further processing. The FB_DALIVirtual Communication function block sequentially reads the DALI commands from this command buffer and forwards the DALI commands to the associated instances of FB_DALIVirtual Control Gear [} 897]. One instance of the FB_DALIVirtual Communication function block must be created for each DALI line that is to be simulated. This instance must be called in a separate, faster task. This faster communication task must have a higher priority than the task in which the function blocks for the individual DALI commands are called. The utilization rate of the command buffer can be determined using the outputs of the function block. If you find that the command buffer is overflowing regularly, you should take the following steps: • How heavily are the individual PLC tasks utilized? Twin CAT provides suitable analysis tools. • Try reducing the cycle time of the task in which the FB_DALIVirtual Communication function block is called. The value should not be greater than 6 ms. The optimum value is 2 ms or less. • Check the cycle time of the PLC task in which the function blocks for the individual DALI commands are called. This value should not be greater than 10 ms. The optimum value is 8 ms or less. • If possible avoid polling (regular reading) of values. Only read values when they are actually required. • Distribute the individual simulated DALI devices evenly over several DALI lines. Since several DALI lines are processed simultaneously in each PLC cycle, this increases the data throughput. Inputs VAR_INPUT b Reset Maximum Demand Counter : BOOL; b Reset Overflow Counter : BOOL; n Options : DWORD := 0; END_VAR 896 Version: 1.20.0 TE1000
## Page 897

Programming Name Type Description b Reset Maximum De BOOL A positive edge resets the stored value for the maximum mand Counter utilization of the command buffer, n Buffer Maximum Demand Meter (0…100%). Reset Overflow Count BOOL A positive edge resets the stored value for the number of er overflows of the command buffer, n Buffer Overflow Counter. n Options DWORD Reserved for future extensions. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; b Busy : BOOL; n Buffer Demand Meter : BYTE; n Buffer Maximum Demand Meter : BYTE; n Buffer Overflow Counter : UINT; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. b Busy BOOL The output is set as soon as execution of the DALI commands has commenced. It remains active until all DALI commands have been processed. n Buffer Demand Mete BYTE Utilization rate of the command buffer (0…100%). r n Buffer Maximum De BYTE Maximum utilization rate of the command buffer reached mand Meter so far (0…100%). The counter can be reset via the input b Reset Maximum Demand Counter. n Buffer Overflow Cou UINT Number of command buffer overflows to date. The counter nter can be reset via the input b Reset Overflow Counter. Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.1.7.2 FB_DALIVirtual Control Gear The function block represents a DALI control gear on a virtual DALI line. For each virtual DALI control gear an instance of FB_DALIVirtual Control Gear must be created. During the declaration the interface pointer of FB_DALIVirtual Communication [} 896] is passed, whereby the virtual DALI control gear is assigned to the virtual DALI line. The individual variables for the virtual DALI control gear are set via Properties. The same function blocks as for real DALI control gears are used for access from the application program, e.g. FB_DALI102Go To Scene [} 87], FB_DALI102Set Min Level [} 73] or FB_DALI102Query Content DTR0 [} 100]. TE1000 Version: 1.20.0 897
## Page 898

Programming Currently FB_DALIVirtual Control Gear supports most DALI commands to Part 102. The DALI PLC Simulation Tool is a Twin CAT 3 sample application that can be used to visualize virtual DALI control gears. The individual parameters of the virtual DALI control gears can be set via corresponding dialogs. Outputs VAR_OUTPUT b Error : BOOL; ip Result Message : I_Tc Message; END_VAR Name Type Description b Error BOOL This output is switched to TRUE if an error occurs during the execution. Further information about the error can be queried via the variable ip Result Message. The output is set to FALSE again as soon as b Busy switches to TRUE. ip Result Message I_Tc Message Interface pointer (see error evaluation [} 939]) that can be used to obtain detailed information about the processing of the function block (see runtime messages [} 923]). The interface pointer is valid after b Busy has changed from TRUE to FALSE. Properties Via Properties the variables [} 153] of the virtual DALI control gear can be set or also queried. 898 Version: 1.20.0 TE1000
## Page 899

Programming Name Type Access Initial Description value a Scene Levels REFERE Get, Set [16(255)] See scene0...scene15 [} 159]. NCE TO ARRAY [0..15] OF BYTE b Control Gear Failu BOOL Get, Set FALSE See control Gear Failure [} 158]. re b Lamp Failure BOOL Get, Set FALSE See lamp Failure [} 158]. e Extended Fade Ti E_DALIE Get, Set E_DALIE See extended Fade Time Base [} 157]. me Base xtended F xtended F ade Time ade Time Base Base. Bas e01 e Extended Fade Ti E_DALIE Get, Set E_DALIE See extended Fade Time Multiplier [} 157]. me Multiplier xtended F xtended F ade Time ade Time Multiplier Multiplier. Disabled e Fade Rate E_DALIF Get, Set E_DALIF See fade Rate [} 155]. ade Rate ade Rate. N045Ste ps Per Sec e Fade Time E_DALIF Get, Set E_DALIF See fade Time [} 156]. ade Time ade Time. Disabled n Actual Level BYTE Get, Set 254 See actual Level [} 155]. n DTR0 BYTE Get, Set 0 See DTR0... DTR2 [} 159]. n DTR1 BYTE Get, Set 0 See DTR0... DTR2 [} 159]. n DTR2 BYTE Get, Set 0 See DTR0... DTR2 [} 159]. n Groups WORD Get, Set 16#0000 See gear Groups [} 159]. n Max Level BYTE Get, Set 254 See min Level / max Level [} 155]. n Min Level BYTE Get, Set 85 See min Level / max Level [} 155]. n Physical Minimu BYTE Get, Set 85 See physical Min Level [} 159]. m n Power On Level BYTE Get, Set 254 See power On Level [} 155]. The output value is set to n Power On Level as soon as the function block is initialized (e.g. restart of the PLC program). n Short Address BYTE Get, Set 255 See short Address [} 158]. n Status BYTE Get, Set 0 Status of the DALI control gear. See also FB_DALI102Query Status [} 126]. n System Failure Le BYTE Get, Set 254 See system Failure Level [} 155]. vel Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.1.7.3 DALI PLC Simulation Tool The DALI PLC Simulation Tool can be used to simulate DALI lines with up to 64 virtual DALI control gears (see https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/17442463115.zip). TE1000 Version: 1.20.0 899
## Page 900

Programming The Twin CAT project is available for download as *.zip file. This must first be unpacked locally so that the archive (*.tnzip file) is available for import into the Twin CAT project. Each virtual DALI control gear is represented by a lamp symbol. The number below the symbol is the DALI short address, while the number in the middle contains the current output value. If the output value is greater than 0, the color of the lamp symbol changes from gray to yellow. If you click the Parameters button, an overview page with all parameters of the selected virtual DALI control gear opens. Operation of the parameter interface The current parameters from the virtual DALI control gear are displayed here. It is also possible to modify them and thus change the behavior of the virtual DALI control gear. 900 Version: 1.20.0 TE1000
## Page 901

Programming For more information on the parameters used, see chapter Variables [} 153]. Requirements Required PLC library DALI PLC Simulation Tool Tc3_DALI from v3.11.0.0 Tc3_DALI_PLC_Simulation_Tool v1.0.0.0 4.2 DUTs 4.2.1 Structures 4.2.1.1 ST_DALIChange Address List TYPE ST_DALIChange Address List : STRUCT n Old Address : BYTE; n New Address : BYTE; n Random Address : UDINT; n Errors : DWORD; END_STRUCT END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.1.2 ST_DALIControl Gear Settings TYPE ST_DALIVControl Gear Settings : STRUCT n Errors : DWORD; b Present : BOOL; n Actual Level : BYTE; TE1000 Version: 1.20.0 901
## Page 902

Programming n Power On Level : BYTE; n System Failure Level : BYTE; n Min Level : BYTE; n Max Level : BYTE; e Fade Rate : E_DALIFade Rate; e Fade Time : E_DALIFade Time; e Fade Time Base : E_DALIExtended Fade Time Base; e Fade Time Multiplier : E_DALIExtended Fade Time Multiplier; n Random Address : DWORD; n Groups : WORD; a Scene Levels : ARRAY [0..15] OF BYTE; n Status : BYTE; n Major Version : BYTE; n Minor Version : BYTE; a Device Types : ARRAY [1..20] OF E_DALIDevice Type; n Physical Min Level : BYTE; END_STRUCT END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.2.1.3 ST_EL6821In Data TYPE ST_EL6821In Data: STRUCT n Status : WORD n Send Error Code : USINT; n Number Of Buffer Entries : USINT; n Number Of Addressed Devices : USINT; n Addressing Error Code : USINT; b Input01 : BIT; b Input02 : BIT; n Rx Buffer Info : WORD; n Rx Buffer Frame : UDINT; st Ads Addr : ST_Ams Addr; END_STRUCT END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.47 Tc3_DALI from v3.16.1.0 4.2.1.4 ST_EL6821Out Data TYPE ST_KL6821In Data : STRUCT n Ctrl : WORD; n Addressing Start Address : USINT; n Frame : UDINT END_STRUCT END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.47 Tc3_DALI from v3.16.1.0 4.2.1.5 ST_KL6811In Data TYPE ST_KL6811In Data : STRUCT n Status : BYTE; n Data : WORD; END_STRUCT END_TYPE 902 Version: 1.20.0 TE1000
## Page 903

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.1.6 ST_KL6811Out Data TYPE ST_KL6811Out Data : STRUCT n Ctrl : BYTE; n Data : WORD; END_STRUCT END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.1.7 ST_KL6821In Data TYPE ST_KL6821In Data : STRUCT n Status : WORD a Data : ARRAY [0..3] OF BYTE; END_STRUCT END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.1.8 ST_KL6821Out Data TYPE ST_KL6821Out Data : STRUCT n Ctrl : WORD; a Data : ARRAY [0..3] OF BYTE; END_STRUCT END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.2 Enumerations 4.2.2.1 E_DALIAddress Type TYPE E_DALIAddress Type : ( Short := 0, Group := 1, Broadcast := 2, Broadcast Unaddr := 3 ) BYTE := Short; END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 TE1000 Version: 1.20.0 903
## Page 904

Programming 4.2.2.2 E_DALIAlarm Number TYPE E_DALIAlarm Number : ( e Alarm0 := 0, e Alarm1 := 1, e Alarm2 := 2, e Alarm3 := 3 ) USINT; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.2.2.3 E_DALIAlarm Type TYPE E_DALIAlarm Type : ( Low Limit := 0, High Limit := 1 ) USINT; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.2.2.4 E_DALIColour Temperature Tc Limit TYPE E_DALIColour Temperature Tc Limit : ( Colour Temperature Tc Coolest := 0, Colour Temperature Tc Warmest := 1, Colour Temperature Tc Physical Coolest := 2, Colour Temperature Tc Physical Warmest := 3 ) USINT; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.2.2.5 E_DALIColour Type TYPE E_DALIColour Type : ( Unknown := 16#00, Xy Coordinate := 16#10, Colour Temperature Tc := 16#20, Primary NDim Level := 16#40, RGBWAFControl := 16#80, MASK := 255 ) USINT := MASK; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 904 Version: 1.20.0 TE1000
## Page 905

Programming 4.2.2.6 E_DALIColour Value TYPE E_DALIColour Value : ( XCoordinate := 0, YCoordinate := 1, Colour Temperature Tc := 2, Primary NDim Level0 := 3, Primary NDim Level1 := 4, Primary NDim Level2 := 5, Primary NDim Level3 := 6, Primary NDim Level4 := 7, Primary NDim Level5 := 8, Red Dim Level := 9, Green Dim Level := 10, Blue Dim Level := 11, White Dim Level := 12, Amber Dim Level := 13, Free Colour Dim Level := 14, RGBWAFControl := 15, XCoordinate Primary N0 := 64, YCoordinate Primary N0 := 65, TYPrimary N0 := 66, XCoordinate Primary N1 := 67, YCoordinate Primary N1 := 68, TYPrimary N1 := 69, XCoordinate Primary N2 := 70, CCoordinate Primary N2 := 71, TYPrimary N2 := 72, XCoordinate Primary N3 := 73, YCoordinate Primary N3 := 74, TYPrimary N3 := 75, XCoordinate Primary N4 := 76, YCoordinate Primary N4 := 77, TYPrimary N4 := 78, XCoordinate Primary N5 := 79, YCoordinate Primary N5 := 80, TYPrimary N5 := 81, Number Of Primaries := 82, Colour Temperature Tc Coolest := 128, Colour Temperature Tc Physical Coolest := 129, Colour Temperature Tc Warmest := 130, Colour Temperature Tc Physical Warmest := 131, Temporary XCoordinate := 192, Temporary YCoordinate := 193, Temporary Colour Temperature Tc := 194, Temporary Primary NDim Level0 := 195, Temporary Primary NDim Level1 := 196, Temporary Primary NDim Level2 := 197, Temporary Primary NDim Level3 := 198, Temporary Primary NDim Level4 := 199, Temporary Primary NDim Level5 := 200, Temporary Red Dim Level := 201, Temporary Green Dim Level := 202, Temporary Blue Dim Level := 203, Temporary White Dim Level := 204, Temporary Amber Dim Level := 205, Temporary Free Colour Dim Level := 206, Temporary RGBWAFControl := 207, Temporary Colour Type := 208, Report XCoordinate := 224, Report YCoordinate := 225, Report Colour Temperature Tc := 226, Report Primary NDim Level0 := 227, Report Primary NDim Level1 := 228, Report Primary NDim Level2 := 229, Report Primary NDim Level3 := 230, Report Primary NDim Level4 := 231, Report Primary NDim Level5 := 232, Report Red Dim Level := 233, Report Green Dim Level := 234, Report Blue Dim Level := 235, Report White Dim Level := 236, Report Amber Dim Level := 237, Report Free Colour Dim Level := 238, Report RGBWAFControl := 239, Report Colour Type := 240 ) USINT; END_TYPE TE1000 Version: 1.20.0 905
## Page 906

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.2.2.7 E_DALICommand Priority TYPE E_DALICommand Priority : ( High := 1, Middle High := 2, Middle := 3, Middle Low := 4, Low := 5, Unknown := 255 ) BYTE := Middle; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.2.2.8 E_DALIConfiguration Command TYPE E_DALIConfiguration Command : ( Do Nothing := 0, Off := 1, Recall Max Level := 2, Recall Min Level := 3, Go To Scene0 := 4, Go To Scene1 := 5, Go To Scene2 := 6, Go To Scene3 := 7, Go To Scene4 := 8, Go To Scene5 := 9, Go To Scene6 := 10, Go To Scene7 := 11, Go To Scene8 := 12, Go To Scene9 := 13, Go To Scene10 := 14, Go To Scene11 := 15, Go To Scene12 := 16, Go To Scene13 := 17, Go To Scene14 := 18, Go To Scene15 := 19 ); END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.2.9 E_DALIData Frame Type TYPE E_DALIData Frame Type : ( Bit16 := 1, Bit24 := 3 ) BYTE; END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 906 Version: 1.20.0 TE1000
## Page 907

Programming 4.2.2.10 E_DALIDevice Type TYPE E_DALIDevice Type : ( DT00Fluorescent Lamp := 0, DT01Independent Emergency Lighting := 1, DT02Discharge Lamp := 2, DT03Low Voltage Halogen Lamp := 3, DT04Incandescent Lamp := 4, DT05Conversion Of Digital Signal To DCVoltage := 5, DT06LEDModule := 6, DT07Switching Function := 7, DT08Colour Control := 8, DT09Sequencer := 9, DT15Load Referencing := 15, DT16Thermal Gear Protection := 16, DT17Dimming Curve Selection := 17, DT19Centrally Supplied Emergency Operation := 19, DT20Load Shedding := 20, DT21Thermal Lamp Protection := 21, DT23Integrated Light Source := 23, DT49Integrated Bus Power Supply := 49, DT50Memory Bank1Extension := 50, DT51Energy Reporting := 51, DT52Diagnostics Maintenance := 52, DT53Extended Emergency Data := 53, Unknown := 255 ) BYTE := Unknown; END_TYPE DT00Fluorescent Lamp: Part 201: Standard device (device type 0) DT01Independent Emergency Lighting: Part 202: Device for emergency lighting (device type 1) DT02Discharge Lamp: Part 203: Device for discharge lamps (device type 2) DT03Low Voltage Halogen Lamp: Part 204: Device for low-voltage halogen lamps (device type 3) DT04Incandescent Lamp: Part 205: Supply voltage controller for incandescent lamps (device type 4) DT05Conversion Of Digital Signal To DCVoltage: Part 206: Device for converting digital signals into DC voltage signals (device type 5) DT06LEDModule: Part 207: Device for LED modules (device type 6) DT07Switching Function: Part 208: Device for switching functions (device type 7) DT08Colour Control: Part 209: Device for color/color temperature control (device type 8) DT09Sequencer: Part 210: Sequencer (device type 9) DT15Load Referencing: Part 216: Load referencing (device type 15) DT16Thermal Gear Protection: Part 217: Thermal gear protection (device type 16) DT17Dimming Curve Selection: Part 218: Dimming curve selection (device type 17) DT19Centrally Supplied Emergency Operation: Part 220: Centrally supplied emergency operation (device type 19) DT20Load Shedding: Part 221: Load shedding (device type 20) DT21Thermal Lamp Protection: Part 222: Thermal lamp protection (device type 21) DT23Integrated Light Source: Part 224: Non-replaceable light sources (device type 23) DT49Integrated Bus Power Supply: Part 250: Devices with integrated DALI bus power supply (device type 49) DT50Memory Bank1Extension: Part 251: Further information and parameters for DALI control gears in memory bank 1 (device type 50) DT51Energy Reporting: Part 252: Further parameters for the creation of an energy report (device type 51) TE1000 Version: 1.20.0 907
## Page 908

Programming DT52Diagnostics Maintenance: Part 253: Further parameters with diagnostic and maintenance information for DALI control gears (device type 52) DT53Extended Emergency Data: Part 254: Extended information for DALI control gears for emergency lighting (device type 53) Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.2.2.11 E_DALIDimming Curve TYPE E_DALIDimming Curve : ( Standard := 0, Linear := 1, Unknown := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.2.2.12 E_DALIEvent Priority TYPE E_DALIEvent Priority : ( Middle High := 2, Middle := 3, Middle Low := 4, Low := 5, Unknown := 255 ) BYTE := Middle; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.2.2.13 E_DALIEvent Scheme TYPE E_DALIEvent Scheme : ( Instance := 0, Device := 1, Device Instance := 2, Device Group := 3, Instance Group := 4, Unknown := 255 ) BYTE := Unknown; END_TYPE Instance: Instance addressing with instance type and instance number. Device: Device addressing with short address and instance type. Device Instance: Device/instance addressing with short address and instance number. Device Group: Addressing of device groups with device group and instance type. Instance Group: Addressing of instance groups with instance group and instance type. 908 Version: 1.20.0 TE1000
## Page 909

Programming Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.2.14 E_DALIEvent Type TYPE E_DALIEvent Type : ( Input Notification := 0, Power Notification := 1, Unknown := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.2.15 E_DALIExtended Fade Time Base TYPE E_DALIExtende Fade Time Base : ( Base01 := 0, Base02 := 1, Base03 := 2, Base04 := 3, Base05 := 4, Base06 := 5, Base07 := 6, Base08 := 7, Base09 := 8, Base10 := 9, Base11 := 10, Base12 := 11, Base13 := 12, Base14 := 13, Base15 := 14, Base16 := 15, Unknown := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.2.2.16 E_DALIExtended Fade Time Multiplier TYPE E_DALIExtende Fade Time Multiplier : ( Disabled := 0, Multiplier100ms := 1, Multiplier1s := 2, Multiplier10s := 3, Multiplier1min := 4, Unknown := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 TE1000 Version: 1.20.0 909
## Page 910

Programming 4.2.2.17 E_DALIFade Rate TYPE E_DALIFade Rate : ( N358Steps Per Sec := 1, N253Steps Per Sec := 2, N179Steps Per Sec := 3, N127Steps Per Sec := 4, N089Steps Per Sec := 5, N063Steps Per Sec := 6, N045Steps Per Sec := 7, N032Steps Per Sec := 8, N022Steps Per Sec := 9, N016Steps Per Sec := 10, N011Steps Per Sec := 11, N008Steps Per Sec := 12, N006Steps Per Sec := 13, N004Steps Per Sec := 14, N003Steps Per Sec := 15, Unknown := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.2.2.18 E_DALIFade Time TYPE E_DALIFade Time : ( Disabled := 0, T00707ms := 1, T01000ms := 2, T01400ms := 3, T02000ms := 4, T02800ms := 5, T04000ms := 6, T05700ms := 7, T08000ms := 8, T11300ms := 9, T16000ms := 10, T22600ms := 11, T32000ms := 12, T45300ms := 13, T64000ms := 14, T90500ms := 15, Unknown := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.4 Tc3_DALI from v3.2.0.0 4.2.2.19 E_DALIFast Fade Time TYPE E_DALIFast Fade Time : ( Disabled := 0, T100ms := 4, T200ms := 8, T225ms := 9, T300ms := 12, T400ms := 16, T500ms := 20, T600ms := 24, T700ms := 27, Unknown := 255 ) BYTE := Unknown; END_TYPE 910 Version: 1.20.0 TE1000
## Page 911

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.2.2.20 E_DALIInstance Address Type TYPE E_DALIInstance Address Type : ( Instance Number := 0, Instance Group := 1, Instance Type := 2, Feature Number := 3, Feature Group := 4, Feature Type := 5, Feature Broadcast := 6, Instance Broadcast := 7, Feature Device := 8, Device := 9 ) BYTE := Instance Number; END_TYPE Instance Number: Instance number (0…31). Instance Group: Instance group (0…31). Instance Type: Instance type (0…31). Feature Number: Feature at instance number level (0...31). Feature Group: Feature at instance group level (0...31). Feature Type: Feature at instance type level (0...31). Feature Broadcast: Feature at instance broadcast level. Instance Broadcast: Instance broadcast. Feature Device: Feature at device level. Device: Device Requirements Development environment required PLC library Twin CAT from v3.1.4022.29 Tc3_DALI from v3.1.4.0 4.2.2.21 E_DALIInstance Type TYPE E_DALIInstance Type : ( IT00Generic Instance := 0, IT01Push Button := 1, IT02Absolute Input Device := 2, IT03Occupancy Sensor := 3, IT04Light Sensor := 4, IT05Colour Sensor := 5, IT06General Purpose Sensor := 6, IT32Input Control Device Feedback := 32, IT33Manual Configuration := 33, IT51Luminaire Mounted Control Device := 51, Unknown := 255 ) BYTE := Unknown; END_TYPE IT00Generic Instance: Part 103: Control device (instance type 0) IT01Push Button: Part 301: Push button (instance type 1) IT02Absolute Input Device: Part 302: Absolute input device (instance type 2) IT03Occupancy Sensor Part 303: Occupancy sensor (instance type 3) TE1000 Version: 1.20.0 911
## Page 912

Programming IT04Light Sensor: Part 304: Light sensor (instance type 4) IT05Colour Sensor: Part 305: Color sensor (instance type 5) IT06General Purpose Sensor: Part 306: Universal sensor (instance type 6) IT32Input Control Device Feedback: Part 332: Feedback for input devices (instance type 32) IT33Manual Configuration: Part 333: Manual configuration (instance type 33) IT51Luminaire Mounted Control Device: Part 351: Control device integrated in the luminaire (instance type 51) Requirements Development environment Required PLC library Twin CAT from v3.1.4024.11 Tc3_DALI from v3.5.0.0 4.2.2.22 E_DALILight Source Type TYPE E_DALILight Source Type : ( Low Pressure Fluorescent := 0, HID := 2, Low Voltage Halogen := 3, Incandescent := 4, LED := 6, OLED := 7, Other := 252, Unknown := 253, No Light Source := 254, Multiple := 255 ) BYTE := Unknown; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.29 Tc3_DALI from v3.11.0.0 4.2.2.23 E_DALILoytec Input Configuration TYPE E_DALILoytec Input Configuration : ( Push Button := 0, Generic Input := 1, Absolute Value := 2 ) BYTE := Push Button; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.2.2.24 E_DALILoytec Resistance Configuration TYPE E_DALILoytec Resistance Configuration : ( Resistance1k Ohm := 0, Resistance10k Ohm := 1, ) BYTE := Resistance10k Ohm; END_TYPE 912 Version: 1.20.0 TE1000
## Page 913

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.10 Tc3_DALI from v3.4.0.0 4.2.2.25 E_DALIMeasurement Variable TYPE E_DALIMeasurement Variable : ( Alarm Is Activated := 0, Alarm Type := 1, Input Signal Signed := 2, Alarm0Byte0 := 3, // MSB Alarm0Byte1 := 4, Alarm0Byte2 := 5, // LSB Alarm1Byte0 := 6, // MSB Alarm1Byte1 := 7, Alarm1Byte2 := 8, // LSB Alarm2Byte0 := 9, // MSB Alarm2Byte1 := 10, Alarm2Byte2 := 11, // LSB Alarm3Byte0 := 12, // MSB Alarm3Byte1 := 13, Alarm3Byte2 := 14, // LSB Alarm0Hysteresis Byte0 := 15, // MSB Alarm0Hysteresis Byte1 := 16, Alarm0Hysteresis Byte2 := 17, // LSB Alarm1Hysteresis Byte0 := 18, // MSB Alarm1Hysteresis Byte1 := 19, Alarm1Hysteresis Byte2 := 20, // LSB Alarm2Hysteresis Byte0 := 21, // MSB Alarm2Hysteresis Byte1 := 22, Alarm2Hysteresis Byte2 := 23, // LSB Alarm3Hysteresis Byte0 := 24, // MSB Alarm3Hysteresis Byte1 := 25, Alarm3Hysteresis Byte2 := 26, // LSB Unit Of Measurement := 27, Unit Of Measurement Extended LSB := 28, // LSB: Bit 0..7 Unit Of Measurement Extended MSB := 29, // MSB: Bit 8..15 Quantity Name := 30, Quantity Name Extended LSB := 31, // LSB: Bit 0..7 Quantity Name Extended MSB := 32, // MSB: Bit 8..15 Magnitude := 33, Magnitude Ph Max := 34, Magnitude Ph Min := 35, Max Measured Value Byte0 := 36, // MSB Max Measured Value Byte1 := 37, Max Measured Value Byte2 := 38, Max Measured Value Byte3 := 39, // LSB Min Measured Value Byte0 := 40, // MSB Min Measured Value Byte1 := 41, Min Measured Value Byte2 := 42, Min Measured Value Byte3 := 43 // LSB ) USINT; END_TYPE Requirements Development environment Required PLC library Twin CAT from v3.1.4024.59 Tc3_DALI from v3.19.1.0 4.2.2.26 E_DALITest Timing TYPE E_DALITest Timing : ( Function Test Delay Time := 0, Duration Test Delay Time := 2, Function Test Interval := 4, Duration Test Interval := 5, Test Execution Timeout := 6, Prolong Time := 7 ) BYTE; END_TYPE TE1000 Version: 1.20.0 913
## Page 914

Programming Requirements Development environment Required PLC library Twin CAT from v3.1.4024.35 Tc3_DALI from v3.13.0.0 4.3 GVLs 4.3.1 Constants VAR_GLOBAL e Event Trace Level : Tc Event Severity := Tc Event Severity. Critical; END_VAR VAR_GLOBAL_CONSTANT c Memory Mode : DWORD := 16#0000_0001; c Complete New Installation : DWORD := 16#0000_0001; c Delete All Group Assignments : DWORD := 16#0000_0002; c Delete All Scene Assignments : DWORD := 16#0000_0004; c Optical Feedback : DWORD := 16#0000_0008; c Check Lamp Failure : DWORD := 16#0000_0010; c Check Control Gear Failure : DWORD := 16#0000_0020; c Check Unaddressed Control Gears : DWORD := 16#0000_0040; c Option Actual Dim Level : DWORD := 16#0000_0001; c Option Power On Level : DWORD := 16#0000_0002; c Option System Failure Level : DWORD := 16#0000_0004; c Option Min Level : DWORD := 16#0000_0008; c Option Max Level : DWORD := 16#0000_0010; c Option Fade Rate : DWORD := 16#0000_0020; c Option Fade Time : DWORD := 16#0000_0040; c Option Fade Rate Fade Time : DWORD := 16#0000_0080; c Option Extended Fade Time : DWORD := 16#0000_0100; c Option Random Address : DWORD := 16#0000_0200; c Option Groups : DWORD := 16#0000_0400; c Option Scene Levels : DWORD := 16#0000_0800; c Option Status Information : DWORD := 16#0000_1000; c Option Version Number : DWORD := 16#0000_2000; c Option Device Type : DWORD := 16#0000_4000; c Option Physical Min Level : DWORD := 16#0000_8000; c Option All : DWORD := 16#00FF_FFFF; END_VAR 4.3.2 Parameter VAR_GLOBAL CONSTANT c Timeout Terminal Response : TIME := T#500MS; c Timeout Device Response : TIME := T#80MS; c Timeout Response Table : TIME := T#30S; c Timeout Post Command : TIME := T#1S c Timeout Initialize Terminal : TIME := T#5S; c Timeout Addressing : TIME := T#3M; c Timeout Transaction : TIME := T#1M; c Max Command Buffer Entries : USINT := 120; c Max Response Table Entries : USINT := 120; c Max Event Table Entries : USINT := 20; c Max Virtual Devices : USINT := 64; END_VAR The Tc3_DALI library contains some parameters which can be used to change general settings. The parameter list can be accessed via the Library Manager. The values of the individual parameters can also be adjusted there. NOTICE Note that some parameters have a profound effect on the way the Tc3_DALI library works. 914 Version: 1.20.0 TE1000
## Page 915

Programming 4.4 Integration into Twin CAT 4.4.1 EL6821 with CX5120 This sample explains how to write a simple PLC program for DALI in Twin CAT and how to link it with the hardware. A single lamp is to be controlled and switched to the maximum output value or switched off with a push button. Sample: https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/13899865611.zip The Twin CAT project is available for download as *.zip file. This must first be unpacked locally so that the archive (*.tnzip file) is available for import into the Twin CAT project. Hardware Setting up the components 1x CX5120 Embedded PC 1x EL1008 digital 8-channel input terminal (for the switch-on/switch-off function) 1 x power supply terminal EL9562 1x DALI terminal EL6821 1 x end terminal EL9011 TE1000 Version: 1.20.0 915
## Page 916

Programming Set up the hardware and the DALI components as described in the documentation. This sample assumes that an On button was connected to the first EL1008 input and an Off button to the second. There is a lamp at DALI address 0. Software Creation of the PLC program Create a new Twin CAT XAE Project and a Standard PLC Project. Add the Tc3_DALI library in the PLC project under References. Generate a global variable list with the name GVL_DALI and create the following variables: VAR_GLOBAL b Switch On AT %I* : BOOL; b Switch Off AT %I* : BOOL; st EL6821In Data AT %I* : ST_EL6821In Data; st EL6821Out Data AT %Q* : ST_EL6821Out Data; END_VAR b Switch On: Input variable for the On button. b Switch Off: Input variable for the Off button. st EL6821In Data Input variable for the DALI terminal (see ST_EL6821In Data [} 902]). st EL6821Out Data: Output variable for the DALI terminal (see ST_EL6821Out Data [} 902]). Create a program (CFC) for the background communication with the DALI terminal. The function block FB_EL6821Communication [} 614] is called in the program. In the communication block ensure that the structures st In Data and st Out Data are linked. Create a MAIN program (CFC) in which the function blocks FB_DALI102Recall Max Level [} 91] and FB_DALI102Off [} 88] are declared as follows. PROGRAM MAIN VAR fb102Recall Max Level : FB_DALI102Recall Max Level(Communication.fb EL6821Communication); fb102Off : FB_DALI102Off(Communication.fb EL6821Communication); END_VAR The communication block is specified in the round brackets after the declaration. The reference to the desired DALI terminal is defined via this specification. For more information, see Transfer of the reference to the communication block [} 946]. Call the two instances of the function blocks FB_DALI102Recall Max Level [} 91] and FB_DALI102Off [} 88] with the following variables. 916 Version: 1.20.0 TE1000
## Page 917

Programming The input b Start of the function block for switching on a lamp with the maximum output value is linked to the global variable b Switch On. The input b Start of the function block for switching off a lamp is linked to the global variable b Switch Off. Navigate to the task configuration section and configure the Plc Task. By way of example, the task is assigned priority 16 and a cycle time of 6 ms. Create another task for background communication. Give this task a higher priority (lower number) and a lower interval time than the Plc task. TE1000 Version: 1.20.0 917
## Page 918

Programming Add the program for the communication to this task. Further information on task configuration can be found in the description of the function block FB_EL6821Communication [} 614]. I/O configuration Select the CX as target system and initiate a search for its hardware. In the instance (DALI_Sample_EL6821_CX5120 Instance) of the PLC project, you can see that the input and output variables of the PLC program are assigned to the corresponding tasks (Plc Communication and Plc Task). 918 Version: 1.20.0 TE1000
## Page 919

Programming Now link the global variables of PLC program with the inputs and outputs of the bus terminals. Create the Solution and enable the configuration. The lamp with the maximum brightness value is switched on by pressing the first push button. The second push button can be used to switch it off again. 4.4.2 KL6821 with CX5120 This sample explains how to write a simple PLC program for DALI in Twin CAT and how to link it with the hardware. A single lamp is to be controlled and switched to the maximum output value or switched off with a push button. Sample: https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/6011100683.zip The Twin CAT project is available for download as *.zip file. This must first be unpacked locally so that the archive (*.tnzip file) is available for import into the Twin CAT project. Hardware Setting up the components • 1x CX5120 Embedded PC • 1x KL1104 digital 4-channel input terminal (for the switch-on/switch-off function) • 1x KL6821 DALI terminal • 1x KL9010 end terminal Set up the hardware and the DALI components as described in the documentation. This sample assumes that an On button was connected to the first KL1104 input and an Off button to the second. There is a lamp at DALI address 0. Software Creation of the PLC program Create a new Twin CAT XAE Project and a Standard PLC Project. Add the Tc3_DALI library in the PLC project under References. Generate a global variable list with the name GVL_DALI and create the following variables: VAR_GLOBAL b Switch On AT %I* : BOOL; b Switch Off AT %I* : BOOL; st KL6821In Data AT %I* : ST_KL6821In Data; st KL6821Out Data AT %Q* : ST_KL6821Out Data; END_VAR b Switch On: Input variable for the On button. b Switch Off: Input variable for the Off button. st KL6821In Data: Input variable for the DALI terminal (see ST_KL6821In Data [} 903]). st KL6821Out Data: Output variable for the DALI terminal (see ST_KL6821Out Data [} 903]). Create a program (CFC) for the background communication with the DALI terminal. The function block FB_KL6821Communication [} 621] is called in the program. In the communication block ensure that the structures st In Data and st Out Data are linked. TE1000 Version: 1.20.0 919
## Page 920

Programming Create a MAIN program (CFC) in which the FB_DALI102Recall Max Level [} 91] and FB_DALI102Off [} 88] function blocks are declared as follows. PROGRAM MAIN VAR fb102Recall Max Level : FB_DALI102Recall Max Level(Communication.fb KL6821Communication); fb102Off : FB_DALI102Off(Communication.fb KL6821Communication); END_VAR The communication block is specified in the round brackets after the declaration. The reference to the desired DALI terminal is defined via this specification. For more information see: Transfer of the reference to the communication block [} 946]. Call the two instances of the function blocks FB_DALI102Recall Max Level [} 91] and FB_DALI102Off [} 88] with the following variables. The input b Start of the function block for switching on a lamp with the maximum output value is linked to the global variable b Switch On. The input b Start of the function block for switching off a lamp is linked to the global variable b Switch Off. Navigate to the task configuration section and configure the Plc Task. By way of example, the task is assigned priority 16 and a cycle time of 6 ms. 920 Version: 1.20.0 TE1000
## Page 921

Programming Create a further task for the background communication. Assign a higher priority (smaller number) and a lower interval time to this task than the Plc Task. Add the program for the communication to this task. Further information on task configuration can be found in the description of the function block FB_KL6821Communication [} 621]. TE1000 Version: 1.20.0 921
## Page 922

Programming I/O configuration Select the CX as target system and initiate a search for its hardware. In the instance (DALI_Sample_KL6821_CX5120 Instance) of the PLC project, you can see that the input and output variables of the PLC program are assigned to the corresponding tasks (Plc Communication and Plc Task). Now link the global variables of PLC program with the inputs and outputs of the bus terminals. Create the Solution and enable the configuration. The lamp with the maximum brightness value is switched on by pressing the first push button. The second push button can be used to switch it off again. 922 Version: 1.20.0 TE1000
## Page 923

Programming 4.5 Runtime messages TE1000 Version: 1.20.0 923
## Page 924

Programming Value Valu Text ID Description (hex) e (dec) 16#0000 0 No Error No error. 16#0001 1 No Response From The DALITerminal No response from the DALI terminal. 16#0002 2 No Response From The DALIDevice No response from the DALI device. 16#0003 3 Command Buffer Overflow Overflow of the command buffer. 16#0004 4 No Answer From The Communication Block No answer from the communication block. 16#0005 5 DALICollision Detected On The Backward Channel DALI collision detected on the backward channel: during the transfer of a DALI frame, a collision with the send data of another DALI device was detected. 16#0006 6 DALICollision Detected On The Forward Channel DALI collision detected on the forward channel: during the transfer of a DALI frame, a collision with the send data of another DALI control device was detected. The error also occurs if the 24 V supply is missing at the power contacts of the KL6811. 16#0007 7 Overload Of The Internal DALIPower Supply Unit Of The Bus Termin When using the internal DALI power supply unit of al_Bus Under Voltage the bus terminal: overload of the internal DALI power supply unit of the bus terminal (bus undervoltage). 16#0008 8 Power Supply Unit Fault Detected When using the internal DALI power supply unit: Power supply unit fault detected. 16#0009 9 The Process Image Was Disabled By DI1Or DI2 The process image was disabled by the DI1 or DI2 inputs of the terminal. 16#000A 10 Short Circuit Detected On The DALIBus The 24 V DC supply voltage at connections 1 and 5 of the KL6821/EL6821 is missing, or a short circuit has been detected on the DALI bus. 16#000B 11 Collision Error On The DALIBus Due to collisions on the DALI bus, the DALI command could not be sent. 16#000C 12 Item In Receive Buffer Is Invalid The item in the receive buffer of the KL6821/EL6821 is invalid. 16#000D 13 The Interface To The Communication Buffer Is Not Initialized The interface pointer on the communication block is not initialized. 16#000E 14 The Command Buffers Have Been Blocked For Longer Than Permitt The command buffer was blocked for longer than is ed permitted. 16#000F 15 The Terminal Has Returned An Error During Internal Addressing The terminal has returned an error during addressing. 16#0010 16 During Internal Addressing The Terminal Has Detected AShort Circ During addressing the terminal has detected a short uit On The Bus circuit on the bus. 16#0011 17 During Internal Addressing The Terminal Has Detected That There I During addressing the terminal has detected that s No Further Short Address Available there is no free short address available. 16#0012 18 During Internal Addressing The Terminal Has Detected That Severa During addressing the terminal has detected that l Devices Have The Same Long Address several devices have the same long address. 16#0013 19 Internal Addressing Has Failed3Times The addressing failed three times. 16#0014 20 Timeout During Internal Addressing Timeout for addressing. The terminal has not sent a response following the start of addressing. 16#0015 21 No Response From The DALIDevice Instance No response from the instance of the DALI device. 16#0016 22 The KL6811Does Not Support This DALICommand The KL6811 supports only 16-bit commands (IEC 62386-102 and IEC 62386-2xx). 16#0017 23 Error During The Configuration Of The Terminal An error occurred during configuration of the terminal. 16#0018 24 No Response From The DALIDevice2 No response from the DALI device. 16#0019 25 No Free Short Address Available No more free short addresses are available. 16#001A 26 Error During Addressing An error occurred during addressing. 16#001B 27 Invalid Response From The DALIDevice The response from the DALI device is invalid. 16#001C 28 Invalid Response From The DALIDevice Instance Invalid response from the instance of the DALI device. 16#001D 29 This DALICommand Is Not Supported By The Simulation This DALI command is not supported by the simulation. 16#001E 30 Command Buffers Blocked By Mutex Access to the command buffer is not possible due to blocking by the mutex. 16#001F 31 Item In Receive Buffer Error Bit Timing The item in the receive buffer of the KL6821/EL6821 has a bit timing error. 16#0020 32 Item In Receive Buffer Incorrect Number Of Bits The item in the receive buffer of the KL6821/EL6821 has an incorrect number of bits. 16#0021 33 Item In Receive Buffer Encoding Error An error has occurred in the item in the receive buffer of the KL6821/EL6821 during decoding. 924 Version: 1.20.0 TE1000
## Page 925

Programming Value Valu Text ID Description (hex) e (dec) 16#0022 34 During Addressing The Terminal Has Detected Missing Response During addressing, the terminal has detected a missing response from a device. 16#00AC 172 Parameter Command Is Not Valid Parameter n Command is no valid command. 16#00AD 173 Parameter Lux Range Brightness Lies Outside Of The Valid Range Parameter n Lux Range Brightness lies outside of the valid range (0…1). 16#00AE 174 Parameter Alarm Event Priority Lies Outside Of The Valid Range Parameter e Alarm Event Priority lies outside of the valid range (E_DALIEvent Priority. Low... E_DALIEvent Priority. Mi ddle High). 16#00AF 175 Parameter Alarm XHysteresis Part306Lies Outside Of The Valid Ra Parameter n Alarm NHysteresis lies outside of the nge valid range (0...4194303). 16#00B0 176 Parameter Alarm XLevel Part306Lies Outside Of The Valid Range Parameter n Alarm NLevel lies outside of the valid range (0...4194303). 16#00B1 177 Parameter Alarm Report Timer Part306Lies Outside Of The Valid Ra Parameter n Alarm Report Timer lies outside of the nge valid range (0...1275 s). 16#00B2 178 Parameter Report Timer Part306Lies Outside Of The Valid Range Parameter n Report Timer lies outside of the valid range (0...1275 s). 16#00B3 179 Parameter Alarm Level Lies Outside Of The Valid Range Parameter n Alarm Level lies outside of the valid range (0...4194303). 16#00B4 180 Parameter Alarm Hysteresis Lies Outside Of The Valid Range Parameter n Alarm Hysteresis lies outside of the valid range (0...4194303). 16#00B5 181 Writing To The Offset Of The Memory Bank Was Not Successful Writing to the offset of a memory bank of a DALI device was not successful. 16#00B6 182 Parameter Colour Type Lies Outside Of The Valid Range Parameter e Colour Type [} 904] lies outside of the valid range (E_DALIColour Type. Xy Coordinate... E_DALIColour T ype. RGBWAFControl). 16#00B7 183 Parameter Emergency Level Lies Outside Of The Valid Range Parameter n Emergency Level lies outside of the valid range (emergency Min Level...emergency Max Level, 255). 16#00B8 184 Parameter Duration Test Interval Lies Outside Of The Valid Range Parameter n Duration Test Interval lies outside of the valid range (0...97). 16#00B9 185 Parameter Sensitivity Occupancy Partial3Part303Lies Outside Of Parameter n Sensitivity N lies outside of the valid The Valid Range range (1…100). 16#00BA 186 Parameter Sensitivity Occupancy Partial2Part303Lies Outside Of Parameter n Sensitivity N lies outside of the valid The Valid Range range (0…4). 16#00BB 187 Parameter Extended Fade Time Base Lies Outside Of The Valid Ran Parameter e Extended Fade Time Base lies outside of ge the valid range (E_DALIExtended Fade Time Base. Base01... E_DALI Extended Fade Time Base. Base16). 16#00BC 188 Parameter Extended Fade Time Multiplier Lies Outside Of The Valid Parameter e Extended Fade Time Multiplier is out of Range valid range (E_DALIExtended Fade Time Multiplier. Disabled... E_ DALIExtended Fade Time Multiplier. Multiplier1min). 16#00BD 189 Parameter Deadtime Lies Outside Of The Valid Range Parameter t Deadtime lies outside of the valid range (2...3600 s). 16#00BE 190 Parameter Hysteresis Lies Outside Of The Valid Range2 Parameter n Hysteresis lies outside of the valid range (0...25 %). 16#00BF 191 Parameter Deadtime Timer Lies Outside Of The Valid Range Parameter n Deadtime Timer lies outside of the valid range (0...12750 ms). 16#00C0 192 Parameter Hold Timer Lies Outside Of The Valid Range Parameter n Hold Timer lies outside of the valid range (1...2538 ms). 16#00C1 193 Parameter Stuck Timer Lies Outside Of The Valid Range Parameter n Stuck Timer lies outside of the valid range (5...255 s). 16#00C2 194 Parameter Short Lies Outside Of The Valid Range Parameter n Short lies outside of the valid range (t Short Min [} 536]...255). 16#00C3 195 Parameter Short Timer Part301Lies Outside Of The Valid Range Parameter n Short Timer N lies outside of the valid range (t Short Min [} 536]...5100 ms). 16#00C4 196 Parameter Short Timer Lies Outside Of The Valid Range Parameter n Short Timer lies outside of the valid range (t Short Min [} 536]...5100 ms). 16#00C5 197 Parameter Double Timer Part301Lies Outside Of The Valid Range Parameter n Double Timer N lies outside of the valid range (0, t Double Min [} 537]...2000 ms). 16#00C6 198 Parameter Double Timer Lies Outside Of The Valid Range Parameter n Double Timer lies outside of the valid range (0, t Double Min [} 537]...2000 ms). TE1000 Version: 1.20.0 925
## Page 926

Programming Value Valu Text ID Description (hex) e (dec) 16#00C7 199 Parameter Repeat Timer Lies Outside Of The Valid Range Parameter n Repeat Timer lies outside of the valid range (100...2000 ms). 16#00C8 200 Parameter Event Scheme Lies Outside Of The Valid Range Parameter e Event Scheme lies outside of the valid range (see E_DALIEvent Scheme [} 908]). 16#00C9 201 Parameter Address Is AGroup Address And Lies Outside Of The Vali Parameter n Address is a group address and lies d Range2 outside of the valid range (0...31). 16#00CA 202 Parameter Event Priority Device Lies Outside Of The Valid Range Parameter e Event Priority N lies outside of the valid range (E_DALIEvent Priority. Low... E_DALIEvent Priority. Mi ddle High). 16#00CB 203 Parameter ALSCorrection Factor Part304Lies Outside Of The Valid Parameter n ALSx Correction Factor N lies outside of Range the valid range (0.1...5.0). 16#00CC 204 Parameter Room Correction Factor Part304Lies Outside Of The Val Parameter n Room Correction Factor N lies outside of id Range the valid range (5...200). 16#00CD 205 Parameter Switch On Level Lies Outside Of The Valid Range Parameter n Switch On Level lies outside of the valid range (min Level...max Level [} 155]). 16#00CE 206 Parameter Hysteresis Part304Lies Outside Of The Valid Range Parameter n Hysteresis N lies outside of the valid range (0...25 %). 16#00CF 207 Parameter Deadtime Timer Part304Lies Outside Of The Valid Rang Parameter n Deadtime Timer N lies outside of the e valid range (0...12750 ms). 16#00D0 208 Parameter Sensitivity Occupancy Partial Part303Lies Outside Of T Parameter n Sensitivity N lies outside of the valid he Valid Range range (1…5). 16#00D1 209 Parameter Sensitivity Occupancy Percent Part303Lies Outside Of Parameter n Sensitivity N lies outside of the valid The Valid Range range (0...100 %). 16#00D2 210 Parameter Detection Range Occupancy Part303Lies Outside Of Th Parameter n Detection Range N lies outside of the e Valid Range valid range (0...100 %). 16#00D3 211 Parameter Hold Timer Part303Lies Outside Of The Valid Range Parameter n Hold Timer N lies outside of the valid range (1...2538 ms). 16#00D4 212 Parameter Deadtime Timer Part303Lies Outside Of The Valid Rang Parameter n Deadtime Timer N lies outside of the e valid range (0...12750 ms). 16#00D5 213 Parameter Hysteresis Lies Outside Of The Valid Range3 Parameter n Hysteresis lies outside of the valid range (1...65535). 16#00D6 214 Parameter Deadtime Timer Part302Lies Outside Of The Valid Rang Parameter n Deadtime Timer N lies outside of the e valid range (0...12750 ms). 16#00D7 215 Parameter Stuck Timer Part301Lies Outside Of The Valid Range Parameter n Stuck Timer N lies outside of the valid range (5...255 ms). 16#00D8 216 Parameter Repeat Timer Part301Lies Outside Of The Valid Range Parameter n Repeat Timer N lies outside of the valid range (100...2000 ms). 16#00D9 217 Parameter Up Switch Off Threshold Lies Outside Of The Valid Range Parameter n Up Switch Off Threshold lies outside of the valid range (1...255). 16#00DA 218 Parameter Up Switch On Threshold Lies Outside Of The Valid Range Parameter n Up Switch On Threshold lies outside of the valid range (1...255). 16#00DB 219 Parameter Level Memory Mode Lies Outside Of The Valid Range Parameter n Level Memory Mode lies outside of the valid range (1…254). 16#00DC 220 Parameter Min Level Is Greater Than Max Level Parameter n Min Level is greater than n Max Level. 16#00DD 221 Parameter Reference Device Address Lies Outside Of The Valid Ra Parameter n Reference Device Address lies outside of nge the valid range (0...63). 16#00DE 222 Error During Reading Offset From Memory Bank An error occurred while reading an offset from the memory bank. 16#00DF 223 Parameter Sub Range Start Lies Outside Of The Valid Range Parameter n Sub Range Start lies outside of the valid range. 16#00E0 224 Error Reading Memory Bank DTR0Is Wrong An error occurred while reading out a memory bank. The value of DTR0 is not as expected. 16#00E1 225 Parameter Sub Range End Lies Outside Of The Valid Range Parameter n Sub Range End lies outside of the valid range. 16#00E2 226 Read Command Returned TMASK The DALI device returns TMASK. The value is not currently available. 16#00E3 227 Read Command Returned MASK The DALI device returns MASK. The value is not available. 16#00E4 228 Parameter Internal Control Gear Reference Temperature Lies Outs Parameter ide Of The Valid Range n Internal Control Gear Reference Temperature lies outside of the valid range (-60…193 °C). 16#00E5 229 Parameter Light Source On Time Resettable Lies Outside Of The Val Parameter n Light Source On Time Resettable lies id Range outside of the valid range (0…4294967293 s). 926 Version: 1.20.0 TE1000
## Page 927

Programming Value Valu Text ID Description (hex) e (dec) 16#00E6 230 Parameter Light Source Start Counter Resettable Lies Outside Of T Parameter n Light Source Start Counter Resettable lies he Valid Range outside of the valid range (0…16777213). 16#00E7 231 Parameter Rated Median Useful Life Of Luminaire Lies Outside Of T Parameter n Rated Median Useful Life Of Luminaire lies he Valid Range outside of the valid range (0…253). 16#00E8 232 Parameter Rated Median Useful Light Source Starts Lies Outside Of Parameter n Rated Median Useful Light Source Starts The Valid Range lies outside of the valid range (0…65533) 16#00E9 233 Parameter Instance Number Lies Outside Of The Valid Range Parameter n Instance Number lies outside of the valid range (0…31). 16#00EA 234 Parameter Short Address Lies Outside Of The Valid Range2 Parameter n Short Address lies outside of the valid range (0…63). 16#00EB 235 Parameter Sub Range End Is Less Than Sub Range Start Parameter n Sub Range End is smaller than n Sub Range Start. 16#00EC 236 Parameter Fast Fade Time Lies Outside Of The Valid Range Parameter e Fast Fade Time is out of valid range (E_DALIFast Fade Time. Disabled... E_DALIFast Fade Time. T700ms). 16#00ED 237 Parameter Dimming Curve Lies Outside Of The Valid Range Parameter e Dimming Curve lies outside of the valid range (see E_DALIDimming Curve [} 908]). 16#00EE 238 Parameter Event Priority Lies Outside Of The Valid Range Parameter e Event Priority lies outside of the valid range (E_DALIEvent Priority. Low... E_DALIEvent Priority. Mi ddle High). 16#00EF 239 Parameter Short Address Lies Outside Of The Valid Range Parameter n Short Address lies outside of the valid range (0…63, 255). 16#00F0 240 Parameter Address Info Instance Group Lies Outside Of The Valid R Parameter n Address Info1/n Address Info2 defines an ange instance group and lies outside of the valid range (0…31). 16#00F1 241 Parameter Address Info Device Group Lies Outside Of The Valid Ra Parameter n Address Info1/n Address Info2 defines a nge device group and lies outside of the valid range (0… 31). 16#00F2 242 Parameter Address Info Short Address Lies Outside Of The Valid Ra Parameter n Address Info1/n Address Info2 defines a nge short address and lies outside of the valid range (0…63). 16#00F3 243 Parameter Address Info Instance Number Lies Outside Of The Valid Parameter n Address Info1/n Address Info2 defines an Range instance number and lies outside of the valid range (0…31). 16#00F4 244 Parameter Address Info Instance Type Lies Outside Of The Valid Ra Parameter n Address Info1/n Address Info2 defines an nge instance type and lies outside of the valid range (0… 31). 16#00F5 245 Parameter Hysteresis Lies Outside Of The Valid Range Parameter n Hysteresis lies outside of the valid range (0...25). 16#00F6 246 Parameter Hold Lies Outside Of The Valid Range Parameter n Hold lies outside of the valid range (0… 254). 16#00F7 247 Parameter Double Lies Outside Of The Valid Range Parameter n Double lies outside of the valid range (0, t Double Min [} 537]…100). 16#00F8 248 Parameter Repeat Lies Outside Of The Valid Range Parameter n Repeat lies outside of the valid range (5…100). 16#00F9 249 Parameter Stuck Lies Outside Of The Valid Range Parameter n Stuck lies outside of the valid range (5…255). 16#00FA 250 Parameter Resolution Lies Outside Of The Valid Range Parameter n Resolution lies outside of the valid range (1…64). 16#00FB 251 Parameter Event Filter Lies Outside Of The Valid Range Parameter n Event Filter lies outside of the valid range (16#00_0000…16#FF_FFFF). 16#00FC 252 Parameter Change Address List Is Empty Parameter a Change Address List is empty. 16#00FD 253 Parameter Change Address List Contains An Invalid Short Address Parameter a Change Address List contains an invalid Entry short address entry. 16#00FE 254 Parameter Change Address List Contains ADouble List Entry In The Parameter a Change Address List contains a double Short Addresses list entry in the short addresses. 16#00FF 255 Parameter Change Address List Contains An Entry For ANew Short Parameter a Change Address List contains an entry Address Which Is Already Assigned for a new short address which is already assigned to a device that is not affected by changes. The addresses have been changed back. 16#0100 256 Parameter Max Response Table Entries Lies Outside Of The Valid R Parameter c Max Response Table Entries lies outside ange of the valid range (2…250). 16#0101 257 Parameter Max Event Table Entries Lies Outside Of The Valid Rang Parameter c Max Event Table Entries lies outside of e the valid range (2…250). TE1000 Version: 1.20.0 927
## Page 928

Programming Value Valu Text ID Description (hex) e (dec) 16#0102 258 Parameter Timeout Transaction Lies Outside Of The Valid Range Parameter c Timeout Transaction lies outside of the valid range (2…120 s). 16#0103 259 Parameter Max Command Buffer Entries Lies Outside Of The Valid Parameter c Max Command Buffer Entries lies outside Range of the valid range (2…250). 16#0104 260 Parameter Data Frame Type Lies Outside The Valid Range Parameter e Data Frame Type lies outside of the valid range (see E_DALIData Frame Type [} 906]). 16#0105 261 Parameter Address Type Lies Outside Of The Valid Range Parameter e Address Type lies outside of the valid range (see E_DALIAddress Type [} 903]). 16#0106 262 Parameter Address Is AShort Address And Lies Outside Of The Valid Parameter n Address is a short address and lies Range outside of the valid range (0...63). 16#0107 263 Parameter Address Is AGroup Address And Lies Outside Of The Vali Parameter n Address is a group address and lies d Range outside of the valid range (0…15). 16#0108 264 Parameter Command Priority Lies Outside Of The Valid Range Parameter e Command Priority lies outside the valid range (E_DALICommand Priority. Low... E_DALICommand P riority. High). 16#0109 265 Parameter Instance Address Type Lies Outside The Valid Range Parameter e Instance Address Type lies outside of the valid range (see E_DALIInstance Address Type [} 911]). 16#010A 266 Parameter Instance Address Is AInstance Number And Lies Outsid Parameter n Instance Address is an instance number e Of The Valid Range and lies outside of the valid range (0…31). 16#010B 267 Parameter Instance Address Is AInstance Group And Lies Outside Parameter n Instance Address is an instance group Of The Valid Range and lies outside of the valid range (0…31). 16#010C 268 Parameter Instance Address Is AInstance Type And Lies Outside Of Parameter n Instance Address is an instance type The Valid Range and lies outside of the valid range (0…31). 16#010D 269 Parameter Instance Address Is AFeature On Instance Number Leve Parameter n Instance Address is a feature on l And Lies Outside Of The Valid Range instance number level and lies outside of the valid range (0…31). 16#010E 270 Parameter Instance Address Is AFeature On Instance Group Level Parameter n Instance Address is a feature on And Lies Outside Of The Valid Range instance group level and lies outside of the valid range (0…31). 16#010F 271 Parameter Instance Address Is AFeature On Instance Type Level A Parameter n Instance Address is a feature on nd Lies Outside Of The Valid Range instance type level and lies outside the valid range (0…31). 16#0110 272 Parameter Group Lies Outside Of The Valid Range Parameter n Group lies outside of the valid range (0…15). 16#0111 273 Parameter Scene Lies Outside Of The Valid Range Parameter n Scene lies outside of the valid range (0…15). 16#0112 274 Parameter Fade Time Lies Outside Of The Valid Range Parameter e Fade Time is out of valid range (E_DALIFade Time. Disabled... E_DALIFade Time. T90 500ms). 16#0113 275 Parameter Fade Rate Lies Outside Of The Valid Range Parameter e Fade Rate is out of valid range (E_DALIFade Rate. N003Steps Per Sec... E_DALIFade Rate. N358Steps Per Sec). 16#0114 276 Parameter New Short Address Lies Outside Of The Valid Range Parameter n New Short Address lies outside of the valid range (0…63, 255). 16#0115 277 Parameter Start With Short Address Lies Outside Of The Valid Rang Parameter n Start With Short Address lies outside of e the valid range (0…63). 928 Version: 1.20.0 TE1000
## Page 929

Appendix 5 Appendix 5.1 Commissioning and diagnosis 5.1.1 Commissioning KL6821 The KS2000 provides dialogs for commissioning and diagnosis of DALI devices on the KL6821. The dialogs offer not only functions for addressing DALI control gears and DALI control devices, but also for writing and reading parameters. The search function automatically detects the DALI device types and displays them in a tree structure. All parameters of the KL6821 can also be set via the KS2000. This makes it possible, for example, to define the DALI commands that are sent when the digital inputs on the KL6821 are actuated. TE1000 Version: 1.20.0 929
## Page 930

Appendix Overview of the most important functions in the KS2000 for the KL6821: • Find DALI devices • Addressing the DALI devices, including adapting the short addresses • Scene and group assignment of the DALI control gears • Configuration of the DALI control gears, including the parameters for the different device types • Configuration of the DALI control gears, including the parameters for the different sensor types • Writing/reading of the memory banks • Definition of DALI commands for DI1 and DI2 (separate for rising and falling edge) • Definition of the DALI command for the K-bus watchdog (K-bus failure) • Switching the internal DALI power supply unit on/off • Activation/deactivation of the blocking of the process image for the PLC as soon as a DALI command is sent by actuating a digital input on the KL6821. 5.1.2 Commissioning EL6821 From Twin CAT 3.1.4024.57, dialogs are available for the commissioning and diagnosis of DALI devices on the EL6821. The dialogs offer not only functions for addressing DALI control gears and DALI control devices, but also for writing and reading parameters. The search function automatically detects the DALI device types and displays them in a tree structure. 930 Version: 1.20.0 TE1000
## Page 931

Appendix Furthermore, all parameters of the EL6821 can be set via Twin CAT XAE. This makes it possible, for example, to define the DALI commands that are sent when the digital inputs on the EL6821 are actuated. Overview of the most important functions in the Twin CAT XAE for the EL6821: • Find DALI devices • Addressing the DALI devices, including adapting the short addresses • Scene and group assignment of the DALI control gears • Configuration of the DALI control gears, including the parameters for the different device types • Configuration of the DALI control devices, including the parameters for the different sensor types • Writing/reading of the memory banks • Definition of DALI commands for DI1 and DI2 (separate for rising and falling edge) TE1000 Version: 1.20.0 931
## Page 932

Appendix • Definition of the DALI command for the E-bus watchdog (E-bus failure) • Switching the DALI power supply unit on/off • Activation/deactivation of the blocking of the process image for the PLC as soon as a DALI command is sent by actuating a digital input on the EL6821. 5.1.3 DALI PLC Commissioning Tool The DALI PLC Commissioning Tool PLC project offers the user the option of configuring DALI devices and up to 36 KL6811/KL6821/EL6821 with the aid of the Twin CAT PLC HMI (see https://infosys.beckhoff.com/ content/1033/Tc Plc Lib_Tc3_DALI/Resources/13219898251.zip). The Twin CAT project is available for download as *.zip file. This must first be unpacked locally so that the archive (*.tnzip file) is available for import into the Twin CAT project. This project can be extended for specific applications, or it can only be used for configuration purposes. It initially supports 36 KL6811/KL6821/EL6821 via the n Max Number Of DALI_Lines global variable, but can be reduced or supplemented with additional lines by the user. Linking of process data As an array with the number of n Max Number Of DALI_Lines is created for each potential terminal, it is important to ensure that the mapping of the terminals in the data array matches the hardware arrangement of the terminals when the hardware is linked. 932 Version: 1.20.0 TE1000
## Page 933

Appendix Application The basic setting is the result of the options in the Choose Terminal Type screen. The dialogs offer not only functions for addressing DALI control gears and DALI control devices, but also for writing and reading parameters. Using the drop-down menu, the user first selects how many DALI terminals are present in the project and which types they are. To ensure clarity in the project, the n Max Number Of DALI_Lines global variable should be reduced to the actual number of DALI lines present in the project. TE1000 Version: 1.20.0 933
## Page 934

Appendix In the other lines of the drop-down menu, select whether DALI control gears or DALI control devices are to be parameterized. 934 Version: 1.20.0 TE1000
## Page 935

Appendix Addressing of the DALI devices and querying of the addresses that are already assigned is performed in the Addressing tab, which is available for both control gears and control devices. Parameters can be read based on selected short addresses and can be written, as far as possible. TE1000 Version: 1.20.0 935
## Page 936

Appendix There are also dialogs for • Executing DALI commands • Reading current states • Reading and configuring group allocations • Reading and configuring assignments within scenes • Reading and writing the configuration of DALI control gears: ◦ Device type 1 (Emergency lighting devices, Part 202) can be read out manually. ◦ Device type 4 (Regulation of supply voltage of incandescent lamps, Part 205) can be read out manually. ◦ Device type 6 (LED modules, Part 207) can be read out manually. ◦ Device type 7 (Switching functions, Part 208) can be read out manually. • Reading and writing the configuration of DALI control devices: ◦ Instance type 0 (Generic inputs, Part 103) can be read out manually. ◦ Instance type 1 (Push button, Part 301) can be read out manually and event-driven. ◦ Instance type 2 (Absolute value, Part 302) can be read out manually. ◦ Instance type 3 (Occupancy sensor, Part 303) can be read out manually and event-driven. ◦ Instance type 4 (Light sensor, Part 304) can be read out manually. For this purpose, one page is available for reading the configuration and one for writing. • Adjustment of the fading settings • Reading and, if the vendor wishes, configuration of the memory banks. • Memory bank 1 for the control gears (part 102) contains the extension (device type 50). • The device type 51 (Energy report) is available by querying the memory banks 202, 203 and 204. 936 Version: 1.20.0 TE1000
## Page 937

Appendix • The device type 52 (Diagnostics and maintenance) is available by querying the memory banks 205, 206 and 207. • Configuration of the KL6821/EL6821 (switching the power supply unit on/off, behavior on triggering of the K-bus or E-bus watchdog, behavior in the event of rising or falling edges on the two digital inputs of the terminal, enablement of the process image after the inputs have been actuated, deactivation of the blocking of the process image when using the digital inputs of the KL6821/EL6821). As the KL6811 does not support the DALI-2 standard, dialogs that are not available are hidden as follows. Requirements Required PLC library DALI PLC Commissioning Tool Tc3_DALI from v3.22.0.0 Tc3_DALI_PLC_Commissioning_Tool v3.9.0.0 5.1.4 Event Logger The Tc3_DALI library supports the Twin CAT Event Logger for the output of messages. This means that errors are displayed to the developer during runtime without having to explicitly extend the program for this purpose. The output of the messages can be influenced by a variable. It is located in the Tc3_DALI library as a global variable: e Event Trace Level : Tc Event Severity := Tc Event Severity. Critical; Each message is assigned to a level that indicates how serious it is. The levels Info, Warning, Error or Critical are available. The global variable e Event Trace Level defines the level from which a message is displayed in the message window. By default, the variable is initialized so that only messages that correspond to the Critical level are output. Since most messages of the Tc3_DALI library are assigned to the Error level, these messages are not displayed. The Critical level is rated more serious than the Error level. The output of messages via the Twin CAT Event Logger may only be active for a limited time, e.g. during troubleshooting or commissioning. PLC The following instruction, which you can insert into your PLC program, outputs all messages of all function blocks from the Tc3_DALI library. This is particularly helpful during development or commissioning. TE1000 Version: 1.20.0 937
## Page 938

Appendix Tc3_DALI. GVL.e Event Trace Level := Tc Event Severity. Verbose; Watch List In addition to the extension of the PLC program, you can create a watch list in which the global variable e Event Trace Level can be changed. 1. Create the watch list. 2. Select the global variable e Event Trace Level. The default setting of the variable can be seen in the documentation area of the input assistant. ð After adding the variable to the watch list you can change its value via a drop-down menu. 938 Version: 1.20.0 TE1000
## Page 939

Appendix Displaying the messages The messages are displayed in the Twin CAT Logged Events window (see chapter Event Logger). All messages are stored in a ring buffer in the Twin CAT controller. The size of the ring buffer can be adapted in the Twin CAT options. This has the advantage that messages are saved even if the Twin CAT project is not open in Visual Studio. In addition, the messages can also be displayed in the Output window. Make sure that Show output from is set to Twin CAT. 5.1.5 Error evaluation The interface pointer ip Result Message of type I_Tc Message provides information about a current event (runtime message [} 923]). The most important methods and properties are described below: TE1000 Version: 1.20.0 939
## Page 940

Appendix Methods Name Description Equals To Event Entry Ex Compares the event definition of the event with another event definition. Request Event Text Returns the text for the event. Properties Name Type Description e Severity Tc Event Severity Returns the severity. Event Class GUID Returns the unique ID of the event class. n Event Id UDINT Returns the ID of the event. st Event Entry Tc Event Entry Returns the event definition. For details about the interface I_TCMessage, see the documentation for the Tc3_Event Logger library. Each event is unambiguously described by the structure Tc Event Entry. It contains three structure elements: • Event-Class • Event-ID • Event-Severity Several events are merged into one event class. For example, the event class for DALI and the event class for En Ocean® can contain the event ID 100. The complete description of an event always consists of the event class and the event ID. This avoids ambiguities due to the same IDs within different libraries. In order to make the events accessible to the PLC, Twin CAT automatically creates a structure for each event class in the type system. This happens for all PLC libraries that are referenced in the project. The structure ST_DALIEvent Class is added using the Tc3_DALI library. 940 Version: 1.20.0 TE1000
## Page 941

Appendix This structure contains all events of the event class for the Tc3_DALI library. Each element of the structure is mapped by a variable of type Tc Event Entry. The name of the element indicates the meaning of the event. TYPE ST_Tc DALIEvent Class: STRUCT No Response From DALITerminal: Tc Event Entry := ( … No Response From DALIDevice: Tc Event Entry := ( … Command Buffer Overflow: Tc Event Entry := ( … […] END_STRUCT END_TYPE All event classes are stored in the global variable list TC_Events, which is also generated automatically by Twin CAT. VAR_GLOBAL CONSTANT […] Tc RTime Event Class: ST_Tc RTime Event Class; Win32Event Class: ST_Win32Event Class; Tc DALIEvent Class: ST_Tc DALIEvent Class; END_VAR Thus all messages of all event classes are available in the PLC program. FAQ How can I query whether an FB returns an error? In all libraries, the event ID for error-free execution is set to 0. Since the event ID not only outputs errors, but also notes and warnings, most function blocks have the output b Error. This output is TRUE when an error occurs. IF (fb DALI.b Error) THEN … END_IF This output remains FALSE in the event of warnings or notes. Therefore it may be the case that the event ID (fb DALI.ip Result Message.n Event ID) is not 0, but b Error remains FALSE. TE1000 Version: 1.20.0 941
## Page 942

Appendix How can I query whether a FB returns a specific event? The method ip Result Message. Equals To Event Entry Ex(st Other Tc Event Entry) compares whether the event matches the transferred event st Other. Since a variable of type Tc Event Entry automatically exists for each event, the query for a certain event can be carried out as follows. IF (fb DALI.ip Result Message. Equals To Event Entry Ex( TC_EVENTS. Tc DALIEvent Class. No Response From The DALIDevice)) THEN … END_IF Alternatively, the Event ID can also be queried directly. IF (fb DALI.ip Result Message.n Event Id = 2) THEN … END_IF A structure of the data type Tc Event Entry exists for each event. This is located inside the structure Tc DALIEvent Class (data type ST_Tc DALIEvent Class). The meaning of the message is recognizable from the names of the individual events. The use of this structure can thus improve the readability of the PLC program: IF (fb DALI.ip Result Message.n Event Id = TC_EVENTS. Tc DALIEvent Class. No Response From The DALIDevice.n Event Id) then … END_IF For a list of all events that represent an error, see Runtime messages [} 923]. How can I query the text of an event? The text that is output in the Twin CAT Logged Events window can also be queried in the PLC program using the method ip Result Message. Request Event Text(n Lang Id DINT, s Result REFERENCE TO STRING, n Result Size UDINT) . If an event is present, the following sample returns the event text: s Txt : STRING(255); s Event Text : STRING(255); IF (fb DALI.ip Result Message. Request Event Text(1031, s Txt, SIZEOF(s Txt))) THEN UTF8_TO_STRING(ADR(s Event Text), ADR(s Txt), SIZEOF(s Txt)); END_IF The first parameter specifies the language in which the text is to be read. The Tc3_DALI library contains all texts in English (1033) and German (1031). 5.1.6 Communication Monitor The Twin CAT 3 Extension Twin CAT Communication Monitor contains a diagnostic window in which the DALI commands sent and the DALI events of the Tc3_DALI library are displayed. The Twin CAT Communication Monitor has been developed exclusively for use with Visual Studio 2017. Installation with Twin CAT XAE (TCXae Shell) If you use the Twin CAT XAE Shell, perform the following steps to install the Twin CAT Communication Monitor: 1. For a 32-bit operating system, the Twin CAT Communication Monitor folder must be created under: C:\Program Files\Beckhoff\Tc Xae Shell\Common7\IDE\Extensions\Beckhoff Automation Gmb H. 2. For a 64-bit operating system, the folder must be created under: C:\Program Files (x86)\Beckhoff\Tc Xae Shell\Common7\IDE\Extensions\Beckhoff Automation Gmb H. 942 Version: 1.20.0 TE1000
## Page 943

Appendix 3. Download the Twin CAT Communication Monitor from the following link and save the *.vsix file that it contains locally: https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/9260769675.zip 4. Rename the *.vsix file to a *.zip file. 5. Copy the contents of the previously renamed file to the newly created folder. 6. Check that the following security settings are set correctly for all files: 7. Restart Twin CAT XAE (Tc Xae Shell). ð The installation is now completed. Installation with Visual Studio Download the Twin CAT Communication Monitor from the following link and save the *.vsix file that it contains locally: https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/9260769675.zip The Twin CAT Communication Monitor is installed by double-clicking the Tc Communication Monitor VSIX_V1.1.0.0.vsix file. Start the DALI Twin CAT Communication Monitor After the Twin CAT Communication Monitor has been installed, the DALI Monitor entry is available under the Twin CAT menu item. TE1000 Version: 1.20.0 943
## Page 944

Appendix After starting the DALI Monitor, select the instance of the desired communication block (FB_KL6811Communication [} 618],or FB_KL6821Communication [} 621] ). All frames sent by the respective instance are then displayed in the DALI Monitor. In addition to the timestamp, address, DALI command and command priority, the instance path is also displayed. This indicates from where within the PLC program the DALI command was sent. To display the frames, it is not necessary that the corresponding Twin CAT project has been loaded. Since the data exchange between the PLC program and the DALI Monitor was realized via ADS, it is sufficient if the Twin CAT router was correctly configured. 5.2 Use of properties Properties have the advantage that they enable read and write access. Thus, parameters can be passed to a function block via properties, i.e. states of the function block can also be output. The Tc3_DALI uses properties mainly to pass parameters to function blocks. Each property has a documented initial value. Thus, it is not necessary to assign a value to each property. Assignment at runtime The following sample shows how values are passed to properties at runtime in ST and CFC. fb DALI102Dimmer1Switch : FB_DALI102Dimmer1Switch(Communication.fb KL6821Communication); In ST, the assignment of properties is done separately from the instance call. fb DALI102Dimmer1Switch.n Max Level := 250; fb DALI102Dimmer1Switch.n Min Level := 130; fb DALI102Dimmer1Switch(); The assignment of the properties is done in CFC by input and output elements and also independent of the instance call. 944 Version: 1.20.0 TE1000
## Page 945

Appendix Assignment during declaration Properties can also be given a value directly when a function block is declared. fb DALI102Dimmer1Switch : FB_DALI102Dimmer1Switch(Communication.fb KL6821Communication) := (n Max Level := 250, n Min Level := 130); The values are assigned to the properties before the first PLC cycle. Use of arrays If an array is declared by a function block, the properties for each element of the array can be given different values. a DALI102Dimmer1Switch : ARRAY [1..3] OF FB_DALI102Dimmer1Switch(Communication.fb KL6821Communication) := [(n Max Level := 250, n Min Level := 130), // Element 1 (n Max Level := 240, n Min Level := 130), // Element 2 (n Max Level := 254, n Min Level := 125)]; // Element 3 In the following sample, the two properties n Max Level and n Min Level of element 1 and 2 are given individual values. The properties of element 3 remain unchanged and retain their initial values. a DALI102Dimmer1Switch : ARRAY [1..3] OF FB_DALI102Dimmer1Switch(Communication.fb KL6821Communication) := [(n Max Level := 250, n Min Level := 130), // Element 1 (n Max Level := 240, n Min Level := 130)]; // Element 2 The short form for multiple initialization can also be used. a DALI102Dimmer1Switch : ARRAY [1..5] OF FB_DALI102Dimmer1Switch(Communication.fb KL6821Communication) := [2((n Max Level := 250, n Min Level := 130)), // Element 1 and 2 (n Max Level := 254, n Min Level := 125), // Element 3 2((n Max Level := 240, n Min Level := 140))]; // Element 4 and 5 TE1000 Version: 1.20.0 945
## Page 946

Appendix 5.3 Transfer of the reference to the communication block The individual function blocks of the Tc3_DALI send and receive the DALI data packets via the respective DALI terminal (KL6811, KL6821 or EL6821). The function blocks access the DALI terminal via a special communication block (FB_KL6811Communication [} 618], FB_KL6821Communication [} 621] or FB_EL6821Communication [} 614]). Each instance of a communication block is assigned to exactly one DALI terminal. The communication blocks ensure that the processing of the individual DALI commands is carried out correctly and that the received events are assigned to the correct function blocks. Each function block requires a reference to a communication block. This assignment is implemented in the Tc3_DALI with an interface pointer. There are two ways to pass the assignment of the communication block to a function block. Transfer during declaration When declaring the function block, the complete path of the instance of the communication block (FB_KL6811Communication, FB_KL6821Communication or FB_EL6821Communication) is specified in round brackets. fb DALI102Off : FB_DALI102Off(Communication.fb KL6821Communication); The complete path consists of the POU name in which the instance of the communication block was created (Communication) and the name of the instance (fb KL6821Communication), separated by a dot. A NULL reference can also be passed in the declaration. fb DALI102Off : FB_DALI102Off(NULL); This can be useful if an assignment is to be made only at program runtime (see below). If a module does not have a valid interface pointer to a communication block, a runtime message [} 923] is output. If the interface pointer is changed in the declaration, this is not taken into account during an Online Change. In this case, the PLC program must be completely recompiled and loaded onto the target system. Use of arrays Each instance can be assigned to an individual communication block. The instances of the communication blocks can also map different types of DALI terminals (KL6811, KL6821 or EL6821). a DALI102Off : ARRAY[1..3] OF FB_DALI102Off[(Communication.fb KL6821Communication), (Communication.fb EL6821Communication), (Communication.fb KL6811Communication)]; In the following sample, all instances are assigned to the same communication block: a DALI102Off : ARRAY[1..3] OF FB_DALI102Off(Communication.fb KL6821Communication); Transfer by property So that the reference to the communication block can also be changed at runtime, all function blocks have the property ip DALICommunication. This property can also be used to pass the interface pointer. fb DALI102Off.ip DALICommunication := Communication.fb KL6821Communication01; The assignment does not have to take place in every PLC cycle. It is sufficient if this is done once. IF (b Switch To Linie01) THEN fb DALI102Off.ip DALICommunication := Communication.fb KL6821Communication01; b Switch To Linie01 := FALSE; END_IF IF (b Switch To Linie02) THEN fb DALI102Off.ip DALICommunication := Communication.fb KL6821Communication02; b Switch To Linie02 := FALSE; END_IF 946 Version: 1.20.0 TE1000
## Page 947

Appendix For additional information on properties, see the chapter Use op properties [} 944]. 5.4 Tc2_DALI and Tc3_DALI in the same project The Tc2_DALI library can be used for porting existing Twin CAT 2 projects to Twin CAT 3. At source code level, the Twin CAT 2 DALI library is compatible with the Twin CAT 3 Tc2_DALI library, which significantly simplifies the transfer of Twin CAT 2 projects to Twin CAT 3. In contrast, the Twin CAT 3 library Tc3_DALI is a completely new development, which has been optimized for Twin CAT 3 and adapted to DALI-2. In this way it was possible to improve the performance and to simplify handling of the function blocks further. For new projects the Tc3_DALI library should therefore be used if possible. This can lead to a situation where the Tc2_DALI library is used in a Twin CAT 3 project, this project is subsequently extended and the Tc3_DALI library is to be used for this purpose. The following section illustrates how a KL6821 with the Tc2_DALI library and a further KL6821 with the Tc3_DALI library are operated in a Twin CAT 3 project. The function blocks of the Tc2_DALI and Tc3_DALI libraries cannot be mixed on the same Bus Terminal. Each library must have exclusive access to a KL6821 or KL6811. Add both libraries to the Twin CAT 3 project: The necessary variables must be created for each terminal and linked with the KL6821. In this example, the global variable list has the name GVL. VAR_GLOBAL // Tc2_DALI st KL6821In Data Tc2 AT %I* : Tc2_DALI. ST_KL6821In Data; st KL6821Out Data Tc2 AT %Q* : Tc2_DALI. ST_KL6821Out Data; st Command Buffer KL6821 : Tc2_DALI. ST_DALIV2Command Buffer; // Tc3_DALI st KL6821In Data Tc3 AT %I* : Tc3_DALI. ST_KL6821In Data; st KL6821Out Data Tc3 AT %Q* : Tc3_DALI. ST_KL6821Out Data; END_VAR Since the structures for linking the Bus Terminal have the same name in both libraries, the namespace must be prefixed. Although the structures have the same name in both libraries, they have different data types within the Twin CAT 3 type system. The namespace ensures that the appropriate data type from the respective library is used. For better readability, the namespace was also specified for the structure for the command buffer (ST_DALIV2Command Buffer) from the Tc2_DALI library. Strictly speaking this would not be necessary at this point, because the identifier ST_DALIV2Command Buffer only occurs in the Tc2_DALI library. The namespace of a library is displayed in the Properties window. TE1000 Version: 1.20.0 947
## Page 948

Appendix By convention, the namespace of the Beckhoff library is the same as the name of the library. Next, the function block that is called by the communication task is created. In this function block, an instance of FB_KL6821Communication is called for each terminal, among other things. The namespace must also be specified here, since each library contains a function block with the name FB_KL6821Communication. PROGRAM Communication VAR // Tc2_DALI fb KL6821Communication Tc2 : Tc2_DALI. FB_KL6821Communication; // Tc3_DALI fb KL6821Communication Tc3 : Tc3_DALI. FB_KL6821Communication; END_VAR // Tc2_DALI fb KL6821Communication Tc2(st In Data := GVL.st KL6821In Data Tc2, st Out Data := GVL.st KL6821Out Data Tc2, st Command Buffer := GVL.st Command Buffer KL6821); // Tc3_DALI fb KL6821Communication Tc3(st In Data := GVL.st KL6821In Data Tc3, st Out Data := GVL.st KL6821Out Data Tc3); When calling the respective function blocks for sending the DALI commands or for receiving the events, in most cases it is not necessary to specify the namespace. In the Tc2_DALI library all elements have the prefix DALIV2 while in the Tc3_DALI the prefix DALI is used. Here you can download the sample project:https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/ Resources/9843858059.zip 5.5 Creating an application function block The following section illustrates how to create an application function block based on the Tc3_DALI library. The example describes a simple function block that controls control gears via short address, group address or broadcast. Here you can find the https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/ 9869845131.zip. The Twin CAT project is available for download as *.zip file. This must first be unpacked locally so that the archive (*.tnzip file) is available for import into the Twin CAT project. 948 Version: 1.20.0 TE1000
## Page 949

Appendix A positive edge at one of the three inputs sends the DALI command RECALL MAX LEVEL, RECALL MIN LEVEL or OFF. Parameterization of the DALI control gears The function block can initialize the variables max Level, min Level and fade Time of DALI control gears. Corresponding properties are available for this purpose. Their values are written to the DALI control gears when a positive edge is detected at b Initialize. During this time the output b Initializing is TRUE. DALI short address for reference device (n Reference Device Address) The parameter n Reference Device Address is used for reading the output value of a reference DALI control gear cyclically in the background (t Cycle Actual Level > 0 s). The output value is available at the output n Actual Level. No reference DALI control gear is required if a single DALI control gear is to be controlled with the function block (e Address Type = E_DALIAddress Type. Short). In this case, the output value of the individual control gear is determined via the individual address n Address. If a DALI group is addressed with the function block (e Address Type = E_DALIAddress Type. Group), n Reference Device Address must always contain the short address of a DALI control gear, which must be located in the addressed DALI group. Even with a broadcast (e Address Type = E_DALIAddress Type. Broadcast), a DALI control gear with a corresponding short address must be located on the DALI line. Transfer of the reference to the communication block When declaring the function block, the complete path of the communication block (FB_KL6811Communication [} 618], FB_KL6821Communication [} 621] or FB_EL6821Communication [} 614],…) is specified in round brackets. fb DALIApplication Example : FB_DALIApplication Example(Communication.fb KL6821Communication); This is used to specify via which DALI terminal the function block is to communicate. In FB_DALIApplication Example the parameter is passed by the method FB_init. The method FB_init is called automatically by the Twin CAT 3 runtime environment, once before the PLC program is started. TE1000 Version: 1.20.0 949
## Page 950

Appendix The parameter is of type I_DALICommunication and is contained in the Tc3_DALI library. All communication blocks (FB_KL6811Communication [} 618], FB_KL6821Communication [} 621] or FB_EL6821Communication [} 614], …) have implemented this interface. All DALI command function blocks (e.g. FB_DALI102Off) communicate with the DALI communication block via the interface pointer. In the method FB_init the parameter is assigned to the variable _ip DALICommunication of the function block. To ensure that the reference can be changed at runtime, the interface pointer is also passed to the device function block via the property ip DALICommunication. Internally, the property is stored in the variable _ip DALICommunication. In the device function block it must be ensured that this interface pointer is passed on to all DALI command function blocks. The internal method Set Communication is available for this purpose. In this method the interface pointer is passed to all DALI command function blocks located in the function block. The property ip DALICommunication is used in the command function blocks for this purpose. This property is used to reassign the reference to the DALI communication block at runtime. Checking the parameters All parameters are checked by the internal method Check Parameters. In the event of an error the method returns the error Id, or 0 if there is no error. The Ids of the runtime messages [} 923] can be used here: IF (THIS^.ip DALICommunication = 0) THEN Check Parameters := TC_EVENTS. Tc DALIEvent Class. The Interface To The Communication Buffer Is Not Initialized .n Event Id; END_IF If required, you can also use your own error Ids, starting at 1000: IF (<check your parameter>) THEN Check Parameters := 1000; END_IF Similar to Set Communication, Check Parameters is also called in the first PLC cycle. This call also occurs if a positive edge was detected at the inputs b Initialize, b Recall Max Level, b Recall Min Level or b Off. Alternatively, you could call the method every time the value of a parameter has changed. Structure of the function block In the upper part of the function block the positive edges of the inputs b Initialize, b Recall Max Level, b Recall Min Level or b Off are queried. The middle part contains a step sequence in which the individual actions are carried out. If a positive edge is detected at one of the inputs, the corresponding step of the step sequence is triggered. The DALI command QUERY ACTUAL LEVEL is sent once the DALI commands RECALL MAX LEVEL (step 200) or RECALL MIN LEVEL (step 300) have been executed. This reads the new output value from the DALI reference device and outputs it at the output n Actual Level. The variables max Level, min Level and fade Time are written from step 10000. In the lower part, the output value is read cyclically from the DALI reference device and output at the output n Actual Level. Comments The step sequence can only be set to a new action if no action is currently being executed (n Step = 0). The number of DALI commands should be minimized. For example, after the DALI commands RECALL MAX LEVEL or RECALL MIN LEVEL, the current output value is only read out if during the next 1000 ms the output value is not already read out by cyclic querying in the lower part of the function block: IF (((ton Cycle Actual Level. PT - ton Cycle Actual Level. ET) > T#1S) OR (t Cycle Actual Level = T#0S)) THEN n Step := 9000; ELSE b Busy := FALSE; n Step := 0; END_IF 950 Version: 1.20.0 TE1000
## Page 951

Appendix 5.6 Creating a device function block The following section illustrates how to create a device function block based on the Tc3_DALI library. The sample describes a simple function block that maps a DALI sensor (input device) with occupancy sensor (instance 0) and light sensor (instance 1). Here you can find the https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_DALI/Resources/ 11326365707.zip. The Twin CAT project is available for download as *.zip file. This must first be unpacked locally so that the archive (*.tnzip file) is available for import into the Twin CAT project. The current measured value is read directly from the respective instance via the inputs b Query Occupancy and b Query Brightness and output at the output b Occupied or n Brightness Level. During the reading process, the output b Reading Occupancy or b Reading Brightness = TRUE. A positive edge at input b Cancel Hold Timer Occupancy causes the DALI command CANCEL HOLD TIMER to be sent to instance 0 (occupancy sensor). This terminates the hold timer prematurely and, if there is no motion, sets the output b Occupied to FALSE. Parameterization of the DALI control gears The function block can initialize all relevant variables from the occupancy sensor (instance 0) and from the light sensor (instance 1). Corresponding properties are available for this purpose. Their values are written to the DALI control device when a positive edge is detected at b Initialize. During this time the output b Initializing is TRUE. TE1000 Version: 1.20.0 951
## Page 952

Appendix Transfer of the reference to the communication block When declaring the function block, the complete path of the communication block (FB_KL6811Communication [} 618], FB_KL6821Communication [} 621] or FB_EL6821Communication [} 614],…) is specified in round brackets. fb DALIApplication Example : FB_DALIApplication Example(Communication.fb KL6821Communication); This is used to specify via which DALI terminal the function block is to communicate. In FB_DALIApplication Example the parameter is passed by the method FB_init. The method FB_init is called automatically by the Twin CAT 3 runtime environment, once before the PLC program is started. The parameter is of type I_DALICommunication and is contained in the Tc3_DALI library. All communication blocks (FB_KL6811Communication [} 618], FB_KL6821Communication [} 621] or FB_EL6821Communication [} 614], …) have implemented this interface. All DALI command function blocks (e.g. FB_DALI102Off) communicate with the DALI communication block via the interface pointer. In the method FB_init the parameter is assigned to the variable _ip DALICommunication of the function block. To ensure that the reference can be changed at runtime, the interface pointer is also passed to the device function block via the property ip DALICommunication. Internally, the property is stored in the variable _ip DALICommunication. In the device function block it must be ensured that this interface pointer is passed on to all DALI command function blocks. The internal method Set Communication is available for this purpose. In this method the interface pointer is passed to all DALI command function blocks located in the function block. The property ip DALICommunication is used in the command function blocks for this purpose. This property is used to reassign the reference to the DALI communication block at runtime. Checking the parameters All parameters are checked by the internal method Check Parameters. In the event of an error the method returns the error Id, or 0 if there is no error. The Ids of the runtime messages [} 923] can be used here: IF (THIS^.ip DALICommunication = 0) THEN Check Parameters := TC_EVENTS. Tc DALIEvent Class. The Interface To The Communication Buffer Is Not Initialized.n Event Id; END_IF If required, you can also use your own error Ids, starting at 1000: IF (<check your parameter>) THEN Check Parameters := 1000; END_IF Check Parameters is called in the first PLC cycle and on a positive edge at input b Initialize. 952 Version: 1.20.0 TE1000
## Page 953

Appendix In addition, the method Check Parameters is called as soon as a parameter has changed. The check for parameter change is done in the method Parameter Changed. If this returns TRUE, a parameter has been changed. Then the method Check Parameters is used to check whether all parameters contain correct values. If this is not the case, the function block is terminated. IF (THIS^. Parameter Changed()) THEN n Error Id := THIS^. Check Parameters(); b Error := (n Error Id > 0); IF (b Error) THEN b Parameter Invalid := TRUE; RETURN; ELSE b Parameter Invalid := FALSE; END_IF END_IF IF (b Parameter Invalid) THEN RETURN; END_IF Structure of the function block In the upper part of the function block, the parameters (Check Parameters) are checked when the function block is started for the first time and the interface pointer from the communication block (_ip DALICommunication) is transferred to the internal DALI function blocks (Set Communication). In the middle part there is a step sequence with which the DALI control device is initialized. The function blocks FB_DALI103Control Device, FB_DALI303Occupancy Sensor and FB_DALI304Light Sensor are used for this purpose. At the end of the initialization, the current measured value is read from both instances. Initialization may only be started if no measured value is currently being read out (b Reading Occupancy and b Reading Brightness are FALSE). In the lower part the notifications are evaluated and the reading of the measured values is executed by the inputs b Query Occupancy and b Query Brightness. The function blocks FB_DALI103Control Device, FB_DALI303Occupancy Sensor and FB_DALI304Light Sensor are also used for this purpose. This area is only processed if initialization is not active. 5.7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components TE1000 Version: 1.20.0 953
## Page 954

Appendix Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 954 Version: 1.20.0 TE1000
## Page 955

Trademark statements Beckhoff®, ATRO®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. Third-party trademark statements Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies.
## Page 956

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
