---
title: "TF5200_online_tool_compensation_en"
product: "TF5200"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.06"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_online_tool_compensation_en.pdf"
release_date: "2025-06-10"
---
Functional description | EN TF5200 | Twin CAT 3 CNC Online tool compensation 6/10/2025 | Version: 1.06
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5200 | Twin CAT 3 CNC Version: 1.06 3 Online tool compensation
## Page 4

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. 4 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 5

Table of contents Table of contents Notes on the documentation.................................................................................................................... 3 General and safety instructions.............................................................................................................. 4 1 Overview.................................................................................................................................................... 8 2 Description................................................................................................................................................ 9 2.1 Programming (#OTC ON/OFF)......................................................................................................... 9 2.2 Wear compensation of tool radius................................................................................................... 11 2.3 Wear compensation of tool length................................................................................................... 16 2.3.1 Inclined grinding disc........................................................................................................ 18 2.4 Wear compensation in tool direction............................................................................................... 19 2.5 Wear compensation in direction of surface normal......................................................................... 23 2.6 Special settings in tool data............................................................................................................ 26 2.7 HLI parameters............................................................................................................................... 27 2.7.1 Channel-specific connection............................................................................................ 27 2.7.2 Axis-specific connection................................................................................................... 28 2.7.3 HLI parameters up to CNC Build V2.20xx........................................................................ 28 2.8 Special V. G. variables for OTC....................................................................................................... 30 2.9 Connecting to external tool management....................................................................................... 31 3 Parameter................................................................................................................................................. 32 3.1 Overview......................................................................................................................................... 32 3.2 Description...................................................................................................................................... 32 4 Support and Service............................................................................................................................... 35 Index......................................................................................................................................................... 36 TF5200 | Twin CAT 3 CNC Version: 5 Online tool compensation
## Page 6

Table of contents 6 Version: TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 7

List of figures List of figures Fig. 1 Grinding a contour........................................................................................................................ 9 Fig. 2 Wear compensation of tool radius................................................................................................ 11 Fig. 3 Contour of the NC program wr_quad_disc.nc.............................................................................. 13 Fig. 4 Description of RADIUS function................................................................................................... 15 Fig. 5 Wear compensation of tool length................................................................................................ 16 Fig. 6 Description of LENGTH function.................................................................................................. 17 Fig. 7 Inclined grinding disc.................................................................................................................... 18 Fig. 8 Wear compensation in tool direction............................................................................................ 19 Fig. 9 Grinding disc setting B=0............................................................................................................. 21 Fig. 10 Grinding disc setting B=90........................................................................................................... 21 Fig. 11 Description of TOOL_DIR function............................................................................................... 22 Fig. 12 Wear in surface normal direction................................................................................................. 23 Fig. 13 Description of SURF_NORM_DIR function.................................................................................. 25 TF5200 | Twin CAT 3 CNC Version: 1.06 7 Online tool compensation
## Page 8

Overview 1 Overview Task With certain processes such as grinding, the length or the radius of the tool must be continuously corrected to compensate for wear. Wear compensation depends on the path travelled. Properties Wear compensation can only be enabled with tool type 2 (grinding tool). If a different tool type is used, error message P-ERR-21391 is output. Wear compensation can be used for 4 processing types and 3 different modes. Parametrisation Wear compensation is activated and deactivated from the NC program. The wear constant can be parameterised both from the NC program and using preset parameters in the tool list P-TOOL-00030. Further parameters in this context are described in the section Parameter [} 32]. Programming The following NC command is provided to program online tool compensation in the NC program. Parametrisation can be programmed in advance or in combination with #OTC ON . For further details on the above command, see the section Programming (#OTC ON/OFF) [} 9]. Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 8 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 9

Description 2 Description Task With certain processes such as grinding, the length or the radius of the tool must be continuously corrected to compensate for wear. Wear compensation depends on the path covered. In addition, compensation can be influenced by the PLC. Wear compensation is activated and deactivated from the NC program. The wear constant can be parameterised both from the NC program and using preset parameters in the tool list P-TOOL-00030. Rapid traversing blocks have no wear. It is assumed that the entire width of the lateral surface of the grinding disc is in contact. Tool holder Workpiece Fig. 1: Grinding a contour Tool type Wear compensation can only be enabled with tool type 2 (grinding tool). If a different tool type is used, error message P-ERR-21391 is output. Processing types Online wear compensation can be used for 4 processing types and 3 different modes. 1. Radius compensation (only in combination with active TRC) for processing contours in the plane (2.5 D) 2. Length compensation for processing surfaces (surface grinding, 2.5 D) 3. Compensation in tool direction for any orientation (5-axis) 4. Compensation in direction of surface normal (5-axis) Modes 1. Continuous (dependent on motion path traversed) 2. Discrete (discrete wear compensation via PLC) 3. Automatic, combination of discrete and continuous Discrete additive wear values which are assigned by the PLC are adjusted over several cycles. 2.1 Programming (#OTC ON/OFF) The following NC command is provided to program online tool compensation in the NC program. Parametrisation can be programmed in advance or in combination with #OTC ON: #OTC ON | OFF [ [ RADIUS | LENGTH | TOOL_DIR | SURF_NORM_DIR DISC | CONT | AUTO TF5200 | Twin CAT 3 CNC Version: 1.06 9 Online tool compensation
## Page 10

Description WEAR_CONST=.. | WEAR_CONST_TOOL ACC_WEIGHT=.. ] ] RADIUS Radius compensation processing type LENGTH Length compensation processing type (default) TOOL_DIR Compensation in tool direction (5-axis) processing type SURF_NORM_DIR Compensation in direction of surface normal (5-axis) processing type DISC Discrete mode: input only via PLC, external presetting CONT Continuous mode: Presetting values only by calculating the motion path traversed and the wear constant, internal calculation AUTO Automatic mode: Adding the external presetting and internal calculation (default) WEAR_CONST=.. User-specific definition of wear constant; it acts modally, this means that with #OTC ON the programmed wear constant is used and not the default wear constant defined in the current tool data. Defining the valid wear constant is optional. Unit: 0.1 µm/m WEAR_CONST_TOO Switch to the default wear constant defined in the current tool data; it acts modally, L this means that with #OTC ON the default wear constant (default) defined in the current tool data is used and not the user-specific definition of the wear constant. ACC_WEIGHT=.. Acceleration weighting in percent [1;100], default: 100% When OTC is deselected with #OTC OFF, the amount of wear (discrete and/or continuous) is in- cluded in the calculation for the current tool. 10 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 11

Description 2.2 Wear compensation of tool radius Grinding a contour Use tool radius wear compensation (radius compensation) by preference to grind a contour at the same time as tool radius compensation. Grinding disc wear in the direction of the disc radius can be compensated continuously or discretely. In the radius compensation processing type, wear is only considered for active tool radius compensation (TRC). The figure below shows the tool radius wear: R1 Workpiece R2 R1 > R2 Fig. 2: Wear compensation of tool radius The start-up movement in relation to the equidistant path after selecting TRC (G41/G42) is con- sidered without wear. Motion after deselecting TRC (G40) is also without wear. TF5200 | Twin CAT 3 CNC Version: 1.06 11 Online tool compensation
## Page 12

Description General #OTC programming example N10 F10000 N20 D1 (Data set selection for grinding wheel) N30 G0 X0 Y0 Z0 N40 #OTC[RADIUS, AUTO] (define OTC processing type + mode) N50 #OTC ON (select OTC) N60 G41 G01 X50 (select TRC, wear-free movement) N70 X1000 N80 G40 X50 (deselect TRC with path motion to reduce TRC) N90 #OTC OFF (deselect OTC) N100 G00 X50 N199 M30 12 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 13

Description OTC with discrete compensation %wr_quad_disc.nc N20 G17G90 N22 D1 G25 (Linear transition block) N40 G1 X0Y0Z0 F600 N50 #OTC ON[RADIUS DISC] N55 G42 N60 G1 X2 N70 G1 X102 N80 G26 Y100 (Circular transition block) N90 X2 N95 Y0 N100 G40 G1 X0 N110 #OTC OFF N99999 M30 Legend: Green: Path contour with active TRC without OTC offset Black: Path contour with negative value for OTC radius offset Red: Path contour with positive value for OTC radius offset Fig. 3: Contour of the NC program wr_quad_disc.nc TF5200 | Twin CAT 3 CNC Version: 1.06 13 Online tool compensation
## Page 14

Description Explanation to the figure above (the discrete OTC offset applied is 2 mm) 1. In this corner of the contour, G25 is active. The contour is not continuous. The predefined OTC offset is applied to another axis over several cycles. 2. The TRC inserts a circular transition because of G26. But the OTC offset is so large that the increase in offset is unable to keep up with the continuous change in the contour. 3. The OTC offset lags behind considerably. 4. Increase the OTC offset 5. Decrease the positive OTC offset and increase the negative OTC offset The tool radius is influenced by the PLC. Condition: After the OTCRadius Offset control unit is active, the OTC radius offset can then be programmed accordingly for the build currently in use. This value is then added to each cycle perpendicular to the programmed contour. PLC example code (* Enable the OTC control unit for first channel *) gp Ch[0]^.bahn_mc_control.otc_radius_offset.enable_w := TRUE; (* write radius offset in the first channel *) gp Ch[0]^.bahn_mc_control.otc_radius_offset.command_w := OTC_Offset; PLC example code for CNC Build as of V2.11.20cxx: where channel_idx = [1.. HLI_SYS_CHNMAX] (* Enable the OTC control unit for first channel *) p MC[1]^.addr^. MCControl Bahn_Data. MCControl SGN32Unit_OTCRadius Offset. X_Enable := TRUE; (* write radius offset in the first channel *) p MC[1]^.addr^. MCControl Bahn_Data. MCControl SGN32Unit_OTCRadius Offset. D_Command := OTC_Offset; A continuous contour path is recommended because changing the orientation of the predefined off- set is not applied to the axis all at once but is distributed over several cycles. On selection, the commands G41/G42 and #OTC ON can be swapped. On deselection, the se- quence G40 before #OTC OFF must be maintained. The TRC modes G138/G139 make a path mo- tion between the two commands absolutely necessary. If error 90050 is output, the path motion does not exist when deselected with G138/G139. 14 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 15

Description The functionality of the RADIUS type is shown by the example of the G17 plane: Fig. 4: Description of RADIUS function TF5200 | Twin CAT 3 CNC Version: 1.06 15 Online tool compensation
## Page 16

Description 2.3 Wear compensation of tool length Grinding a surface When the tool length is compensated (length compensation), wear is compensated in the direction of the 3rd main axis. This can take place both continuously and discretely. This procedure is used in particular for processing surfaces (surface grinding). Z Work piece Y X 16 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation L1 L 2 L1 > L2 Fig. 5: Wear compensation of tool length Tool length wear ... N30 D1 (Select record for grinding disc) N40 G00 X0 Y0 Z0 N50 #OTC ON [LENGTH] (Select OTC) N60 G1 X1000 F10000 N70 #OTC OFF (Deselect OTC) ...
## Page 17

Description Distributing continuous wear on 2 main axes depends on the inclination of the grinding disc as described in section Inclined grinding disc [} 18]. The LENGTH operation mode is shown in the figure below: Decoder TRC BAVO IPO TF5200 | Twin CAT 3 CNC Version: 1.06 17 Online tool compensation gninnal P eniln O #OTC [ LENGTH CONT/ DISC/AUTO] CONT X Y Z Covered distance and tilt + angle of disc + G17/G18/G19 DISC + W Axis offset + + PLC + + OTC Fig. 6: Description of LENGTH function
## Page 18

Description 2.3.1 Inclined grinding disc Inclined grinding The incline of the grinding disc is only entered in the tool list (P-TOOL-00138) to grind inclined surfaces. Here the complete lateral surface of the grinding disc is also in contact. The figure below shows the orientation of the tilt angle using the example of the G17 plane: X/Y plane with G17 18 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation cev_iro Z Turning point of disc a a c e v _ o ri r o i _ v e c X a negative a positive a is 0 Fig. 7: Inclined grinding disc
## Page 19

Description Tool orientation is determined by the disc tilt angle. This tool orientation can then be used to apply the resulting wear proportionately to the main axes. In the figure above, wear is included in the calculation of the X and Z axes. 2.4 Wear compensation in tool direction Grinding a surface This compensation type is used to compensate for wear in the tool direction. This can take place both continuously and discretely. Z Grinding disc Workpiece tool wear X Fig. 8: Wear compensation in tool direction TF5200 | Twin CAT 3 CNC Version: 1.06 19 Online tool compensation
## Page 20

Description OTC grinding with kinematic type 4 ... N30 D1 (Select record for grinding disc) N40 G00 X0 Y0 Z300 B0 N50 #KIN ID[4] N50 #TRAFO ON N60 G00 B45 N70 G01 X100 Z50 F1000 N80 #OTC ON [TOOL_DIR, DISC] (Select OTC) N90 $FOR P1=0, 20, 1 N100 G91 G01 X10 Z-10 F2000 N110 X-10 Z10 N120 $ENDFOR N120 #OTC OFF (deselect OTC) N130 #TRAFO OFF ... 20 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 21

Description Programming kinematic parameters Tool 1 B=0° B - + HD1 Grinding wheel HD3 TCP Fig. 9: Grinding disc setting B=0 Tool 2 B=90° B - + HD10=-90° HD1 Grinding wheel TCP Fig. 10: Grinding disc setting B=90 TF5200 | Twin CAT 3 CNC Version: 1.06 21 Online tool compensation
## Page 22

Description The figure below shows the function of TOOL_DIR: Decoder TRC BAVO IPO 22 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation gninnal P eniln O #OTC [TOOL_DIR CONT/DISC/AUTO] X Y Z C A CONT + + Covered distance + Tool orientation + Offset + In tool PLC direction + DISC OTC Fig. 11: Description of TOOL_DIR function
## Page 23

Description 2.5 Wear compensation in direction of surface normal Grinding a surface This compensation type compensates for wear in surface normal direction. The surface normal direction is calculated in the CNC based on the tool direction vector and the path tangent vector. Z Grinding wheel ori1 fn1 Tool wear ori2 tb1 fn2 ori3 fn3 tb2 Workpiece tb3 X Fig. 12: Wear in surface normal direction TF5200 | Twin CAT 3 CNC Version: 1.06 23 Online tool compensation
## Page 24

Description OTC grinding with kinematic type 4 N30 D1 (Select record for grinding disc) N40 G00 X0 Y0 Z300 B0 N50 #KIN ID[4] N50 #TRAFO ON N60 G00 B0 N70 G01 X100 Z50 F1000 N80 #OTC ON [SURF_NORM_DIR, DISC] (Select OTC) N85 #HSC ON[BSPLINE PATH_DEV 5 MERGE = 0] N90 $FOR P1=0, 5, 1 N100 G91 G01 X3 Z-3 F2000 N110 X2 Z-2 N120 X5 Z-2 N130 X5 Z-1 N140 X5 N150 X5 Z-1 N160 X5 Z-2 N170 X2 Z-2 N180 X3 Z-3 N190 X-3 Z3 F2000 N200 X-2 Z2 N210 X-5 Z2 N220 X-5 Z1 N230 X-5 N240 X-5 Z1 N250 X-5 Z2 N260 X-2 Z2 N270 X-3 Z3 N280 $ENDFOR N290 #HSC OFF N300 #OTC OFF (Deselect OTC) N310 #TRAFO OFF M30 24 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 25

Description Decoder WRK BAVO IPO TF5200 | Twin CAT 3 CNC Version: 1.06 25 Online tool compensation gninnal P eniln O #OTC [ SURF_NORM_DIR CONT/DISC/AUTO] X Y Z C A CONT + + Covered distance + Surface normal + Offset + Radius PLC + DISC OTC Fig. 13: Description of SURF_NORM_DIR function
## Page 26

Description 2.6 Special settings in tool data Definition of tool type and wear parameters: wz[1].gueltig 1 wz[1].typ 2 grinding tool wz[1].mass_einheit 0 wz[1].laenge 500000 wz[1].radius 300000 wz[1].ax_versatz[0] 0 wz[1].ax_versatz[1] 0 wz[1].ax_versatz[2] 0 ... # Wear constant : Unit 0.1 µm/m wz[1].grinding_wear_const 100000 # Maximum applied discrete input via PLC, unit: 0.1µm wz[1].grinding_max_infeed 200000 # Disc tilt angle, unit: 0.0001 degree wz[1].grinding_disc_tilt_angle 0 The disc tilt angle must be entered as a function of the mechanical construction. Unassigned data are assigned the value 0 by default. Consequence: If the tool type is not assigned Type 2, the error P-ERR-21391 is generated when #OTC ON is programmed. If grinding_max_infeed is not set, no discrete offset can be applied. The following also applies: if grinding_wear_const is not set, it is not possible to calculate the con- tinuous offset depending on the path. 26 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 27

Description 2.7 HLI parameters 2.7.1 Channel-specific connection The following channel-specific control unit is used to default wear values by the PLC in the modes – ‘Radius wear ‘ (RADIUS) or ‘Tool direction wear’ (TOOL_DIR). See Programming (#OTC ON/OFF) [} 9] The mode must be either DISC or AUTO in both modes. Online tool compensation (OTC) Description The tool radius is compensated by specifying a wear value. The wear value is specified as an offset from the planned cutting edge. It is only possible to used the control unit in the RADIUS or TOOL_DIR modes and in the DISC or AUTO mode. See NC command #OTC [} 9]. See also functional description [FCT-C20 [} 11]]. Data type MC_CONTROL_SGN32_UNIT, see description of Control unit Special features If the wear value changes, this change is distributed over several interpolation cycles to avoid sudden changes. Access PLC reads request_r + state_r and writes command_w + enable_w ST path gp Ch[channel_idx]^.bahn_mc_control.otc_radius_offset Commanded, requested and return values ST element .command_w .request_r .state_r Data type DINT Unit 0.1 µm Value range [-P-TOOL-00031, P-TOOL-00031] Redirection ST element .enable_w Adding wear in tool direction In the third axis (axis_idx = 2) an offset value can be written in the tool direction. The PLC input of the first two axes is ignored. All the axes in the following sequence can be influenced as usual by the PLC. TF5200 | Twin CAT 3 CNC Version: 1.06 27 Online tool compensation
## Page 28

Description 2.7.2 Axis-specific connection Adding wear in axis direction It is possible to use the following control unit both when the RADIUS mode is used as well as the LENGTH mode. The mode must be either DISC or AUTO. See Programming (#OTC ON/OFF) [} 9] Adding wear in surface normal direction When the SURF_NORM_ORI mode is used, it is possible to use automatic continuous wear compensation and influencing via the following control unit. The mode must be either DISC or AUTO. See Programming (#OTC ON/OFF) [} 9] The surface normal is approximated based on the current tool orientation and path tangent (cf. RADIUS type). For a continuous change in direction of the surface normal vector, the contour and orientation should be steady at all times. The PLC input of the first three axes is ignored All the axes in the following sequence can be influenced as usual by the PLC. OTC offset Description When this wear offset is set, wear in the direction of this axis can be compensated. When the SURF_NORM_ORI mode is used (wear in the direction of the surface normal), the offset value must be assigned in the third axis. Data type MC_CONTROL_SGN32_UNIT, see description of Control unit Special features The wear offset is distributed by the CNC over several cycles. Access PLC reads request_r + state_r and writes command_w + enable_w ST path gp Ax[axis_idx]^.ipo_mc_control.otc_offset Commanded, requested and return values ST element .command_w .request_r .state_r Data type DINT Unit 0.1 µm Value range [-P-TOOL-00031, P-TOOL-00031] Redirection ST element .enable_w 2.7.3 HLI parameters up to CNC Build V2.20xx Channel-specific connection Online tool compensation (OTC) 28 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 29

Description Description The tool radius can be adapted by setting the wear offset depending on wear. [0,1µm] See also Wear compensation of tool radius [} 11]. It is only possible to used the control unit in the RADIUS or TOOL_DIR modes and in the DISC or AUTO mode. See NC command #OTC [} 9]. See also functional description [FCT-C20 [} 8]]. Data type MCControl SGN32Unit, see description of Control Unit Peculiarities The wear offset is not output in a cycle in the CNC. Instead it is output over several cycles. Access PLC reads Request + State and writes Command + Enable ST Path p MC[channel_idx]^.addr^. MCControl Bahn_Data. MCControl SGN32Unit_OTCRad ius Offset Commanded, requested and return values ST Element . D_Command . D_Request . D_State Data type DINT Value range [-P-TOOL-00031, P-TOOL-00031] Redirection ST Element . X_Enable Axis-specific connection OTC offset Description When this wear offset is set, wear in the direction of this axis can be compensated. When the SURF_NORM_ORI mode is used (wear in the direction of the surface normal), the offset value must be assigned in the third axis. Unit: 0.1µm Data type MCControl SGN32Unit, see description of control unit Special features The wear offset is distributed by the CNC over several cycles. Access PLC reads Request + State and writes Command + Enable ST path p AC[axis_idx]^.addr^. Mc Control Ipo_Data. MCControl SGN32Unit_OTCOffset Commanded, requested and return values ST element . D_Command . D_Request . D_State Data type DINT Value range [-P-TOOL-00031, P-TOOL-00031] Redirection ST element . X_Enable Move back manual mode offset Description If manual mode is active in the channel and if the commanded axis fails to move, the axis is moved by this command so that afterwards manual mode offset is 0. Data type MCControl Bool Unit, see description of Control Unit Special features A rising edge (FALSE → TRUE) at X_Command starts the process. The signal is ignored if a manual mode motion is still active or manual mode offset is already 0. Access PLC reads Request + State and writes Command + Enable ST path p AC[axis_idx]^.addr^. Mc Control Ipo_Data. MCControl Bool Unit_Manual Mv Back T o Start TF5200 | Twin CAT 3 CNC Version: 1.06 29 Online tool compensation
## Page 30

Description Commanded, requested and return values ST element . X_Command . X_Request . X_State Data type BOOL Value range rising edge (FALSE → TRUE) triggers backward motion Redirection ST element . X_Enable 2.8 Special V. G. variables for OTC Reading wear values Current tool wear can be read after processing with the following variables. With radius compensation processing type in [mm] or [inch]: - Total radius wear, discrete + continuous wear V. G. WZ_AKT. WEAR_RADIUS - Continuous radius wear V. G. WZ_AKT. WEAR_RADIUS_CONT With length compensation processing type in [mm] or [inch]: - Wear in axis with index <idx> V. G. WZ_AKT. WEAR[<idx>] or - Wear in axis with name <axis_name> V. G. WZ_AKT. WEAR.<axis_name> The current wear value is supplied after deselecting OTC. The wear value refers to the wear which occurred between selecting and deselecting OTC. If OTC is selected and deselected repeated in the same NC program, the above variables refer to the accumulated wear. Writing/reading wear constant The wear constant is defined as default in the tool data. It can also be read or written in the NC program by the variable V. G. WZ_AKT. WEAR_CONST in [0.1 µm/m]: Status query: OTC active The OTC state can be determined in the NC program. To do this, the NC program V. G. OTC_ACTIVE of the Boolean type must be readable in the NC program. NOTICE While OTC is active, V. G. WZ_AKT wear values are not up-to-date. They are only updated after OTC (#OTC OFF) is deselected. 30 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 31

Description 2.9 Connecting to external tool management Tool data The external tool management system must provide the following data to the CNC when a grinding tool is changed (see [FCT-C10//section Tool data]: • Type: Tool type 2 for grinding tool • wear_const: Wear constant • disc_tilt_angle: Grinding disc tilt angle • ext_discret_limit: Maximum discrete input by the PLC When the grinding tool is replaced, the CNC informs the external tool management system of the wear: The wear data sent includes the following: • wear_radius, total wear consisting of discrete and continuous wear • wear_radius_cont, continuous wear This wear data is generated from the time when the tool is replaced. The values must be taken over by the external tool management and are used internally to recalculate the tool geometric data (radius, length). Unassigned data are assigned the value 0 by default. Consequence: If the tool type is not assigned Type 2, the error P-ERR-21391 is generated when #OTC ON is programmed. If grinding_max_infeed is not set, no discrete offset can be applied. The following also applies: if grinding_wear_const is not set, it is not possible to calculate the con- tinuous offset depending on the path. TF5200 | Twin CAT 3 CNC Version: 1.06 31 Online tool compensation
## Page 32

Parameter 3 Parameter 3.1 Overview Channel parameters ID Parameter Description P-CHAN-00870 allow_pos_req_otc Position requests with active OTC Tool parameters ID Parameter Description P-TOOL-00001 typ Tool type P-TOOL-00030 grinding_wear_const Wear constant P-TOOL-00031 grinding_max_infeed Maximum discrete infeed P-TOOL-00138 grinding_disc_tilt_angl Grinding disc tilt angle e 3.2 Description Tool parameters P-TOOL-00001 Type Description This parameter is assigned to distinguish between tool types. Parameter wz[i].typ or wz[i].type Data type UNS16 Data range 0: Milling tool 1: Turning tool 2: Grinding tool 3: Wire (erosion) Dimension ---- Default value 0 Remarks Parameterisation example: Tool 5 is a milling tool wz[5].typ 0 P-TOOL-00030 Wear constant Description The wear constant is used to calculate continuous tool wear. Alternatively, it can also be defined in the NC program (#OTC […]. Parameter wz[i].grinding_wear_const Data type REAL64 Data range 0 ≤ grinding_wear_const Dimension 0.1µm/m Default value 0 Remarks The wear constant should contain relatively small values. There is no special dynamic consideration based on the actual wear values. P-TOOL-00031 Maximum discrete infeed Description The maximum discrete infeed defines the greatest relative change which is assignable by the PLC. 32 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 33

Parameter Parameter wz[i].grinding_max_infeed Data type REAL64 Data range MIN(SGN32) ≤ grinding_max_infeed ≤ MAX(SGN32) Dimension 0.1µm Default value 0 Remarks P-TOOL-00138 Grinding disc tilt angle Description The parameter defines the angle between the centre line of the grinding disc and the 3rd main axis for tilted grinding discs. Parameter wz[i].grinding_disc_tilt_angle Data type REAL64 Data range -45°≤ grinding_tilt_angle ≤ 45° Dimension 0.0001° Default value 0 Remarks Grinding disc tilt angle TF5200 | Twin CAT 3 CNC Version: 1.06 33 Online tool compensation
## Page 34

Parameter Channel parameters P-CHAN-00870 Position requests with active OTC Description When OTC [} 9] is active, this parameter allows the use of NC commands and functions that result in a position request in the NC channel. This includes e.g.: • #CHANNEL INIT • Functionality of measurement An error with ID 21572 is output if each NC command or function is programmed without P-CHAN-00870. Parameter allow_pos_req_otc Data type BOOLEAN Data range 0: Position request not allowed with active OTC 1: Position request allowed with active OTC Dimension ---- Default value 0 Remarks Available as of Build V3.1.3081.8 or V3.1.3116.0 34 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 35

Support and Service 4 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5200 | Twin CAT 3 CNC Version: 1.06 35 Online tool compensation
## Page 36

Index Index M manual mode offset:move back:stop 29 O Offset manual mode:move back:stop 29 OTC 28, 29 OTC Offset 28, 29 radius 27, 28 P P-CHAN-00870 34 P-TOOL-00001 32 P-TOOL-00030 32 P-TOOL-00031 32 P-TOOL-00138 33 T tool compensation:online:radius 27 V Verschleiß Werkzeug:Radius 28 W wear tool:radius 27 Werkzeug Korrektur:Online:Radius 28 36 Version: 1.06 TF5200 | Twin CAT 3 CNC Online tool compensation
## Page 38

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
