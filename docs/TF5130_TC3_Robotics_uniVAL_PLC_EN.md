---
title: "TF5130_TC3_Robotics_uniVAL_PLC_EN"
product: "TF5130"
category: "Motion_Control"
tags: ["PLC", "ROBOTICS", "VAL"]
language: "EN"
document_type: "Manual"
version: "1.3.4"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5130_TC3_Robotics_uniVAL_PLC_EN.pdf"
release_date: "2025-03-13"
---
Manual | EN TF5130 Twin CAT 3 | Robotics uni VAL PLC 2025-03-13 | Version: 1.3.4
## Page 3

Table of Contents Table of Contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 6 1.3 Notes on information security............................................................................................................ 7 2 Introduction............................................................................................................................................... 8 3 System Requirements.............................................................................................................................. 9 4 Installation............................................................................................................................................... 10 5 Licensing................................................................................................................................................. 11 6 PLC API.................................................................................................................................................... 14 6.1 Function blocks............................................................................................................................... 14 6.1.1 Database.......................................................................................................................... 14 6.1.2 Internal............................................................................................................................. 35 6.1.3 MC_Group Continue......................................................................................................... 36 6.1.4 MC_Group Interrupt.......................................................................................................... 37 6.1.5 MC_Group Jog.................................................................................................................. 38 6.1.6 MC_Group Power............................................................................................................. 40 6.1.7 MC_Group Read Actual Position........................................................................................ 41 6.1.8 MC_Group Reset.............................................................................................................. 42 6.1.9 MC_Group Stop................................................................................................................ 43 6.1.10 MC_Move Axis Absolute.................................................................................................... 44 6.1.11 MC_Move Circular Absolute.............................................................................................. 46 6.1.12 MC_Move Direct Absolute................................................................................................. 48 6.1.13 MC_Move Linear Absolute................................................................................................. 50 6.1.14 VAL_Compute Frame....................................................................................................... 52 6.1.15 VAL_Get Forward Transformation..................................................................................... 54 6.1.16 VAL_Get Inverse Transformation....................................................................................... 55 6.1.17 VAL_Get Motor Temperature............................................................................................. 56 6.1.18 VAL_Move Safe Reference................................................................................................ 58 6.1.19 VAL_Read Axes Group...................................................................................................... 59 6.1.20 VAL_Read Safe Reference................................................................................................ 60 6.1.21 VAL_Read Write Arm IO..................................................................................................... 61 6.1.22 VAL_Read Write IO............................................................................................................ 63 6.1.23 VAL_Safe Brake Test......................................................................................................... 65 6.1.24 VAL_Set Movement ID....................................................................................................... 66 6.1.25 VAL_Shift Point................................................................................................................. 67 6.1.26 VAL_Touch Probe............................................................................................................. 68 6.1.27 VAL_Write Axes Group...................................................................................................... 69 6.2 Functions......................................................................................................................................... 70 6.2.1 VAL_Define Cartesian Pos................................................................................................ 70 6.2.2 VAL_Define Joint Pos........................................................................................................ 71 6.2.3 VAL_Define Trsf................................................................................................................ 72 6.2.4 VAL_Enable Manual Move................................................................................................. 73 6.3 Types.............................................................................................................................................. 74 TF5130 Version: 1.3.4 3
## Page 4

Table of Contents 6.3.1 Internal............................................................................................................................. 74 6.3.2 MC_Transition Parameter................................................................................................. 74 6.3.3 T_CS9Sfty Cmd................................................................................................................ 75 6.3.4 T_CS9Sfty Fbk.................................................................................................................. 75 6.3.5 T_Cartesian Pos............................................................................................................... 76 6.3.6 T_Command.................................................................................................................... 76 6.3.7 T_Joint Pos....................................................................................................................... 77 6.3.8 T_Mdesc.......................................................................................................................... 77 6.3.9 T_Staeubli Robot.............................................................................................................. 78 6.3.10 T_Status........................................................................................................................... 79 6.3.11 T_Trsf............................................................................................................................... 80 6.4 enums............................................................................................................................................. 81 6.4.1 e Blending......................................................................................................................... 81 6.4.2 e Config Elbow................................................................................................................... 81 6.4.3 e Config Shoulder.............................................................................................................. 82 6.4.4 e Config Wrist..................................................................................................................... 82 6.4.5 e MC_BUFFER_MODE.................................................................................................... 83 6.4.6 e MC_TRANSITION_MODE............................................................................................. 84 6.4.7 e Operation Mode.............................................................................................................. 84 6.4.8 e State Machine................................................................................................................. 85 6.5 unival PLC Error Codes.................................................................................................................. 86 6.5.1 CS8C_Error Message....................................................................................................... 86 6.5.2 CS9_Error Messages........................................................................................................ 89 7 Support and Service............................................................................................................................... 99 4 Version: 1.3.4 TF5130
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS®, and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. TF5130 Version: 1.3.4 5
## Page 6

Foreword 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.3.4 TF5130
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF5130 Version: 1.3.4 7
## Page 8

Introduction 2 Introduction The TC3 Robotics uni VAL PLC allows direct communication between the PLC and the robotics controller from Stäubli via a common interface. The robot's movements can be programmed directly in the PLC and compared with the robot's actual values in real-time. The TC3 Robotics uni VAL PLC combines PLC control and robotics on a single platform and enables programming from a single system without having to know a special robot programming language. The communication takes place via Ether CAT, with Twin CAT and the robotics controller from Stäubli exchanging the data as master and slave, respectively. Twin CAT sends the motion commands to the robot via Ether CAT. Thanks to this efficient communication, commands can be sent from the PLC to the robot at high speed. In addition, the PLC programmer has real- time access to the robot’s position data at all times. Other motion programs which are located in the robot controller's database can also be activated via this interface. 8 Version: 1.3.4 TF5130
## Page 9

System Requirements 3 System Requirements Technical data TF5130 Required TC1200 Twin CAT 3 PLC Target operating system Windows 10, Windows CE, Twin CAT/BSD Twin CAT version 3.1.4022 and later versions Twin CAT library Minimum Twin CAT ver- uni VAL PLC Minimum Stäubli Robot Control sion server (SRC) Tc3_uni Val Plc_v4_6 3.1.4024.43 s4.6 s7.10.2 (cs8) s8.10(cs9) Tc3_uni Val Plc_v4_5 3.1.4022.35 & s4.5 s7.10.2 (cs8) s8.10(cs9) 3.1.4024.15 Tc3_uni Val Plc_v4_4 3.1.4022.32 & 3.1.4024.9 s4.4 s7.10.2 (cs8) s8.12.3 (cs9) Tc3_uni Val Plc_v4_3 3.1.4022.30 & 3.1.4024.0 s4.2 & s4.3 s7.10.2 (cs8) s8.6.2 (cs9) Tc3_uni Val Plc_v4 3.1.4022.28 s4.1 s7.10.1 (cs8) s8.5.1 (cs9) Tc3_uni Val Plc 3.1.4022.28 3.1 s7.10.0 (cs8) TF5130 Version: 1.3.4 9
## Page 10

Installation 4 Installation Twin CAT 3.1 Build 4024 Executed with the Twin CAT 3 XAE or Full Setup. Twin CAT 3.1 Build 4026 Install the following workload via the Twin CAT Package Manager: Command line: tcpkg install TF5130. Robotics-unival PLC. XAE 10 Version: 1.3.4 TF5130
## Page 11

Licensing 5 Licensing The Twin CAT 3 function can be activated as a full version or as a 7-day test version. Both license types can be activated via the Twin CAT 3 development environment (XAE). Licensing the full version of a Twin CAT 3 Function A description of the procedure to license a full version can be found in the Beckhoff Information System in the documentation "Twin CAT 3 Licensing". Licensing the 7-day test version of a Twin CAT 3 Function A 7-day test version cannot be enabled for a Twin CAT 3 license dongle. 1. Start the Twin CAT 3 development environment (XAE). 2. Open an existing Twin CAT 3 project or create a new project. 3. If you want to activate the license for a remote device, set the desired target system. To do this, select the target system from the Choose Target System drop-down list in the toolbar. ð The licensing settings always refer to the selected target system. When the project is activated on the target system, the corresponding Twin CAT 3 licenses are automatically copied to this system. 4. In the Solution Explorer, double-click License in the SYSTEM subtree. ð The Twin CAT 3 license manager opens. TF5130 Version: 1.3.4 11
## Page 12

Licensing 5. Open the Manage Licenses tab. In the Add License column, check the check box for the license you want to add to your project (e.g. "TF4100 TC3 Controller Toolbox"). 6. Open the Order Information (Runtime) tab. ð In the tabular overview of licenses, the previously selected license is displayed with the status “missing”. 7. Click 7-Day Trial License... to activate the 7-day trial license. ð A dialog box opens, prompting you to enter the security code displayed in the dialog. 8. Enter the code exactly as it is displayed and confirm the entry. 9. Confirm the subsequent dialog, which indicates the successful activation. ð In the tabular overview of licenses, the license status now indicates the expiry date of the license. 12 Version: 1.3.4 TF5130
## Page 13

Licensing 10. Restart the Twin CAT system. ð The 7-day trial version is enabled. TF5130 Version: 1.3.4 13
## Page 14

PLC API 6 PLC API 6.1 Function blocks 6.1.1 Database 6.1.1.1 VAL_Get Bank Size VAL_Get Bank Size Execute BOOL BOOL Busy User Database BOOL BOOL Done Data Type INT BOOL Error Bank ID INT UDINT Error ID ↔ Axes Group T_Staeubli Robot INT Bank Size FUNCTION_BLOCK VAL_Get Bank Size This function block returns the size of the specified bank of data from the selected database. Syntax Definition: FUNCTION_BLOCK VAL_Get Bank Size VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Data Type : INT := 0; Bank ID : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Bank Size : INT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Use user database; False=Use plc database Data Type INT Type of data to resize (1 = point, 2 = joint, 3 = tool, 4 = motion descriptor) Bank ID INT Number of the bank of point to resize. This parameter is effective only when Data Type parameter = 1. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success 14 Version: 1.3.4 TF5130
## Page 15

PLC API Name Type Description Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Bank Size INT Size of the selected bank of data / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.2 VAL_Load Database VAL_Load Database Execute BOOL BOOL Busy Database ID INT BOOL Done ↔ Axes Group T_Staeubli Robot BOOL Error UDINT Error ID FUNCTION_BLOCK VAL_Load Database Load a database identified by the ID given as input parameter. Parameter Name Value Comment Error ID 0 No error [110..142] See VAL3 error code of lib Load instruction Syntax Definition: FUNCTION_BLOCK VAL_Load Database VAR_INPUT Execute : BOOL := FALSE; Database ID : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge starts function execution. Database ID INT Identifier of the database to be loaded. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success TF5130 Version: 1.3.4 15
## Page 16

PLC API Name Type Description Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.3 VAL_Move VAL_Move Execute BOOL BOOL Busy User Database BOOL BOOL Done Joint Position BOOL BOOL Error Interpolate J BOOL UDINT Error ID Enable Blending BOOL INT Movement ID Bank ID INT First Point Idx INT Last Point Idx INT Tool Idx INT Mdesc Idx INT ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Move This function block allows to command a motion to the specified end position located inside a database on robot side. When First Point Idx and Last Point Idx parameters are different, the robot will move along the path defined by the points located in the bank between these 2 indexes. If Last Point Idx is not specified or equal to First Point Idx, the function block command a single movement to the point index defined by First Point Idx parameter. Example: One supposes that there are 6 points defined in the bank number 2 of a database If First Point Idx is equal 0 and Last Point Idx is equal 4, the robot will move along a path defined by the points with indexes 0-1-2-3-4 If First Point Idx is equal 5 and Last Point Idx is equal 0, the robot will move along a path defined by the points with indexes 5-4-3-2-1-0 Syntax Definition: FUNCTION_BLOCK VAL_Move VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Joint Position : BOOL := FALSE; Interpolate J : BOOL := FALSE; Enable Blending : BOOL := FALSE; Bank ID : INT := -1; First Point Idx : INT := -1; Last Point Idx : INT := -1; Tool Idx : INT := -1; Mdesc Idx : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; 16 Version: 1.3.4 TF5130
## Page 17

PLC API END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Use user database; False=Use plc database Joint Position BOOL True=move to joint position; False= move to a cartesian position Interpolate J BOOL True=Joint interpolated movement; False=Linear movement Enable Blending BOOL True=use blending parameter of motion descriptor; False= robot stops at destination. Bank ID INT Number of the bank in which the point is located. Relevant only when moving on Cartesian position First Point Idx INT Index of the first Joint or Point data in the selected bank Last Point Idx INT Index of the last Joint or Point data in the selected bank. Tool Idx INT Index of the tool position in the bank Mdesc Idx INT Index of the motion descriptor in the bank. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot TF5130 Version: 1.3.4 17
## Page 18

PLC API 6.1.1.4 VAL_Move Relative VAL_Move Relative Execute BOOL BOOL Busy Interpolate J BOOL BOOL Done Enable Blending BOOL BOOL Error User Database BOOL UDINT Error ID Bank ID INT INT Movement ID Point Idx INT Tool Idx INT Mdesc Idx INT Offsets T_Trsf Shift In Frame BOOL Uframe INT ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Move Relative This function block allows to commands a movement to a position calculated with specified offsets from a point located in a bank of a database. The offset might be applied in the following coordinate system: • Tool • User Frame Syntax Definition: FUNCTION_BLOCK VAL_Move Relative VAR_INPUT Execute : BOOL := FALSE; Interpolate J : BOOL := FALSE; Enable Blending : BOOL := FALSE; User Database : BOOL := FALSE; Bank ID : INT := -1; Point Idx : INT := -1; Tool Idx : INT := -1; Mdesc Idx : INT := -1; Offsets : T_Trsf; Shift In Frame : BOOL := FALSE; Uframe : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Interpolate J BOOL True=Joint interpolated movement; False=Linear movement Enable Blending BOOL True=use blending parameter of motion descriptor; False= robot stops at destination. User Database BOOL True=Use user database; False=Use plc database Bank ID INT Number of the bank in which the point is located 18 Version: 1.3.4 TF5130
## Page 19

PLC API Name Type Description Point Idx INT Index of the Point data in the bank Tool Idx INT Index of the Tool in the bank to use for the commanded movement Mdesc Idx INT Index of the motion descriptor in the bank. Offsets T_Trsf [} 80] Relative distances in each dimensions for approaching the end-position. Shift In Frame BOOL True= Offset are applied in user frame. False= Offset are applied in Tool (default) Uframe INT Index of the user frame in which offsets are applied. This parameter is effective when parameter Shift In Frame is True. If not specified, the offsets are applied in the user frame associated to the specified bank ID Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.5 VAL_Movec VAL_Movec Execute BOOL BOOL Busy User Database BOOL BOOL Done Enable Blending BOOL BOOL Error Bank ID INT UDINT Error ID Intermediate Point Idx INT INT Movement ID Target Point Idx INT Tool Idx INT Mdesc Idx INT ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Movec This function commands a circular interpolated movement to a point located inside a database on robot side. Syntax Definition: FUNCTION_BLOCK VAL_Movec VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Enable Blending : BOOL := FALSE; TF5130 Version: 1.3.4 19
## Page 20

PLC API Bank ID : INT := -1; Intermediate Point Idx : INT := -1; Target Point Idx : INT := -1; Tool Idx : INT := -1; Mdesc Idx : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL // Rising edge starts function execution User Database BOOL True=Data of the user database will be used Enable Blending BOOL True=use blending parameter of motion descriptor; False= robot stops at destination. Bank ID INT Number of the bank in which the point is located. Relevant only when moving on Cartesian position Intermediate Point Idx INT Intermediate point passing during the movement Target Point Idx INT Target point of the circle Tool Idx INT Index of the tool position in the bank Mdesc Idx INT Index of the motion descriptor in the bank. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.6 VAL_Position VAL_Position Execute BOOL BOOL Busy User Database BOOL BOOL Done Bank ID INT BOOL Error Point Idx INT UDINT Error ID Bank IDDest INT T_Cartesian Pos Position Dest ↔ Axes Group T_Staeubli Robot 20 Version: 1.3.4 TF5130
## Page 21

PLC API FUNCTION_BLOCK VAL_Position This function block returns the coordinates of the position in the user frame associated with the destination Bank ID Syntax Definition: FUNCTION_BLOCK VAL_Position VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Bank ID : INT := -1; Point Idx : INT := -1; Bank IDDest : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Position Dest : T_Cartesian Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Bank ID INT Number of the bank in which the point is located. Point Idx INT Index of the point in the bank Bank IDDest INT Number of the bank in which the coordinates of the position are calculated Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Position Dest T_Cartesian Pos [} 76] New Position in the destination coordsystem / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot TF5130 Version: 1.3.4 21
## Page 22

PLC API 6.1.1.7 VAL_Read Frame VAL_Read Frame Execute BOOL BOOL Busy User Database BOOL BOOL Done Bank ID INT BOOL Error ↔ Axes Group T_Staeubli Robot UDINT Error ID T_Trsf Frame Value FUNCTION_BLOCK VAL_Read Frame This function block returns the value of the user frame associated to a bank of point. Syntax Definition: FUNCTION_BLOCK VAL_Read Frame VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Bank ID : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Frame Value : T_Trsf; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True= Data of the user database will be used Bank ID INT Number of the bank for which coordinate system (frame) is returned. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Frame Value T_Trsf [} 80] Coordinates of the requested user frame / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 22 Version: 1.3.4 TF5130
## Page 23

PLC API 6.1.1.8 VAL_Read Joint VAL_Read Joint Execute BOOL BOOL Busy User Database BOOL BOOL Done Joint Idx INT BOOL Error ↔ Axes Group T_Staeubli Robot UDINT Error ID T_Joint Pos Joint Value FUNCTION_BLOCK VAL_Read Joint This function block returns the coordinates of a joint position in the selected database. Syntax Definition: FUNCTION_BLOCK VAL_Read Joint VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Joint Idx : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Joint Value : T_Joint Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Joint Idx INT Index of the joint variable in the bank Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Joint Value T_Joint Pos [} 77] Coordinates of joint position / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot TF5130 Version: 1.3.4 23
## Page 24

PLC API 6.1.1.9 VAL_Read Mdesc VAL_Read Mdesc Execute BOOL BOOL Busy User Database BOOL BOOL Done Mdesc Idx INT BOOL Error ↔ Axes Group T_Staeubli Robot UDINT Error ID T_Mdesc Mdesc Value FUNCTION_BLOCK VAL_Read Mdesc This function returns the current value of a motion descriptor in the selected database. Syntax Definition: FUNCTION_BLOCK VAL_Read Mdesc VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Mdesc Idx : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Mdesc Value : T_Mdesc; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Mdesc Idx INT Index of the motion descriptor in the bank Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Mdesc Value T_Mdesc [} 77] Values for the motion descriptor / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 24 Version: 1.3.4 TF5130
## Page 25

PLC API 6.1.1.10 VAL_Read Point VAL_Read Point Execute BOOL BOOL Busy User Database BOOL BOOL Done Bank ID INT BOOL Error Point Idx INT UDINT Error ID ↔ Axes Group T_Staeubli Robot T_Cartesian Pos Point Value FUNCTION_BLOCK VAL_Read Point This function returns the coordinates of a cartesian point located in a bank of a the database. Syntax Definition: FUNCTION_BLOCK VAL_Read Point VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Bank ID : INT := -1; Point Idx : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Point Value : T_Cartesian Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Bank ID INT Number of the bank in which the point is located. Point Idx INT Index of the point in the bank Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Point Value T_Cartesian Pos [} 76] Coordinates of the requested point / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot TF5130 Version: 1.3.4 25
## Page 26

PLC API 6.1.1.11 VAL_Read Tool VAL_Read Tool Execute BOOL BOOL Busy User Database BOOL BOOL Done Tool Idx INT BOOL Error ↔ Axes Group T_Staeubli Robot UDINT Error ID T_Trsf Tool Value FUNCTION_BLOCK VAL_Read Tool This function block returns the coordinates of a Tool Center Point located in a database. Syntax Definition: FUNCTION_BLOCK VAL_Read Tool VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Tool Idx : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Tool Value : T_Trsf; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Tool Idx INT Index of the Tool in the bank of tool located in the database Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Tool Value T_Trsf [} 80] Coordinates of the requested Tool / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 26 Version: 1.3.4 TF5130
## Page 27

PLC API 6.1.1.12 VAL_Set Bank Size VAL_Set Bank Size Execute BOOL BOOL Busy User Database BOOL BOOL Done Data Type INT BOOL Error Data Size INT UDINT Error ID Bank ID INT ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Set Bank Size This function blocks resizes the bank of the specified type in user or plc database Syntax Definition: FUNCTION_BLOCK VAL_Set Bank Size VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Data Type : INT := 0; Data Size : INT := 0; Bank ID : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Use user database; False=Use plc database Data Type INT Type of data to resize (1 = point, 2 = joint, 3 = tool, 4 = motion descriptor) Data Size INT New size for the selected bank Bank ID INT Number of the bank of point to resize. This parameter is effective only when Data Type parameter = 1. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code TF5130 Version: 1.3.4 27
## Page 28

PLC API / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.13 VAL_Write Frame VAL_Write Frame Execute BOOL BOOL Busy User Database BOOL BOOL Done Bank ID INT BOOL Error Frame X REAL UDINT Error ID Frame Y REAL Frame Z REAL Frame RX REAL Frame RY REAL Frame RZ REAL Save On Disk BOOL ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Write Frame This function writes the coordinates of a user frame associated to a bank of point located in a database. Syntax Definition: FUNCTION_BLOCK VAL_Write Frame VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Bank ID : INT := -1; Frame X : REAL := 0; Frame Y : REAL := 0; Frame Z : REAL := 0; Frame RX : REAL := 0; Frame RY : REAL := 0; Frame RZ : REAL := 0; Save On Disk : BOOL := TRUE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Bank ID INT Number of the bank for which user frame is returned. Frame X REAL Value for X coordinate Frame Y REAL Value for Y coordinate Frame Z REAL Value for Z coordinate Frame RX REAL Value for RX coordinate Frame RY REAL Value for RY coordinate 28 Version: 1.3.4 TF5130
## Page 29

PLC API Name Type Description Frame RZ REAL Value for RZ coordinate Save On Disk BOOL True=Tool data stored onto the controller's flashdisk. False=Data not stored--> faster FB execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.14 VAL_Write Joint VAL_Write Joint Execute BOOL BOOL Busy User Database BOOL BOOL Done Joint Idx INT BOOL Error Joint1 REAL UDINT Error ID Joint2 REAL Joint3 REAL Joint4 REAL Joint5 REAL Joint6 REAL Save On Disk BOOL ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Write Joint This function block allows to initialize a joint position inside a database Syntax Definition: FUNCTION_BLOCK VAL_Write Joint VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Joint Idx : INT := -1; Joint1 : REAL := 0; Joint2 : REAL := 0; Joint3 : REAL := 0; Joint4 : REAL := 0; Joint5 : REAL := 0; Joint6 : REAL := 0; Save On Disk : BOOL := TRUE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; TF5130 Version: 1.3.4 29
## Page 30

PLC API END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used; False= Use data of the plc database Joint Idx INT Index of the joint position in the bank Joint1 REAL Coordinate for axis 1 Joint2 REAL Coordinate for axis 2 Joint3 REAL Coordinate for axis 3 Joint4 REAL Coordinate for axis 4 Joint5 REAL Coordinate for axis 5 - not applicable for 4 axis robots- Joint6 REAL Coordinate for axis 6 - not applicable for 4 axis robots- Save On Disk BOOL True=Tool data stored onto the controller's flashdisk. False=Data not stored--> faster FB execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.15 VAL_Write Mdesc VAL_Write Mdesc Execute BOOL BOOL Busy User Database BOOL BOOL Done Mdesc Idx INT BOOL Error Acceleration INT UDINT Error ID Velocity INT Deceleration INT Tvel REAL Rvel REAL Blend Leave REAL Blend Reach REAL Blend Type INT ↔ Axes Group T_Staeubli Robot 30 Version: 1.3.4 TF5130
## Page 31

PLC API FUNCTION_BLOCK VAL_Write Mdesc This function block allows to set the properties of a motion descriptor located in a database. The following picture describes the definition of blending distances Syntax Definition: FUNCTION_BLOCK VAL_Write Mdesc VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Mdesc Idx : INT := -1; Acceleration : INT := 100; Velocity : INT := 100; Deceleration : INT := 100; Tvel : REAL := 99999; Rvel : REAL := 99999; Blend Leave : REAL := 10; Blend Reach : REAL := 10; Blend Type : INT := 0; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Mdesc Idx INT Index of the motion descriptor in the bank. Acceleration INT Joint acceleration. Percentage of the nominal acceleration of the robot Velocity INT Joint velocity. Percentage of the nominal speed of the robot Deceleration INT Joint deceleration. Percentage of the nominal deceleration of the robot Tvel REAL Maximum cartesian velocity (mm/sec or inches/sec). Unit depends on settings on robot controller Rvel REAL Maximum rotational velocity (mm/sec or inches/sec). Unit depends on settings on robot controller TF5130 Version: 1.3.4 31
## Page 32

PLC API Name Type Description Blend Leave REAL Distance from the destination point at which the nominal trajectory is left Blend Reach REAL Distance from the destination point at which the nominal trajectory is joined again. Blend Type INT 1=Off; 2=Joint; 3=Cartesian Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.1.16 VAL_Write Point VAL_Write Point Execute BOOL BOOL Busy User Database BOOL BOOL Done Bank ID INT BOOL Error Point Idx INT UDINT Error ID Point X REAL Point Y REAL Point Z REAL Point RX REAL Point RY REAL Point RZ REAL Point CS UINT Point CE UINT Point CW UINT Save On Disk BOOL ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Write Point This function block allows to modify the coordinates of a cartesian position located in a database. Syntax Definition: FUNCTION_BLOCK VAL_Write Point VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Bank ID : INT := -1; Point Idx : INT := -1; Point X : REAL := 0; Point Y : REAL := 0; Point Z : REAL := 0; 32 Version: 1.3.4 TF5130
## Page 33

PLC API Point RX : REAL := 0; Point RY : REAL := 0; Point RZ : REAL := 0; Point CS : UINT := 2; Point CE : UINT := 2; Point CW : UINT := 2; Save On Disk : BOOL := TRUE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Bank ID INT Number of the bank in which the point is located. Point Idx INT Index of the cartesian point in the bank Point X REAL Value for X coordinate Point Y REAL Value for Y coordinate Point Z REAL Value for Z coordinate Point RX REAL Value for RX coordinate Point RY REAL Value for RY coordinate Point RZ REAL Value for RZ coordinate Point CS UINT Value for shoulder configuration (1=> sfree; 2=> ssame; 3=> righty; 4=> lefty) Point CE UINT Value for elbow configuration (1=> sfree; 2=> ssame; 3=> epositive; 4=> enegative) Point CW UINT Value for wrist configuration (1=> sfree; 2=> ssame; 3=> wpositive; 4=> wnegative) Save On Disk BOOL True=Tool data stored onto the controller's flashdisk. False=Data not stored--> faster FB execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot TF5130 Version: 1.3.4 33
## Page 34

PLC API 6.1.1.17 VAL_Write Tool VAL_Write Tool Execute BOOL BOOL Busy User Database BOOL BOOL Done Tool Idx INT BOOL Error Tool X REAL UDINT Error ID Tool Y REAL Tool Z REAL Tool RX REAL Tool RY REAL Tool RZ REAL Save On Disk BOOL ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Write Tool This function block allows to modify the coordinates of a tool located in a database. Syntax Definition: FUNCTION_BLOCK VAL_Write Tool VAR_INPUT Execute : BOOL := FALSE; User Database : BOOL := FALSE; Tool Idx : INT := -1; Tool X : REAL := 0; Tool Y : REAL := 0; Tool Z : REAL := 0; Tool RX : REAL := 0; Tool RY : REAL := 0; Tool RZ : REAL := 0; Save On Disk : BOOL := TRUE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution User Database BOOL True=Data of the user database will be used Tool Idx INT Index of the tool position in the bank Tool X REAL Value for X coordinate Tool Y REAL Value for Y coordinate Tool Z REAL Value for Z coordinate Tool RX REAL Value for RX coordinate Tool RY REAL Value for RY coordinate Tool RZ REAL Value for RZ coordinate Save On Disk BOOL True=Tool data stored onto the controller's flashdisk. False=Data not stored--> faster FB execution 34 Version: 1.3.4 TF5130
## Page 35

PLC API Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.2 Internal The item listed in this folder are for internal use only. The functions / function blocs are not intended to be called by user application 6.1.2.1 FB_Transfer Data FB_Transfer Data Execute BOOL BOOL Busy Server ID UINT BOOL Done Function Code UINT BOOL Error i Bit Param ARRAY [0.. GV.ui BITPARAM_MAX_OUT] OF BOOL UDINT Error ID i Word Param ARRAY [0.. GV.ui WORDPARAM_MAX_OUT] OF INT ARRAY [0.. GV.ui BITPARAM_MAX_IN] OF BOOL o Bit Param i Float Param ARRAY [0.. GV.ui FLOATPARAM_MAX_OUT] OF REAL ARRAY [0.. GV.ui WORDPARAM_MAX_IN] OF INT o Word Param ↔ Axes Group T_Staeubli Robot ARRAY [0.. GV.ui FLOATPARAM_MAX_IN] OF REAL o Float Param FUNCTION_BLOCK FB_Transfer Data This function block manages the communication with uni VAL plc server installed on the robot side Syntax Definition: FUNCTION_BLOCK FB_Transfer Data VAR_INPUT Execute : BOOL := FALSE; Server ID : UINT := 0; Function Code : UINT := 0; i Bit Param : ARRAY [0.. GV.ui BITPARAM_MAX_OUT] OF BOOL; i Word Param : ARRAY [0.. GV.ui WORDPARAM_MAX_OUT] OF INT; i Float Param : ARRAY [0.. GV.ui FLOATPARAM_MAX_OUT] OF REAL; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; o Bit Param : ARRAY [0.. GV.ui BITPARAM_MAX_IN] OF BOOL; o Word Param : ARRAY [0.. GV.ui WORDPARAM_MAX_IN] OF INT; o Float Param : ARRAY [0.. GV.ui FLOATPARAM_MAX_IN] OF REAL; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR TF5130 Version: 1.3.4 35
## Page 36

PLC API Inputs Name Type Description Execute BOOL Rising edge starts function execution Server ID UINT Number of the server to address Function Code UINT Code of the function to address i Bit Param ARRAY [0.. GV.ui BITPARAM_MAX _OUT] OF BOOL i Word Param ARRAY [0.. GV.ui WORDPARAM_ MAX_OUT] OF INT i Float Param ARRAY [0.. GV.ui FLOATPARAM_ MAX_OUT] OF REAL Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code o Bit Param ARRAY [0.. GV.ui BITPARAM_MAX _IN] OF BOOL o Word Param ARRAY [0.. GV.ui WORDPARAM_ MAX_IN] OF INT o Float Param ARRAY [0.. GV.ui FLOATPARAM_ MAX_IN] OF REAL / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.3 MC_Group Continue MC_Group Continue Execute BOOL BOOL Busy ↔ Axes Group T_Staeubli Robot BOOL Done BOOL Error UDINT Error ID FUNCTION_BLOCK MC_Group Continue This function blocks allows to continue the movement that has been previously stopped by the MC_Interrupt function block. 36 Version: 1.3.4 TF5130
## Page 37

PLC API Syntax Definition: FUNCTION_BLOCK MC_Group Continue VAR_INPUT Execute : BOOL := FALSE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge starts function execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.4 MC_Group Interrupt MC_Group Interrupt Execute BOOL BOOL Busy ↔ Axes Group T_Staeubli Robot BOOL Done BOOL Error UDINT Error ID FUNCTION_BLOCK MC_Group Interrupt This function block commands a controlled stop of the robot along the commanded trajectory. The robot power remains enabled. When velocity zero is reached the DONE output set. Unlike MC_Group Stop, all commanded movements are not cancelled, this means the robot can continue its trajectory as soon as MC_Group Continue is executed. At the interrupted FB the output Command Aborted will not be set, Busy is still high and Active is reset. Syntax Definition: FUNCTION_BLOCK MC_Group Interrupt VAR_INPUT Execute : BOOL := FALSE; TF5130 Version: 1.3.4 37
## Page 38

PLC API END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge starts function execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.5 MC_Group Jog MC_Group Jog Enable BOOL BOOL Busy Jog Mode UINT BOOL Error Jog Step REAL UDINT Error ID Jog Value1 INT Jog Value2 INT Jog Value3 INT Jog Value4 INT Jog Value5 INT Jog Value6 INT ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK MC_Group Jog This function block allows to move the robot from a user-supplied teach pendant in manual mode only. • The robot can be moved in speed or in position mode depending on the value of the Jog Step input parameter. • Several axes can be moved simultaneously when their dedicated input are set. • The robot speed still depends on the override value. • If Jog Mode input is Frame(2) or Tool(3) the robot will move along Frame and Tool coordinate systems selected by Staeubli_Robot. Command. Coord System Cmd and Staeubli_Robot. Command. Tool Cmd Examples 38 Version: 1.3.4 TF5130
## Page 39

PLC API • If you set Jog Step value to 0 and Jog Value_xx to 50% and the override value is 10%, the selected axes will move with 5% of the nominal speed. • If you set Jog Step value to 3 and Jog Value_xx to 50%, the selected axes will move: ◦ 1.5 degrees or millimeters when Jog Mode is Joint (1). ◦ 1.5 millimeters in direction X,Y,Z when Jog Mode is Frame(2) or Tool(3). ◦ 1.5 degrees in direction RX,RY,RZ when Jog Mode is Frame(2) or Tool(3). This function is effective only when Stäubli Teach Pendant is removed and replaced by the delivered dummy plug. The controller must be configured to have user-supplied teach pendant in use (file iomap.cfx on controller). Manual operation mode can be selected either from Stäubli Working Mode Selector Box or from user-supplied teach pendant Syntax Definition: FUNCTION_BLOCK MC_Group Jog VAR_INPUT Enable : BOOL := FALSE; Jog Mode : UINT := 0; Jog Step : REAL := 0; Jog Value1 : INT := 0; Jog Value2 : INT := 0; Jog Value3 : INT := 0; Jog Value4 : INT := 0; Jog Value5 : INT := 0; Jog Value6 : INT := 0; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL True= content of the function block is executed Jog Mode UINT Select jog mode. 1=Joint ; 2=Frame ; 3=Tool Jog Step REAL When this value is non zero, the robot is jogged in step mode. When a jog Value is set, the robot moves until the specified distance is reached. The Jog Value shall be reset and set again to trigger the next movement with the specified distance. Jog Value1 INT Commanded speed for Axis1 / X direction [-100%..100%] Jog Value2 INT Commanded speed for Axis2 / Y direction [-100%..100%] Jog Value3 INT Commanded speed for Axis3 / Z direction [-100%..100%] Jog Value4 INT Commanded speed for Axis4 / RX direction [-100%..100%] Jog Value5 INT Commanded speed for Axis5 / RY direction [-100%..100%] Jog Value6 INT Commanded speed for Axis6 / RZ direction [-100%..100%] TF5130 Version: 1.3.4 39
## Page 40

PLC API Outputs Name Type Description Busy BOOL A valid jog command is sent to the robot Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.6 MC_Group Power MC_Group Power Enable BOOL BOOL Status ↔ Axes Group T_Staeubli Robot BOOL Error UDINT Error ID FUNCTION_BLOCK MC_Group Power This function block manages the arm power ON/OFF sequence. Switching arm power ON/OFF is possible only if remote automatic operation mode is selected. The operation mode is selected with the Working Mode Selector box. The arm power ON / arm power OFF sequences on the robot side can take up to 1 second until robot is effectively powered ON/OFF. During that time Enable input and Status output have different values. • Enable=TRUE : Command to switch robot power ON. • Enable=FALSE: Command to switch robot power OFF. If an error occurs, the Enable input must go low and high once again to re-execute the function block. However, the pending error(s) must be acknowledged using the MC_Group Reset function block. When a user-supplied teach pendant is in use, this function block allows to power ON/OFF the robot in any operation mode. Syntax Definition: FUNCTION_BLOCK MC_Group Power VAR_INPUT Enable : BOOL := FALSE; END_VAR VAR_OUTPUT Status : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL TRUE= Command to switch power on ; FALSE= Command to switch power off. 40 Version: 1.3.4 TF5130
## Page 41

PLC API Outputs Name Type Description Status BOOL Effective state of the robot power. Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.7 MC_Group Read Actual Position MC_Group Read Actual Position Enable BOOL BOOL Valid Tool UINT BOOL Busy Coord System UINT BOOL Error ↔ Axes Group T_Staeubli Robot UDINT Error ID T_Cartesian Pos Position FUNCTION_BLOCK MC_Group Read Actual Position This function block provides a convenient way of reading the current position of the selected Tool Center Point in the selected user frame. It shall be noticed that this function block may change briefly the value of the following members of the robot data block T_Staeubli Robot. Command. Tool Cmd T_Staeubli Robot. Command. Coord System Cmd until the position of the robot is effectively read. This may impact your application if it continuously read the position of the robot directly from the robot data block. Syntax Definition: FUNCTION_BLOCK MC_Group Read Actual Position VAR_INPUT Enable : BOOL := FALSE; Tool : UINT := 0; Coord System : UINT := 0; END_VAR VAR_OUTPUT Valid : BOOL := FALSE; Busy : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Position : T_Cartesian Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL TRUE = Enable the execution of the function block Tool UINT Number of the Tool for which position is reported TF5130 Version: 1.3.4 41
## Page 42

PLC API Name Type Description Coord System UINT Number of the user frame in which the position of selected Tool Center Point is reported Outputs Name Type Description Valid BOOL TRUE = A valid set of data are available. Busy BOOL TRUE = function block is proceeding... Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Position T_Cartesian Pos [} 76] Current cartesian position of the selected Tool in the selected user frame / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.8 MC_Group Reset MC_Group Reset Execute BOOL BOOL Busy ↔ Axes Group T_Staeubli Robot BOOL Done BOOL Error UDINT Error ID FUNCTION_BLOCK MC_Group Reset This function blocks allows to reset all pending errors on robot side. Further actions might be executed by the MC_Group Reset function block Telegrams transmitted between PLC and robot controller may end in a deadlock (e.g. one device is restarted during data exchange). In this situation, the function block resets the communication protocol. After this, new telegrams can be exchanged. For CS8C controller ONLY If the state of one dual channel contact in the CS8C E-Stop chain is not consistent, a hardware fault is registered and robot operation is not possible until this hardware fault is repaired, tested, and acknowledged. (See CS8C instruction manual for further details) Once the hardware fault is tested, the MC_Group Reset function block performs the required acknowledgment. Syntax Definition: FUNCTION_BLOCK MC_Group Reset VAR_INPUT Execute : BOOL := FALSE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR 42 Version: 1.3.4 TF5130
## Page 43

PLC API Inputs Name Type Description Execute BOOL Rising edge triggers function execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.9 MC_Group Stop MC_Group Stop Execute BOOL BOOL Busy ↔ Axes Group T_Staeubli Robot BOOL Done BOOL Error UDINT Error ID FUNCTION_BLOCK MC_Group Stop This function block commands a controlled motion stop. Moreover, this function cancels any movement that have been commanded and buffered on robot side. Syntax Definition: FUNCTION_BLOCK MC_Group Stop VAR_INPUT Execute : BOOL := FALSE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge starts function execution TF5130 Version: 1.3.4 43
## Page 44

PLC API Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.10 MC_Move Axis Absolute MC_Move Axis Absolute Execute BOOL BOOL Busy Joint Position T_Joint Pos BOOL Done Velocity REAL BOOL Active Acceleration REAL BOOL Command Transferred Deceleration REAL BOOL Command Aborted Cartesian Vel REAL BOOL Error Rotational Vel REAL UDINT Error ID Buffer Mode e MC_BUFFER_MODE INT Movement ID Transition Mode UINT Transition Param MC_Transition Parameter ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK MC_Move Axis Absolute This function block commands a joint interpolated movement to an end-position. The values specified for the end-position are interpreted as joint values. They represent the position of each axis in degrees. The speed of the robot is calculated with both • Parameters related to axes of the robot (Velocity / Acceleration / Deceleration) • Parameter related to the Tool Center Point (Cartesian Vel / Rotational Vel) The final robot speed is set by the most limiting of these parameters. When the speed of the object, carried by the robot, does not need to be handled with special care, parameters related to Tool Center Point can be ignored (kept to default values). The speed along the trajectory may change depending on the robot position in the space. On the contrary, if a constant speed is required for the Tool Center Point, it shall be set with Cartesian Vel parameter. Example: The speed of the object carried by the robot shall be 100mm/s. Set the Cartesian Vel parameter to 100. However, axes related speed/acceleration parameters are still active. If you set the Velocity parameter too low (e.g 10%), the objet may not reach 100mm/s. Syntax Definition: 44 Version: 1.3.4 TF5130
## Page 45

PLC API FUNCTION_BLOCK MC_Move Axis Absolute VAR_INPUT Execute : BOOL := FALSE; Joint Position : T_Joint Pos; Velocity : REAL := REAL#100; Acceleration : REAL := REAL#100; Deceleration : REAL := REAL#100; Cartesian Vel : REAL := REAL#99999; Rotational Vel : REAL := REAL#99999; Buffer Mode : e MC_BUFFER_MODE := Buffered; Transition Mode : UINT := 0; Transition Param : MC_Transition Parameter; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Active : BOOL := FALSE; Command Transferred : BOOL := FALSE; Command Aborted : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Joint Position T_Joint Pos [} 77] Absolute end position for each axis Velocity REAL Joint velocity. Percentage of the nominal speed of the robot. Range [0.01 .. 500] Acceleration REAL Joint acceleration. Percentage of the nominal acceleration of the robot. Range [0.01 .. 500] Deceleration REAL Joint deceleration. Percentage of the nominal deceleration of the robot. Range [0.01 .. 500] Cartesian Vel REAL Optional: Maximum cartesian velocity at Tool Center Point in mm/s Rotational Vel REAL Optional: Maximum rotational velocity at Tool Center Point in degree/s Buffer Mode e MC_BUFFER_MODE 0 = aborting / 1= buffered / 6-7 = blending [} 83] Transition Mode UINT Defines the profile of the robot trajectory nearby the set points. 0 = None / 3 = Corner distance / 10 = blending distances Transition Param MC_Transition Parameter [} 74] Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Active BOOL Set when commanded movement is currently executed by the robot Command Transferred BOOL Commanded motion is successfully buffered inside robot controler Command Aborted BOOL Command is aborted by another command TF5130 Version: 1.3.4 45
## Page 46

PLC API Name Type Description Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.11 MC_Move Circular Absolute MC_Move Circular Absolute Execute BOOL BOOL Busy Circ Mode INT BOOL Done Aux Point T_Cartesian Pos BOOL Active End Point T_Cartesian Pos BOOL Command Transferred Velocity REAL BOOL Command Aborted Acceleration REAL BOOL Error Deceleration REAL UDINT Error ID Cartesian Vel REAL INT Movement ID Rotational Vel REAL Coord System UINT Tool Number UINT Buffer Mode e MC_BUFFER_MODE Transition Mode UINT Transition Param MC_Transition Parameter ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK MC_Move Circular Absolute This function block commands a circular interpolated movement starting from the actual position of the TCP. The end point as well as the auxiliary point are defined absolutely in the specified coordinate system. The speed of the robot is calculated with both • Parameters related to axes of the robot (Velocity / Acceleration / Deceleration) • Parameter related to the Tool Center Point (Cartesian Vel / Rotational Vel) The final robot speed is set by the most limiting of these parameters. When the speed of the object, carried by the robot, does not need to be handled with special care, parameters related to Tool Center Point can be ignored (kept to default values). The speed along the trajectory may changed depending on the robot position in the space. On the contrary, if a constant speed is required for the Tool Center Point, it shall be set with Cartesian Vel parameter. Example: The speed of the object carried by the robot shall be 100mm/s. Set the Cartesian Vel parameter to 100. However, axes related speed/acceleration parameters are still active. If you set the Velocity parameter too low (e.g 10%), the objet may not reach 100mm/s. Syntax Definition: FUNCTION_BLOCK MC_Move Circular Absolute VAR_INPUT Execute : BOOL := FALSE; Circ Mode : INT := 3; 46 Version: 1.3.4 TF5130
## Page 47

PLC API Aux Point : T_Cartesian Pos; End Point : T_Cartesian Pos; Velocity : REAL := REAL#100; Acceleration : REAL := REAL#100; Deceleration : REAL := REAL#100; Cartesian Vel : REAL := REAL#99999; Rotational Vel : REAL := REAL#99999; Coord System : UINT := 0; Tool Number : UINT := 0; Buffer Mode : e MC_BUFFER_MODE := Buffered; Transition Mode : UINT := 0; Transition Param : MC_Transition Parameter; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Active : BOOL := FALSE; Command Transferred : BOOL := FALSE; Command Aborted : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Circ Mode INT Specifies the meaning of the input signals 'Aux Point' and 'Circ Direction'. Only 'BORDER' mode is supported. Aux Point T_Cartesian Pos [} 76] Coordinates of the intermediate position in the specified coordinate system. End Point T_Cartesian Pos [} 76] Coordinates of the end point in the specified coordinate system. Velocity REAL Joint velocity. Percentage of the nominal speed of the robot. Range [0.01 .. 500] Acceleration REAL Joint acceleration. Percentage of the nominal acceleration of the robot. Range [0.01 .. 500] Deceleration REAL Joint deceleration. Percentage of the nominal deceleration of the robot. Range [0.01 .. 500] Cartesian Vel REAL Optional: Maximum cartesian velocity at Tool Center Point in mm/s Rotational Vel REAL Optional: Maximum rotational velocity at Tool Center Point in degree/s Coord System UINT Number of the coordinate system (located in the database) in which the Aux Point and End Point variables are applicated Tool Number UINT Index of the Tool in the bank that shall be used for the movement. Buffer Mode e MC_BUFFER_MODE 0 = aborting / 1= buffered / 6-7 = blending [} 83] Transition Mode UINT Defines the profile of the robot trajectory nearby the set points. 0 = None / 3 = Corner distance / 10 = blending distances Transition Param MC_Transition Parameter [} 74] TF5130 Version: 1.3.4 47
## Page 48

PLC API Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Active BOOL Set when commanded movement is currently executed by the robot Command Transferred BOOL Commanded motion is successfully buffered inside robot controler Command Aborted BOOL Command is aborted by another command Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.12 MC_Move Direct Absolute MC_Move Direct Absolute Execute BOOL BOOL Busy Position T_Cartesian Pos BOOL Done Velocity REAL BOOL Active Acceleration REAL BOOL Command Transferred Deceleration REAL BOOL Command Aborted Cartesian Vel REAL BOOL Error Rotational Vel REAL UDINT Error ID Coord System UINT INT Movement ID Tool Number UINT Buffer Mode e MC_BUFFER_MODE Transition Mode UINT Transition Param MC_Transition Parameter ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK MC_Move Direct Absolute This function block commands a joint interpolated movement from the current robot position to the specified absolute position in the specified coordinate system. The speed of the robot is calculated with both • Parameters related to axes of the robot (Velocity / Acceleration / Deceleration) • Parameter related to the Tool Center Point (Cartesian Vel / Rotational Vel) The final robot speed is set by the most limiting of these parameters. When the speed of the object, carried by the robot, does not need to be handled with special care, parameters related to Tool Center Point can be ignored (kept to default values). The speed along the trajectory may changed depending on the robot position in the space. On the contrary, if a constant speed is required for the Tool Center Point, it shall be set with Cartesian Vel parameter. 48 Version: 1.3.4 TF5130
## Page 49

PLC API Example: The speed of the object carried by the robot shall be 100mm/s. Set the Cartesian Vel parameter to 100. However, axes related speed/acceleration parameters are still active. If you set the Velocity parameter too low (e.g 10%), the objet may not reach 100mm/s. Syntax Definition: FUNCTION_BLOCK MC_Move Direct Absolute VAR_INPUT Execute : BOOL := FALSE; Position : T_Cartesian Pos; Velocity : REAL := REAL#100; Acceleration : REAL := REAL#100; Deceleration : REAL := REAL#100; Cartesian Vel : REAL := REAL#99999; Rotational Vel : REAL := REAL#99999; Coord System : UINT := 0; Tool Number : UINT := 0; Buffer Mode : e MC_BUFFER_MODE := Buffered; Transition Mode : UINT := 0; Transition Param : MC_Transition Parameter; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Active : BOOL := FALSE; Command Transferred : BOOL := FALSE; Command Aborted : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Position T_Cartesian Pos [} 76] Absolute end positions for each dimension in the specified coordinate system. Velocity REAL Joint velocity. Percentage of the nominal speed of the robot. Range [0.01 .. 500] Acceleration REAL Joint acceleration. Percentage of the nominal acceleration of the robot. Range [0.01 .. 500] Deceleration REAL Joint deceleration. Percentage of the nominal deceleration of the robot. Range [0.01 .. 500] Cartesian Vel REAL Optional: Maximum cartesian velocity at Tool Center Point in mm/s Rotational Vel REAL Optional: Maximum rotational velocity at Tool Center Point in degree/s Coord System UINT Number of the coordinate system (located in a database on robot side) in which the Position input parameter is applicated Tool Number UINT Index of the Tool Center Point (located in a database on robot side) that shall be used for the movement. Buffer Mode e MC_BUFFER_MODE 0 = aborting / 1= buffered / 6-7 = blending [} 83] Transition Mode UINT Defines the profile of the robot trajectory nearby the set points. 0 = None / 3 = Corner distance / 10 = blending distances TF5130 Version: 1.3.4 49
## Page 50

PLC API Name Type Description Transition Param MC_Transition Parameter [} 74] Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Active BOOL Set when commanded movement is currently executed by the robot Command Transferred BOOL Commanded motion is successfully buffered inside robot controler Command Aborted BOOL Command is aborted by another command Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.13 MC_Move Linear Absolute MC_Move Linear Absolute Execute BOOL BOOL Busy Position T_Cartesian Pos BOOL Done Velocity REAL BOOL Active Acceleration REAL BOOL Command Transferred Deceleration REAL BOOL Command Aborted Cartesian Vel REAL BOOL Error Rotational Vel REAL UDINT Error ID Coord System UINT INT Movement ID Tool Number UINT Buffer Mode e MC_BUFFER_MODE Transition Mode UINT Transition Param MC_Transition Parameter ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK MC_Move Linear Absolute This function block commands a linear interpolated movement from the current robot position to the specified absolute position in the specified coordinate system. The speed of the robot is calculated with both • Parameters related to axes of the robot (Velocity / Acceleration / Deceleration) • Parameter related to the Tool Center Point (Cartesian Vel / Rotational Vel) 50 Version: 1.3.4 TF5130
## Page 51

PLC API The final robot speed is set by the most limiting of these parameters. When the speed of the object, carried by the robot, does not need to be handled with special care, parameters related to Tool Center Point can be ignored (kept to default values). The speed along the trajectory may changed depending on the robot position in the space. On the contrary, if a constant speed is required for the Tool Center Point, it shall be set with Cartesian Vel parameter. Example: The speed of the object carried by the robot shall be 100mm/s. Set the Cartesian Vel parameter to 100. However, axes related speed/acceleration parameters are still active. If you set the Velocity parameter too low (e.g 10%), the objet may not reach 100mm/s. Syntax Definition: FUNCTION_BLOCK MC_Move Linear Absolute VAR_INPUT Execute : BOOL := FALSE; Position : T_Cartesian Pos; Velocity : REAL := REAL#100; Acceleration : REAL := REAL#100; Deceleration : REAL := REAL#100; Cartesian Vel : REAL := REAL#99999; Rotational Vel : REAL := REAL#99999; Coord System : UINT := 0; Tool Number : UINT := 0; Buffer Mode : e MC_BUFFER_MODE := Buffered; Transition Mode : UINT := 0; Transition Param : MC_Transition Parameter; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Active : BOOL := FALSE; Command Transferred : BOOL := FALSE; Command Aborted : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Position T_Cartesian Pos [} 76] Absolute end positions for each dimension in the specified coordinate system. Velocity REAL Joint velocity. Percentage of the nominal speed of the robot. Range [0.01 .. 500] Acceleration REAL Joint acceleration. Percentage of the nominal acceleration of the robot. Range [0.01 .. 500] Deceleration REAL Joint deceleration. Percentage of the nominal deceleration of the robot. Range [0.01 .. 500] Cartesian Vel REAL Optional: Maximum cartesian velocity at Tool Center Point in mm/s Rotational Vel REAL Optional: Maximum rotational velocity at Tool Center Point in degree/s Coord System UINT Number of the coordinate system (located in a database on robot side) in which the Position input parameter is applicated TF5130 Version: 1.3.4 51
## Page 52

PLC API Name Type Description Tool Number UINT Index of the Tool in the bank that shall be used for the movement. Buffer Mode e MC_BUFFER_MODE 0 = aborting / 1= buffered / 6-7 = blending [} 83] Transition Mode UINT Defines the profile of the robot trajectory nearby the set points. 0 = None / 3 = Corner distance / 10 = blending distances Transition Param MC_Transition Parameter [} 74] Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Active BOOL Set when commanded movement is currently executed by the robot Command Transferred BOOL Commanded motion is successfully buffered inside robot controler Command Aborted BOOL Command is aborted by another command Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.14 VAL_Compute Frame VAL_Compute Frame Execute BOOL BOOL Busy Coord System INT BOOL Done Origin T_Cartesian Pos BOOL Error Xdirection T_Cartesian Pos UDINT Error ID Ydirection T_Cartesian Pos T_Trsf Uframe Data ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Compute Frame This functions blocks computes the coordinates of a the user frame associated to a bank of cartesian point in the plc database. A user frame is computed with 3 cartesian positions that shall be taught as shown below. To achieve maximal accuracy, it is recommend to teach Ox vector along the longest side of the object for which a user frame will be defined. 52 Version: 1.3.4 TF5130
## Page 53

PLC API Fig. 1: Frame definition with 3 points Syntax Definition: FUNCTION_BLOCK VAL_Compute Frame VAR_INPUT Execute : BOOL := FALSE; Coord System : INT := -1; Origin : T_Cartesian Pos; Xdirection : T_Cartesian Pos; Ydirection : T_Cartesian Pos; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Uframe Data : T_Trsf; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Coord System INT Number of the user frame to compute. The user frame is stored in the plc database located on robot side. Origin T_Cartesian Pos [} 76] Coordinates of the origin of the user frame Xdirection T_Cartesian Pos [} 76] Coordinates of the point defining Ox direction Ydirection T_Cartesian Pos [} 76] Coordinates of the point defining Oxy plane of the user frame. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Uframe Data T_Trsf [} 80] Coordinates of the computed user frame TF5130 Version: 1.3.4 53
## Page 54

PLC API / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.15 VAL_Get Forward Transformation VAL_Get Forward Transformation Execute BOOL BOOL Busy Joint Position T_Joint Pos BOOL Done Tool Number UINT BOOL Error Coord System UINT UDINT Error ID ↔ Axes Group T_Staeubli Robot T_Cartesian Pos Cartesian Pos FUNCTION_BLOCK VAL_Get Forward Transformation This functions blocks converts a joint position into a cartesian position. Syntax Definition: FUNCTION_BLOCK VAL_Get Forward Transformation VAR_INPUT Execute : BOOL := FALSE; Joint Position : T_Joint Pos; Tool Number : UINT := 0; Coord System : UINT := 0; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Cartesian Pos : T_Cartesian Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Joint Position T_Joint Pos [} 77] Position of each axis. Tool Number UINT Number of the Tool Center Point for which the cartesian position shall be returned. The Tool Center Point is located in a plc dedicated database on robot side Coord System UINT Number of the user frame in which the cartesian position is returned. The user frame is stored in a plc dedicated database located on robot side. Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success 54 Version: 1.3.4 TF5130
## Page 55

PLC API Name Type Description Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Cartesian Pos T_Cartesian Pos [} 76] Coordinates of the computed position / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.16 VAL_Get Inverse Transformation VAL_Get Inverse Transformation Execute BOOL BOOL Busy Position T_Cartesian Pos BOOL Done Tool Number UINT BOOL Error Coord System UINT UDINT Error ID Joint Reference T_Joint Pos T_Joint Pos Joint Pos ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Get Inverse Transformation This functions blocks converts a cartesian position into a joint position. The computed joint position is computed with following rules: • If configuration fields of the cartesian position (CS CE CW) is 1, robot's final configuration is not easily predictable. For this reason, it is not recommended to have CS CE or CW set to 1. • If configuration fields of the cartesian position (CS CE CW) is 2, robot's final configuration is the same than this defined by Joint Reference parameter. • If configuration fields of the cartesian position (CS CE CW) are 3 or 4, robot's final configuration is this of Cartesian input position. Syntax Definition: FUNCTION_BLOCK VAL_Get Inverse Transformation VAR_INPUT Execute : BOOL := FALSE; Position : T_Cartesian Pos; Tool Number : UINT := 0; Coord System : UINT := 0; Joint Reference : T_Joint Pos; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Joint Pos : T_Joint Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Position T_Cartesian Pos [} 76] Cartesian position to convert into a joint position TF5130 Version: 1.3.4 55
## Page 56

PLC API Name Type Description Tool Number UINT Number of the Tool Center Point used for the computation. The Tool Center Point is located in a plc dedicated database on robot side Coord System UINT Number of the user frame to which the cartesian position relates. The user frame is stored in a plc dedicated database located on robot side. Joint Reference T_Joint Pos [} 77] Joint position used as a reference if configuration fields of input position are 1 or 2 Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Joint Pos T_Joint Pos [} 77] Coordinates of the computed joint position / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.17 VAL_Get Motor Temperature VAL_Get Motor Temperature Execute BOOL BOOL Busy ↔ Axes Group T_Staeubli Robot BOOL Done BOOL Error UDINT Error ID REAL Motor Temp1 REAL Motor Temp2 REAL Motor Temp3 REAL Motor Temp4 REAL Motor Temp5 REAL Motor Temp6 FUNCTION_BLOCK VAL_Get Motor Temperature This function block returns the temperature of each motor of the robot. This function is available for CS9 controller ONLY. The parameter Error ID shows the axes for which the temperature could not be gathered and shall be interpreted as a bitfield: Bit No Description 0 Temperature motor 1 could not be gathered 1 Temperature motor 2 could not be gathered 2 Temperature motor 3 could not be gathered 3 Temperature motor 4 could not be gathered 4 Temperature motor 5 could not be gathered 56 Version: 1.3.4 TF5130
## Page 57

PLC API Bit No Description 5 Temperature motor 6 could not be gathered Syntax Definition: FUNCTION_BLOCK VAL_Get Motor Temperature VAR_INPUT Execute : BOOL := FALSE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Motor Temp1 : REAL := 0; Motor Temp2 : REAL := 0; Motor Temp3 : REAL := 0; Motor Temp4 : REAL := 0; Motor Temp5 : REAL := 0; Motor Temp6 : REAL := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Motor Temp1 REAL Temperature of motor 1 Motor Temp2 REAL Temperature of motor 2 Motor Temp3 REAL Temperature of motor 3 Motor Temp4 REAL Temperature of motor 4 Motor Temp5 REAL Temperature of motor 5 - Not applicable for 4 axis robots Motor Temp6 REAL Temperature of motor 6 - Not applicable for 4 axis robots / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot TF5130 Version: 1.3.4 57
## Page 58

PLC API 6.1.18 VAL_Move Safe Reference VAL_Move Safe Reference Execute BOOL BOOL Busy Index UINT BOOL Done Velocity REAL BOOL Active Acceleration REAL BOOL Command Transferred Deceleration REAL BOOL Command Aborted ↔ Axes Group T_Staeubli Robot BOOL Error UDINT Error ID INT Movement ID FUNCTION_BLOCK VAL_Move Safe Reference Applicable for CS9 controller only This function block commands a joint interpolated movement to an end-position. The values specified for the end-position are interpreted as joint values. They represent the position of each axis in degrees. Syntax Definition: FUNCTION_BLOCK VAL_Move Safe Reference VAR_INPUT Execute : BOOL := FALSE; Index : UINT; Velocity : REAL := REAL#100; Acceleration : REAL := REAL#100; Deceleration : REAL := REAL#100; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Active : BOOL := FALSE; Command Transferred : BOOL := FALSE; Command Aborted : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Movement ID : INT := -1; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution Index UINT Number of the safe position to reach Velocity REAL Joint velocity. Percentage of the nominal speed of the robot Acceleration REAL Joint acceleration. Percentage of the nominal acceleration of the robot Deceleration REAL Joint deceleration. Percentage of the nominal deceleration of the robot 58 Version: 1.3.4 TF5130
## Page 59

PLC API Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Active BOOL Set when commanded movement is currently executed by the robot Command Transferred BOOL Commanded motion is successfully buffered inside robot controler Command Aborted BOOL Command is aborted by another command Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Movement ID INT Identifier for this commanded movement / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.19 VAL_Read Axes Group VAL_Read Axes Group Enable BOOL BOOL Error Input Address POINTER TO T_From Robot UDINT Error ID ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Read Axes Group This function block initializes the values of the interface data block by reading the inputs of the communication interface. It provides the data for the other blocks of the library. It must be called as the first network of a robot’s program. Syntax Definition: FUNCTION_BLOCK VAL_Read Axes Group VAR_INPUT Enable : BOOL := FALSE; Input Address : POINTER TO T_From Robot; END_VAR VAR_OUTPUT Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL TRUE = Content of the FB is executed TF5130 Version: 1.3.4 59
## Page 60

PLC API Name Type Description Input Address POINTER TO Base address of the Inputs within the IO interface T_From Robot [} 74] with a robot. Use 'ADR' operator for setting this input of the function block. Typical syntax is ADR(%IWxx) where xx depends on the hardware configuration of the PLC. Outputs Name Type Description Error BOOL Error flag Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.20 VAL_Read Safe Reference VAL_Read Safe Reference Execute BOOL BOOL Busy Index INT BOOL Done ↔ Axes Group T_Staeubli Robot BOOL Error UDINT Error ID T_Joint Pos Safe Reference FUNCTION_BLOCK VAL_Read Safe Reference Applicable for CS9 controller only This function block returns the coordinates of a the safe reference position. For futher details about CS9 safety features, please consult 'CS9 Safety Manual' Syntax Definition: FUNCTION_BLOCK VAL_Read Safe Reference VAR_INPUT Execute : BOOL := FALSE; Index : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Safe Reference : T_Joint Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution 60 Version: 1.3.4 TF5130
## Page 61

PLC API Name Type Description Index INT Number of the safe reference. Range [1..2] Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Safe Reference T_Joint Pos [} 77] Coordinates of the selected safe reference position / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.21 VAL_Read Write Arm IO VAL_Read Write Arm IO Enable BOOL BOOL Valid Dout0 BOOL BOOL Din0 Dout1 BOOL BOOL Din1 Dout2 BOOL BOOL Din2 Dout3 BOOL BOOL Din3 Dout4 BOOL BOOL Din4 Dout5 BOOL BOOL Din5 Dout6 BOOL BOOL Din6 Dout7 BOOL BOOL Din7 Aout0 INT INT Ain0 Aout1 INT INT Ain1 Aout2 INT INT Ain2 Aout3 INT INT Ain3 ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Read Write Arm IO Syntax Definition: FUNCTION_BLOCK VAL_Read Write Arm IO VAR_INPUT Enable : BOOL := FALSE; Dout0 : BOOL := FALSE; Dout1 : BOOL := FALSE; Dout2 : BOOL := FALSE; Dout3 : BOOL := FALSE; Dout4 : BOOL := FALSE; Dout5 : BOOL := FALSE; Dout6 : BOOL := FALSE; Dout7 : BOOL := FALSE; Aout0 : INT := 0; Aout1 : INT := 0; Aout2 : INT := 0; Aout3 : INT := 0; END_VAR VAR_OUTPUT TF5130 Version: 1.3.4 61
## Page 62

PLC API Valid : BOOL := FALSE; Din0 : BOOL := FALSE; Din1 : BOOL := FALSE; Din2 : BOOL := FALSE; Din3 : BOOL := FALSE; Din4 : BOOL := FALSE; Din5 : BOOL := FALSE; Din6 : BOOL := FALSE; Din7 : BOOL := FALSE; Ain0 : INT := 0; Ain1 : INT := 0; Ain2 : INT := 0; Ain3 : INT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL Function block content is executed as long as this input is set TRUE Dout0 BOOL Command state of digital output channel 0 of the Arm IO board Dout1 BOOL Command state of digital output channel 1 of the Arm IO board Dout2 BOOL Command state of digital output channel 2 of the Arm IO board Dout3 BOOL Command state of digital output channel 3 of the Arm IO board Dout4 BOOL Command state of digital output channel 4 of the Arm IO board Dout5 BOOL Command state of digital output channel 5 of the Arm IO board Dout6 BOOL Command state of digital output channel 6 of the Arm IO board Dout7 BOOL Command state of digital output channel 7 of the Arm IO board Aout0 INT Command state of analog output channel 0 of the arm IO board. Unit is millivolt Aout1 INT Command state of analog output channel 1 of the arm IO board. Unit is millivolt Aout2 INT Command state of analog output channel 2 of the arm IO board. Unit is millivolt Aout3 INT Command state of analog output channel 3 of the arm IO board. Unit is millivolt Outputs Name Type Description Valid BOOL Set when function block is executing. Reset when Done or Error is set Din0 BOOL Command state of digital input channel 0 of the Arm IO board Din1 BOOL Command state of digital input channel 1 of the Arm IO board Din2 BOOL Command state of digital input channel 2 of the Arm IO board 62 Version: 1.3.4 TF5130
## Page 63

PLC API Name Type Description Din3 BOOL Command state of digital input channel 3 of the Arm IO board Din4 BOOL Command state of digital input channel 4 of the Arm IO board Din5 BOOL Command state of digital input channel 5 of the Arm IO board Din6 BOOL Command state of digital input channel 6 of the Arm IO board Din7 BOOL Command state of digital input channel 7 of the Arm IO board Ain0 INT Command state of analog input channel 0 of the arm IO board. Unit is millivolt Ain1 INT Command state of analog input channel 1 of the arm IO board. Unit is millivolt Ain2 INT Command state of analog input channel 2 of the arm IO board. Unit is millivolt Ain3 INT Command state of analog input channel 3 of the arm IO board. Unit is millivolt / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.22 VAL_Read Write IO VAL_Read Write IO Enable BOOL BOOL Valid Valve1 BOOL BOOL Usr Input0 Valve2 BOOL BOOL Usr Input1 Fout0 BOOL BOOL Fin0 Fout1 BOOL BOOL Fin1 Enable Valve1 BOOL BOOL Valves Safe State Enable Valve2 BOOL ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Read Write IO Update the digital outputs of the controller with values passed as parameter. Return the state of the digital inputs available on the controller. The mentioned inputs Valve1 and Valve2 are not available with TS Scara robot (CS8C controler). Please be aware of the following signal combination for CS9 controller controlling robot equiped with 5-3 ways solenoid valves Valvexx Enable Valvexx Air flow on outlet (robot forearm) 0 or 1 0 NO air 0 1 Axx 1 1 Bxx TF5130 Version: 1.3.4 63
## Page 64

PLC API Valvexx Enable Valvexx Air flow on outlet (robot forearm) Comment: xx = 1 or 2 depending on robot model Syntax Definition: FUNCTION_BLOCK VAL_Read Write IO VAR_INPUT Enable : BOOL := FALSE; Valve1 : BOOL := FALSE; Valve2 : BOOL := FALSE; Fout0 : BOOL := FALSE; Fout1 : BOOL := FALSE; Enable Valve1 : BOOL := FALSE; Enable Valve2 : BOOL := FALSE; END_VAR VAR_OUTPUT Valid : BOOL := FALSE; Usr Input0 : BOOL := FALSE; Usr Input1 : BOOL := FALSE; Fin0 : BOOL := FALSE; Fin1 : BOOL := FALSE; Valves Safe State : BOOL := FALSE; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL Function block content is executed as long as this input is set TRUE Valve1 BOOL Command the state of the internal valve connected to A1&B1 outlets on the forearm of 6 axis robot Valve2 BOOL Command the state of the internal valve connected to A2&B2 outlets on the forearm of 6 axis robot Fout0 BOOL Command Fast output provided on J111-9 / J111-12 connector for CS8C controller OR J212-4 / J212-9 connector for CS9 controller Fout1 BOOL Command Fast output provided on J111-9 / J111-12 connector for CS8C controller OR J212-1 / J212-5 connector for CS9 controller Enable Valve1 BOOL Apply to CS9 with 6 axes robot equipped with 5-3 ways solenoid valves ONLY. TRUE=Valve1 can be operated. FALSE=Valve1 is in (closed) middle Position Enable Valve2 BOOL Apply to CS9 with 6 axes robot equipped with 5-3 ways solenoid valves ONLY. TRUE=Valve2 can be operated. FALSE=Valve2 is in (closed) middle Position Outputs Name Type Description Valid BOOL Set when function block is executing. Reset when Done or Error is set Usr Input0 BOOL State of the digital user input 0 provided on J109-11 / J109-30 connector of the CS8C controller Usr Input1 BOOL State of the digital user input 1 provided on J109-16 / J109-35 connector of the CS8C controller 64 Version: 1.3.4 TF5130
## Page 65

PLC API Name Type Description Fin0 BOOL State of the fast digital input provided on J111-2 / J111-7 connector of the CS8C controller Fin1 BOOL State of the fast digital input provided on J111-3 / J111-8 connector of the CS8C controller Valves Safe State BOOL CS9 controlling 5-3 ways valves ONLY. The valves are in Safe State. Valve position may not match the commanded state. Refer to CS9 safety manual for details / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.23 VAL_Safe Brake Test VAL_Safe Brake Test Execute BOOL BOOL Busy ↔ Axes Group T_Staeubli Robot BOOL Done BOOL Error UDINT Error ID ARRAY [0..5] OF INT Brake Status FUNCTION_BLOCK VAL_Safe Brake Test Applicable for CS9 controller only This function blocks commands a test of all the brakes of the connected robot. For futher details about CS9 safety features, please consult 'CS9 Safety Manual' Syntax Definition: FUNCTION_BLOCK VAL_Safe Brake Test VAR_INPUT Execute : BOOL := FALSE; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Brake Status : ARRAY [0..5] OF INT; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution TF5130 Version: 1.3.4 65
## Page 66

PLC API Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Brake Status ARRAY [0..5] OF INT Result of the brake test for each axis / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.24 VAL_Set Movement ID VAL_Set Movement ID Execute BOOL BOOL Busy Movement ID INT BOOL Done ↔ Axes Group T_Staeubli Robot BOOL Error UDINT Error ID FUNCTION_BLOCK VAL_Set Movement ID This instruction changes the movement ID for the next commanded movement. It is useful to arrange so that the same path always uses the same movement ID values. After execution of MC_Group Stop(), the movement ID is automatically reset to 0. After executing this function block, the relation between the movement ID set and the ID of the movement in progress may become uncertain: Several commanded movements may then have the same movement id. This function block should therefore not give a value that is also the movement ID of a pending move command. To finish, this is highly recommended to execute this function when robot is NOT moving Syntax Definition: FUNCTION_BLOCK VAL_Set Movement ID VAR_INPUT Execute : BOOL := FALSE; Movement ID : INT := -1; END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Execute BOOL Rising edge triggers function execution 66 Version: 1.3.4 TF5130
## Page 67

PLC API Name Type Description Movement ID INT Value for setting movement ID on robot side Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL s when function block has terminated with error Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.25 VAL_Shift Point VAL_Shift Point Execute BOOL BOOL Busy Coord System INT BOOL Done Position T_Cartesian Pos BOOL Error Shift In Frame BOOL UDINT Error ID Frame Idx INT T_Cartesian Pos relative Position Offsets T_Trsf ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Shift Point This function block computes a new cartesian position by applying a geometrical transformation. The geometrical transformation specified by ‘Offsets’ parameter can be applied relative to different coordinate systems : • User frames ( Equivalent to native compose() function) • Tool ( Equivalent to native appro() function ) Syntax Definition: FUNCTION_BLOCK VAL_Shift Point VAR_INPUT Execute : BOOL := FALSE; Coord System : INT := -1; Position : T_Cartesian Pos; Shift In Frame : BOOL := FALSE; Frame Idx : INT := -1; Offsets : T_Trsf := STRUCT(X := 0, Y := 0, Z := 0, RX := 0, RY := 0, RZ := 0); END_VAR VAR_OUTPUT Busy : BOOL := FALSE; Done : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; relative Position : T_Cartesian Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR TF5130 Version: 1.3.4 67
## Page 68

PLC API Inputs Name Type Description Execute BOOL Rising edge triggers function execution Coord System INT Index of the user frame (starting with 0) Position T_Cartesian Pos [} 76] Absolute end positions for each dimension in the specified coordinate system. Shift In Frame BOOL True=Position will be shifted in specified user frame. False=shift in according to orientation of the Position parameter Frame Idx INT Index of the user frame in which Position will be shifted - Applicable only if Shift In Frame is true Offsets T_Trsf [} 80] Offsets in all directions to apply to the Position Outputs Name Type Description Busy BOOL Set when function block is executing. Reset when Done or Error is set Done BOOL This output is set when function block has terminated with success Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code relative Position T_Cartesian Pos [} 76] New Position after the offets have been applied / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.26 VAL_Touch Probe VAL_Touch Probe Enable BOOL BOOL Valid Fast Input Number INT BOOL Active ↔ Axes Group T_Staeubli Robot BOOL Error UDINT Error ID T_Joint Pos Joint Position FUNCTION_BLOCK VAL_Touch Probe This function block enables high accurate ‘on the fly’ capture of the robot position. A sensor shall be connected to a dedicated fast digital input of the robot controller. The position capture occurs on a rising edge of this dedicated sensor. Fast input Description Wiring CS8C Wiring CS9 number 0 Fast input 0 J111-2(+) / J111-7(-) J212-2(+) / J212-7 (-) 1 Fast input 1 J111-3(+) / J111-8(-) J212-3(+) / J212-8 (-) Syntax Definition: 68 Version: 1.3.4 TF5130
## Page 69

PLC API FUNCTION_BLOCK VAL_Touch Probe VAR_INPUT Enable : BOOL := FALSE; Fast Input Number : INT := -1; END_VAR VAR_OUTPUT Valid : BOOL := FALSE; Active : BOOL := FALSE; Error : BOOL := FALSE; Error ID : UDINT := 0; Joint Position : T_Joint Pos; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL Rising edge triggers function execution Fast Input Number INT Index of the fast input which is used to capture robot position. Outputs Name Type Description Valid BOOL This output is set when function block has terminated with success Active BOOL TRUE = Fast robot position capture is activated on robot side. FALSE = Fast robot position capture is disabled. Error BOOL This output is set when function block has terminated with error Error ID UDINT Error code Joint Position T_Joint Pos [} 77] Position of each robot axis when rising edge occured on input / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.1.27 VAL_Write Axes Group VAL_Write Axes Group Enable BOOL BOOL Error Output Address POINTER TO T_To Robot UDINT Error ID ↔ Axes Group T_Staeubli Robot FUNCTION_BLOCK VAL_Write Axes Group Syntax Definition: FUNCTION_BLOCK VAL_Write Axes Group VAR_INPUT Enable : BOOL := FALSE; Output Address : POINTER TO T_To Robot; END_VAR VAR_OUTPUT TF5130 Version: 1.3.4 69
## Page 70

PLC API Error : BOOL := FALSE; Error ID : UDINT := 0; END_VAR VAR_IN_OUT Axes Group : T_Staeubli Robot; END_VAR Inputs Name Type Description Enable BOOL TRUE = Content of the FB is executed Output Address POINTER TO T_To Robot Base address of the Outputs within the IO interface with a robot. Use 'ADR' operator for setting this input [} 74] of the function block. Typical syntax is ADR(%QWxx) where xx depends on the hardware configuration of the PLC. Outputs Name Type Description Error BOOL Error flag Error ID UDINT Error code / Inputs/Outputs Name Type Description Axes Group T_Staeubli Robot [} 78] Data block for a robot 6.2 Functions 6.2.1 VAL_Define Cartesian Pos VAL_Define Cartesian Pos X REAL T_Cartesian Pos VAL_Define Cartesian Pos Y REAL Z REAL RX REAL RY REAL RZ REAL CS UINT CE UINT CW UINT FUNCTION VAL_Define Cartesian Pos : T_Cartesian Pos [} 76] This function might be used to initialize a cartesian position. It provides a way to have a more compact code. The following code below my Point := VAL_Define Cartesian Pos(10,-13.125,115.10,45.5,25.3,-90.25,2,2,2); is equivalent to my Point. X := 10; my Point. Y := -13.125; my Point. Z := 115.10; my Point. RX := 45.5; my Point. RY := 25.3; my Point. RZ := -90.25; 70 Version: 1.3.4 TF5130
## Page 71

PLC API my Point. CS := 2; my Point. CE := 2; my Point. CW := 2; Syntax Definition: FUNCTION VAL_Define Cartesian Pos : T_Cartesian Pos VAR_INPUT X : REAL := 0; Y : REAL := 0; Z : REAL := 0; RX : REAL := 0; RY : REAL := 0; RZ : REAL := 0; CS : UINT := 2; CE : UINT := 2; CW : UINT := 2; END_VAR Inputs Name Type Description X REAL Value for X coordinate Y REAL Value for Y coordinate Z REAL Value for Z coordinate RX REAL Value for RX coordinate RY REAL Value for RY coordinate RZ REAL Value for RZ coordinate CS UINT Value for shoulder configuration (1=> sfree; 2=> ssame; 3=> righty; 4=> lefty) CE UINT Value for elbow configuration (1=> sfree; 2=> ssame; 3=> righty; 4=> lefty) CW UINT Value for wrist configuration (1=> sfree; 2=> ssame; 3=> righty; 4=> lefty) Return value Name Type Description VAL_Define Cartesian Pos T_Cartesian Pos [} 76] 6.2.2 VAL_Define Joint Pos VAL_Define Joint Pos J1 REAL T_Joint Pos VAL_Define Joint Pos J2 REAL J3 REAL J4 REAL J5 REAL J6 REAL FUNCTION VAL_Define Joint Pos : T_Joint Pos [} 77] This function might be used to initialize a joint position. It provides a way to have a more compact code. The following below my Joint := VAL_Define Joint Pos(10,-13.125,115.10,45.5,25.3,-90.25); is equivalent to TF5130 Version: 1.3.4 71
## Page 72

PLC API my Joint. J1 := 10; my Joint. J2 := -13.125; my Joint. J3 := 115.10; my Joint. J4 := 45.5; my Joint. J5 := 25.3; my Joint. J6 := -90.25; Syntax Definition: FUNCTION VAL_Define Joint Pos : T_Joint Pos VAR_INPUT J1 : REAL := 0; J2 : REAL := 0; J3 : REAL := 0; J4 : REAL := 0; J5 : REAL := 0; J6 : REAL := 0; END_VAR Inputs Name Type Description J1 REAL Coordinate for axis 1 J2 REAL Coordinate for axis 2 J3 REAL Coordinate for axis 3 J4 REAL Coordinate for axis 4 J5 REAL Coordinate for axis 5 - not applicable for 4 axis robots- J6 REAL Coordinate for axis 6 - not applicable for 4 axis robots- Return value Name Type Description VAL_Define Joint Pos T_Joint Pos [} 77] 6.2.3 VAL_Define Trsf VAL_Define Trsf X REAL T_Trsf VAL_Define Trsf Y REAL Z REAL RX REAL RY REAL RZ REAL FUNCTION VAL_Define Trsf : T_Trsf [} 80] This function might be used to initialize a T_Trsf variable. It provides a way to have a more compact code. The following code below: my Trsf := VAL_Define Trsf(10,-13.125,115.10,45.5,25.3,-90.25); is equivalent to my Trsf. X := 10; my Trsf. Y := -13.125; my Trsf. Z := 115.10; my Point. RX := 45.5; my Trsf. RY := 25.3; my Trsf. RZ := -90.25; 72 Version: 1.3.4 TF5130
## Page 73

PLC API Syntax Definition: FUNCTION VAL_Define Trsf : T_Trsf VAR_INPUT X : REAL := 0; Y : REAL := 0; Z : REAL := 0; RX : REAL := 0; RY : REAL := 0; RZ : REAL := 0; END_VAR Inputs Name Type Description X REAL Value for X coordinate Y REAL Value for Y coordinate Z REAL Value for Z coordinate RX REAL Value for RX coordinate RY REAL Value for RY coordinate RZ REAL Value for RZ coordinate Return value Name Type Description VAL_Define Trsf T_Trsf [} 80] 6.2.4 VAL_Enable Manual Move VAL_Enable Manual Move Enable Move BOOL BOOL VAL_Enable Manual Move FUNCTION VAL_Enable Manual Move : BOOL This function enables movement of the robot when manual mode is selected. It provides the hold-to-run function described hereafter: Although robot speed is limited and user shall activate the 3-position switch, an additional action is required as per ISO 10218-1:2011 - Robots and robotic devices -- Safety requirements for industrial robots - Chapter 5.7.3: • Manual control of the robot from inside the safeguarded space shall be performed with a reduced speed in conjunction with either of the following: ◦ hold-to-run controls in conjunction with an enabling device in accordance with 5.8 [Pendant controls] ◦ for program verification only, a start/stop control in conjunction with an enabling device in accordance with 5.8 [Pendant controls] • This function is effective only when Stäubli Teach Pendant is removed and replaced by the delivered shorting plug. • The controller must be configured to have user-supplied teach pendant in use (file iomap.cfx on controller). • Manual operation mode must be selected from user-supplied teach pendant Syntax Definition: TF5130 Version: 1.3.4 73
## Page 74

PLC API FUNCTION VAL_Enable Manual Move : BOOL VAR_INPUT Enable Move : BOOL := FALSE; END_VAR Inputs Name Type Description Enable Move BOOL If this input is TRUE, the robot movement are enabled. When released, the robot stops on the programmed trajectory Return value Name Type Description VAL_Enable Manual Move BOOL 6.3 Types 6.3.1 Internal 6.3.1.1 T_From Robot TYPE T_From Robot : STRUCT Structure defining the inputs (PLC side) for the interface with a robot. This datatype is for internal use only. It is deliberately not documented. 6.3.1.2 T_To Robot TYPE T_To Robot : STRUCT Structure defining the outputs (PLC side) for the interface with a robot. This datatype is for internal use only. It is deliberately not documented. 6.3.2 MC_Transition Parameter TYPE MC_Transition Parameter : STRUCT Syntax Definition: TYPE MC_Transition Parameter : STRUCT leave : REAL; reach : REAL; END_STRUCT END_TYPE Parameters Name Type Description leave REAL Distance from the destination point at which the nominal trajectory is left. reach REAL Distance from the destination point at which the nominal trajectory is joined again. 74 Version: 1.3.4 TF5130
## Page 75

PLC API 6.3.3 T_CS9Sfty Cmd TYPE T_CS9Sfty Cmd : STRUCT Structure defining information related to CS9 safety features Applicable for CS9 controller only. For futher details about CS9 safety features, please consult 'CS9 Safety Manual'Restart control is the safety function to maintain the robot in safe state after a safety stop, or after machine start-up, until an explicit restart acknowledge (manual reset) signal is received. Syntax Definition: TYPE T_CS9Sfty Cmd : STRUCT Restart Safety : BOOL := FALSE; Reset Referencing : BOOL := FALSE; Force Referencing Check : BOOL := FALSE; Safe Ref Sensor : BOOL := FALSE; END_STRUCT END_TYPE Parameters Name Type Initial Description Restart Safety BOOL FALSE Command a safety restart/acknowledgment of the CS9 internal safety PLC program. Safety acknowledge can be disabled on the robot side, when restart control is fully implemented within an external PLC program Reset Referencing BOOL FALSE Effective when robot power is OFF. Reset the safe referencing procedure. It shall be completely performed again. Force Referencing Check BOOL FALSE When set, robot moves at slow speed only. A movement to second referencing position is required. Safe Ref Sensor BOOL FALSE State of the safe referencing sensor 6.3.4 T_CS9Sfty Fbk TYPE T_CS9Sfty Fbk : STRUCT Structure defining information related to CS9 safety features Applicable for CS9 controller only. For futher details about CS9 safety features, please consult 'CS9 Safety Manual'Restart control is the safety function to maintain the robot in safe state after a safety stop, or after machine start-up, until an explicit restart acknowledge (manual reset) signal is received. Syntax Definition: TYPE T_CS9Sfty Fbk : STRUCT Wait For Restart : BOOL := FALSE; Brake Test Warning : BOOL := FALSE; Brake Test Timeout : BOOL := FALSE; Safe Referencing Status : UINT := 7; END_STRUCT END_TYPE Parameters Name Type Initial Description Wait For Restart BOOL FALSE The CS9 internal safety PLC program is waiting for a safety restart/acknowledgment. This feature can be disabled TF5130 Version: 1.3.4 75
## Page 76

PLC API Name Type Initial Description Brake Test Warning BOOL FALSE TRUE= Time interval for performing brake test is about to elapse. Robot brakes shall be tested as soon as possible Brake Test Timeout BOOL FALSE TRUE= Time interval for performing brake test is up. Robot will move wil low speed until Brake test procedure is successfully executed. Safe Referencing Status UINT 7 Self explaining... 6.3.5 T_Cartesian Pos TYPE T_Cartesian Pos : STRUCT This data type represents a cartesian position. A Cartesian position defines the position and orientation of a point in the environment of the robot. Syntax Definition: TYPE T_Cartesian Pos : STRUCT X : REAL := 0; Y : REAL := 0; Z : REAL := 0; RX : REAL := 0; RY : REAL := 0; RZ : REAL := 0; CS : UINT := 2; CE : UINT := 2; CW : UINT := 2; END_STRUCT END_TYPE Parameters Name Type Initial Description X REAL 0 X coordinate Y REAL 0 Y coordinate Z REAL 0 Z coordinate RX REAL 0 RX coordinate RY REAL 0 RY coordinate RZ REAL 0 RZ coordinate CS UINT 2 Configuration shoulder (1=> sfree; 2=> ssame; 3=> righty; 4=> lefty CE UINT 2 Configuration elbow (1=> efree; 2=> esame; 3=> epositive; 4=> enegative CW UINT 2 Configuration wrist (1=> wfree; 2=> wsame; 3=> wpositive; 4=> wnegative 6.3.6 T_Command TYPE T_Command : STRUCT Structure defining the command information defined in robot data block. Syntax Definition: TYPE T_Command : STRUCT Enable Profi Alarms : BOOL := FALSE; Enable Verbose : BOOL := FALSE; Override Cmd : UINT := 0; Operation Mode Cmd : UINT := 0; Tool Cmd : UINT := 0; Coord System Cmd : UINT := 0; 76 Version: 1.3.4 TF5130
## Page 77

PLC API CS9Safety : T_CS9Sfty Cmd; Lifebit Period : TIME := TIME#200ms; END_STRUCT END_TYPE Parameters Name Type Initial Description Enable Profi Alarms BOOL FALSE TRUE=Error messages are reported on Profinet network. Enable Verbose BOOL FALSE TRUE=Enable tracing activity of the server. It is strongly recommended to enable trace for debugging purpose only. Override Cmd UINT 0 Commanded Override [1..100] (monitor speed) Operation Mode Cm UINT 0 Commanded operation mode 0= invalid , 1= Manu, d 3=Auto, 4 remote(ext Aut) Tool Cmd UINT 0 Select the Tool used for movement. Starting with 0 Coord System Cmd UINT 0 Select the coordinate system used for movement. Starting with 0 CS9Safety T_CS9Sfty Cmd CS9 Only - Safety features [} 75] Lifebit Period TIME TIME#20 Select the period of the internal lifebit 0ms (100ms<Period<1000ms) 6.3.7 T_Joint Pos TYPE T_Joint Pos : STRUCT This data type represents a joint position. A joint position is defined by the angular position of each revolute axis and the linear position of each linear axis. The fields are expressed in degrees for the rotary axes and in millimeter or inches for the linear axes. The origin of each axis is defined according to the type of robot used. Syntax Definition: TYPE T_Joint Pos : STRUCT J1 : REAL := 0; J2 : REAL := 0; J3 : REAL := 0; J4 : REAL := 0; J5 : REAL := 0; J6 : REAL := 0; END_STRUCT END_TYPE Parameters Name Type Initial Description J1 REAL 0 Position of axis 1 J2 REAL 0 Position of axis 2 J3 REAL 0 Position of axis 3 J4 REAL 0 Position of axis 4 J5 REAL 0 Position of axis 5 if applicable. For 4 axis robots, this value is 0 J6 REAL 0 Position of axis 6 if applicable. For 4 axis robots, this value is 0 6.3.8 T_Mdesc TYPE T_Mdesc : STRUCT TF5130 Version: 1.3.4 77
## Page 78

PLC API This data type describes a motion descriptor. A motion descriptor is a variable used to define : • The dynamic parameters of a commanded movement (Speed, Acceleration, Deceleration) • The geometry of the trajectory at way point (Blending distances) Syntax Definition: TYPE T_Mdesc : STRUCT Accel : INT := 0; Vel : INT := 0; Decel : INT := 0; Tvel : REAL := 0; Rvel : REAL := 0; Leave : REAL := 0; Reach : REAL := 0; e Blending Type : e Blending := 0; END_STRUCT END_TYPE Parameters Name Type Initial Description Accel INT 0 Maximum permitted joint acceleration as a % of the nominal acceleration of the robot. Vel INT 0 Maximum permitted joint speed as a % of the nominal speed of the robot. Decel INT 0 Maximum permitted joint deceleration as a % of the nominal deceleration of the robot. Tvel REAL 0 Maximum permitted translational speed of the tool center point, in mm/s or inches/s depending on the unit of length defined in robot's controller Rvel REAL 0 Maximum permitted rotational speed of the tool center point, in degrees per second. Leave REAL 0 Distance from the destination point at which the nominal trajectory is left. Reach REAL 0 Distance from the destination point at which the nominal trajectory is joined again. e Blending Type e Blending 0 Blending type 0: Not Defined, 1: Off, 2: Joint, 3: Cartesian [} 81] 6.3.9 T_Staeubli Robot TYPE T_Staeubli Robot : STRUCT Data structure for server commands/status Syntax Definition: TYPE T_Staeubli Robot : STRUCT Status : T_Status; Command : T_Command; END_STRUCT END_TYPE Parameters Name Type Status T_Status [} 79] 78 Version: 1.3.4 TF5130
## Page 79

PLC API Name Type Command T_Command [} 76] 6.3.10 T_Status TYPE T_Status : STRUCT Structure defining the status information defined in robot data block Syntax Definition: TYPE T_Status : STRUCT Initialized : BOOL; Online : BOOL; Error Pending : BOOL; Is Moving : BOOL; EStop Active : BOOL; Dummy Plug : BOOL; External WMS : BOOL; External MCP : BOOL; External Mcp_Wms : BOOL; Actual Speed : REAL; Actual Override : REAL; Actual Error Number : UINT; Actual Operation Mode : UINT; Actual Error ID : T_Pending Errors; Cartesian Pos : T_Cartesian Pos; Joint Pos : T_Joint Pos; Joint Forces : ARRAY [0..5] OF REAL; Actual Coord System : UINT := 0; Actual Tool : UINT := 0; Robot State Machine : UINT; Movement ID : INT; Movement Progress : INT; Robot Model : STRING(10); Controller Model : UINT; CS9Safety : T_CS9Sfty Fbk; Heartbeat : UINT; Server Major Version : UINT; Server Minor Version : UINT; Server Edit : UINT; Client Major Version : UINT; Client Minor Version : UINT; Client Edit : UINT; END_STRUCT END_TYPE Parameters Name Type Initial Description Initialized BOOL True = The library is initialized Online BOOL True = robot can receive commands Error Pending BOOL True = an error is pending Is Moving BOOL True = robot is moving EStop Active BOOL True = E-stop is pending Dummy Plug BOOL True = staubli teach pendant replaced by dummy plug External WMS BOOL True = Remote WMS option activated. Operation mode selection is done from user-supplied Working Mode Selector device. Stäubli WMS Box is replaced by J113 dummy plug. False = Stäubli WMS box is used OR external WMS option NOT configured properly (see iomap.cfx file on robot side) TF5130 Version: 1.3.4 79
## Page 80

PLC API Name Type Initial Description External MCP BOOL True = Remote MCP option activated. User-supplied Teach Pendant is used for jogging robot in manual mode. False = Stäubli SP1 Teach pendant is in used or Remote WMS option NOT configured properly (see iomap.cfx file on robot side) External Mcp_Wms BOOL True = Robot is properly configured to use both user- supplied WMS and Teach Pendant. Actual Speed REAL Cartesian speed of the current TCP Actual Override REAL Current override value [0.01 .. 100] Actual Error Number UINT Total number of pending errors in robot Actual Operation Mode UINT Actual working mode 0= invalid , 1= manu, 3=Auto, 4 remote(extaut) Actual Error ID T_Pending Err List of pending error on server side ors Cartesian Pos T_Cartesian Po UDT for a robot position s [} 76] Joint Pos T_Joint Pos [} 77] Joint Forces ARRAY [0..5] OF REAL Actual Coord System UINT 0 Number of the user frame in which the position of the Tool Center Point is reported. Actual Tool UINT 0 Number of the Tool Center Point for which the position is reported. Robot State Machine UINT State Machine of the robot Movement ID INT Identifier of motion currently executed Movement Progress INT Percentage of actual movement that has been completed Robot Model STRING(10) Robot model connected to controller Controller Model UINT Model of connected Stäubli controller 8=CS8C / 9=CS9 CS9Safety T_CS9Sfty Fbk CS9 Only - Safety features [} 75] Heartbeat UINT Counter incremented at every cycle of the server's communication task Server Major Version UINT Major version of unival PLC server Server Minor Version UINT Minor version of unival PLC server Server Edit UINT Edit of the uni VAL plc server Client Major Version UINT Major version of unival PLC client library Client Minor Version UINT Minor version of unival PLC client library Client Edit UINT Edit of the unival PLC client library 6.3.11 T_Trsf TYPE T_Trsf : STRUCT This data type represents a geometrical transformation Syntax Definition: TYPE T_Trsf : STRUCT X : REAL := 0; Y : REAL := 0; Z : REAL := 0; RX : REAL := 0; 80 Version: 1.3.4 TF5130
## Page 81

PLC API RY : REAL := 0; RZ : REAL := 0; END_STRUCT END_TYPE Parameters Name Type Initial Description X REAL 0 X coordinate Y REAL 0 Y coordinate Z REAL 0 Z coordinate RX REAL 0 RX coordinate RY REAL 0 RY coordinate RZ REAL 0 RZ coordinate 6.4 enums 6.4.1 e Blending TYPE e Blending : Define rounding solutions. The members of this enumeration are matching the 'blend' field of VAL3 motion descriptor. Syntax Definition: TYPE e Blending : ( NOTDEF := 0, OFF := 1, JOINT := 2, CARTESIAN := 3 ); END_TYPE Parameters Name Initial NOTDEF 0 OFF 1 JOINT 2 CARTESIAN 3 6.4.2 e Config Elbow TYPE e Config Elbow : Define robot's elbow configuration The members of this enumeration are matching VAL3 description of robot's elbow configuration Syntax Definition: TYPE e Config Elbow : ( e Not Defined := 0, efree := 1, esame := 2, epositive := 3, TF5130 Version: 1.3.4 81
## Page 82

PLC API enegative := 4 ); END_TYPE Parameters Name Initial e Not Defined 0 efree 1 esame 2 epositive 3 enegative 4 6.4.3 e Config Shoulder TYPE e Config Shoulder : Define robot's shoulder configuration The members of this enumeration are matching VAL3 description of robot's shoulder configuration Syntax Definition: TYPE e Config Shoulder : ( s Not Defined := 0, sfree := 1, ssame := 2, righty := 3, lefty := 4 ); END_TYPE Parameters Name Initial s Not Defined 0 sfree 1 ssame 2 righty 3 lefty 4 6.4.4 e Config Wrist TYPE e Config Wrist : Define robot's wrist configuration The members of this enumeration are matching VAL3 description of robot's wrist configuration Syntax Definition: TYPE e Config Wrist : ( e Not Defined := 0, wfree := 1, wsame := 2, wpositive := 3, wnegative := 4 ); END_TYPE 82 Version: 1.3.4 TF5130
## Page 83

PLC API Parameters Name Initial e Not Defined 0 wfree 1 wsame 2 wpositive 3 wnegative 4 6.4.5 e MC_BUFFER_MODE TYPE e MC_BUFFER_MODE : A fundamental part of interpolated motion control is blending of (buffered) consecutive motion commands on an axes group. This enumeration lists the supported buffer modes. Fig. 2: Trajectory of the TCP of two consecutive motion commands in three modes Source: PLCopen - Technical Committee 2 – Task Force / Document: Function blocks for motion control version 2.0 Syntax Definition: TYPE e MC_BUFFER_MODE : ( Aborting := 0, Buffered := 1, Blending Joint := 6, Blending Cartesian := 7 ); END_TYPE Parameters Name Initial Description Aborting 0 A FB with buffer mode “Aborting” aborts any ongoing motion and starts the new motion immediately Buffered 1 The next FB affects the axes group as soon as the previous motion is fully completed (Robot has reached commanded destination). Blending Joint 6 The current and the next motion FBs are blended, so the axes group will not stop between the motions. During blending, the robot is performing a joint interpolated motion TF5130 Version: 1.3.4 83
## Page 84

PLC API Name Initial Description Blending Cartesian 7 The current and the next motion FBs are blended, so the axes group will not stop between the motions. The shape of the robot’s motion during the blending is a Bezier curve 6.4.6 e MC_TRANSITION_MODE TYPE e MC_TRANSITION_MODE : This enumeration defines the profile of the robot trajectory nearby the set points. Full description for this feature can be found in the document edited by PLCopen organization Source: PLCopen - Technical Committee 2 – Task Force / Document: Function blocks for motion control version 2.0. uni VALplc client library defines MC_Transition Parameter data type for specifying mentioned distances. Syntax Definition: TYPE e MC_TRANSITION_MODE : ( None := 0, Corner Distance := 3, Blending Distances := 10 ); END_TYPE Parameters Name Initial Description None 0 The motion blocks are not modified, and no transition curve is inserted. Corner Distance 3 This mode is like ‘Blending distances’ except that leave and reach distances are equal. Blending Distances 10 If the position where the original contour can be left is known, the user can specify: • The distance from the arrival point at which the nominal trajectory is left. • The distance from the arrival point at which the nominal trajectory is rejoined 6.4.7 e Operation Mode TYPE e Operation Mode : Define the working mode of the robot. The working mode is selected with a dedicated key switch located on the WMS. The picture below shows the Working Mode Selector currently abbreviated WMS. 84 Version: 1.3.4 TF5130
## Page 85

PLC API Fig. 3: WMS Box Syntax Definition: TYPE e Operation Mode : ( wrk Mode_INVALID := 0, wrk Mode_MANUAL := 1, wrk Mode_TEST := 2, wrk Mode_AUTO := 3, wrk Mode_REMOTE := 4 ); END_TYPE Parameters Name Initial Description wrk Mode_INVALID 0 wrk Mode_MANUAL 1 wrk Mode_TEST 2 Not implemented wrk Mode_AUTO 3 wrk Mode_REMOTE 4 6.4.8 e State Machine TYPE e State Machine : Define steps of the robot's state machine Syntax Definition: TYPE e State Machine : ( SM_POWEROFF := 0, SM_STANDBY := 1, SM_INTERRUPT := 2, SM_HOLD := 6, SM_MOVING := 3, SM_CONNECT := 4, SM_JOGGING := 5 ); END_TYPE Parameters Name Initial Description SM_POWEROFF 0 Robot power is OFF TF5130 Version: 1.3.4 85
## Page 86

PLC API Name Initial Description SM_STANDBY 1 Robot settled with no pending movement SM_INTERRUPT 2 Robot settled with pending movement SM_HOLD 6 Robot stopped because of Move/Hold key SM_MOVING 3 Robot is moving SM_CONNECT 4 Robot is moving along a connection move SM_JOGGING 5 Robot is jogged from teach pendant 6.5 unival PLC Error Codes 6.5.1 CS8C_Error Message Id Description 0 No Error 1 uni VAL plc server license not installed 2 uni VAL plc server demo period has expired. Reboot is needed 3 Lifebit Error. The lifebit period seems to be not stable. 5 Try to load a non-existing server. 6 Error while loading server. check event logger for more details 7 Arm IO error: IO signal not responding 8 Controller IO error: IO signal not responding (Usr In, Valves, Fout, Fin) 9 unknown server Key or server not ready 10 Robot model could not be identified. Check event logger for more information 20 Invalid function code 21 Bank ID not defined in user database or user frame not defined in plc database (range: [0..31]) 22 Command not supported for this controller. 23 TCP not defined 24 Mdesc not defined 25 Joint not defined 26 Point not defined 27 Invalid value for VEL 28 Invalid value for ACCEL 29 Invalid value for DECEL 30 Invalid value for TVEL 31 Invalid value for RVEL 32 Invalid value for LEAVE 33 Invalid value for REACH 34 Invalid value for BLEND. Range is [1..3] 35 Userframe cannot be computed. Check the position of the 3 construction points 36 Invalid point index for Userframe computation range is: [1..3] 37 Invalid configuration for a point 38 Try to access a datatype that does not exist. (1=Point 2=Joint 3=TCP 4=Mdesc) 39 Invalid size for a bank 40 Position not reachable. 41 Motion stack is locked because a previous motion has failed. 43 Change in configuration detected - Shoulder 44 Change in configuration detected - Elbow 86 Version: 1.3.4 TF5130
## Page 87

PLC API Id Description 45 Change in configuration detected - Wrist 46 Robot powering ON/OFF sequence has failed. 48 Cannot execute movement, no database has been loaded. 50 Cannot change monitor speed. Robot not in ‘Remote’ working mode. 51 Invalid frame number. The position of the current active Tool is reported relatively to a defined user Frame. There are 32 userframes available on robot side. This error is reported when you select a user Frame number that is out of range [0..31] 52 Invalid Tool number. A total number of 32 Tools are available on robot side. You shall select the number of the Tool which position is reported by uni VAL plc server. This error is reported when you select a Tool number that is out of range [0..31] 60 uni VALplc client library initialization failed. 61 Parameter Axes Group not in range. 62 Index parameter not in range. 63 Invalid Buffer mode (0='Aborted' 1='Buferred' 6='Blending Joint' 7='Blending Cartesian') 64 Invalid Transition Mode (0=’None’ 3=’Corner distance’ 10=’Blending distances). 65 Communication reset during transaction. (Communication protocol aborted) 66 Data of the profinet module cannot be read at specified address. 67 Access to an invalid input or output number 68 Operation timeout. Server acknowledgment missed. 90 Remote MCP mode not activated. Dummy plug not detected. Check that dummy plug is installed on J110. 92 Invalid Jog mode selected. (1=Joint 2=Frame 3=Tool) 93 Cannot jog: Manual mode requested 94 Cannot jog: Robot power is OFF 110 Internal error #10 while loading a data base. Please contact your local Stäubli business unit 111 Internal error #11 while loading a data base. Please contact your local Stäubli business unit 112 Internal error #12 while loading a data base. Please contact your local Stäubli business unit 113 Internal error #13 while loading a data base. Please contact your local Stäubli business unit 114 Internal error #14 while loading a data base. Please contact your local Stäubli business unit 120 Internal error #20 while loading a data base. Please contact your local Stäubli business unit 121 Internal error #21 while loading a data base . Please contact your local Stäubli business unit 122 Internal error #22 while loading a data base. Please contact your local Stäubli business unit 123 Internal error #23 while loading a data base. Please contact your local Stäubli business unit 130 Internal error #30 while loading a data base. Please contact your local Stäubli business unit 131 Internal error #31 while loading a data base. Please contact your local Stäubli business unit 132 Cannot load database, Device not found. 133 Cannot load database, Device not ready 134 Cannot load database, Device timeout 139 Cannot load database, File not found 142 Cannot load database, No answer from FTP server. 200 Enveloppe error.(0x1503) 201 Cannot settle arm power: working mode change. (0x1605) 202 Joint limit electrical switch activated. (0x160d) 203 Drive error SAFETY-Drive Fault. (0x160e) 204 Cannot settle arm power (0x1626) 205 Arm power shutdown: working mode change. (0x1627) 206 Teach pendant emergency stop activated. (0x1709) 216 System event SAFETY-Shortr Open.(0x1736) 217 System event SAFETY-Watchdog.(0x1737) 218 System event SAFETY-Thermo Opened.(0x1738) TF5130 Version: 1.3.4 87
## Page 88

PLC API Id Description 219 Internal power error (fuse F3 on USBI safety board ?).(0x1739) 220 Internal power error (fuse F2 on RSI board ?).(0x173a) 221 Teach pendant emergency stop activated.(0x173b) 222 Remote emergency stop activated.(0x173c) 223 Cell emergency stop chain open (User ES1-2) 224 Deadman switch released or emergency stop chain for manual mode open (User EN) 225 Emergency stop chain DOOR open 226 cell emergency stop chain open (User ESB1-2).(0x1740) 227 brake select switch turned from normal (0) position.(0x1741) 228 brake release button pressed.(0x1742) 229 system event ROBOT-Safety Init.(0x1743) 230 system event SAFETY-Unstable Signal.(0x1744) 231 system event SAFETY-No Signal.(0x1745) 232 system event SAFETY-Transient.(0x1746) 233 phasing signal is enabled.(0x1747) 234 system event SAFETY-Estop Soft.(0x1748) 235 system event ROBOT-Safety.(0x1749) 238 Use of WMS is not allowed.(0x180A) 239 The robot is not calibrated: only joint jog move is possible. 240 Cannot move: destination is out of software axis limits.(0x3b05) 241 Cannot complete move: destination is out of reach.(out of software joint limits).0x3b06) 242 Cannot move: cannot cross singularity in this case.(0x3b07) 243 Cannot apply arm power: arm power is still in disabling phase.(0x3f04) 244 Cannot apply arm power: press and hold the deadman switch. (0x3f08) 245 Cannot apply arm power: release & press deadman to enable arm power request. (0x3f12) 246 Jog mode cannot be selected: first enable arm power.(0x3f15) 247 Turn off arm power or switch to manual mode. Jogging is not possible in this mode. (0x3f16) 248 Jog move impossible: first select a jog mode.(0x3f19) 249 Cannot apply arm power: park the pendant on the cradle.(0x3f22) 251 Invalid working mode. Try to perform an action which is not allowed in the current working mode. e.g. switch power ON in remote workingmode.(0x4001) 252 Cannot apply arm power: after an emergency stop, e Stop acknowledge signal (as configured in iomap.cf) must be validated.(0x4002) 800 Unexpected application runtime error. Check error logger 810 Invalid numerical calculation (division by zero). 811 Invalid numerical calculation (e.g.ln(-1)) 820 Access to an array with an index that is larger than the array size. 821 Access to an array with negative index or resize to zero. 829 Invalid task name. See task Create() instruction. 830 The specified name does not correspond to any VAL 3 task. 831 A task with the same name already exists. See task Create instruction. 832 Only 2 different periods for synchronous tasks are supported. Change scheduling period. 840 Not enough memory space available. 841 Not enough memory space to run the task. See the run memory size. 860 Maximum instruction run time exceeded. 861 Internal VAL 3 interpreter error 870 Invalid instruction parameter. See the corresponding instruction. 880 Uses data or a program from a library not loaded in the memory. 88 Version: 1.3.4 TF5130
## Page 89

PLC API Id Description 881 Incompatible kinematic: Use of a point/joint/config that is not compatible with the arm kinematic. 882 The reference frame or tool of a variable belongs to a library and is not accessible. 890 The task cannot resume from the location specified. See task Resume() instruction. 900 The speed specified in the motion descriptor is invalid (negative or too great). 901 The acceleration specified in the motion descriptor is invalid (negative or too great). 902 The deceleration specified in the motion descriptor is invalid (negative or too great). 903 The translation velocity specified in the motion descriptor is invalid (negative or too great). 904 The rotation velocity specified in the motion descriptor is invalid (negative or too great). 905 The reach parameter specified in the movement descriptor is invalid (negative). 906 The leave parameter specified in the movement descriptor is invalid (negative). 922 Attempt to write in a system input. 923 Use of a dio, aio or sio input/output not connected to a system input/output. 924 Attempt to access a protected system input/output 925 Read or write error on a dio, aio or sio (field bus error) 950 Cannot run this movement instruction: a previous movement request could not be completed (point out of reach, singularity, configuration problem, etc.) 953 Movement command not supported 954 Invalid movement instruction: target out of reach, or check the movement descriptor. 960 Invalid flange tool coordinates 961 Invalid world tool coordinates 962 Use of a point without a reference frame. See Definition. 963 Use of a frame without a reference frame. See Definition. 964 Use of a tool without reference tool. See Definition. 965 Invalid frame or reference tool (global variable linked to a local variable) 999 Unexpected error. Please check event logger of Stäubli controller. 6.5.2 CS9_Error Messages Id Description 0 No Error 1 uni VAL plc server license not installed 2 uni VAL plc server demo period has expired. Reboot is needed 3 Lifebit Error. The lifebit period seems to be not stable. 4 Not defined 5 Try to load a non-existing server. 6 Error while loading server. check event logger for more details 7 Arm IO error: IO signal not responding 8 Controller IO error: IO signal not responding (Usr In, Valves, Fout, Fin) 9 unknown server Key or server not ready 10 Robot model could not be identified. Check event logger for more information 20 Invalid function code 21 Bank ID not defined in user database or user frame not defined in plc database (range: [0..31]). 22 Command not supported for this controller. 23 TCP not defined 24 Mdesc not defined 25 Joint not defined TF5130 Version: 1.3.4 89
## Page 90

PLC API Id Description 26 Point not defined 27 Invalid value for VEL 28 Invalid value for ACCEL 29 Invalid value for DECEL 30 Invalid value for TVEL 31 Invalid value for RVEL 32 Invalid value for LEAVE 33 Invalid value for REACH 34 Invalid value for BLEND. Range is [1..3] 35 Userframe cannot be computed. Check the position of the 3 construction points 36 Invalid point index for Userframe computation range is: [1..3] 37 Invalid configuration for a point 38 Try to access a datatype that does not exist. (1=Point 2=Joint 3=TCP 4=Mdesc) 39 Invalid size for a bank 40 Position not reachable. 41 Motion stack is locked because a previous motion has failed. 43 Change in configuration detected - Shoulder 44 Change in configuration detected - Elbow 45 Change in configuration detected - Wrist 46 Robot powering ON/OFF sequence has failed. 47 48 Cannot execute movement, no database has been loaded. 49 50 Cannot change monitor speed. Robot not in ‘Remote’ working mode. 51 User-frame number is out of range [0..31] 52 Tool number is out of range [0..31] 60 uni VALplc client library initialization failed. 61 Parameter Axes Group not in range. 62 Index parameter not in range. 63 Invalid Buffer mode (0='Aborted' 1='Buferred' 6='Blending Joint' 7='Blending Cartesian') 64 Invalid Transition Mode (0=’None’ 3=’Corner distance’ 10=’Blending distances). 65 Communication reset during transaction. (Communication protocol aborted) 66 Data of the profinet module cannot be read at specified address. 67 Invalid inpt/output signal number. 68 Operation timeout. Server acknowledgment missed. 90 Remote MCP mode not activated. Dummy plug not detected. Check that dummy plug is installed on J110. 92 Invalid Jog mode selected. (1=Joint 2=Frame 3=Tool) 93 Cannot jog: Manual mode requested 94 Cannot jog: Robot power is OFF 110 Internal error #10 while loading a data base. Please contact your local Stäubli business unit 111 Internal error #11 while loading a data base. Please contact your local Stäubli business unit 112 Internal error #12 while loading a data base. Please contact your local Stäubli business unit 113 Internal error #13 while loading a data base. Please contact your local Stäubli business unit 114 Internal error #14 while loading a data base. Please contact your local Stäubli business unit 120 Internal error #20 while loading a data base. Please contact your local Stäubli business unit 121 Internal error #21 while loading a data base . Please contact your local Stäubli business unit 122 Internal error #22 while loading a data base. Please contact your local Stäubli business unit 123 Internal error #23 while loading a data base. Please contact your local Stäubli business unit 90 Version: 1.3.4 TF5130
## Page 91

PLC API Id Description 130 Internal error #30 while loading a data base. Please contact your local Stäubli business unit 131 Internal error #31 while loading a data base. Please contact your local Stäubli business unit 132 Cannot load database, Device not found. 133 Cannot load database, Device not ready 134 Cannot load database, Device timeout 139 Cannot load database, File not found 142 Cannot load database, No answer from FTP server. 199 Not response from RSI board. 200 Enveloppe error.(0x1503) 201 internal DSI board voltage error 202 redundancy check error in DSI board 203 internal DSI error 204 communication error with one encoder 205 shortcut on RBR signal enable1 (J1204) 206 shortcut on RBR signal enable2 (J1204) 207 shortcut on RBR signal mode1 (J1204) 208 shortcut on RBR signal mode2 (J1204) 209 shortcut on RBR signal select1 (J1204) 210 shortcut on RBR signal select2 (J1204) 211 shortcut on RBR signal select3 (J1204) 212 shortcut on RBR signal select4 (J1204) 213 invalid voltage on a RBR input 214 open wire on brake 1 215 open wire on brake 2 216 open wire on brake 3 217 open wire on brake 4 218 open wire on brake 5 219 open wire on brake 6 220 DSI board alarm: unexpected encoder feedback on axis 1 221 DSI board alarm: unexpected encoder feedback on axis 1 222 DSI board alarm: unexpected encoder feedback on axis 2 223 DSI board alarm: unexpected encoder feedback on axis 2 224 DSI board alarm: unexpected encoder feedback on axis 3 225 DSI board alarm: unexpected encoder feedback on axis 3 226 DSI board alarm: unexpected encoder feedback on axis 4 227 DSI board alarm: unexpected encoder feedback on axis 4 228 DSI board alarm: unexpected encoder feedback on axis 5 229 DSI board alarm: unexpected encoder feedback on axis 5 230 DSI board alarm: unexpected encoder feedback on axis 6 231 DSI board alarm: unexpected encoder feedback on axis 6 232 cut wire, disconnected or shortcut on valve A1 233 cut wire, disconnected or shortcut on valve A2 234 cut wire, disconnected or shortcut on valve B1 235 cut wire, disconnected or shortcut on valve B2 236 cut wire, disconnected or shortcut on brake 1 237 cut wire, disconnected or shortcut on brake 2 238 cut wire, disconnected or shortcut on brake 3 239 cut wire, disconnected or shortcut on brake 4 TF5130 Version: 1.3.4 91
## Page 92

PLC API Id Description 240 cut wire, disconnected or shortcut on brake 5 241 cut wire, disconnected or shortcut on brake 6 242 shortcut on a valve signal 243 shortcut on a brake signal 244 shortcut on a RBR signal 245 DSI temperature is too high 246 invalid brake power supply 247 unexpected voltage on encoder 1 power supply 248 unexpected voltage on encoder 2 power supply 249 unexpected voltage on encoder 3 power supply 250 unexpected voltage on encoder 4 power supply 251 unexpected voltage on encoder 5 power supply 252 unexpected voltage on encoder 6 power supply 253 DSI in standalone mode: please check if RBR is not activated or press update button 254 An encoder change detected. Encoder validation procedure is required (calibration page). 255 safety alarm: reboot is required after validation of the faulty safety signal 256 unexpected STO feedback from the drives: STO1 OFF 257 unexpected STO feedback from the drives: STO1 ON 258 unexpected STO feedback from the drives: STO2 OFF 259 unexpected STO feedback from the drives: STO2 ON 260 diagnostic is missing. Check safety board I/O on control panel 261 diagnostic is missing. Check safety board I/O on control panel 262 inconsistent safety stop signal from the MCP (MCPES1 off) 263 inconsistent safety stop signal from the MCP (MCPES2 off) 264 inconsistent safety stop signal from user stop USIA (USIA1 (J100-1, J101-7) off) 265 inconsistent safety stop signal from user stop USIA (USIA2 (J100-2, J101-8) off) 266 inconsistent safety stop signal from user stop USIB (USIB1 (J100-5) off) 267 inconsistent safety stop signal from user stop USIB (USIB2 (J100-6) off) 268 inconsistent safety stop signal from user stop USIC (USIC1 (J100-9) off) 269 inconsistent safety stop signal from user stop USIC (USIC2 (J100-10) off) 270 inconsistent safety stop signal from user stop USID (USID1 (J100-13) off) 271 inconsistent safety stop signal from user stop USID (USID2 (J100-14) off) 272 communication lost between the CPU and the safety board 273 drive error 274 interruption or too much delay in the communication between the MCP and the safety board 275 safety stop request from MCP 276 safety stop request from MCP 277 safety stop request from MCP 278 ESTOP on WMS (J101 5-7,6-8) or safety stop request from user USIA (J100 1-3,2-4) 279 user stop USIA1 (J100-1) 280 user stop USIA2 (J100-2) 281 user stop USIB (J100-5/6) 282 user stop USIB1 (J100-5) 283 user stop USIB2 (J100-6) 284 user stop USIC (J100-9/10) 285 user stop USIC1 (J100-9) 286 user stop USIC2 (J100-10) 287 user stop USID (J100-13/14) 92 Version: 1.3.4 TF5130
## Page 93

PLC API Id Description 288 user stop USID1 (J100-13) 289 user stop USID2 (J100-14) 290 no working mode request from the CPU (safety need a WMS and there is no WMS connected) 291 SS1 safety stop condition from external safety PLC 292 SS2 safety stop condition from external safety PLC 293 diagnostic is missing. Check safety board I/O on control panel 294 diagnostic is missing. Check safety board I/O on control panel 295 WMS stop (WMS signal WMS-Local (J101-1)) 296 WMS stop (WMS signal WMS-Remote (J101-2)) 297 WMS stop (WMS signal WMS-Manu (J101-3)) 298 working mode change 299 working mode change 300 working mode change 301 arm power is not allowed in brake release mode 302 diagnostic is missing. Check safety board I/O on control panel 303 brake test timeout 304 activation of brake test mode 305 the MCP plug was not placed in time after the MCP removal request 306 a safety restart is needed 307 safety reset signal activated 308 the enabling device is released 309 release the enabling device and press it again 310 safe velocity required but disabled 311 safe referencing required but not defined 312 safety overspeed 313 safe joint limits overpassed 314 movement detected in Safe Operating Stop mode 315 the enabling device was not released 1s after activation of service auto 316 safety stop request from Zone1 317 safety stop request from Zone2 318 diagnostic is missing. Check safety board I/O on control panel 319 diagnostic is missing. Check safety board I/O on control panel 320 diagnostic is missing. Check safety board I/O on control panel 321 diagnostic is missing. Check safety board I/O on control panel 322 diagnostic is missing. Check safety board I/O on control panel 323 diagnostic is missing. Check safety board I/O on control panel 324 diagnostic is missing. Check safety board I/O on control panel 325 manual slow working mode expected 326 brake release mode expected to open brakes without arm power 327 a brake is still in closing phase 328 no brake is selected 329 several brakes are selected 330 no communication between CPU and safety board RSI9 331 diagnostic is missing. Check safety board I/O on control panel 332 diagnostic is missing. Check safety board I/O on control panel 333 diagnostic is missing. Check safety board I/O on control panel 334 diagnostic is missing. Check safety board I/O on control panel 335 diagnostic is missing. Check safety board I/O on control panel TF5130 Version: 1.3.4 93
## Page 94

PLC API Id Description 336 diagnostic is missing. Check safety board I/O on control panel 337 diagnostic is missing. Check safety board I/O on control panel 338 diagnostic is missing. Check safety board I/O on control panel 339 diagnostic is missing. Check safety board I/O on control panel 340 temperature out of range 341 internal voltage out of range 342 internal error 343 the safety application contains faults 344 safety configuration is corrupted 345 the safety configuration does not match the safety application 346 the format of the safety configuration is not supported 347 internal communication error 348 test output fault 349 input deactivation fault 350 signal on USIA1 (J100-1) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 351 signal on USIA2 (J100-2) is not the expected test signal TDO1 (J100-4, J101-6, J103-12) 352 signal on USIB1 (J100-5) is not the expected test signal TDO2 (J100-7/16, J103-5) 353 signal on USIB2 (J100-6) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 354 signal on USIC1 (J100-9) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 355 signal on USIC2 (J100-10) is not the expected test signal TDO3 (J100-12/15, J103-3) 356 signal on USID1 (J100-13) is not the expected test signal TDO3 (J100-12/15, J103-3) 357 signal on USID2 (J100-14) is not the expected test signal TDO2 (J100-7/16, J103-5) 358 signal on WMS-Local (J101-1) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 359 signal on WMS-Remote (J101-2) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 360 signal on WMS-Manu (J101-3) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 361 signal on WMS-Reset (J101-4) is not the expected test signal TDO1 (J100-4, J101-6, J103-12) 362 signal on Enabling1 (J103-8) is not the expected test signal TDO0 (J100-3/8/11, J101-5, J103-7) 363 signal on Enabling2 (J103-17) is not the expected test signal TDO1 (J100-4, J101-6, J103-12) 364 signal on Estop1 (J103-6) is not the expected test signal TDO2 (J100-7/16, J103-5) 365 signal on Estop2 (J103-4) is not the expected test signal TDO3 (J100-12/15, J103-3) 366 signal on USOA1 (J102-1) is not as expected 367 signal on USOA2 (J102-2) is not as expected 368 signal on USOB1 (J102-5) is not as expected 369 signal on USOB2 (J102-6) is not as expected 370 signal on USOC1 (J102-9) is not as expected 371 signal on USOC2 (J102-10) is not as expected 372 internal signal on STO1 (J222-10) is not as expected 373 internal signal on STO2 (J222-10) is not as expected 374 shortcut to 24V on USOA1 (J102-1) or USOA2 (J102-2) 375 shortcut to 24V on USOB1 (J102-5) or USOB2 (J102-6) 376 shortcut to 24V on USOC1 (J102-9) or USOC2 (J102-10) 377 shortcut to 24V on STO1 or STO2 378 shortcut to 24V on STO1 or STO2 379 safety overrun. Reduce the number/type of monitoring points 380 diagnostic is missing. Check safety board I/O on control panel 381 diagnostic is missing. Check safety board I/O on control panel 382 diagnostic is missing. Check safety board I/O on control panel 383 diagnostic is missing. Check safety board I/O on control panel 94 Version: 1.3.4 TF5130
## Page 95

PLC API Id Description 384 unreferenced error on DSI board 385 safety license missing or over 386 RSI temperature exceeds threshold 387 Encoder on Axis1 exceeds a temperature threshold 388 Encoder on Axis2 exceeds a temperature threshold 389 Encoder on Axis3 exceeds a temperature threshold 390 Encoder on Axis4 exceeds a temperature threshold 391 Encoder on Axis5 exceeds a temperature threshold 392 Encoder on Axis6 exceeds a temperature threshold 393 Safe referencing (manu or auto) need to be activated in safety program because of SEL, SLS or SZM configuration 394 continuous axis license not compatible with safety version lower than 200.004 395 maintenance mode is not allowed by the current user profile 396 current working mode is not allowed by the current user profile 397 Safe referencing inconsistency: positions of 'safe position 1' and 'safe position 2' should be different for all joint 398 SS2 is unsupported in current safety version (requested from external safety PLC?) 399 Invalid working mode. Try to perform an action which is not allowed in the current working mode. 400 Cannot settle arm power: error reading DSI temperature. 401 Cannot settle arm power: DSI temperature must be above 0 degrees Celsius. 403 Arm power shutdown: internal power error (24V_OK in ARPS module) 404 Arm power shutdown: controller power supply shutdown detected (MAIN_POWER_OK signal) 405 Arm power shutdown: due to prepare Cpu Shutdown VAL3 function call 406 Cannot apply arm power: controller not yet initialized. 407 Cannot apply arm power: simultaneous power off request. 408 Cannot apply arm power: arm power is still in disabling phase. 410 Overspeed on joint. (0x0209) 411 Cannot move: cannot cross singularity in this case.(0x021c) 412 Translation or Rotational velocity too high (0x021e) (0x021f) 413 Cartesian position unreachable with the specified configuration. (0x0215) 414 Jog mode cannot be selected: first enable arm power.(0x3f15) 415 Jog mode cannot be selected: first select manual working mode, then enable arm power. (0x3f16) 416 Jog move impossible: first select a jog mode.(0x3f19) 417 Invalid move axis or direction. (0x3f1A) 418 Cannot apply arm power: park the pendant on the cradle.(0x3f22) 420 421 438 Safety board communication error. Please check event logger of Stäubli controller. 440 system event CPU-Battery Off. CPU board battery is not present or dead. 441 system event CPU-Overcurrent. Overcurrent detected on CPU. 442 system event CPU-Cpu Reading Failed. CPU temperature reading failed. 443 system event CPU-BBReading Failed. Baseboard temperature reading failed. 444 system event CPU-Fan Reading Failed. CPU board fan speed reading error. 445 system event CPU-Battery Reading Failed. Battery state reading failed. 446 system event CPU-Overcurrent Reading Failed. CPU board overcurrent state reading error. 447 system event CPU-Cpu Temperature Low. CPU temperature is lower than minimum threshold). 448 system event CPU-Cpu Temperature Warning. CPU temperature exceeded the warning threshold. 449 system event CPU-Cpu Temperature Limit. CPU temperature exceeded the error threshold. Behaviour of CPU board is uncertain. TF5130 Version: 1.3.4 95
## Page 96

PLC API Id Description 450 system event CPU-BBTemperature Low. Baseboard temperature is lower than minimum threshold. 451 system event CPU-BBTemperature Warning. Baseboard temperature exceeded the warning threshold. 452 system event CPU-BBTemperature Limit. Baseboard temperature exceeded the error threshold Behaviour of CPU board is uncertain. 453 454 system event CPU-Fan High. CPU board fan speed is higher than limit. 455 CPU fan control failed. 456 Safety board error 'Not ready after a minute': Failed to initialize. Please reboot the controller. 457 Safety board error: Not ready anymore. 458 Safety alarm. 459 Safety error . A reboot is required. 460 Safety board error communication error. Please check event logger of Stäubli controller and Staubli support service. 461 470 Invalid safe referencing position. 471 Safety restart failed during safe referencing procedure. 472 The number of the safe reference position does not match the status of safe referencing procedure. 473 The reference position is out of range. 479 The test brake procedure failed. 480 No 481 Hibernate function not supported by controller 482 Timeout waiting for confirmation of the safety board. 483 Robot must be disabled to activate power save. 484 485 486 487 Wake up function not supported by controller 488 Timeout waiting for encoder interface ready state 489 Timeout waiting for safety board ready state 513 Internal motion generator error. 514 Invalid parameter value. 515 Invalid motion generator state. 520 Joint position out of software limits. 521 Position out of software limits on joints: %s. 522 Overspeed on joint %u. 525 Arm position not allowed. 526 Translation velocity too high. 527 Rotation velocity too high. 530 No joint solution found (no convergence). Cartesian position probably out of reach. 531 Cartesian position out of joint limits. 532 Cartesian position out of workspace. 533 Cartesian position unreachable with the specified configuration. 534 Orientation unreachable with this arm. 535 The arm position found is in a forbidden area. 536 The arm positions found are either outside joint limits or inside forbidden areas. 540 Cannot cross singularity in this case. 541 Internal error: Cartesian path discontinuity. 96 Version: 1.3.4 TF5130
## Page 97

PLC API Id Description 542 Configuration discontinuity: the joint position reached does not match the arm configuration requested for next movement. 543 Robot not at trajectory start position. 544 The Cartesian path is leading a multi-turn joint out of its range. 550 Circular arc: the angle between start and intermediate points exceeds 180 deg. 551 Circular arc: the angle between intermediate and end points exceeds 180 deg. 552 Circular arc: start, intermediate and end points are too close. 553 Circular arc: the orientation change between start and intermediate, or intermediate and end points is exactly 180 deg. The direction of the move is 554 Cartesian blending: the rotation is too large. Move direction maybe ambiguous. 560 No blending supported with compliant moves. 561 No blending supported with movej Sync. 562 'joint' blending not supported with tracking movements. Use 'Cartesian' instead. 563 No blending supported with traj Move. 564 No blending supported with splines. 565 Invalid blending in mdesc : 'Cartesian' blending is not possible when switching between {external axes+arm} and {arm only} kinematics. 570 Invalid data for this arm (wrong number of joints or wrong kinematic). 571 Invalid kinematic chain part. 572 Part mounting error: a reset Motion() is required to switch to carried part trajectory mode. 573 Part mounting error: a reset Motion() is required to switch to carried tool trajectory mode. 574 Part mounting error: carried part mode is not supported for this move. 580 A 'track On' movement is required to start a conveyor tracking sequence. 581 A 'track Off' movement is required to end a conveyor tracking sequence. 582 The moving frame is different from the previous one. Use a 'trackon' movement to switch between moving frames. 583 The tracking movements stopped: %s 584 Tracking iterations failed: the conveyor may be out of reach or too fast. 585 Internal tracking error. 586 Conveyor too fast to be tracked. 590 Alter: invalid status, command ignored. 591 Alter: alteration of the path starting. 592 Alter: alteration of the path stopping. 800 Unexpected application runtime error. Check error logger 810 Invalid numerical calculation (division by zero). 811 Invalid numerical calculation (e.g.ln(-1)) 820 Access to an array with an index that is larger than the array size. 821 Access to an array with negative index or resize to zero. 829 Invalid task name. See task Create() instruction. 830 The specified name does not correspond to any VAL 3 task. 831 A task with the same name already exists. See task Create instruction. 832 Only 2 different periods for synchronous tasks are supported. Change scheduling period. 840 Not enough memory space available. 841 Not enough memory space to run the task. See the run memory size. 860 Maximum instruction run time exceeded. 861 Internal VAL 3 interpreter error 870 Invalid instruction parameter. See the corresponding instruction. 880 Uses data or a program from a library not loaded in the memory. 881 Incompatible kinematic: Use of a point/joint/config that is not compatible with the arm kinematic. TF5130 Version: 1.3.4 97
## Page 98

PLC API Id Description 882 The reference frame or tool of a variable belongs to a library and is not accessible. 890 The task cannot resume from the location specified. See task Resume() instruction. 900 The speed specified in the motion descriptor is invalid (negative or too great). 901 The acceleration specified in the motion descriptor is invalid (negative or too great). 902 The deceleration specified in the motion descriptor is invalid (negative or too great). 903 The translation velocity specified in the motion descriptor is invalid (negative or too great). 904 The rotation velocity specified in the motion descriptor is invalid (negative or too great). 905 The reach parameter specified in the movement descriptor is invalid (negative). 906 The leave parameter specified in the movement descriptor is invalid (negative). 922 Attempt to write in a system input. 923 Use of a dio, aio or sio input/output not connected to a system input/output. 924 Attempt to access a protected system input/output 925 Read or write error on a dio, aio or sio (field bus error) 950 Cannot run this movement instruction: a previous movement request could not be completed (point out of reach, singularity, configuration problem, etc.) 953 Movement command not supported 954 Invalid movement instruction: target out of reach, or check the movement descriptor. 960 Invalid flange tool coordinates 961 Invalid world tool coordinates 962 Use of a point without a reference frame. See Definition. 963 Use of a frame without a reference frame. See Definition. 964 Use of a tool without reference tool. See Definition. 965 Invalid frame or reference tool (global variable linked to a local variable) 999 Unexpected error. Please check event logger of Stäubli controller. 98 Version: 1.3.4 TF5130
## Page 99

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5130 Version: 1.3.4 99
## Page 100

Trademark statements Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Third-party trademark statements Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies.
## Page 101

More Information: www.beckhoff.com/tf5130 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
