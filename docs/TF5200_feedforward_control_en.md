---
title: "TF5200_feedforward_control_en"
product: "TF5200"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.05"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_feedforward_control_en.pdf"
release_date: "2025-06-06"
---
Functional description | EN TF5200 | Twin CAT 3 CNC Feedforward control 6/6/2025 | Version: 1.05
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5200 | Twin CAT 3 CNC Version: 1.05 3 Feedforward control
## Page 4

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. 4 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 5

Table of contents Table of contents Notes on the documentation.................................................................................................................... 3 General and safety instructions.............................................................................................................. 4 1 Overview.................................................................................................................................................... 8 2 Description................................................................................................................................................ 9 3 Programming........................................................................................................................................... 12 4 Example: Parameterising feedforward control with additive command values............................... 16 4.1 Velocity feedforward control............................................................................................................ 16 4.2 Acceleration feedforward control..................................................................................................... 19 5 Parameter................................................................................................................................................. 22 5.1 Overview......................................................................................................................................... 22 5.2 Description...................................................................................................................................... 23 6 Support and Service............................................................................................................................... 33 Index......................................................................................................................................................... 34 TF5200 | Twin CAT 3 CNC Version: 5 Feedforward control
## Page 6

Table of contents 6 Version: TF5200 | Twin CAT 3 CNC Feedforward control
## Page 7

List of figures List of figures Fig. 1 Block diagram of conventional feedforward control..................................................................... 9 Fig. 2 Block diagram of feed forward control with additive setpoints..................................................... 11 Fig. 3 Position lag without feedforward control...................................................................................... 14 Fig. 4 Position lag with speed feedforward control................................................................................. 14 Fig. 5 Position lag with speed and acceleration feedforward control..................................................... 15 TF5200 | Twin CAT 3 CNC Version: 1.05 7 Feedforward control
## Page 8

Overview 1 Overview Task When an axis is interpolated, the real actual position of the axes at the interpolated set position takes place with a certain time delay due to the properties of the position control algorithms used and bus delays. The difference between command and actual position is referred to as position lag. Path errors occur on curved paths due to position lag. The is the case in particular for a path compound with axes of different dynamics. Position lag and therefore the path error can be minimised by using feedforward control. Feedforward control by the controller compensates for position lag based on the current speed and acceleration. Feedforward control can be adapted to the machine dynamics and the required path accuracy by entering the appropriate parameters in the axis parameter lists [AXIS] and also in the NC program. Effectiveness Feedforward control is available for all axis and drive types [AXIS]. Programming The feedforward control mode is selected in the NC program. Programming takes place using the modal commands G135, G136 and G137 [PROG]. Parameterisation The parameter P-AXIS-00223 enables feedforward control for each axis or spindle. The required parameters are entered in the constant V_SATZ_ANZ. For other parameters see Chapter “Parameters”. [} 22] Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 8 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 9

Description 2 Description Principle Position lag is caused by control system delay in speed, acceleration and jerk in the position controller with respect to the command variable calculated in the interpolator. Feedforward control calculates the theoretical position lag to be set in the interpolator and which would result from the current speed, acceleration and jerk. From this, it calculates the command speed value v Vorsteuerung which is then added to the position controller output (see Fig. “Block diagram of conventional feedforward control”). This additional command value can be weighted with a factor. The position lag expected from the axis speed Δs is obtained from the equation: v Δs = v/K v v The position lag expected from constant acceleration Δs is obtained from: a Δs = a*T /K a a v The position lag expected from constant jerk Δs results from: j Δs = j+T /K2 j a v Where T is the mechanical time constant of the drive. a Alternatively the command velocities and accelerations calculated in the CNC controller can be transferred as additive speed and torque command values to the drive controller and fed into the appropriate control loops as additive command values (see figure below). Position controller Motor Mechanic Following x Setpoint value X S + error X D v s + i - + 1 1 G S = K V G Motor = 1+Ta s G Schlitten = s Position actual value X i T : mechanical time constant of the drive a Feedforward control Weighting of velocity: d Xs P-AXIS-00514: feedforward_v_add_num dt P-AXIS-00515: feedforward_v_add_denom Weighting of acceleration: + Global weighting d2 Xs P-AXIS-00225: vs_a_faktor of feedforward dt2 P-AXIS-00226: vs_a_nenner + P-AXIS-00228: vs_v_faktor + P-AXIS-00229: vs_v_nenner d3 Xs Weighting of jerk: dt3 P-AXIS-00337: jerk_fact_nom P-AXIS-00338: jerk_fact_denom NC-Commands Type of feedforward control - G135 Selection P-AXIS-00223: vorsteuerung - G136 Weighting - G137 Deselection Fig. 1: Block diagram of conventional feedforward control Feedforward control modes Based on the cause of the position lag, the control system distinguishes between the following feedforward control modes • Velocity feedforward control TF5200 | Twin CAT 3 CNC Version: 1.05 9 Feedforward control
## Page 10

Description • Acceleration feedforward control and • Jerk feedforward control. All feedforward control modes can be enabled or parameterised independently of one another. Feedforward control for spindles In the case of spindles, feedforward control is particularly necessary for thread tapping with endlessly rotating spindles since an ideal machining result is obtained by maintaining the specified command values with as few position lags as possible on both path axes and spindles. Activation The parameter P-AXIS-00223 enables feedforward control for each axis or spindle. When the corresponding bits are set, the feedforward control modes are selected and further control information is also activated. The feedforward control mode is selected in the NC program. NOTICE Note that the axes may overshoot when feedforward control is enabled. Therefore, please be careful when parameterising feedforward control. Set the correct weighting factors in the axis parameter lists and in the NC program. Weighting The resulting feedforward control parameter can be weighted with 2 axis-specific factors. The parameters P- AXIS-00228 and P-AXIS-00229 weight the entire feedforward control process. Weighting = P-AXIS-00228/P-AXIS-00229 vorsteuerung Acceleration feedforward control can also be weighted by a real-time constant T which is defined by the a parameters P-AXIS-00225 and P-AXIS-00226. T = P-AXIS-00225/P-AXIS-00226 a Jerk feedforward control can also be weighted by a factor Weighting = P-AXIS-00337/P-AXIS-00338 Ruckvorsteuerung which is defined from the parameters P-AXIS-00337 and P-AXIS-00338. Empirically, the entire feedforward control can be weighted by a factor in the range of 0.7–1. At val- ues >1 the axis is ahead of and the accuracy of the contour is falling off. 10 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 11

Description Position- Velocity- Current- Motor + Following controller controller Controller Load error X D Setpoint value X S + Vs+ Is+ X i + - + - - Time delay command position: Additive velocity Additive current P-AXIS-00357 command value command value P-AXIS-00513 Actual velocity Vi Feedforward Time dealy: Activation P-AXIS-00223 Weighting of Global weighting P-AXIS-00389 velocity: of feedforward: d Xs P-AXIS-00514 P-AXIS-00228 feedforward_v_add_num vs_v_faktor dt P-AXIS-00515 P-AXIS-00229 feedforward_v_add_denom vs_v_nenner Time delay: Activation: P-AXIS-00390 P-AXIS-00223 Weighting of Global weighting acceleration: of feedforward: d2 Xs P-AXIS-00225 P-AXIS-00228 dt2 vs_a_faktor vs_v_faktor P-AXIS-00226 P-AXIS-00229 vs_a_nenner vs_v_nenner Fig. 2: Block diagram of feed forward control with additive setpoints Parameterisation for PROFIdrive drives PROFIdrive drives require the following additional parameters which must be set in the axis parameter lists: • P-AXIS-00092: Position controller increments per revolution • P-AXIS-00165: time offset of feedforward control parameters With PROFIdrive drives, the parameter P-AXIS-00223 selects how to transfer the calculated feedforward control value to the drive: • P-AXIS-00223, Bit 9 = 0: The feedforward control value is calculated in the control deviation (XERR – signal No. 25) as a position lag. • P-AXIS-00223, Bit 9 = 1: The feedforward control value is included in the speed command value as a speed (NSOLL_B – signal No. 7). NOTICE SERCOS drives With SERCOS drives, if feedforward control is to be implemented in the NC control system and not in the drive, the Kv factor in the axis parameter list must be set identical to the Kv factor of the SERCOS drive (IDN: (S-0-0104). With SERCOS drives, feedforward control is normally implemented in the drive itself and is set with the following parameters: IDN: S-0-0296: Velocity feed forward gain IDN: S-0-0348: Acceleration feedforward gain TF5200 | Twin CAT 3 CNC Version: 1.05 11 Feedforward control
## Page 12

Programming 3 Programming Feedforward control is programmed in the NC program using the modal commands G135, G136 and G137 [PROG]. Selecting feedforward control with G135 Feedforward control is explicitly deactivated every time the program is started. The axis group-specific activation of feedforward control is programmed by the NC command G135. Weighting of feedforward control with G136 An axis-specific, percentage weighting of the calculated feedforward control variables takes place with G136. It is limited to 100% for all axes. The weighting factors are reset to 100% after every program start. If feedforward control is activated or deactivated during the NC program, the weighting factors remain set to the values set by G136. For axes with no G136 programmed, the weighting factor remains set to 100%. It is also possible to enter the selection and weighting of feedforward control in a single block. Deselecting feedforward control with G137 G137 deactivates axis group-specific feedforward control. Deactivating individual axes With axes for which no feedforward control is to be implemented after global selection with G135, a percentage weighting of 0% must be specified with G136 . Selecting and weighting feedforward control G135 (Select feedforward control; weighting) (for all axes 100%) G136 X80 Y95 Z0 (weighting; here, the Z axis) (has no feedforward control) 12 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 13

Programming Parameterising spindles Feedforward control for spindles is also programmed in the NC program using the modal commands G135, G136 and G137 [PROG]. These commands permit the spindle-specific programming of feedforward control. The commands may not be used simultaneously with other spindle-specific commands. Parameterising spindles S[G135] (Activate feedforward control for S) S[G136=80] (Define weighting in %) S[G137] (Deactivate feedforward control) S2[G135 G136=90] ( at 90% weighting for S2) S2[G136=0] (Change weighting to 0%) S1[G135] (Activate with default weighting 100% for S1) Delay The calculation of feedforward values involves a delay of at least one cycle between the interpolator and the position controller. NOTICE Effects of delay on measurement run In the worst case, an error may occur during a measurement run since the interpolator, which monitors the touch probe stroke, ignores the distance components in the block buffer between the interpolator and posi- tion controller. This can be prevented by increasing the actual stroke of the measuring probe in the parameter P- AXIS-00086 (hub_messtaster). TF5200 | Twin CAT 3 CNC Version: 1.05 13 Feedforward control
## Page 14

Programming Examples The figures below show the measured position lags with and without speed and acceleration feedforward control for a simple path motion. The figure below shows a clear position lag over the entire path motion. Fig. 3: Position lag without feedforward control When speed feedforward control is activated, position lag peaks only occur in acceleration phases. Within the constant speed range, position lag is fully compensated by feedforward control (see figure below). Fig. 4: Position lag with speed feedforward control 14 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 15

Programming Position lag can be further reduced in acceleration phases by means of additional acceleration feedforward control (see figure below). Fig. 5: Position lag with speed and acceleration feedforward control TF5200 | Twin CAT 3 CNC Version: 1.05 15 Feedforward control
## Page 16

Example: Parameterising feedforward control with additive command values 4 Example: Parameterising feedforward control with additive command values A number of settings are required to use speed feedforward control and acceleration feedforward control. The list below contains an overview of settings. They are explained in the sections. Velocity feedforward control The parameter P-AXIS-00223 first selects the • conventional speed feedforward control (see also the block diagram “Block diagram of conventional feedforward control”) or • outputs the speed feedforward control value as an additive command value (see also block diagram: "Block diagram of feed forward control with additive setpoints") • Configure the additive command value in cyclic process data. In both cases speed scaling follows as 2. Schritt in the following parameters: • P-AXIS-00205 • P-AXIS-00206 • P-AXIS-00207 Then the weighting factors must be set by the parameters: • P-AXIS-00228 • P-AXIS-00229 Acceleration feedforward control: First select the following using P-AXIS-00223: • Acceleration feedforward control • output of acceleration feedforward control value Then calculate the required motor torque. Configure the path resolution of the axis in: • P-AXIS-00092 • P-AXIS-00233 • P-AXIS-00234 • P-AXIS-00362 and • P-AXIS-00363 Then enter the total motor load in P-AXIS-00391 in the unit kg*m2 Calculate the required motor torque/current command value. Enter the nominal torque of the motor as a reference value for torque scaling in P-AXIS-00392 • Torque scaling factor in the parameters P-AXIS-00325 and P-AXIS-00326. • The value for P-AXIS-00392 is contained in the motor data sheet. Finally, enter the acceleration feedforward control delay related to the set position in the parameter P- AXIS-00390. 4.1 Velocity feedforward control Configuration In order to apply velocity feedforward control, first configure velocity feedforward control in P-AXIS-00223 and the output of the velocity feedforward control value as an additive command value: 16 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 17

Example: Parameterising feedforward control with additive command values vorsteuer.vorsteuerung 0x101 #0x001: Activation velocity feedforward #0x100: Output as additive velocity command value Configure the additive velocity command value in the cyclic process data. If the output of velocity feedforward control is activated as an additive command value and no addit- ive velocity command value is configured in the cyclic process data, the error message ID 70350 is output. Velocity scaling Velocity scaling then needs to be parameterised. The parameters P-AXIS-00205, P-AXIS-00206 and P- AXIS-00207 are used for this. The velocity that is set for the axis and includes all the transfer elements (e.g. gear ratio and spindle pitch) is entered in the parameter P-AXIS-00205 if a value of P-AXIS-00206 is output to the speed interface. The timebase used at the velocity interface is entered in the parameter P-AXIS-00207. Velocity feedforward control A SERCOS drive which has a spindle pitch of 10 mm/rev and a default scaling for speed data (10-4 rpm), results in a translatory axis speed of 10 mm/min (10,000 * 10-4 rpm * 10 mm/rev) when the value 10,000 is output as the speed command value at the drive. Therefore set the following values for the parameters P-AXIS-00205, P-AXIS-00206 and P-AXIS-00207 antr.v_time_base 0 #Timebase per minute antr.v_reso_num 10000 #Output value to drive antr.v_reso_denom 10000 #Resulting axis velocity in um/ v_time_base If a gear with a gear ratio of i=3 (n /n ) is also included, the translatory speed of the axis is reduced to Motor Load 3.333 mm/min (10,000 * 10-4 rpm / i * 10 mm/rev) for the same output value. This results in the following values for P-AXIS-00206 and P-AXIS-00207: antr.v_time_base 0 #Timebase per minute antr.v_reso_num 10000 #Outputvalue to drive antr.v_reso_denom 3333 #Resulting axis velocity in um/ v_time_base In addition the output of the speed feedforward control value can be delayed in relation to the position command value. This delay can be set by the parameter P-AXIS-00389. The maximum delay time that can be set is one position controller cycle. If a longer delay time is parameterised, the error message ID 70349 is output and the delay time is set to 0. The resulting parameter set is therefore: vorsteuer.vorsteuerung 0x101 #0x001: Activation velocity feedforward #0x100: Output as additive velocity command value vorsteuer.velocity_delay_time 150 # Delay velocity feedforward against position # command value in us antr.v_time_base 0 #Timebase per minute antr.v_reso_num 10000 #Outputvalue to drive antr.v_reso_denom 3333 #Resulting axis velocity in um/ v_time_base In addition, configure the additive velocity command value in the cyclic process data of the drive. TF5200 | Twin CAT 3 CNC Version: 1.05 17 Feedforward control
## Page 18

Example: Parameterising feedforward control with additive command values antr.sercos.at[0].ident_nr 37 antr.sercos.mdt[0].ident_len 4 antr.sercos.mdt[0].nc_ref S_0_0037 18 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 19

Example: Parameterising feedforward control with additive command values 4.2 Acceleration feedforward control Configuration To apply acceleration feedforward control, first configure acceleration feedforward control in P-AXIS-00223 and the output of the acceleration feedforward control value as an additive command value: vorsteuer.vorsteuerung 0x202 #0x002: Activation accele- ration feedforward #0x200: Output as additive torque command value In addition, configure the additive torque/current command values in the cyclic process data: antr.sercos.at[0].ident_nr 37 antr.sercos.mdt[0].ident_len 4 antr.sercos.mdt[0].nc_ref S_0_0037 If the output of acceleration feedforward control is activated as an additive command value and no additive torque/current command value is configured in the cyclic process data, the error message ID 70351 is output. Torque calculation With acceleration feedforward control using an additive torque or an additive current command value, the required motor torque is calculated by the equation below. M = J *a tot or F = m *a tot This torque is rescaled to the format used by the motor and then output to the drive. Since specific knowledge of the mechanical structure of the axis is required to calculate angular acceleration, it is advisable to configure the path resolution of the axis by specifying the parameters P-AXIS-00092, P- AXIS-00233, P-AXIS-00234, and P-AXIS-00362 and P-AXIS-00363. If a value unequal to 1 is assigned to one of the two parameters P-AXIS-00362 and P-AXIS-00363, the path resolution is calculated by the equation: TF5200 | Twin CAT 3 CNC Version: 1.05 19 Feedforward control
## Page 20

Example: Parameterising feedforward control with additive command values Parameter set The following parameter set results for an axis with a motor encoder resolution of 220 increments per revolution, a gearbox ratio of 3 and a spindle pitch of 5 mm/rev: antr.feed_const_num 50000 #feedconstant 5mm per revolution antr.feed_const_denom 1 getriebe[0].incr_per_rev 1048576 #2**20 increments per motor revolution getriebe[0].gear_fact_num 3 #gearbox ratio: input revolutions getriebe[0].gear_fact_denom 1 #gearbox ratio: output revolutions A further parameter requires the total motor load (J ). tot J consists of: tot • Total of motor moments of inertia and • load torque referred to the motor shaft. Enter the resulting value in the parameter P-AXIS-00391 in the unit kg*m2. getriebe[0].load 0.48 #Total motor load 0.48 kg*m**2 The required motor torque can be calculated using the parameters now available. The following parameters are also required to calculate the torque/current command value output to the drive: 1. Motor nominal torque as reference value for torque scaling in P-AXIS-00392. 2. Torque scaling factor in the parameters P-AXIS-00325 and P-AXIS-00326. The value for P-AXIS-00392 is contained in the motor data sheet: antr.acc_reference_value 0.45 #stall torque in Nm Enter the value which must be output as additive torque command value for the parameters P-AXIS-00325 and P-AXIS-00326 so that the motor outputs its nominal torque. This value depends on the torque scaling used in the drive. For example, if a percentage weighting is used in 0.1% referred to the maximum current of the drive amplifier, the following results for a maximum current of 3.16 A and a nominal current of 1.58 A for the parameters P-AXIS-00325 and P-AXIS-00326: P-AXIS-00325/P-AXIS-00326 = 1,58A/3,16A * 1000 = 500 The possible values for P-AXIS-00325 and P-AXIS-00326 would then be, for example: antr.torque_scale_num 500 antr.torque_scale_denom 1 In addition, the output of the acceleration feedforward value can still be delayed in relation to the position command value; this delay can be set by the P-AXIS-00390 parameter. The maximum delay time that can be set is one position controller cycle. If a longer delay time is parameterised, the error message ID 70348 is output and the delay time is set to 0. The feedforward value to be output can be weighted by the parameters P-AXIS-00225 and P-AXIS-00226. In the following example the feedforward value is 1.2. vorsteuer.vs_a_faktor 12 # Weighting acceleration feedforward numerator vorsteuer.vs_a_nenner 10 # Weighting acceleration feedforward denominator 20 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 21

Example: Parameterising feedforward control with additive command values The resulting parameter set is therefore: vorsteuer.vorsteuerung 0x202 #0x002: Activation accele- ration feedforward #0x200: Output as additive torque command value antr.feed_const_num 50000 #feedconstant 5mm per revolution antr.feed_const_denom 1 # getriebe[].incr_per_rev 1048576 #2**20 increments per motor revolution getriebe[].wegaufz 3 #gearbox ratio: input revolutions getriebe[].wegaufn 1 #gearbox ratio: output revolutions antr.acc_reference_value 0.45 #stall torque in Nm antr.torque_scale_num 500 antr.torque_scale_denom 1 vorsteuer.acceleration_delay_time 150 # Delay accele- ration feedforward against # position command value in us vorsteuer.vs_a_faktor 12 # Weighting acceleration feedforward numerator vorsteuer.vs_a_nenner 10 # Weighting acceleration feedforward denominator TF5200 | Twin CAT 3 CNC Version: 1.05 21 Feedforward control
## Page 22

Parameter 5 Parameter 5.1 Overview Constant Description V_SATZ_ANZ Maximum number of buffered blocks ID Parameter Description P-AXIS-00092 incr_per_rev Position controller increments per revolution P-AXIS-00165 shift_time PROFIdrive: time offset of feedforward control parameters P-AXIS-00205 v_reso_denom Denominator, scaling factor for speed scaling P-AXIS-00206 v_reso_num Numerator, scaling factor for speed scaling P-AXIS-00207 v_time_base Time base for scaling factor for speed scaling P-AXIS-00223 vorsteuerung Feedforward control mode P-AXIS-00225 vs_a_faktor Substitute time constant for acceleration feedforward control, numerator P-AXIS-00226 vs_a_nenner Substitute time constant for acceleration feedforward control, denominator P-AXIS-00228 vs_v_faktor Weighting factor for feedforward control, numerator P-AXIS-00229 vs_v_nenner Weighting factor for feedforward control, denominator P-AXIS-00255 default_active Permanent activation of feedforward control P-AXIS-00325 torque_scale_num Numerator, scaling factor, torque scaling P-AXIS-00326 torque_scale_denom Denominator, scaling factor, torque scaling P-AXIS-00337 jerk_fact_num Weighting factor for jerk feedforward control, numerator P-AXIS-00338 jerk_fact_denom Weighting factor for jerk feedforward control, denominator P-AXIS-00362 feed_const_num Feed constant numerator P-AXIS-00363 feed_const_denom Feed constant denominator P-AXIS-00389 velocity_delay_time Delay time for speed feedforward control value P-AXIS-00390 acceleration_delay_tim Delay time for acceleration feedforward control value e P-AXIS-00391 load Motor load P-AXIS-00392 feed_const_denom Feed constant denominator P-AXIS-00511 gear_fact_num Gearbox ratio numerator P-AXIS-00512 gear_fact_denom Gear ratio denominator 22 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 23

Parameter 5.2 Description P-AXIS-00092 Position controller increments per revolution Description This parameter contains the number of position controller increments per revolution of the motor axis. The internal value used in the CNC kernel (value after assessing the value transmitted in the bus telegram) is output with the parameters P-AXIS-00405 (SERCOS and CANopen drives), or P-AXIS-00065 (PROFIDRIVE drives). When this parameter is used, the parameters P-AXIS-00362/P-AXIS-00363 and P-AXIS-00511/P-AXIS-00512 ) must be used. Parameter getriebe[i].incr_per_rev Data type UNS32 Data range 0 ≤ incr_per_rev ≤ MAX(UNS32) Axis types T, R, S Dimension T: Increments/ rev. R,S: Increments/ rev. Default value 1024 Drive types ---- Remarks For possible applications, see. Settings of position scaling P-AXIS-00165 Time offset of feed forward control setpoints Description This parameter defines a time offset in NC cycles between the output of the setpoints and the output of the calculated feedforward control values. With a value > 0, the feedforward control values are output before the associated setpoint. This parameter optimises the behaviour of the feedforward control axis. Parameter vorsteuer.shift_time Data type UNS16 Data range 0 ≤ shift_time ≤ 4 Axis types T, R, S Dimension T: Number of interpolation cycles R,S: Number of interpolation cycles Default value 3 Drive types Profidrive Remarks P-AXIS-00205 Normalisation of the velocity (denominator) Description The conversion factor of the set velocity to drive format is obtained by specifying the value output to the drive and the related path distance covered in the time specified in P-AXIS-00207. This parameter specifies the conversion factor numerator. (P-AXIS-00206 is the numerator) This parameter indicates the path covered in the time specified in P-AXIS-00207, provided the value in P-AXIS-00206 is output to the drive. The path is specified in 1 µm or 0.001°. Parameter antr.v_reso_denom Data type UNS32 Data range 1 ≤ v_reso_denom ≤ MAX(UNS32) Axis types T, R, S Dimension T: 1µm R,S: 0,001° Default value 36 Drive types All drive types Remarks P-AXIS-00206 Normalisation of command velocity (numerator) TF5200 | Twin CAT 3 CNC Version: 1.05 23 Feedforward control
## Page 24

Parameter Description The conversion factor of the command velocity to drive format is defined by specifying the value output to the drive and the related distance covered in the time specified in P-AXIS-00207 . This parameter specifies the conversion factor numerator. (P-AXIS-00205 is the denominator) The factor indicates the number of velocity increments output. Parameter antr.v_reso_num Data type UNS32 Data range 0 ≤ v_reso_num ≤ MAX(UNS32) Axis types T, R, S Dimension T: increments R,S: increments Default value 1 Drive types All drive types Remarks P-AXIS-00207 Time base for normalisation of velocity Description The time base for adapting the velocity interface to the unit used in the drive can be specified as value per minute, second or sampling interval. If normalisation per sampling interval is selected, the output value changes proportionally depending on the CNC cycle time at constant velocity. This may be essential depending on the drive. Parameter antr.v_time_base Data type UNS16 Data range 0: per minute 1: per second 2: per sampling interval Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 Drive types SERCOS Remarks P-AXIS-00223 Feedforward control mode Description This parameter specifies bit-coded which reference variables (velocity, acceleration and jerk) are to be active during feedforward control. Parameter vorsteuer.vorsteuerung (feedforward) Data type STRING 24 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 25

Parameter Data range Flag Meaning Value NONE No feedforward control 0x0000 VEL Velocity feedforward control 0x0001 ACC Acceleration feedforward control 0x0002 JERK Jerk feedforward control 0x0004 ADD_VEL Velocity feedforward control by output of an additive 0x0101 velocity command value () PROFIdrive: In PROFIdrive telegram 5, the calculated feedforward control value is calculated as the velocity in the velocity command value (NSOLL_B - Signal No.7); as opposed to VEL, the feedforward value is calculated here as a position lag in the control deviation ((XERR - Signal No.25). ADD_ACC Acceleration feedforward control by output of an 0x0202 additive torque/current command value ADD_JERK Jerk feedforward control by output of an additive 0x0804 torque/current command value Axis types T, R, S Dimension T: ---- R,S: ---- Default value NONE Drive types ---- Remarks This function is available for all types of axes and types of drives. Jerk feedforward is only available when a jerk-limited velocity profile is used. For details on defining the acceleration profile, see P-CHAN-00071 and [PROG// Command #SLOPE [TYPE…] ]. The specification of values by codes is possible as of CNC Builds • V2.11.2034.6 • V2.11.2808.03 • V3.1.3065.04 and • V3.1.3102.00 . Examples: Velocity and acceleration feedforward control: vorsteuer.vorsteuerung VEL | ACC Velocity and acceleration feedforward control by additive command values: vorsteuer.vorsteuerung (feedforward) ADD_VEL | ADD_ACC In previous CNC Builds values had to be specified bit-coded for the UNS16 variable. Default value: 0 P-AXIS-00225 Numerator equivalent time constant for feedforward control of acceleration TF5200 | Twin CAT 3 CNC Version: 1.05 25 Feedforward control
## Page 26

Parameter Description The acceleration command variable is weighted by the mechanical time constant of the drive. The drive is modelled here as a first-order time delay element (see figure of the conventional feedforward control). The following transfer function in the Laplace range is obtained: with P-AXIS-00226: time constant denominator. Parameter vorsteuer.vs_a_faktor Data type SGN32 Data range 0 ≤ vs_a_faktor ≤ MAX(SGN32) Axis types T, R, S Dimension T: µs R,S: µs Default value 1 Drive types ---- Remarks P-AXIS-00226 Denominator equivalent time constant for feedforward control of acceleration Description The acceleration command variable is weighted by the mechanical time constant of the drive. The drive is modelled here as a first-order time delay element (see figure of the conventional feedforward control]). In the Laplace range the following transfer function is obtained with P-AXIS-00225: time constant numerator. Parameter vorsteuer.vs_a_nenner Data type SGN32 Data range 0 ≤ vs_a_nenner ≤ MAX(SGN32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 Drive types ---- Remarks P-AXIS-00228 Numerator weighting factor for feedforward control Description This parameter describes the weighting factor for velocity and acceleration feedforward control. Parameter vorsteuer.vs_v_faktor Data type SGN32 Data range 0 ≤ vs_v_faktor ≤ MAX(SGN32) Axis types T, R, S Dimension T: ---- R,S: ---- 26 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 27

Parameter Default value 1 Drive types ---- Remarks We know from experience that the weighting factor should be in the range of 0.7 - 1. At values >1 the axis leads and impairs contour accuracy. P-AXIS-00229 Denominator weighting factor for feedforward control Description This parameter describes the weighting factor for velocity and acceleration feedforward control. Parameter vorsteuer.vs_v_nenner Data type SGN32 Data range 0 ≤ vs_v_nenner ≤ MAX(SGN32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 Drive types ---- Remarks We know from experience that the weighting factor should be in the range of 0.7 - 1. At values >1 the axis leads and impairs contour accuracy. P-AXIS-00255 Permanent activation of feedforward control Description This parameter activates feedforward control permanently for one axis. Feedforward control is active all the time, even if G137 is active in the channel (or NC program). Parameter vorsteuer.default_active Data type BOOLEAN Data range 0/1 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 Drive types ---- Remarks This function is available for all types of axes and types of drives. P-AXIS-00325 Numerator scaling factor for torque Description Numerator of the scaling factor for the commanded torque to the drive. The factor is specified as a quotient. This quotient is the value which must be output to the motor to reach the nominal torque. Parameter antr.torque_scale_num Data type UNS32 Data range 0 < torque_scale_num < MAX(UNS32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 Drive types SERCOS, Lightbus,CANopen Remarks P-AXIS-00326 Denominator scaling factor for torque Description Denominator of the scaling factor for the commanded torque to the drive. The factor is specified as a quotient. This quotient is the value which must be output to the motor to reach the nominal torque. Parameter antr.torque_scale_denom TF5200 | Twin CAT 3 CNC Version: 1.05 27 Feedforward control
## Page 28

Parameter Data type UNS32 Data range 1 < torque_scale_denom < MAX(UNS32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 Drive types SERCOS, Lightbus,CANopen Remarks If the value 0 is set for P-AXIS-00326, an error message with the ID number P- ERR-110465 is output and the internal scaling factor is set to 0 In this case no output of the additive torque command value to the drive is sent. P-AXIS-00337 Numerator of scaling factor for jerk feedforward Description This parameter specifies the numerator of the scaling factor for jerk feedforward control. The scaling factor for jerk feedforward control is defined as: jerk_fact = P-AXIS-00337/P-AXIS-00338 [} 28] The output of the jerk feedforward control command value to the drive must be activated by setting bit 0x04 in axis parameter P-AXIS-00223 . Parameter vorsteuer.jerk_fact_num Data type UNS32 Data range 0 ≤ jerk_fact_num ≤ MAX(UNS32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 Drive types ---- Remarks Jerk feedforward control is only possible if a jerk-limited acceleration profile is used. For non jerk-limited acceleration profiles a jerk command value of 0 is output. For details on defining the acceleration profile, see P-CHAN-00071 and [PROG// Command #SLOPE [TYPE…] ]. P-AXIS-00338 Denominator of scaling factor for jerk feedforward Description This parameter specifies the denominator of the scaling factor for jerk feedforward control. The scaling factor for jerk feedforward control is defined as: jerk_fact = P-AXIS-00337/ P-AXIS-00338 The output of the jerk feedforward control command value to the drive must be activated by setting bit 0x04 in axis parameter P-AXIS-00223 . Parameter vorsteuer.jerk_fact_denom Data type UNS32 Data range 0 < jerk_fact_denom ≤ MAX(UNS32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 100 Drive types ---- Remarks Jerk feedforward control is only possible if a jerk-limited acceleration profile is used. For non jerk limited acceleration profiles a jerk command value of 0 is output. For details on defining the acceleration profile, see P-CHAN-00071 and [PROG// Command #SLOPE [TYPE…] ]. A value of 0 is inadmissible for this parameter. If this value is specified nevertheless, an error message with error code 110473 is output and the value is corrected to the default (100). P-AXIS-00362 Encoder resolution via feed constant (numerator) 28 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 29

Parameter Description Parameter P-AXIS-00362 and parameter P-AXIS-00363 enable anm alternative method to parameterise encoder resolution. If either parameter P-AXIS-00362 or P- AXIS-00363 are assigned values unequal to 1 (default initialisation), encoder resolution is calculated based on the equation below: where: R: Resulting resolution (Increments / 0.1µm) r : Encoder increments per motor revolution (P-AXIS-00092) Motor i ; Gear transmission ratio (Revolutions gear input / Revolutions gear output (P- Getriebe AXIS-00511/P-AXIS-00512)). f: Feed constant (0.1µm / Revolution) (P-AXIS-00362/P-AXIS-00363). Parameter antr.feed_const_num Data type UNS32 Data range 1 ≤ feed_const_num ≤ MAX(UNS32) Axis types T, R, S Dimension T: 0.1 µm R,S: 0.1 µm Default value 1 Drive types --- Remarks If P-AXIS-00362/ P-AXIS-000363 are used, the parameters P-AXIS-00233 and P- AXIS-00234 must be set to 1. For possible applications, see Settings of position scaling P-AXIS-00363 Encoder resolution via feed constant (denominator) Description Parameter P-AXIS-00362 and parameter P-AXIS-00363 enable an alternative method to parametrise encoder resolution. If either parameter P-AXIS-00362 or P- AXIS-00363 are assigned values unequal to 1 (default initialisation), encoder resolution is calculated based on the equation below: where: R: Resulting resolution (Increments / 0.1µm) r : Encoder increments per motor revolution (P-AXIS-00092) Motor i : Gear transmission ratio (Revolutions gear input / Revolutions gear output (P- Getriebe AXIS-00511/P-AXIS-00512)). f: Feed constant (0.1µm / Revolution) (P-AXIS-00362/ P-AXIS-00363). Parameter antr.feed_const_denom Data type UNS32 Data range 1 ≤ feed_const_denom ≤ MAX(UNS32) Axis types T, R, S Dimension T: U R,S: U TF5200 | Twin CAT 3 CNC Version: 1.05 29 Feedforward control
## Page 30

Parameter Default value 1 Drive types --- Remarks If P-AXIS-00362 / P-AXIS-000363 are used, the parameters P-AXIS-00233 and P- AXIS-00234 must be set to 1. For possible applications, see Settings of position scaling P-AXIS-00389 Delay time for velocity feedforward Description If velocity feedforward control via an additive velocity command value is activated, this parameter can delay the output of the velocity feedforward control value with respect to the command position. The delay time unit is in µs. Maximum delay is six interpolator cycles. Parameter vorsteuer.velocity_delay_time Data type UNS16 Data range 0 ≤ velocity_delay_time < 6*interpolator cycle time Axis types T, R, S Dimension T: µs R,S: µs Default value 0 Drive types SERCOS, Profidrive, CANopen Remarks If the permitted value of P-AXIS-00389 is exceeded, the error message P- ERR-70349 is output and P-AXIS-00389 is corrected to 0. P-AXIS-00390 Delay time for acceleration feedforward Description If acceleration feedforward control via an additive torque command value is activated, this parameter delays the output of the acceleration feedforward control value with respect to the command position. The delay time unit is in µs. Maximum delay is six interpolator cycles. Parameter vorsteuer.acceleration_delay_time Data type UNS16 Data range 0 < acceleration_delay_time < 6*Interpolator cycle time Axis types T, R, S Dimension T: µs R,S: µs Default value 0 Drive types SERCOS, Lightbus, Profidrive, CANopen Remarks If the permitted value of P-AXIS-00390 is exceeded, the error message P- ERR-70348 is output and P-AXIS-00390 is corrected to 0. P-AXIS-00391 Load inertia Description To set up acceleration feedforward with additive torque command value, the total load inertia of the motor must be configured here. The total load inertia is the inertia of the motor itself and the inertia of the load related to the motor shaft. In case of a translatory moved axis, the moved masses must be converted to an equivalent inertia related to the motor shaft. Parameter getriebe[i].load Data type REAL64 Data range 0 ≤ load < MAX(REAL64) Axis types T, R, S Dimension T: kg R,S: kg*m² Default value 1.000000e-006 Drive types SERCOS Remarks P-AXIS-00392 Reference value for converting torque values to the motor format. 30 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 31

Parameter Description This parameter is used for the scaling of the additive torque command if acceleration feedforward control is used with additive command values. The motor stall torque must be enetered. Parameter antr.acc_reference_value Data type REAL64 Data range 0 ≤ acc_reference_value < MAX(REAL64) Axis types T, R, S Dimension T: N R,S: Nm Default value 1 Drive types SERCOS, CANopen Remarks P-AXIS-00511 Gearbox ratio numerator Description By default, the path resolution of an axis is set with axis parameters P-AXIS-00233 and P-AXIS-00234 , where an eventually present gearbox must be considered (load-side scaling). If the parameters P-AXIS-00511/ P-AXIS-00512 and P-AXIS-00092, P-AXIS-00362/ P-AXIS-00363 are used, the resolution of the axis can be specified related to the motor side. The resulting resolution (R) related to the load side is calculated automatically according to the equation below: Parameter getriebe[i].gear_fact_num Data type UNS32 Data range 1 ... MAX (UNS32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 Drive types ---- Remarks For possible applications, see Settings of position scaling P-AXIS-00512 Gearbox ratio denominator Description By default, the path resolution of an axis is specified with axis parameters P- AXIS-00233 and P-AXIS-00234 , where an eventually present gearbox must be considered (load-side scaling). If the parameters P-AXIS-00511/ P-AXIS-00512 and P-AXIS-00092, P-AXIS-00362/ P-AXIS-00363 are used, the resolution of the axis can be specified related to the motor side. The resulting resolution (R) related to the load side is calculated automatically according to the equation below: Parameter getriebe[i].gear_fact_denom Data type UNS32 Data range 1 ... MAX (UNS32) Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 TF5200 | Twin CAT 3 CNC Version: 1.05 31 Feedforward control
## Page 32

Parameter Drive types ---- Remarks A value of zero is not permitted for P-AXIS-00512. If this value is set, the error message P-ERR-110579 is output. For possible applications, see Settings of position scaling 32 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 33

Support and Service 6 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5200 | Twin CAT 3 CNC Version: 1.05 33 Feedforward control
## Page 34

Index Index P P-AXIS-00092 23 P-AXIS-00165 23 P-AXIS-00205 23 P-AXIS-00206 23 P-AXIS-00207 24 P-AXIS-00223 24 P-AXIS-00225 25 P-AXIS-00226 26 P-AXIS-00228 26 P-AXIS-00229 27 P-AXIS-00255 27 P-AXIS-00325 27 P-AXIS-00326 27 P-AXIS-00337 28 P-AXIS-00338 28 P-AXIS-00362 28 P-AXIS-00363 29 P-AXIS-00389 30 P-AXIS-00390 30 P-AXIS-00391 30 P-AXIS-00392 30 P-AXIS-00511 31 P-AXIS-00512 31 34 Version: 1.05 TF5200 | Twin CAT 3 CNC Feedforward control
## Page 36

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
