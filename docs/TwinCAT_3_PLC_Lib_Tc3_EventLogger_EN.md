---
title: "TwinCAT_3_PLC_Lib_Tc3_EventLogger_EN"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "EVENT", "LIB", "LOGGER", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.6.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc3_EventLogger_EN.pdf"
release_date: "2025-08-01"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc3_Event Logger 2025-08-01 | Version: 1.6.2
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 7 1.1 Notes on the documentation............................................................................................................. 7 1.2 For your safety.................................................................................................................................. 7 1.3 Notes on information security............................................................................................................ 9 2 Overview.................................................................................................................................................. 10 3 Functions and function blocks.............................................................................................................. 11 3.1 Asynchronous text requests............................................................................................................ 11 3.1.1 FB_Async Str Result.......................................................................................................... 11 3.1.2 FB_Request Cause Remedy............................................................................................. 12 3.1.3 FB_Request Event Class Details........................................................................................ 15 3.1.4 FB_Request Event Class Name......................................................................................... 18 3.1.5 FB_Request Event Details................................................................................................. 20 3.1.6 FB_Request Event Text..................................................................................................... 23 3.1.7 FB_Request Translation................................................................................................... 26 3.1.8 FB_Tc Cause Remedy....................................................................................................... 29 3.1.9 FB_Tc Detail..................................................................................................................... 31 3.1.10 F_Get Event Class Name................................................................................................... 34 3.1.11 F_Get Event Text............................................................................................................... 34 3.2 Event Entry conversion.................................................................................................................... 35 3.2.1 Ads Err_TO_Tc Event Entry................................................................................................ 35 3.2.2 HRESULTAds Err_TO_Tc Event Entry............................................................................... 36 3.2.3 Tc Event Entry_TO_Ads Err................................................................................................ 37 3.2.4 Tc Event Entry_TO_HRESULTAds Err............................................................................... 37 3.3 Filter................................................................................................................................................ 38 3.3.1 FB_Tc Clear Logged Events Settings.................................................................................. 38 3.3.2 FB_Tc Event Csv Export Settings........................................................................................ 40 3.3.3 FB_Tc Event Filter............................................................................................................. 41 3.4 Remote Event Logger....................................................................................................................... 43 3.4.1 FB_Remote Listener Base................................................................................................. 44 3.4.2 FB_Tc Remote Event Logger.............................................................................................. 49 3.5 FB_Listener Base2........................................................................................................................... 56 3.5.1 Execute............................................................................................................................ 57 3.5.2 On Alarm Cleared.............................................................................................................. 57 3.5.3 On Alarm Confirmed.......................................................................................................... 58 3.5.4 On Alarm Disposed............................................................................................................ 58 3.5.5 On Alarm Raised................................................................................................................ 58 3.5.6 On Message Sent.............................................................................................................. 59 3.5.7 Subscribe......................................................................................................................... 59 3.5.8 Subscribe2....................................................................................................................... 60 3.5.9 Unsubscribe..................................................................................................................... 60 3.6 FB_Tc Alarm.................................................................................................................................... 61 3.6.1 Clear................................................................................................................................. 63 3.6.2 Confirm............................................................................................................................. 64 3.6.3 Create.............................................................................................................................. 65 TE1000 Version: 1.6.2 3
## Page 4

Table of contents 3.6.4 Create Ex.......................................................................................................................... 65 3.6.5 Raise................................................................................................................................ 66 3.6.6 Set Json Attribute............................................................................................................... 67 3.7 FB_Tc Arguments............................................................................................................................ 67 3.7.1 Is Empty............................................................................................................................ 69 3.8 FB_Tc Event.................................................................................................................................... 69 3.9 FB_Tc Event Base............................................................................................................................ 71 3.9.1 Equals To.......................................................................................................................... 72 3.9.2 Equals To Event Class........................................................................................................ 73 3.9.3 Equals To Event Entry........................................................................................................ 73 3.9.4 Equals To Event Entry Ex.................................................................................................... 74 3.9.5 Get Json Attribute.............................................................................................................. 74 3.9.6 Release............................................................................................................................ 75 3.9.7 Request Event Class Name................................................................................................ 75 3.9.8 Request Event Text............................................................................................................ 76 3.9.9 ip Arguments..................................................................................................................... 77 3.9.10 ip Source Info..................................................................................................................... 77 3.10 FB_Tc Event Logger......................................................................................................................... 77 3.10.1 Clear Alarms..................................................................................................................... 78 3.10.2 Clear All Alarms................................................................................................................. 78 3.10.3 Clear Logged Events.......................................................................................................... 79 3.10.4 Confirm Alarms................................................................................................................. 80 3.10.5 Confirm All Alarms............................................................................................................. 80 3.10.6 Export Logged Events........................................................................................................ 81 3.10.7 Get Alarm.......................................................................................................................... 82 3.10.8 Get Alarm Ex...................................................................................................................... 82 3.10.9 Is Alarm Raised.................................................................................................................. 83 3.10.10 Is Alarm Raised Ex.............................................................................................................. 83 3.10.11 Send Message.................................................................................................................. 84 3.10.12 Send Message2................................................................................................................ 85 3.10.13 Send Message Ex.............................................................................................................. 86 3.10.14 Send Message Ex2............................................................................................................ 87 3.11 FB_Tc Message............................................................................................................................... 88 3.11.1 Create.............................................................................................................................. 90 3.11.2 Create Ex.......................................................................................................................... 91 3.11.3 Set Json Attribute............................................................................................................... 91 3.12 FB_Tc Source Info............................................................................................................................ 92 3.12.1 Clear................................................................................................................................. 93 3.12.2 Extend Name.................................................................................................................... 93 3.12.3 Reset To Default................................................................................................................ 94 4 Interfaces................................................................................................................................................. 95 4.1 I_Tc Arguments................................................................................................................................ 95 4.1.1 Add Blob............................................................................................................................ 95 4.1.2 Add Bool............................................................................................................................ 96 4.1.3 Add Byte............................................................................................................................ 96 4.1.4 Add Dint............................................................................................................................ 97 4 Version: 1.6.2 TE1000
## Page 5

Table of contents 4.1.5 Add DWord........................................................................................................................ 97 4.1.6 Add Event Reference Id...................................................................................................... 98 4.1.7 Add Event Reference Id Guid.............................................................................................. 98 4.1.8 Add Int............................................................................................................................... 99 4.1.9 Add LInt............................................................................................................................. 99 4.1.10 Add LReal......................................................................................................................... 99 4.1.11 Add Real......................................................................................................................... 100 4.1.12 Add SInt.......................................................................................................................... 100 4.1.13 Add String....................................................................................................................... 101 4.1.14 Add UDint........................................................................................................................ 101 4.1.15 Add UInt.......................................................................................................................... 102 4.1.16 Add ULInt........................................................................................................................ 102 4.1.17 Add USInt........................................................................................................................ 103 4.1.18 Add Word........................................................................................................................ 103 4.1.19 Add WString.................................................................................................................... 103 4.1.20 Clear............................................................................................................................... 104 4.2 I_Tc Event Base.............................................................................................................................. 104 4.2.1 Equals To........................................................................................................................ 105 4.2.2 Equals To Event Class...................................................................................................... 105 4.2.3 Equals To Event Entry...................................................................................................... 106 4.2.4 Equals To Event Entry Ex.................................................................................................. 106 4.2.5 Get Json Attribute............................................................................................................ 107 4.2.6 Request Event Class Name.............................................................................................. 107 4.2.7 Request Event Text.......................................................................................................... 108 4.3 I_Tc Message................................................................................................................................. 109 4.3.1 Send............................................................................................................................... 109 4.4 I_Tc Source Info.............................................................................................................................. 110 4.4.1 Equals To........................................................................................................................ 110 5 Data types.............................................................................................................................................. 112 5.1 Tc Event Entry................................................................................................................................. 112 5.2 Tc Event Severity............................................................................................................................ 112 5.3 Tc Event Confirmation State............................................................................................................ 112 6 Global lists............................................................................................................................................. 114 6.1 Global_Constants.......................................................................................................................... 114 6.2 GVL............................................................................................................................................... 114 6.3 Parameter list................................................................................................................................ 114 6.4 Global_Version.............................................................................................................................. 114 7 Examples............................................................................................................................................... 115 7.1 Tutorial.......................................................................................................................................... 115 7.2 Example Result Message.............................................................................................................. 117 7.3 Example Listener.......................................................................................................................... 117 7.4 Example filter................................................................................................................................ 118 TE1000 Version: 1.6.2 5
## Page 6

Table of contents 6 Version: 1.6.2 TE1000
## Page 7

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.6.2 7
## Page 8

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 8 Version: 1.6.2 TE1000
## Page 9

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.6.2 9
## Page 10

Overview 2 Overview The PLC library contains functions and function blocks for using the Twin CAT 3 Event Logger. See also: Dokumentation Twin CAT 3 Event Logger Function blocks for using the TC3 Event Logger FB_Listener Base2 [} 56] Basic implementation of an event listener. FB_Tc Alarm [} 61] Represents an alarm of the Twin CAT 3 Event Logger. FB_Tc Arguments [} 67] Defines arguments of an event. FB_Tc Event Logger [} 77] Represents the Twin CAT 3 Event Logger itself. FB_Tc Message [} 88] Represents a message from the Twin CAT 3 Event Logger. FB_Tc Source Info [} 92] Defines the source information of an event. Asynchronous text requests F_Get Event Class Name [} 34] Triggers the asynchronous request for the name of an event class. F_Get Event Text [} 34] Triggers the asynchronous request for an event text. FB_Async Str Result [} 11] Enables the asynchronous request for a text. FB_Request Event Class Name [} 18] Enables the asynchronous request for the name of an event class. FB_Request Event Text [} 23] Enables the asynchronous request for an event text in the desired language. Event Entry conversion Ads Err_TO_Tc Event Entry [} 35] Converts a standard ADS error into a Tc Event Entry. HRESULTAds Err_TO_Tc Event Entry [} 36] Converts a standard ADS error (HRESULT) into a Tc Event Entry. Tc Event Entry_TO_Ads Err [} 37] Converts a Tc Event Entry into a standard ADS error. Tc Event Entry_TO_HRESULTAds Err [} 37] Converts a Tc Event Entry into a standard ADS error (HRESULT). 10 Version: 1.6.2 TE1000
## Page 11

Functions and function blocks 3 Functions and function blocks 3.1 Asynchronous text requests 3.1.1 FB_Async Str Result This function block enables the asynchronous request for a text. Methods Name Description Get String [} 11] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.1.1.1 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes TE1000 Version: 1.6.2 11
## Page 12

Functions and function blocks Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 3.1.2 FB_Request Cause Remedy This function block enables the asynchronous request of cause/remedy in the desired language for an event. Methods Name Description Clear [} 12] This method clears the last result queried. Get [} 13] As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Request [} 13] Calling this method triggers the asynchronous request. Request Remote Calling this method triggers the asynchronous request on a remote target system. [} 14] Properties Name Type Access Description b Busy BOOL GET TRUE as long as the processing is not yet completed. b Error BOOL GET TRUE when an error occurs. hr Error Code HRESULT GET Outputs the error information if b Error is TRUE. n Count UDINT GET Number of causes/remedy elements found Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.1.2.1 Clear This method clears the last result queried. Syntax METHOD Clear 12 Version: 1.6.2 TE1000
## Page 13

Functions and function blocks 3.1.2.2 Get As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Syntax METHOD Get : HRESULT VAR_INPUT n Index : UDINT; fb Cause Remedy : REFERENCE TO FB_Tc Cause Remedy; END_VAR Inputs Name Type Description n Index UDINT Index in the list of cause/remedy elements to be queried. fb Cause Remedy Reference to Reference to a FB_Tc Cause Remedy in which the texts FB_Tc Cause Remedy [} 29] are stored. Outputs Name Type Description Get HRESULT S_OK on success ADS_E_INVALIDSTATE if the query is still running. ADS_E_INVALIDSIZE if an index is queried that is not assigned. 3.1.2.3 Request Calling this method triggers the asynchronous request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR TE1000 Version: 1.6.2 13
## Page 14

Functions and function blocks Inputs Name Type Description event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 … The Tc Lcid enum can be used. Outputs Name Type Description Request HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.2.4 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. 14 Version: 1.6.2 TE1000
## Page 15

Functions and function blocks Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.3 FB_Request Event Class Details This function block can be used to query the details of an event class in the form of FB_Tc Detail [} 31]. Each "detail" (Description Text, Description Url, Comment) – see when creating the event) has an index and the key ((Description Text, Description Url, Comment) and the value are supplied for each index. Methods Name Description Clear [} 15] This method clears the last result queried. Get [} 16] As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Request [} 16] Calling this method triggers the asynchronous request. Request Remote Calling this method triggers the asynchronous request on a remote target system. [} 17] Properties Name Type Access Description b Busy BOOL GET TRUE as long as the processing is not yet completed. b Error BOOL GET TRUE when an error occurs. hr Error Code HRESULT GET Outputs the error information if b Error is TRUE. n Count UDINT GET Number of causes/remedy elements found Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.1.3.1 Clear This method clears the last result queried. TE1000 Version: 1.6.2 15
## Page 16

Functions and function blocks Syntax METHOD Clear 3.1.3.2 Get As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Syntax METHOD Get : HRESULT VAR_INPUT n Index : UDINT; fb Detail : REFERENCE TO FB_Tc Detail; END_VAR Inputs Name Type Description n Index UDINT Index in the list of cause/remedy elements to be queried. fb Detail Reference to FB_Tc Detail Reference to an FB_Tc Detail in which the details are stored. [} 31] Outputs Name Type Description Get HRESULT Returns S_OK if successful. ADS_E_INVALIDSTATE if the query is still running. ADS_E_INVALIDSIZE if an index is queried that is not assigned. 3.1.3.3 Request Calling this method triggers the asynchronous request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR 16 Version: 1.6.2 TE1000
## Page 17

Functions and function blocks Inputs Name Type Description event Class GUID Specifies the event class. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 … The Tc Lcid enum can be used. Outputs Name Type Description Request HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.3.4 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. TE1000 Version: 1.6.2 17
## Page 18

Functions and function blocks Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.4 FB_Request Event Class Name This function block enables the asynchronous request for the name of an event class. Methods Name Description Clear [} 18] This method clears the last result queried. Get String [} 19] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Request [} 19] Calling this method triggers the asynchronous text request. Request Remote [} 20] Calling this method triggers the asynchronous request on a remote target system. Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.1.4.1 Clear This method clears the last result queried. Syntax METHOD Clear 18 Version: 1.6.2 TE1000
## Page 19

Functions and function blocks 3.1.4.2 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 3.1.4.3 Request Calling this method triggers the asynchronous text request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Lang Id : DINT; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 TE1000 Version: 1.6.2 19
## Page 20

Functions and function blocks Return value Name Type Description Request HRESULT Returns possible error information. 3.1.4.4 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.5 FB_Request Event Details This function block can be used to query the details of an event in the form of FB_Tc Detail [} 31]. 20 Version: 1.6.2 TE1000
## Page 21

Functions and function blocks Methods Name Description Clear [} 21] This method clears the last result queried. Get [} 21] As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Request [} 22] Calling this method triggers the asynchronous request. Request Remote Calling this method triggers the asynchronous request on a remote target system. [} 22] Properties Name Type Access Description b Busy BOOL GET TRUE as long as the processing is not yet completed. b Error BOOL GET TRUE when an error occurs. hr Error Code HRESULT GET Outputs the error information if b Error is TRUE. n Count UDINT GET Number of causes/remedy elements found Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.1.5.1 Clear This method clears the last result queried. Syntax METHOD Clear 3.1.5.2 Get As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Syntax METHOD Get : HRESULT VAR_INPUT n Index : UDINT; fb Detail : REFERENCE TO FB_Tc Detail; END_VAR Inputs Name Type Description n Index UDINT Index in the list of causes/remedy elements to be queried. fb Detail Reference to FB_Tc Detail Reference to an FB_Tc Detail in which the details are stored. [} 31] TE1000 Version: 1.6.2 21
## Page 22

Functions and function blocks Outputs Name Type Description Get HRESULT S_OK on success ADS_E_INVALIDSTATE if the query is still running. ADS_E_INVALIDSIZE if an index is queried that is not assigned. 3.1.5.3 Request Calling this method triggers the asynchronous request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 … The Tc Lcid enum can be used. Outputs Name Type Description Request HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.5.4 Request Remote 22 Version: 1.6.2 TE1000
## Page 23

Functions and function blocks Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.6 FB_Request Event Text This function block enables the asynchronous request for an event text in the desired language. Methods Name Description Clear [} 26] This method clears the last result queried. Get String [} 24] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Request [} 24] Calling this method triggers the asynchronous text request. Request Remote [} 25] Calling this method triggers the asynchronous request on a remote target system. TE1000 Version: 1.6.2 23
## Page 24

Functions and function blocks Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.1.6.1 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 3.1.6.2 Request 24 Version: 1.6.2 TE1000
## Page 25

Functions and function blocks Calling this method triggers the asynchronous text request. Syntax METHOD Request : BOOL VAR_INPUT event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR Inputs Name Type Description event Class GUID Specifies the event class. n Event Id UDINT ID of the event. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments [} 95] Optional specification of arguments. Return value Name Type Description Request HRESULT Returns possible error information. 3.1.6.3 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR TE1000 Version: 1.6.2 25
## Page 26

Functions and function blocks Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Event Id UDINT ID of the event. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments Optional specification of arguments. Return value Name Type Description Request Re HRESULT mote Also see about this 2 I_Tc Arguments [} 95] 3.1.6.4 Clear This method clears the last result queried. Syntax METHOD Clear 3.1.7 FB_Request Translation This function block provides a translation for a text in a desired language. The translations are referenced by an event class, which is specified in the query. It is therefore not used here as an event class, but as a translation table. Methods Name Description Clear [} 29] This method clears the last result queried. Get String [} 27] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Request [} 27] Calling this method triggers the asynchronous text request. Request Remote [} 28] Calling this method triggers the asynchronous request on a remote target system. 26 Version: 1.6.2 TE1000
## Page 27

Functions and function blocks Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.1.7.1 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 3.1.7.2 Request TE1000 Version: 1.6.2 27
## Page 28

Functions and function blocks Calling this method triggers the asynchronous text request. Syntax METHOD Request : BOOL VAR_INPUT event Class : GUID; END_VAR VAR_IN_OUT CONSTANT text : STRING; END_VAR VAR_INPUT n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR Inputs Name Type Description event Class GUID Specifies the event class to be used as the basis for the query. text STRING The text to be translated n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments [} 95] Optional specification of arguments. Return value Name Type Description Request HRESULT Returns possible error information. 3.1.7.3 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger event Class : GUID; END_VAR VAR_IN_OUT CONSTANT text : STRING; END_VAR VAR_INPUT n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR 28 Version: 1.6.2 TE1000
## Page 29

Functions and function blocks Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class to be used as the basis for the query. text STRING The text to be translated n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments [} 95] Optional specification of arguments. Return value Name Type Description Request Re HRESULT Returns possible error information. mote S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 3.1.7.4 Clear This method clears the last result queried. Syntax METHOD Clear 3.1.8 FB_Tc Cause Remedy This function block is used to display the cause/remedy for an alarm. This function block is used via FB_Request Cause Remedy [} 12]. Methods Name Description Get Cause [} 30] Returns the cause. Get Id [} 30] Returns the index of the cause/remedy. Get Remedy [} 31] Returns the remedy. Release [} 31] Clears the internal memory of the function block. TE1000 Version: 1.6.2 29
## Page 30

Functions and function blocks Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.1.8.1 Get Cause This method returns the cause. Syntax METHOD Get Cause : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Cause BOOL Returns the success whether a cause was provided. 3.1.8.2 Get Id This method returns the index of the cause/remedy. Syntax METHOD Get Id : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Id BOOL Returns the success whether an ID was provided. 30 Version: 1.6.2 TE1000
## Page 31

Functions and function blocks 3.1.8.3 Get Remedy This method returns the remedy. Syntax METHOD Get Remedy : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Remedy BOOL Returns the success of whether a remedy has been provided. 3.1.8.4 Release This method clears the internal memory of the function block. Syntax METHOD Release : HRESULT Outputs Name Type Description Release HRESULT Returns whether the memory has been cleaned. 3.1.9 FB_Tc Detail This function block is used to display the details of an event. This function block is used via FB_Request Event Class Details [} 15] or FB_Request Event Details [} 20]. TE1000 Version: 1.6.2 31
## Page 32

Functions and function blocks Methods Name Description Get Comment Returns the comment. [} 32] Get Name [} 33] Returns the name. Get Text [} 33] Returns the text. Release [} 32] Clears the internal memory of the function block Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.1.9.1 Release This method clears the internal memory of the function block. Syntax METHOD Release : HRESULT Outputs Name Type Description Release HRESULT Returns whether the memory has been cleaned. 3.1.9.2 Get Comment This method returns the comment. Syntax METHOD Get Comment : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Commend BOOL Returns the success whether a comment was provided. 32 Version: 1.6.2 TE1000
## Page 33

Functions and function blocks 3.1.9.3 Get Name This method returns the name. Syntax METHOD Get Name : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Name BOOL Returns the success whether a name was provided. 3.1.9.4 Get Text This method returns the text. Syntax METHOD Get Text : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Text BOOL Returns the success whether a text was provided. TE1000 Version: 1.6.2 33
## Page 34

Functions and function blocks 3.1.10 F_Get Event Class Name The function triggers the asynchronous request for the name of an event class. Syntax Definition: FUNCTION F_Get Event Class Name : HRESULT VAR_INPUT n Lang Id : DINT; fb Event Base : REFERENCE TO FB_Tc Event Base; END_VAR VAR_IN_OUT fb Result : FB_Async Str Result; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … fb Event Base REFERENCE TO Specification of an event/alarm/message object. FB_Tc Event Base [} 71] / Inputs/outputs Name Type Description fb Result FB_Async Str Result [} 11] Specification of a function block instance in order to track an asynchronous text request. Return value Name Type Description F_Get Event Class Name HRESULT Returns possible error information. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.1.11 F_Get Event Text The function triggers the asynchronous request for an event text. 34 Version: 1.6.2 TE1000
## Page 35

Functions and function blocks Syntax Definition: FUNCTION F_Get Event Text : HRESULT VAR_INPUT n Lang Id : DINT; fb Event Base : REFERENCE TO FB_Tc Event Base; END_VAR VAR_IN_OUT fb Result : FB_Async Str Result; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … fb Event Base REFERENCE TO Specification of an event/alarm/message object. FB_Tc Event Base [} 71] / Inputs/outputs Name Type Description fb Result FB_Async Str Result [} 11] Specification of a function block instance in order to track an asynchronous text request. Return value Name Type Description F_Get Event Text HRESULT Returns possible error information. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.2 Event Entry conversion 3.2.1 Ads Err_TO_Tc Event Entry This function converts a standard ADS error into a Tc Event Entry. Syntax Definition: FUNCTION Ads Err_TO_Tc Event Entry : BOOL VAR_INPUT e Error Id : E_Ads Err; st Event Entry : REFERENCE TO Tc Event Entry; END_VAR TE1000 Version: 1.6.2 35
## Page 36

Functions and function blocks Inputs Name Type Description e Error Id E_Ads Err Error code to be converted. st Event Entry REFERENCE TO Tc Event Entry [} 112] Outputs the resulting event definition. Return value Name Type Description Ads Err_TO_Tc Event Entry BOOL Returns TRUE if the conversion was carried out successfully. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.2.2 HRESULTAds Err_TO_Tc Event Entry This function converts a standard ADS error (HRESULT) into a Tc Event Entry. Syntax Definition: FUNCTION HRESULTAds Err_TO_Tc Event Entry : BOOL VAR_INPUT hr : E_HRESULTAds Err; st Event Entry : REFERENCE TO Tc Event Entry; END_VAR Inputs Name Type Description hr E_HRESULTAds Err Error code to be converted. st Event Entry REFERENCE TO Tc Event Entry Outputs the resulting event definition. [} 112] Return value Name Type Description HRESULTAds Err_TO_Tc Event Entry BOOL Returns TRUE if the conversion was carried out successfully. The call fails if the facility code in the specified HRESULT is unknown. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 36 Version: 1.6.2 TE1000
## Page 37

Functions and function blocks 3.2.3 Tc Event Entry_TO_Ads Err This function converts a Tc Event Entry into a standard ADS error. Syntax Definition: FUNCTION Tc Event Entry_TO_Ads Err : BOOL VAR_INPUT st Event Entry : Tc Event Entry; e Error Id : REFERENCE TO E_Ads Err; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 112] Event definition to be converted. e Error Id REFERENCE TO E_Ads Err Outputs the resulting error code. Return value Name Type Description Tc Event Entry_TO_Ads Err BOOL Returns TRUE if the conversion was carried out successfully and FALSE if the event class is unknown. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.2.4 Tc Event Entry_TO_HRESULTAds Err This function converts a Tc Event Entry into a standard ADS error (HRESULT). Syntax Definition: FUNCTION Tc Event Entry_TO_HRESULTAds Err : BOOL VAR_INPUT st Event Entry : Tc Event Entry; hr : REFERENCE TO E_HRESULTAds Err; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 112] Event definition to be converted. hr REFERENCE TO Outputs the resulting error code. E_HRESULTAds Err TE1000 Version: 1.6.2 37
## Page 38

Functions and function blocks Return value Name Type Description Tc Event Entry_TO_HRESULTAds Err BOOL Returns TRUE if the conversion was carried out successfully and FALSE if the event class is unknown. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.3 Filter The filter functionality is used in different places. A sample that describes the possible uses is covered in the Example filter [} 118]. 3.3.1 FB_Tc Clear Logged Events Settings This function block provides the functionality to specify which events are to be removed from the cache. Syntax Definition: FUNCTION_BLOCK FB_Tc Clear Logged Events Settings IMPLEMENTS I_Tc Clear Logged Events Settings Methods Name Definition location Description Add Filter [} 38] Local Method for adding a filter. Delivers if successful S_OK. Clear [} 39] Local Method for clearing the settings. Delivers if successful S_OK. Set Limit [} 39] Local Indicates the number of events to be cleared. The limit is applied after sorting and filtering. Delivers if successful S_OK. Set Sorting [} 40] Local Sets the sort order for the query. Delivers if successful S_OK. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 3.3.1.1 Add Filter Method for adding a filter. 38 Version: 1.6.2 TE1000
## Page 39

Functions and function blocks Inputs Name Type Description ip Event Filter I_Tc Event Filter Instance of the filter to be used Return values Name Type Description Add Filter HRESULT Returns S_OK if successful. 3.3.1.2 Clear Method for clearing the settings. Return values Name Type Description Clear HRESULT Returns S_OK if successful. 3.3.1.3 Set Limit Indicates the number of events to be cleared. The limit is applied after sorting and filtering. Inputs Name Type Description e Type Tc Event Limit Type Determines the reference whether the limit applies to the first or last events. n Limit DINT Specifies the number (-1 = no limit) n Offset DINT Optional. Defines how many entries are to be skipped. Return values Name Type Description Set Limit HRESULT Returns S_OK if successful. TE1000 Version: 1.6.2 39
## Page 40

Functions and function blocks 3.3.1.4 Set Sorting Sets the sort order for the query. Inputs Name Type Description e Field Tc Event Field Property to be used for sorting. e Order Tc Event Sort Order Defines the sort order. Return values Name Type Description Set Sorting HRESULT Returns S_OK if successful. 3.3.2 FB_Tc Event Csv Export Settings Provides the functionality to specify the csv export. Syntax Definition: FUNCTION_BLOCK FB_Tc Event Csv Export Settings EXTENDS FB_Tc Event Export Settings IMPLEMENTS I_Tc Event Csv Export Settings Methods Name Type Description b With Header BOOL Determines whether a header should be created. Standard: True n Lang Id DINT Determines the default identifier of the export language. Standard: 1033 s Delimiter STRING Defines the CSV delimiter. Standard: Semicolon [;] Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 40 Version: 1.6.2 TE1000
## Page 41

Functions and function blocks 3.3.3 FB_Tc Event Filter Provides the functionality to specify an event filter. The filters are provided via a floating interface following a structured query language. It describes which messages should apply. • Conditions can be linked via . AND_OP() and . OR_OP(). • Conditions can be negated by . NOT_OP(). • Conditions can be defined by properties such as .is Alarm() or . Event Class. Equals To(<Event Class>), for example. A complete list of properties can be found in the API documentation. • A grouping can be formulated via . Filter Expression(<Sub Condition>). The <Sub Codition> is itself another FB_Tc Event Filter or ITc Event Filter. A filter is applied once it has been compiled. To receive messages, for example, it is assigned to a recipient via FB_Listener Base2.subscribe(). In this way FB_Listener Base2 takes over the filter and provides a corresponding return value, which is described here. The filter can be amended by repeating FB_Listener Base2.subscribe(). A maximum of 255 filter conditions can be set - after which an ADS_NOMOREHDL is returned as an error message. Sample A filter can be assembled in the following way, for example: fb Filter. Severity. Greater Than (Tc EVent Severity. Error). AND_OP(). Source. Name. Like('%Main%'); The Example filter [} 118] shows the usage. Ether CAT filter The mechanism for receiving Ether CAT emergency messages is similar to that described above. The entry point in the chained method calls is . Ether CATDevice(), which first provides a direct request to ascertain if it was sent from an Ether CAT device (Is Ether CATDevice()). From here you can filter based on the vendor (. Vendor Id()), the product code (. Product Code()) or the revision (Revision No()) ). Syntax Definition: FUNCTION_BLOCK FB_Tc Event Filter IMPLEMENTS I_Tc Event Filter, I_Tc Expression Base Methods Name Definition location Description Clear [} 42] I_Tc Event Filter Clears the previous filter expression. Filter Expression [} 42] I_Tc Expression Base Specification of a subordinate filter definition. Is Alarm [} 43] I_Tc Expression Base Checking whether it is an alarm. Is Message [} 43] I_Tc Expression Base Checking whether it is a message. NOT_OP [} 43] I_Tc Expression Base Negation of the subsequent statement. TE1000 Version: 1.6.2 41
## Page 42

Functions and function blocks Properties Name Type Access Description Alarm State I_Tc Alarm Filter Express Get Checking with an Alarm State ion Ether CATDevice I_Tc Ether CATDevice E Get Checking whether the source is an xpression Ether CAT device. Event Class I_Tc Guid Compare Get Checking with an Event Class Event Id I_Tc UDInt Compare Get Checking with an Event Id Json Attribute I_Tc Json Attribute Expre Get Checking with the Json Attribute ssion Severity I_Tc Severity Compare Get Checking with Serverity Source I_Tc Source Info Express Get Checking with the source ion Time Cleared I_Tc ULInt Compare Get Checking of the clear time (only in the event of an alarm) Time Confirmed I_Tc ULInt Compare Get Checking of the confirm time (only for alarm with acknowledgement) Time Raised I_Tc ULInt Compare Get Checking of the sender (for messages) or the raised time (for alarms) Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 3.3.3.1 Clear The method clears the previous filter expression. Return values Name Type Description Clear I_Tc Binary Expression Link point 3.3.3.2 Filter Expression The method specifies a subordinate filter definition. Inputs Name Type Description ip Expression I_Tc Event Filter Base Link point 42 Version: 1.6.2 TE1000
## Page 43

Functions and function blocks Return values Name Type Description Filter Expression I_Tc Logical Expression Link point 3.3.3.3 Is Alarm The method checks whether it is an alarm. Return values Name Type Description Is Alarm I_Tc Logical Expression Link point 3.3.3.4 Is Message The method checks whether it is a message. Return values Name Type Description Is Message I_Tc Logical Expression Link point 3.3.3.5 NOT_OP The method negates the following statement. Return values Name Type Description NOT_OP I_Tc Binary Expression Link point 3.4 Remote Event Logger The Event Logger also offers the option of accessing remote systems, for which the necessary function blocks are described here. In addition, function blocks from the Asynchronous text requests [} 11] section have an option to query texts on a remote system. The use is described in the section Remote access to the Event Logger via PLC. TE1000 Version: 1.6.2 43
## Page 44

Functions and function blocks 3.4.1 FB_Remote Listener Base The function block serves as the basic implementation of an event listener of a remote system. New messages and state changes of alarms can be recognized through the overwriting of the event-driven methods. This function block provides access to the Event Logger of a remote system and can be used to send events there or receive events from there. Syntax FUNCTION_BLOCK FB_Remote Listener Base IMPLEMENTS I_Remote Listener Methods Name Description Execute [} 45] Must be called cyclically so that the event queue can be processed. Subscribe [} 48] Subscribes notifications. Unsubscribe [} 49] Unsubscribes notifications. Event-driven methods Name Description On Alarm Cleared Called when the state of an alarm changes from "Raised" to "Clear". [} 45] On Alarm Confirmed Called when an alarm has been confirmed. [} 45] On Alarm Disposed Called when an alarm instance has been released again. [} 46] On Alarm Raised Called when the state of an alarm changes from "Clear" to "Raised". [} 46] On Connection State C Called when the connection to the remote system changes state. hanged [} 46] On Database Changed Called if the database has changed, e.g. if a Clear Logged Events() has been called [} 47] On Event Logger Error Called if an ADS error occurs during communication. [} 47] On Message Sent Called when a message has been sent. [} 48] Properties Name Type Access Description b Subscribed BOOL Get Returns TRUE if the function block has registered notifications and event monitoring is active. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 44 Version: 1.6.2 TE1000
## Page 45

Functions and function blocks 3.4.1.1 Execute The method must be called cyclically so that the event queue can be processed. Syntax METHOD Execute : HRESULT Return value Name Type Description Execute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.4.1.2 On Alarm Cleared This method is called if the state of an alarm changes from Raised to Clear. Syntax METHOD On Alarm Cleared : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 3.4.1.3 On Alarm Confirmed This method is called when an alarm has been confirmed. Syntax METHOD On Alarm Confirmed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR TE1000 Version: 1.6.2 45
## Page 46

Functions and function blocks Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 3.4.1.4 On Alarm Disposed This method is called when an alarm instance has been released again. Syntax METHOD On Alarm Disposed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 3.4.1.5 On Alarm Raised This method is called if the state of an alarm changes from Clear to Raised. Syntax METHOD On Alarm Raised : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 3.4.1.6 On Connection State Changed 46 Version: 1.6.2 TE1000
## Page 47

Functions and function blocks This method is called when the connection to the remote system changes state. Syntax METHOD On Connection State Changed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; e Reason : Tc Remote Connection Change Reason; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers e Reason Tc Remote Connection Change The type of change in connection status. Reason 3.4.1.7 On Database Changed This method is called if the database has changed, e.g. if a Clear Logged Events() has been called. Syntax METHOD On Database Changed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; e Reason : Tc Database Change Reason; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers e Reason Tc Database Change Reason One of the values of the ENUM: Undefined, Cleard By Command, Maximum Size Reached, Deleted 3.4.1.8 On Event Logger Error This method is called if an ADS error occurs during communication. Syntax METHOD On Event Logger Error : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; hr : HRESULT; END_VAR TE1000 Version: 1.6.2 47
## Page 48

Functions and function blocks Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers hr HRESULT The error code that has occurred. 3.4.1.9 On Message Sent This method is called when a message has been sent. Syntax METHOD On Message Sent : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 3.4.1.10 Subscribe The method subscribes notifications. Syntax METHOD Subscribe : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; ip Event Filter : I_Tc Event Filter Base; // optional END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Reference to the Event Logger for which a notification is to be registered. ip Event Filter I_Tc Event Filter Base Pointer to an instance of FB_Tc Event Filter [} 41], if a filter is to be activated. 48 Version: 1.6.2 TE1000
## Page 49

Functions and function blocks Return value Name Type Description Subscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_EXISTS if the listener is already subscribed. Otherwise returns HRESULT as the error code 3.4.1.11 Unsubscribe The listener is unsubcribed with this method. Syntax METHOD Unsubscribe : HRESULT Return value Name Type Description Unsubscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_NOTFOUND if the listener was not subscribed. Otherwise returns HRESULT as the error code. 3.4.2 FB_Tc Remote Event Logger This function block represents the Twin CAT 3 Event Logger for a remote system. Syntax FUNCTION_BLOCK FB_Remote Event Logger IMPLEMENTS I_Remote Event Logger TE1000 Version: 1.6.2 49
## Page 50

Functions and function blocks Methods Name Description Clear Alarm [} 50]s Clears active alarms. Clear Logged Events Clears logged events. [} 51] Confirm Alarms Confirms alarms. [} 52] Connect [} 52] Connects to the remote system. Disconnect [} 53] Terminates the connection with the remote system. Send Message [} 53] Sends a message. Send Message2 Sends a message. [} 54] Send Message Ex Sends a message. [} 55] Send Message Ex2 Sends a message. [} 55] Properties Name Type Access Description hr Connect HRESULT Get Connection status to the remote system hr Init HRESULT Get Errors that occur during startup. s Net Id T_Ams Net Id Get Ams Net Id of the remote system Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 3.4.2.1 Clear Alarms Method for clearing active alarms. Returns S_OK if successful. Syntax METHOD Clear Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; b Reset Confirmation : BOOL := FALSE; ip Filter : I_Tc Event Filter; END_VAR 50 Version: 1.6.2 TE1000
## Page 51

Functions and function blocks Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 b Reset Confirmati BOOL If TRUE and the confirmation status is on Wait For Confirmation, the confirmation status is set to Reset. Otherwise, the confirmation status is not changed. Initial: FALSE ip Filter I_Tc Event Filter Specify which alarms are to be cleared, otherwise all triggered alarms are cleared. Return value Name Type Description Clear Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.4.2.2 Clear Logged Events Async method for clearing logged events. Returns TRUE if the asynchronous request is no longer assigned. Syntax METHOD Clear Logged Events : HRESULT VAR_INPUT ip Clear Settings : I_Tc Clear Logged Events Settings; END_VAR Inputs Name Type Description ip Clear Settings I_Tc Clear Logged Events Settin Optional gs (otherwise the entire cache is emptied) Return value Name Type Description Clear Logged Eve HRESULT Returns S_PENDING as long as the request has not yet nts been completed. Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. Use of the method This method is asynchronous, i.e. it requires several cycles to deliver the return value. The following use is intended: IF b Clear Logged Events THEN b Clear Logged Events:= NOT (fb Logger. Clear Logged Events(0) = S_OK); END_IF TE1000 Version: 1.6.2 51
## Page 52

Functions and function blocks 3.4.2.3 Confirm Alarms The method confirms alarms. Syntax METHOD Confirm Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 ip Filter I_Tc Event Filter Specify which alarms are to be confirmed, otherwise all alarms with the confirmation status Wait For Confirmation are confirmed. Return value Name Type Description Confirm Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.4.2.4 Connect The method connects to the remote system. Syntax METHOD Connect : HRESULT VAR_INPUT s Net Id : T_Ams Net Id; (* Ams Net Id of the remote Twin CAT system.*) END_VAR Inputs Name Type Description s Net Id T_Ams Net Id Ams Net Id of the remote system Return value Name Type Description Connect HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 52 Version: 1.6.2 TE1000
## Page 53

Functions and function blocks 3.4.2.5 Disconnect The method terminates the connection with the remote system. Syntax METHOD Disconnect : HRESULT Return value Name Type Description Disconnect HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.4.2.6 Send Message This method sends a message. Syntax METHOD Send Message : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR Inputs Name Type Description event Class GUID GUID of the event class n Event Id UDINT ID of the event e Severity Tc Event Severity Severity of the event ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. TE1000 Version: 1.6.2 53
## Page 54

Functions and function blocks Return value Name Type Description Send Message HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.4.2.7 Send Message2 This method sends a message. Syntax METHOD Send Message2 : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR Inputs Name Type Description event Class GUID GUID of the event class n Event Id UDINT ID of the event. e Severity Tc Event Severity Severity of the event ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return value Name Type Description Send Message2 HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 54 Version: 1.6.2 TE1000
## Page 55

Functions and function blocks 3.4.2.8 Send Message Ex This method sends a message. Syntax METHOD Send Message Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR Inputs Name Type Description st Event Entry Tc Event Entry Event definition ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. Return value Name Type Description Send Message Ex HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.4.2.9 Send Message Ex2 This method sends a message. Syntax METHOD Send Message Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR TE1000 Version: 1.6.2 55
## Page 56

Functions and function blocks Inputs Name Type Description st Event Entry Tc Event Entry Event definition ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return value Name Type Description Send Message Ex HRESULT Returns S_OK if the method call was successful, 2 otherwise an HRESULT as the error code. 3.5 FB_Listener Base2 The function block serves as the basic implementation of an event listener. New messages and state changes of alarms can be recognized through the overwriting of the event-driven methods. Syntax Definition: FUNCTION_BLOCK FB_Listener Base2 IMPLEMENTS I_Listener2 Methods Name Definition loca- Description tion Execute [} 57] Local Must be called cyclically so that the event queue can be processed. Subscribe [} 59] Local Subscribes messages. Unsubscribe [} 60] Local Unsubscribes messages. 56 Version: 1.6.2 TE1000
## Page 57

Functions and function blocks Event-driven methods (callback methods) Name Definition loca- Description tion On Alarm Cleared I_Listener2 Called when the state of an alarm changes from "Raised" to "Clear". [} 57] On Alarm Confirmed I_Listener2 Called when an alarm has been confirmed. [} 58] On Alarm Disposed I_Listener2 Called when an alarm instance has been released again. [} 58] On Alarm Raised [} 58] I_Listener2 Called when the state of an alarm changes from "Clear" to "Raised". On Message Sent I_Listener2 Called when a message has been sent. [} 59] Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 3.5.1 Execute This method must be called cyclically so that the event queue can be processed. Syntax METHOD Execute : HRESULT Return value Name Type Description Execute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.5.2 On Alarm Cleared This method is called if the state of an alarm changes from Raised to Clear. Syntax METHOD On Alarm Cleared : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. TE1000 Version: 1.6.2 57
## Page 58

Functions and function blocks Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 69] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 3.5.3 On Alarm Confirmed This method is called when an alarm has been confirmed. Syntax METHOD On Alarm Confirmed : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 69] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 3.5.4 On Alarm Disposed This method is called when an alarm instance has been released again. Syntax METHOD On Alarm Confirmed : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 69] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 3.5.5 On Alarm Raised This method is called if the state of an alarm changes from Clear to Raised. 58 Version: 1.6.2 TE1000
## Page 59

Functions and function blocks Syntax METHOD On Alarm Raised : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 69] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 3.5.6 On Message Sent This method is called when a message has been sent. Syntax METHOD On Message Sent : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 69] Reference to the event that has occurred. This reference must not be copied, e.g. through assignment. 3.5.7 Subscribe The listener is subscribed for messages with this method. Syntax METHOD Subscribe : HRESULT VAR_INPUT ip Message Filter Config : POINTER TO ITc Event Filter Config; ip Alarm Filter Config : POINTER TO ITc Event Filter Config; END_VAR TE1000 Version: 1.6.2 59
## Page 60

Functions and function blocks Inputs Name Type Description ip Message Filter Config POINTER TO ITc Event Filter Config Pointer to ITc Event Filter Config if a filter is to be activated. ip Alarm Filter Config POINTER TO ITc Event Filter Config Pointer to ITc Event Filter Config if a filter is to be activated. Return value Name Type Description Subscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_EXISTS if the listener is already subscribed. Otherwise returns HRESULT as the error code. 3.5.8 Subscribe2 This method subscribes notifications. Syntax METHOD Subscribe2 : HRESULT Input Name Type Description ip Event Filter I_Tc Event Filter Base Pointer to an instance of FB_Tc Event Filter [} 41], if a filter is to be activated. Return value Name Type Description Subscribe2 HRESULT Delivers if successful S_OK. 3.5.9 Unsubscribe The listener is unsubcribed with this method. Syntax METHOD Unsubscribe : HRESULT 60 Version: 1.6.2 TE1000
## Page 61

Functions and function blocks Return value Name Type Description Unsubscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_NOTFOUND if the listener was not subscribed. Otherwise returns HRESULT as the error code. 3.6 FB_Tc Alarm This function block represents an alarm of the Twin CAT 3 Event Logger. Syntax Definition: FUNCTION_BLOCK FB_Tc Alarm EXTENDS FB_Tc Event Base Inheritance hierarchy FB_Tc Event Base [} 71] FB_Tc Alarm TE1000 Version: 1.6.2 61
## Page 62

Functions and function blocks Methods Name Definition location Description Equals To [} 72] Inherited from FB_Tc Event Base Compares the event with another instance. [} 71] Equals To Event Class [} 73] Inherited from FB_Tc Event Base Compares the event class of the event with another event class. [} 71] Equals To Event Entry [} 73] Inherited from FB_Tc Event Base Compares the event class, the event ID and the severity of the event with those of another [} 71] event. Equals To Event Entry Ex [} 74] Inherited from FB_Tc Event Base Compares the event definition of the event with another event definition. [} 71] Get Json Attribute [} 74] Inherited from FB_Tc Event Base Returns the Json attribute. [} 71] Release [} 75] Inherited from FB_Tc Event Base Releases the instance created by the Event Logger again. [} 71] Request Event Class Name Inherited from FB_Tc Event Base Requests the name of the event class. [} 75] [} 71] Request Event Text [} 76] Inherited from FB_Tc Event Base Returns the text for the event. [} 71] Clear [} 63] Local Sets the alarm state to "Not Raised". Confirm [} 64] Local Confirms the alarm. Create [} 65] Local Creates an alarm instance in the Event Logger. Create Ex [} 65] Local Creates an alarm instance in the Event Logger from an event definition. Raise [} 66] Local Sets the alarm state to "Raised". Set Json Attribute [} 67] Local Sets the Json attribute. 62 Version: 1.6.2 TE1000
## Page 63

Functions and function blocks Properties Name Type Access Definition location Description e Severity Tc Event Severity Get Inherited from Returns the severity. [} 112] FB_Tc Event Base [} 71] Event Class GUID Get Inherited from Returns the GUID of the event FB_Tc Event Base class. [} 71] ip Arguments [} 77] I_Tc Arguments Get Inherited from Returns the interface pointer for [} 95] FB_Tc Event Base the arguments. [} 71] ip Source Info [} 77] I_Tc Source Info Get Inherited from The Source Info is created [} 110] FB_Tc Event Base internally as the default behavior. It then contains the [} 71] symbol name of the function block that instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id n Event Id Get Inherited from Returns the ID of the event. FB_Tc Event Base [} 71] st Event Entry Tc Event Entry Get Inherited from Returns the event definition. [} 112] FB_Tc Event Base [} 71] b Raised BOOL Get Local Returns TRUE if the alarm is in the "raised" state. b Active BOOL Get Local Returns TRUE if the alarm is in the "Raised" or "Wait For Confirmation" state. e Confirmation State Tc Event Confirmati Get Local Returns the confirmation state. on State [} 112] n Time Cleared ULINT Get Local Returns the time of the Clear. n Time Confirmed ULINT Get Local Returns the time of the Confirm. n Time Raised ULINT Get Local Returns the time of the Raise. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.6.1 Clear This method sets the alarm state to Not Raised. TE1000 Version: 1.6.2 63
## Page 64

Functions and function blocks Syntax METHOD Clear : HRESULT VAR_INPUT n Time Stamp : ULINT; b Reset Confirmation : BOOL; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). b Reset Confirmation BOOL If TRUE and the confirmation state is Wait For Confirmation, the confirmation state is set to Reset. Otherwise the confirmation state is not changed. Return value Name Type Description Clear HRESULT Returns S_OK if the method call was successful. Returns ADS_E_INVALIDSTATE if the alarm was not in the Raised state. Otherwise returns HRESULT as the error code. 3.6.2 Confirm This method sets the confirmation state of Wait For Confirmation to Confirmed. Syntax METHOD Confirm : HRESULT VAR_INPUT n Time Stamp: ULINT; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Confirm HRESULT Returns S_OK if the method call was successful. Returns ADS_E_INVALIDSTATE if the confirmation state was not Wait Confirmation. Otherwise returns HRESULT as the error code. 64 Version: 1.6.2 TE1000
## Page 65

Functions and function blocks 3.6.3 Create This method creates an alarm instance in the Event Logger. Syntax METHOD Create : HRESULT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; b With Confirmation : BOOL; ip Source Info : I_Tc Source Info; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Severity of the event. [} 112] b With Confirmation BOOL Defines whether the alarm requires mandatory confirmation. ip Source Info I_Tc Source Info Interface pointer to the source information. [} 110] This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create HRESULT Returns S_OK if a new alarm was successfully created. Returns ERROR_ALREADY_EXISTS if the alarm has already existed. Otherwise returns HRESULT as the error code 3.6.4 Create Ex This method creates an alarm instance in the Event Logger. Syntax METHOD Create Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; b With Confirmation : BOOL; ip Source Info : I_Tc Source Info; END_VAR TE1000 Version: 1.6.2 65
## Page 66

Functions and function blocks Inputs Name Type Description st Event Entry Tc Event Entry [} 112] Event definition. b With Confirmation BOOL Defines whether the alarm requires mandatory confirmation. ip Source Info I_Tc Source Info [} 110] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create Ex HRESULT Returns S_OK if a new alarm was successfully created. Returns ERROR_ALREADY_EXISTS if the alarm has already existed. Otherwise returns HRESULT as the error code. 3.6.5 Raise The method sets the alarm state to Raised. If the alarm requires mandatory confirmation, the confirmation state is additionally set to Wait For Confirmation. Syntax METHOD Raise : HRESULT VAR_INPUT n Time Stamp : ULINT; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Raise HRESULT Returns S_OK if the method call was successful. Returns ADS_E_INVALIDSTATE if the alarm was already in the Raised state. Otherwise returns HRESULT as the error code. 66 Version: 1.6.2 TE1000
## Page 67

Functions and function blocks 3.6.6 Set Json Attribute This method sets the JSON attribute. Syntax METHOD Set Json Attribute : HRESULT VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR Inputs Name Type Description s Json Attribute STRING JSON string Return value Name Type Description Set Json Attribute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.7 FB_Tc Arguments Arguments of an event can be defined with this function block. The ITc Arguments interface is implemented for this. Syntax Definition: FUNCTION_BLOCK FB_Tc Arguments IMPLEMENTS I_Tc Arguments Interfaces Type Description I_Tc Arguments [} 95] Defines the argument handling. TE1000 Version: 1.6.2 67
## Page 68

Functions and function blocks Methods Name Definition loca- Description tion Add Blob [} 95] I_Tc Arguments Adds binary data as an argument. [} 95] Add Bool [} 96] I_Tc Arguments Adds an argument of the type BOOL. [} 95] Add Byte [} 96] I_Tc Arguments Adds an argument of the type BYTE. [} 95] Add Dint [} 97] I_Tc Arguments Adds an argument of the type DINT. [} 95] Add DWord [} 97] I_Tc Arguments Adds an argument of the type DWORD. [} 95] Add Event Reference Id I_Tc Arguments Adds a reference to another event as an argument. [} 98] [} 95] Add Event Reference Id G I_Tc Arguments Adds a reference to another event as an argument. uid [} 98] [} 95] Add Int [} 99] I_Tc Arguments Adds an argument of the type INT. [} 95] Add LInt [} 99] I_Tc Arguments Adds an argument of the type LINT. [} 95] Add LReal [} 99] I_Tc Arguments Adds an argument of the type LREAL. [} 95] Add Real [} 100] I_Tc Arguments Adds an argument of the type REAL. [} 95] Add SInt [} 100] I_Tc Arguments Adds an argument of the type SINT. [} 95] Add String [} 101] I_Tc Arguments Adds an argument of the type STRING. [} 95] Add UDint [} 101] I_Tc Arguments Adds an argument of the type UDINT. [} 95] Add UInt [} 102] I_Tc Arguments Adds an argument of the type INT. [} 95] Add ULInt [} 102] I_Tc Arguments Adds an argument of the type ULINT. [} 95] Add USInt [} 103] I_Tc Arguments Adds an argument of the type USINT. [} 95] Add Word [} 103] I_Tc Arguments Adds an argument of the type WORD. [} 95] Add WString [} 103] I_Tc Arguments Adds an argument of the type WSTRING. [} 95] Clear [} 104] I_Tc Arguments Removes all arguments. [} 95] Is Empty [} 69] Local Checks whether arguments have been added. 68 Version: 1.6.2 TE1000
## Page 69

Functions and function blocks Properties Name Type Access Description n Count UDINT Get Returns the number of transferred arguments. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.7.1 Is Empty This method checks whether arguments have been added. Syntax METHOD Is Empty : BOOL Return value Name Type Description Is Empty BOOL Returns TRUE if no arguments have been added. 3.8 FB_Tc Event This function block provides only read methods and read properties for an event. Syntax Definition: FUNCTION_BLOCK FB_Tc Event EXTENDS FB_Tc Event Base IMPLEMENTS I_Tc Event Base Inheritance hierarchy FB_Tc Event Base [} 71] FB_Tc Event Interfaces Type Description I_Tc Event Base [} 104] Basic interface that defines methods and properties of an event. TE1000 Version: 1.6.2 69
## Page 70

Functions and function blocks Methods Name Definition location Description Equals To [} 72] Inherited from FB_Tc Event Base Compares the event with another instance. [} 71] Equals To Event Class [} 73] Inherited from FB_Tc Event Base Compares the event class of the event with another event class. [} 71] Equals To Event Entry [} 73] Inherited from FB_Tc Event Base Compares the event definition of the event with another event [} 71] definition. Equals To Event Entry Ex [} 74] Inherited from FB_Tc Event Base Compares the event definition of the event with another event [} 71] definition. Get Json Attribute [} 74] Inherited from FB_Tc Event Base Returns the Json attribute. [} 71] Release [} 75] Inherited from FB_Tc Event Base Releases the instance created by the Event Logger again. [} 71] Request Event Class Name [} 75] Inherited from FB_Tc Event Base Requests the name of the event class. [} 71] Request Event Text [} 76] Inherited from FB_Tc Event Base Returns the text for the event. [} 71] Properties Name Type Access Definition loca- Description tion e Severity Tc Event Severity Get Inherited from Returns the severity. [} 112] FB_Tc Event Base [} 71] Event Class GUID Get Inherited from Returns the GUID of the event class. FB_Tc Event Base [} 71] ip Arguments I_Tc Arguments Get Inherited from Returns the interface pointer for the [} 77] [} 95] FB_Tc Event Base arguments. [} 71] ip Source Info I_Tc Source Info Get Inherited from The Source Info is created internally as [} 77] [} 110] FB_Tc Event Base the default behavior. It then contains the symbol name of the function block that [} 71] instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id n Event Id Get Inherited from Returns the ID of the event. FB_Tc Event Base [} 71] st Event Entry Tc Event Entry [} 112] Get Inherited from Returns the event definition. FB_Tc Event Base [} 71] n Timestamp ULINT Get Local Returns the time. 70 Version: 1.6.2 TE1000
## Page 71

Functions and function blocks Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.9 FB_Tc Event Base This function block contains the basic implementation. Syntax Definition: FUNCTION_BLOCK FB_Tc Event Base Methods Name Definition location Description Equals To [} 72] Local Compares the event with another instance. Equals To Event Class [} 73] Local Compares the event class of the event with another event class. Equals To Event Entry [} 73] Local Compares the event definition of the event with another event definition. Equals To Event Entry Ex [} 74] Local Compares the event definition of the event with another event definition. Get Json Attribute [} 74] Local Returns the Json attribute. Release [} 75] Local Releases the instance created by the Event Logger again. Request Event Class Name [} 75] Local Requests the name of the event class. Request Event Text [} 76] Local Returns the text for the event. TE1000 Version: 1.6.2 71
## Page 72

Functions and function blocks Properties Name Type Access Description e Severity Tc Event Severity [} 112] Get Returns the severity. Event Class GUID Get Returns the GUID of the event class. ip Arguments [} 77] I_Tc Arguments [} 95] Get Returns the interface pointer for the arguments. ip Source Info [} 77] I_Tc Source Info [} 110] Get The Source Info is created internally as the default behavior. It then contains the symbol name of the function block that instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id UDINT Get Returns the ID of the event. n Unique Id UDINT Get Returns the unique ID of the event. st Event Entry Tc Event Entry [} 112] Get Returns the event definition. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.9.1 Equals To This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To : BOOL VAR_INPUT ip Other : I_Tc Event Base; END_VAR Inputs Name Type Description ip Other I_Tc Event Base [} 104] Event to be compared 72 Version: 1.6.2 TE1000
## Page 73

Functions and function blocks Return value Name Type Description Equals To BOOL Returns TRUE if the events match. 3.9.2 Equals To Event Class This method carries out a comparison with another event class specified at the input. Syntax METHOD Equals To Event Class : BOOL VAR_INPUT Other Event Class : GUID; END_VAR Inputs Name Type Description Other Event Class GUID Event class to be compared. Return value Name Type Description Equals To Event Class BOOL Returns TRUE if the event classes match. 3.9.3 Equals To Event Entry This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry : BOOL VAR_INPUT Other Event Class : GUID; n Other Event ID : UDINT; e Other Severity : Tc Event Severity; END_VAR Inputs Name Type Description Other Event Class GUID Event class of the event to be compared. n Other Event ID UDINT Event ID of the event to be compared. e Other Severity Tc Event Severity [} 112] Event severity of the event to be compared. TE1000 Version: 1.6.2 73
## Page 74

Functions and function blocks Return value Name Type Description Equals To Event Entry BOOL Returns TRUE if the events match. 3.9.4 Equals To Event Entry Ex This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry Ex : BOOL VAR_INPUT st Other : Tc Event Entry; END_VAR Inputs Name Type Description st Other Tc Event Entry [} 112] Event to be compared. Return value Name Type Description Equals To Event Entry Ex BOOL Returns TRUE if the events match. 3.9.5 Get Json Attribute This method returns the JSON attribute. Syntax METHOD Get Json Attribute : HRESULT VAR_INPUT s Json Attribute : REFERENCE TO STRING; n Json Attribute : UDINT; END_VAR Inputs Name Type Description s Json Attribute REFERENCE TO STRING Reference to a variable of the type String n Json Attribute UDINT Length of the String variable 74 Version: 1.6.2 TE1000
## Page 75

Functions and function blocks Return value Name Type Description Get Json Attribute HRESULT Returns S_OK if the method call was successful. Returns ERROR_BAD_LENGTH if the length of the variable is too small. Otherwise HRESULT is returned as the error code. 3.9.6 Release This method releases the instance created by the Event Logger again. Syntax METHOD Release : HRESULT Return value Name Type Description Release HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.9.7 Request Event Class Name This method returns the name of the event class. Syntax METHOD Request Event Class Name : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes TE1000 Version: 1.6.2 75
## Page 76

Functions and function blocks Return value Name Type Description Request Event Class Name BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 3.9.8 Request Event Text This method returns the event text. Syntax METHOD Request Event Text : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes Return value Name Type Description Request Event Text BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. 76 Version: 1.6.2 TE1000
## Page 77

Functions and function blocks Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 3.9.9 ip Arguments PROPERTY PUBLIC ip Arguments : I_Tc Arguments 3.9.10 ip Source Info PROPERTY ip Source Info : I_Tc Source Info 3.10 FB_Tc Event Logger This function block represents the Twin CAT 3 Event Logger itself. Syntax Definition: FUNCTION_BLOCK FB_Tc Event Logger Methods Name Description Clear Alarms [} 78] Clears active alarms. Clear All Alarms [} 78] Calls Clear() for all alarms in the Raised state. Clear Logged Events [} 79] Clears logged events. Confirm Alarms [} 80] Confirms alarms. Confirm All Alarms [} 80] Calls Confirm() for all alarms with the confirmation state Wait For Confirmation. Export Logged Events [} 81] Exports logged events. Get Alarm [} 82] Returns the pointer to an existing alarm. Get Alarm Ex [} 82] Returns the pointer to an existing alarm. Is Alarm Raised [} 83] Queries whether an alarm is in the Raised state. Is Alarm Raised Ex [} 83] Queries whether an alarm is in the Raised state. Send Message [} 84] Sends a message. Send Message2 [} 85] Sends a message. Send Message Ex [} 86] Sends a message. Send Message Ex2 [} 87] Sends a message. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger TE1000 Version: 1.6.2 77
## Page 78

Functions and function blocks 3.10.1 Clear Alarms Method for clearing active alarms. Returns S_OK if successful. Syntax METHOD Clear Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; b Reset Confirmation : BOOL := FALSE; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 b Reset Confirmation BOOL If TRUE and the confirmation status is Wait For Confirmation, the confirmation status is set to Reset. Otherwise, the confirmation status is not changed. Initial: FALSE ip Filter I_Tc Event Filter Specify which alarms are to be cleared, otherwise all triggered alarms are cleared. Return values Name Type Description Clear Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.2 Clear All Alarms This method calls the Clear() method for all alarms in the alarm state Raised. Syntax METHOD Clear All Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; b Reset Confirmation : BOOL := FALSE; END_VAR 78 Version: 1.6.2 TE1000
## Page 79

Functions and function blocks Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). b Reset Confirmation BOOL If TRUE and the confirmation state is Wait For Confirmation, the confirmation state is set to Reset. Otherwise the confirmation state is not changed. Return value Name Type Description Clear All Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code 3.10.3 Clear Logged Events Async method for clearing logged events. Returns TRUE if the asynchronous request is no longer assigned. Syntax METHOD Clear Logged Events : BOOL VAR_INPUT ip Clear Settings : I_Tc Clear Logged Events Settings; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description ip Clear Settings I_Tc Clear Logged Events Settings Optional (otherwise the entire cache is emptied) Return values Name Type Description Clear Logged Events BOOL Returns TRUE as soon as the request has been processed. Outputs Name Type Description b Error BOOL Returns TRUE if the query is incorrect. hr Error Code HRESULT Returns an error code if the query is incorrect. TE1000 Version: 1.6.2 79
## Page 80

Functions and function blocks Application sample for the method This method is asynchronous, i.e. it requires several cycles to deliver the return value. The following use is intended: IF b Clear Logged Events THEN b Clear Logged Events:= NOT fb Logger. Clear Logged Events(0); END_IF 3.10.4 Confirm Alarms This method confirms alarms. Syntax METHOD Confirm Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 ip Filter I_Tc Event Filter Specify which alarms are to be confirmed, otherwise all alarms with the confirmation status Wait For Confirmation are confirmed. Return values Name Type Description Confirm Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.5 Confirm All Alarms This method calls the Confirm() method for all alarms having the confirmation state Wait For Confirmation. Syntax METHOD Confirm All Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; END_VAR 80 Version: 1.6.2 TE1000
## Page 81

Functions and function blocks Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Confirm All Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.6 Export Logged Events This method exports logged events asynchronously. Returns TRUE when asynchronous processing is complete. Syntax METHOD Export Logged Events : BOOL VAR_IN_OUT CONSTANT s File Name : STRING; END_VAR VAR_INPUT ip Export Settings : I_Tc Event Export Settings; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description ip Export Settings I_Tc Event Export Settings Specify which events are to be exported, otherwise all events will be exported. An instance of FB_Tc Event Csv Export Settings [} 40] can be assigned for this purpose. Inputs/outputs Name Type Description s File Name STRING Name of the destination file Return values Name Type Description Export Logged Events BOOL TRUE, if the processing is completed. TE1000 Version: 1.6.2 81
## Page 82

Functions and function blocks Outputs Name Type Description b Error BOOL TRUE when an error occurs. hr Error Code HRESULT Outputs the error information if b Error is TRUE. Application sample for the method This method is asynchronous, i.e. it requires several cycles to deliver the return value. The following use is intended: IF b Export Logged Events THEN b Export Logged Events:= NOT fb Logger. Export Logged Events(…); END_IF 3.10.7 Get Alarm This method returns an interface pointer to an existing instance. Syntax METHOD Get Alarm : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; ip Source Info : I_Tc Source Info := 0; fb Alarm : REFERENCE TO FB_Tc Alarm; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event ip Source Info I_Tc Source Info [} 110] Pointer to an ITc Source Info interface. fb Alarm REFERENCE TO FB_Tc Alarm [} 61] Pointer to an alarm. Return value Name Type Description Get Alarm HRESULT Returns ADS_E_NOTFOUND if no instance was found. Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.8 Get Alarm Ex This method returns an interface pointer to an existing instance. 82 Version: 1.6.2 TE1000
## Page 83

Functions and function blocks Syntax METHOD Get Alarm Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; // optional fb Alarm : REFERENCE TO FB_Tc Alarm; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 112] Event definition ip Source Info I_Tc Source Info [} 110] Pointer to an ITc Source Info interface fb Alarm REFERENCE TO FB_Tc Alarm [} 61] Pointer to an alarm Return value Name Type Description Get Alarm Ex HRESULT Returns ADS_E_NOTFOUND if no instance was found. Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.9 Is Alarm Raised This method queries whether an alarm is in the Raised state. Syntax METHOD Is Alarm Raised : BOOL VAR_INPUT event Class : GUID; n Event Id : UDINT; ip Source Info : I_Tc Source Info := 0; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. ip Source Info I_Tc Source Info [} 110] Pointer to an ITc Source Info interface. Return value Name Type Description Is Alarm Raised BOOL Returns TRUE if the alarm is in the raised state. 3.10.10 Is Alarm Raised Ex TE1000 Version: 1.6.2 83
## Page 84

Functions and function blocks This method queries whether an alarm is in the Raised state. Syntax METHOD Is Alarm Raised Ex : BOOL VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; END_VAR Inputs Name Type Description st Event Entry UDINT Event definition. ip Source Info I_Tc Source Info [} 110] Pointer to an ITc Source Info interface. Return value Name Type Description Is Alarm Raised Ex BOOL Returns TRUE if the alarm is in the raised state. 3.10.11 Send Message This method sends a message. Syntax METHOD Send Message : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR 84 Version: 1.6.2 TE1000
## Page 85

Functions and function blocks Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity [} 112] Severity of the event. ip Source Info I_Tc Source Info [} 110] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). ip Arguments I_Tc Arguments [} 95] Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. Return value Name Type Description Send Message HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.12 Send Message2 This method sends a message. Syntax METHOD Send Message2 : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR TE1000 Version: 1.6.2 85
## Page 86

Functions and function blocks Inputs Name Type Description event Class GUID GUID of the event class n Event Id UDINT ID of the event e Severity Tc Event Severity Severity of the event ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return values Name Type Description Send Message2 HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.13 Send Message Ex This method sends a message. Syntax METHOD Send Message Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR 86 Version: 1.6.2 TE1000
## Page 87

Functions and function blocks Inputs Name Type Description st Event Entry Tc Event Entry [} 112] Event definition. ip Source Info I_Tc Source Info [} 110] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). ip Arguments I_Tc Arguments [} 95] Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. Return value Name Type Description Send Message Ex HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.10.14 Send Message Ex2 This method sends a message. Syntax METHOD Send Message Ex2 : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR TE1000 Version: 1.6.2 87
## Page 88

Functions and function blocks Inputs Name Type Description st Event Entry Tc Event Entry Event definition ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 67] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return values Name Type Description Send Message Ex2 HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.11 FB_Tc Message This function block represents a message from the Twin CAT 3 Event Logger. Syntax Definition: FUNCTION_BLOCK FB_Tc Message EXTENDS FB_Tc Event Base IMPLEMENTS I_Tc Message Inheritance hierarchy FB_Tc Event Base [} 71] FB_Tc Message Interfaces Type Description I_Tc Message [} 109] Provides methods and properties for the message handling. 88 Version: 1.6.2 TE1000
## Page 89

Functions and function blocks Methods Name Definition loca- Description tion Equals To [} 72] Inherited from Compares the event with another instance. FB_Tc Event Base [} 71] Equals To Event Class Inherited from Compares the event class of the event with another event [} 73] FB_Tc Event Base class. [} 71] Equals To Event Entry Inherited from Compares the event definition of the event with another event [} 73] FB_Tc Event Base definition. [} 71] Equals To Event Entry Ex Inherited from Compares the event definition of the event with another event [} 74] FB_Tc Event Base definition. [} 71] Get Json Attribute [} 74] Inherited from Returns the Json attribute. FB_Tc Event Base [} 71] Release [} 75] Inherited from Releases the instance created by the Event Logger again. FB_Tc Event Base [} 71] Request Event Class Nam Inherited from Requests the name of the event class. e [} 75] FB_Tc Event Base [} 71] Request Event Text Inherited from Returns the text for the event. [} 76] FB_Tc Event Base [} 71] Create [} 90] Local Creates a message instance in the Event Logger. Create Ex [} 91] Local Creates a message instance in the Event Logger from an event definition. Set Json Attribute Local Sets the Json attribute. [} 91] Send [} 109] I_Tc Message Sends a message. [} 109] TE1000 Version: 1.6.2 89
## Page 90

Functions and function blocks Properties Name Type Access Definition location Description e Severity Tc Event Severity Get Inherited from Returns the severity. [} 112] FB_Tc Event Base [} 71] Event Class GUID Get Inherited from Returns the GUID of the event class. FB_Tc Event Base [} 71] ip Arguments I_Tc Arguments Get Inherited from Returns the interface pointer for the [} 77] [} 95] FB_Tc Event Base arguments. [} 71] ip Source Info I_Tc Source Info Get Inherited from The Source Info is created internally as [} 77] [} 110] FB_Tc Event Base the default behavior. It then contains the symbol name of the function block [} 71] that instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id n Event Id Get Inherited from Returns the ID of the event. FB_Tc Event Base [} 71] st Event Entry Tc Event Entry [} 112] Get Inherited from Returns the event definition. FB_Tc Event Base [} 71] n Time Sent ULINT Get Local Returns the time of the Send. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.11.1 Create This method creates a message instance in the Event Logger. Syntax METHOD Create : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; END_VAR 90 Version: 1.6.2 TE1000
## Page 91

Functions and function blocks Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Defines the severity. [} 112] ip Source Info I_Tc Source Info Interface pointer to the source information. [} 110] This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.11.2 Create Ex This method creates a message instance in the Event Logger from an event definition. Syntax METHOD PUBLIC Create Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 112] Event definition. ip Source Info I_Tc Source Info [} 110] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 92] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create Ex HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.11.3 Set Json Attribute TE1000 Version: 1.6.2 91
## Page 92

Functions and function blocks This method sets the JSON attribute. Syntax METHOD Set Json Attribute : HRESULT VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR Inputs Name Type Description s Json Attribute STRING JSON string Return value Name Type Description Set Json Attribute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 3.12 FB_Tc Source Info The source information of an event can be defined with this function block. Syntax Definition: FUNCTION_BLOCK FB_Tc Source Info IMPLEMENTS I_Tc Source Info Interfaces Type Description I_Tc Source Info [} 110] Provides read methods and read properties of a source information. Methods Name Definition loca- Description tion Clear [} 93] Local Resets the source information. Extend Name [} 93] Local Appends the transferred string to the name. Reset To Default [} 94] Local Sets the properties to default values. s Name is initialized with the symbol name of the instanced function block. n Id is initialized with the object ID of the PLC instance. If the instance of FB_Tc Source Info is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. Equals To [} 110] I_Tc Source Info Compares an instance with another instance. [} 110] 92 Version: 1.6.2 TE1000
## Page 93

Functions and function blocks Properties Name Type Access Definition location Description guid GUID Get I_Tc Source Info [} 110] Returns the GUID of the source information. guid GUID SET Local Sets the GUID as source information. n Id UDINT Get I_Tc Source Info [} 110] Returns the ID of the source information. n Id UDINT SET Local Sets the ID of the source information. s Name STRING(Parameter List.c Sourc Get I_Tc Source Info [} 110] Returns the name of the e Name Size-1) source information. s Name STRING(Parameter List.c Sourc SET Local Sets the name of the e Name Size-1) source information Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 3.12.1 Clear This method resets the source information. Syntax METHOD Clear 3.12.2 Extend Name This method extends the name. Syntax METHOD Extend Name : BOOL VAR_INPUT s Extension : STRING(255); END_VAR Inputs Name Type Description s Extension STRING(255) Text to be appended to the right. TE1000 Version: 1.6.2 93
## Page 94

Functions and function blocks Return value Name Type Description Extend Name BOOL Returns TRUE if the concatenation was successful. Returns FALSE if the resulting character string is longer than the output character string and doesn't fit in the given output buffer. The memory requirement for the resulting string is then larger than that for the output string. The string is then truncated. 3.12.3 Reset To Default This method sets the source information to default values. Default values: s Name is initialized with the symbol name of the instanced function block. n Id is initialized with the object ID of the PLC instance. If the instance of FB_Tc Source Info is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. Syntax METHOD Reset To Default 94 Version: 1.6.2 TE1000
## Page 95

Interfaces 4 Interfaces 4.1 I_Tc Arguments This interface defines methods for the argument handling. Inheritance hierarchy __SYSTEM. IQuery Interface I_Tc Arguments Methods Name Description Add Blob [} 95] Adds binary data as an argument. Add Bool [} 96] Adds an argument of the type BOOL. Add Byte [} 96] Adds an argument of the type BYTE. Add Dint [} 97] Adds an argument of the type DINT. Add DWord [} 97] Adds an argument of the type DWORD. Add Event Reference Id [} 98] Adds a reference to another event as an argument. Add Event Reference Id Guid Adds a reference to another event as an argument. [} 98] Add Int [} 99] Adds an argument of the type INT. Add LInt [} 99] Adds an argument of the type LINT. Add LReal [} 99] Adds an argument of the type LREAL. Add Real [} 100] Adds an argument of the type REAL. Add SInt [} 100] Adds an argument of the type SINT. Add String [} 101] Adds an argument of the type STRING. Add UDint [} 101] Adds an argument of the type UDINT. Add UInt [} 102] Adds an argument of the type INT. Add ULInt [} 102] Adds an argument of the type ULINT. Add USInt [} 103] Adds an argument of the type USINT. Add Word [} 103] Adds an argument of the type WORD. Add WString [} 103] Adds an argument of the type WSTRING. Clear [} 104] Removes all arguments. Properties Name Type Access Description n Count UDINT Get Returns the number of transferred arguments. 4.1.1 Add Blob This method adds binary data as an argument. TE1000 Version: 1.6.2 95
## Page 96

Interfaces Syntax METHOD Add Blob : I_Tc Arguments VAR_INPUT p Data : PVOID; cb Data : UINT; END_VAR Inputs Name Type Description p Data PVOID Pointer to the first byte of the binary data. cb Data UINT Length of the binary data in bytes. Return value Name Type Description Add Blob I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.2 Add Bool This method adds an argument of the type BOOL. Syntax METHOD Add Bool : I_Tc Arguments VAR_INPUT value : BOOL; END_VAR Inputs Name Type Description value BOOL Value to be added. Return value Name Type Description Add Bool I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.3 Add Byte This method adds an argument of the type BYTE. Syntax METHOD Add Byte : I_Tc Arguments VAR_INPUT value : BYTE; END_VAR 96 Version: 1.6.2 TE1000
## Page 97

Interfaces Inputs Name Type Description value BYTE Value to be added. Return value Name Type Description Add Byte I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.4 Add Dint This method adds an argument of the type DINT. Syntax METHOD Add DINT : I_Tc Arguments VAR_INPUT value : DINT; END_VAR Inputs Name Type Description value DINT Value to be added. Return value Name Type Description Add DINT I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.5 Add DWord This method adds an argument of the type DWORD. Syntax METHOD Add DWord : I_Tc Arguments VAR_INPUT value : DWORD; END_VAR Inputs Name Type Description value DWORD Value to be added. TE1000 Version: 1.6.2 97
## Page 98

Interfaces Return value Name Type Description Add DWord I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.6 Add Event Reference Id This method adds a reference to another event as an argument. Syntax METHOD Add Event Reference Id : I_Tc Arguments VAR_INPUT n Event Id : UDINT; END_VAR Inputs Name Type Description n Event Id UDINT ID of the event. Return value Name Type Description Add Event Reference Id I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.7 Add Event Reference Id Guid This method adds a reference to another event as an argument. Syntax METHOD Add Event Reference Id Guid : I_Tc Arguments VAR_INPUT n Event Id : UDINT; Event Class : GUID; END_VAR Inputs Name Type Description n Event Id UDINT ID of the event. Event Class GUID GUID of the event class. Return value Name Type Description Add Event Reference Id Guid I_Tc Arguments Returns the I_Tc Argument pointer again. [} 95] 98 Version: 1.6.2 TE1000
## Page 99

Interfaces 4.1.8 Add Int This method adds an argument of the type INT. Syntax METHOD Add INT : I_Tc Arguments VAR_INPUT value : INT; END_VAR Inputs Name Type Description value INT Value to be added. Return value Name Type Description Add Int I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.9 Add LInt This method adds an argument of the type LINT. Syntax METHOD Add LInt : I_Tc Arguments VAR_INPUT value : LINT; END_VAR Inputs Name Type Description value LINT Value to be added. Return value Name Type Description Add LInt I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.10 Add LReal This method adds an argument of the type LREAL. TE1000 Version: 1.6.2 99
## Page 100

Interfaces Syntax METHOD Add LReal : I_Tc Arguments VAR_INPUT value : LREAL; END_VAR Inputs Name Type Description value LREAL Value to be added. Return value Name Type Description Add LReal I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.11 Add Real This method adds an argument of the type REAL. Syntax METHOD Add Real : I_Tc Arguments VAR_INPUT value : REAL; END_VAR Inputs Name Type Description value REAL Value to be added. Return value Name Type Description Add Real I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.12 Add SInt This method adds an argument of the type SINT. Syntax METHOD Add SInt : I_Tc Arguments VAR_INPUT value : SInt; END_VAR 100 Version: 1.6.2 TE1000
## Page 101

Interfaces Inputs Name Type Description value SINT Value to be added. Return value Name Type Description Add SInt I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.13 Add String This method adds an argument of the type STRING. Syntax METHOD Add String : I_Tc Arguments VAR_IN_OUT CONSTANT value : STRING; END_VAR Inputs Name Type Description value STRING Value to be added. Return value Name Type Description Add String I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.14 Add UDint This method adds an argument of the type UDINT. Syntax METHOD Add UDInt : I_Tc Arguments VAR_INPUT value : UDINT; END_VAR Inputs Name Type Description value UDINT Value to be added. TE1000 Version: 1.6.2 101
## Page 102

Interfaces Return value Name Type Description Add UDInt I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.15 Add UInt This method adds an argument of the type INT. Syntax METHOD Add UInt : I_Tc Arguments VAR_INPUT value : UINT; END_VAR Inputs Name Type Description value UINT Value to be added. Return value Name Type Description Add UInt I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.16 Add ULInt This method adds an argument of the type ULINT. Syntax METHOD Add ULInt : I_Tc Arguments VAR_INPUT value : ULINT; END_VAR Inputs Name Type Description value ULINT Value to be added. Return value Name Type Description Add ULInt I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 102 Version: 1.6.2 TE1000
## Page 103

Interfaces 4.1.17 Add USInt This method adds an argument of the type USINT. Syntax METHOD Add USInt : I_Tc Arguments VAR_INPUT value : USINT; END_VAR Inputs Name Type Description value USINT Value to be added. Return value Name Type Description Add USInt I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.18 Add Word This method adds an argument of the type WORD. Syntax METHOD Add Word : I_Tc Arguments VAR_INPUT value : WORD; END_VAR Inputs Name Type Description value WORD Value to be added. Return value Name Type Description Add Word I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.19 Add WString This method adds an argument of the type WSTRING. TE1000 Version: 1.6.2 103
## Page 104

Interfaces Syntax METHOD Add WString : I_Tc Arguments VAR_IN_OUT CONSTANT value : WSTRING; END_VAR Inputs Name Type Description value WSTRING Value to be added. Return value Name Type Description Add WString I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.1.20 Clear This method removes all arguments. Syntax METHOD Clear : I_Tc Arguments Return value Name Type Description Clear I_Tc Arguments [} 95] Returns the I_Tc Argument pointer again. 4.2 I_Tc Event Base Methods and properties of an event are defined in this basic interface. Methods Name Description Equals To [} 105] Compares the event with another instance. Equals To Event Class [} 105] Compares the event class of the event with another event class. Equals To Event Entry Ex Compares the event definition of the event with another event definition. [} 106] Get Json Attribute [} 107] Returns the Json attribute. Request Event Class Name Requests the name of the event class. [} 107] Request Event Text [} 108] Returns the text for the event. 104 Version: 1.6.2 TE1000
## Page 105

Interfaces Properties Name Type Access Description e Severity Tc Event Severity Get Returns the severity. [} 112] Event Class GUID Get Returns the GUID of the event class. ip Source Info I_Tc Source Info Get Returns a pointer to the source definition. [} 110] n Event Id UDINT Get Returns the ID of the event. st Event Entry Tc Event Entry [} 112] Get Returns the event definition. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 4.2.1 Equals To This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To : BOOL VAR_INPUT ip Other : I_Tc Event Base; END_VAR Inputs Name Type Description ip Other I_Tc Event Base [} 104] Event to be compared Return value Name Type Description Equals To BOOL Returns TRUE if the events match. 4.2.2 Equals To Event Class This method carries out a comparison with another event class specified at the input. Syntax METHOD Equals To Event Class : BOOL VAR_INPUT Other Event Class : GUID; END_VAR TE1000 Version: 1.6.2 105
## Page 106

Interfaces Inputs Name Type Description Other Event Class GUID Event class to be compared. Return value Name Type Description Equals To Event Class BOOL Returns TRUE if the event classes match. 4.2.3 Equals To Event Entry This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry : BOOL VAR_INPUT Other Event Class : GUID; n Other Event ID : UDINT; e Other Severity : Tc Event Severity; END_VAR Inputs Name Type Description Other Event Class GUID Event class of the event to be compared. n Other Event ID UDINT Event ID of the event to be compared. e Other Severity Tc Event Severity [} 112] Event severity of the event to be compared. Return value Name Type Description Equals To Event Entry BOOL Returns TRUE if the events match. 4.2.4 Equals To Event Entry Ex This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry Ex : BOOL VAR_INPUT st Other : Tc Event Entry; END_VAR 106 Version: 1.6.2 TE1000
## Page 107

Interfaces Inputs Name Type Description st Other Tc Event Entry [} 112] Event to be compared. Return value Name Type Description Equals To Event Entry Ex BOOL Returns TRUE if the events match. 4.2.5 Get Json Attribute This method returns the JSON attribute. Syntax METHOD Get Json Attribute : HRESULT VAR_INPUT s Json Attribute : REFERENCE TO STRING; n Json Attribute : UDINT; END_VAR Inputs Name Type Description s Json Attribute REFERENCE TO STRING Reference to a variable of the type String n Json Attribute UDINT Length of the String variable Return value Name Type Description Get Json Attribute HRESULT Returns S_OK if the method call was successful. Returns ERROR_BAD_LENGTH if the length of the variable is too small. Otherwise HRESULT is returned as the error code. 4.2.6 Request Event Class Name This method returns the name of the event class. Syntax METHOD Request Event Class Name : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT TE1000 Version: 1.6.2 107
## Page 108

Interfaces b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes Return value Name Type Description Request Event Class Name BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 4.2.7 Request Event Text This method returns the event text. Syntax METHOD Request Event Text : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR 108 Version: 1.6.2 TE1000
## Page 109

Interfaces Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes Return value Name Type Description Request Event Text BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 4.3 I_Tc Message This interface provides methods and properties for the message handling. Inheritance hierarchy I_Tc Event Base [} 104] I_Tc Message Methods Name Description Send [} 109] Sends a message Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 4.3.1 Send This method sends the message. TE1000 Version: 1.6.2 109
## Page 110

Interfaces Syntax METHOD Send : HRESULT VAR_INPUT n Time Stamp: ULINT; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Send FB_ HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code 4.4 I_Tc Source Info This interface defines properties for an item of source information. Methods Name Description Equals To [} 110] Compares an instance with source information with another instance. Properties Name Type Access Description guid GUID Get Returns the GUID of the source information. n Id UDINT Get Returns the ID of the source information. s Name STRING(Parameter List.c Sourc Get Returns the name of the source e Name Size-1) information. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 4.4.1 Equals To This method compares an instance with source information with another instance. Syntax METHOD Equals To : BOOL VAR_INPUT ip Other : I_Tc Source Info; END_VAR 110 Version: 1.6.2 TE1000
## Page 111

Interfaces Inputs Name Type Description ip Other I_Tc Source Info [} 110] Items of source information to be compared Return value Name Type Description Equals To BOOL Returns TRUE if the items of source information match. TE1000 Version: 1.6.2 111
## Page 112

Data types 5 Data types 5.1 Tc Event Entry Defines an event by means of event class, event ID and severity. Syntax Definition: TYPE Tc Event Entry : STRUCT uuid Event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; END_STRUCT END_TYPE Parameter Name Type Description uuid Event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Event severity defines the severity of the event, 5.2 Tc Event Severity Defines the severity of the event. Syntax Definition: {attribute 'qualified_only'} TYPE Tc Event Severity : ( Verbose := 0, Info := 1, Warning := 2, Error := 3, Critical := 4); END_TYPE Parameter Name Description 4 Critical Critical 3 Error Error 2 Warning Warning 1 Info Information 0 Verbose Extended output 5.3 Tc Event Confirmation State Defines the confirmation state of an alarm. Syntax Definition: {attribute 'qualified_only'} TYPE Tc Event Confirmation State : ( Not Supported := 0, 112 Version: 1.6.2 TE1000
## Page 113

Data types Not Required := 1, Wait For Confirmation := 2, Confirmed := 3, Reset := 4); END_TYPE Parameter Name Description Confirmed Confirmed Not Required Confirmation not necessary in the current state. (Alarm not currently in the Raised state). Not Supported Was initialized without confirmation. Reset Initial state Wait For Confirmation Waiting for confirmation. TE1000 Version: 1.6.2 113
## Page 114

Global lists 6 Global lists 6.1 Global_Constants VAR_GLOBAL CONSTANT EMPTY_EVENT_CLASS : GUID := (Data1:=16#0, Data2:=16#0, Data3:=16#0, Data4:=[16#0,16#0,16#0,16#0, 16#0,16#0,16#0,16#0]); EMPTY_EVENT_ID : UDINT := 16#0; EMPTY_SEVERITY : Tc Event Severity := Tc Event Severity. Verbose; SUCCESS_EVENT : Tc Event Entry := ( uuid Event Class := EMPTY_EVENT_CLASS, n Event ID := EMPTY_EVE NT_ID, e Severity := EMPTY_SEVERITY ); END_VAR Name Type Initial value EMPTY_EVENT_CLASS GUID STRUCT(Data1:=16#0, Data2:=16#0, Data3:=16#0, Data4: =[16#0,16#0,16#0,16#0,16#0,16#0,16#0,16#0]) EMPTY_EVENT_ID UDINT 16#0 EMPTY_SEVERITY Tc Event Severity Tc Event Severity. Verbose [} 112] SUCCESS_EVENT Tc Event Entry STRUCT(uuid Event Class := EMPTY_EVENT_CLASS, n Ev ent ID := EMPTY_EVENT_ID, e Severity := EMPTY_SEVER [} 112] ITY) 6.2 GVL {attribute 'qualified_only'} VAR_GLOBAL n Lang Id_Online Monitoring : DINT := 1033; END_VAR Name Type Initial value Description n Lang Id_Online Monitoring DINT 1033 Language ID for the online monitoring English (en-US) = 1033 German (de-DE) = 1031 … 6.3 Parameter list {attribute 'qualified_only'} VAR_GLOBAL CONSTANT c Source Name Size : UDINT(81..10000) := 256; END_VAR Name Type Initial value Description c Source Name Size UDINT(81..10000) 256 Size in bytes for the name of the source information. A maximum of 512 bytes is recommended. 6.4 Global_Version All libraries have a certain version. This version can be seen in the PLC library repository among others. A global constant contains the library version information (of type ST_Lib Version): Global_Version VAR_GLOBAL CONSTANT st Lib Version_Tc3_Event Logger : ST_Lib Version; END_VAR To check whether the version you have is the version you need, use the function F_Cmp Lib Version (defined in the Tc2_System library). 114 Version: 1.6.2 TE1000
## Page 115

Examples 7 Examples 7.1 Tutorial This tutorial illustrates the work steps from an empty Twin CAT project to a dispatched message. It depicts the properties of the Twin CAT 3 Event Logger described in the Technical Introduction section in the work sequence. Creating an event class in the Twin CAT type system ü A standard Twin CAT PLC project exists. 1. Double-click on Type System in the SYSTEM subtree and select the Event Classes tab in the editor which then opens. Open the context menu and select the New command. ð The TMC editor opens. 2. Give the event class a name and enter a display text. TE1000 Version: 1.6.2 115
## Page 116

Examples 3. An event is already created below the event class. Give the event a name and enter a display text and the severity. 4. Save and, if applicable, close the event class. ð The source code is provided in the PLC and is accessible under the TC_EVENTS symbol. Adding the TC3_Event Logger library 5. Select the Add Library command in the context menu of the References object. ð The Add Library dialog opens. 6. Select the library and confirm the dialog. ð The library is added to the PLC project. Creating a PLC program 1. Open the MAIN program of the PLC project in the editor by double-clicking. 2. Declare and initialize the variables b Init and b Send and declare an instance of the function block FB_Tc Message: PROGRAM MAIN VAR b Init : BOOL := TRUE; b Send : BOOL := TRUE; 116 Version: 1.6.2 TE1000
## Page 117

Examples fb Msg : FB_Tc Message; END_VAR 3. Implement the send procedure as shown in the code. The message is initialized once by means of the Create Ex method. Since the initialization requires dynamic resources it should not take place cyclically. The initialized message is subsequently sent using the Send method. IF b Init THEN b Init := FALSE; fb Msg. Create Ex(TC_EVENTS. Tutorial Class. Tutorial Event, 0); END_IF IF b Send THEN b Send := FALSE; fb Msg. Send(0); END_IF 4. Create the PLC project and start the PLC. ð The result is shown in the Logged Events window in the Twin CAT 3 Engineering. 7.2 Example Result Message This sample shows the use of the Twin CAT 3 Event Logger with function blocks. Firstly, it demonstrates how an output on a function block can be utilized in order to use the event information as an extended return. On the other hand, it demonstrates how a parameterization can be carried out in order to output the messages via the Twin CAT 3 Event Logger only in certain cases. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Result Message Sample The example consists of two function blocks: • FB_Math Calculation: This function block offers two methods and two properties that always output messages at the output ip Result Message and additionally send them via the Event Logger if a trace level is exceeded. ◦ Method Addition(): Adds two numbers and sends a message in case of overflow ◦ Method Divison(): Divides two numbers after checking. Sends a message in case of division by 0. ◦ Property b Trace Level Default: Indicates whether the trace level is to be observed locally on the function block or whether to use a trace level library, which exists in the GVL in the sample. ◦ Property e Trace Level: The methods only send the message via the Event Logger if the severity is greater than or equal to this property. • FB_Control: This function block shows the use of the FB_Math Calculation function block within another function block. The Execute method of the FB_Control thereby uses the FB_Math Calculation. Divison() and handles the message further itself as error code. 7.3 Example Listener This sample illustrates the use of the Twin CAT 3 Event Logger in relation to messages and alarms. At the same time the reception of messages is shown in a second project. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Listener Sample Publisher project Single BOOL variables are used as triggers in the Publisher project: • b Send Message to send a message. TE1000 Version: 1.6.2 117
## Page 118

Examples • b Raise Alarm to set an alarm. • b Clear Alarm to cancel an alarm. • b Confirm Alarm to confirm an alarm. In addition there is an option to set the JSON attribute in order to send it with both messages. Listener project The Listener project contains a function block, FB_Listener, which extends the FB_Listener Base function block contained in the Tc3_Event Logger. The function block implements the functions for receiving the messages: • On Message Sent: when a message has been sent the Event Logger will call this method as a callback. The method counts the number of messages. • On Alarm Raised/On Alarm Cleared/On Alarm Confirmed: if the alarm changes its state the Event Logger will call this method as a callback. The methods count the number of state changes. • To initiate receiving of messages, an Execute method is implemented at the function block. • The text of the last received message can be retrieved. • The function block FB_Listener Test uses the FB_Listener. In doing so it registers the event class to be received once. Another event class that exists is not received to demonstrate the filter functionality. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 7.4 Example filter This sample illustrates the application of the Twin CAT 3 Event Logger for receiving messages. The focus is on the filter functions in order to process the right messages in a targeted manner. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Filter Sample The sample has four components: • A number of different messages are sent, demonstrating the selection of messages in different filters. • One component shows how to discard from the cache messages that are specified by a filter. • Another component illustrates the export of cached messages to a CSV file. Here, too, the filters are used to program which messages are to be selected. • Another component illustrates the general principle of receiving messages sent in real-time and receiving of Ether CAT emergency messages. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 118 Version: 1.6.2 TE1000
## Page 119

Trademark statements Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. Third-party trademark statements Arm, Arm9 and Cortex are trademarks or registered trademarks of Arm Limited (or its subsidiaries or affiliates) in the US and/or elsewhere.
## Page 120

More Information: www.beckhoff.com/te1000/ Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
