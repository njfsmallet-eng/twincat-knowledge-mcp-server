---
title: "TE1000 Twin CAT 3"
product: "TC3"
category: "HMI"
tags: ["CAT", "TWIN"]
language: "EN"
document_type: "Manual"
version: "1.11.3"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TC3_EventLogger_EN.pdf"
release_date: "2025-08-01"
---
Manual | EN TE1000 Twin CAT 3 | Event Logger 2025-08-01 | Version: 1.11.3

## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 7 1.1 Notes on the documentation............................................................................................................. 7 1.2 For your safety.................................................................................................................................. 7 1.3 Notes on information security............................................................................................................ 9 2 Overview.................................................................................................................................................. 10 3 System requirements.............................................................................................................................. 11 4 Limitations............................................................................................................................................... 12 5 Technical introduction............................................................................................................................ 13 5.1 Event class...................................................................................................................................... 16 5.2 Event............................................................................................................................................... 19 5.3 Managing events with Excel............................................................................................................ 21 5.4 Code generation of the event definition.......................................................................................... 23 5.5 Internationalization/translations....................................................................................................... 24 5.6 Target system................................................................................................................................. 26 5.7 Engineering..................................................................................................................................... 28 5.8 Arguments....................................................................................................................................... 29 5.9 Handling sources............................................................................................................................ 31 5.10 Internationalization of sources........................................................................................................ 32 5.11 JSON attributes............................................................................................................................... 33 5.12 Query filter....................................................................................................................................... 34 5.12.1 Return values................................................................................................................... 35 5.13 Remote access to the Event Logger via PLC.................................................................................. 35 5.14 Importing resource files................................................................................................................... 36 6 PLC API.................................................................................................................................................... 37 6.1 Functions and function blocks......................................................................................................... 37 6.1.1 Asynchronous text requests............................................................................................. 37 6.1.2 Event Entry conversion..................................................................................................... 62 6.1.3 Filter................................................................................................................................. 64 6.1.4 Remote Event Logger........................................................................................................ 70 6.1.5 FB_Listener Base2............................................................................................................ 83 6.1.6 FB_Tc Alarm..................................................................................................................... 88 6.1.7 FB_Tc Arguments............................................................................................................. 94 6.1.8 FB_Tc Event..................................................................................................................... 96 6.1.9 FB_Tc Event Base............................................................................................................. 98 6.1.10 FB_Tc Event Logger........................................................................................................ 104 6.1.11 FB_Tc Message.............................................................................................................. 115 6.1.12 FB_Tc Source Info........................................................................................................... 119 6.2 Interfaces...................................................................................................................................... 121 6.2.1 I_Tc Arguments............................................................................................................... 121 6.2.2 I_Tc Event Base............................................................................................................... 131 6.2.3 I_Tc Message.................................................................................................................. 136 6.2.4 I_Tc Source Info............................................................................................................... 137 6.3 Data types..................................................................................................................................... 137 TE1000 Version: 1.11.3 3

## Page 4

Table of contents 6.3.1 Tc Event Entry.................................................................................................................. 137 6.3.2 Tc Event Severity............................................................................................................. 138 6.3.3 Tc Event Confirmation State............................................................................................. 138 6.4 Global lists..................................................................................................................................... 139 6.4.1 Global_Constants........................................................................................................... 139 6.4.2 GVL................................................................................................................................ 139 6.4.3 Parameter list................................................................................................................. 139 6.4.4 Global_Version............................................................................................................... 140 7 C++ API.................................................................................................................................................. 141 7.1 Interfaces...................................................................................................................................... 141 7.1.1 ITc Event......................................................................................................................... 141 7.1.2 ITc Message.................................................................................................................... 144 7.1.3 ITc Alarm......................................................................................................................... 145 7.1.4 ITc Event Logger.............................................................................................................. 148 7.2 Data types..................................................................................................................................... 155 7.2.1 Tc Event Entry.................................................................................................................. 155 7.2.2 Tc Event Severity............................................................................................................. 156 7.2.3 Tc Event Confirmation State............................................................................................. 156 8 User mode API....................................................................................................................................... 157 8.1 Classes......................................................................................................................................... 157 8.1.1 Tc Event Logger............................................................................................................... 157 8.1.2 Tc Arguments.................................................................................................................. 162 8.1.3 Tc Source Info.................................................................................................................. 164 8.2 Interfaces...................................................................................................................................... 166 8.2.1 _ITc Event Logger Events................................................................................................. 166 8.2.2 ITc Alarm3....................................................................................................................... 167 8.2.3 ITc Argument Entry.......................................................................................................... 173 8.2.4 ITc Cause Remedy.......................................................................................................... 177 8.2.5 ITc Detail......................................................................................................................... 177 8.2.6 ITc Event......................................................................................................................... 178 8.2.7 ITc Event Logger2............................................................................................................ 182 8.2.8 ITc Logged Event4........................................................................................................... 184 8.2.9 ITc Message3.................................................................................................................. 190 8.3 Data types..................................................................................................................................... 195 8.3.1 Confirmation State Enum................................................................................................. 195 8.3.2 Event Type Enum............................................................................................................. 195 8.3.3 Severity Level Enum........................................................................................................ 196 8.3.4 Tc Event Argument Type Enum......................................................................................... 196 8.3.5 Tc Source Info Type Enum................................................................................................ 196 9 Example................................................................................................................................................. 198 9.1 PLC............................................................................................................................................... 198 9.1.1 Tutorial........................................................................................................................... 198 9.1.2 Example Result Message............................................................................................... 201 9.1.3 Example Listener........................................................................................................... 201 9.1.4 Example filter................................................................................................................. 202 4 Version: 1.11.3 TE1000

## Page 5

Table of contents 9.1.5 Sample Resource Import............................................................................................... 202 9.2 C++............................................................................................................................................... 203 9.2.1 Tutorial........................................................................................................................... 203 9.2.2 Example: Start-Stop....................................................................................................... 208 9.2.3 Example Listener........................................................................................................... 208 9.3 User mode API.............................................................................................................................. 209 10 Appendix................................................................................................................................................ 210 10.1 ADS Return Codes........................................................................................................................ 210 10.2 Support and Service...................................................................................................................... 214 TE1000 Version: 1.11.3 5

## Page 6

Table of contents 6 Version: 1.11.3 TE1000

## Page 7

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.11.3 7

## Page 8

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 8 Version: 1.11.3 TE1000

## Page 9

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.11.3 9

## Page 10

Overview 2 Overview The Twin CAT 3 Event Logger provides an interface for the exchange of messages between Twin CAT components and non-Twin CAT components. This documentation is aimed at the user of the Twin CAT 3 Event Logger. Information about how the Twin CAT 3 Event Logger is used by different Twin CAT 3 components can be found in the respective product documentations. Product components All the components of the Twin CAT 3 Event Logger are present in the respective basic installation. Various interfaces are included in the Twin CAT 3 Engineering for programming. The necessary modules and libraries are part of the corresponding runtime. Use of the Twin CAT 3 Event Logger is free of license fees. 10 Version: 1.11.3 TE1000

## Page 11

System requirements 3 System requirements Technical data Requirement Operating system Windows 10, Windows CE 7, Twin CAT/BSD Target platform PC architecture (x86, x64 and Arm®) Twin CAT version Twin CAT 3.1 Build 4022.20 or higher Required Twin CAT license Any runtime license (PLC, C++) Visual Studio version Parts of the Twin CAT 3 Event Logger are usable from Visual Studio 2013. TE1000 Version: 1.11.3 11

## Page 12

Limitations 4 Limitations • Events have a maximum size of 8 k B during transmission. When using the Twin CAT 3 Event Logger, make sure that this limit is observed. It refers to all elements that are transmitted and described in this documentation, including the dynamic elements (Attributes, Source Name, JSON Attributes). • The interface for receiving events in real-time stores a maximum of 1024 events temporarily until they have to be retrieved. If they are not retrieved in time, events are lost. • The Twin CAT 3 Event Logger offers a connection to the Twin CAT HMI (TF2xxx). The Twin CAT PLC HMI (TF18xx), conversely, cannot receive the events. 12 Version: 1.11.3 TE1000

## Page 13

Technical introduction 5 Technical introduction The Twin CAT 3 Event Logger transmits events. An event is a message or an alarm. This technical introduction focuses on the data that are transmitted as the contents of an event, because they are necessary for the understanding of the process. The transmission and reception of an event are explained in detail in the API descriptions for PLC and C++ as well as in the samples. Events An event itself is not used directly, but rather the derived types "messages" or "alarms". An event provides the following common elements of messages and alarms: Event Class (GUID) Event classes are a grouping of events (possibly for a topic). Event-ID (UDINT) The event is clearly identified within an event class by an Event-ID. Text (String) Description of the event. The description is intended for people and can therefore also be internationalized. Arguments can be inserted at runtime to make the text individually adaptable. Source Info Source of the occurrence of an event. Source consists of three elements. These can be used as desired, but there is a corresponding recommendation as to how they should be used. • Source-ID (INT): Tc COM object ID • Source-Name (STRING): Path within the Tc COM object, e.g. path to a function block in a PLC project • Source-GUID (GUID): Can be used, for example, to identify a project or a (sub-)product. JSON Attribute Can be used as desired. Whereas the "text" (see above) is intended for people as (STRING) recipients, the JSON attribute is intended for programmatic reception. A JSON string can easily be created (serialized) and processed (deserialized). Twin CAT offers the Json Xml library in real-time for this (see Documentation - PLC library Tc3_Json Xml). In addition to these elements, events possess further elements, which are described in the TMC Editor [} 19]. TE1000 Version: 1.11.3 13

## Page 14

Technical introduction Messages Messages are stateless. They are sent when called and the corresponding registered components are delivered. Identification Messages are identified by the Event Class and Event-ID. Alarm As opposed to a message, an alarm is not stateless. It has the following alarm states: • Not-Raised • Raised In addition, a confirmation can be demanded. Distinction is made between the following confirmation states: • Wait For Confirmation • Confirmed or Reset Calling the corresponding methods causes an event to be transmitted and sets the alarm to the respective state. • If a confirmation takes place via Confirm(), the state is set to Confirmed. • If a confirmation takes place via Clear(TRUE), the state is set to Reset. If the call of a method is invalid in the current state, this will be indicated by a return value. When shutting down Twin CAT (RUN → CONFIG transition), a dispose that sets a Clear time stamp is executed internally for all alarms in the Raised state. There is no confirmation for these alarms. Identification The Twin CAT 3 Event Logger identifies an alarm using the Event Class, Event-ID and Source Info. Thus an alarm (combination of Event Class and Event-ID) can be used at different points in a program. For example, an alarm "storage empty" can be used for different storages, since different "Source Info" is provided at runtime (see also Handling sources [} 31]). 14 Version: 1.11.3 TE1000

## Page 15

Technical introduction Architecture The Twin CAT 3 Event Logger transmits events centrally between other components. These components include the real-time programming interfaces PLC or C++ as the primary source of events. During the development the messages can be displayed in the Twin CAT Engineering (XAE). An HMI, for example, can receive messages and display them accordingly. The customer can create further components of his own for receiving events. The Twin CAT 3 Event Logger keeps a limited number of the last events in a cache. This can be queried from the Engineering, for example after a restart, in order to enable a diagnosis to be made. The cache is dependent on the secured shutdown of the computer. Cache not persistent under Windows CE Starting with Twin CAT 3.1 Build 4024.25 the cache of events is not persisted under Windows CE systems for performance reasons. Workflow The general workflow for establishing asynchronous communication between components is as follows: 1. Creation of a new Twin CAT project. 2. Definition of event classes and events in the Twin CAT type system. 3. Execution of the automatic code generation in order to provide the source code for the real-time programming language in Twin CAT. 4. Implementation of the use and thus the sending and receiving of events. See also: • Documentation Twin CAT 3 Type system • API descriptions - PLC [} 37] and C++ [} 141] • Examples [} 198] TE1000 Version: 1.11.3 15

## Page 16

Technical introduction 5.1 Event class Event classes are groups of events (possibly for a topic) and, in the sense of the Twin CAT type system, data types that can be used in different modules. For this reason they are created as data types in the Twin CAT type system (System > Type System > Event Classes). All known event classes are listed on the Event Classes tab in the Twin CAT type system. The TMC editor, in which the event classes can be defined and edited, can be opened via the context menu commands Edit and New. In addition to the project event classes, Twin CAT also provides further event classes such as ADS return codes and system events. Properties of event classes 16 Version: 1.11.3 TE1000

## Page 17

Technical introduction Name Description Name This name designates the event class, for example in the generated source code. Namespace Like all data types, event classes may also belong to a namespace. Display Text This text is used for the event class for the display. It can be internationalized (see Internationalization/translations [} 24]). Guid Like all data types it identifies the currently described event class. It is calculated automatically and changes in the event of changes within the event class. Optional properties By setting properties, the behavior of the event classes can be changed: • Name "plc Attribute_to_string" to Value "1" an attribute 'to_string' is created in the PLC. • "Hide Needless Arguments" on Value "1" suppresses the output of unnecessary arguments in the event texts. Event classes in PLC libraries If event classes are used in a PLC library, they should also be part of the library in order to ensure that the data types are contained in the Twin CAT type system of every application that uses the PLC library. To make this possible the event classes must be "pinned" in the PLC library. To do this, select in the PLC library object in the context menu Add the command Add Global Data Type ... (in Twin CAT 3.1 4024: External Types -> Pin Global Data Type). TE1000 Version: 1.11.3 17

## Page 18

Technical introduction Select the data type of the event class: Event classes in C++ projects Analogous to the other Twin CAT data types there is a possibility for C++ projects to define event classes locally in the C++ project. 18 Version: 1.11.3 TE1000

## Page 19

Technical introduction The event classes are declared for use in the corresponding C++ modules (irrespective of where they were defined). If an event class is added to a C++ module, it is automatically embedded in the TMC file of the module. 5.2 Event Events are described within the event class. TE1000 Version: 1.11.3 19

## Page 20

Technical introduction The events can be configured accordingly through the subelements. Properties of events 20 Version: 1.11.3 TE1000

## Page 21

Technical introduction Name This name designates the event, e.g. in the generated source code. ID Clearly identifies the event within the event class. Display Text This text is used for the event class for the display. It can be internationalized (see Internationalization/translations [} 24]). Severity Severity of the event. This is provided by the generated source code and thus represents the default behavior; however, a different value can also be used there: • Verbose • Info • Warning • Error • Critical 5.3 Managing events with Excel Twin CAT Package "Twin CAT. XAE. Eventlogger Excel Add In" is required Install the package "Twin CAT. XAE. Eventlogger Excel Add In" to use the functionality described here. In addition to the TMC Editor as part of the Twin CAT Solution, Twin CAT also offers the possibility to use Microsoft Excel to create event classes with events and their translations. These can then be exported from Excel and integrated in Twin CAT as "Shared TMC". Installation After installing the package, a corresponding setup is available at C: \Program Data\Beckhoff\Twin CAT\Eventlogger Excel Add In. The directory can also be transferred from here to other systems that do not have Twin CAT installed. The setup can be used if Microsoft Excel is installed and activated. To do this, simply run setup.exe to perform the integration in Excel. Use After a start of Excel a new main menu item is available in Excel: • Create New Sample creates both the base structure and the two sample event classes "Master" and "Machine" in the current Solution. • Import is used to import the resource information and transfer it into event classes. Cf. Importing resource files [} 36] • New Event Class creates a new event class as a new sheet. • Add missing Translation Keys creates corresponding keys in the Translations sheet based on all existing event classes. • Highlight unused Translation Keys marks the keys that are currently not used. • Generate Id (hash) from Name generates a hash value of the name as Event Id for an event class. Cf. Internationalization of sources [} 32] • Generate TMC File generates a TMC file based on the event classes. This can be used as a shared TMC in Twin CAT. TE1000 Version: 1.11.3 21

## Page 22

Technical introduction • Create PLC mapping function creates a Tc POU file as PLC Function. This represents a mapping to map the Source Id and Event Id used in resource files to the event classes. Cf. Importing resource files [} 36] Workflow and implementation At this point the workflow between Excel and Twin CAT is described: ü The setup.exe has been executed and the add-in is registered in Microsoft Excel. 1. Switch to the Tc Event Logger menu item and click on "Create New Sample". ð The sample event classes are created. 2. You can expand them or create translations in the "Translations" sheet. 3. Use "Add missing Translation Keys" and also "Highlight unused Translation Keys" for creating the entries. ð At "Generate TMC-File" a selection dialog appears, in which the event classes to be exported are selected: ð A dialog for selecting the save dialog is displayed. The TMC file is generated in the process. 4. Include the TMC file via the System -> Right Click -> Add Existing Item... type: 22 Version: 1.11.3 TE1000

## Page 23

Technical introduction ð The file is included as a reference in the Twin CAT Solution. The included event classes are ready: 5. If you overwrite the file, Twin CAT notices this and applies corresponding updates: ð The description of the event classes is made in Excel and automatically imported into Twin CAT via the export function. In this workflow, the Excel file is the "leading" file. It must be organizationally prevented that changes are made via the TMC editor in the Twin CAT Solution, since these cannot be restored. 5.4 Code generation of the event definition Source code is generated from the definition of event classes with events, both in the PLC and in C++. The "names" of the events and event classes are used in the code generation. An event class can thus be used across different versions of an event class through its name. The "severity" is provided by the code generation. The programmer thus has the possibility to set this individually when creating the events. The "severity" as described in the TMC editor [} 19] should thus be considered the default behavior. The "severity" can deviate from this in the specific application case. PLC A GVL TC_EVENTS is created in the PLC and contains the event classes as subelements and is updated following changes (saving/closing the TMC editor). These global constants in turn contain the events themselves as subelements together with the individual elements Event Id, Severity and the UUID of the event class to which they belong. A TC_EVENT_CLASSES GVL is also generated, which makes the GUIDs of the event classes directly accessible. These elements can be used for the parameters by means of Intelli Sense, e.g. with Create()/Create Ex(). TE1000 Version: 1.11.3 23

## Page 24

Technical introduction Logged-in PLC The code is not updated if a connection to a PLC exists (login). The update then takes place following a logout. Via "Online Change" the changes to an event class can be applied if the option "Update boot project" is selected. C++ Tc COM modules must use the event classes, i.e. they must be entered as used in the TMC editor. A code generation then creates a namespace, "Tc Events", as part of the <<Driver Name>Services.h- file. The namespace can be used by means of Intelli Sense for the parameters of the event classes/events, e.g. with Create Message()/Create Alarm(). Compatibility The C++ source code generation requires Visual Studio 2013 or newer. 5.5 Internationalization/translations The texts of the events ("Display Text") for display in HMIs, for example, can be internationalized. The "Translations" section in the TMC editor is provided for this. The section describes a table in whose rows the keys are assigned to the texts in different languages. Keys to be translated The keys are automatically determined from the texts ("Display Text") of the events and event classes. It is possible to describe individually whether the keys are to be adopted into the translation: Languages to be included Languages can be selected and added. If a language is requested at runtime for which no text is stored, the English text will be used. 24 Version: 1.11.3 TE1000

## Page 25

Technical introduction Translations The translations can be placed in the table below "Translations". Alternatively the languages can be edited separately on the respective sub-nodes. Additional functions Further functions are available for the internationalization: TE1000 Version: 1.11.3 25

## Page 26

Technical introduction The following functions are available: • Add a language: Adds a language, as described above. • Remove selected translations: Removes a key with the translations. • Import Translation Keys: Imports the key that is used from the event classes as described above. • Copy: Copies the translation. • Paste: Pastes a translation. • Show Types: Displays the use of the selected key. • Delete unused: Deletes the key that is not used in any Event Class from the table. • Import: Imports the translations from an XML or CSV file. • Export: Exports the translations to an XML or CSV file. The import and export functions relate to an XML/CSV format, which can be investigated by way of an example through an export. Translations outside of Twin CAT (XML) The translation information is stored in its own area of the configuration files, which can also be edited outside of the Twin CAT XAE. 5.6 Target system The Twin CAT 3 Event Logger can be configured on the target system by means of registry entries. The following keys are usable below HKEY_LOCAL_MACHINE\SOFTWARE\ [WOW6432Node\]Beckhoff\Twin CAT3: 26 Version: 1.11.3 TE1000

## Page 27

Technical introduction Timestamp \Event Logger\Timestamp Source DWORD 0 = Cur Pentium Time 2 = Cur System Time [default] The Cur Pentium Time provides a precise timestamp for each individual event. This is only required if time intervals are important within a task. The computing time may increase significantly dependent on the volume of tasks. \Event Logger\Timestamp Base DWORD 0 = System Time [default] 1 = External Time Hard 2 = External Time Medium 3 = External Time Soft For 1 to 3, please comply with the documentation Corrected timestamp. Maximum size of the message cache \Event Logger\Max Database Size DWORD 20 [default] in MB On reaching the limit, half of the messages will be discarded. Message cache location \Event Logger\Database Dir STRING :memory: = main memory (messages are deleted with the (From > Twin CAT 3.1 Build transition to CONFIG and also 4024.22) reboot etc.) <path> = file system folder for storing the Logged Events.db file If the key is not present, the database is placed in the boot folder. Under Windows CE this is used to store the database non- persistently. Save messages in the Windows Error Log \Event Logger\Windows Event Log\T DWORD 0 = None [default] ypes Supported | 0x1 = Messages | 0x2 = Alarms | 0x3 = both \Event Logger\Windows Event Log\L DWORD 1033 [default] og Locale Id 0 = current locale \Event Logger\Windows Event Log\M DWORD 0 = Verbose [default] in Log Level 1 = Info 2 = Warning 3 = Error Log Twin CAT system error See also https://infosys.beckhoff.com/content/1033/tceventlogger/12332566027.html HKEY_LOCAL_MACHINE\SOFTW DWORD 3 = acceptance of the system ARE\ errors in the Tc3 Event Logger [WOW6432Node\]Beckhoff\Twin C 4 = acceptance of the system AT3\System[Log Message Type] errors in the Tc3 Event Logger and the XAE error list. TE1000 Version: 1.11.3 27

## Page 28

Technical introduction • If the keys do not exist, they must be created with the specified type. • After changing the Reg Keys, the device must be rebooted to apply the changes. 5.7 Engineering Twin CAT Logged Events window The target system events can be loaded from the cache database mentioned above and displayed via the Logged Window. The window is opened in the Twin CAT 3 Engineering (XAE) via View > Other Windows > Twin CAT Logged Events. The toolbar in the window provides the following functions: Loads the events from the selected target system. Two modes can be activated via the drop-down menu: • Start/Stop Update: The events are updated continuously. • Read Logged Events: Events are read once. You can configure whether alarms or messages should be displayed via the Alarms or Messages button respectively. The "severity" from which the events should be displayed can be selected via the drop-down menu. Provides an export of the data in a CVS format, where the information that is currently displayed is exported. Deletes (after a prompt) the cache database on the target system. The language can be selected or entered via the drop-down menu. The columns in the window and the temporal resolution can be configured using the commands in the context menu: • The "Alarm State" column represents the current state of an alarm. • Different time representations for the timestamps can be selected via the "Time Precision" menu (ms, µs, 100ns). This only affects the display in engineering. On the target system, the timestamp used can be set, as described here [} 26]. 28 Version: 1.11.3 TE1000

## Page 29

Technical introduction • Entries can be selected via the filter function: Twin CAT options The Twin CAT engineering settings in the Twin CAT options (Tools > Options) provide basic settings for the Twin CAT 3 Event Logger for display in engineering. Max Logged Events Maximum number of messages displayed in the Twin CAT Logged Events window. Output as Task Item Display of the events in the Error List window. The output is synchronous as soon as the engineering is connected to a target system. However, the display is not designed for a large number of messages, so this option can also be used to turn off the output if necessary. Severity This option can be used to limit the output in the Error List . 5.8 Arguments The texts of the events can be individualized by programming with "arguments". A marking with the notation {n} is used for this during the description of the events in the TMC editor, where n is an ascending number starting from 0. Up to 128 arguments with a maximum size of 1024 bytes can be used at one event. TE1000 Version: 1.11.3 29

## Page 30

Technical introduction In the TMC editor, for example, such a Display Text is used for an event: This can then be used in the source code, as explained below. PLC Arguments can be handled in the PLC as follows: fb Msg : FB_Tc Message; IF NOT fb Msg. Equals To Event Entry Ex(st Other:=TC_EVENTS. Calculation Event Class. Division By Zero) THEN hr := fb Msg. Create Ex(TC_EVENTS. Calculation Event Class. Division By Zero, 0 (*fb Source*) ); END_IF fb Msg.ip Arguments. Clear(). Add LReal(f Dividend); //set Argument The arguments must thereby be defined after Create()/Create Ex(), but before Send(). Several arguments can be specified in concatenated form. fb Msg.ip Arguments. Clear(). Add LReal(f Dividend). Add LReal(f Divisor); In this case f Dividend is set in place of {0} and f Divisor in place of {1}. C++ Arguments can be handled in the C++ as follows: Tc Args tc Args(m_sp Message); tc Args->Clear(); tc Args. Add Argument(m_dividend); The arguments must thereby be defined after Create Message()/Create Alarm(), but before Send(). For this, Tc Event Logger Template.h must be included in <Project Name>Interfaces.h. #include"Tc Router Interfaces.h" #include"Tc Event Logger Templates.h" ///<Auto Generated Content id="Interfaces"> ///</Auto Generated Content> Output The output is accordingly: This notation can also be used as text within the translations. 30 Version: 1.11.3 TE1000

## Page 31

Technical introduction If more arguments are sent than provided by corresponding placeholders, they are appended to the event text in parentheses. This behavior can be suppressed by setting the "Hide Needless Arguments" option for the event class, as described here [} 16]. Formatting The output of the arguments can also be formatted. To do this the syntax {n,<Format>} is used accordingly in the TMC editor: The following formats are available: Type Format Description Numerical value d / D Decimal representation e / E Exponential representation x / X Hexadecimal representation f / F Fixed point Note that, for example, a REAL cannot be represented as "d" or "x" etc. Additional notes regarding arguments in message texts • In addition, the syntax {event ID} (for the Event ID) and {eventclass} (for the Guid of the event class) are available to output the corresponding information as part of the text. • If strings are used as arguments Add String(), they are inserted as arguments in the message text. This string cannot be translated by the Twin CAT 3 Event Logger. If an argument is to be translated, . Add Event Reference Ex() can be used for this purpose. Here, the message text is inserted in the corresponding translation. The Example Listener [} 201] shows the usage. 5.9 Handling sources The same events can occur at different points in a program. The source of an event is described in the programming by the "Source Info" and sent as well when transmitting. The Source Info consists of three parts (see Events [} 13]). The source is also specified when creating the event in both programming languages. PLC The FB_Tc Source Info is used for this in the PLC. This is parameterized accordingly before Create()/Create Ex() is called: TE1000 Version: 1.11.3 31

## Page 32

Technical introduction Alternatively a zero can be assigned to the corresponding parameter on calling Create()/Create Ex() in order to use the internal standard source information of the PLC. If no explicit Source Info is then specified, the symbol path is output where the event is instanced as Source Name and the object ID of the PLC instance as Source ID. C++ Tc Source Info is used in C++ and can be transferred, for example, in the following way with Create Message()/Create Alarm(): Output This Source Info can be shown accordingly in the Logged Events window: 5.10 Internationalization of sources Twin CAT 3.1 Build 4026 required The functionality described here requires version Twin CAT 3.1 4026.0. The Source Info of an event should describe the location to which an event belongs. The Source Name can be used to describe a source for a person. This means that the Source Name should also be translated in some cases. Follow the steps below to internationalize the Source Name: 1. Create an event class that is used to carry the translation information. The name is arbitrary, for example "Translation Event Class". 2. Create an event in the event class for each Source Name to be translated and write the Source Name to be translated as display text in this event. 3. Create a translation table for these events with the different languages. 32 Version: 1.11.3 TE1000

## Page 33

Technical introduction 4. To access the translations, you must set the created event class as Source Guid at the respective event. This provides the reference so that the texts can be transferred to the target system and used for translation. 5. Activate the Solution. ð The translations are available on the target system. The translations can be accessed in different ways: • Twin CAT/HMI: Provides the translated Source Name in the Grid Control event. • The Logged Events window from Engineering automatically displays the translation when a language is selected. • PLC: The translation for a Source Name can be queried via the function block FB_Request Translation [} 52]. 5.11 JSON attributes As described in the introductory part of the Technical introduction [} 13] section, there is a possibility to transmit an additional JSON attribute with a message. The Json Xml library (PLC library Tc3_Json Xml) can be used to generate the JSON when creating and when receiving. PLC The JSON attribute can be specified before the Send() but after the Create()/Create Ex(). C++ The JSON attribute can be specified before the Send() but after the Create Message()/Create Alarm(). TE1000 Version: 1.11.3 33

## Page 34

Technical introduction Output The Logged Events window provides two visualizations for the JSON attributes, which can be selected via the drop-down menu inside the information column and opened by clicking on the magnifying glass: Text Visualizer JSON Visualizer 5.12 Query filter From Twin CAT 3.1 Build 4024.17 The filters described here are available from version Twin CAT 3.1 Build 4024.17. When processing messages such as receiving, the question arises as to which messages are to be considered at the corresponding point. An API is provided to formulate the desired messages. For all incoming messages, the API describes which ones are relevant, resulting in a filter. This API is available for use in various places: • Receiving messages in real-time via the Listener interface. • Receiving messages which occur based on Ether CAT emergency messages of the I/O system. • Deleting messages from the cache. • Exporting messages to a file ("CSV Export“). The actual use of the filters is shown in the samples Example filter [} 202] and Example Listener [} 201]. The function block FB_Tc Event Filter [} 67] is the entry point in terms of use. 34 Version: 1.11.3 TE1000

## Page 35

Technical introduction 5.12.1 Return values When processing the filters, the correctness is checked in the respective application. Any errors are indicated by corresponding return values. These are documented here: ADS_E_NOTINIT 0x981170 ADS connection not initialized 18 E_POINTER 0x800040 Invalid pointer 03L E_NOTIMPL 0x800040 Function is not implemented. 01L E_OUTOFMEMORY 0x800700 Insufficient memory 0EL ADS_E_INVALIDPARM 0x981170 Validation error 0B ADS_E_NOMEMORY 0x981170 Insufficient memory 0A ADS_E_INVALIDSTATE 0x981170 The system is in a state in which it cannot process the filters. 12 For example, Export Logged Events is not in OP state. ADS_E_INVALIDDATA 0x981170 Add Json Attribute Expression path is invalid. 06 5.13 Remote access to the Event Logger via PLC The Event Logger of one system can be accessed from another remote system. This offers the interface described under "Usermode API". Here, users create their own (user mode) programs that communicate with the Event Logger of another system via an ADS route (and thus possibly also via network). Available with Twin CAT 3.1 4026 The following functionality is available from Twin CAT 3.1 Build 4026. The PLC additionally offers the possibility of access via network by means of the function blocks in the folder "Remote Eventlogger" of the PLC library. The available functions are described here. Establishing the connection First, a connection to the remote system is established: VAR s Net Id Target : T_Ams Net ID; //the Ams Net Id of the remote system fb Remote Logger : FB_Tc Remote Event Logger; END_VAR hr := fb Remote Logger. Connect(s Net Id:=s Net Id Target); This can be done cyclically, which initiates the rebuild if the connection is lost. The connection can be terminated again: VAR fb Remote Logger : FB_Tc Remote Event Logger; END_VAR hr := fb Remote Logger. Disconnect(); The state can be monitored: hr := fb Remote LOgger.hr Connect; To receive messages from a remote system, a function block must be implemented that extends FB_Remote Listener Base : TE1000 Version: 1.11.3 35

## Page 36

Technical introduction FUNCTION_BLOCK FB_Remote Listener EXTENDS FB_Remote Listener Base In addition to the callback methods On Message Sent etc. known from FB_Listener Base2, this function block receives the following methods that are specifically responsible for remote functionality: • On Event Logger Error(): Called when the remote Event Logger returns an error code as HRESULT. • On Connection State Changed(): This method is called when the connection state changes. It provides the respective change as an enum Tc Remote Connection Change Reason. With the help of such a function block, the messages can be received by subscribing: hr := fb Listener. Subscribe(fb Remote Logger, 0); Accordingly, there is also a possibility to unsubscribe: hr Unsubscribe:= fb Listener. Unsubscribe(); The function block FB_Tc Remote Event Logger otherwise provides equivalent functions to the local variant FB_Tc Event Logger. Monitor the connection state during use. 5.14 Importing resource files Resource files (extension ECPX) are typically located in the directory 3.1\Target\Resource. The Twin CAT 2 Event Logger has created these files via a configuration program. The files can be used in the new Event Logger via the following workflow: ü The Excel Add-in [} 21] has been installed. 1. Select a resource file in Excel via the menu entry Tc Event Logger > Import. ð One event class is created per Source Id. ð When importing, some mappings are made. 2. Check their content in the application and take them into account. The mappings are described below. 3. Generate a TMC file via Generate TMC-File. ð The TMC file is integrated in the Twin CAT Solution as described here [} 21]. 4. Additionally you can create a Tc POU file via Create PLC mapping function, which provides a mapping from Source Id/Event Id to the corresponding new event. ð The further development can be done in the following in Excel or after one-time import also in the TMC editor (but then no longer in Excel) The following mappings are made during the import: • All events about resources have a state b Set Event and are therefore provided as alarms. • Source Id is used as event class and the Event Id as event ID and corresponding event classes are created. • The information Req Must Con is imported and handled as an acknowledgement using clear. • The information n Class is mapped to the e Severity of the Twin CAT 3 Event Logger: New Event Logger e Severity Old Event Logger n Class 0 Verbose 0 None 0 Verbose 1 Maintenance 0 Verbose 2 Message 0 Verbose 3 Hint 1 Info 4 Stateinfo 1 Info 5 Instruction 2 Warning 6 Warning 3 Error 7 Alarm 4 Critical 8 Parameter Error The sample Resource Import [} 202] provides the necessary implementations as an example. 36 Version: 1.11.3 TE1000

## Page 37

PLC API 6 PLC API 6.1 Functions and function blocks 6.1.1 Asynchronous text requests 6.1.1.1 FB_Async Str Result This function block enables the asynchronous request for a text. Methods Name Description Get String [} 37] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.1.1.1 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes TE1000 Version: 1.11.3 37

## Page 38

PLC API Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 6.1.1.2 FB_Request Cause Remedy This function block enables the asynchronous request of cause/remedy in the desired language for an event. Methods Name Description Clear [} 38] This method clears the last result queried. Get [} 39] As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Request [} 39] Calling this method triggers the asynchronous request. Request Remote Calling this method triggers the asynchronous request on a remote target system. [} 40] Properties Name Type Access Description b Busy BOOL GET TRUE as long as the processing is not yet completed. b Error BOOL GET TRUE when an error occurs. hr Error Code HRESULT GET Outputs the error information if b Error is TRUE. n Count UDINT GET Number of causes/remedy elements found Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 6.1.1.2.1 Clear This method clears the last result queried. Syntax METHOD Clear 38 Version: 1.11.3 TE1000

## Page 39

PLC API 6.1.1.2.2 Get As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Syntax METHOD Get : HRESULT VAR_INPUT n Index : UDINT; fb Cause Remedy : REFERENCE TO FB_Tc Cause Remedy; END_VAR Inputs Name Type Description n Index UDINT Index in the list of cause/remedy elements to be queried. fb Cause Remedy Reference to Reference to a FB_Tc Cause Remedy in which the texts FB_Tc Cause Remedy [} 55] are stored. Outputs Name Type Description Get HRESULT S_OK on success ADS_E_INVALIDSTATE if the query is still running. ADS_E_INVALIDSIZE if an index is queried that is not assigned. 6.1.1.2.3 Request Calling this method triggers the asynchronous request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR TE1000 Version: 1.11.3 39

## Page 40

PLC API Inputs Name Type Description event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 … The Tc Lcid enum can be used. Outputs Name Type Description Request HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.2.4 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. 40 Version: 1.11.3 TE1000

## Page 41

PLC API Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.3 FB_Request Event Class Details This function block can be used to query the details of an event class in the form of FB_Tc Detail [} 58]. Each "detail" (Description Text, Description Url, Comment) – see when creating the event) has an index and the key ((Description Text, Description Url, Comment) and the value are supplied for each index. Methods Name Description Clear [} 41] This method clears the last result queried. Get [} 42] As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Request [} 42] Calling this method triggers the asynchronous request. Request Remote Calling this method triggers the asynchronous request on a remote target system. [} 43] Properties Name Type Access Description b Busy BOOL GET TRUE as long as the processing is not yet completed. b Error BOOL GET TRUE when an error occurs. hr Error Code HRESULT GET Outputs the error information if b Error is TRUE. n Count UDINT GET Number of causes/remedy elements found Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 6.1.1.3.1 Clear This method clears the last result queried. TE1000 Version: 1.11.3 41

## Page 42

PLC API Syntax METHOD Clear 6.1.1.3.2 Get As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Syntax METHOD Get : HRESULT VAR_INPUT n Index : UDINT; fb Detail : REFERENCE TO FB_Tc Detail; END_VAR Inputs Name Type Description n Index UDINT Index in the list of cause/remedy elements to be queried. fb Detail Reference to FB_Tc Detail Reference to an FB_Tc Detail in which the details are stored. [} 58] Outputs Name Type Description Get HRESULT Returns S_OK if successful. ADS_E_INVALIDSTATE if the query is still running. ADS_E_INVALIDSIZE if an index is queried that is not assigned. 6.1.1.3.3 Request Calling this method triggers the asynchronous request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR 42 Version: 1.11.3 TE1000

## Page 43

PLC API Inputs Name Type Description event Class GUID Specifies the event class. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 … The Tc Lcid enum can be used. Outputs Name Type Description Request HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.3.4 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. TE1000 Version: 1.11.3 43

## Page 44

PLC API Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.4 FB_Request Event Class Name This function block enables the asynchronous request for the name of an event class. Methods Name Description Clear [} 44] This method clears the last result queried. Get String [} 45] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Request [} 45] Calling this method triggers the asynchronous text request. Request Remote [} 46] Calling this method triggers the asynchronous request on a remote target system. Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.1.4.1 Clear This method clears the last result queried. Syntax METHOD Clear 44 Version: 1.11.3 TE1000

## Page 45

PLC API 6.1.1.4.2 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 6.1.1.4.3 Request Calling this method triggers the asynchronous text request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Lang Id : DINT; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 TE1000 Version: 1.11.3 45

## Page 46

PLC API Return value Name Type Description Request HRESULT Returns possible error information. 6.1.1.4.4 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.5 FB_Request Event Details This function block can be used to query the details of an event in the form of FB_Tc Detail [} 58]. 46 Version: 1.11.3 TE1000

## Page 47

PLC API Methods Name Description Clear [} 47] This method clears the last result queried. Get [} 47] As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Request [} 48] Calling this method triggers the asynchronous request. Request Remote Calling this method triggers the asynchronous request on a remote target system. [} 48] Properties Name Type Access Description b Busy BOOL GET TRUE as long as the processing is not yet completed. b Error BOOL GET TRUE when an error occurs. hr Error Code HRESULT GET Outputs the error information if b Error is TRUE. n Count UDINT GET Number of causes/remedy elements found Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 6.1.1.5.1 Clear This method clears the last result queried. Syntax METHOD Clear 6.1.1.5.2 Get As soon as b Busy is FALSE and if no error has occurred (b Error = FALSE), this method can be used to get a result from the queried list. Syntax METHOD Get : HRESULT VAR_INPUT n Index : UDINT; fb Detail : REFERENCE TO FB_Tc Detail; END_VAR Inputs Name Type Description n Index UDINT Index in the list of causes/remedy elements to be queried. fb Detail Reference to FB_Tc Detail Reference to an FB_Tc Detail in which the details are stored. [} 58] TE1000 Version: 1.11.3 47

## Page 48

PLC API Outputs Name Type Description Get HRESULT S_OK on success ADS_E_INVALIDSTATE if the query is still running. ADS_E_INVALIDSIZE if an index is queried that is not assigned. 6.1.1.5.3 Request Calling this method triggers the asynchronous request. Syntax METHOD Request : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 … The Tc Lcid enum can be used. Outputs Name Type Description Request HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.5.4 Request Remote 48 Version: 1.11.3 TE1000

## Page 49

PLC API Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; // English(US)=1033 ; German(Germay)=1031 END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Event Id UDINT ID of the event n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. Outputs Name Type Description Request Remote HRESULT Returns possible error information. S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.6 FB_Request Event Text This function block enables the asynchronous request for an event text in the desired language. Methods Name Description Clear [} 52] This method clears the last result queried. Get String [} 50] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Request [} 50] Calling this method triggers the asynchronous text request. Request Remote [} 51] Calling this method triggers the asynchronous request on a remote target system. TE1000 Version: 1.11.3 49

## Page 50

PLC API Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.1.6.1 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF 6.1.1.6.2 Request 50 Version: 1.11.3 TE1000

## Page 51

PLC API Calling this method triggers the asynchronous text request. Syntax METHOD Request : BOOL VAR_INPUT event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR Inputs Name Type Description event Class GUID Specifies the event class. n Event Id UDINT ID of the event. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments [} 121] Optional specification of arguments. Return value Name Type Description Request HRESULT Returns possible error information. 6.1.1.6.3 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; event Class : GUID; n Event Id : UDINT; n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR TE1000 Version: 1.11.3 51

## Page 52

PLC API Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class. n Event Id UDINT ID of the event. n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments Optional specification of arguments. Return value Name Type Description Request Re HRESULT mote Also see about this 2 I_Tc Arguments [} 121] 6.1.1.6.4 Clear This method clears the last result queried. Syntax METHOD Clear 6.1.1.7 FB_Request Translation This function block provides a translation for a text in a desired language. The translations are referenced by an event class, which is specified in the query. It is therefore not used here as an event class, but as a translation table. Methods Name Description Clear [} 55] This method clears the last result queried. Get String [} 53] As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Request [} 54] Calling this method triggers the asynchronous text request. Request Remote [} 54] Calling this method triggers the asynchronous request on a remote target system. 52 Version: 1.11.3 TE1000

## Page 53

PLC API Properties Name Type Access Description b Busy BOOL Get TRUE as long as the processing is not yet completed. b Error BOOL Get TRUE when an error occurs. hr Error Code HRESULT Get Outputs the error information if b Error is TRUE. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) Also see about this 2 Internationalization of sources [} 32] 6.1.1.7.1 Get String As soon as b Busy is FALSE and provided no error has occurred (b Error = FALSE), the requested text can be fetched with this method. Syntax METHOD Get String : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Buffer variable for the requested text n Result UDINT Buffer size in bytes Return value Name Type Description Get String BOOL Returns TRUE if the text could be assigned. Returns FALSE if the text could not be completely assigned because the specified buffer variable is too small. Example The method may only be called if b Busy = FALSE and b Error = FALSE signal that text is available. IF NOT fb.b Busy AND NOT fb.b Error THEN b Get String Success := fb. Get String(s Text, SIZEOF(s Text)); END_IF TE1000 Version: 1.11.3 53

## Page 54

PLC API 6.1.1.7.2 Request Calling this method triggers the asynchronous text request. Syntax METHOD Request : BOOL VAR_INPUT event Class : GUID; END_VAR VAR_IN_OUT CONSTANT text : STRING; END_VAR VAR_INPUT n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR Inputs Name Type Description event Class GUID Specifies the event class to be used as the basis for the query. text STRING The text to be translated n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments [} 121] Optional specification of arguments. Return value Name Type Description Request HRESULT Returns possible error information. 6.1.1.7.3 Request Remote Calling this method triggers the asynchronous request on a remote target system. Syntax METHOD Request Remote : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger event Class : GUID; END_VAR VAR_IN_OUT CONSTANT text : STRING; END_VAR VAR_INPUT 54 Version: 1.11.3 TE1000

## Page 55

PLC API n Lang Id : DINT; ip Args : I_Tc Arguments; END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Instance of I_Tc Remote Event Logger, which describes the target system. event Class GUID Specifies the event class to be used as the basis for the query. text STRING The text to be translated n Lang Id DINT Specifies the language ID: English (en-US) = 1033 German (de-DE) = 1031 ... The Tc Lcid enum can be used. ip Args I_Tc Arguments [} 121] Optional specification of arguments. Return value Name Type Description Request Re HRESULT Returns possible error information. mote S_OK if the query is successful. ADS_E_INVALIDSTATE if the target system is in an invalid state. ADS_E_NOMEMORY if no memory is available to store the result. ADS_E_PENDING if the query is still pending. 6.1.1.7.4 Clear This method clears the last result queried. Syntax METHOD Clear 6.1.1.8 FB_Tc Cause Remedy This function block is used to display the cause/remedy for an alarm. This function block is used via FB_Request Cause Remedy [} 38]. TE1000 Version: 1.11.3 55

## Page 56

PLC API Methods Name Description Get Cause [} 56] Returns the cause. Get Id [} 56] Returns the index of the cause/remedy. Get Remedy [} 57] Returns the remedy. Release [} 57] Clears the internal memory of the function block. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 6.1.1.8.1 Get Cause This method returns the cause. Syntax METHOD Get Cause : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Cause BOOL Returns the success whether a cause was provided. 6.1.1.8.2 Get Id This method returns the index of the cause/remedy. Syntax METHOD Get Id : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR 56 Version: 1.11.3 TE1000

## Page 57

PLC API Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Id BOOL Returns the success whether an ID was provided. 6.1.1.8.3 Get Remedy This method returns the remedy. Syntax METHOD Get Remedy : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Remedy BOOL Returns the success of whether a remedy has been provided. 6.1.1.8.4 Release This method clears the internal memory of the function block. Syntax METHOD Release : HRESULT Outputs Name Type Description Release HRESULT Returns whether the memory has been cleaned. TE1000 Version: 1.11.3 57

## Page 58

PLC API 6.1.1.9 FB_Tc Detail This function block is used to display the details of an event. This function block is used via FB_Request Event Class Details [} 41] or FB_Request Event Details [} 46]. Methods Name Description Get Comment Returns the comment. [} 58] Get Name [} 59] Returns the name. Get Text [} 59] Returns the text. Release [} 58] Clears the internal memory of the function block Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 6.1.1.9.1 Release This method clears the internal memory of the function block. Syntax METHOD Release : HRESULT Outputs Name Type Description Release HRESULT Returns whether the memory has been cleaned. 6.1.1.9.2 Get Comment This method returns the comment. Syntax METHOD Get Comment : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR 58 Version: 1.11.3 TE1000

## Page 59

PLC API Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Commend BOOL Returns the success whether a comment was provided. 6.1.1.9.3 Get Name This method returns the name. Syntax METHOD Get Name : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Name BOOL Returns the success whether a name was provided. 6.1.1.9.4 Get Text This method returns the text. Syntax METHOD Get Text : BOOL VAR_INPUT s Result : REFERENCE TO STRING; n Result : UDINT; // buffer size in bytes END_VAR TE1000 Version: 1.11.3 59

## Page 60

PLC API Inputs Name Type Description s Result REFERENCE TO STRING Reference to a string in which the result is to be stored. n Result UDINT Length of the s Result Outputs Name Type Description Get Text BOOL Returns the success whether a text was provided. 6.1.1.10 F_Get Event Class Name The function triggers the asynchronous request for the name of an event class. Syntax Definition: FUNCTION F_Get Event Class Name : HRESULT VAR_INPUT n Lang Id : DINT; fb Event Base : REFERENCE TO FB_Tc Event Base; END_VAR VAR_IN_OUT fb Result : FB_Async Str Result; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … fb Event Base REFERENCE TO Specification of an event/alarm/message object. FB_Tc Event Base [} 98] / Inputs/outputs Name Type Description fb Result FB_Async Str Result [} 37] Specification of a function block instance in order to track an asynchronous text request. Return value Name Type Description F_Get Event Class Name HRESULT Returns possible error information. 60 Version: 1.11.3 TE1000

## Page 61

PLC API Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.1.11 F_Get Event Text The function triggers the asynchronous request for an event text. Syntax Definition: FUNCTION F_Get Event Text : HRESULT VAR_INPUT n Lang Id : DINT; fb Event Base : REFERENCE TO FB_Tc Event Base; END_VAR VAR_IN_OUT fb Result : FB_Async Str Result; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … fb Event Base REFERENCE TO Specification of an event/alarm/message object. FB_Tc Event Base [} 98] / Inputs/outputs Name Type Description fb Result FB_Async Str Result [} 37] Specification of a function block instance in order to track an asynchronous text request. Return value Name Type Description F_Get Event Text HRESULT Returns possible error information. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger TE1000 Version: 1.11.3 61

## Page 62

PLC API 6.1.2 Event Entry conversion 6.1.2.1 Ads Err_TO_Tc Event Entry This function converts a standard ADS error into a Tc Event Entry. Syntax Definition: FUNCTION Ads Err_TO_Tc Event Entry : BOOL VAR_INPUT e Error Id : E_Ads Err; st Event Entry : REFERENCE TO Tc Event Entry; END_VAR Inputs Name Type Description e Error Id E_Ads Err Error code to be converted. st Event Entry REFERENCE TO Tc Event Entry [} 137] Outputs the resulting event definition. Return value Name Type Description Ads Err_TO_Tc Event Entry BOOL Returns TRUE if the conversion was carried out successfully. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.2.2 HRESULTAds Err_TO_Tc Event Entry This function converts a standard ADS error (HRESULT) into a Tc Event Entry. Syntax Definition: FUNCTION HRESULTAds Err_TO_Tc Event Entry : BOOL VAR_INPUT hr : E_HRESULTAds Err; st Event Entry : REFERENCE TO Tc Event Entry; END_VAR 62 Version: 1.11.3 TE1000

## Page 63

PLC API Inputs Name Type Description hr E_HRESULTAds Err Error code to be converted. st Event Entry REFERENCE TO Tc Event Entry Outputs the resulting event definition. [} 137] Return value Name Type Description HRESULTAds Err_TO_Tc Event Entry BOOL Returns TRUE if the conversion was carried out successfully. The call fails if the facility code in the specified HRESULT is unknown. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.2.3 Tc Event Entry_TO_Ads Err This function converts a Tc Event Entry into a standard ADS error. Syntax Definition: FUNCTION Tc Event Entry_TO_Ads Err : BOOL VAR_INPUT st Event Entry : Tc Event Entry; e Error Id : REFERENCE TO E_Ads Err; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 137] Event definition to be converted. e Error Id REFERENCE TO E_Ads Err Outputs the resulting error code. Return value Name Type Description Tc Event Entry_TO_Ads Err BOOL Returns TRUE if the conversion was carried out successfully and FALSE if the event class is unknown. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger TE1000 Version: 1.11.3 63

## Page 64

PLC API 6.1.2.4 Tc Event Entry_TO_HRESULTAds Err This function converts a Tc Event Entry into a standard ADS error (HRESULT). Syntax Definition: FUNCTION Tc Event Entry_TO_HRESULTAds Err : BOOL VAR_INPUT st Event Entry : Tc Event Entry; hr : REFERENCE TO E_HRESULTAds Err; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 137] Event definition to be converted. hr REFERENCE TO Outputs the resulting error code. E_HRESULTAds Err Return value Name Type Description Tc Event Entry_TO_HRESULTAds Err BOOL Returns TRUE if the conversion was carried out successfully and FALSE if the event class is unknown. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.3 Filter The filter functionality is used in different places. A sample that describes the possible uses is covered in the Example filter [} 202]. 6.1.3.1 FB_Tc Clear Logged Events Settings This function block provides the functionality to specify which events are to be removed from the cache. Syntax Definition: FUNCTION_BLOCK FB_Tc Clear Logged Events Settings IMPLEMENTS I_Tc Clear Logged Events Settings 64 Version: 1.11.3 TE1000

## Page 65

PLC API Methods Name Definition location Description Add Filter [} 65] Local Method for adding a filter. Delivers if successful S_OK. Clear [} 65] Local Method for clearing the settings. Delivers if successful S_OK. Set Limit [} 66] Local Indicates the number of events to be cleared. The limit is applied after sorting and filtering. Delivers if successful S_OK. Set Sorting [} 66] Local Sets the sort order for the query. Delivers if successful S_OK. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 6.1.3.1.1 Add Filter Method for adding a filter. Inputs Name Type Description ip Event Filter I_Tc Event Filter Instance of the filter to be used Return values Name Type Description Add Filter HRESULT Returns S_OK if successful. 6.1.3.1.2 Clear Method for clearing the settings. Return values Name Type Description Clear HRESULT Returns S_OK if successful. TE1000 Version: 1.11.3 65

## Page 66

PLC API 6.1.3.1.3 Set Limit Indicates the number of events to be cleared. The limit is applied after sorting and filtering. Inputs Name Type Description e Type Tc Event Limit Type Determines the reference whether the limit applies to the first or last events. n Limit DINT Specifies the number (-1 = no limit) n Offset DINT Optional. Defines how many entries are to be skipped. Return values Name Type Description Set Limit HRESULT Returns S_OK if successful. 6.1.3.1.4 Set Sorting Sets the sort order for the query. Inputs Name Type Description e Field Tc Event Field Property to be used for sorting. e Order Tc Event Sort Order Defines the sort order. Return values Name Type Description Set Sorting HRESULT Returns S_OK if successful. 6.1.3.2 FB_Tc Event Csv Export Settings Provides the functionality to specify the csv export. Syntax Definition: 66 Version: 1.11.3 TE1000

## Page 67

PLC API FUNCTION_BLOCK FB_Tc Event Csv Export Settings EXTENDS FB_Tc Event Export Settings IMPLEMENTS I_Tc Event Csv Export Settings Methods Name Type Description b With Header BOOL Determines whether a header should be created. Standard: True n Lang Id DINT Determines the default identifier of the export language. Standard: 1033 s Delimiter STRING Defines the CSV delimiter. Standard: Semicolon [;] Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 6.1.3.3 FB_Tc Event Filter Provides the functionality to specify an event filter. The filters are provided via a floating interface following a structured query language. It describes which messages should apply. • Conditions can be linked via . AND_OP() and . OR_OP(). • Conditions can be negated by . NOT_OP(). • Conditions can be defined by properties such as .is Alarm() or . Event Class. Equals To(<Event Class>), for example. A complete list of properties can be found in the API documentation. • A grouping can be formulated via . Filter Expression(<Sub Condition>). The <Sub Codition> is itself another FB_Tc Event Filter or ITc Event Filter. A filter is applied once it has been compiled. To receive messages, for example, it is assigned to a recipient via FB_Listener Base2.subscribe(). In this way FB_Listener Base2 takes over the filter and provides a corresponding return value, which is described here. The filter can be amended by repeating FB_Listener Base2.subscribe(). A maximum of 255 filter conditions can be set - after which an ADS_NOMOREHDL is returned as an error message. Sample A filter can be assembled in the following way, for example: fb Filter. Severity. Greater Than (Tc EVent Severity. Error). AND_OP(). Source. Name. Like('%Main%'); The Example filter [} 202] shows the usage. Ether CAT filter The mechanism for receiving Ether CAT emergency messages is similar to that described above. The entry point in the chained method calls is . Ether CATDevice(), which first provides a direct request to ascertain if it was sent from an Ether CAT device (Is Ether CATDevice()). From here you can filter based on the vendor (. Vendor Id()), the product code (. Product Code()) or the revision (Revision No()) ). TE1000 Version: 1.11.3 67

## Page 68

PLC API Syntax Definition: FUNCTION_BLOCK FB_Tc Event Filter IMPLEMENTS I_Tc Event Filter, I_Tc Expression Base Methods Name Definition location Description Clear [} 68] I_Tc Event Filter Clears the previous filter expression. Filter Expression [} 69] I_Tc Expression Base Specification of a subordinate filter definition. Is Alarm [} 69] I_Tc Expression Base Checking whether it is an alarm. Is Message [} 69] I_Tc Expression Base Checking whether it is a message. NOT_OP [} 69] I_Tc Expression Base Negation of the subsequent statement. Properties Name Type Access Description Alarm State I_Tc Alarm Filter Express Get Checking with an Alarm State ion Ether CATDevice I_Tc Ether CATDevice E Get Checking whether the source is an xpression Ether CAT device. Event Class I_Tc Guid Compare Get Checking with an Event Class Event Id I_Tc UDInt Compare Get Checking with an Event Id Json Attribute I_Tc Json Attribute Expre Get Checking with the Json Attribute ssion Severity I_Tc Severity Compare Get Checking with Serverity Source I_Tc Source Info Express Get Checking with the source ion Time Cleared I_Tc ULInt Compare Get Checking of the clear time (only in the event of an alarm) Time Confirmed I_Tc ULInt Compare Get Checking of the confirm time (only for alarm with acknowledgement) Time Raised I_Tc ULInt Compare Get Checking of the sender (for messages) or the raised time (for alarms) Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 6.1.3.3.1 Clear The method clears the previous filter expression. Return values Name Type Description Clear I_Tc Binary Expression Link point 68 Version: 1.11.3 TE1000

## Page 69

PLC API 6.1.3.3.2 Filter Expression The method specifies a subordinate filter definition. Inputs Name Type Description ip Expression I_Tc Event Filter Base Link point Return values Name Type Description Filter Expression I_Tc Logical Expression Link point 6.1.3.3.3 Is Alarm The method checks whether it is an alarm. Return values Name Type Description Is Alarm I_Tc Logical Expression Link point 6.1.3.3.4 Is Message The method checks whether it is a message. Return values Name Type Description Is Message I_Tc Logical Expression Link point 6.1.3.3.5 NOT_OP The method negates the following statement. TE1000 Version: 1.11.3 69

## Page 70

PLC API Return values Name Type Description NOT_OP I_Tc Binary Expression Link point 6.1.4 Remote Event Logger The Event Logger also offers the option of accessing remote systems, for which the necessary function blocks are described here. In addition, function blocks from the Asynchronous text requests [} 37] section have an option to query texts on a remote system. The use is described in the section Remote access to the Event Logger via PLC [} 35]. 6.1.4.1 FB_Remote Listener Base The function block serves as the basic implementation of an event listener of a remote system. New messages and state changes of alarms can be recognized through the overwriting of the event-driven methods. This function block provides access to the Event Logger of a remote system and can be used to send events there or receive events from there. Syntax FUNCTION_BLOCK FB_Remote Listener Base IMPLEMENTS I_Remote Listener Methods Name Description Execute [} 71] Must be called cyclically so that the event queue can be processed. Subscribe [} 75] Subscribes notifications. Unsubscribe [} 75] Unsubscribes notifications. 70 Version: 1.11.3 TE1000

## Page 71

PLC API Event-driven methods Name Description On Alarm Cleared Called when the state of an alarm changes from "Raised" to "Clear". [} 72] On Alarm Confirmed Called when an alarm has been confirmed. [} 72] On Alarm Disposed Called when an alarm instance has been released again. [} 72] On Alarm Raised Called when the state of an alarm changes from "Clear" to "Raised". [} 73] On Connection State C Called when the connection to the remote system changes state. hanged [} 73] On Database Changed Called if the database has changed, e.g. if a Clear Logged Events() has been called [} 73] On Event Logger Error Called if an ADS error occurs during communication. [} 74] On Message Sent Called when a message has been sent. [} 74] Properties Name Type Access Description b Subscribed BOOL Get Returns TRUE if the function block has registered notifications and event monitoring is active. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 6.1.4.1.1 Execute The method must be called cyclically so that the event queue can be processed. Syntax METHOD Execute : HRESULT Return value Name Type Description Execute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. TE1000 Version: 1.11.3 71

## Page 72

PLC API 6.1.4.1.2 On Alarm Cleared This method is called if the state of an alarm changes from Raised to Clear. Syntax METHOD On Alarm Cleared : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 6.1.4.1.3 On Alarm Confirmed This method is called when an alarm has been confirmed. Syntax METHOD On Alarm Confirmed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 6.1.4.1.4 On Alarm Disposed This method is called when an alarm instance has been released again. Syntax METHOD On Alarm Disposed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR 72 Version: 1.11.3 TE1000

## Page 73

PLC API Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 6.1.4.1.5 On Alarm Raised This method is called if the state of an alarm changes from Clear to Raised. Syntax METHOD On Alarm Raised : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 6.1.4.1.6 On Connection State Changed This method is called when the connection to the remote system changes state. Syntax METHOD On Connection State Changed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; e Reason : Tc Remote Connection Change Reason; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers e Reason Tc Remote Connection Change The type of change in connection status. Reason 6.1.4.1.7 On Database Changed TE1000 Version: 1.11.3 73

## Page 74

PLC API This method is called if the database has changed, e.g. if a Clear Logged Events() has been called. Syntax METHOD On Database Changed : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; e Reason : Tc Database Change Reason; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers e Reason Tc Database Change Reason One of the values of the ENUM: Undefined, Cleard By Command, Maximum Size Reached, Deleted 6.1.4.1.8 On Event Logger Error This method is called if an ADS error occurs during communication. Syntax METHOD On Event Logger Error : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; hr : HRESULT; END_VAR Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers hr HRESULT The error code that has occurred. 6.1.4.1.9 On Message Sent This method is called when a message has been sent. Syntax METHOD On Message Sent : HRESULT VAR_INPUT ip Context : I_Tc Listener Context; fb Event : REFERENCE TO FB_Tc Event; END_VAR 74 Version: 1.11.3 TE1000

## Page 75

PLC API Inputs Name Type Description ip Context I_Tc Listener Context Context of the different Event Loggers fb Event REFERENCE TO Reference to the alarm that has occurred. This reference FB_Tc Event must not be copied, e.g. by assignment. 6.1.4.1.10 Subscribe The method subscribes notifications. Syntax METHOD Subscribe : HRESULT VAR_INPUT ip Remote Logger : I_Tc Remote Event Logger; ip Event Filter : I_Tc Event Filter Base; // optional END_VAR Inputs Name Type Description ip Remote Logger I_Tc Remote Event Logger Reference to the Event Logger for which a notification is to be registered. ip Event Filter I_Tc Event Filter Base Pointer to an instance of FB_Tc Event Filter [} 67], if a filter is to be activated. Return value Name Type Description Subscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_EXISTS if the listener is already subscribed. Otherwise returns HRESULT as the error code 6.1.4.1.11 Unsubscribe The listener is unsubcribed with this method. Syntax METHOD Unsubscribe : HRESULT TE1000 Version: 1.11.3 75

## Page 76

PLC API Return value Name Type Description Unsubscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_NOTFOUND if the listener was not subscribed. Otherwise returns HRESULT as the error code. 6.1.4.2 FB_Tc Remote Event Logger This function block represents the Twin CAT 3 Event Logger for a remote system. Syntax FUNCTION_BLOCK FB_Remote Event Logger IMPLEMENTS I_Remote Event Logger Methods Name Description Clear Alarm [} 77]s Clears active alarms. Clear Logged Events Clears logged events. [} 77] Confirm Alarms Confirms alarms. [} 78] Connect [} 78] Connects to the remote system. Disconnect [} 79] Terminates the connection with the remote system. Send Message [} 79] Sends a message. Send Message2 Sends a message. [} 80] Send Message Ex Sends a message. [} 81] Send Message Ex2 Sends a message. [} 82] Properties Name Type Access Description hr Connect HRESULT Get Connection status to the remote system hr Init HRESULT Get Errors that occur during startup. s Net Id T_Ams Net Id Get Ams Net Id of the remote system Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4026.0 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>=3.3.7.0) 76 Version: 1.11.3 TE1000

## Page 77

PLC API 6.1.4.2.1 Clear Alarms Method for clearing active alarms. Returns S_OK if successful. Syntax METHOD Clear Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; b Reset Confirmation : BOOL := FALSE; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 b Reset Confirmati BOOL If TRUE and the confirmation status is on Wait For Confirmation, the confirmation status is set to Reset. Otherwise, the confirmation status is not changed. Initial: FALSE ip Filter I_Tc Event Filter Specify which alarms are to be cleared, otherwise all triggered alarms are cleared. Return value Name Type Description Clear Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.2 Clear Logged Events Async method for clearing logged events. Returns TRUE if the asynchronous request is no longer assigned. Syntax METHOD Clear Logged Events : HRESULT VAR_INPUT ip Clear Settings : I_Tc Clear Logged Events Settings; END_VAR Inputs Name Type Description ip Clear Settings I_Tc Clear Logged Events Settin Optional gs (otherwise the entire cache is emptied) TE1000 Version: 1.11.3 77

## Page 78

PLC API Return value Name Type Description Clear Logged Eve HRESULT Returns S_PENDING as long as the request has not yet nts been completed. Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. Use of the method This method is asynchronous, i.e. it requires several cycles to deliver the return value. The following use is intended: IF b Clear Logged Events THEN b Clear Logged Events:= NOT (fb Logger. Clear Logged Events(0) = S_OK); END_IF 6.1.4.2.3 Confirm Alarms The method confirms alarms. Syntax METHOD Confirm Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 ip Filter I_Tc Event Filter Specify which alarms are to be confirmed, otherwise all alarms with the confirmation status Wait For Confirmation are confirmed. Return value Name Type Description Confirm Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.4 Connect The method connects to the remote system. Syntax METHOD Connect : HRESULT VAR_INPUT s Net Id : T_Ams Net Id; (* Ams Net Id of the remote Twin CAT system.*) END_VAR 78 Version: 1.11.3 TE1000

## Page 79

PLC API Inputs Name Type Description s Net Id T_Ams Net Id Ams Net Id of the remote system Return value Name Type Description Connect HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.5 Disconnect The method terminates the connection with the remote system. Syntax METHOD Disconnect : HRESULT Return value Name Type Description Disconnect HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.6 Send Message This method sends a message. Syntax METHOD Send Message : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR TE1000 Version: 1.11.3 79

## Page 80

PLC API Inputs Name Type Description event Class GUID GUID of the event class n Event Id UDINT ID of the event e Severity Tc Event Severity Severity of the event ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. Return value Name Type Description Send Message HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.7 Send Message2 This method sends a message. Syntax METHOD Send Message2 : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR 80 Version: 1.11.3 TE1000

## Page 81

PLC API Inputs Name Type Description event Class GUID GUID of the event class n Event Id UDINT ID of the event. e Severity Tc Event Severity Severity of the event ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return value Name Type Description Send Message2 HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.8 Send Message Ex This method sends a message. Syntax METHOD Send Message Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR TE1000 Version: 1.11.3 81

## Page 82

PLC API Inputs Name Type Description st Event Entry Tc Event Entry Event definition ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. Return value Name Type Description Send Message Ex HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.4.2.9 Send Message Ex2 This method sends a message. Syntax METHOD Send Message Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; // optional n Time Stamp : ULINT := 0; // set 0 to get the current time automatically ip Arguments : I_Tc Arguments := 0; // optional END_VAR 82 Version: 1.11.3 TE1000

## Page 83

PLC API Inputs Name Type Description st Event Entry Tc Event Entry Event definition ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return value Name Type Description Send Message Ex HRESULT Returns S_OK if the method call was successful, 2 otherwise an HRESULT as the error code. 6.1.5 FB_Listener Base2 The function block serves as the basic implementation of an event listener. New messages and state changes of alarms can be recognized through the overwriting of the event-driven methods. Syntax Definition: FUNCTION_BLOCK FB_Listener Base2 IMPLEMENTS I_Listener2 Methods Name Definition loca- Description tion Execute [} 84] Local Must be called cyclically so that the event queue can be processed. Subscribe [} 86] Local Subscribes messages. Unsubscribe [} 87] Local Unsubscribes messages. TE1000 Version: 1.11.3 83

## Page 84

PLC API Event-driven methods (callback methods) Name Definition loca- Description tion On Alarm Cleared I_Listener2 Called when the state of an alarm changes from "Raised" to "Clear". [} 84] On Alarm Confirmed I_Listener2 Called when an alarm has been confirmed. [} 85] On Alarm Disposed I_Listener2 Called when an alarm instance has been released again. [} 85] On Alarm Raised [} 85] I_Listener2 Called when the state of an alarm changes from "Clear" to "Raised". On Message Sent I_Listener2 Called when a message has been sent. [} 86] Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 6.1.5.1 Execute This method must be called cyclically so that the event queue can be processed. Syntax METHOD Execute : HRESULT Return value Name Type Description Execute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.5.2 On Alarm Cleared This method is called if the state of an alarm changes from Raised to Clear. Syntax METHOD On Alarm Cleared : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. 84 Version: 1.11.3 TE1000

## Page 85

PLC API Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 96] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 6.1.5.3 On Alarm Confirmed This method is called when an alarm has been confirmed. Syntax METHOD On Alarm Confirmed : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 96] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 6.1.5.4 On Alarm Disposed This method is called when an alarm instance has been released again. Syntax METHOD On Alarm Confirmed : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 96] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 6.1.5.5 On Alarm Raised This method is called if the state of an alarm changes from Clear to Raised. TE1000 Version: 1.11.3 85

## Page 86

PLC API Syntax METHOD On Alarm Raised : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 96] Reference to the alarm that has occurred. This reference must not be copied, e.g. through assignment. 6.1.5.6 On Message Sent This method is called when a message has been sent. Syntax METHOD On Message Sent : HRESULT VAR_INPUT fb Event : REFERENCE TO FB_Tc Event; END_VAR If the implementation of the callback method returns a return code <> S_OK, further callback calls will be paused until the next execution. Inputs Name Type Description fb Event REFERENCE TO FB_Tc Event [} 96] Reference to the event that has occurred. This reference must not be copied, e.g. through assignment. 6.1.5.7 Subscribe The listener is subscribed for messages with this method. Syntax METHOD Subscribe : HRESULT VAR_INPUT ip Message Filter Config : POINTER TO ITc Event Filter Config; ip Alarm Filter Config : POINTER TO ITc Event Filter Config; END_VAR 86 Version: 1.11.3 TE1000

## Page 87

PLC API Inputs Name Type Description ip Message Filter Config POINTER TO ITc Event Filter Config Pointer to ITc Event Filter Config if a filter is to be activated. ip Alarm Filter Config POINTER TO ITc Event Filter Config Pointer to ITc Event Filter Config if a filter is to be activated. Return value Name Type Description Subscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_EXISTS if the listener is already subscribed. Otherwise returns HRESULT as the error code. 6.1.5.8 Subscribe2 This method subscribes notifications. Syntax METHOD Subscribe2 : HRESULT Input Name Type Description ip Event Filter I_Tc Event Filter Base Pointer to an instance of FB_Tc Event Filter [} 67], if a filter is to be activated. Return value Name Type Description Subscribe2 HRESULT Delivers if successful S_OK. 6.1.5.9 Unsubscribe The listener is unsubcribed with this method. Syntax METHOD Unsubscribe : HRESULT TE1000 Version: 1.11.3 87

## Page 88

PLC API Return value Name Type Description Unsubscribe HRESULT Returns S_OK if the method call was successful. Returns ADS_E_NOTFOUND if the listener was not subscribed. Otherwise returns HRESULT as the error code. 6.1.6 FB_Tc Alarm This function block represents an alarm of the Twin CAT 3 Event Logger. Syntax Definition: FUNCTION_BLOCK FB_Tc Alarm EXTENDS FB_Tc Event Base Inheritance hierarchy FB_Tc Event Base [} 98] FB_Tc Alarm 88 Version: 1.11.3 TE1000

## Page 89

PLC API Methods Name Definition location Description Equals To [} 99] Inherited from FB_Tc Event Base Compares the event with another instance. [} 98] Equals To Event Class [} 100] Inherited from FB_Tc Event Base Compares the event class of the event with another event class. [} 98] Equals To Event Entry [} 100] Inherited from FB_Tc Event Base Compares the event class, the event ID and the severity of the event with those of another [} 98] event. Equals To Event Entry Ex [} 101] Inherited from FB_Tc Event Base Compares the event definition of the event with another event definition. [} 98] Get Json Attribute [} 101] Inherited from FB_Tc Event Base Returns the Json attribute. [} 98] Release [} 102] Inherited from FB_Tc Event Base Releases the instance created by the Event Logger again. [} 98] Request Event Class Name Inherited from FB_Tc Event Base Requests the name of the event class. [} 102] [} 98] Request Event Text [} 103] Inherited from FB_Tc Event Base Returns the text for the event. [} 98] Clear [} 90] Local Sets the alarm state to "Not Raised". Confirm [} 91] Local Confirms the alarm. Create [} 92] Local Creates an alarm instance in the Event Logger. Create Ex [} 92] Local Creates an alarm instance in the Event Logger from an event definition. Raise [} 93] Local Sets the alarm state to "Raised". Set Json Attribute [} 94] Local Sets the Json attribute. TE1000 Version: 1.11.3 89

## Page 90

PLC API Properties Name Type Access Definition location Description e Severity Tc Event Severity Get Inherited from Returns the severity. [} 138] FB_Tc Event Base [} 98] Event Class GUID Get Inherited from Returns the GUID of the event FB_Tc Event Base class. [} 98] ip Arguments [} 104] I_Tc Arguments Get Inherited from Returns the interface pointer for [} 121] FB_Tc Event Base the arguments. [} 98] ip Source Info [} 104] I_Tc Source Info Get Inherited from The Source Info is created [} 137] FB_Tc Event Base internally as the default behavior. It then contains the [} 98] symbol name of the function block that instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id n Event Id Get Inherited from Returns the ID of the event. FB_Tc Event Base [} 98] st Event Entry Tc Event Entry Get Inherited from Returns the event definition. [} 137] FB_Tc Event Base [} 98] b Raised BOOL Get Local Returns TRUE if the alarm is in the "raised" state. b Active BOOL Get Local Returns TRUE if the alarm is in the "Raised" or "Wait For Confirmation" state. e Confirmation State Tc Event Confirmati Get Local Returns the confirmation state. on State [} 138] n Time Cleared ULINT Get Local Returns the time of the Clear. n Time Confirmed ULINT Get Local Returns the time of the Confirm. n Time Raised ULINT Get Local Returns the time of the Raise. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.6.1 Clear This method sets the alarm state [} 14] to Not Raised. 90 Version: 1.11.3 TE1000

## Page 91

PLC API Syntax METHOD Clear : HRESULT VAR_INPUT n Time Stamp : ULINT; b Reset Confirmation : BOOL; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). b Reset Confirmation BOOL If TRUE and the confirmation state is Wait For Confirmation, the confirmation state is set to Reset. Otherwise the confirmation state is not changed. Return value Name Type Description Clear HRESULT Returns S_OK if the method call was successful. Returns ADS_E_INVALIDSTATE if the alarm was not in the Raised state. Otherwise returns HRESULT as the error code. 6.1.6.2 Confirm This method sets the confirmation state [} 14] of Wait For Confirmation to Confirmed. Syntax METHOD Confirm : HRESULT VAR_INPUT n Time Stamp: ULINT; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Confirm HRESULT Returns S_OK if the method call was successful. Returns ADS_E_INVALIDSTATE if the confirmation state was not Wait Confirmation. Otherwise returns HRESULT as the error code. TE1000 Version: 1.11.3 91

## Page 92

PLC API 6.1.6.3 Create This method creates an alarm instance in the Event Logger. Syntax METHOD Create : HRESULT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; b With Confirmation : BOOL; ip Source Info : I_Tc Source Info; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Severity of the event. [} 138] b With Confirmation BOOL Defines whether the alarm requires mandatory confirmation. ip Source Info I_Tc Source Info Interface pointer to the source information. [} 137] This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create HRESULT Returns S_OK if a new alarm was successfully created. Returns ERROR_ALREADY_EXISTS if the alarm has already existed. Otherwise returns HRESULT as the error code 6.1.6.4 Create Ex This method creates an alarm instance in the Event Logger. Syntax METHOD Create Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; b With Confirmation : BOOL; ip Source Info : I_Tc Source Info; END_VAR 92 Version: 1.11.3 TE1000

## Page 93

PLC API Inputs Name Type Description st Event Entry Tc Event Entry [} 137] Event definition. b With Confirmation BOOL Defines whether the alarm requires mandatory confirmation. ip Source Info I_Tc Source Info [} 137] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create Ex HRESULT Returns S_OK if a new alarm was successfully created. Returns ERROR_ALREADY_EXISTS if the alarm has already existed. Otherwise returns HRESULT as the error code. 6.1.6.5 Raise The method sets the alarm state [} 14] to Raised. If the alarm requires mandatory confirmation, the confirmation state is additionally set to Wait For Confirmation. Syntax METHOD Raise : HRESULT VAR_INPUT n Time Stamp : ULINT; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Raise HRESULT Returns S_OK if the method call was successful. Returns ADS_E_INVALIDSTATE if the alarm was already in the Raised state. Otherwise returns HRESULT as the error code. TE1000 Version: 1.11.3 93

## Page 94

PLC API 6.1.6.6 Set Json Attribute This method sets the JSON attribute. Syntax METHOD Set Json Attribute : HRESULT VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR Inputs Name Type Description s Json Attribute STRING JSON string Return value Name Type Description Set Json Attribute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.7 FB_Tc Arguments Arguments of an event can be defined with this function block. The ITc Arguments interface is implemented for this. Syntax Definition: FUNCTION_BLOCK FB_Tc Arguments IMPLEMENTS I_Tc Arguments Interfaces Type Description I_Tc Arguments [} 121] Defines the argument handling. 94 Version: 1.11.3 TE1000

## Page 95

PLC API Methods Name Definition loca- Description tion Add Blob [} 122] I_Tc Arguments Adds binary data as an argument. [} 121] Add Bool [} 123] I_Tc Arguments Adds an argument of the type BOOL. [} 121] Add Byte [} 123] I_Tc Arguments Adds an argument of the type BYTE. [} 121] Add Dint [} 124] I_Tc Arguments Adds an argument of the type DINT. [} 121] Add DWord [} 124] I_Tc Arguments Adds an argument of the type DWORD. [} 121] Add Event Reference Id I_Tc Arguments Adds a reference to another event as an argument. [} 124] [} 121] Add Event Reference Id G I_Tc Arguments Adds a reference to another event as an argument. uid [} 125] [} 121] Add Int [} 125] I_Tc Arguments Adds an argument of the type INT. [} 121] Add LInt [} 126] I_Tc Arguments Adds an argument of the type LINT. [} 121] Add LReal [} 126] I_Tc Arguments Adds an argument of the type LREAL. [} 121] Add Real [} 127] I_Tc Arguments Adds an argument of the type REAL. [} 121] Add SInt [} 127] I_Tc Arguments Adds an argument of the type SINT. [} 121] Add String [} 128] I_Tc Arguments Adds an argument of the type STRING. [} 121] Add UDint [} 128] I_Tc Arguments Adds an argument of the type UDINT. [} 121] Add UInt [} 128] I_Tc Arguments Adds an argument of the type INT. [} 121] Add ULInt [} 129] I_Tc Arguments Adds an argument of the type ULINT. [} 121] Add USInt [} 129] I_Tc Arguments Adds an argument of the type USINT. [} 121] Add Word [} 130] I_Tc Arguments Adds an argument of the type WORD. [} 121] Add WString [} 130] I_Tc Arguments Adds an argument of the type WSTRING. [} 121] Clear [} 131] I_Tc Arguments Removes all arguments. [} 121] Is Empty [} 96] Local Checks whether arguments have been added. TE1000 Version: 1.11.3 95

## Page 96

PLC API Properties Name Type Access Description n Count UDINT Get Returns the number of transferred arguments. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.7.1 Is Empty This method checks whether arguments have been added. Syntax METHOD Is Empty : BOOL Return value Name Type Description Is Empty BOOL Returns TRUE if no arguments have been added. 6.1.8 FB_Tc Event This function block provides only read methods and read properties for an event. Syntax Definition: FUNCTION_BLOCK FB_Tc Event EXTENDS FB_Tc Event Base IMPLEMENTS I_Tc Event Base Inheritance hierarchy FB_Tc Event Base [} 98] FB_Tc Event Interfaces Type Description I_Tc Event Base [} 131] Basic interface that defines methods and properties of an event. 96 Version: 1.11.3 TE1000

## Page 97

PLC API Methods Name Definition location Description Equals To [} 99] Inherited from FB_Tc Event Base Compares the event with another instance. [} 98] Equals To Event Class [} 100] Inherited from FB_Tc Event Base Compares the event class of the event with another event class. [} 98] Equals To Event Entry [} 100] Inherited from FB_Tc Event Base Compares the event definition of the event with another event [} 98] definition. Equals To Event Entry Ex [} 101] Inherited from FB_Tc Event Base Compares the event definition of the event with another event [} 98] definition. Get Json Attribute [} 101] Inherited from FB_Tc Event Base Returns the Json attribute. [} 98] Release [} 102] Inherited from FB_Tc Event Base Releases the instance created by the Event Logger again. [} 98] Request Event Class Name [} 102] Inherited from FB_Tc Event Base Requests the name of the event class. [} 98] Request Event Text [} 103] Inherited from FB_Tc Event Base Returns the text for the event. [} 98] Properties Name Type Access Definition loca- Description tion e Severity Tc Event Severity Get Inherited from Returns the severity. [} 138] FB_Tc Event Base [} 98] Event Class GUID Get Inherited from Returns the GUID of the event class. FB_Tc Event Base [} 98] ip Arguments I_Tc Arguments Get Inherited from Returns the interface pointer for the [} 104] [} 121] FB_Tc Event Base arguments. [} 98] ip Source Info I_Tc Source Info Get Inherited from The Source Info is created internally as [} 104] [} 137] FB_Tc Event Base the default behavior. It then contains the symbol name of the function block that [} 98] instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id n Event Id Get Inherited from Returns the ID of the event. FB_Tc Event Base [} 98] st Event Entry Tc Event Entry [} 137] Get Inherited from Returns the event definition. FB_Tc Event Base [} 98] n Timestamp ULINT Get Local Returns the time. TE1000 Version: 1.11.3 97

## Page 98

PLC API Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.9 FB_Tc Event Base This function block contains the basic implementation. Syntax Definition: FUNCTION_BLOCK FB_Tc Event Base Methods Name Definition location Description Equals To [} 99] Local Compares the event with another instance. Equals To Event Class [} 100] Local Compares the event class of the event with another event class. Equals To Event Entry [} 100] Local Compares the event definition of the event with another event definition. Equals To Event Entry Ex [} 101] Local Compares the event definition of the event with another event definition. Get Json Attribute [} 101] Local Returns the Json attribute. Release [} 102] Local Releases the instance created by the Event Logger again. Request Event Class Name [} 102] Local Requests the name of the event class. Request Event Text [} 103] Local Returns the text for the event. 98 Version: 1.11.3 TE1000

## Page 99

PLC API Properties Name Type Access Description e Severity Tc Event Severity [} 138] Get Returns the severity. Event Class GUID Get Returns the GUID of the event class. ip Arguments [} 104] I_Tc Arguments [} 121] Get Returns the interface pointer for the arguments. ip Source Info [} 104] I_Tc Source Info [} 137] Get The Source Info is created internally as the default behavior. It then contains the symbol name of the function block that instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id UDINT Get Returns the ID of the event. n Unique Id UDINT Get Returns the unique ID of the event. st Event Entry Tc Event Entry [} 137] Get Returns the event definition. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.9.1 Equals To This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To : BOOL VAR_INPUT ip Other : I_Tc Event Base; END_VAR Inputs Name Type Description ip Other I_Tc Event Base [} 131] Event to be compared TE1000 Version: 1.11.3 99

## Page 100

PLC API Return value Name Type Description Equals To BOOL Returns TRUE if the events match. 6.1.9.2 Equals To Event Class This method carries out a comparison with another event class specified at the input. Syntax METHOD Equals To Event Class : BOOL VAR_INPUT Other Event Class : GUID; END_VAR Inputs Name Type Description Other Event Class GUID Event class to be compared. Return value Name Type Description Equals To Event Class BOOL Returns TRUE if the event classes match. 6.1.9.3 Equals To Event Entry This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry : BOOL VAR_INPUT Other Event Class : GUID; n Other Event ID : UDINT; e Other Severity : Tc Event Severity; END_VAR Inputs Name Type Description Other Event Class GUID Event class of the event to be compared. n Other Event ID UDINT Event ID of the event to be compared. e Other Severity Tc Event Severity [} 138] Event severity of the event to be compared. 100 Version: 1.11.3 TE1000

## Page 101

PLC API Return value Name Type Description Equals To Event Entry BOOL Returns TRUE if the events match. 6.1.9.4 Equals To Event Entry Ex This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry Ex : BOOL VAR_INPUT st Other : Tc Event Entry; END_VAR Inputs Name Type Description st Other Tc Event Entry [} 137] Event to be compared. Return value Name Type Description Equals To Event Entry Ex BOOL Returns TRUE if the events match. 6.1.9.5 Get Json Attribute This method returns the JSON attribute. Syntax METHOD Get Json Attribute : HRESULT VAR_INPUT s Json Attribute : REFERENCE TO STRING; n Json Attribute : UDINT; END_VAR Inputs Name Type Description s Json Attribute REFERENCE TO STRING Reference to a variable of the type String n Json Attribute UDINT Length of the String variable TE1000 Version: 1.11.3 101

## Page 102

PLC API Return value Name Type Description Get Json Attribute HRESULT Returns S_OK if the method call was successful. Returns ERROR_BAD_LENGTH if the length of the variable is too small. Otherwise HRESULT is returned as the error code. 6.1.9.6 Release This method releases the instance created by the Event Logger again. Syntax METHOD Release : HRESULT Return value Name Type Description Release HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.9.7 Request Event Class Name This method returns the name of the event class. Syntax METHOD Request Event Class Name : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes 102 Version: 1.11.3 TE1000

## Page 103

PLC API Return value Name Type Description Request Event Class Name BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 6.1.9.8 Request Event Text This method returns the event text. Syntax METHOD Request Event Text : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes Return value Name Type Description Request Event Text BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. TE1000 Version: 1.11.3 103

## Page 104

PLC API Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 6.1.9.9 ip Arguments PROPERTY PUBLIC ip Arguments : I_Tc Arguments 6.1.9.10 ip Source Info PROPERTY ip Source Info : I_Tc Source Info 6.1.10 FB_Tc Event Logger This function block represents the Twin CAT 3 Event Logger itself. Syntax Definition: FUNCTION_BLOCK FB_Tc Event Logger Methods Name Description Clear Alarms [} 105] Clears active alarms. Clear All Alarms [} 105] Calls Clear() for all alarms in the Raised state. Clear Logged Events [} 106] Clears logged events. Confirm Alarms [} 107] Confirms alarms. Confirm All Alarms [} 107] Calls Confirm() for all alarms with the confirmation state Wait For Confirmation. Export Logged Events [} 108] Exports logged events. Get Alarm [} 109] Returns the pointer to an existing alarm. Get Alarm Ex [} 109] Returns the pointer to an existing alarm. Is Alarm Raised [} 110] Queries whether an alarm is in the Raised state. Is Alarm Raised Ex [} 110] Queries whether an alarm is in the Raised state. Send Message [} 111] Sends a message. Send Message2 [} 112] Sends a message. Send Message Ex [} 113] Sends a message. Send Message Ex2 [} 114] Sends a message. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 104 Version: 1.11.3 TE1000

## Page 105

PLC API 6.1.10.1 Clear Alarms Method for clearing active alarms. Returns S_OK if successful. Syntax METHOD Clear Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; b Reset Confirmation : BOOL := FALSE; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 b Reset Confirmation BOOL If TRUE and the confirmation status is Wait For Confirmation, the confirmation status is set to Reset. Otherwise, the confirmation status is not changed. Initial: FALSE ip Filter I_Tc Event Filter Specify which alarms are to be cleared, otherwise all triggered alarms are cleared. Return values Name Type Description Clear Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.2 Clear All Alarms This method calls the Clear() method for all alarms in the alarm state Raised. Syntax METHOD Clear All Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; b Reset Confirmation : BOOL := FALSE; END_VAR TE1000 Version: 1.11.3 105

## Page 106

PLC API Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). b Reset Confirmation BOOL If TRUE and the confirmation state is Wait For Confirmation, the confirmation state is set to Reset. Otherwise the confirmation state is not changed. Return value Name Type Description Clear All Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code 6.1.10.3 Clear Logged Events Async method for clearing logged events. Returns TRUE if the asynchronous request is no longer assigned. Syntax METHOD Clear Logged Events : BOOL VAR_INPUT ip Clear Settings : I_Tc Clear Logged Events Settings; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description ip Clear Settings I_Tc Clear Logged Events Settings Optional (otherwise the entire cache is emptied) Return values Name Type Description Clear Logged Events BOOL Returns TRUE as soon as the request has been processed. Outputs Name Type Description b Error BOOL Returns TRUE if the query is incorrect. hr Error Code HRESULT Returns an error code if the query is incorrect. 106 Version: 1.11.3 TE1000

## Page 107

PLC API Application sample for the method This method is asynchronous, i.e. it requires several cycles to deliver the return value. The following use is intended: IF b Clear Logged Events THEN b Clear Logged Events:= NOT fb Logger. Clear Logged Events(0); END_IF 6.1.10.4 Confirm Alarms This method confirms alarms. Syntax METHOD Confirm Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; ip Filter : I_Tc Event Filter; END_VAR Inputs Name Type Description n Time Stamp ULINT Set to 0 to obtain the current time automatically. Initial: 0 ip Filter I_Tc Event Filter Specify which alarms are to be confirmed, otherwise all alarms with the confirmation status Wait For Confirmation are confirmed. Return values Name Type Description Confirm Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.5 Confirm All Alarms This method calls the Confirm() method for all alarms having the confirmation state Wait For Confirmation. Syntax METHOD Confirm All Alarms : HRESULT VAR_INPUT n Time Stamp : ULINT := 0; END_VAR TE1000 Version: 1.11.3 107

## Page 108

PLC API Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Confirm All Alarms HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.6 Export Logged Events This method exports logged events asynchronously. Returns TRUE when asynchronous processing is complete. Syntax METHOD Export Logged Events : BOOL VAR_IN_OUT CONSTANT s File Name : STRING; END_VAR VAR_INPUT ip Export Settings : I_Tc Event Export Settings; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description ip Export Settings I_Tc Event Export Settings Specify which events are to be exported, otherwise all events will be exported. An instance of FB_Tc Event Csv Export Settings [} 66] can be assigned for this purpose. Inputs/outputs Name Type Description s File Name STRING Name of the destination file Return values Name Type Description Export Logged Events BOOL TRUE, if the processing is completed. 108 Version: 1.11.3 TE1000

## Page 109

PLC API Outputs Name Type Description b Error BOOL TRUE when an error occurs. hr Error Code HRESULT Outputs the error information if b Error is TRUE. Application sample for the method This method is asynchronous, i.e. it requires several cycles to deliver the return value. The following use is intended: IF b Export Logged Events THEN b Export Logged Events:= NOT fb Logger. Export Logged Events(…); END_IF 6.1.10.7 Get Alarm This method returns an interface pointer to an existing instance. Syntax METHOD Get Alarm : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; ip Source Info : I_Tc Source Info := 0; fb Alarm : REFERENCE TO FB_Tc Alarm; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event ip Source Info I_Tc Source Info [} 137] Pointer to an ITc Source Info interface. fb Alarm REFERENCE TO FB_Tc Alarm [} 88] Pointer to an alarm. Return value Name Type Description Get Alarm HRESULT Returns ADS_E_NOTFOUND if no instance was found. Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.8 Get Alarm Ex This method returns an interface pointer to an existing instance. TE1000 Version: 1.11.3 109

## Page 110

PLC API Syntax METHOD Get Alarm Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; // optional fb Alarm : REFERENCE TO FB_Tc Alarm; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 137] Event definition ip Source Info I_Tc Source Info [} 137] Pointer to an ITc Source Info interface fb Alarm REFERENCE TO FB_Tc Alarm [} 88] Pointer to an alarm Return value Name Type Description Get Alarm Ex HRESULT Returns ADS_E_NOTFOUND if no instance was found. Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.9 Is Alarm Raised This method queries whether an alarm is in the Raised state. Syntax METHOD Is Alarm Raised : BOOL VAR_INPUT event Class : GUID; n Event Id : UDINT; ip Source Info : I_Tc Source Info := 0; END_VAR Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. ip Source Info I_Tc Source Info [} 137] Pointer to an ITc Source Info interface. Return value Name Type Description Is Alarm Raised BOOL Returns TRUE if the alarm is in the raised state. 6.1.10.10 Is Alarm Raised Ex 110 Version: 1.11.3 TE1000

## Page 111

PLC API This method queries whether an alarm is in the Raised state. Syntax METHOD Is Alarm Raised Ex : BOOL VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; END_VAR Inputs Name Type Description st Event Entry UDINT Event definition. ip Source Info I_Tc Source Info [} 137] Pointer to an ITc Source Info interface. Return value Name Type Description Is Alarm Raised Ex BOOL Returns TRUE if the alarm is in the raised state. 6.1.10.11 Send Message This method sends a message. Syntax METHOD Send Message : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR TE1000 Version: 1.11.3 111

## Page 112

PLC API Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity [} 138] Severity of the event. ip Source Info I_Tc Source Info [} 137] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). ip Arguments I_Tc Arguments [} 121] Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. Return value Name Type Description Send Message HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.12 Send Message2 This method sends a message. Syntax METHOD Send Message2 : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR 112 Version: 1.11.3 TE1000

## Page 113

PLC API Inputs Name Type Description event Class GUID GUID of the event class n Event Id UDINT ID of the event e Severity Tc Event Severity Severity of the event ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return values Name Type Description Send Message2 HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.13 Send Message Ex This method sends a message. Syntax METHOD Send Message Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR TE1000 Version: 1.11.3 113

## Page 114

PLC API Inputs Name Type Description st Event Entry Tc Event Entry [} 137] Event definition. ip Source Info I_Tc Source Info [} 137] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC). ip Arguments I_Tc Arguments [} 121] Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. Return value Name Type Description Send Message Ex HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.10.14 Send Message Ex2 This method sends a message. Syntax METHOD Send Message Ex2 : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; n Time Stamp : ULINT := 0; ip Arguments : I_Tc Arguments := 0; END_VAR VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR 114 Version: 1.11.3 TE1000

## Page 115

PLC API Inputs Name Type Description st Event Entry Tc Event Entry Event definition ip Source Info I_Tc Source Info Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. n Time Stamp ULINT 0: Current timestamp is used. > 0: External timestamp in 100 nanoseconds since January 1st, 1601 (UTC) ip Arguments I_Tc Arguments Interface pointer to arguments of the event. This information is optional. An instance of the type FB_Tc Arguments [} 94] can be specified here. s Json Attribute STRING String as a Json representation, which is transmitted in addition to the event text. Return values Name Type Description Send Message Ex2 HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.11 FB_Tc Message This function block represents a message from the Twin CAT 3 Event Logger. Syntax Definition: FUNCTION_BLOCK FB_Tc Message EXTENDS FB_Tc Event Base IMPLEMENTS I_Tc Message Inheritance hierarchy FB_Tc Event Base [} 98] FB_Tc Message Interfaces Type Description I_Tc Message [} 136] Provides methods and properties for the message handling. TE1000 Version: 1.11.3 115

## Page 116

PLC API Methods Name Definition loca- Description tion Equals To [} 99] Inherited from Compares the event with another instance. FB_Tc Event Base [} 98] Equals To Event Class Inherited from Compares the event class of the event with another event [} 100] FB_Tc Event Base class. [} 98] Equals To Event Entry Inherited from Compares the event definition of the event with another event [} 100] FB_Tc Event Base definition. [} 98] Equals To Event Entry Ex Inherited from Compares the event definition of the event with another event [} 101] FB_Tc Event Base definition. [} 98] Get Json Attribute Inherited from Returns the Json attribute. [} 101] FB_Tc Event Base [} 98] Release [} 102] Inherited from Releases the instance created by the Event Logger again. FB_Tc Event Base [} 98] Request Event Class Nam Inherited from Requests the name of the event class. e [} 102] FB_Tc Event Base [} 98] Request Event Text Inherited from Returns the text for the event. [} 103] FB_Tc Event Base [} 98] Create [} 117] Local Creates a message instance in the Event Logger. Create Ex [} 118] Local Creates a message instance in the Event Logger from an event definition. Set Json Attribute Local Sets the Json attribute. [} 118] Send [} 136] I_Tc Message Sends a message. [} 136] 116 Version: 1.11.3 TE1000

## Page 117

PLC API Properties Name Type Access Definition location Description e Severity Tc Event Severity Get Inherited from Returns the severity. [} 138] FB_Tc Event Base [} 98] Event Class GUID Get Inherited from Returns the GUID of the event class. FB_Tc Event Base [} 98] ip Arguments I_Tc Arguments Get Inherited from Returns the interface pointer for the [} 104] [} 121] FB_Tc Event Base arguments. [} 98] ip Source Info I_Tc Source Info Get Inherited from The Source Info is created internally as [} 104] [} 137] FB_Tc Event Base the default behavior. It then contains the symbol name of the function block [} 98] that instances FB_Tc Message as Source Name and the object ID of the PLC instance as Source ID. If the instance of FB_Tc Message is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. n Event Id n Event Id Get Inherited from Returns the ID of the event. FB_Tc Event Base [} 98] st Event Entry Tc Event Entry [} 137] Get Inherited from Returns the event definition. FB_Tc Event Base [} 98] n Time Sent ULINT Get Local Returns the time of the Send. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.11.1 Create This method creates a message instance in the Event Logger. Syntax METHOD Create : HRESULT VAR_INPUT event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; ip Source Info : I_Tc Source Info := 0; END_VAR TE1000 Version: 1.11.3 117

## Page 118

PLC API Inputs Name Type Description event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Defines the severity. [} 138] ip Source Info I_Tc Source Info Interface pointer to the source information. [} 137] This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.11.2 Create Ex This method creates a message instance in the Event Logger from an event definition. Syntax METHOD PUBLIC Create Ex : HRESULT VAR_INPUT st Event Entry : Tc Event Entry; ip Source Info : I_Tc Source Info := 0; END_VAR Inputs Name Type Description st Event Entry Tc Event Entry [} 137] Event definition. ip Source Info I_Tc Source Info [} 137] Interface pointer to the source information. This information is optional. An instance of the type FB_Tc Source Info [} 119] can be specified here. If nothing (NULL) is transferred, standard source information is generated. Return value Name Type Description Create Ex HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.11.3 Set Json Attribute 118 Version: 1.11.3 TE1000

## Page 119

PLC API This method sets the JSON attribute. Syntax METHOD Set Json Attribute : HRESULT VAR_IN_OUT CONSTANT s Json Attribute : STRING; END_VAR Inputs Name Type Description s Json Attribute STRING JSON string Return value Name Type Description Set Json Attribute HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 6.1.12 FB_Tc Source Info The source information of an event can be defined with this function block. Syntax Definition: FUNCTION_BLOCK FB_Tc Source Info IMPLEMENTS I_Tc Source Info Interfaces Type Description I_Tc Source Info [} 137] Provides read methods and read properties of a source information. Methods Name Definition loca- Description tion Clear [} 120] Local Resets the source information. Extend Name [} 120] Local Appends the transferred string to the name. Reset To Default [} 121] Local Sets the properties to default values. s Name is initialized with the symbol name of the instanced function block. n Id is initialized with the object ID of the PLC instance. If the instance of FB_Tc Source Info is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. Equals To [} 137] I_Tc Source Info Compares an instance with another instance. [} 137] TE1000 Version: 1.11.3 119

## Page 120

PLC API Properties Name Type Access Definition location Description guid GUID Get I_Tc Source Info [} 137] Returns the GUID of the source information. guid GUID SET Local Sets the GUID as source information. n Id UDINT Get I_Tc Source Info [} 137] Returns the ID of the source information. n Id UDINT SET Local Sets the ID of the source information. s Name STRING(Parameter List.c Sourc Get I_Tc Source Info [} 137] Returns the name of the e Name Size-1) source information. s Name STRING(Parameter List.c Sourc SET Local Sets the name of the e Name Size-1) source information Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.1.12.1 Clear This method resets the source information. Syntax METHOD Clear 6.1.12.2 Extend Name This method extends the name. Syntax METHOD Extend Name : BOOL VAR_INPUT s Extension : STRING(255); END_VAR Inputs Name Type Description s Extension STRING(255) Text to be appended to the right. 120 Version: 1.11.3 TE1000

## Page 121

PLC API Return value Name Type Description Extend Name BOOL Returns TRUE if the concatenation was successful. Returns FALSE if the resulting character string is longer than the output character string and doesn't fit in the given output buffer. The memory requirement for the resulting string is then larger than that for the output string. The string is then truncated. 6.1.12.3 Reset To Default This method sets the source information to default values. Default values: s Name is initialized with the symbol name of the instanced function block. n Id is initialized with the object ID of the PLC instance. If the instance of FB_Tc Source Info is hidden with the attribute "hide", no symbol name can be created internally for the default behavior. Syntax METHOD Reset To Default 6.2 Interfaces 6.2.1 I_Tc Arguments This interface defines methods for the argument handling. Inheritance hierarchy __SYSTEM. IQuery Interface I_Tc Arguments TE1000 Version: 1.11.3 121

## Page 122

PLC API Methods Name Description Add Blob [} 122] Adds binary data as an argument. Add Bool [} 123] Adds an argument of the type BOOL. Add Byte [} 123] Adds an argument of the type BYTE. Add Dint [} 124] Adds an argument of the type DINT. Add DWord [} 124] Adds an argument of the type DWORD. Add Event Reference Id [} 124] Adds a reference to another event as an argument. Add Event Reference Id Guid Adds a reference to another event as an argument. [} 125] Add Int [} 125] Adds an argument of the type INT. Add LInt [} 126] Adds an argument of the type LINT. Add LReal [} 126] Adds an argument of the type LREAL. Add Real [} 127] Adds an argument of the type REAL. Add SInt [} 127] Adds an argument of the type SINT. Add String [} 128] Adds an argument of the type STRING. Add UDint [} 128] Adds an argument of the type UDINT. Add UInt [} 128] Adds an argument of the type INT. Add ULInt [} 129] Adds an argument of the type ULINT. Add USInt [} 129] Adds an argument of the type USINT. Add Word [} 130] Adds an argument of the type WORD. Add WString [} 130] Adds an argument of the type WSTRING. Clear [} 131] Removes all arguments. Properties Name Type Access Description n Count UDINT Get Returns the number of transferred arguments. 6.2.1.1 Add Blob This method adds binary data as an argument. Syntax METHOD Add Blob : I_Tc Arguments VAR_INPUT p Data : PVOID; cb Data : UINT; END_VAR Inputs Name Type Description p Data PVOID Pointer to the first byte of the binary data. cb Data UINT Length of the binary data in bytes. 122 Version: 1.11.3 TE1000

## Page 123

PLC API Return value Name Type Description Add Blob I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.2 Add Bool This method adds an argument of the type BOOL. Syntax METHOD Add Bool : I_Tc Arguments VAR_INPUT value : BOOL; END_VAR Inputs Name Type Description value BOOL Value to be added. Return value Name Type Description Add Bool I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.3 Add Byte This method adds an argument of the type BYTE. Syntax METHOD Add Byte : I_Tc Arguments VAR_INPUT value : BYTE; END_VAR Inputs Name Type Description value BYTE Value to be added. Return value Name Type Description Add Byte I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. TE1000 Version: 1.11.3 123

## Page 124

PLC API 6.2.1.4 Add Dint This method adds an argument of the type DINT. Syntax METHOD Add DINT : I_Tc Arguments VAR_INPUT value : DINT; END_VAR Inputs Name Type Description value DINT Value to be added. Return value Name Type Description Add DINT I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.5 Add DWord This method adds an argument of the type DWORD. Syntax METHOD Add DWord : I_Tc Arguments VAR_INPUT value : DWORD; END_VAR Inputs Name Type Description value DWORD Value to be added. Return value Name Type Description Add DWord I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.6 Add Event Reference Id This method adds a reference to another event as an argument. 124 Version: 1.11.3 TE1000

## Page 125

PLC API Syntax METHOD Add Event Reference Id : I_Tc Arguments VAR_INPUT n Event Id : UDINT; END_VAR Inputs Name Type Description n Event Id UDINT ID of the event. Return value Name Type Description Add Event Reference Id I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.7 Add Event Reference Id Guid This method adds a reference to another event as an argument. Syntax METHOD Add Event Reference Id Guid : I_Tc Arguments VAR_INPUT n Event Id : UDINT; Event Class : GUID; END_VAR Inputs Name Type Description n Event Id UDINT ID of the event. Event Class GUID GUID of the event class. Return value Name Type Description Add Event Reference Id Guid I_Tc Arguments Returns the I_Tc Argument pointer again. [} 121] 6.2.1.8 Add Int This method adds an argument of the type INT. Syntax METHOD Add INT : I_Tc Arguments VAR_INPUT value : INT; END_VAR TE1000 Version: 1.11.3 125

## Page 126

PLC API Inputs Name Type Description value INT Value to be added. Return value Name Type Description Add Int I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.9 Add LInt This method adds an argument of the type LINT. Syntax METHOD Add LInt : I_Tc Arguments VAR_INPUT value : LINT; END_VAR Inputs Name Type Description value LINT Value to be added. Return value Name Type Description Add LInt I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.10 Add LReal This method adds an argument of the type LREAL. Syntax METHOD Add LReal : I_Tc Arguments VAR_INPUT value : LREAL; END_VAR Inputs Name Type Description value LREAL Value to be added. 126 Version: 1.11.3 TE1000

## Page 127

PLC API Return value Name Type Description Add LReal I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.11 Add Real This method adds an argument of the type REAL. Syntax METHOD Add Real : I_Tc Arguments VAR_INPUT value : REAL; END_VAR Inputs Name Type Description value REAL Value to be added. Return value Name Type Description Add Real I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.12 Add SInt This method adds an argument of the type SINT. Syntax METHOD Add SInt : I_Tc Arguments VAR_INPUT value : SInt; END_VAR Inputs Name Type Description value SINT Value to be added. Return value Name Type Description Add SInt I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. TE1000 Version: 1.11.3 127

## Page 128

PLC API 6.2.1.13 Add String This method adds an argument of the type STRING. Syntax METHOD Add String : I_Tc Arguments VAR_IN_OUT CONSTANT value : STRING; END_VAR Inputs Name Type Description value STRING Value to be added. Return value Name Type Description Add String I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.14 Add UDint This method adds an argument of the type UDINT. Syntax METHOD Add UDInt : I_Tc Arguments VAR_INPUT value : UDINT; END_VAR Inputs Name Type Description value UDINT Value to be added. Return value Name Type Description Add UDInt I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.15 Add UInt This method adds an argument of the type INT. 128 Version: 1.11.3 TE1000

## Page 129

PLC API Syntax METHOD Add UInt : I_Tc Arguments VAR_INPUT value : UINT; END_VAR Inputs Name Type Description value UINT Value to be added. Return value Name Type Description Add UInt I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.16 Add ULInt This method adds an argument of the type ULINT. Syntax METHOD Add ULInt : I_Tc Arguments VAR_INPUT value : ULINT; END_VAR Inputs Name Type Description value ULINT Value to be added. Return value Name Type Description Add ULInt I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.17 Add USInt This method adds an argument of the type USINT. Syntax METHOD Add USInt : I_Tc Arguments VAR_INPUT value : USINT; END_VAR TE1000 Version: 1.11.3 129

## Page 130

PLC API Inputs Name Type Description value USINT Value to be added. Return value Name Type Description Add USInt I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.18 Add Word This method adds an argument of the type WORD. Syntax METHOD Add Word : I_Tc Arguments VAR_INPUT value : WORD; END_VAR Inputs Name Type Description value WORD Value to be added. Return value Name Type Description Add Word I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.19 Add WString This method adds an argument of the type WSTRING. Syntax METHOD Add WString : I_Tc Arguments VAR_IN_OUT CONSTANT value : WSTRING; END_VAR Inputs Name Type Description value WSTRING Value to be added. 130 Version: 1.11.3 TE1000

## Page 131

PLC API Return value Name Type Description Add WString I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.1.20 Clear This method removes all arguments. Syntax METHOD Clear : I_Tc Arguments Return value Name Type Description Clear I_Tc Arguments [} 121] Returns the I_Tc Argument pointer again. 6.2.2 I_Tc Event Base Methods and properties of an event are defined in this basic interface. Methods Name Description Equals To [} 132] Compares the event with another instance. Equals To Event Class [} 132] Compares the event class of the event with another event class. Equals To Event Entry Ex Compares the event definition of the event with another event definition. [} 133] Get Json Attribute [} 134] Returns the Json attribute. Request Event Class Name Requests the name of the event class. [} 134] Request Event Text [} 135] Returns the text for the event. Properties Name Type Access Description e Severity Tc Event Severity Get Returns the severity. [} 138] Event Class GUID Get Returns the GUID of the event class. ip Source Info I_Tc Source Info Get Returns a pointer to the source definition. [} 137] n Event Id UDINT Get Returns the ID of the event. st Event Entry Tc Event Entry [} 137] Get Returns the event definition. TE1000 Version: 1.11.3 131

## Page 132

PLC API Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.2.2.1 Equals To This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To : BOOL VAR_INPUT ip Other : I_Tc Event Base; END_VAR Inputs Name Type Description ip Other I_Tc Event Base [} 131] Event to be compared Return value Name Type Description Equals To BOOL Returns TRUE if the events match. 6.2.2.2 Equals To Event Class This method carries out a comparison with another event class specified at the input. Syntax METHOD Equals To Event Class : BOOL VAR_INPUT Other Event Class : GUID; END_VAR Inputs Name Type Description Other Event Class GUID Event class to be compared. Return value Name Type Description Equals To Event Class BOOL Returns TRUE if the event classes match. 132 Version: 1.11.3 TE1000

## Page 133

PLC API 6.2.2.3 Equals To Event Entry This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry : BOOL VAR_INPUT Other Event Class : GUID; n Other Event ID : UDINT; e Other Severity : Tc Event Severity; END_VAR Inputs Name Type Description Other Event Class GUID Event class of the event to be compared. n Other Event ID UDINT Event ID of the event to be compared. e Other Severity Tc Event Severity [} 138] Event severity of the event to be compared. Return value Name Type Description Equals To Event Entry BOOL Returns TRUE if the events match. 6.2.2.4 Equals To Event Entry Ex This method carries out a comparison with another event specified at the input. Syntax METHOD Equals To Event Entry Ex : BOOL VAR_INPUT st Other : Tc Event Entry; END_VAR Inputs Name Type Description st Other Tc Event Entry [} 137] Event to be compared. Return value Name Type Description Equals To Event Entry Ex BOOL Returns TRUE if the events match. TE1000 Version: 1.11.3 133

## Page 134

PLC API 6.2.2.5 Get Json Attribute This method returns the JSON attribute. Syntax METHOD Get Json Attribute : HRESULT VAR_INPUT s Json Attribute : REFERENCE TO STRING; n Json Attribute : UDINT; END_VAR Inputs Name Type Description s Json Attribute REFERENCE TO STRING Reference to a variable of the type String n Json Attribute UDINT Length of the String variable Return value Name Type Description Get Json Attribute HRESULT Returns S_OK if the method call was successful. Returns ERROR_BAD_LENGTH if the length of the variable is too small. Otherwise HRESULT is returned as the error code. 6.2.2.6 Request Event Class Name This method returns the name of the event class. Syntax METHOD Request Event Class Name : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes 134 Version: 1.11.3 TE1000

## Page 135

PLC API Return value Name Type Description Request Event Class Name BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 6.2.2.7 Request Event Text This method returns the event text. Syntax METHOD Request Event Text : BOOL VAR_INPUT n Lang Id : DINT; s Result : REFERENCE TO STRING; n Result Size : UDINT; END_VAR VAR_OUTPUT b Error : BOOL; hr Error Code : HRESULT; END_VAR Inputs Name Type Description n Lang Id DINT Specifies the language ID English (en-US) = 1033 German (de-DE) = 1031 … s Result REFERENCE TO STRING Reference to a variable of the type String n Result Size UDINT Size of the String variable in bytes Return value Name Type Description Request Event Text BOOL Returns TRUE as soon as the request has been terminated. Returns FALSE if the asynchronous request is still active. The method must be called until the return value is TRUE. TE1000 Version: 1.11.3 135

## Page 136

PLC API Outputs Name Type Description b Error BOOL Returns FALSE if the method call was successful. Returns TRUE if an error has occurred. hr Error Code HRESULT Returns S_OK if the method call was successful. An error code is output in case of an error. 6.2.3 I_Tc Message This interface provides methods and properties for the message handling. Inheritance hierarchy I_Tc Event Base [} 131] I_Tc Message Methods Name Description Send [} 136] Sends a message Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.2.3.1 Send This method sends the message. Syntax METHOD Send : HRESULT VAR_INPUT n Time Stamp: ULINT; END_VAR Inputs Name Type Description n Time Stamp ULINT 0: Current time stamp is used > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Name Type Description Send FB_ HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code 136 Version: 1.11.3 TE1000

## Page 137

PLC API 6.2.4 I_Tc Source Info This interface defines properties for an item of source information. Methods Name Description Equals To [} 137] Compares an instance with source information with another instance. Properties Name Type Access Description guid GUID Get Returns the GUID of the source information. n Id UDINT Get Returns the ID of the source information. s Name STRING(Parameter List.c Sourc Get Returns the name of the source e Name Size-1) information. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4022.20 PC or CX (x64, x86, Arm®) Tc3_Event Logger 6.2.4.1 Equals To This method compares an instance with source information with another instance. Syntax METHOD Equals To : BOOL VAR_INPUT ip Other : I_Tc Source Info; END_VAR Inputs Name Type Description ip Other I_Tc Source Info [} 137] Items of source information to be compared Return value Name Type Description Equals To BOOL Returns TRUE if the items of source information match. 6.3 Data types 6.3.1 Tc Event Entry Defines an event by means of event class, event ID and severity. TE1000 Version: 1.11.3 137

## Page 138

PLC API Syntax Definition: TYPE Tc Event Entry : STRUCT uuid Event Class : GUID; n Event Id : UDINT; e Severity : Tc Event Severity; END_STRUCT END_TYPE Parameter Name Type Description uuid Event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Event severity defines the severity of the event, 6.3.2 Tc Event Severity Defines the severity of the event. Syntax Definition: {attribute 'qualified_only'} TYPE Tc Event Severity : ( Verbose := 0, Info := 1, Warning := 2, Error := 3, Critical := 4); END_TYPE Parameter Name Description 4 Critical Critical 3 Error Error 2 Warning Warning 1 Info Information 0 Verbose Extended output 6.3.3 Tc Event Confirmation State Defines the confirmation state of an alarm. Syntax Definition: {attribute 'qualified_only'} TYPE Tc Event Confirmation State : ( Not Supported := 0, Not Required := 1, Wait For Confirmation := 2, Confirmed := 3, Reset := 4); END_TYPE 138 Version: 1.11.3 TE1000

## Page 139

PLC API Parameter Name Description Confirmed Confirmed Not Required Confirmation not necessary in the current state. (Alarm not currently in the Raised state). Not Supported Was initialized without confirmation. Reset Initial state Wait For Confirmation Waiting for confirmation. 6.4 Global lists 6.4.1 Global_Constants VAR_GLOBAL CONSTANT EMPTY_EVENT_CLASS : GUID := (Data1:=16#0, Data2:=16#0, Data3:=16#0, Data4:=[16#0,16#0,16#0,16#0, 16#0,16#0,16#0,16#0]); EMPTY_EVENT_ID : UDINT := 16#0; EMPTY_SEVERITY : Tc Event Severity := Tc Event Severity. Verbose; SUCCESS_EVENT : Tc Event Entry := ( uuid Event Class := EMPTY_EVENT_CLASS, n Event ID := EMPTY_EVE NT_ID, e Severity := EMPTY_SEVERITY ); END_VAR Name Type Initial value EMPTY_EVENT_CLASS GUID STRUCT(Data1:=16#0, Data2:=16#0, Data3:=16#0, Data4: =[16#0,16#0,16#0,16#0,16#0,16#0,16#0,16#0]) EMPTY_EVENT_ID UDINT 16#0 EMPTY_SEVERITY Tc Event Severity Tc Event Severity. Verbose [} 138] SUCCESS_EVENT Tc Event Entry STRUCT(uuid Event Class := EMPTY_EVENT_CLASS, n Ev ent ID := EMPTY_EVENT_ID, e Severity := EMPTY_SEVER [} 137] ITY) 6.4.2 GVL {attribute 'qualified_only'} VAR_GLOBAL n Lang Id_Online Monitoring : DINT := 1033; END_VAR Name Type Initial value Description n Lang Id_Online Monitoring DINT 1033 Language ID for the online monitoring English (en-US) = 1033 German (de-DE) = 1031 … 6.4.3 Parameter list {attribute 'qualified_only'} VAR_GLOBAL CONSTANT c Source Name Size : UDINT(81..10000) := 256; END_VAR Name Type Initial value Description c Source Name Size UDINT(81..10000) 256 Size in bytes for the name of the source information. A maximum of 512 bytes is recommended. TE1000 Version: 1.11.3 139

## Page 140

PLC API 6.4.4 Global_Version All libraries have a certain version. This version can be seen in the PLC library repository among others. A global constant contains the library version information (of type ST_Lib Version): Global_Version VAR_GLOBAL CONSTANT st Lib Version_Tc3_Event Logger : ST_Lib Version; END_VAR To check whether the version you have is the version you need, use the function F_Cmp Lib Version (defined in the Tc2_System library). 140 Version: 1.11.3 TE1000

## Page 141

C++ API 7 C++ API 7.1 Interfaces 7.1.1 ITc Event This interface provides general methods for ITc Alarm and ITc Message. It is used in the callbacks of the interfaces ITc Alarm Listener and ITc Message Listener. Syntax TCOM_DECL_INTERFACE("4A9CB0E9-8969-4B85-B567-605110511200", ITc Event) Methods Name Description Get Event Class [} 141] Returns the GUID of the event class. Get Event Id [} 141] Returns the ID of the event. Get Severity [} 142] Returns the Severity of the event. Get Source Info [} 142] Returns the Source Info. Get Json Attribute [} 142] Returns the JSON attribute. Get Text [} 143] Returns the text asynchronously. Get Event Class Name [} 143] Returns the event class name asynchronously. 7.1.1.1 Get Event Class Returns the GUID of the event class. Syntax virtual HRESULT TCOMAPI Get Event Class (GUID event Class) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.1.2 Get Event Id Returns the ID of the event. Syntax virtual HRESULT TCOMAPI Get Event Id (UDINT Event Id) TE1000 Version: 1.11.3 141

## Page 142

C++ API Parameter Name Type Description event Id REFERENCE TO UDINT Reference to the ID of the event. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.1.3 Get Severity Returns the Severity of the event. Syntax virtual HRESULT TCOMAPI Get Severity (Tc Event Severity severity) Parameter Name Type Description severity REFERENCE TO Tc Event Severity Reference to the severity of an event. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.1.4 Get Source Info Returns the Source Info. Syntax virtual HRESULT TCOMAPI Get Source Info (ITc Source Info pip Source Info) Parameter Name Type Description pip Source Info POINTER TO ITc Source Info Reference to the Source Info interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.1.5 Get Json Attribute Returns the JSON attribute. Syntax virtual HRESULT TCOMAPI Get Json Attribute (STRING s Json Attribute, UDINT n Json Attribute) 142 Version: 1.11.3 TE1000

## Page 143

C++ API Parameter Name Type Description s Json Attribute REFERENCE TO STRING Reference to the JSON string. n Json Attribute REFERENCE TO UDINT Reference to the length of the Json attribute. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.1.6 Get Text Returns the text asynchronously. Syntax virtual HRESULT TCOMAPI Get Text (DINT n Lang Id, ITc Async String Result pip Result) Parameter Name Type Description n Lang Id DINT Language ID (LCID) of the requested language. pip Result POINTER TO Reference to an ITc Async String Result ITc Async String Result pointer. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.1.7 Get Event Class Name Returns the event class name asynchronously. Syntax virtual HRESULT TCOMAPI Get Class Name (DINT n Lang Id, ITc Async String Result pip Result) Parameter Name Type Description n Lang Id DINT Language ID (LCID) of the requested language. pip Result POINTER TO Reference to an ITc Async String Result ITc Async String Result pointer. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. TE1000 Version: 1.11.3 143

## Page 144

C++ API 7.1.2 ITc Message This interface represents a message from the Twin CAT 3 Event Logger. Syntax TCOM_DECL_INTERFACE("6474ED2C-E483-454E-A67D-233E6D337C08", ITc Message) Methods Name Description Set Json Attribute [} 144] Sets the JSON attribute. Get Arguments [} 144] Returns the interface pointer for the arguments. Send [} 144] Sends the message. 7.1.2.1 Set Json Attribute Sets the JSON attribute. Syntax virtual HRESULT TCOMAPI Set Json Attribute (STINRG s Json Attribute) Parameter Name Type Description s Json Attribute STRING JSON string Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.2.2 Get Arguments Returns the interface pointer for the arguments. Syntax virtual HRESULT TCOMAPI Get Arguments (ITc Arguments pip Arguments) Parameter Name Type Description pip Arguments POINTER to ITc Arguments Reference to the ITc Arguments interface Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.2.3 Send Sends the message. 144 Version: 1.11.3 TE1000

## Page 145

C++ API Syntax virtual HRESULT TCOMAPI Send (ULINT time Stamp) Parameter Name Type Description time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.3 ITc Alarm This interface represents an alarm from the Twin CAT 3 Event Logger. Syntax TCOM_DECL_INTERFACE("EC6D4FF7-5805-4DDB-A316-27894E77D644", ITc Alarm) Methods Name Description Set Json Attribute [} 145] Sets the JSON attribute. Get Arguments [} 146] Returns the interface pointer for the arguments. Get Is Raised [} 146] Returns TRUE if the alarm is in the raised state. Raise [} 146] Sets the alarm state to Raised. Clear [} 147] Sets the alarm state to Not Raised. Get Confirmation State [} 147] Returns the confirmation state. Confirm [} 147] Sets the alarm state to Confirmed. 7.1.3.1 Set Json Attribute Sets the Json attribute. Syntax virtual HRESULT TCOMAPI Set Json Attribute (STRING s Json Attribute) Parameter Name Type Description s Json Attribute STRING JSON string Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. TE1000 Version: 1.11.3 145

## Page 146

C++ API 7.1.3.2 Get Arguments Returns the interface pointer for the arguments. Syntax virtual HRESULT TCOMAPI Get Arguments (ITc Arguments pip Arguments) Parameter Name Type Description pip Arguments POINTER to ITc Arguments Reference to the ITc Arguments interface Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.3.3 Get Is Raised Returns TRUE in the parameter bls Raised if the alarm is in the Raised state. Syntax virtual HRESULT TCOMAPI Get Is Raised (BOOL32 b Is Raised) Parameter Name Type Description b Is Raised REFERENCE TO BOOL32 Reference to the state. Returns TRUE if the alarm is in the raised state. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.3.4 Raise Sets the alarm state [} 14] to Raised. If the alarm requires mandatory confirmation, the confirmation state is additionally set to Wait For Confirmation. Syntax virtual HRESULT TCOMAPI Raise (ULINT time Stamp) Parameter Name Type Description time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). 146 Version: 1.11.3 TE1000

## Page 147

C++ API Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.3.5 Clear Sets the alarm state [} 14] to Not Raised. Syntax virtual HRESULT TCOMAPI Clear (ULINT time Stamp, BOOL32 b Reset Confirmation) Parameter Name Type Description time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). b Reset Confirmation BOOL32 If TRUE and the confirmation state is Wait For Confirmation, the confirmation state is set to Reset. Otherwise the confirmation state is not changed. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.3.6 Get Confirmation State Returns the confirmation state [} 14]. Syntax virtual HRESULT TCOMAPI Get Confirmation State (… state) Parameter Name Type Description state REFERENCE TO Returns the confirmation state. Tc Event Confirmation State Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.3.7 Confirm Sets the confirmation state [} 14] of Waiting For Confirmation to Confirmed. TE1000 Version: 1.11.3 147

## Page 148

C++ API Syntax virtual HRESULT TCOMAPI Confirm (ULINT time Stamp) Parameter Name Type Description time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4 ITc Event Logger This interface represents the Twin CAT 3 Event Logger itself. Syntax TCOM_DECL_INTERFACE("B2D5D4E2-07F6-44F4-A292-92CA8035AA86", ITc Event Logger) Required includes: #include "Tc Router Interfaces.h" #include "Tc Event Logger Interfaces.h" Methods Name Description Create Message [} 148] Creates an instance that implements ITc Message. Create Alarm [} 149] Creates an instance that implements ITc Alarm. Get Alarm [} 149] Returns the pointer to an existing alarm. Is Alarm Raised [} 150] Queries whether an alarm is in the Raised state. Confirm All Alarms [} 150] Calls Confirm() for all alarms with the confirmation state Wait For Confirmation. Clear All Alarms [} 151] Calls Clear() for all alarms in the Raised state. Send Tc Message [} 151] Sends a message. Add Message Listener [} 152] Adds a message listener. Remove Message Listener [} 152] Removes a message listener. Notify Message Listener [} 153] Processes a queue for a message listener. Add Alarm Listener [} 153] Adds an alarm listener. Remove Alarm Listener [} 153] Removes an alarm listener. Notify Alarm Listener [} 154] Processes a queue for an alarm listener. Get Event Text [} 154] Returns a text for an event. Get Event Class Name [} 155] Returns the class name for an event. Create Arguments [} 155] Creates an instance that implements ITc Arguments. 7.1.4.1 Create Message Creates an instance that implements ITc Message. 148 Version: 1.11.3 TE1000

## Page 149

C++ API Syntax virtual HRESULT TCOMAPI Create Message (GUID event Class, UDINT event Id, GUID severit, ITc Source Info i p Source Info, ITc Message pip Message) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. event Id REFERENCE TO UDINT Reference to the ID of the event. severity REFERENCE TO Tc Event Severity Reference to the severity of an event. ip Source Info ITc Source Info Pointer to the ITc Source Info interface. pip Message ITc Message [} 144] Pointer to an ITc Message pointer. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.2 Create Alarm Creates an instance that implements ITc Alarm. Syntax virtual HRESULT TCOMAPI Create Alarm (GUID event Class, UDINT event Id, GUID severity, BOOL32 b With Conf irmation, ITc Source Info ip Source Info, ITc Alarm pip Alarm) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. event Id REFERENCE TO UDINT Reference to the ID of the event. severity REFERENCE TO Tc Event Severity Reference to the severity of an event. b With Confirmation BOOL32 Defines whether the alarm requires mandatory confirmation. ip Source Info ITc Source Info Pointer to the ITc Source Info interface. pip Alarm ITc Alarm [} 145] Pointer to an ITc Alarm pointer. Return value Type Description HRESULT Returns S_OK if a new alarm was successfully created. Returns ERROR_ALREADY_EXISTS if the alarm already exists. In case of error an HRESULT is returned as the error code. 7.1.4.3 Get Alarm Returns an interface pointer to an existing instance. TE1000 Version: 1.11.3 149

## Page 150

C++ API Syntax virtual HRESULT TCOMAPI Get Alarm (GUID event Class, UDINT event Id, ITc Source Info ip Source Info, ITc Ala rm pip Alarm) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. event Id REFERENCE TO UDINT Reference to the ID of the event. ip Source Info ITc Source Info Pointer to the ITc Source Info interface. pip Alarm ITc Alarm [} 145] Pointer to an ITc Alarm pointer. Return value Type Description HRESULT Returns ADS_E_NOTFOUND if no instance was found. Returns S_OK if everything was successful, otherwise an HRESULT as the error code. 7.1.4.4 Is Alarm Raised Queries whether an alarm is in the Raised state. Syntax virtual HRESULT TCOMAPI Is Alarm Raised (GUID event Class, UDINT event Id, BOOL32 b Is Raised, ITc Source In fo ip Source Info) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. event Id REFERENCE TO UDINT Reference to the ID of the event. b Is Raised REFERENCE TO BOOL32 Reference to the state. Returns TRUE if the alarm is in the raised state. ip Source Info ITc Source Info Pointer to the ITc Source Info interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.5 Confirm All Alarms Calls Confirm() for all alarms with the confirmation state Wait For Confirmation. Syntax virtual HRESULT TCOMAPI Confirm All Alarms (ULINT time Stamp) 150 Version: 1.11.3 TE1000

## Page 151

C++ API Parameter Name Type Description time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.6 Clear All Alarms Calls Clear() for all alarms in the Raised state. Syntax virtual HRESULT TCOMAPI Clear All Alarms (ULINT timestamp, BOOL32 b Reset Confirmation) Parameter Name Type Description time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). b Reset Confirmation BOOL32 If TRUE and the confirmation state is Wait For Confirmation, the confirmation state is set to Reset. Otherwise the confirmation state is not changed. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.7 Send Tc Message Sends a message. Syntax virtual HRESULT TCOMAPI Send Tc Message (GUID event Class, UDINT event Id, GUID severity, ITc Source Info ip Source Info, ULINT time Stamp, ITc Arguments ip Serialized Arguments) TE1000 Version: 1.11.3 151

## Page 152

C++ API Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. event Id REFERENCE TO UDINT Reference to the ID of the event. severity REFERENCE TO Tc Event Severity Reference to the severity of an event. ip Source Info ITc Source Info Pointer to the ITc Source Info interface. time Stamp ULINT > 0: External time stamp in 100 nanoseconds since January 1st, 1601 (UTC). ip Serialized Arguments ITc Arguments Pointer to the ITc Arguments interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.8 Add Message Listener Adds a message listener. Syntax virtual HRESULT TCOMAPI Add Message Listener (ITc Message Listener ip Listener, ITc Event Filter Config pip F ilter Config) Parameter Name Type Description ip Listener ITc Message Listener Pointer to the ITc Message Listener interface. pip Filter Config ITc Event Filter Config Pointer to an ITc Event Filter Config pointer. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.9 Remove Message Listener Removes a message listener. Syntax virtual HRESULT TCOMAPI Remove Message Listener (ITc Message Listener ip Listener) Parameter Name Type Description ip Listener ITc Message Listener Pointer to the ITc Message Listener interface. 152 Version: 1.11.3 TE1000

## Page 153

C++ API Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.10 Notify Message Listener Processes a queue for the message listener. Syntax virtual HRESULT TCOMAPI Notify Message Listener (ITc Message Listener ip Listener) Parameter Name Type Description ip Listener ITc Message Listener Pointer to the ITc Message Listener interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.11 Add Alarm Listener Adds an alarm listener. Syntax virtual HRESULT TCOMAPI Add Alarm Listener (ITc Message Listener ip Listener, ITc Event Filter Config pip Fil ter Config) Parameter Name Type Description ip Listener ITc Message Listener Pointer to the ITc Message Listener interface. pip Filter Config ITc Event Filter Config Pointer to an ITc Event Filter Config pointer. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.12 Remove Alarm Listener Removes an alarm listener. Syntax virtual HRESULT TCOMAPI Remove Alarm Listener (ITc Message Listener ip Listener) TE1000 Version: 1.11.3 153

## Page 154

C++ API Parameter Name Type Description ip Listener ITc Message Listener Pointer to the ITc Message Listener interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.13 Notify Alarm Listener Processes a queue for an alarm listener. Syntax virtual HRESULT TCOMAPI Notify Message Listener (ITc Message Listener ip Listener) Parameter Name Type Description ip Listener ITc Message Listener Pointer to the ITc Message Listener interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.14 Get Event Text Returns a text for an event. Syntax virtual HRESULT TCOMAPI Get Event Text (GUID event Class, UDINT event Id, ITc Source Info ip Source Info, IT c Arguments ip Arguments, DINT n Lang Id, ITc Async String Result pip Result) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. event Id REFERENCE TO UDINT Reference to the ID of the event. ip Source Info ITc Source Info Pointer to the ITc Source Info interface. ip Arguments ITc Arguments Pointer to the ITc Arguments interface. n Lang Id DINT Language ID (LCID) of the requested language. pip Result POINTER TO Reference to an ITc Async String Result ITc Async String Result pointer. 154 Version: 1.11.3 TE1000

## Page 155

C++ API Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.15 Get Event Class Name Returns the class name for an event. Syntax virtual HRESULT TCOMAPI Get Event Class Name (GUID event Class, DINT n Lang Id, ITc Async String Result pip Re sult) Parameter Name Type Description event Class REFERENCE TO GUID Reference to the GUID of the event class. n Lang Id DINT Language ID (LCID) of the requested language. pip Result POINTER TO Reference to an ITc Async String Result ITc Async String Result pointer. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.1.4.16 Create Arguments Creates an instance that implements ITc Arguments. Syntax virtual HRESULT TCOMAPI Create Arguments (ITc Arguments ip Arguments) Parameter Name Type Description ip Arguments ITc Arguments Pointer to the ITc Arguments interface. Return value Type Description HRESULT Returns S_OK if the method call was successful, otherwise an HRESULT as the error code. 7.2 Data types 7.2.1 Tc Event Entry Defines an event by means of event class, event ID and severity. TE1000 Version: 1.11.3 155

## Page 156

C++ API Syntax Definition: typedef struct { GUID uuid Event Class; UDINT n Event Id; Tc Event Severity e Severity; }Tc Event Entry; Parameter Name Type Description uuid Event Class GUID GUID of the event class. n Event Id UDINT ID of the event. e Severity Tc Event Severity Event severity defines the severity of the event, 7.2.2 Tc Event Severity Defines the severity of the event. Syntax Definition: typedef enum { Verbose = 0, Info = 1, Warning = 2, Error = 3, Critical = 4 }Tc Event Severity; 7.2.3 Tc Event Confirmation State Defines the confirmation state of an alarm. Syntax Definition: typedef enum { Not Supported = 0, Not Required = 1, Wait For Confirmation = 2, Confirmed = 3, Reset = 4 }Tc Event Confirmation State; 156 Version: 1.11.3 TE1000

## Page 157

User mode API 8 User mode API The Event Logger provides an interface to both send messages and receive sent events from user mode programs. Beckhoff. Twin CAT. Tc Event Logger Ads Proxy. Net from Nu Get.org The API is available on Nu Get.org via the package Beckhoff. Twin CAT. Tc Event Logger Ads Proxy. Net for implementation into projects. To get started easily, you will find there sample code in the README file, which only needs to be copied into a . NET project. COM based interface is replaced The COM based interface, which is described here before, is supported up to Twin CAT 3.1 4024. Due to the technology used, it cannot be offered under Twin CAT/BSD. The API provided on Nu Get.org is the successor and provides easy porting for customer applications through an equivalent API. 8.1 Classes 8.1.1 Tc Event Logger This class represents the connection to a Twin CAT 3 Eventlogger. Syntax public class: ITc Event Logger2, _ITc Event Logger Events Constructor Initializes a new instance of the Tc Event Logger class. public Tc Event Logger Class(); Call: Tc Event Logger logger : new Tc Event Logger(); Interfaces Name Description ITc Event Logger2 [} 182] Interface for sending commands to the Event Logger. _ITc Event Logger Events [} 166] This interface provides the messages for occurring events. TE1000 Version: 1.11.3 157

## Page 158

User mode API Methods Name Modifier Return type Definition loca- Description tion Clear All Alarms public virtual void ITc Event Logger/ Calls Clear() for all alarms in the [} 182] ITc Event Logger2 "Raised" state. [} 182] Clear Logged Events public virtual void ITc Event Logger/ Calls Clear() for all events that are [} 183] ITc Event Logger2 currently in the "Raised" state. [} 182] Confirm All Alarms public virtual void ITc Event Logger/ Calls Confirm() for all alarms with [} 183] ITc Event Logger2 the confirmation state "Wait For Confirmation". [} 182] Connect [} 183] public virtual void ITc Event Logger/ Connects to the Event Logger of the ITc Event Logger2 Twin CAT system on a given system. [} 182] Disconnect [} 183] public virtual void ITc Event Logger/ Cancels the connection to an ITc Event Logger2 Event Logger of the Twin CAT system. [} 182] Get Event Class Name public virtual string ITc Event Logger/ Returns the class name for an [} 183] ITc Event Logger2 event. [} 182] Get Logged Events public virtual Tc Event Logger ITc Event Logger/ Queries the events located in the [} 183] Ads Proxy Lib. T ITc Event Logger2 cache. c Logged Event [} 182] Collection ITc Event Logger2_Sen public virtual void ITc Event Logger2 Sends a message. d Tc Message [} 161] [} 182] events Name Return type Definition location Description Alarm Cleared _ITc Event Logger _ITc Event Logger Eve Called if an alarm changes to the "Not Events_Alarm Cle Raised" state. nts [} 166] ared Event Handler Alarm Confirmed _ITc Event Logger _ITc Event Logger Eve Called if an alarm changes to the Events_Alarm Con "Confirmed" state. nts [} 166] firmed Event Handl er Alarm Raised _ITc Event Logger _ITc Event Logger Eve Called if an alarm changes to the "Raised" Events_Alarm Rai state. nts [} 166] sed Event Handler Message Sent _ITc Event Logger _ITc Event Logger Eve Called when a message has been sent. Events_Message nts [} 166] Sent Event Handle r 158 Version: 1.11.3 TE1000

## Page 159

User mode API Properties Name Modifier Type Access Definition loca- Description tion Active Alarms [} 184] public virtual Tc Alarm Collect get ITc Event Logger/ Returns a collection with ion ITc Event Logger2 all currently active alarms. [} 182] Is Connected [} 184] public virtual bool get ITc Event Logger/ Represents the ITc Event Logger2 connection that was established by means of [} 182] Connect. Should be checked regularly. 8.1.1.1 ITc Event Logger_Clear All Alarms This method sets all alarms that are in the "Raised" state to "Not Raised". Syntax public virtual void ITc Event Logger_Clear All Alarms([bool b Reset Confirmation = True]) Parameter Name Type Description b Reset Confirmation bool Determines whether the confirmations for alarms should be triggered. 8.1.1.2 ITc Event Logger_Clear Logged Events This method clears the events cache. The current alarm states are not changed by this. Syntax public virtual void ITc Event Logger_Clear Logged Events() 8.1.1.3 ITc Event Logger_Confirm All Alarms This method confirms all alarms that have to be confirmed, i.e. those that are in the "Wait For Confirmation" state. Syntax public virtual void ITc Event Logger_Confirm All Alarms() 8.1.1.4 ITc Event Logger_Connect This method connects the object with an Event Logger on a runtime system on the basis of the Ams Net Id. Syntax public virtual void ITc Event Logger_Connect([string Address = localhost]) Parameter Name Type Description Address string Defines the Ams Net Id. TE1000 Version: 1.11.3 159

## Page 160

User mode API 8.1.1.5 ITc Event Logger_Disconnect This method disconnects the object from the Event Logger. Syntax public virtual void ITc Event Logger_Disconnect() 8.1.1.6 ITc Event Logger_Get Event Class Name This method returns the Event Class name that matches a given Event Class GUID. Syntax public virtual string ITc Event Logger_Get Event Class Name(System. Guid Event Class, int n Lang Id) Parameter Name Type Description Event Class System. Guid GUID of the event class. lang Id int Lang ID in which the name is to be returned. Return value Name Type Description ITc Event Logger_Get Event Class Na string Name of the Event Class. me 8.1.1.7 ITc Event Logger_Get Logged Events This method returns a collection of stored latest events. Syntax public virtual Tc Logged Event Collection ITc Event Logger_Get Logged Events(uint n Max Entiries) Parameter Name Type Description n Max Entiries uint Maximum number of events to be returned. Return value Name Type Description ITc Event Logger_Get Logged Events Tc Logged Event Collection A collection of the latest events. 8.1.1.8 ITc Event Logger_Get Text This method returns the text of an event. Syntax public virtual string ITc Event Logger_Get Text(System. Guid Event Class, uint Event Id, uint object Id, Tc Event Logger Ads Proxy Lib. Tc Event Arguments Info p Arg Info, System. Int Ptr p Arg Data, int n Lang Id) 160 Version: 1.11.3 TE1000

## Page 161

User mode API Parameter Name Type Description Event Class System. Guid GUID of the event class. Event Id uint ID of the event object Id uint p Arg Info Tc Event Logger Ads Proxy Lib. Tc Eve nt Arguments Info p Arg Data System. Int Ptr lang Id int Lang ID in which the name is to be returned. Return value Name Type Description ITc Event Logger_Get Text string Text of the event. 8.1.1.9 ITc Event Logger_Active Alarms This property box returns a collection of the currently active alarms (active state is "Raised" or "Waiting For Confirmation"). Syntax public virtual Tc Event Logger Ads Proxy Lib. Tc Alarm Collection ITc Event Logger_Active Alarms 8.1.1.10 ITc Event Logger_Is Connected This property indicates whether the Tc Event Logger object is currently connected to a target system. This should be checked regularly in order to be able to react to a loss of connection. Syntax public virtual bool ITc Event Logger_Is Connected 8.1.1.11 ITc Event Logger2_Send Tc Message This method sends a message. Syntax public virtual void Send Tc Message(System. Guid Event Class, uint Event Id, Tc Event Logger Ads Proxy Lib. Severity Level Enum severity, string Json Attribute, Tc Event Logger Ads Proxy Lib. Tc Source Info p Source Info, Tc Event Logger Ads Proxy Lib. Tc Arguments p Arguments) Parameter Name Type Description Event Class System. Guid GUID of the event classes Event Id uint ID of the event Severity Tc Event Logger Ads Proxy Lib. Severit Severity of the event y Level Enum [} 196] Json Attribute string JSON attribute p Source Info Tc Event Logger Ads Proxy Lib. Tc Sou Reference to the source rce Info information p Arguments Tc Arguments Reference to the arguments. TE1000 Version: 1.11.3 161

## Page 162

User mode API 8.1.2 Tc Arguments Arguments of an event can be defined with this class. The ITc Arguments interface is implemented for this. Syntax public class: ITc Arguments Constructor Initializes a new instance of the class Tc Arguments. public Tc Arguments(); Call: Tc Arguments args : new Tc Arguments(); Interfaces Name Description ITc Arguments Interface for describing the arguments. Methods Name Modifier Return type Definition location Description Add [} 162] public virtual void ITc Event Logger/ Adds an argument. ITc Arguments Add V [} 163] public virtual void ITc Event Logger/ Adds an array of ITc Arguments arguments. Clear [} 163] public virtual void ITc Event Logger/ Deletes all ITc Arguments arguments. Get Enumerator public virtual System. Collections. I ITc Event Logger/ Returns an Enumerator ITc Arguments enumeration of the [} 163] arguments. Remove [} 163] public virtual void ITc Event Logger/ Deletes an ITc Arguments argument. Set [} 177] public virtual void ITc Event Logger/ Sets an argument. ITc Arguments Properties Name Modifier Type Access Definition loca- Description tion Count [} 164] public virtual int get ITc Event Logger/ number of ITc Arguments arguments. this [uint] public virtual ITc Logged Event get ITc Event Logger/ The event to ITc Arguments which the arguments relate. 8.1.2.1 Add This method adds an argument. Syntax public virtual void Add(object Item) 162 Version: 1.11.3 TE1000

## Page 163

User mode API Parameter Name Type Description Item object The argument to be added. 8.1.2.2 Add V This method adds an array of arguments. Syntax public virtual void Add V(params object[] args) Parameter Name Type Description args params object[] Array of the arguments to be added. 8.1.2.3 Clear This method deletes all arguments. Syntax public virtual void Clear() 8.1.2.4 Get Enumerator This method returns an enumeration of the arguments. Syntax public virtual System. Collections. IEnumerator Get Enumerator() Return value Name Type Description Get Enumerator System. Collections. IEnumerator Enumeration of the arguments. 8.1.2.5 Remove This method deletes an argument. Syntax public virtual void Remove(uint Index) Parameter Name Type Description Index uint Index of the arguments to be deleted. 8.1.2.6 Set This method sets an argument. Syntax public virtual void Set(uint Index, object Item) TE1000 Version: 1.11.3 163

## Page 164

User mode API Parameter Name Type Description Index uint Index of the argument to be set. Item object The new argument. 8.1.2.7 Count This property returns the number. Syntax public virtual int Count 8.1.2.8 this [uint] This property is the event to which the arguments refer. Syntax public virtual Tc Event Logger Ads Proxy Lib. Tc Argument Entry this[uint Index] 8.1.3 Tc Source Info This class describes the source information of an event. Syntax public class: ITc Source Info Constructor Initializes a new instance of the class Tc Source Info. public Tc Arguments(); Call: Tc Source Info souce Info: new Source Info(); Methods Name Modifier Return type Definition location Description Is Source Info Type Sup public virtual bool ITc Event Logger/ Query option for the ITc Source Info type of source ported [} 165] information. Properties Name Modifier Type Access Definition loca- Description tion Count [} 165] public virtual int get ITc Event Logger/ Number of ITc Source Info Source Info types. Guid [} 165] public virtual System. Guid get, set ITc Event Logger/ GUID of the ITc Source Info source. Id [} 165] public virtual uint get, set ITc Event Logger/ Id of the source. ITc Source Info Name [} 166] public virtual string get, set ITc Event Logger/ Name of the ITc Source Info source. 164 Version: 1.11.3 TE1000

## Page 165

User mode API 8.1.3.1 Get Data This method returns the data for a source. Syntax public virtual void Get Data(uint Index, out Tc Event Logger Ads Proxy Lib. Tc Source Info Type Enum p Info Type, System. Int Ptr p Data, out uint cb Data) Parameter Name Type Description Index uint Index of the source. p Info Type Tc Event Logger Ads Proxy Lib. Tc Sour Reference to the type information. ce Info Type Enum [} 196] p Data System. Int Ptr Reference to the data. cb Data uint Length of the data. 8.1.3.2 Is Source Info Type Supported This method can be used to check whether the source information type has been defined. Syntax public virtual bool Is Source Info Type Supported(Tc Source Info Type Enum info Type) Parameter Name Type Description info Type Tc Source Info Type Enum [} 196] Query type of source Return value Name Type Description Is Source Info Type Supported bool Information as to whether supported. 8.1.3.3 Count This property returns the number. Syntax public virtual int Count 8.1.3.4 Guid This property returns the GUID of the source. Syntax public virtual System. Guid Guid 8.1.3.5 Id This property returns the Id. Syntax public virtual uint Id TE1000 Version: 1.11.3 165

## Page 166

User mode API 8.1.3.6 Name This property returns the name. Syntax public virtual string Name 8.2 Interfaces 8.2.1 _ITc Event Logger Events This interface provides the messages for occurring events. Syntax public interface _ITc Event Logger Events Methods Name Modifier Return type Description Alarm Cleared [} 166] public virtual void Called if an alarm changes to the "Not Raised" state. Alarm Confirmed [} 166] public virtual void Called if an alarm changes to the "Confirmed" state. Alarm Raised [} 167] public virtual void Called if an alarm changes to the "Raised" state. Message Send [} 167] public virtual void Called when a message has been sent. 8.2.1.1 Alarm Cleared Called if an alarm changes to the "Not Raised" state. Syntax public virtual void Alarm Cleared(Tc Alarm evt Obj, bool b Remove) Parameter Name Type Description evt Obj Tc Alarm The alarm b Remove bool TRUE = the alarm is in the "Not Raised" state and not in the "Wait for Confirmation" state. FALSE = the alarm is still waiting for a confirmation. 8.2.1.2 Alarm Confirmed Called if an alarm changes to the "Confirmed" state. Syntax public virtual void Alarm Confirmed(Tc Alarm evt Obj, bool b Remove) 166 Version: 1.11.3 TE1000

## Page 167

User mode API Parameter Name Type Description evt Obj Tc Alarm The alarm b Remove bool TRUE if the alarm is not in the "Raised" state. FALSE if the alarm is in the "Raised" state. 8.2.1.3 Alarm Raised Called if an alarm changes to the "Raised" state. Syntax public virtual void Alarm Raised(Tc Alarm evt Obj) Parameter Name Type Description evt Obj Tc Alarm The alarm 8.2.1.4 Message Send Called when a message has been sent. Syntax void Message Sent(Tc Message evt Obj) Parameter Name Type Description evt Obj Tc Message The message 8.2.2 ITc Alarm3 This interface represents an alarm. Syntax public interface ITc Alarm3 Methods Name Modifier Return type Description Confirm [} 168] public virtual void Confirms the alarm. Get Cause Remedy [} 170] Public virtual Tc Cause Remedy Collectio Returns information on n the cause and remedy (if these are defined). Get Details [} 171] Public virtual Tc Detail Collection Returns the details. Get Event Class Name public virtual string Returns the event class name. [} 169] Get Text [} 170] public virtual string Returns the event text, including the arguments. Is Source Info Type Supporte public virtual bool Query option for the type of source information. d [} 170] TE1000 Version: 1.11.3 167

## Page 168

User mode API Properties Name Modifier Type Access Description Confirmation State public virtual Confirmation State En get Returns the [} 170] um Confirmation State [} 195]. Event Class [} 171] public virtual System. Guid get Returns the Event Class GUID. Event Id [} 171] public virtual uint get Returns the event ID. Event Type [} 171] public virtual Event Type Enum get Returns the type of the event [} 195]. File Time Cleared public virtual long get Timestamp when the alarm was changed [} 171] to the Cleared state. File Time Confirmed public virtual long get Timestamp when the alarm was [} 171] confirmed. File Time Raised public virtual long get Timestamp when the alarm was changed [} 172] to the Raised state. Is Raised [} 172] public virtual bool get Indicates whether the alarm has been changed to the Raised state. Json Attribute [} 172] public virtual string get The JSON attribute. Severity Level [} 172] public virtual Severity Level Enum get The Severity Level [} 196]. Source Guid [} 172] public virtual System. Guid get Returns the GUID of the source. Source Id [} 172] public virtual uint get Returns the ID of the source. Source Name [} 172] public virtual string get Returns the name of the source. Time Cleared [} 172] public virtual System. Date Time get Timestamp when the alarm was changed to the Cleared state. Time Confirmed public virtual System. Date Time get Timestamp when the alarm was [} 173] confirmed. Time Raised [} 173] public virtual Sytem. Date Time get Timestamp when the alarm was changed to the Raised state. 8.2.2.1 Confirm This method confirms the alarm. Syntax public virtual void Confirm() 168 Version: 1.11.3 TE1000

## Page 169

User mode API 8.2.2.2 Get Argument Data For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the data of the arguments. Syntax public virtual void Get Argument Data(ref System. Int Ptr pp Arg Data, uint size) Parameter Name Type Description pp Arg Data ref System. Int Ptr Reference to the data. size Uint Size 8.2.2.3 Get Argument Info For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the (type) information for the arguments. Syntax public virtual void Get Argument Info(ref Tc Event Arguments Info p Arg Info) Parameter Name Type Description p Arg Info ref Tc Event Arguments Info Reference to the information provided. 8.2.2.4 Get Event Class Name This method returns the Event Class name. Syntax public virtual string Get Event Class Name(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Event Class Name string Names of the Event Class TE1000 Version: 1.11.3 169

## Page 170

User mode API 8.2.2.5 Get Text This method returns the event text, including the arguments. Syntax public virtual string Get Text(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Text string Event text 8.2.2.6 Is Source Info Type Supported This method can be used to check whether the source information type has been defined. Syntax public virtual bool Is Source Info Type Supported(Tc Source Info Type Enum info Type) Parameter Name Type Description info Type Tc Source Info Type Enum [} 196] Query type of source Return value Name Type Description Is Source Info Type Supported bool Information as to whether supported. 8.2.2.7 Get Cause Remedy This method returns the cause/remedy information, if this has been defined. Syntax public virtual Tc Cause Remedy Collection Get Cause Remedy(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language. Return value Name Type Description Get Cause Remedy Tc Cause Remedy Collection Collection of the cause/remedy information. 8.2.2.8 Confirmation State This property returns the Confirmation State. 170 Version: 1.11.3 TE1000

## Page 171

User mode API Syntax Public virtual Confirmation State Enum Confirmation State 8.2.2.9 Get Details This method returns the details. Syntax public virtual Tc Detail Collection Get Details(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Details Tc Detail Collection Collection of the details 8.2.2.10 Event Class This property returns the Event Class GUID. Syntax public virtual System. Guid Event Class 8.2.2.11 Event Id This property returns the event ID. Syntax public virtual uint Event Id 8.2.2.12 Event Type This property returns the type of the event. Syntax public virtual Event Type Enum Event Type 8.2.2.13 File Time Cleared This property returns the timestamp when the alarm was changed to the Cleared state. Syntax public virtual long File Time Cleared 8.2.2.14 File Time Confirmed This property returns the timestamp when the alarm was changed to the Confirmed state. Syntax public virtual long File Time Confirmed TE1000 Version: 1.11.3 171

## Page 172

User mode API 8.2.2.15 File Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual long File Time Raised 8.2.2.16 Is Raised This property indicates whether the alarm has been changed to the Raised state. Syntax public virtual bool Is Raised 8.2.2.17 Json Attribute This property returns the JSON attribute. Syntax public virtual string Json Attribute 8.2.2.18 Severity Level This property returns the Severity level. Syntax public virtual Tc Event Logger Ads Proxy Lib. Severity Level Enum Severity Level 8.2.2.19 Source Guid This property returns the GUID of the source. Syntax public virtual System. Guid Source Guid 8.2.2.20 Source Id This property returns the ID of the source. Syntax public virtual uint Source Id 8.2.2.21 Source Name This property returns the name of the source. Syntax public virtual string Source Name 8.2.2.22 Time Cleared This property returns the timestamp when the alarm was changed to the Cleared state. Syntax public virtual System. Date Time Time Cleared 172 Version: 1.11.3 TE1000

## Page 173

User mode API 8.2.2.23 Time Confirmed This property returns the timestamp when the alarm was changed to the Confirmed state. Syntax public virtual System. Date Time Time Confirmed 8.2.2.24 Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual System. Date Time Time Raised 8.2.3 ITc Argument Entry This interface describes an argument. Syntax public interface ITc Argument Entry Methods Name Modifier Return type Description Get [} 173] public virtual dynamic Returns the value as a dynamic type. Get Boolean [} 174] public virtual bool Returns the value as Boolean. Get Double [} 174] public virtual void Returns the value as Double. Get Float [} 174] public virtual float Returns the value as Float. Get Int16 [} 175] public virtual short Returns the value as Short. Get Int32 [} 175] public virtual int Returns the value as Int. Get Int64 [} 175] public virtual long Returns the value as Long. Get Int8 [} 175] public virtual sbyte Returns the value as SByte. Get String [} 175] public virtual string Returns the value as String. Get UInt16 [} 176] public virtual ushort Returns the value as UShort. Get UInt32 [} 176] public virtual uint Returns the value as UInt. Get UInt64 [} 176] public virtual ulong Returns the value as ULong. Get UInt8 [} 176] public virtual byte Returns the value as Byte. Set [} 177] public virtual void Sets the value. 8.2.3.1 Get This method returns the value as a dynamic type. TE1000 Version: 1.11.3 173

## Page 174

User mode API Syntax public virtual Object Get() Return value Name Type Description Get Object Return is an object of the type corresponding to the argument. 8.2.3.2 Get Boolean This method returns the value as Boolean. Syntax public virtual bool Get Boolean() Return value Name Type Description Get Boolean bool Return 8.2.3.3 Get Data This method returns the value as a reference to data. Syntax public virtual void Get Data(out Tc Event Argument Type Enum p Info Type, System. Int Ptr p Data, out uint cb Data) Parameter Name Type Description p Info Type Tc Event Argument Type Enum [} 196] Reference to the type of data. p Data System. Int Ptr Reference to the data. cb Data uint Length of the data. 8.2.3.4 Get Double This method returns the value as Double. Syntax public virtual double Get Double Return value Name Type Description Get Double double Return 8.2.3.5 Get Float This method returns the value as Float. Syntax public virtual float Get Float() 174 Version: 1.11.3 TE1000

## Page 175

User mode API Return value Name Type Description Get Float float Return 8.2.3.6 Get Int16 This method returns the value as Short. Syntax public virtual short Get Int16() Return value Name Type Description Get Int16 short Return 8.2.3.7 Get Int32 This method returns the value as Int. Syntax public virtual int Get Int32() Return value Name Type Description Get Int32 int Return 8.2.3.8 Get Int64 This method returns the value as Long. Syntax public virtual long Get Int64() Return value Name Type Description Get Int64 long Return 8.2.3.9 Get Int8 This method returns the value as SByte. Syntax public virtual sbyte Get Int8() Return value Name Type Description Get Int8 sbyte Return 8.2.3.10 Get String This method returns the value as String. TE1000 Version: 1.11.3 175

## Page 176

User mode API Syntax public virtual string Get String() Return value Name Type Description Get String string Return 8.2.3.11 Get UInt16 This method returns the value as UShort. Syntax public virtual ushort Get UInt16() Return value Name Type Description Get UInt16 ushort Return 8.2.3.12 Get UInt32 This method returns the value as UInt. Syntax public virtual uint Get UInt32() Return value Name Type Description Get UInt32 uint Return 8.2.3.13 Get UInt64 This method returns the value as ULong. Syntax public virtual ulong Get UInt64() Return value Name Type Description Get UInt64 ulong Return 8.2.3.14 Get UInt8 This method returns the value as Byte. Syntax public virtual byte Get UInt8() Return value Name Type Description Get UInt8 byte Return 176 Version: 1.11.3 TE1000

## Page 177

User mode API 8.2.3.15 Set This method sets the value. Syntax public virtual void Set(object Item) Parameter Name Type Description Item object New argument. An object of the type corresponding to the argument. 8.2.4 ITc Cause Remedy This interface describes the cause/remedy information for an event. Syntax public interface ITc Cause Remedy Properties Name Modifier Type Access Description Cause [} 177] public virtual string get The cause. Id [} 177] public virtual uint get The ID. Remedy [} 177] public virtual string get The remedy. 8.2.4.1 Cause This property returns the cause. Syntax public virtual string Cause 8.2.4.2 Id This property returns the Id. Syntax public virtual uint Id 8.2.4.3 Remedy This property returns the remedy. Syntax public virtual string Remedy 8.2.5 ITc Detail This interface describes the details of an event. Syntax public interface ITc Detail TE1000 Version: 1.11.3 177

## Page 178

User mode API Properties Name Modifier Type Access Description Comment [} 178] Public virtual string get The comment Name [} 178] public virtual string get The name text [} 178] Public virtual string get The text 8.2.5.1 Comment This property returns the comment on a detail. Syntax public virtual string Comment 8.2.5.2 Name This property returns the name. Syntax public virtual string Name 8.2.5.3 text This property returns the text for a detail. Syntax public virtual string text 8.2.6 ITc Event This interface describes an event. This event can be either a message or an alarm. Syntax public interface ITc Event Methods Name Modifier Return type Description Get Argument Data [} 179] public virtual void Returns the data of the arguments. Get Argument Info [} 179] public virtual void Returns the (type) information for the arguments. Get Event Class Name public virtual string Returns the event class name. [} 180] Get Text [} 180] public virtual string Returns the event text, including the arguments. Is Source Info Type Supporte public virtual bool Query option for the type of source information. d [} 180] 178 Version: 1.11.3 TE1000

## Page 179

User mode API Properties Name Modifier Type Access Description Event Class [} 181] public virtual System. Guid get Returns the Event Class GUID. Event Id [} 181] public virtual uint get Returns the event ID. Event Type [} 181] public virtual Event Type Enum get Returns the type of the event [} 195]. File Time Raised public virtual long get Timestamp when the event was sent. [} 181] Severity Level [} 181] public virtual Severity Level Enum get The Severity Level [} 196]. Source Guid [} 181] public virtual System. Guid get Returns the GUID of the source. Source Id [} 181] public virtual uint get Returns the ID of the source. Source Name [} 181] public virtual string get Returns the name of the source. Time Raised [} 182] public virtual System. Date Time get Timestamp when the event was sent. 8.2.6.1 Get Argument Data For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the data of the arguments. Syntax public virtual void Get Argument Data(ref System. Int Ptr pp Arg Data, uint size) Parameter Name Type Description pp Arg Data ref System. Int Ptr Reference to the data. size Uint Size 8.2.6.2 Get Argument Info For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the (type) information for the arguments. Syntax public virtual void Get Argument Info(ref Tc Event Arguments Info p Arg Info) TE1000 Version: 1.11.3 179

## Page 180

User mode API Parameter Name Type Description p Arg Info ref Tc Event Arguments Info Reference to the information provided. 8.2.6.3 Get Event Class Name This method returns the Event Class name. Syntax public virtual string Get Event Class Name(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Event Class Name string Names of the Event Class 8.2.6.4 Get Text This method returns the event text, including the arguments. Syntax public virtual string Get Text(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Text string Event text 8.2.6.5 Is Source Info Type Supported This method can be used to check whether the source information type has been defined. Syntax public virtual bool Is Source Info Type Supported(Tc Source Info Type Enum info Type) Parameter Name Type Description info Type Tc Source Info Type Enum [} 196] Query type of source Return value Name Type Description Is Source Info Type Supported bool Information as to whether supported. 180 Version: 1.11.3 TE1000

## Page 181

User mode API 8.2.6.6 Event Class This property returns the Event Class GUID. Syntax public virtual System. Guid Event Class 8.2.6.7 Event Id This property returns the event ID. Syntax public virtual uint Event Id 8.2.6.8 Event Type This property returns the type of the event. Syntax public virtual Event Type Enum Event Type 8.2.6.9 File Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual long File Time Raised 8.2.6.10 Severity Level This property returns the Severity level. Syntax public virtual Tc Event Logger Ads Proxy Lib. Severity Level Enum Severity Level 8.2.6.11 Source Guid This property returns the GUID of the source. Syntax public virtual System. Guid Source Guid 8.2.6.12 Source Id This property returns the ID of the source. Syntax public virtual uint Source Id 8.2.6.13 Source Name This property returns the name of the source. Syntax public virtual string Source Name TE1000 Version: 1.11.3 181

## Page 182

User mode API 8.2.6.14 Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual System. Date Time Time Raised 8.2.7 ITc Event Logger2 Interface for sending commands to the Event Logger. Syntax public interface ITc Event Logger2 Methods Name Modifier Return type Description Clear All Alarms [} 182] public virtual void Calls Clear() for all alarms in the "Raised" state. Clear Logged Events public virtual void Clears the cache. [} 183] Confirm All Alarms [} 183] public virtual void Calls Confirm() for all alarms with the confirmation state "Wait For Confirmation". Connect [} 183] public virtual void Connects to the Event Logger of the Twin CAT system on a given system. Disconnect [} 183] public virtual void Cancels the connection to an Event Logger of the Twin CAT system. Get Event Class Name public virtual string Returns the class name for an event. [} 183] Get Logged Events [} 183] public virtual Tc Logged Event C Queries the events located in the cache. ollection Properties Name Modifier Type Access Description Active Alarms [} 184] public virtual Tc Alarm Collection get Returns a collection with all currently active alarms. Is Connected [} 184] public virtual bool get Represents the connection that was established by means of Connect. Should be checked regularly. 8.2.7.1 Clear All Alarms Calls Clear() for all alarms in the "Raised" state. Syntax public virtual void Clear All Alarms([bool b Reset Confirmation = True]) Parameter Name Type Description b Reset Confirmation bool Indicates whether the alarms should also be changed to the "Confirmed" state. 182 Version: 1.11.3 TE1000

## Page 183

User mode API 8.2.7.2 Clear Logged Events Clears the cache. Syntax Public virtual void Clear Logged Events() 8.2.7.3 Confirm All Alarms Calls Confirm() for all alarms with the confirmation state "Wait For Confirmation". Syntax public virtual void Confirm All Alarms() 8.2.7.4 Connect Connects to the Event Logger of the Twin CAT system on a given system. Syntax public virtual void Connect([string Address = localhost]) Parameter Name Type Description Adress string AMS Net ID 8.2.7.5 Disconnect Cancels the connection to an Event Logger of the Twin CAT system. Syntax public virtual void Disconnect() 8.2.7.6 Get Event Class Name Returns the class name for an event. Syntax public virtual string Get Event Class Name(System. Guid Event Class, int n Lang Id) Parameter Name Type Description lang Id int Lang ID for the language Event Class System. Guid GUID of the event class Return value Name Type Description Get Event Class Name string 8.2.7.7 Get Logged Events Queries the events located in the cache. TE1000 Version: 1.11.3 183

## Page 184

User mode API Syntax public virtual Tc Event Logger Ads Proxy Lib. Tc Logged Event Collection Get Logged Events(uint n Max Entiries) Parameter Name Type Description n Max Entiries uint Number of events to be returned. Return value Name Type Description Get Logged Events Tc Event Logger Ads Proxy Lib. Tc Log ged Event Collection 8.2.7.8 Active Alarms Returns a collection with all currently active alarms. Syntax public virtual Tc Event Logger Ads Proxy Lib. Tc Alarm Collection Active Alarms 8.2.7.9 Is Connected Represents the connection that was established by means of Connect. Should be checked regularly. Syntax public virtual bool Is Connected 8.2.7.10 ITc Event Logger2_Send Tc Message This method sends a message. Syntax public virtual void Send Tc Message(System. Guid Event Class, uint Event Id, Tc Event Logger Ads Proxy Lib. Severity Level Enum severity, string Json Attribute, Tc Event Logger Ads Proxy Lib. Tc Source Info p Source Info, Tc Event Logger Ads Proxy Lib. Tc Arguments p Arguments) Parameter Name Type Description Event Class System. Guid GUID of the event classes Event Id uint ID of the event Severity Tc Event Logger Ads Proxy Lib. Severit Severity of the event y Level Enum [} 196] Json Attribute string JSON attribute p Source Info Tc Event Logger Ads Proxy Lib. Tc Sou Reference to the source rce Info information p Arguments Tc Arguments Reference to the arguments. 8.2.8 ITc Logged Event4 This interface describes a stored event. This event can be either a message or an alarm. Syntax public interface ITc Logged Event4 184 Version: 1.11.3 TE1000

## Page 185

User mode API Methods Name Modifier Return type Description Get Argument Data [} 186] public virtual void Returns the data of the arguments. Get Argument Info [} 187] public virtual void Returns the (type) information for the arguments. Get Cause Remedy [} 187] public virtual Tc Cause Remedy Collectio Returns the cause/ n remedy information. Get Details [} 187] public virtual Tc Detail Collection Returns the details. Get Event Class Name public virtual string Returns the event class name. [} 188] Get Text [} 188] public virtual string Returns the event text, including the arguments. Is Source Info Type Supporte public virtual bool Query option for the type of source information. d [} 188] TE1000 Version: 1.11.3 185

## Page 186

User mode API Properties Name Modifier Type Access Description Event Class [} 189] public virtual System. Guid get Returns the Event Class GUID. Event Id [} 189] public virtual uint get Returns the event ID. Event Type [} 189] public virtual Event Type Enum get Returns the type of the event [} 195]. File Time Cleared public virtual long get Only alarm: Timestamp when the [} 189] alarm was changed to the Cleared state. File Time Confirmed public virtual long get Only alarm: Timestamp when the [} 189] alarm was confirmed. File Time Raised public virtual long get Timestamp when the event was sent / the [} 189] alarm was changed to the Raised state. Json Attribute [} 189] public virtual string get The JSON attribute. Severity Level [} 189] public virtual Severity Level Enum get The Severity Level [} 196]. Source Guid [} 190] public virtual System. Guid get Returns the GUID of the source. Source Id [} 190] public virtual uint get Returns the ID of the source. Source Name [} 190] public virtual string get Returns the name of the source. Time Cleared [} 190] public virtual System. Date Time get Only alarm: Timestamp when the alarm was changed to the Cleared state. Time Confirmed public virtual System. Date Time get Only alarm: Timestamp when the [} 190] alarm was confirmed. Time Raised [} 190] public virtual System. Date Time get Timestamp when the event was sent / the alarm was changed to the Raised state. With Confirmation public virtual bool get Only alarm: A confirmation is [} 190] necessary. 8.2.8.1 Get Argument Data For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the data of the arguments. 186 Version: 1.11.3 TE1000

## Page 187

User mode API Syntax public virtual void Get Argument Data(ref System. Int Ptr pp Arg Data, uint size) Parameter Name Type Description pp Arg Data ref System. Int Ptr Reference to the data. size Uint Size 8.2.8.2 Get Argument Info For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the (type) information for the arguments. Syntax public virtual void Get Argument Info(ref Tc Event Arguments Info p Arg Info) Parameter Name Type Description p Arg Info ref Tc Event Arguments Info Reference to the information provided. 8.2.8.3 Get Cause Remedy This method returns the cause/remedy information, if this has been defined. Syntax public virtual Tc Cause Remedy Collection Get Cause Remedy(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language. Return value Name Type Description Get Cause Remedy Tc Cause Remedy Collection Collection of the cause/remedy information. 8.2.8.4 Get Details This method returns the details. Syntax public virtual Tc Detail Collection Get Details(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language TE1000 Version: 1.11.3 187

## Page 188

User mode API Return value Name Type Description Get Details Tc Detail Collection Collection of the details 8.2.8.5 Get Event Class Name This method returns the Event Class name. Syntax public virtual string Get Event Class Name(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Event Class Name string Names of the Event Class 8.2.8.6 Get Text This method returns the event text, including the arguments. Syntax public virtual string Get Text(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Text string Event text 8.2.8.7 Is Source Info Type Supported This method can be used to check whether the source information type has been defined. Syntax public virtual bool Is Source Info Type Supported(Tc Source Info Type Enum info Type) Parameter Name Type Description info Type Tc Source Info Type Enum [} 196] Query type of source Return value Name Type Description Is Source Info Type Supported bool Information as to whether supported. 188 Version: 1.11.3 TE1000

## Page 189

User mode API 8.2.8.8 Event Class This property returns the Event Class GUID. Syntax public virtual System. Guid Event Class 8.2.8.9 Event Id This property returns the event ID. Syntax public virtual uint Event Id 8.2.8.10 Event Type This property returns the type of the event. Syntax public virtual Event Type Enum Event Type 8.2.8.11 File Time Cleared This property returns the timestamp when the alarm was changed to the Cleared state. Syntax public virtual long File Time Cleared 8.2.8.12 File Time Confirmed This property returns the timestamp when the alarm was changed to the Confirmed state. Syntax public virtual long File Time Confirmed 8.2.8.13 File Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual long File Time Raised 8.2.8.14 Json Attribute This property returns the JSON attribute. Syntax public virtual string Json Attribute 8.2.8.15 Severity Level This property returns the Severity level. Syntax public virtual Tc Event Logger Ads Proxy Lib. Severity Level Enum Severity Level TE1000 Version: 1.11.3 189

## Page 190

User mode API 8.2.8.16 Source Guid This property returns the GUID of the source. Syntax public virtual System. Guid Source Guid 8.2.8.17 Source Id This property returns the ID of the source. Syntax public virtual uint Source Id 8.2.8.18 Source Name This property returns the name of the source. Syntax public virtual string Source Name 8.2.8.19 Time Cleared This property returns the timestamp when the alarm was changed to the Cleared state. Syntax public virtual System. Date Time Time Cleared 8.2.8.20 Time Confirmed This property returns the timestamp when the alarm was changed to the Confirmed state. Syntax public virtual System. Date Time Time Confirmed 8.2.8.21 Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual System. Date Time Time Raised 8.2.8.22 With Confirmation This property describes whether a confirmation is necessary. Syntax public virtual bool With Confirmation 8.2.9 ITc Message3 This interface represents a message. Syntax public interface ITc Message 190 Version: 1.11.3 TE1000

## Page 191

User mode API Methods Name Modifier Return type Description Get Argument Data [} 191] public virtual void Returns the data of the arguments. Get Argument Info [} 192] public virtual void Returns the (type) information for the arguments. Get Cause Remedy [} 192] public virtual Tc Cause Remedy Collectio Returns the cause/ n remedy information. Get Details [} 192] public virtual Tc Detail Collection Returns the details. Get Event Class Name public virtual string Returns the Event Class name [} 193] Get Text [} 193] public virtual string Returns the event text, including the arguments. Is Source Info Type Supporte public virtual bool Query option for the type of source information. d [} 193] Properties Name Modifier Type Access Description Event Class [} 194] public virtual System. Guid get Returns the Event Class GUID. Event Id [} 194] public virtual uint get Returns the event ID. Event Type [} 194] public virtual Event Type Enum get Returns the type of the event [} 195]. File Time Raised public virtual long get Timestamp when the message was sent. [} 194] Json Attribute [} 194] public virtual string get The JSON attribute. Severity Level [} 194] public virtual Severity Level Enum get The Severity Level [} 196]. Source Guid [} 194] public virtual System. Guid get Returns the GUID of the source. Source Id [} 194] public virtual uint get Returns the ID of the source. Source Name [} 195] public virtual string get Returns the name of the source. Time Raised [} 195] public virtual System. Date Time get Timestamp when the message was sent. 8.2.9.1 Get Argument Data For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the data of the arguments. Syntax public virtual void Get Argument Data(ref System. Int Ptr pp Arg Data, uint size) TE1000 Version: 1.11.3 191

## Page 192

User mode API Parameter Name Type Description pp Arg Data ref System. Int Ptr Reference to the data. size Uint Size 8.2.9.2 Get Argument Info For internal implementation only This method is only intended for internal implementation and not for use via applications. For programming purposes, the arguments can also be appended as JSON attributes. This method returns the (type) information for the arguments. Syntax public virtual void Get Argument Info(ref Tc Event Arguments Info p Arg Info) Parameter Name Type Description p Arg Info ref Tc Event Arguments Info Reference to the information provided. 8.2.9.3 Get Cause Remedy This method returns the cause/remedy information, if this has been defined. Syntax public virtual Tc Cause Remedy Collection Get Cause Remedy(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language. Return value Name Type Description Get Cause Remedy Tc Cause Remedy Collection Collection of the cause/remedy information. 8.2.9.4 Get Details This method returns the details. Syntax public virtual Tc Detail Collection Get Details(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language 192 Version: 1.11.3 TE1000

## Page 193

User mode API Return value Name Type Description Get Details Tc Detail Collection Collection of the details 8.2.9.5 Get Event Class Name This method returns the Event Class name. Syntax public virtual string Get Event Class Name(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Event Class Name string Names of the Event Class 8.2.9.6 Get Text This method returns the event text, including the arguments. Syntax public virtual string Get Text(int lang Id) Parameter Name Type Description lang Id int Lang ID of the language Return value Name Type Description Get Text string Event text 8.2.9.7 Is Source Info Type Supported This method can be used to check whether the source information type has been defined. Syntax public virtual bool Is Source Info Type Supported(Tc Source Info Type Enum info Type) Parameter Name Type Description info Type Tc Source Info Type Enum [} 196] Query type of source Return value Name Type Description Is Source Info Type Supported bool Information as to whether supported. TE1000 Version: 1.11.3 193

## Page 194

User mode API 8.2.9.8 Event Class This property returns the Event Class GUID. Syntax public virtual System. Guid Event Class 8.2.9.9 Event Id This property returns the event ID. Syntax public virtual uint Event Id 8.2.9.10 Event Type This property returns the type of the event. Syntax public virtual Event Type Enum Event Type 8.2.9.11 File Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual long File Time Raised 8.2.9.12 Json Attribute This property returns the JSON attribute. Syntax public virtual string Json Attribute 8.2.9.13 Severity Level This property returns the Severity level. Syntax public virtual Tc Event Logger Ads Proxy Lib. Severity Level Enum Severity Level 8.2.9.14 Source Guid This property returns the GUID of the source. Syntax public virtual System. Guid Source Guid 8.2.9.15 Source Id This property returns the ID of the source. Syntax public virtual uint Source Id 194 Version: 1.11.3 TE1000

## Page 195

User mode API 8.2.9.16 Source Name This property returns the name of the source. Syntax public virtual string Source Name 8.2.9.17 Time Raised This property returns the timestamp when the alarm was changed to the Raised state. Syntax public virtual System. Date Time Time Raised 8.3 Data types 8.3.1 Confirmation State Enum Defines the confirmation state of an alarm. Syntax public enum Confirmation State Enum { Confirmed, Not Required, Not Supported, Reset, Wait For Confirmation } Parameter Name Description Confirmed Confirmed Not Required Confirmation not necessary in the current state. (Alarm not currently in the Raised state). Not Supported Was initialized without confirmation. Reset Initial state Wait For Confirmation Waiting for confirmation. 8.3.2 Event Type Enum Type definition whether a Tc Event is of the type alarm or message. Syntax public enum Event Type Enum { Alarm, Message } Parameter Name Description Alarm The Tc Event is of the type Tc Alarm. Message The Tc Event is of the type Tc Message. TE1000 Version: 1.11.3 195

## Page 196

User mode API 8.3.3 Severity Level Enum This enumeration defines the "severity" of the event. It is an ordered list. Syntax public enum Severity Level Enum { Critical, Error, Warning, Info, Verbose } Parameter Name Description 4 Critical Critical 3 Error Error 2 Warning Warning 1 Info Information 0 Verbose Extended output 8.3.4 Tc Event Argument Type Enum Type definition of what type a Tc Argument is. Syntax public enum Tc Event Argument Type Enum { Blob, Boolean, Char, Double, E_Adsnotification Stream, Event Reference, External Time Stamp, Float, Format String, Int16, Int32, Int64, Int8, String Type, UInt16, UInt32, UInt64, UInt8, Undefinied, UTF8Encoded String, WChar, WString Type } 8.3.5 Tc Source Info Type Enum Definition of which entry in a Tc Source Info is identified. Syntax public enum Tc Source Info Type Enum { Source Guid, Source Id, Source Name } 196 Version: 1.11.3 TE1000

## Page 197

User mode API Parameter Name Description Source Guid The source GUID of the Tc Source Info. Source Id The source ID of the Tc Source Info. For example, the Tc COM object ID. Source Name The Source Name of the Tc Source Info. For example, the instance path within a PLC. TE1000 Version: 1.11.3 197

## Page 198

Example 9 Example Samples of how to use the Event Logger are provided at this point. These examples provide easy-to-follow demonstrations for dealing with the Twin CAT 3 Event Logger. Sample code and configurations for this product can be obtained from the corresponding repository on Git Hub: https://github.com/Beckhoff/Tc3Eventlogger_Samples. There you have the option to clone the repository or download a ZIP file containing the sample. The samples PLC [} 198] as well as C++ [} 203] refer to the real-time programming interfaces of Twin CAT. A . NET interface [} 209] is available for user mode programs. 9.1 PLC 9.1.1 Tutorial This tutorial illustrates the work steps from an empty Twin CAT project to a dispatched message. It depicts the properties of the Twin CAT 3 Event Logger described in the Technical Introduction [} 13] section in the work sequence. Creating an event class in the Twin CAT type system ü A standard Twin CAT PLC project exists. 198 Version: 1.11.3 TE1000

## Page 199

Example 1. Double-click on Type System in the SYSTEM subtree and select the Event Classes tab in the editor which then opens. Open the context menu and select the New command. ð The TMC editor opens. 2. Give the event class a name and enter a display text. TE1000 Version: 1.11.3 199

## Page 200

Example 3. An event is already created below the event class. Give the event a name and enter a display text and the severity. 4. Save and, if applicable, close the event class. ð The source code is provided in the PLC and is accessible under the TC_EVENTS symbol. Adding the TC3_Event Logger library 5. Select the Add Library command in the context menu of the References object. ð The Add Library dialog opens. 6. Select the library and confirm the dialog. ð The library is added to the PLC project. Creating a PLC program 1. Open the MAIN program of the PLC project in the editor by double-clicking. 2. Declare and initialize the variables b Init and b Send and declare an instance of the function block FB_Tc Message: PROGRAM MAIN VAR b Init : BOOL := TRUE; b Send : BOOL := TRUE; 200 Version: 1.11.3 TE1000

## Page 201

Example fb Msg : FB_Tc Message; END_VAR 3. Implement the send procedure as shown in the code. The message is initialized once by means of the Create Ex method. Since the initialization requires dynamic resources it should not take place cyclically. The initialized message is subsequently sent using the Send method. IF b Init THEN b Init := FALSE; fb Msg. Create Ex(TC_EVENTS. Tutorial Class. Tutorial Event, 0); END_IF IF b Send THEN b Send := FALSE; fb Msg. Send(0); END_IF 4. Create the PLC project and start the PLC. ð The result is shown in the Logged Events window in the Twin CAT 3 Engineering. 9.1.2 Example Result Message This sample shows the use of the Twin CAT 3 Event Logger with function blocks. Firstly, it demonstrates how an output on a function block can be utilized in order to use the event information as an extended return. On the other hand, it demonstrates how a parameterization can be carried out in order to output the messages via the Twin CAT 3 Event Logger only in certain cases. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Result Message Sample The example consists of two function blocks: • FB_Math Calculation: This function block offers two methods and two properties that always output messages at the output ip Result Message and additionally send them via the Event Logger if a trace level is exceeded. ◦ Method Addition(): Adds two numbers and sends a message in case of overflow ◦ Method Divison(): Divides two numbers after checking. Sends a message in case of division by 0. ◦ Property b Trace Level Default: Indicates whether the trace level is to be observed locally on the function block or whether to use a trace level library, which exists in the GVL in the sample. ◦ Property e Trace Level: The methods only send the message via the Event Logger if the severity is greater than or equal to this property. • FB_Control: This function block shows the use of the FB_Math Calculation function block within another function block. The Execute method of the FB_Control thereby uses the FB_Math Calculation. Divison() and handles the message further itself as error code. 9.1.3 Example Listener This sample illustrates the use of the Twin CAT 3 Event Logger in relation to messages and alarms. At the same time the reception of messages is shown in a second project. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Listener Sample Publisher project Single BOOL variables are used as triggers in the Publisher project: • b Send Message to send a message. TE1000 Version: 1.11.3 201

## Page 202

Example • b Raise Alarm to set an alarm. • b Clear Alarm to cancel an alarm. • b Confirm Alarm to confirm an alarm. In addition there is an option to set the JSON attribute in order to send it with both messages. Listener project The Listener project contains a function block, FB_Listener, which extends the FB_Listener Base function block contained in the Tc3_Event Logger. The function block implements the functions for receiving the messages: • On Message Sent: when a message has been sent the Event Logger will call this method as a callback. The method counts the number of messages. • On Alarm Raised/On Alarm Cleared/On Alarm Confirmed: if the alarm changes its state the Event Logger will call this method as a callback. The methods count the number of state changes. • To initiate receiving of messages, an Execute method is implemented at the function block. • The text of the last received message can be retrieved. • The function block FB_Listener Test uses the FB_Listener. In doing so it registers the event class to be received once. Another event class that exists is not received to demonstrate the filter functionality. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 9.1.4 Example filter This sample illustrates the application of the Twin CAT 3 Event Logger for receiving messages. The focus is on the filter functions in order to process the right messages in a targeted manner. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Filter Sample The sample has four components: • A number of different messages are sent, demonstrating the selection of messages in different filters. • One component shows how to discard from the cache messages that are specified by a filter. • Another component illustrates the export of cached messages to a CSV file. Here, too, the filters are used to program which messages are to be selected. • Another component illustrates the general principle of receiving messages sent in real-time and receiving of Ether CAT emergency messages. Requirements Development environment Target platform PLC libraries to include Twin CAT v3.1.4024.17 PC or CX (x64, x86, Arm®) Tc3_Event Logger (>= v3.1.27.0) 9.1.5 Sample Resource Import This sample shows how a resource file in ECPX format can be used with the Twin CAT 3 Event Logger. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/PLC/ Tc3Event Logger_Resouce Import Sample/Twin CAT%20Resource Import For this purpose, a new implementation of the FB_Simple Ads Log Event function block is created in the sample. This uses the mapping function F_Map Source generated from Excel, which can be imported via the Tc POU file. The implementation also shows the mapping of the functionality: 202 Version: 1.11.3 TE1000

## Page 203

Example • b Set Event: An event is set as an alarm on rising edge (raise) and deleted again on falling edge (cleared) • b Quit: If Req Must Con was set, an alarm is also created as capable of being acknowledged. This acknowledgement can be made via b Quit. The following steps are proposed ü A Resource.ecpx file is available and corresponding alarms are to be sent via the Twin CAT 3 Event Logger. The Excel add-in is installed. 1. Import the file into Excel [} 21] using "Import". ð An event class is created from each "source" in which the events can be found. The translations have also been adopted in the translation 2. The event classes can now be further developed in Excel. 3. "Generate TMC file" generates a TMC file. 4. This can be integrated into a Twin CAT Solution by right-clicking on System->Type System "Add existing item". 5. A PLC function can be created using "Create PLC mapping function". 6. This can be imported into a PLC project on DUT by right-clicking "Add"->"Existing Item". 7. The sample provides a sample implementation for a function block that has the same inputs/outputs as the FB_Simple Ads Log Event. This means that only the declaration needs to be changed, but not the behavior of the process. ð The events are sent by the provided function block via the Twin CAT 3 Event Logger. For this purpose, the behavior of the exemplary implementation may have to be adapted and, for example, the mapping of the severity adapted. Cf. Importing resource files [} 36] The sample shows the result and also provides an example of the output file in ECPX format, generated TMC / Function file. 9.2 C++ 9.2.1 Tutorial This tutorial illustrates the work steps from an empty Twin CAT project to a dispatched message. It depicts the properties of the Twin CAT 3 Event Logger described in the Technical Introduction [} 13] section in the work sequence. Creating an event class in the data types of the TMC file in the C++ project ü A new Twin CAT C++ project exists with the module from the wizard "Twin CAT Module Class with Cyclic IO". TE1000 Version: 1.11.3 203

## Page 204

Example 1. Click twice on the TMC file in the C++ project to open the TMC editor. Select the command Add new event class… from the context menu of Data Types. ð The TMC editor opens the event class. 2. Give the event class a name and optionally enter a display text. 204 Version: 1.11.3 TE1000

## Page 205

Example 3. An event is already created below the event class. Give the event a name and enter a display text and the severity. 4. Use the event class in the previously created module. TE1000 Version: 1.11.3 205

## Page 206

Example 5. In addition, create an input b Send in order to send the event on a rising edge. 6. Generate the source code of the module. Creating a C++ program 7. Add headers to the Untitled1Interfaces.h in the C++ program: #include "Tc Router Interfaces.h" #include "Tc Event Logger Interfaces.h" 8. You need the following declarations in the Module1.h: UINT m_counter; ITc Event Logger Ptr m_sp Event Logger; ITc Message Ptr m_sp Message; BOOL m_Old Send; 9. Initialize the following values in the constructor of the module in Module1.cpp: CModule1::CModule1() : m_Trace(m_Trace Level Max, m_sp Srv) , m_counter(0) { 206 Version: 1.11.3 TE1000

## Page 207

Example ///<Auto Generated Content id="Member Initialization"> m_Trace Level Max = tl Always; memset(&m_Parameter, 0, sizeof(m_Parameter)); memset(&m_Inputs, 0, sizeof(m_Inputs)); memset(&m_Outputs, 0, sizeof(m_Outputs)); ///</Auto Generated Content> m_sp Event Logger = 0; m_sp Message = 0; m_Old Send = FALSE; m_Inputs.b Send = TRUE; } 10. In addition, carry out the following initialization in the method Set Obj State SO(): // TODO: Add any additional initialization m_sp Event Logger. Set OID(OID_TCEVENTLOGGER); hr = FAILED(hr) ? hr : m_sp Srv->Tc Query Smart Object Interface(m_sp Event Logger); hr = FAILED(hr) ? hr : m_sp Event Logger- >Create Message(Tc Events::Tutorial Class::Event Class, Tc Events::Tutorial Class::Tutorial Event.n Even t Id, Tc Events::Tutorial Class::Tutorial Event.e Severity, 0, &m_sp Message); 11. If the call of the method Add Module To Caller() fails, carry out a deinitialization: // Cleanup if transition failed at some stage if ( FAILED(hr) ) { Remove Module From Caller(); m_sp Event Logger = NULL; m_sp Message = NULL; } 12. Carry out a deinitialization in the method Set Obj State OS(): // TODO: Add any additional deinitialization m_sp Event Logger = NULL; m_sp Message = NULL; 13. Extend the cyclic code of the module by the sending of the message: // TODO: Replace the sample with your cyclic code if (m_Inputs.b Send && ! m_Old Send) // raising edge { m_sp Message->Send(0); } m_Old Send = m_Inputs.b Send; 14. Create a module instance and link it with a task. 15. Create the C++ project and start Twin CAT. ð The result is shown in the Logged Events window in the Twin CAT 3 Engineering. TE1000 Version: 1.11.3 207

## Page 208

Example 9.2.2 Example: Start-Stop This sample shows the use of the Twin CAT 3 Event Logger when starting and stopping Twin CAT. A message is used with arguments that map the different states of the C++ module. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/C%2B%2B(RT)/ Tc3Event Logger_Cpp Start Stop_Sample The message is used in the methods of the state machines: • Set Obj State PS(): The Event Logger is being started by Twin CAT. Use in this state is thus impossible. • Set Obj State SO(): Here, the reference to the Event Logger is procured through Tc Query Smart Object Interface and the messages initiated by Create Message(). A corresponding message is dispatched. A message is dispatched with Add Module To Caller(). A message is also dispatched here at the end of the transition. • Cycle Update(): in this example no messages are dispatched. The behavior of the module towards the OP state is thus equivalent to that of a "Cyclic IO" module. • Set Obj State OS(): A message is dispatched with Remove Module From Caller(). A message is also dispatched here at the end of the transition. Thereafter the references to the message and to the Event Logger are set to ZERO, which is also notified by means of a message. • Set Obj State PS(): The Event Logger is shut down by Twin CAT. Use in this state is thus impossible. The following messages result: 9.2.3 Example Listener This sample illustrates the use of the Twin CAT 3 Event Logger in relation to messages and alarms. It consists of a module that can send a message and an alarm, and a module that receives these messages. Download the sample: https://github.com/Beckhoff/Tc3Eventlogger_Samples/tree/main/C%2B%2B(RT)/ Tc3Event Logger_Cpp Listener_Sample Publisher module Single BOOL variables are used in the Publisher module as triggers on the input data area: • b Send Message to send a message • b Raise Alarm to set an alarm • b Clear Alarm to cancel an alarm • b Confirm Alarm to confirm an alarm In addition there is an option to set and to remove the JSON attribute in order to send it with both messages. 208 Version: 1.11.3 TE1000

## Page 209

Example Listener module The Listener module implements both the ITCMessage Listener and the ITc Alarm Listener interface. The methods specified as a result of this are called by the Event Logger as callback. • On Message Sent: when a message has been sent the Event Logger will call this method as a callback. The method counts the number of messages. • On Alarm Raised/On Alarm Cleared/On Alarm Confirmed: if the alarm changes its state the Event Logger will call this method as a callback. The methods count the number of state changes. The Listener module thereby registers itself with the Event Logger for the corresponding event classes on starting in the method Set Obj State SO(). 9.3 User mode API Beckhoff. Twin CAT. Tc Event Logger Ads Proxy. Net from Nu Get.org The API is available on Nu Get.org via the package Beckhoff. Twin CAT. Tc Event Logger Ads Proxy. Net for implementation into projects. To get started easily, you will find there sample code in the README file, which only needs to be copied into a . NET project. COM based interface is replaced The COM based interface, which is described here before, is supported up to Twin CAT 3.1 4024. Due to the technology used, it cannot be offered under Twin CAT/BSD. The API provided on Nu Get.org is the successor and provides easy porting for customer applications through an equivalent API. Also see about this 2 User mode API [} 157] TE1000 Version: 1.11.3 209

## Page 210

Appendix 10 Appendix 10.1 ADS Return Codes Grouping of error codes: Global error codes: 0x0000 [} 210]... (0x9811_0000 ...) Router error codes: 0x500 [} 210]... (0x9811_0500 ...) General ADS errors: 0x700 [} 211]... (0x9811_0700 ...) RTime error codes: 0x1000 [} 213]... (0x9811_1000 ...) Global error codes Hex Dec HRESULT Name Description 0x0 0 0x98110000 ERR_NOERROR No error. 0x1 1 0x98110001 ERR_INTERNAL Internal error. 0x2 2 0x98110002 ERR_NORTIME No real time. 0x3 3 0x98110003 ERR_ALLOCLOCKEDMEM Allocation locked – memory error. 0x4 4 0x98110004 ERR_INSERTMAILBOX Mailbox full – the ADS message could not be sent. Reducing the number of ADS messages per cycle will help. 0x5 5 0x98110005 ERR_WRONGRECEIVEHMSG Wrong HMSG. 0x6 6 0x98110006 ERR_TARGETPORTNOTFOUND Target port not found – ADS server is not started, not reachable or not installed. 0x7 7 0x98110007 ERR_TARGETMACHINENOTFOUND Target computer not found – AMS route was not found. 0x8 8 0x98110008 ERR_UNKNOWNCMDID Unknown command ID. 0x9 9 0x98110009 ERR_BADTASKID Invalid task ID. 0x A 10 0x9811000A ERR_NOIO No IO. 0x B 11 0x9811000B ERR_UNKNOWNAMSCMD Unknown AMS command. 0x C 12 0x9811000C ERR_WIN32ERROR Win32 error. 0x D 13 0x9811000D ERR_PORTNOTCONNECTED Port not connected. 0x E 14 0x9811000E ERR_INVALIDAMSLENGTH Invalid AMS length. 0x F 15 0x9811000F ERR_INVALIDAMSNETID Invalid AMS Net ID. 0x10 16 0x98110010 ERR_LOWINSTLEVEL Installation level is too low –Twin CAT 2 license error. 0x11 17 0x98110011 ERR_NODEBUGINTAVAILABLE No debugging available. 0x12 18 0x98110012 ERR_PORTDISABLED Port disabled – Twin CAT system service not started. 0x13 19 0x98110013 ERR_PORTALREADYCONNECTED Port already connected. 0x14 20 0x98110014 ERR_AMSSYNC_W32ERROR AMS Sync Win32 error. 0x15 21 0x98110015 ERR_AMSSYNC_TIMEOUT AMS Sync Timeout. 0x16 22 0x98110016 ERR_AMSSYNC_AMSERROR AMS Sync error. 0x17 23 0x98110017 ERR_AMSSYNC_NOINDEXINMAP No index map for AMS Sync available. 0x18 24 0x98110018 ERR_INVALIDAMSPORT Invalid AMS port. 0x19 25 0x98110019 ERR_NOMEMORY No memory. 0x1A 26 0x9811001A ERR_TCPSEND TCP send error. 0x1B 27 0x9811001B ERR_HOSTUNREACHABLE Host unreachable. 0x1C 28 0x9811001C ERR_INVALIDAMSFRAGMENT Invalid AMS fragment. 0x1D 29 0x9811001D ERR_TLSSEND TLS send error – secure ADS connection failed. 0x1E 30 0x9811001E ERR_ACCESSDENIED Access denied – secure ADS access denied. Router error codes 210 Version: 1.11.3 TE1000

## Page 211

Appendix Hex Dec HRESULT Name Description 0x500 1280 0x98110500 ROUTERERR_NOLOCKEDMEMORY Locked memory cannot be allocated. 0x501 1281 0x98110501 ROUTERERR_RESIZEMEMORY The router memory size could not be changed. 0x502 1282 0x98110502 ROUTERERR_MAILBOXFULL The mailbox has reached the maximum number of possible messages. 0x503 1283 0x98110503 ROUTERERR_DEBUGBOXFULL The Debug mailbox has reached the maximum number of possible messages. 0x504 1284 0x98110504 ROUTERERR_UNKNOWNPORTTYPE The port type is unknown. 0x505 1285 0x98110505 ROUTERERR_NOTINITIALIZED The router is not initialized. 0x506 1286 0x98110506 ROUTERERR_PORTALREADYINUSE The port number is already assigned. 0x507 1287 0x98110507 ROUTERERR_NOTREGISTERED The port is not registered. 0x508 1288 0x98110508 ROUTERERR_NOMOREQUEUES The maximum number of ports has been reached. 0x509 1289 0x98110509 ROUTERERR_INVALIDPORT The port is invalid. 0x50A 1290 0x9811050A ROUTERERR_NOTACTIVATED The router is not active. 0x50B 1291 0x9811050B ROUTERERR_FRAGMENTBOXFULL The mailbox has reached the maximum number for fragmented messages. 0x50C 1292 0x9811050C ROUTERERR_FRAGMENTTIMEOUT A fragment timeout has occurred. 0x50D 1293 0x9811050D ROUTERERR_TOBEREMOVED The port is removed. General ADS error codes TE1000 Version: 1.11.3 211

## Page 212

Appendix Hex Dec HRESULT Name Description 0x700 1792 0x98110700 ADSERR_DEVICE_ERROR General device error. 0x701 1793 0x98110701 ADSERR_DEVICE_SRVNOTSUPP Service is not supported by the server. 0x702 1794 0x98110702 ADSERR_DEVICE_INVALIDGRP Invalid index group. 0x703 1795 0x98110703 ADSERR_DEVICE_INVALIDOFFSET Invalid index offset. 0x704 1796 0x98110704 ADSERR_DEVICE_INVALIDACCESS Reading or writing not permitted. Several causes are possible. For example, an incorrect password was entered when creating routes. 0x705 1797 0x98110705 ADSERR_DEVICE_INVALIDSIZE Parameter size not correct. 0x706 1798 0x98110706 ADSERR_DEVICE_INVALIDDATA Invalid data values. 0x707 1799 0x98110707 ADSERR_DEVICE_NOTREADY Device is not ready to operate. 0x708 1800 0x98110708 ADSERR_DEVICE_BUSY Device is busy. 0x709 1801 0x98110709 ADSERR_DEVICE_INVALIDCONTEXT Invalid operating system context. This can result from use of ADS blocks in different tasks. It may be possible to resolve this through multitasking synchronization in the PLC. 0x70A 1802 0x9811070A ADSERR_DEVICE_NOMEMORY Insufficient memory. 0x70B 1803 0x9811070B ADSERR_DEVICE_INVALIDPARM Invalid parameter values. 0x70C 1804 0x9811070C ADSERR_DEVICE_NOTFOUND Not found (files, ...). 0x70D 1805 0x9811070D ADSERR_DEVICE_SYNTAX Syntax error in file or command. 0x70E 1806 0x9811070E ADSERR_DEVICE_INCOMPATIBLE Objects do not match. 0x70F 1807 0x9811070F ADSERR_DEVICE_EXISTS Object already exists. 0x710 1808 0x98110710 ADSERR_DEVICE_SYMBOLNOTFOUND Symbol not found. 0x711 1809 0x98110711 ADSERR_DEVICE_SYMBOLVERSIONINVALID Invalid symbol version. This can occur due to an online change. Create a new handle. 0x712 1810 0x98110712 ADSERR_DEVICE_INVALIDSTATE Device (server) is in invalid state. 0x713 1811 0x98110713 ADSERR_DEVICE_TRANSMODENOTSUPP Ads Trans Mode not supported. 0x714 1812 0x98110714 ADSERR_DEVICE_NOTIFYHNDINVALID Notification handle is invalid. 0x715 1813 0x98110715 ADSERR_DEVICE_CLIENTUNKNOWN Notification client not registered. 0x716 1814 0x98110716 ADSERR_DEVICE_NOMOREHDLS No further handle available. 0x717 1815 0x98110717 ADSERR_DEVICE_INVALIDWATCHSIZE Notification size too large. 0x718 1816 0x98110718 ADSERR_DEVICE_NOTINIT Device not initialized. 0x719 1817 0x98110719 ADSERR_DEVICE_TIMEOUT Device has a timeout. 0x71A 1818 0x9811071A ADSERR_DEVICE_NOINTERFACE Interface query failed. 0x71B 1819 0x9811071B ADSERR_DEVICE_INVALIDINTERFACE Wrong interface requested. 0x71C 1820 0x9811071C ADSERR_DEVICE_INVALIDCLSID Class ID is invalid. 0x71D 1821 0x9811071D ADSERR_DEVICE_INVALIDOBJID Object ID is invalid. 0x71E 1822 0x9811071E ADSERR_DEVICE_PENDING Request pending. 0x71F 1823 0x9811071F ADSERR_DEVICE_ABORTED Request is aborted. 0x720 1824 0x98110720 ADSERR_DEVICE_WARNING Signal warning. 0x721 1825 0x98110721 ADSERR_DEVICE_INVALIDARRAYIDX Invalid array index. 0x722 1826 0x98110722 ADSERR_DEVICE_SYMBOLNOTACTIVE Symbol not active. 0x723 1827 0x98110723 ADSERR_DEVICE_ACCESSDENIED Access denied. Several causes are possible. For example, a unidirectional ADS route is used in the opposite direction. 0x724 1828 0x98110724 ADSERR_DEVICE_LICENSENOTFOUND Missing license. 0x725 1829 0x98110725 ADSERR_DEVICE_LICENSEEXPIRED License expired. 0x726 1830 0x98110726 ADSERR_DEVICE_LICENSEEXCEEDED License exceeded. 0x727 1831 0x98110727 ADSERR_DEVICE_LICENSEINVALID Invalid license. 0x728 1832 0x98110728 ADSERR_DEVICE_LICENSESYSTEMID License problem: System ID is invalid. 0x729 1833 0x98110729 ADSERR_DEVICE_LICENSENOTIMELIMIT License not limited in time. 0x72A 1834 0x9811072A ADSERR_DEVICE_LICENSEFUTUREISSUE Licensing problem: time in the future. 0x72B 1835 0x9811072B ADSERR_DEVICE_LICENSETIMETOLONG License period too long. 0x72C 1836 0x9811072C ADSERR_DEVICE_EXCEPTION Exception at system startup. 0x72D 1837 0x9811072D ADSERR_DEVICE_LICENSEDUPLICATED License file read twice. 0x72E 1838 0x9811072E ADSERR_DEVICE_SIGNATUREINVALID Invalid signature. 0x72F 1839 0x9811072F ADSERR_DEVICE_CERTIFICATEINVALID Invalid certificate. 0x730 1840 0x98110730 ADSERR_DEVICE_LICENSEOEMNOTFOUND Public key not known from OEM. 0x731 1841 0x98110731 ADSERR_DEVICE_LICENSERESTRICTED License not valid for this system ID. 212 Version: 1.11.3 TE1000

## Page 213

Appendix Hex Dec HRESULT Name Description 0x732 1842 0x98110732 ADSERR_DEVICE_LICENSEDEMODENIED Demo license prohibited. 0x733 1843 0x98110733 ADSERR_DEVICE_INVALIDFNCID Invalid function ID. 0x734 1844 0x98110734 ADSERR_DEVICE_OUTOFRANGE Outside the valid range. 0x735 1845 0x98110735 ADSERR_DEVICE_INVALIDALIGNMENT Invalid alignment. 0x736 1846 0x98110736 ADSERR_DEVICE_LICENSEPLATFORM Invalid platform level. 0x737 1847 0x98110737 ADSERR_DEVICE_FORWARD_PL Context – forward to passive level. 0x738 1848 0x98110738 ADSERR_DEVICE_FORWARD_DL Context – forward to dispatch level. 0x739 1849 0x98110739 ADSERR_DEVICE_FORWARD_RT Context – forward to real-time. 0x740 1856 0x98110740 ADSERR_CLIENT_ERROR Client error. 0x741 1857 0x98110741 ADSERR_CLIENT_INVALIDPARM Service contains an invalid parameter. 0x742 1858 0x98110742 ADSERR_CLIENT_LISTEMPTY Polling list is empty. 0x743 1859 0x98110743 ADSERR_CLIENT_VARUSED Var connection already in use. 0x744 1860 0x98110744 ADSERR_CLIENT_DUPLINVOKEID The called ID is already in use. 0x745 1861 0x98110745 ADSERR_CLIENT_SYNCTIMEOUT Timeout has occurred – the remote terminal is not responding in the specified ADS timeout. The route setting of the remote terminal may be configured incorrectly. 0x746 1862 0x98110746 ADSERR_CLIENT_W32ERROR Error in Win32 subsystem. 0x747 1863 0x98110747 ADSERR_CLIENT_TIMEOUTINVALID Invalid client timeout value. 0x748 1864 0x98110748 ADSERR_CLIENT_PORTNOTOPEN Port not open. 0x749 1865 0x98110749 ADSERR_CLIENT_NOAMSADDR No AMS address. 0x750 1872 0x98110750 ADSERR_CLIENT_SYNCINTERNAL Internal error in Ads sync. 0x751 1873 0x98110751 ADSERR_CLIENT_ADDHASH Hash table overflow. 0x752 1874 0x98110752 ADSERR_CLIENT_REMOVEHASH Key not found in the table. 0x753 1875 0x98110753 ADSERR_CLIENT_NOMORESYM No symbols in the cache. 0x754 1876 0x98110754 ADSERR_CLIENT_SYNCRESINVALID Invalid response received. 0x755 1877 0x98110755 ADSERR_CLIENT_SYNCPORTLOCKED Sync Port is locked. 0x756 1878 0x98110756 ADSERR_CLIENT_REQUESTCANCELLED The request was canceled. RTime error codes Hex Dec HRESULT Name Description 0x1000 4096 0x98111000 RTERR_INTERNAL Internal error in the real-time system. 0x1001 4097 0x98111001 RTERR_BADTIMERPERIODS Timer value is not valid. 0x1002 4098 0x98111002 RTERR_INVALIDTASKPTR Task pointer has the invalid value 0 (zero). 0x1003 4099 0x98111003 RTERR_INVALIDSTACKPTR Stack pointer has the invalid value 0 (zero). 0x1004 4100 0x98111004 RTERR_PRIOEXISTS The request task priority is already assigned. 0x1005 4101 0x98111005 RTERR_NOMORETCB No free TCB (Task Control Block) available. The maximum number of TCBs is 64. 0x1006 4102 0x98111006 RTERR_NOMORESEMAS No free semaphores available. The maximum number of semaphores is 64. 0x1007 4103 0x98111007 RTERR_NOMOREQUEUES No free space available in the queue. The maximum number of positions in the queue is 64. 0x100D 4109 0x9811100D RTERR_EXTIRQALREADYDEF An external synchronization interrupt is already applied. 0x100E 4110 0x9811100E RTERR_EXTIRQNOTDEF No external sync interrupt applied. 0x100F 4111 0x9811100F RTERR_EXTIRQINSTALLFAILED Application of the external synchronization interrupt has failed. 0x1010 4112 0x98111010 RTERR_IRQLNOTLESSOREQUAL Call of a service function in the wrong context 0x1017 4119 0x98111017 RTERR_VMXNOTSUPPORTED Intel VT-x extension is not supported. 0x1018 4120 0x98111018 RTERR_VMXDISABLED Intel VT-x extension is not enabled in the BIOS. 0x1019 4121 0x98111019 RTERR_VMXCONTROLSMISSING Missing function in Intel VT-x extension. 0x101A 4122 0x9811101A RTERR_VMXENABLEFAILS Activation of Intel VT-x fails. Specific positive HRESULT Return Codes: TE1000 Version: 1.11.3 213

## Page 214

Appendix HRESULT Name Description 0x0000_0000 S_OK No error. 0x0000_0001 S_FALSE No error. Example: successful processing, but with a negative or incomplete result. 0x0000_0203 S_PENDING No error. Example: successful processing, but no result is available yet. 0x0000_0256 S_WATCHDOG_TIMEOUT No error. Example: successful processing, but a timeout occurred. TCP Winsock error codes Hex Dec Name Description 0x274C 10060 WSAETIMEDOUT A connection timeout has occurred - error while establishing the connection, because the remote terminal did not respond properly after a certain period of time, or the established connection could not be maintained because the connected host did not respond. 0x274D 10061 WSAECONNREFUSED Connection refused - no connection could be established because the target computer has explicitly rejected it. This error usually results from an attempt to connect to a service that is inactive on the external host, that is, a service for which no server application is running. 0x2751 10065 WSAEHOSTUNREACH No route to host - a socket operation referred to an unavailable host. More Winsock error codes: Win32 error codes 10.2 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service 214 Version: 1.11.3 TE1000

## Page 215

Appendix • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TE1000 Version: 1.11.3 215

## Page 216

Trademark statements Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. Third-party trademark statements Arm, Arm9 and Cortex are trademarks or registered trademarks of Arm Limited (or its subsidiaries or affiliates) in the US and/or elsewhere. Intel, the Intel logo, Intel Core, Xeon, Intel Atom, Celeron and Pentium are trademarks of Intel Corporation or its subsidiaries. Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies.

## Page 217

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
