---
title: "TF5200_homing_en"
product: "TF5200"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_homing_en.pdf"
release_date: "2025-06-06"
---
Functional description | EN TF5200 | Twin CAT 3 CNC Homing 6/6/2025 | Version: 1.2
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5200 | Twin CAT 3 CNC Version: 1.2 3 Homing
## Page 4

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. 4 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 5

Table of contents Table of contents Notes on the documentation.................................................................................................................... 3 General and safety instructions.............................................................................................................. 4 1 Overview.................................................................................................................................................... 8 2 Description................................................................................................................................................ 9 2.1 Homing interfaces........................................................................................................................... 12 2.2 Commanding and execution........................................................................................................... 14 2.3 Sequence strategies for homing..................................................................................................... 17 2.3.1 Default homing................................................................................................................. 18 2.3.2 Flying homing for spindle axes......................................................................................... 24 2.3.3 Special homing methods.................................................................................................. 28 2.4 Monitoring during homing................................................................................................................ 37 2.4.1 Path monitoring................................................................................................................ 37 2.5 Monitoring after homing.................................................................................................................. 37 2.5.1 Reference loss (reference monitoring)............................................................................. 37 2.6 Delayed activation of zero pulse logic............................................................................................. 40 3 Parameterisation..................................................................................................................................... 42 3.1 System parameters......................................................................................................................... 43 3.1.1 Drive types....................................................................................................................... 43 3.1.2 Drive systems with reference cam................................................................................... 46 3.1.3 Drive systems with zero pulse.......................................................................................... 47 3.2 Sequence parameters..................................................................................................................... 48 3.2.1 Homing with or without reversal....................................................................................... 48 3.2.2 Motion direction during homing........................................................................................ 48 3.2.3 Velocities for homing........................................................................................................ 48 3.2.4 Homing acceleration........................................................................................................ 48 3.3 Reference position.......................................................................................................................... 48 3.4 Specific parameter for drive simulation........................................................................................... 49 3.5 Effectiveness of parameters............................................................................................................ 50 3.6 Parameterisation examples............................................................................................................. 51 3.6.1 Conventional drives.......................................................................................................... 51 3.6.2 Simulation........................................................................................................................ 52 3.6.3 SERCOS with zero pulse latch with S-0-146................................................................... 53 4 Parameter................................................................................................................................................. 54 4.1 Overview......................................................................................................................................... 54 4.2 Description...................................................................................................................................... 54 4.3 Dependence on the type of referencing method............................................................................. 67 5 Support and Service............................................................................................................................... 68 Index......................................................................................................................................................... 69 TF5200 | Twin CAT 3 CNC Version: 5 Homing
## Page 6

Table of contents 6 Version: TF5200 | Twin CAT 3 CNC Homing
## Page 7

List of figures List of figures Fig. 1 Principle layout of limit switches and reference cam of a machine axis....................................... 10 Fig. 2 Overview of NC controller............................................................................................................ 12 Fig. 3 Default homing in time range....................................................................................................... 19 Fig. 4 Default homing............................................................................................................................. 19 Fig. 5 Homing in 3 phases, referencing to the reference cam with zero pulse...................................... 22 Fig. 6 Homing in 3 phases, referencing to the reference cam with zero pulse...................................... 23 Fig. 7 State graph of spindle modes...................................................................................................... 26 Fig. 8 State graph of spindle modes for digital drives (e.g. SERCOS)................................................... 27 Fig. 9 Referencing at motion away from reference cam (without zero pulse)........................................ 28 Fig. 10 Move to reference cam with zero pulse (1 phase)....................................................................... 29 Fig. 11 Move to reference cam without zero pulse (1 phase).................................................................. 30 Fig. 12 Referencing with zero pulse without reference point cam............................................................ 31 Fig. 13 Influence of parameters during motion to a fixed stop................................................................. 33 Fig. 14 Influence of parameters during motion to a fixed stop................................................................. 36 Fig. 15 The zero pulse may not be reliably detected............................................................................... 40 Fig. 16 Activation time shift of zero pulse logic ensures identical zero pulse........................................... 41 Fig. 17 Drive system with reference cam................................................................................................. 46 Fig. 18 Cam signal level........................................................................................................................... 46 Fig. 19 Drive system with zero pulse....................................................................................................... 47 TF5200 | Twin CAT 3 CNC Version: 1.2 7 Homing
## Page 8

Overview 1 Overview Task To home a machine axis, the actual position value system of the machine axis must be synchronised • with the axis coordinate system of the machine and • the CNC. Characteristics All machine axes that must be positioned and have no encoder (which supplies an actual value absolute position) must be homed. Speed-controlled or only endlessly position-controlled spindles need not be homed. Homing (RPF) is possible for the following axis types (P-AXIS-00018): • Linear axes • Rotary axes • Spindles Parameterisation Homing must be parameterised for every axis in the axis parameter list. For more information on this function, see the chapter Parameterisation [} 42]. Programming Homing is commanded with by the NC command G74 or by starting the 'Homing’ mode. Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 8 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 9

Description 2 Description Task of homing The actual position value system of a machine axis is synchronised with the machine geometry by homing. Homing means: Synchronising axis initialisation with the required axis coordinate system. Homing refers to the entire process including referencing up to axis standstill. NOTICE Only when homing is completed are the software limit switch position of the axes monitored. Homing is always executed at line slope speed profile. Axis position after homing After homing is complete, the axis is not located at its reference point. The reason for this is that, when the cam/zero pulse signal occurs, the reference position is adopted and the axis is then decel- erated. At the end of homing, the axis is then located at the deceleration distance away from the ref- erence position. Absolute measuring system or incremental measuring system Machine axes need not be homed if they are equipped with an absolute measuring system which supplies a unique axis or slide position in the entire motion range of the drive. This can be set by the axis parameter P- AXIS-00014 (abs_pos-_gueltig). NOTICE Homing is required for incremental measuring systems. This is obtained by setting the axis parameter P- AXIS-00014 (abs_pos_gueltig) to 0. The homing that is then required is described in detail below. TF5200 | Twin CAT 3 CNC Version: 1.2 9 Homing
## Page 10

Description Homing strategies The following strategies can be executed with the controller to home an axis. • Homing with reference cam, reference with zero pulse • Homing with reference cam, reference with cam (without zero pulse) • Referencing (without reference cam) with zero pulse • Homing with fast and slow reversal • Referencing by homing to fixed stop [} 31] Reference cam The reference cam executes a pre-positioning and precise homing is then executed with the zero pulse from the encoder. A cam switch determines whether the axis is located on or next to the cam. It is also possible to reference with cam without zero impulse. For example, this is a standard method with stepper motors in addition to referencing with “Move to fixed stop”. Repeatability with referencing Depending on the homing strategy and the hardware used, latching the axis position is executed either by the cam signal or the zero pulse. This permits exact speed-independent referencing. If the hardware used does not support this, the homing accuracy is dependent on the speed at which motion takes place on the cam. If the homing speed is selected, the maximum tolerance results from the sampling time of the function which executes position and cam detection. For example, a maximum deviation of 200 µm results from a homing speed of 6 m/min and a sampling rate of 2ms. Slide Drive HW-limit switches Reference cam SW-limit switches Zero pulse Fig. 1: Principle layout of limit switches and reference cam of a machine axis Zero pulse encoder After pre-positioning with a reference cam, referencing can be executed very precisely with a zero pulse encoder if the hardware supports latching the counter state when the zero pulse is received. In this case, the repeatability of referencing depends on the homing speed. It is also possible to reference with only one pulse which may occur once in the motion range and is therefore unique. This is often used with rotary axes. 10 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 11

Description Fitting the zero pulse encoder The search for a zero pulse is only activated by the NC kernel if the reference cam is operated. The encoder should therefore be fitted so that the zero pulse occurs about half an encoder rotation after the cam is operated. This produces reproducible referencing. If the zero pulse occurs simultaneously with the cam, the zero pulse is either detected or not de- pending on whether the reference cam is operated before or after the zero pulse occurs. Axis refer- encing can then by shifted by one encoder rotation. TF5200 | Twin CAT 3 CNC Version: 1.2 11 Homing
## Page 12

Description 2.1 Homing interfaces The figure shows the NC controller with its interfaces related to homing. Homing the assigned axes can be commanded in the individual channels either in • “Homing” mode or with the • NC command G74 in the NC program. Homing must be parameterised for every NC axis in the axis parameter list. GUI Interface via CNC objects Parameterisation of Axis para- homing meter list Axis 1 Channel 1 Channel 2 Channel n PLC Ref. Ref. . . . Ref. Commanding of homing HLI interface - implicitly: Operating mode homing - explicitly: G74 in NC-program NC-Kern Drive interface Zero pulse . . . Cams Axis 1 Axis 2 Axis m Fig. 2: Overview of NC controller CNC interface Referring to homing, the CNC has an object interface for the • GUI to command homing and • to request the axis status from the controller. 12 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 13

Description HLI interface The HLI interface is a memory-coupled interface for the NC controller to communicate with the PLC. This interface is described in detail in [HLI]. The HLI interface is used to: • command homing and • request the axis status. The cam signal is supplied to the NC via the HLI interface,. The periphery reads the cam signal and writes the signal to the HLI interface. This is executed in the PLC (see also [HLI]). Drive interface The drive interface is used to connect NC axes to the controller via various drive types. TF5200 | Twin CAT 3 CNC Version: 1.2 13 Homing
## Page 14

Description 2.2 Commanding and execution Homing is commanded either for “Homing ” mode or by the NC command G74 for specific channels. This command can be executed either in a manual block or in an NC program. When referencing, the axis adopts the reference position P-AXIS-00152 (pos_refpkt) from the axis parameter list and stops. NC program Homing is started either: • implicitly in homing mode with the default homing program rfp.nc or • explicitly with any NC program that started in ‘Automatic’ mode or with a manual block which is executed in MDI mode. Homing sequence of axes The NC command G74 specifies the axes to be referenced and the sequence in which the axes are to execute homing. A • sequential and a • parallel command of the axes are possible. The values programmed with the axis names define the homing sequence. For axes with the same value, homing is triggered simultaneously (see also [PROG]). Sequential commanding In the example below, axes Z, X, Y, A and B are commanded sequentially, i.e. Z is referenced before X starts homing, etc. … N10 G74 Z1 X2 Y3 A4 B5 … This mode may be required, for example, to move the Z tool axis out of a collision zone with the workpiece or other axes. The other axes are then referenced. 14 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 15

Description Parallel commanding In the example below, homing is executed in parallel (simultaneously) for the axes X, Y A and B. … N10 G74 X1 Y1 A1 B1 … This mode is ideal due to the shorter time required at low homing speeds and the large motion range of the axis. Another reason may be kinematic axis couplings which do not permit sequential homing. NC program for referencing In the example below, the Z axis is first referenced and moved to safety height. In the next NC block, the axes X and Y are then commanded in parallel and afterwards the axes A and B are also commanded in par- allel. Finally, spindle S is referenced. %RPF. NC N10 G74 Z1 (optional: move Z to safety height) N15 G01 G90 Z200 F500 N20 G74 X1 Y1 A2 B2 S3 … (optional: move axes to home position) N30 G01 X0 Y20 Z0 A90 F1000 N40 SPOS0 S500 ... N40 M30 After homing is completed, the axes can be positioned by a motion command to any position within the software limit switch. It is also possible to execute any initialisation here. Drive-controlled referencing Drive-controlled referencing describes homing which is executed independently by the drive. The NC controller commands the drive to reference its axis and at the end of homing it receive confirmation from the drive whether reference was executed successfully. Homing is only parameterised in the drive. The CNC support drive-controlled referencing by drives with SERCOS interface. Except for P-AXIS-00014 all homing parameters in the axis parameter list only apply to NC-con- trolled referencing. NC-controlled referencing With NC-controlled referencing the entire homing sequence is determined by the NC controller. Homing can be parameterised for each axis using the homing parameters in the axis parameter list. Depending on the homing strategy selected, the reference cam signal may have to be provided on the HLI. Supported drive types NC-controlled referencing is supported for the following drive types: • Drive simulation (by digital filters) • Profidrive • Terminal (+/-10V drives with incremental encoders, transparent access via field buses) • Lightbus • Real-time Ethernet TF5200 | Twin CAT 3 CNC Version: 1.2 15 Homing
## Page 16

Description At present, NC-controlled referencing is only supported for drives with SERCOS interface without zero pulse search. Drive simulation The NC controller supports the “Simulation” drive type, i.e. every axis can be simulated, for example if there is no physical drive (±10V, stepper motor, etc.) present at the time of machine commissioning or if the controller is to be tested completely without physical drives. Homing can also be selected for this drive type. Referencing these axes is simulated and this can be set in the axis parameter list by corresponding parameters. Gantry coupling With a gantry coupling, the parameter P-AXIS-00074 can suppress homing of the gantry slave axis. The reference position is then adopted by the gantry master axis on completion of homing and monitoring the gantry difference between the master and slave axes can be started. In another case, homing can also be executed for gantry slave axes after the master axis is referenced. In both cases, the other mechanically coupled axis is tracked. 16 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 17

Description 2.3 Sequence strategies for homing The homing sequence of a machine axis is dependent on various factors, e.g.: • Is a reference cam present? • Is a zero pulse signal triggered? • Should the reference cam be approached with cam clearance? The various sequence strategies for homing are divided into the following methods and then described in greater detail: • Default homing • Flying homing for spindles • Special homing methods Default homing For the default homing, it is assumed that a reference cam switch is present and the position counter can be latched by a cam or zero pulse signal. The chronological sequence of default homing normally occurs in 3 phases: • Phase 1: Move to reference cam • Phase 2: Move away from reference cam • Phase 3: Move to reference cam with referencing The 3-phase default homing has 2 changes of direction. The motions can be parameterised at 2 different velocities. Individual phases can be skipped with variants of this homing. Homing can then be reduced to a single phase. In this case, no change of direction is executed. Flying homing for spindle axes Flying homing is only available for spindle axes. The spindle axis must be referenced in order to set up a spindle axis, i.e. position with M19. If the spindle axis is not referenced or if the reference point was lost, the spindle axis executes homing automatically. Flying homing is executed while the spindle axis is rotating without standstill. Special homing methods In special cases, default homing cannot be executed. The special homing methods below list further options to reference an axis according to the related parameterisation. • Referencing with motion away from cam • Referencing without reversal • Referencing only with zero pulse without reference cam • Referencing in the direction of the valid motion range by reversing the reference direction and reversing the cam signal level • Referencing by motion to fixed stop TF5200 | Twin CAT 3 CNC Version: 1.2 17 Homing
## Page 18

Description 2.3.1 Default homing Default homing is the most commonly used method in practice to reference machine axes. Condition • Default homing requires the presence of a reference cam. • Default homing executes the cam clearance of the machine axis. • In general, a counter hardware with latch input is required to achieve high referencing accuracy. Parameterisation P-AXIS-00156 (ref_ohne_nocken) 0 , with reference cam P-AXIS-00157 (ref_ohne_rev) 0 , with cam clearance Chronological sequence The chronological sequence of default homing normally occurs in 3 phases: • Phase 1: Move to reference cam • Phase 2: Move away from reference cam • Phase 3: Move to reference cam with referencing The figures below show the sequence of default homing. Zero pulse When referencing with zero pulse and with the required hardware support, the zero pulse results in the immediate latching of the counter value provided the strobe input was previously activated. In this way, the motion velocity has no influence on referencing accuracy when referencing is executed with zero pulse evaluation. A zero pulse is not necessarily required for default homing. The zero pulse is evaluated in Phase 3 during the referencing process when the reference cam switch is operated. Referencing only with reference cam without zero pulse reduces referencing accuracy depending on the motion velocity. Referencing without zero pulse is depicted in Figure 2‑3. The following velocity-path diagrams show in simplified form the acceleration and deceleration phases as linear straight lines. 18 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 19

Description Fig. 3: Default homing in time range Fig. 4: Default homing TF5200 | Twin CAT 3 CNC Version: 1.2 19 Homing
## Page 20

Description 2.3.1.1 Phase 1: Move to reference cam Parameterising P-AXIS-00158 (ref_richt) Referencing direction Phase 1 P-AXIS-00219 (vb_refmax) Fast referencing velocity Start of Phase 1 Homing is started by the NC command G74 or by starting the 'Homing’ mode. The machine axis is at standstill and homing is in preparation. The starting point for Phase 1 can be 2 situations: • Axis located in front of cam • Axis located on cam Axis located in front of cam The machine axis accelerates to fast referencing velocity P-AXIS-00219 (vb_refmax) in the referencing direction P-AXIS-00158 (ref_richt). The CNC controller is notified via the HLI interface when the reference cam is reached and the machine axis is then decelerated to standstill. Phase 1 is terminated and the process continues with Phase 2. Axis located on cam If the reference cam is already operated when homing starts, Phase 1 is not executed. The machine axis remains at its starting position. Phase 1 is terminated and the process continues with Phase 2. 20 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 21

Description 2.3.1.2 Phase 2: Move away from reference cam Parameterising P-AXIS-00064 (fast_from_cam) Slow or fast motion away from Phase 2 reference cam. P-AXIS-00158 (ref_richt) Referencing direction P-AXIS-00219 (vb_refmax) Fast referencing velocity P-AXIS-00218 (vb_reflow) Slow referencing velocity Start of Phase 2 Phase 2 is started automatically if Phase 1 was completed successfully and the machine axis is located on the reference cam. Execute Phase 2 The machine axis accelerates to the parameterised reference velocity and moves in the opposite reference direction P-AXIS-00158 (ref_richt) away from the reference cam. The CNC controller is notified of the machine axis when it leaves the reference cam. The machine axis is then decelerated to standstill. The parameter P-AXIS-00064 (fast_from_cam) defines whether the referencing velocity is slow or fast in Phase 2. Phase 2 is terminated and the process continues with Phase 3. TF5200 | Twin CAT 3 CNC Version: 1.2 21 Homing
## Page 22

Description 2.3.1.3 Phase 3: Move to reference cam with referencing Parameterising P-AXIS-00084 With or without zero pulse Phase 3 (homing_without_zero_pulse) P-AXIS-00158 (ref_richt) Referencing direction P-AXIS-00218 (vb_reflow) Slow referencing velocity, e.g. 15000 [μm/s] Start of Phase 3 Phase 3 is started automatically if Phase 2 was completed successfully and the machine axis is no longer located on the reference cam. The reference position can be searched by: • the zero pulse or • the reference cam. Referencing with zero pulse Fig. 5: Homing in 3 phases, referencing to the reference cam with zero pulse 22 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 23

Description Referencing with reference cam Fig. 6: Homing in 3 phases, referencing to the reference cam with zero pulse With this parameterisation, reference is executed on the positive edge of the cam signal in Phase 3, i.e. during motion to the cam. Referencing is executed when the cam switch is operated in the Phase 3 of the homing sequence. With this method, the referencing accuracy is defined by the axis velocity (vb_reflow) in Phase 3 and the sampling time since the position is only adopted at discrete times and the position value is not latched as with zero pulse evaluation. This method is used in stepper motor applications without incremental encoder, for example. A generally acceptable accuracy is attainable here if P-AXIS-00218 (vb_reflow) is initialised so that the motor moves at one increment per sampling cycle in the 3rd phase. This method is also used for “separable” drives (toothed rack, pinion) where the zero pulse signal is not normally used. TF5200 | Twin CAT 3 CNC Version: 1.2 23 Homing
## Page 24

Description 2.3.2 Flying homing for spindle axes Description The parameters P-AXIS-00157 (ref_ohne_rev) and P-AXIS-00156 (ref_ohne_ nocken) are used to define the homing strategy. • "ref_ohne_rev" defines whether the axis should have a cam clearance. • "ref_ohne_nocken" defines whether only the zero pulse signal is evaluated for homing or whether the cam signal is also evaluated. Conventional homing is executed if both "ref_ohne_rev" and "ref_ohne_nocken” are set to FALSE. The combination of setting "ref_ohne_rev" to FALSE and "ref_ohne_nocken" to TRUE is impractical since cam signal evaluation is required for cam clearance. The variable "ref_ohne_rev” must be set to TRUE to execute flying homing from endless rotation without reversal. The table below shows the settings for the various RFP (homing) types. ref_ohne_rev = FALSE ref_ohne_rev = TRUE ref_ohne_nocken = FALSE conventional homing flying homing with cam ref_ohne_nocken = TRUE impermissible setting flying homing without cam With conventional axes and simulation axes, the position controller is enabled automatically for homing if homing was previously disabled. A specific homing position exists for each gear speed and this is specified in the axis machine record. In general, the CNC automatically executes homing before setting up the spindle axis (M19, move to gear change position or axis position) if the reference point is not valid (any more). For example, if the maximum encoder frequency is exceeded by a speed that is too high. However, from endless rotation this can only be executed if the parameter “ref_ohne_rev” is set to TRUE. Otherwise, an error message is output and a transition takes place to error state. When SERCOS drives are referenced drive-controlled, the automatic RPF mechanism must be suppressed. In this case, set the ACHSMODE_KEINE_AUTO_RPF bit to axis mode (P- AXIS-00015) in the axis machine record. 24 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 25

Description 2.3.2.1 Homing without reversal Homing without reversal With homing without reversal and when the spindle is at standstill, the motion accelerates to the speed P- AXIS-00218 (vb_reflow) in the axis machine record. The spindle is accelerated not to the current limit but with default ramps. The rotation direction is initialised with the homing direction P-AXIS-00158 (ref_richt). When the spindle machine data is initialised, a check is made whether a preferred direction is specified for the spindle. If this does not match the specified homing direction, an error message is output. If the spindle executes homing from endless rotation, it first accelerates or decelerates to the homing speed “vb_reflow” before being references. The referencing direction is identical to the endless rotation direction. The spindle is set up with programmed speed and rapid traverse speed after homing without motion stop. This means that flying homing takes place. Positioning takes ´place in the direction in which homing was executed, even if this does not match the specified rotation direction. Homing without spindle reversal can basically be executed in two methods. The method is defined by the value (TRUE/FALSE) of the variable P-AXIS-00156 (ref_ohne_nocken) in the axis machine record. Parameterisation ref_ohne_nocken 0 Read cam and zero pulse This is used to trigger both the reference point cam and the zero pulse. The reference point cam is triggered at the point when the ‘not operated’ edge changes. This means that, if the cam is currently operated, the spindle is rotated until the cam is not operated. Parameterisation ref_ohne_nocken 1 Only the zero pulse is used for triggering. This method can be used if only one zero pulse is triggered per spindle rotation. TF5200 | Twin CAT 3 CNC Version: 1.2 25 Homing
## Page 26

Description Spindle modes (not SERCOS) Fig. 7: State graph of spindle modes 26 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 27

Description Homing with SERCOS drives Drive-controlled homing is used for SERCOS drives. This means that the ACHSMODE_KEINE_AUTO_RPF bit must be set in the parameter “achs_mode” in the axis machine record for the spindles to prevent automatic referencing. The parameters “ref_ohne_rev” and “ref_ohne_nocken” are then no longer evaluated. Before it is set up, a spindle with SERCOS drive must be subjected to explicit homing (via the auto- matic program or via a manual block). Otherwise an error message is output. Spindle modes with SERCOS SERCOS M19 Discrete Motion Continuous Motion M5 Done M19 M3/M4 Standstill Done G74 Homing Fig. 8: State graph of spindle modes for digital drives (e.g. SERCOS) TF5200 | Twin CAT 3 CNC Version: 1.2 27 Homing
## Page 28

Description 2.3.3 Special homing methods In special cases, default homing cannot be applied. The special homing methods below list further options to reference an axis according to the related parameterisation. • Referencing with motion away from cam • Referencing without reversal • Referencing only with zero pulse without reference cam • Referencing in the direction of the valid motion range by reversing the reference direction and reversing the cam signal level • Referencing by motion to fixed stop 2.3.3.1 Referencing with motion away from cam Referencing takes place on the falling edge using a simple method, i.e. by inverting the motion dir- ection during referencing (ref_richt) and the cam switch signal level (cam_level). Providing the cam switch is operated at the start of homing, this is then a 3-phase homing. This method has advantages if the reference position is outside the corresponding software limit switch in the method described above. The following changes result for the above example: Parameterisation P-AXIS-00038 (cam_level) 0 P-AXIS-00158 (ref_richt) 0 Fig. 9: Referencing at motion away from reference cam (without zero pulse) 2.3.3.2 Homing without reversal Referencing in 1 phase Referencing in one phase is executed without change in direction Examples for translatory axes 28 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 29

Description NOTICE Referencing in one phase is optional but should not be used in reality. Please note here that the axis many not be located on the reference cam at the start of homing. This check is executed by the PLC. Parameterisation P-AXIS-00156 0, reference cam present (ref_ohne_nocken) P-AXIS-00084 0, with zero pulse (homing_without_zero_pulse) P-AXIS-00157 (ref_ohne_rev) 1, no reversal Referencing with zero pulse Fig. 10: Move to reference cam with zero pulse (1 phase) TF5200 | Twin CAT 3 CNC Version: 1.2 29 Homing
## Page 30

Description Referencing without zero pulse Parameterisation P-AXIS-00156 0, reference cam present (ref_ohne_nocken) P-AXIS-00084 1, no zero pulse (homing_without_zero_pulse) P-AXIS-00157 (ref_ohne_rev) 1, no reversal Fig. 11: Move to reference cam without zero pulse (1 phase) 30 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 31

Description 2.3.3.3 Referencing with zero pulse without reference cam Parameterisation P-AXIS-00084 0, with zero pulse (homing_without_zero_pulse) P-AXIS-00156 1 , without reference cam (ref_ohne_nocken) P-AXIS-00157 1, no reversal (ref_ohne_rev) P-AXIS-00158 Referencing direction (ref_richt) P-AXIS-00218 slow referencing velocity (vb_reflow) Process Fig. 12: Referencing with zero pulse without reference point cam 2.3.3.4 Referencing by homing to fixed stop Function available as of V3.1.3080.11. Referencing by motion to fixed stop is a CNC-controlled homing function. The axis is then moved to a fixed stop at reduced velocity and limited torque. After a fixed stop is detected, the actual value of the machine axis is synchronised with the axis coordinate system of the machine and the CNC by means of the actual position sent by the drive and the parameterised reference point. This type of homing is only possible with SERCOS and CANopen drives. If a different drive type is used, the error ID 110371 is output. The existing homing to a fixed stop function is supported for DSE drives with one spindle. The parameterisation for this is under “NC-controlled homing to fixed stop with DSE drives [} 35]”. 2.3.3.4.1 Process for homing to fixed stop In order for homing to fixed stop to function, the position lag monitor in the drive must be disabled or the limit value must be set to a higher setting. In addition , the maximum torque of the drive must be limited. TF5200 | Twin CAT 3 CNC Version: 1.2 31 Homing
## Page 32

Description This is achieved by writing the drive parameters to the drive. The detection criteria are checked during homing. The criteria consist of the position lag, velocity and drive torque and can be used singly or in combination to detect the fixed stop. When the fixed stop is detected, the actual position sent by the drive is transferred to the CNC. The axis is then moved away from the fixed stop by the retraction distance parameter. Axis position after homing After homing is complete, the axis is not located at its reference point. This is due to the retraction distance that is retracted after the fixed stop is reached. 2.3.3.4.2 Parameterisation The following parameters are relevant for homing to fixed stop: Parameter ID Parameter Description P-AXIS-00270 getriebe[i].slope_type Slope type P-AXIS-00299 kenngr.homing_type Homing type (TORQ) P-AXIS-00333 getriebe[i].homing.torq_move_vel Velocity during homing to a fixed stop ocity P-AXIS-00334 getriebe[i].homing.torq_move_acc Acceleration during homing to a fixed stop eleration P-AXIS-00344 kenngr.homing.torq_min_distance Minimum distance before detection of a fixed stop. P-AXIS-00345 kenngr.homing.torq_max_distanc Maximum motion path during homing e P-AXIS-00346 kenngr.homing.torq_homing_dir Direction of reference point travel P-AXIS-00347 kenngr.homing.torq_detect_veloci Percentage residual velocity at which the fixed ty_limit stop is considered detected. P-AXIS-00348 kenngr.homing.torq_retraction_dis Retraction distance after detection of the fixed tance stop P-AXIS-00349 kenngr.homing.torq_homing_posit Position of the fixed axis ion P-AXIS-00350 kenngr.homing.torq_detect_time Minimum time to meet the detection criteria and detect a fixed stop. P-AXIS-00819 kenngr.homing.torq_detect_pos_l Position lag at which the fixed stop is considered ag_limit detected. P-AXIS-00820 kenngr.homing.torq_detect_torqu Percentage torque at which the fixed stop is e_limit considered detected. The special detection criteria can be used singly or in any combination. However, at least one criteria must be used. If this is not the case, the following general detection parameters are used for fixed stop detection. 32 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 33

Description Fig. 13: Influence of parameters during motion to a fixed stop General detection parameters for fixed stop detecton. Parameter ID Parameter Description P-AXIS-00769 antr.fixed_stop.detect.pos_lag_lim Position lag at which the fixed stop is considered it detected. P-AXIS-00817 antr.fixed_stop.detect.detect_velo Percentage residual velocity at which the fixed city_limit stop is considered detected. P-AXIS-00818 antr.fixed_stop.detect.detect_torq Percentage torque at which the fixed stop is ue_limit considered detected. If these criteria are also not parameterised, the criterion to detect the fixed stop is not used. 2.3.3.4.3 Drive parameters For homing to fixed stop, it is essential to reduce the drive torque and disable the position lag monitor in the drive. Therefore, the drive parameters used are the same as for “Moving to a fixed stop”. Parameter ID Parameter P-AXIS-00719 antr.fixed_stop.drive_ident[i].id P-AXIS-00720 antr.fixed_stop.drive_ident[i].commu P-AXIS-00721 antr.fixed_stop.drive_ident[i].wr_ident P-AXIS-00722 antr.fixed_stop.drive_ident[i].data_type P-AXIS-00723 antr.fixed_stop.drive_ident[i].startup_value P-AXIS-00724 antr.fixed_stop.drive_ident[i].scaling_type TF5200 | Twin CAT 3 CNC Version: 1.2 33 Homing
## Page 34

Description Parameter ID Parameter P-AXIS-00725 antr.fixed_stop.drive_ident[i].max_limit P-AXIS-00726 antr.fixed_stop.drive_ident[i].min_limit P-AXIS-00727 antr.fixed_stop.drive_ident[i].mask P-AXIS-00728 antr.fixed_stop.drive_ident[i].scaling_factor P-AXIS-00729 antr.fixed_stop.drive_ident[i].active_value P-AXIS-00730 antr.fixed_stop.drive_ident[i].use_startup_value P-AXIS-00731 antr.fixed_stop.drive_ident[i].rd_ident P-AXIS-00821 antr.fixed_stop.drive_ident[i].default_ident At the commencement of homing, the drive parameters are written to the drive and only reset at the end or in the event of a fault. 2.3.3.4.4 Drive simulation The NC controller supports the “Simulation” drive type (P-AXIS-00020), i.e. any axis can be simulated, for example if there is no physical drive (±10V, stepper motor, etc.) present at the time of machine commissioning or if the controller is to be tested completely without physical drives. Homing can also be selected for this drive type. Referencing these axes is simulated and this can be set in the axis parameter list by corresponding parameters. The parameter P-AXIS-00822 specifying the distance to detect the fixed stop is required for homing to fixed stop. 2.3.3.4.5 Gantry coupling With a gantry coupling, the parameter P-AXIS-00074 can suppress homing of the gantry slave axis. The reference position is then adopted by the gantry master axis on completion of homing and monitoring the gantry difference between the master and slave axes can be started. In another case, homing can also be executed for gantry slave axes after the master axis is referenced. In both cases, the other mechanically coupled axis is tracked. The retraction distance after detection of the fixed stop (P-AXIS-00348) of the master axis must be greater than the resettable distance to go (P-AXIS-00072) of the slave axes. This ensures the reliable clearance of the gantry difference. If this is not the case, the resettable distance is set to the retraction distance value and the warning ID 70651 is output. With gantry slave axes, the retraction distance parameterised in the master axis is used for the retraction distance after detection of the fixed stop. NOTICE With a gantry configuration, the fixed stops of all gantry axes must be positioned so that they are detected at the same time. 2.3.3.4.6 Example parameters for a SERCOS drive kenngr.homing_type TORQ kenngr.homing.torq_homing_position 100000 # [0.1µm] kenngr.homing.torq_homing_dir POSITIVE kenngr.homing.torq_retraction_distance 50000 # [0.1µm] kenngr.homing.torq_max_distance 200000 # [0.1µm] kenngr.homing.torq_min_distance 0 # [0.1µm] kenngr.homing.torq_detect_time 25000 # [µs] kenngr.homing.torq_detect_pos_lag_limit 2000 # [0.1µm] kenngr.homing.torq_detect_velocity_limit 300 # [0.1%] kenngr.homing.torq_detect_torque_limit 600 # [0.1%] 34 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 35

Description getriebe[0].homing.torq_move_acceleration 50 # [mm/s^2] getriebe[0].vb_not_referenced 2000 # [µm/s] antr.fixed_stop.drive_ident[0].id TORQUE_LIMIT antr.fixed_stop.drive_ident[0].commu ACYCLIC antr.fixed_stop.drive_ident[0].wr_ident S_0_0092 antr.fixed_stop.drive_ident[0].data_type UNS16 antr.fixed_stop.drive_ident[0].startup_value 1000 antr.fixed_stop.drive_ident[0].scaling_type UNSCALED antr.fixed_stop.drive_ident[0].max_limit 1000 antr.fixed_stop.drive_ident[0].min_limit 0 antr.fixed_stop.drive_ident[0].mask NOT_USED antr.fixed_stop.drive_ident[0].scaling_factor 1 antr.fixed_stop.drive_ident[0].active_value 50 antr.fixed_stop.drive_ident[0].use_startup_value 0 antr.fixed_stop.drive_ident[0].rd_ident # Leerstring antr.fixed_stop.drive_ident[0].default_ident 0 antr.fixed_stop.drive_ident[1].id MON_WINDOW antr.fixed_stop.drive_ident[1].commu ACYCLIC antr.fixed_stop.drive_ident[1].wr_ident S-0-0159 antr.fixed_stop.drive_ident[1].data_type UNS32 antr.fixed_stop.drive_ident[1].startup_value 7000 antr.fixed_stop.drive_ident[1].scaling_type UNSCALED antr.fixed_stop.drive_ident[1].max_limit 429496729 antr.fixed_stop.drive_ident[1].min_limit 0 antr.fixed_stop.drive_ident[1].mask NOT_USED antr.fixed_stop.drive_ident[1].scaling_factor 1 antr.fixed_stop.drive_ident[1].active_value 429496728 antr.fixed_stop.drive_ident[1].use_startup_value 0 antr.fixed_stop.drive_ident[1].rd_ident # Leerstring antr.fixed_stop.drive_ident[1].default_ident 0 2.3.3.5 NC-controlled homing to fixed stop with DSE drives In order to use this referencing method, the axis parameter P-AXIS-00299 (kenngr.homing.homing_type) must be parameterised with the value TORQ. This referencing method is implemented for the following drive interfaces (see P-AXIS-00020): Value Meaning 0x0004 Drive simulation 0x0009 Generic drive interface Other general parameters must be assigned values to define how homing is to run with motion to a fixed stop. They are In the axis list, they are indicated by the prefix kenngr.homing. prefix; see table: General parameters for referencing to fixed stop Name Dimension Value range Description torq_min_distance 0.1 µm < torq_max_distance Minimum distance up to detection of the reference position (P-AXIS-00344) torq_max_distance 0.1 µm 0 ... MAX_SGN23 Maximum distance up to detection of the reference position (P-AXIS-00345) torq_homing_dir [POSITIVE, NEGATIVE] Direction of reference point travel (P-AXIS-00346) torq_detect_velocity_limit 0.1% 0 ... 1000 Speed limit for detection of the reference position (P-AXIS-00347) torq_retraction_distance 0.1 µm MAX_SGN32 Withdrawal distance after detection of the reference position (P-AXIS-00348) torq_homing_position 0.1 µm MAX_SGN32 Reference position (P-AXIS-00349) TF5200 | Twin CAT 3 CNC Version: 1.2 35 Homing
## Page 36

Description torq_detect_time µs MAX_UNS32 Minimum time that the limit torque must be exceeded for the (P-AXIS-00350) reference position to be detected. The parameters that are dependent on the gear stage are indicated by the prefix getriebe[X].homing. In this case, an ordinal number must be entered for X for each gear stage; see table: Gear stage-specific parameters for referencing to fixed stop Name Dimension Value range Description torq_move_acceleration mm/s2 <= a_max Acceleration (P-AXIS-00334) torq_move_velocity µm/s <= vb_max Velocity for axis motion (P-AXIS-00333) torq_move_torque_limit 0.1% 0 ... 1000 Percentage torque limit for motion (P-AXIS-00342) torq_detect_torque_limit 0.1% 0 ... 1000 Limit for detection of the standing axis. Percentage value referred to (P-AXIS-00343) torq_move_torque_limit. The graphic below shows the way in which the parameters listed have an influence on motion to a fixed stop. Fig. 14: Influence of parameters during motion to a fixed stop 36 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 37

Description 2.4 Monitoring during homing 2.4.1 Path monitoring The parameter P-AXIS-00412 can execute path monitoring for spindles and rotary axes. This checks whether the reference position was found within a distance from the homing start position. This distance is parameterisable by P-AXIS-00412. What is meant here is whether the reference cam and/or the zero pulse was found, for example. 2.5 Monitoring after homing 2.5.1 Reference loss (reference monitoring) Reference monitoring is currently possible only for the SERCOS drive type (see P-AXIS-00020). In the case of all other drive types, the error message ID 110548 is output when reference monitoring is activated. Motivation In most cases it is desirable to check whether an axis that was referenced once has lost its reference. For example, when absolute encoders are used that store internal working data in a memory with battery backup, it may happen after a few years that the backup battery is exhausted and the absolute encoder supplies an incorrect position. Equally, when drive amplifiers are parameterised and decisive parameters are changed, it can happen that an already referenced axis loses its reference again. In both cases, this leads to an unexpected shift in the position supplied by the drive relative to the mechanical position of the axis. This may result in damage to the machine. To prevent this, an option was devised to check whether an axis has lost its reference. Operating principle In reference monitoring, a signal generated in the drive controller indicates whether the axis is referenced. The signal is transferred via the cyclic process data to the CNC. There a check is made whether the expected state of this signal is correct. This 'axis is referenced' signal is referred to below as the reference signal. For example, for an absolute value encoder, the axis is referenced immediately after the start of cyclic data transfer. For an axis without absolute value encoder, the axis is referenced as soon as drive-controlled homing is completed successfully. The CNC controller has the possibility to compare the reference signal supplied by the drive with the internally calculated expected reference signal and to output an error message in the event of deviations. TF5200 | Twin CAT 3 CNC Version: 1.2 37 Homing
## Page 38

Description Parameterisation The parameterisation basically defines transfer of the reference signal from the drive to the CNC. The name of the cyclic process data item that transfers the reference signal must then be specified in the axis parameter P-AXIS-00426. If the reference signal is transferred in one of the real-time status bits of the SERCOS status word, the value "S-0-0135" must be entered in P-AXIS-00426. The signal status word need not be explicitly configured in the input process data because it is always configured automatically. If the name configured in P-AXIS-00426 was not found in the cyclic input process data, the error message ID 70401 is output and reference monitoring is deactivated. Activation/effect Reference checking is activated as soon as valid values are configured for the axis parameters P- AXIS-00425 and P-AXIS-00426. When reference checking is active, the error message ID 70400 is output as soon as the CNC detects a discrepancy between the reference signal returned by the drive and the CNC's internal reference signal. Parameterisation example 1 A reference check is to be executed for a SERCOS drive. The reference signal should be transferred via the real-time status bit 1. Parameterisation in the drive: The reference signal must be assigned to the real-time control bit 1 in the drive. This takes place by assigned the value S-0-403 (status of actual value position) to the drive parameter S-0-305 (assign real-time status bit 1). Axis parameters: Since the reference signal is read from the real-time status bit of the status word, the value "S-0-0135" must be entered in P-AXIS-00426. The real-time status bit 1 in the status word is the bit with the number 6 (counted from 0) and so the value 6 must be entered in P-AXIS-00425. antr.homing_check.element_name S-0-0135 antr.homing_check.bit_nr 6 38 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 39

Description Parameterisation example 2 A reference check is to be executed for a SERCOS drive. The reference signal should be transferred via bit 2 of the drive parameter P-0-4078. Parameterisation in the drive: The parameter P-0-4078 must be configured in the cyclic process data of the drive. Axis parameters: Since the reference signal is read from P-0-4078, the value "P-0-4078" must be entered in P-AXIS-00426. The reference signal in P-0-4078 is the bit with the number 2 (counted from 0) and so the value 2 must be entered in P-AXIS-00425 antr.sercos.at[1].ident_nr 36846 antr.sercos.at[1].ident_len 2 antr.sercos.at[1].nc_ref P-0-4078 antr.homing_check.element_name P-0-4078 antr.homing_check.bit_nr 2 TF5200 | Twin CAT 3 CNC Version: 1.2 39 Homing
## Page 40

Description 2.6 Delayed activation of zero pulse logic Activation A path offset can be specified in the parameter “kenngr.shift_offset_zero_pulse_activation“ P-AXIS-00494 for CNC-controlled homing (see P-AXIS-00299) in order to delay activation of the zero pulse logic after the reference cam is operated. This parameter is 0 in the default setting. The zero pulse logic is immediately enabled when the reference cam is operated. Operating principle If the reference cam and zero pulse are located close together, the zero pulse may not be detected reliably since detection of the next or the next but one zero pulse depends on the activation speed of the reference cam. See figure below: Zero pulse Zero pulse Resulting home position Case 1 Cam Offset reference cam - Activation of zero Homing direction zero pulse pulse logic Case 2 Cam Offset reference cam - zero pulse One encoder rotation Fig. 15: The zero pulse may not be reliably detected In this case a shift of the activation point for the zero pulse logic ensures that the identical zero pulse is always detected: 40 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 41

Description Zero pulse Zero pulse Resulting home position Case 1 Cam Shift offset Activation of zero Homing direction P-AXIS-00493 pulse logic Case 2 Cam Shift offset P-AXIS-00493 One encoder rotation Fig. 16: Activation time shift of zero pulse logic ensures identical zero pulse After homing, the position offset between the activation of the reference cam and detection of the zero pulse can be read out via the CNC object “reference cam - zero pulse offset”: • Geo task, • index group: 0x20300/ • index offset: 0x10000 * (axis_index + 1) + 0x11C Examples 1. axis -> index offset 0x1011C 3rd axis -> index offset 0x3011C, TF5200 | Twin CAT 3 CNC Version: 1.2 41 Homing
## Page 42

Parameterisation 3 Parameterisation Homing is parameterised axis-specific in the axis parameter list of an axis. This is divided depending on its task into: • system parameters and • sequence parameters System parameters System parameters are used to make machine-specific settings in the drive system. The controller is notified of the information below in these parameters: • Is the axis equipped with reference cams? • Is zero pulse or cam signal used for referencing? • What signal level does the cam supply in operated state? Sequence parameters The sequence parameters define the response during homing. This includes, for example: • The velocity at which motion takes place in each of the homing phases. • The motion direction in which homing is started or executed. • The number of phases (single-phase or multi-phase) up to referencing. Effectiveness of parameters The section “Effectiveness of parameters” [} 50] provides an overview of the effectiveness of homing parameters depending on the homing strategy used. 42 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 43

Parameterisation 3.1 System parameters 3.1.1 Drive types The parameter P-AXIS-00020 sets the axis drive type. With certain drive types, e.g. Simulation, very few homing-specific parameters are significant. P-AXIS-00020 (antr_typ) 1. +/-10V drives with incremental encoders using a function library for I/O access (option) 2. SERCOS 3. Profidrive 4. Drive simulation (by digital filters) 5. Lightbus 6. Terminal (+/-10V drives with incremental encoders, transparent access via field buses) 7. Real-time Ethernet 3.1.1.1 Simulation axis Homing simulation For spindle axes, the variable P-AXIS-00157 (ref_ohne_rev) must then be set to TRUE in the axis machine record. Homing in drive simulation is executed automatically without cam. The homing sequence is identical to the sequence for conventional drives. The distance until the zero pulse is received must be set in the variable P-AXIS-00161 (rpf_weg_bis_nip) in the axis machine record. 3.1.1.2 SERCOS axis Homing for SERCOS SERCOS axes can be reference with the following methods: (The homing type executed is defined in the axis parameter P-AXIS-00299 (homing_type).) • Drive-controlled (default) In this case, only P-AXIS-00014 (abs_pos_gueltig) and P-AXIS-00015 (achs_mode) need be parameterised as CNC parameters. The homing sequence must be set in the drive • CNC-controlled with zero pulse latch. • CNC-controlled with zero pulse latch via probing input • CNC-controlled at encoder overflow. TF5200 | Twin CAT 3 CNC Version: 1.2 43 Homing
## Page 44

Parameterisation Drive-controlled homing Drive-controlled homing is the default setting for SERCOS axes. In drive-controlled homing, the CNC starts the SERCOS command S-0-148 in the drive and waits for the drive to acknowledge it. After acknowledgement, the CNC adopts the drive command values as CNC- internal command values. The homing sequence and the drive reference position are completely parameterised in the drive. The reference cam must be connected to the drive. This homing type is set by assigning the value ‘DRIVE_CONTROLLED’ to the axis parameter P-AXIS-00299 (homing_type). No drive-controlled homing is possible for SERCOS axes whose position control is executed in the controller. CNC-controlled with zero pulse latch via S-0-146 With CNC-controlled homing, all the sequence variants described in the section Sequence strategies for homing [} 17] are available. The zero pulse search is performed by executing the SERCOS command S-0-146 in the drive. After the zero pulse is detected in the drive, the actual position is switched over to the reference position in the drive and the CNC adopts this position. The reference position is set by the axis parameter P-AXIS-00152 (pos_refpkt). This value is transferred to the drive at the start of homing This homing type is set by assigning the value ‘CNC_CONTROLLED’ to the axis parameter P-AXIS-00299 (homing_type). The value 0 must be assigned to the axis parameter P-AXIS-00299) (homing_without_zero_pulse); the parameter P-AXIS-00386 (drive_supports_cnc_homing) activates use of the drive-internal zero pulse latch. For the zero pulse search sequence, the encoder used to perform homing must be entered in the parameter P-AXIS-00388 [} 65] (cnc_homing_encoder). In addition, control and status information must be transferred between the drive and the CNC to control the homing sequence. This can be performed either by using the real-time bits in the control or status word of the drive or by signal, control and status worlds. The axis parameter P-AXIS-00387 (cnc_homing_rt_bit_layout) sets how these bits are transferred. Control and status bits must also be assigned in the drive to match the set value of P-AXIS-00387. If the signal control and status words are used, they must be configured in the cyclic process data. The reference cam is evaluated in the CNC. It can either be transferred to the CNC via the HLI or via the real-time status bit of the status word, see P-AXIS-00321 (reference_cam_signal). The section SERCOS with zero pulse latch with S-0-146 [} 53] contains a parameterisation example. 44 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 45

Parameterisation CNC-controlled with manufacturer-specific zero pulse latch AX5000 For AX5000 drives from Beckhoff, a zero pulse latch can be executed by using the drive-internal latch logic without using the command S-0-146. The latched zero pulse is then transferred as measured value to the CNC: The CNC must then be parameterised for measuring with a SERCOS drive (see function description [FCT-C4]); in addition the occurrence of the zero pulse must be configured in the drive latch event. The CNC must be notified of the real-time control and real-time status bit used in the parameter kenngr.echtzeit_bit_nr (P-AXIS-00060). Please refer to the manufacturer’s documentation for information on drive parameterisation. With CNC-controlled homing, all the sequence variants described in the section Sequence strategies for homing [} 17] are available. The reference position is set by the axis parameter P-AXIS-00152 (pos_refpkt). This homing type is set by assigning the value ‘CNC_CONTROLLED’ to the axis parameter P-AXIS-00299 (homing_type). The value 0 must be assigned to the axis parameter P-AXIS-00299) (homing_without_zero_pulse). CNC-controlled at encoder overflow If the encoder used in the drive supplies an absolute position during a motor revolution (this means the encoder position does not change when the drive is switched off and back on), the encoder overflow can be used for referencing instead of the zero pulse The encoder can then mask and check a settable number of position value bits when this position overflows. This encoder overflow uniquely marks a mechanical motor position during a motor revolution and can then be used for referencing. With CNC-controlled homing, all the sequence variants described in the section Sequence strategies for homing [} 17] are available. This homing type is activated by setting the axis parameter P-AXIS-00294 (homing_overflow_evaluation) to 1. In addition set P-AXIS-00084 (homing_without_zero_pulse) to 0. The number of bits of the actual value position transferred by the drive and used to calculate overflow must be entered in axis parameter P-AXIS-00355 (encoder_bit_range). The axis parameter P-AXIS-00354 (encoder_overflow_offset) can shift the position of encoder overflow during a motor revolution. The reference position is set by the axis parameter P-AXIS-00152 (pos_refpkt). This referencing type only supplies reproducible results if the encoder used supplies an absolute position during a motor revolution. This means that, after the drive is switched off and on, the en- coder position supplied by the drive must be identical if the mechanical motor position is identical. If in doubt, please refer to the drive documentation or contact the drive manufacturer. TF5200 | Twin CAT 3 CNC Version: 1.2 45 Homing
## Page 46

Parameterisation 3.1.2 Drive systems with reference cam 3.1.2.1 Reference cam present With a drive system that has a reference cam, the system parameter P-AXIS-00156 (ref_ohne_nocken) must be set to 0. This is irrespective to whether the cam is only used for the homing sequence or also for referencing. P-AXIS-00156 (ref_ohne_nocken) 0: Reference cam present 1: Reference cam not present or used s Cam HW-limit switches SW-limit switches Fig. 17: Drive system with reference cam 3.1.2.2 Cam switch signal level The level when the cam switch is operated can be either logic 0 (0-active) or 1 (1-active). The sequence parameter P-AXIS-00038 (cam_level) sets the level. P-AXIS-00038 (cam_level) 0: 0-active 1: 1-active Cam signal level 0-Active 1-Active 0 s HW-limit switches SW-limit switches Cam Fig. 18: Cam signal level 46 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 47

Parameterisation 3.1.2.3 Access type on cam signal The controller read the cam signal axis-specific via the HLI interface. P-AXIS-00036 0: Supply the reference cam signal in the HLI interface by (cam_direct_access) the PLC 3.1.3 Drive systems with zero pulse If the drive system has a zero pulse signal for referencing, the parameter P-AXIS-00084 (homing_without_zero_pulse) must be set to 0. P-AXIS-00084 0: with zero pulse (homing_without_zero_pulse) 1: without zero pulse Zero pulse s HW-limit switches SW-limit switches Fig. 19: Drive system with zero pulse TF5200 | Twin CAT 3 CNC Version: 1.2 47 Homing
## Page 48

Parameterisation 3.2 Sequence parameters 3.2.1 Homing with or without reversal This parameter sets whether homing is to be executed in • one phase or in • several phases. P-AXIS-00157 (ref_ohne_rev) 0: with reversal - multi-phase 1: without reversal - single-phase 3.2.2 Motion direction during homing P-AXIS-00158 (ref_richt) 1: Positive motion direction (in the direction of positive axis coordinates) 0: Negative motion direction The motion direction specified in the parameter P-AXIS-00158 (ref_richt) defines the motion direc- tion if a cam switch is not operated for homing with cam (P-AXIS-00156 = 0). 3.2.3 Velocities for homing There are 2 velocities for homing: The parameter P-AXIS-00064 defines whether the homing velocity is faster or slower in phases 2 and 3. P-AXIS-00219 (vb_refmax) Fast velocity in [μm/s] or [°/s] P-AXIS-00218 (vb_reflow) Slow velocity in [μm/s] or [°/s] P-AXIS-00064 (fast_from_cam) 0: Reversal with vb_reflow 1: Reversal with b_refmax The following applies: P-AXIS-00219 (vb_refmax) ≥ P-AXIS-00218 (vb_reflow). 3.2.4 Homing acceleration Homing acceleration is set by the P-AXIS-00285 parameter. When a non-linear acceleration profile is used, the ramp time can be additionally set by the P-AXIS-00286 parameter. If P-AXIS-00285 (acceleration) and P-AXIS-00286 (ramp time) are not parameterised or have the value 0, the following values are used: • Acceleration: the minimum of the values P-AXIS-00005 and P-AXIS-00006 is used. • Ramp time: If the parameter is 0 or too small, the value of P-AXIS-00201 is adopted. 3.3 Reference position This parameter defines the position which is adopted by the controller – or the position controller – for referencing. This determines the required axis coordinate system. 48 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 49

Parameterisation P-AXIS-00152 (pos_refpkt) Definition of reference position in [0.1μm] or [0.0001 °] 3.4 Specific parameter for drive simulation This parameter is used for the “Drive simulation” drive type to define the distance up to referencing. In this case, homing is single-phase, i.e. with no reversal. No physical I/O is required. The settings of other homing parameters are irrelevant for this drive type except for the parameter listed below. P-AXIS-00161 (rpf_weg_bis_nip) Distance up to referencing is in [0.1μm] or [0.0001 °] TF5200 | Twin CAT 3 CNC Version: 1.2 49 Homing
## Page 50

Parameterisation 3.5 Effectiveness of parameters System parameters for homing: Measuring system type Not absolute absolute Only cam only zero pulse Cam and zero pulse I II III IV ref_ohne_nocken 0 1 0 - homing_without_zero_pulse 1 0 0 - abs_pos_gueltig 0 0 0 1 cam_direct_access 0 - 0 - cam_level X - X - Effective parameters with individual homing modes Measuring system type Not absolute absolute Only cam only zero pulse Cam and zero pulse I II III IV ref_ohne_rev X X X - ref_richt X X X - fast_from_cam X - X - pos_refpkt X X X - rpf_weg_bis_nip (simulation) - X X - vb_reflow X X X - vb_refmax X - X - 50 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 51

Parameterisation 3.6 Parameterisation examples 3.6.1 Conventional drives Excerpt from parameter list for X axis # ************************************************** # Axis machine data X axis # ************************************************** # kopf.achs_nr 1 kopf.mds_ident 1 kopf.log_achs_name X_axis ......................................... # kenngr.achs_mode 1 kenngr.achs_typ 1 ......................................... kenngr.ref_richt 0 kenngr.homing_without_zero_pulse 0 kenngr.fast_from_cam 1 kenngr.ref_ohne_nocken 0 kenngr.vorz_richtung 0 kenngr.beweg_richt 0 kenngr.ref_ohne_rev 0 ......................................... kenngr.antr_typ 5 kenngr.abs_pos_gueltig 0 # getriebe[0].nummer 1 ......................................... getriebe[0].lslope_profil.a_grenz_stufe_1 10000 getriebe[0].lslope_profil.a_grenz_stufe_2 10000 getriebe[0].lslope_profil.vb_grenz_stufe_1_2 600000 ......................................... getriebe[0].vb_refmax 100000 getriebe[0].vb_reflow 20000 ......................................... getriebe[0].pos_refpkt -2025000 ......................................... lr_hw[0].nummer 1 ......................................... lr_hw[0].cam_direct_access 0 End TF5200 | Twin CAT 3 CNC Version: 1.2 51 Homing
## Page 52

Parameterisation 3.6.2 Simulation Excerpt from parameter list for X axis # *************************************************** # Axis machine data X axis # *************************************************** # kopf.achs_nr 1 kopf.mds_ident 1 kopf.log_achs_name X_axis ......................................... # kenngr.achs_mode 1 kenngr.achs_typ 1 ......................................... kenngr.ref_richt 0 ......................................... kenngr.antr_typ 4 kenngr.abs_pos_gueltig 0 # getriebe[0].nummer 1 ......................................... getriebe[0].lslope_profil.a_grenz_stufe_1 10000 getriebe[0].lslope_profil.a_grenz_stufe_2 10000 getriebe[0].lslope_profil.vb_grenz_stufe_1_2 600000 ......................................... getriebe[0].vb_refmax 100000 getriebe[0].vb_reflow 20000 ......................................... getriebe[0].pos_refpkt -2025000 ......................................... antr_simu.rpf_weg_bis_nip 200 End 52 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 53

Parameterisation 3.6.3 SERCOS with zero pulse latch with S-0-146 CNC-controlled homing with zero point latch by command S-0-146. Encoder for homing is defined by reading out S-0-147. Bits 14 and 15 are used as real-time bits in the signal status and signal control word. Excerpt from parameter list kenngr.homing_type CNC_CONTROLLED kenngr.homing_without_zero_pulse 0 antr.sercos.drive_supports_cnc_homing 1 antr.cnc_homing_encoder 1 antr.sercos.cnc_homing_rt_bit_layout 16 The following parameters must be assigned in the drive: S-0-147: Bit 2 = 0, Bit 4 = 1 (bit numbers counted from 0 in each case). S-0-27 (assign signal control word): List element 14 = 407, List element 15 = 404. S-0-26 (assign signal status word): List element 14 = 408, List element 15 = 403. S-0-144 and S-0-145 must be configured in the cyclic process data. TF5200 | Twin CAT 3 CNC Version: 1.2 53 Homing
## Page 54

Parameter 4 Parameter 4.1 Overview ID Parameter Description P-AXIS-00014 abs_pos_gueltig Identification code for absolute path measurement system P-AXIS-00015 achs_mode Axis mode P-AXIS-00036 cam_direct_access Access to reference cam P-AXIS-00038 cam_level Signal level for reference cam signal P-AXIS-00064 fast_from_cam Slow / fast movement down to reference cam P-AXIS-00074 gantry_slave_no_homi Suppress homing for gantry slave axis ng P-AXIS-00084 homing_without_zero_ Referencing with or without zero pulse signal pulse P-AXIS-00152 pos_refpkt Position of the reference point P-AXIS-00156 ref_ohne_nocken Referencing with or without reference cam P-AXIS-00157 ref_ohne_rev Referencing with or without reversal P-AXIS-00158 ref_richt Motion direction when referencing P-AXIS-00161 rpf_weg_bis_nip Distance up to receipt of zero pulse with simulated homing P-AXIS-00218 vb_reflow Slow velocity of homing P-AXIS-00219 vb_refmax Fast velocity of homing P-AXIS-00294 homing_overflow_eval Referencing to encoder overflow uation P-AXIS-00299 homing_type Homing type P-AXIS-00321 reference_cam_signal Receipt of reference cam signal (SERCOS only) P-AXIS-00354 encoder_overlow_offse Encoder overflow offset t P-AXIS-00355 encoder_bit_range Encoder bit width for referencing to encoder overflow P-AXIS-00386 drive_supports_cnc_ho Execute CNC-controlled homing with zero pulse latch via S-0-146 ming (SERCOS only). P-AXIS-00387 cnc_homing_rt_bit_lay Assign the real-time control and status bits to the CNC-controlled out homing with zero pulse latch via S-0-146 (SERCOS only). P-AXIS-00388 cnc_homing_encoder Define the encoder used for homing. P-AXIS-00412 homing_max_moveme Maximum permitted distance for homing. nt_dist P-AXIS-00425 reference_check.bit_nr Bit number of the bit used for reference monitoring. P-AXIS-00426 reference_check.- Name of the cyclic process data element in which the reference element_name signal is transferred. P-AXIS-00494 shift_offset_zero_pulse Delayed activation of zero pulse logic for CNC-controlled homing. _activation 4.2 Description P-AXIS-00014 Identification code for absolute path measurement system Description If an absolute path measurement system is used, then the parameter must be set to 1. So no homing is necessary. Parameter kenngr.abs_pos_gueltig Data type BOOLEAN Data range 0/1 Axis types T, R, S 54 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 55

Parameter Dimension T: ---- R,S: ---- Default value 0 Drive types Simulation, SERCOS, CANopen Remarks P-AXIS-00015 Axis mode Description Axes can be traversed in different operating modes. Parameter kenngr.achs_mode Data type UNS32 Data range 0x00000001 - 0x10000000 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0x00000001 Drive types ---- Remarks TF5200 | Twin CAT 3 CNC Version: 1.2 55 Homing
## Page 56

Parameter The following operation modes can be parameterised(1): Value Meaning Axis Interpolator type type Description ACHSMODE_ path spindle 0x00000001 The axis is operated as a linear axis; .. LINEAR(1) T, R X no modulo calculation is executed in the channel. For example, rotary axis with restricted motion range; must be set as default for linear axes. 0x00000004 A modulo calculation always takes .. MODULO(1) R X X place after the destination position has been reached. Regardless of the operation mode selected for rotary axes, a modulo calculation is always executed in the position controller. In this way, modulo circle compensation can be executed if required. 0x00000040 Axis is used as a face turning axis .. PLANDREHEN T X (turning functions). 0x00000080 Axis is used as a longitudinal turning .. LAENGSDREHEN T X axis (turning functions). 0x00000100 For a spindle an automatic homing .. KEINE_AUTO_RPF R X before positioning the spindle can be pre-vented. This is only relevant if the axis is not referenced. The function is drive-dependent. 0x00000200 Axis for kinematic 'C axis' .. CAX R X X transformation. 0x00000400 Modulo calculation for linear axis. .. MODULO_LINEAR R X (Example: conveyor belt with drive motor where the position on the belt is programmed in mm). 0x00000800 Axis is released for mechanical .. CLAMPABLE T, R X blocking by the PLC. This axis mode is not available for Twin CAT systems. 0x00001000 Axis carries a rotary workpiece table. .. ROT_TABLE T, R X 0x00008000 Monitoring of axis collision. .. COLL_CHECK T X 0x00010000 Master axis of gantry coupling. .. GANTRY_MASTER T, R X 0x00020000 Slave axis of gantry coupling. .. GANTRY_SLAVE T, R X 0x00040000 Identifier for PLC spindle with axis .. SPINDLE_EXT_CT R X interface RL 0x00080000 Input axis for additional external .. EXT_CTRL_INPUT T X position command values (e.g. distance control). 0x00100000 Pure encoder axis, only to display .. COUNTER T, R X X actual values (e.g. conveyor belt). 0x00200000 Lead axis in combination with single .. LEAD_AXIS T, R X feed axis and G194 (contouring with DIST_MASTER) 0x00400000 The resolution (wegaufz/wegaufn) of .. ALLOW_RESOLUTI T, R X X this axis can be changed. ON_ CHANGE(2) 0x00800000 Path-dependent dynamic weighting for .. DYNAMIC_WEIGHT T, R X this axis is possible. ING 56 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 57

Parameter Value Meaning Axis Interpolator type type 0x02000000 Path axis for tool centre point path .. PATH_LENGTH_TC R X P 0x04000000 Path axis for contour path .. PATH_LENGTH_ R X CONTOUR 0x08000000 Virtual lead axis for path interpolation .. VIRT_LEAD_AXIS R X 0x10000000 Axis carries the pressure roller for .. LAH_OFFSET_AXI R X edge banding. S (1) One of the following two axis modes must always be defined: - ACHSMODE_LINEAR or - ACHSMODE_MODULO All other bits of the parameter achs_mode are additional specifications. For example, the ACHS- MODE_MODULO_LINEAR bit is only useful if combined with the ACHSMODE_MODULO bit. (2) Changing certain axis parameters may be critical while a controller is running, e.g. path resolu- tion,. Therefore, this parameter can be enabled by setting the bit ALLOW_RESOLUTION_CHANGE in axis mode. Otherwise, these parameters (P-AXIS-00234, P-AXIS-00233) can no longer be changed after controller start-up. When the bit ALLOW_RESOLUTION_CHANGE is set, a check is first made whether the axis is in- terpolated, also when other critical parameters change. If the axis is currently in motion, this para- meter update is rejected. P-AXIS-00036 Access to cam signals Description The parameter defines the access to cam signals. Parameter lr_hw[i].cam_direct_access Data type BOOLEAN Data range 0/1 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 drive types. Conventional, Terminal, Lightbus, Profidrive Remarks This entry is not adopted when the axis parameter list is updated. Updates only become effective when the controller is rebooted. P-AXIS-00038 Level of cam signals Description The parameter defines the level of cam signals. Parameter lr_hw[i].cam_level Data type BOOLEAN Data range 0: 0-signal is active level. When the reference cam switch is actuated, the value of the control unit element p AC[axis_idx]^.addr^. Mc Control Lr_Data. MCControl Bool Unit_Reference Cam. X_Comman d on the HLI is FALSE (see [HLI]). 1: 1-signal is active level (default). When the reference cam switch is actuated, the value of the control unit element p AC[axis_idx]^.addr^. Mc Control Lr_Data. MCControl Bool Unit_Reference Cam. X_Comman d on the HLI is TRUE (see [HLI]). Axis types T, R, S Dimension T: ---- R,S: ---- Default value 1 drive types. Conventional, Terminal, Lightbus, Profidrive Remarks TF5200 | Twin CAT 3 CNC Version: 1.2 57 Homing
## Page 58

Parameter P-AXIS-00064 Slow / fast movement down from cam Description This parameter sets the velocity during reversion down from cam. Parameter kenngr.fast_from_cam Data type BOOLEAN Data range 0: Slow movement down from cam 1: Fast movement down from cam (default) Axis types T, R Dimension T: ---- R: ---- Default value 1 drive types. ---- Remarks For further hardware-specific parameters relating to homing with cam, see P-AXIS-00036 - P-AXIS-00039. P-AXIS-00074 Suppress homing for gantry slave axis Description This parameter can suppress the homing of gantry slave axes. When homing of the master axis is completed, the reference positions entered in the axis parameter lists of the slave axes are also adopted and monitoring of the gantry difference is started. Parameter kenngr.gantry_slave_no_homing Data type BOOLEAN Data range 0/1 Axis types T, R Dimension T: ---- R: ---- Default value 0 drive types. ---- Remarks This parameter is not supported in the case of spindle axes. P-AXIS-00084 Homing only with cam (without zero pulse) Description The homing position is detected by travel on the cam. Parameter kenngr.homing_without_zero_pulse Data type BOOLEAN Data range 0: Homing with zero pulse of rotary transducer (default value). 1: Homing without zero pulse of rotary transducer (low accuracy). Axis types T, R Dimension T: ---- R:---- Default value 0 drive types. ---- Remarks For further hardware-specific parameters relating to homing with cam, see P-AXIS-00036 - P-AXIS-00039. P-AXIS-00152 Position of the reference point Description If homing is completed, the value from the parameter P-AXIS-00152 is taken as the absolute position for the axis Parameter getriebe[i].pos_refpkt Data type SGN32 Data range swe_neg < pos_refpkt < swe_pos Axis types T, R, S Dimension T: 0.1 µm R,S: 0.0001 ° Default value 0 drive types. Simulation, Conventional, Terminal, Lightbus, Profidrive, CANopen Remarks 58 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 59

Parameter P-AXIS-00156 Homing without cam Description A changeover of homing strategy can be carried out so that homing is done without cam (e.g. only with zero pulse), i.e. without reverting. In this case the parameter P-AXIS-00156 should be set to TRUE. Parameter kenngr.ref_ohne_nocken Data type BOOLEAN Data range 0/1 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. Conventional, Terminal, Lightbus, Profidrive Remarks To be assigned for analogue spindles only. If P-AXIS-00156 is assigned with 1 (TRUE), then it is imperative that P-AXIS-00157 is assigned with 1 (TRUE). P-AXIS-00157 Homing without reverting Description Via parameter P-AXIS-00157 a restriction of homing can occur that will prohibit any reverting. Parameter kenngr.ref_ohne_rev Data type BOOLEAN Data range 0/1 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. Conventional, Terminal, Lightbus, Profidrive Remarks The speed during reversing is set with the parameter P-AXIS-00064 (fast_from_cam). By reverting, it is possible to repeatedly move to the reference cam at slow speed. To be assigned for analogue spindles only. P-AXIS-00157 must be assigned with 1 (TRUE) if P-AXIS-00156 is assigned with 1 (TRUE). P-AXIS-00158 Preferred direction of axis for homing Description The parameter P-AXIS-00158 specifies the direction of travel if the axis does not remain on a cam. The declaration of the signal level when the reference switch is actuated is given by the axis parameter P-AXIS-00038. Parameter kenngr.ref_richt Data type BOOLEAN Data range 0: Negative direction 1: Positive direction Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. Simulation, Conventional, Terminal, Lightbus, Profidrive Remarks Positive direction signifies that the coordinate values increase. Negative direction signifies that the coordinate values decrease. P-AXIS-00161 Tool path up to zero pulse during homing simulation Description The parameter defines the tool path up to zero pulse during homing simulation. Parameter antr.simu.rpf_weg_bis_nip Data type SGN32 Data range MIN(SGN32) ≤ rpf_weg_bis_nip ≤ MAX(SGN32) Axis types T, R, S TF5200 | Twin CAT 3 CNC Version: 1.2 59 Homing
## Page 60

Parameter Dimension T: 0.1µm R,S: 0.0001 ° Default value 10 drive types. Simulation Remarks P-AXIS-00218 Slow velocity for exact detection of reference position Description Not only the traverse downwards of cam but also the traverse on cam with homing takes place at the velocity P-AXIS-00218. Parameter getriebe[i].vb_reflow Data type UNS32 Data range 1 ≤ vb_reflow ≤ P-AXIS-00219 Axis types T, R, S Dimension T: µm/s R,S: 0.001°/s Default value 16666 drive types. Simulation, Conventional, Terminal, Lightbus, Profidrive Remarks P-AXIS-00219 Fast velocity for detection of reference cam Description At start of homing, if the axis is not on the cam, then travel on the cam takes place at the velocity defined in P-AXIS-00219. Parameter getriebe[i].vb_refmax Data type UNS32 Data range P-AXIS-00218 ≤ vb_refmax ≤ P-AXIS-00212 Axis types T, R, S Dimension T: µm/s R,S: 0.001°/s Default value 83333 drive types. Conventional, Terminal, Lightbus, Profidrive Remarks P-AXIS-00294 Selection of the homing method 'Evaluation of encoder overflow' Description This homing method is selected with the parameter P-AXIS-00294. To use this option, the parameter P-AXIS-00084 must be assigned the value 0. The number of bits used to detect encoder overflow has to be set in parameter P- AXIS-00355 . Parameter kenngr.homing_overflow_evaluation Data type BOOLEAN Data range 0: No evaluation of encoder overflow (default). 1: Evaluation of encoder overflow. Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. Lightbus Remarks This homing method only leads to a repeatable homing position of the axis when encoder overflow occurs every time at the same mechanical position of the axis. This is true for example for resolver encoders. P-AXIS-00299 Homing type Description There are two different homing methods: 1. NC-controlled homing 2. Drive-controlled homing 60 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 61

Parameter With NC-controlled homing, the generation of command values and sequence control (evaluation of reference cams and zero pulses) are handled in the CNC. With drive-controlled homing, motion generation and the evaluation of cam signals and zero pulses are handled in the drive. The homing method can be set up for drives types (P-AXIS-00018) for which both homing methods are implemented with this parameter. Parameter kenngr.homing.homing_type * (Note: see *-note below) Data type STRING Data range CNC_CONTROLLED: CNC-controlled homing is done. DRIVE_CONROLLED: Drive-controlled homing is done. DISABLED: This axis cannot be homed. The CNC generates the error message P- ERR-50685 or P-ERR-60313 if homing is commanded for the axis (e.g. G74). This setting is only intended for axes with an absolute measuring system (see P-AXIS-00014). IGNORE_ABS_POS: Axes with this setting are ignored during homing, i.e. the axis is not homed even if G74 <axis_name> is programmed. In this case the CNC generates no error message contrary to the setting DISABLED. The mode IGNORE_ABS_POS is only permitted for axis with an absolute position measuring system, meaning the parameter kenngr.abs_pos_gueltig (see P-AXIS-00014) must be set to 1. Otherwise, the CNC generates the error warning P-ERR-110584. Axis types T, R, S Dimension T: ---- R,S: ---- Default value CNC_CONTROLLED Drive types ---- Remarks * alternative: kenngr.homing_type (old syntax) If the homing command G74 involves multiple axes with different homing type setting e.g. G74 X1 Y1 Z2, the axis with kenngr.homing_type != IGNORE_ABS_POS/ DISABLED will move and try to find the homing switch while there is no movement on the homing suppressed axes. Therefore it must be ensured that no collision can occur. If a homing type which is not supported by the drive type is set up, an error P- ERR-110384 is generated and default homing type is corrected. If this entry is not present in the parameter list, the default homing type is used according to the drive type: Drive type CNC_CONTROLLED DRIVE_CONTROLLED Simulation X* SERCOS X X* Terminal X* Lightbus X* RT-Ethernet X* PROFIDRIVE X* CANopen X* X * Default homing type P-AXIS-00321 Input interface for reference cam signal Description In the default setting with CNC-controlled homing, the reference cam signal is read from the HLI [HLI]. For some drive types it is possible to use the drive digital inputs as reference cam input. In this case the appropriate input has to be configured in P- AXIS-00321. If this parameter is not set, the reference cam signal is read from the PLC interface. Parameter antr.reference_cam_signal Data type STRING TF5200 | Twin CAT 3 CNC Version: 1.2 61 Homing
## Page 62

Parameter Data range Dependent on the drive type the following different names for the digital inputs are possible: Drive type SERCOS: PLC Read reference cam signal from HLI (default) RT_STATUS_BIT_1 Read reference cam signal from real time status bit 1 RT_STATUS_BIT_2 Read reference cam signal from real time status bit 2 Drive type CANopen: PLC Read reference cam signal from HLI (default) STATUS_DIG_INPUTS (*) Reference cam signal from object 0x60FD : Digital inputs Axis types T, R, S Dimension T: ---- R,S: ---- Default value PLC drive types. SERCOS, Lightbus,CANopen Remarks Caution: It is only possible to use real-time status bits with NC-controlled homing, see also [CMS-A1]. If the drive digital inputs are used, they must also be parameterised using the drive manufacturer’s set-up tool. The transmission of the digital inputs in the cyclic telegram must also be configured. (*) For the transmission of the reference cam state, the object 0x60FD: Digital inputs must be configured (see DS402 drive profile). Otherwise, the error message with error code P- ERR-70292 is output. P-AXIS-00354 Shifting of encoder overflow Description When homing with encoder overflow this parameter can shift the reference position. A positive value for P-AXIS-00354 will shift the reference position in the positive movement direction of the axis. Parameter antr.encoder_overflow_offset Data type SGN32 Data range application-specific Axis types T, R, S Dimension T: 0.1 µm R,S: 0.1 µm Default value 0 drive types. SERCOS, Lightbus,CANopen Remarks The reference position can only be shifted within one encoder revolution. If larger values for P-AXIS-00354 are defined, the error message P-ERR-70310 is output and P- AXIS-00354 is corrected to 0. P-AXIS-00355 Number of bits for evaluation of encoder overflow Description When homing on encoder overflow, this parameter defines the number of bits of the drive's actual position value that are taken into account to detect encoder overflow. The actual position value of the drive system is AND-combined with the value (2P-AXIS-00355 -1) and the underflow or overflow of the resulting value is considered as encoder overflow. Parameter antr.encoder_bit_range Data type UNS08 Data range 1 … 31 Axis types T, R, S Dimension T: ---- R,S: ---- 62 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 63

Parameter Default value 0 drive types. SERCOS, Lightbus,CANopen Remarks P-AXIS-00386 Drive supported execution of the CNC based homing (SERCOS) Description By default CNC-controlled homing for SERCOS drives is only executed in the controller; the drive-internal positions are not altered. If the drive supports the SERCOS command S-0-146 (CNC-controlled homing), this parameter can enable the command S-0-146 for CNC-controlled homing. The advantage of this method is that, after homing is finished, the drive-internal positions are also referenced so that drive-internal software limit switches can be used, for example. The reference position used for homing is P-AXIS-00152. This value is transferred to the drive during homing Parameter antr.sercos.drive_supports_cnc_homing Data type BOOLEAN Data range 0/1 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. SERCOS Remarks This parameter is currently not supported for spindles. In addition to command S-0-146 the drive must support the following commands: • S-0-171 (Calculate displacement) • S-0-172 (Displacement to referenced system) • S-0-191 (Cancel reference point procedure) For further information please refer to the drive manufacturer's documentation.. P-AXIS-00387 Assignment of control and status bits for CNC based homing (SERCOS) Description To execute CNC-controlled homing with drive support, two control bits and two status bits are required. The real-time control and status bits can be used in the drive control and status word or alternatively as bits in the signal status and signal control word. Parameter antr.sercos.cnc_homing_rt_bit_layout Data type UNS16 Data range 1 ≤ cnc_homing_rt_bit_layout ≤ 16 Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. SERCOS Remarks When the status and control bits are transferred in the signal status and control words, they must be configured in the cyclic process data, otherwise the error message P- ERR-70295 is output. Assign the values of P-AXIS-00387 to the possible bit assignments: Value Process data Bit number Meaning Ident 1 Control word Real-time bit 1 (S-0-301) Homing enable S-0-407 Real-time bit 2 (S-0-303) Position command value S-0-404 referenced Status word Real-time bit 1 (S-0-305) Position marker pulse detected S-0-408 Real-time bit 2 (S-0-307) Actual value referenced S-0-403 TF5200 | Twin CAT 3 CNC Version: 1.2 63 Homing
## Page 64

Parameter Value Process data Bit number Meaning Ident 2 Signal control word Bit 0 (S-0-27[0]) Homing enable S-0-407 Bit 1 (S-0-27[1]) Position command value S-0-404 referenced Signal status word Bit 0 (S-0-26[0]) Position marker pulse detected S-0-408 Bit 1 (S-0-26[1]) Actual value referenced S-0-403 3 Signal control word Bit 1 (S-0-27[1]) Homing enable S-0-407 Bit 2 (S-0-27[2]) Position command value S-0-404 referenced Signal status word Bit 1 (S-0-26[1]) Position marker pulse detected S-0-408 Bit 2 (S-0-26[2]) Actual value referenced S-0-403 4 Signal control word Bit 2 (S-0-27[2]) Homing enable S-0-407 Bit 3 (S-0-27[3]) Position command value S-0-404 referenced Signal status word Bit 2 (S-0-26[2]) Position marker pulse detected S-0-408 Bit 3 (S-0-26[3]) Actual value referenced S-0-403 5 Signal control word Bit 3 (S-0-27[3]) Homing enable S-0-407 Bit 4 (S-0-27[4]) Position command value S-0-404 referenced Signal status word Bit 3 (S-0-26[3]) Position marker pulse detected S-0-408 Bit 4 (S-0-26[4]) Actual value referenced S-0-403 6 Signal control word Bit 4 (S-0-27[4]) Homing enable S-0-407 Bit 5 (S-0-27[5]) Position command value S-0-404 referenced Signal status word Bit 4 (S-0-26[4]) Position marker pulse detected S-0-408 Bit 5 (S-0-26[5]) Actual value referenced S-0-403 7 Signal control word Bit 5 (S-0-27[5]) Homing enable S-0-407 Bit 6 (S-0-27[6]) Position command value S-0-404 referenced Signal status word Bit 5 (S-0-26[5]) Position marker pulse detected S-0-408 Bit 6 (S-0-26[6]) Actual value referenced S-0-403 8 Signal control word Bit 6 (S-0-27[6]) Homing enable S-0-407 Bit 7 (S-0-27[7]) Position command value S-0-404 referenced Signal status word Bit 6 (S-0-26[6]) Position marker pulse detected S-0-408 Bit 7 (S-0-26[7]) Actual value referenced S-0-403 9 Signal control word Bit 7 (S-0-27[7]) Homing enable S-0-407 Bit 8 (S-0-27[8]) Position command value S-0-404 referenced Signal status word Bit 7 (S-0-26[7]) Position marker pulse detected S-0-408 Bit 8 (S-0-26[8]) Actual value referenced S-0-403 10 Signal control word Bit 8 (S-0-27[8]) Homing enable S-0-407 Bit 9 (S-0-27[9]) Position command value S-0-404 referenced Signal status word Bit 8 (S-0-26[8]) Position marker pulse detected S-0-408 Bit 9 (S-0-26[9]) Actual value referenced S-0-403 11 Signal control word Bit 9 (S-0-27[9]) Homing enable S-0-407 Bit 10 (S-0-27[10]) Position command value S-0-404 referenced Signal status word Bit 9 (S-0-26[9]) Position marker pulse detected S-0-408 Bit 10 (S-0-26[10]) Actual value referenced S-0-403 64 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 65

Parameter Value Process data Bit number Meaning Ident 12 Signal control word Bit 10 (S-0-27[10]) Homing enable S-0-407 Bit 11 (S-0-27[11]) Position command value S-0-404 referenced Signal status word Bit 10 (S-0-26[10]) Position marker pulse detected S-0-408 Bit 11 (S-0-26[11]) Actual value referenced S-0-403 13 Signal control word Bit 11 (S-0-27[11]) Homing enable S-0-407 Bit 12 (S-0-27[1]2) Position command value S-0-404 referenced Signal status word Bit 11 (S-0-26[11]) Position marker pulse detected S-0-408 Bit 12 (S-0-26[1]2) Actual value referenced S-0-403 14 Signal control word Bit 12 (S-0-27[12]) Homing enable S-0-407 Bit 13 (S-0-27[13]) Position command value S-0-404 referenced Signal status word Bit 12 (S-0-26[12]) Position marker pulse detected S-0-408 Bit 13 (S-0-26[13]) Actual value referenced S-0-403 15 Signal control word Bit 13 (S-0-27[13]) Homing enable S-0-407 Bit 14 (S-0-27[1]4) Position command value S-0-404 referenced Signal status word Bit 13 (S-0-26[13]) Position marker pulse detected S-0-408 Bit 14 (S-0-26[14]) Actual value referenced S-0-403 16 Signal control word Bit 14 (S-0-27[14]) Homing enable S-0-407 Bit 15 (S-0-27[15]) Position command value S-0-404 referenced Signal status word Bit 14 (S-0-26[14]) Position marker pulse detected S-0-408 Bit 15 (S-0-26[15]) Actual value referenced S-0-403 P-AXIS-00388 Encoder, used for CNC controlled homing (SERCOS) Description Some drive types support the use of multiple encoders (motor encoder and external encoder). This parameter defines which encoder is used for homing. Parameter antr.cnc_homing_encoder Data type SGN16 Data range 0: Value is not configured. If P-AXIS-00386 is set to 1, set this parameter to a valid value (0, 1, 2). 1: The encoder used for homing is determined automatically, e.g. for SERCOS drives, by reading drive parameter S-0-147. 2: Motor encoder 3: External encoder Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 drive types. SERCOS Remarks At the moment this parameter is supported only for SERCOS. With SERCOS drives, if the encoder set in S-0-147 does not fit to the value set in P- AXIS-00388, the error message error message P-ERR-70453 is output. This value is only effective when P-AXIS-00386 has the value 1. P-AXIS-00412 Maximum distance during homing Description This parameter defines a maximum distance for homing for spindles and rotary axes. If the maximum permissible homing distance is exceeded, homing is aborted and error message P-ERR-70394 is output. TF5200 | Twin CAT 3 CNC Version: 1.2 65 Homing
## Page 66

Parameter It achieves that homing is aborted if, for example, the reference cam is not found due to a wiring error. This parameter works only for spindles and rotary axes, see P-AXIS-00018. If this parameter is set for linear axes to a value unequal to zero, the error message P- ERR-110545 is output and the parameter is corrected to 0. A value of 0 disables distance monitoring during homing. Parameter kenngr.distc.a_max Data type UNS32 Data range 0 ≤ homing_max_movement_dist ≤ MAX(UNS32) Axis types R, S Dimension R,S: 0.0001 ° Default value 0 drive types. ---- Remarks This parameter has to be set to a value which is at least equal to the modulo range of the axis in order to complete homing successfully. P-AXIS-00425 Bit number of signal 'Drive is referenced' during reference monitoring Description In this parameter enter the number of the bit which is used for transmission of the signal 'Drive is referenced' from the drive to the controller during active reference monitoring. The least significant bit has bit number 0. The maximum value depends on the length of the configured telegram element which is used for transmission. Length of telegram element Max. bit number -1 No reference monitoring 2 15 4 31 Setting the parameter to an invalid bit number leads to the output of error message P- ERR-110549. Parameter antr.reference_check.bit_nr Data type SGN16 Data range 0 ≤ bit_nr ≤ Max. bit number Axis types T, R, S Dimension T: ---- R,S: ---- Default value -1 drive types. SERCOS Remarks This parameter is supported for SERCOS drive types only. P-AXIS-00426 Element name of signal 'Drive is referenced' during reference monitoring Description In this parameter enter the name of the element of the cyclic input process data which is used for transmission of the signal 'Drive is referenced' from the drive. When the set-up value of P-AXIS-00426 is not found within the cyclic process, the error message P-ERR-70401 is output. Parameter antr.reference_check.element_name Data type STRING Data range <Empty string>: Reference monitoring is disabled S-0-0135: When the SERCOS state word is used for transmission of the reference signal, the parameter has to be set to 'S-0-0135'… <Telegram_element_Name>: ...or, alternatively, the name of a telegram element configured in the cyclic process data. Axis types T, R, S Dimension T: ---- R,S: ---- 66 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 67

Parameter Default value * Drive types SERCOS Remarks * Note: The default value of variables is a blank string. Reference monitoring is activated by assigning a value to this parameter. When reference monitoring is activated, the parameter P-AXIS-00425 must also be assigned a valid value. At the moment, this parameter is supported for drive type SERCOS only. Changing this parameter by a list update is not possible (P-ERR-110550). P-AXIS-00494 Delayed activation of zero pulse logic Description For CNC-controlled homing (see P-AXIS-00299) the parameter delays the activation of the zero pulse logic after the actuation of the reference switch. This can be useful if the reference cam and the zero pulse are situated closely together and the detection of the zero pulse is therefore not reliably possible. In this case the next or the next but one zero pulse after the reference cam could be detected depending on the actuation speed of the reference cam. Parameter kenngr.shift_offset_zero_pulse_activation Data type UNS32 Data range 0 ≤ shift_offset_zero_pulse_activation ≤ MAX_UNS32 Axis types T, R, S Dimension T: 0.1 µm R,S: 0.0001 ° Default value 0 drive types. Conventional, SERCOS, Terminal, Lightbus, Profidrive, CANopen Remarks 4.3 Dependence on the type of referencing method As already mentioned, different referencing methods are available. A method is selected by a specification in each axis MDS (achsmds X.lis) by the element kenngr.homing_type. Here, the method is selected by means of a defined string. Refer to the table below for details of the methods available: Method Keyword Move to fixed stop, NC-controlled TORQ Compatibility mode NONE Axis response with referencing type NONE • If commanding was executed, the value is adopted as reference position for the axis. This value is stored in the element “getriebe[i].pos_refpkt“ in the axis MDS (achsmds X.lis) • The behaviour of the axis during commanding depends on the defined drive type. If the drive type DSE is parameterised for the axis (see kenngr.antr_typ), the axis does not move when the FB is commanded. The parameterised reference position is adopted directly and the “Done” output is set to TRUE. • If the drive type Simulation is parameterised for the axis (see kenngr.antr_typ), the axis moves and adopts the parameterised reference position after a short distance. Axis behaviour in the case of the referencing type TORQ • If the drive type DSE is parameterised for the axis, the axis does not move when the FB is commanded. • If the referencing type TORQ Is used, further parameters can be assigned values in the axis MDS (achsmds X.lis). There are general parameters that refer to the referencing operation as such. In the axis list, they are indicated by the prefix kenngr.homing. TF5200 | Twin CAT 3 CNC Version: 1.2 67 Homing
## Page 68

Support and Service 5 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 68 Version: 1.2 TF5200 | Twin CAT 3 CNC Homing
## Page 69

Index Index P P-AXIS-00014 54 P-AXIS-00015 55 P-AXIS-00036 57 P-AXIS-00038 57 P-AXIS-00064 58 P-AXIS-00074 58 P-AXIS-00084 58 P-AXIS-00152 58 P-AXIS-00156 59 P-AXIS-00157 59 P-AXIS-00158 59 P-AXIS-00161 59 P-AXIS-00218 60 P-AXIS-00219 60 P-AXIS-00294 60 P-AXIS-00299 60 P-AXIS-00321 61 P-AXIS-00354 62 P-AXIS-00355 62 P-AXIS-00386 63 P-AXIS-00387 63 P-AXIS-00388 65 P-AXIS-00412 65 P-AXIS-00425 66 P-AXIS-00426 66 P-AXIS-00494 67 TF5200 | Twin CAT 3 CNC Version: 1.2 69 Homing
## Page 71

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
