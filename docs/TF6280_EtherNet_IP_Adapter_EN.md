---
title: "TF6280 Twin CAT 3"
product: "TF6280"
category: "Communication"
tags: ["CAT", "TWIN"]
language: "EN"
document_type: "Manual"
version: "1.3.3"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF6280_EtherNet_IP_Adapter_EN.pdf"
release_date: "2024-07-03"
---
Manual | EN TF6280 Twin CAT 3 | Ether Net/IP Adapter 2024-07-03 | Version: 1.3.3
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 Prerequisites............................................................................................................................................. 9 3.1 Verifying the hardware...................................................................................................................... 9 4 Licensing................................................................................................................................................. 12 5 Configuration........................................................................................................................................... 15 5.1 Creating an Ether Net/IP slave......................................................................................................... 15 5.1.1 Firewall setting................................................................................................................. 18 5.1.2 IP Routing........................................................................................................................ 18 5.2 Setting the cycle time...................................................................................................................... 18 5.3 Changing Ether Net/IP settings........................................................................................................ 19 5.3.1 Object description............................................................................................................ 21 5.3.2 ADS-Write command....................................................................................................... 21 5.3.3 ADS-Read command....................................................................................................... 22 5.3.4 Sample............................................................................................................................. 23 5.4 Creating the Ether Net/IP slave in other Ether Net/IP masters......................................................... 23 5.4.1 Sample for Rockwell CPUs.............................................................................................. 25 5.5 Acyclic communication via Explicit Messaging............................................................................... 26 5.5.1 Common Industrial Protocol (CIP)................................................................................... 26 5.5.2 Forward Message to AMS Port via Explicit Messaging.................................................... 27 6 Properties................................................................................................................................................ 35 6.1 Virtual slave..................................................................................................................................... 35 6.2 TF6280 - Configuration parameters................................................................................................ 36 6.2.1 Index 0x8000 Slave Settings............................................................................................ 36 6.2.2 Index 0x8001 IO Assembly Settings................................................................................ 37 6.2.3 Index 0x9000 Adapter Info............................................................................................... 37 6.2.4 Index 0x9001 IO Assembly Info....................................................................................... 37 7 Diagnostic history................................................................................................................................... 38 7.1 Error codes TF6280........................................................................................................................ 39 8 Appendix.................................................................................................................................................. 41 8.1 Support and Service........................................................................................................................ 41 TF6280 Version: 1.3.3 3
## Page 4

Table of contents 4 Version: 1.3.3 TF6280
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. For installation and commissioning of the components, it is absolutely necessary to observe the documentation and the following notes and explanations. The qualified personnel is obliged to always use the currently valid documentation. The responsible staff must ensure that the application or use of the products described satisfies all requirements for safety, including all the relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. No claims to modify products that have already been supplied may be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of designations or trademarks used in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Patents The Ether CAT Technology is covered, including but not limited to the following patent applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 and similar applications and registrations in several other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document as well as the use and communication of its contents without express authorization are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. TF6280 Version: 1.3.3 5
## Page 6

Foreword Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.3.3 TF6280
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF6280 Version: 1.3.3 7
## Page 8

Overview 2 Overview With the TF6280 Twin CAT Ether Net/IP adapter function, you can parameterize up to 8 Ether Net/IP adapters in combination with a network-capable Beckhoff PC with a physical interface. This creates a virtual MAC address that you can use to operate up to 8 Ether Net/IP adapters on one PC via an Ethernet interface. Technical data TF6280 Requires TC1200 from build 4020 Target system Windows XP, Windows 7/8, Windows CE Performance class (pp) 20 30 40 50 60 70 80 90 – – X X X X X X Ordering information TF6280-00pp TC3 Ether Net/IP Adapter The function TF6280 Twin CAT Ether Net/IP Adapter enables data exchange with an Ether Net/IP scanner; both multicast and unicast are supported. The function TF6280 Twin CAT Ether Net/IP Adapter can also behave like eight Ether Net/IP adapters. For example, it is possible: • to connect one scanner with eight adapters • to connect up to eight scanners with 8 adapters In this way, more data can be transported or the scanners can be operated with different cycle times. In an Ether Net/IP network, the TF6280 behaves as an adapter device and no further configuration via an Ether Net/IP scanner is necessary. The configurator in Twin CAT 3.1 is used for the configuration, e.g. by specifying the IP settings and the number of data. Only the data itself must be set in the Ether Net/IP scanner in the same way so that a connection can be established. Ether Net/IP Ether Net/IP (Ethernet Industrial Protocol, EIP) is a real-time Ethernet protocol, which was disclosed and standardized by the ODVA (Open Device Net Vendor Association). This protocol is based on TCP, UDP and IPv4. Further information can be found at www.odva.org or https://en.wikipedia.org/wiki/Ether Net/IP. 8 Version: 1.3.3 TF6280
## Page 9

Prerequisites 3 Prerequisites Software TF6280 is included in Twin CAT version 3.1 build 4020.28. No further installation is required. Older product versions Older versions are beta versions. Delete any older Ether Net/IP device configurations and create a new configuration. Hardware For using the TF6280, the target system has to have an Intel® network chipset (see: Verifying the hardware [} 9]). Beckhoff PC Beckhoff PC systems are usually preconfigured for the operation of Ether Net/IP devices. 3.1 Verifying the hardware Check whether the network interface is suitable 1. Create an Ether Net/IP slave. Right-click on Devices and add a new device (Add New Item…). TF6280 Version: 1.3.3 9
## Page 10

Prerequisites 2. Select Ether Net/IP Adapter (Slave). 3. Now select the adapter and find the appropriate Ethernet interface (Search…). 10 Version: 1.3.3 TF6280
## Page 11

Prerequisites 4. Select a “real-time capable” interface under Compatible devices. ð You can install the real-time driver. No “real-time capable” network interface available If the list contains no network interfaces under Compatible devices, the TF6280 function cannot be used on the present hardware. TF6280 Version: 1.3.3 11
## Page 12

Licensing 4 Licensing The Twin CAT 3 function can be activated as a full version or as a 7-day test version. Both license types can be activated via the Twin CAT 3 development environment (XAE). Licensing the full version of a Twin CAT 3 Function A description of the procedure to license a full version can be found in the Beckhoff Information System in the documentation "Twin CAT 3 Licensing". Licensing the 7-day test version of a Twin CAT 3 Function A 7-day test version cannot be enabled for a Twin CAT 3 license dongle. 1. Start the Twin CAT 3 development environment (XAE). 2. Open an existing Twin CAT 3 project or create a new project. 3. If you want to activate the license for a remote device, set the desired target system. To do this, select the target system from the Choose Target System drop-down list in the toolbar. ð The licensing settings always refer to the selected target system. When the project is activated on the target system, the corresponding Twin CAT 3 licenses are automatically copied to this system. 4. In the Solution Explorer, double-click License in the SYSTEM subtree. ð The Twin CAT 3 license manager opens. 12 Version: 1.3.3 TF6280
## Page 13

Licensing 5. Open the Manage Licenses tab. In the Add License column, check the check box for the license you want to add to your project (e.g. "TF4100 TC3 Controller Toolbox"). 6. Open the Order Information (Runtime) tab. ð In the tabular overview of licenses, the previously selected license is displayed with the status “missing”. 7. Click 7-Day Trial License... to activate the 7-day trial license. ð A dialog box opens, prompting you to enter the security code displayed in the dialog. 8. Enter the code exactly as it is displayed and confirm the entry. 9. Confirm the subsequent dialog, which indicates the successful activation. ð In the tabular overview of licenses, the license status now indicates the expiry date of the license. TF6280 Version: 1.3.3 13
## Page 14

Licensing 10. Restart the Twin CAT system. ð The 7-day trial version is enabled. 14 Version: 1.3.3 TF6280
## Page 15

Configuration 5 Configuration The most important settings in order to establish a connection with an Ether Net/IP scanner are: • the IP address, • the assembly instance numbers and thus the length of the data • and the correct cycle time. IP address: The IP address can be assigned freely, although it should be from the same network class as the master. Otherwise a gateway must be entered, in order to route the protocol accordingly. Assembly instance numbers: The assembly instance numbers are permanently assigned and must be correctly set in the master. This also always includes the number of data or the size of the process image. Cycle time: The task cycle time in the TF6280 may not exceed the time on the master side, although it can be a fraction of that time. If, for sample, an Ether Net/IP cycle time of 10 ms is set on the master side, the task cycle time on the slave side can be 10 ms, 5 ms, 2 ms or 1 ms. Recommended cycle time Ether Net/IP enables cycle times of 1 ms or higher. The task can always be operated with 1 ms, as long as the system load of your systems [} 8] permits this. 5.1 Creating an Ether Net/IP slave Once you have added an Ether Net/IP adapter, a slave is automatically added to your configuration. 1. Set the IP address of the slave. (The IP address does not have to be the same as the IP address of the operating system.) Click on the box and switch to the Settings tab. Here you can set the IP address, the network mask and the gateway address. TF6280 Version: 1.3.3 15
## Page 16

Configuration 1 a) If the IP address is to be issued by a DHCP server in your network, enter the value 0.0.0.0 in the IP address field. 1 b) If the IP address of the operating system is to be used, enter the value 255.255.255.255 in the IP address field. The subnet mask and the gateway address can be used unchanged. When Twin CAT starts, the Ether Net/IP driver then uses the IP address of the system. Please note the firewall settings [} 18]. 2. Click on the box and select Append IO Assembly. 16 Version: 1.3.3 TF6280
## Page 17

Configuration 3. To create data under Inputs, right-click on Add New Item… 4. Now select the data format and the number of data to be transferred. The number of bytes will be important later. It can be read in the object tree. e.g.: Enter 4 words, i.e. 8 bytes of process data: In addition there are 4 bytes for the Conn State. The Conn State currently has no function. It can be used for additional information in the future. TF6280 Version: 1.3.3 17
## Page 18

Configuration 5. Therefore, 12 bytes of process data must be created. Navigate to the box and select the Settings tab. ð The length can be found in index field 0x8001:07. The length is displayed from the master perspective. Twin CAT inputs are outputs in the master, hence the reference to output size here. 6. Now do the same with the outputs of the Ether Net/IP adapter. ð Data creation is now complete. Now link the data with the PLC. 5.1.1 Firewall setting The firewall must be enabled, if the Ether Net/IP address is to match the IP address of the operating system (OS). It is advisable to enable the firewall if the IP address of the Ether Net/IP scanner deviates from the IP setting of the operating system. 5.1.2 IP Routing f IP routing is used, the IP address of the OS must be in a different subnet than the IP address of the Ethernet/IP adapter/scanner. The Regkey can be different depending on the operating system and version, here only as an example, default is "0". HKEY_LOCAL_MACHINE\ System\ Current Control Set\ Services\ Tcpip\ Parameters "IPEnable Router" 5.2 Setting the cycle time The cycle time of the Ether Net/IP adapter (slave) is specified by the master. The task on the Twin CAT system must operate with at least the same speed. Recommended cycle time Ether Net/IP enables cycle times of 1 ms or higher. The task can always be operated with 1 ms, as long as the system load of your systems [} 8] permits this. To set the task cycle time navigate to the EIP Adapter device, then to the Sync Task tab and set the time. 18 Version: 1.3.3 TF6280
## Page 19

Configuration Use a dedicated Sync Task Use a dedicated Sync Task, since mapping via the PLC can result in the task being stopped, e.g. if a breakpoint is encountered, with the result that the Ether Net/IP connection is interrupted. 5.3 Changing Ether Net/IP settings For the setting, the Store Category [} 21] must be specified in the Twin CAT system configuration. This is entered in the object F8000:2B "Advanced Options" in all Ether Net/IP devices. If the corresponding bit is set, the IP address from the memory is used. If no value is entered, the bit is ignored, and the parameters of the Twin CAT system are used. In the following sample bit 8 (0x0100) is set, which means that Store Category 1 is selected, which affects the IP settings (index 0x8000: 21…23). TF6280 Version: 1.3.3 19
## Page 20

Configuration To use Store Category 1 and 2, 0x0300 should be entered in object 8000:2B. Only bits 8 and 9 should be used. All other bits are reserved and must not be used. ADS function blocks are used for reading or writing the settings from/to the PLC. 20 Version: 1.3.3 TF6280
## Page 21

Configuration 5.3.1 Object description Offset Name Data Type Sub Index Store Category 1 2 0x00..0x01 ID UINT16 1 0x02..0x03 Reserved UINT16 - 0x04..0x23 Product Name BYTE[32], 3 X STRING(31) 0x24..0x27 Device Type UINT32 4 0x28..0x2B Vendor ID UINT32 5 0x2C..0x2F Product Code UINT32 6 X 0x30..0x33 Revision UINT32 7 0x34..0x37 Serial Number UINT32 8 0x38..0x7D Reserved BYTE[70] - 0x7E..0x83 MAC Address BYTE[6] 32 0x84..0x87 IP Address UINT32 33 X 0x88..0x8B Network Mask UINT32 34 X 0x8C..0x8F Gateway Address UINT32 35 X 0x90..0x91 DHCP Max Retries UINT16 36 0x92..0x93 TCP/IP TTL UINT16 37 0x94..0x95 TCP/IP UDP Checksum UINT16 38 0x96..0x97 TCP/IP TCP Timeout UINT16 39 0x98..0x99 Multicast TTL UINT16 40 0x9A..0x9B Multicast Checksum UINT16 41 0x9C..0x9D Forward Class3 to PLC UINT16 42 0x9E..0x9F Flags UINT16 43 0x A0..0x FF Reserved Byte[96] - Store Category The “Store Category” determines which settings are overwritten with the values from the non-volatile memory. Bits 9 - 8 have to be set accordingly in the project under “Flags”. In order to modify both, both bits must be set. (Bit9=Cat2, Bit8=Cat1) 5.3.2 ADS-Write command Ams Net Id The AMSNet Id can be found under the “Ether Net/IP” tab in the “Net ID” field. When you select the option “Info Data Support” it is linked directly. The advantage of a direct link is that it always retrieves the current AMSNETID, even if controllers are used that use different AMSNETIDs. The AMSNETID of the Ether Net/IP adapter therefore does not have to be read manually. TF6280 Version: 1.3.3 21
## Page 22

Configuration ADS port number For the function “Ether Net/IP Adapter” set the ADS port number to a fixed value of 0x FFFF. Slave IDXGRP: 0x0001F480 IDXOFFS: 0x00000000 Setting for setting (4 bytes + object size (256 bytes)) Byte Offset 0: 0x45 Byte Offset 1: 0x23 Byte Offset 2: Obj Index Lo Byte (e.g. 0x8000 for slave 1 and 0x8010 for slave 2) Byte Offset 3: Obj Index Hi Byte Byte Offset 4-260: Data of the object (see object description below) Setting for resetting (4 bytes) Byte Offset 0: 0x00 Byte Offset 1: 0x00 Byte Offset 2: Obj Index Lo Byte (e.g. 0x8000 for slave 1 and 0x8010 for slave 2) Byte Offset 3: Obj Index Hi Byte Accept changes After setting the properties restart Twin CAT for the TF6280, after which the new settings are applied and valid. The settings remain stored and don't have to be loaded again, unless there are changes. 5.3.3 ADS-Read command Ams Net Id The AMSNet Id can be found under the “Ether Net/IP” tab in the “Net ID” field. When you select the option “Info Data Support” it is linked directly. 22 Version: 1.3.3 TF6280
## Page 23

Configuration The advantage of a direct link is that it always retrieves the current AMSNETID, even if controllers are used that use different AMSNETIDs. The AMSNETID of the Ether Net/IP adapter therefore does not have to be read manually. ADS port number For the function “Ether Net/IP Adapter” set the ADS port number to a fixed value of 0x FFFF. Slave IDXGRP: 0x1F480 IDXOFFS: 0x8000 for the first slave IDXOFFS: 0x8010 for the second slave IDXOFFS: 0x8020 for the third slave … IDXOFFS: 0x8070 for the eights slave LEN: 256 The data are stored in the data array, as described above -> see Object description [} 21]. 5.3.4 Sample A sample program can be downloaded: https://infosys.beckhoff.com/content/1033/ TF6280_Tc3_Ethernet IPSlave/Resources/3105211403/.tszip 5.4 Creating the Ether Net/IP slave in other Ether Net/IP masters All the information you need is provided in the Settings dialog: TF6280 Version: 1.3.3 23
## Page 24

Configuration You need • the IP address of the adapter (see Creating an Ether Net/IP slave [} 15]) • the “Assembly Instance” numbers (see Settings tab) • the number of data (see Settings tab) • the “Configuration Instance” number 128 length 0 • the “Input Instance” number 129 length 12 • the “Output Instance”-number 130 length 12 The instance numbers are always the same. An export of the EDS file only contains the instance numbers. The number of data still has to be entered. The Ether Net/IP device (slave) can be integrated via a “generic node” structure or via the EDS file. 24 Version: 1.3.3 TF6280
## Page 25

Configuration 5.4.1 Sample for Rockwell CPUs 1. Under Ethernet, New Module…, select Generic Ethernet Module. 2. Enter the IP address from object 0x8000:21. 3. Enter 129 for Input Instance. dec 4. Enter 130 for Output Instance and dec 5. 128 for Config Instance. dec TF6280 Version: 1.3.3 25
## Page 26

Configuration ð The data length is dependent on the Comm format. Note the properties of the selected Comm format In the above sample the Comm format INT was selected, which means the number of data from objects 0x8001:05 and 0x8001:07 have to be divided by 2, since in Twin CAT they are specified in bytes and in the RSLogix in word length (INT). An odd number of bytes must be rounded up. This also applies even if the Comm format is set to DINT, in which case you must round up to the next whole number. System limitations In the case of Multicast, pay attention to the high network loads that this causes, especially in systems with many or short cycle times. A high network load may possibly impair communication. 5.5 Acyclic communication via Explicit Messaging 5.5.1 Common Industrial Protocol (CIP) The Common Industrial Protocol (CIP) is an object-oriented peer-to-peer protocol that enables connections between industrial devices (sensors, actuators) and higher-level devices (controllers). CIP is independent of physical media and the data link layer. CIP has two main purposes: transport of control-oriented data connected to I/O devices, and transport of information relating to the system to be controlled, such as configuration parameters or diagnostics. CIP uses abstract objects to describe a device. A CIP device consists of a group of objects. Objects describe the available communication services, the externally visible behavior of the device, and a way in which information can be retrieved and exchanged. CIP objects are divided into classes, instances and attributes. A class is a set of objects that all represent the same component. An instance is the current representation of a particular object. Each instance has the same attributes, but possibly with different attribute values. The individual objects are addressed via a node address, which for Ether Net/IP is the IP address, plus a class, instance and attributes. • Object 26 Version: 1.3.3 TF6280
## Page 27

Configuration ◦ An abstract representation of a particular component within a product. • Class ◦ A set of objects that all represent the same type of system component. A class is a generalization of an object. All objects in a class are identical in form and behavior, but can contain different attribute values. • Instance ◦ A specific and real specimen of an object. Example: Berlin is an instance of the Capital object class. • Attribute ◦ A description of a property or characteristic of an object. Typically, attributes provide status information or control the operation of an object. (Source: The CIP Networks Library Volume 1: Common Industrial Protocol, Edition 3.22) The following objects are used internally by Beckhoff and are therefore reserved: 1. Identity Object → Class 0x1 2. Message Router Object → Class 0x2 3. Assembly Object → Class 0x4 4. Connection Manager Object → Class 0x6 5. TCP/IP Interface Object → Class 0x F5 6. Ethernet Link Object → Class 0x F6 5.5.2 Forward Message to AMS Port via Explicit Messaging "Explicit Messaging" is used to send information and data that does not require continuous updates. "Explicit Messaging" allows you to configure and monitor the parameters of a slave device in the Ethernet/IP network. The feature "Fwd Msg To Ams Port" allows the processing of acyclic requests from Ethernet/IP scanners via Explicit Messaging. The following example shows implementation of acyclic communication between a Twin CAT 3 controller and an RS Logix controller. Twin CAT 3 implementation: ü Requirement: Ethernet/IP driver version, min. V1.23 1. To enable the Fwd Msg To Ams Port feature, enter the Ams Port of the PLC (in the example 851) in the slave/master settings (0x8000:2A/0x F800:2A) in Twin CAT. TF6280 Version: 1.3.3 27
## Page 28

Configuration 2. ADSRDWRT requests from the Ethernet/IP driver (IDGRP: 0x848180E9 IOFFS: Slave Id (Adapter)) to the PLC task are registered as indications and enable their processing. The ADSRDWRTIND function block is used for this purpose. ð The first entry in the indication registered by the Ethernet/IP driver is a 32-byte (8x ULONG) header: TYPE DUT_Msg To Ams Port Header: STRUCT n Service Code:UDINT; n Class Id:UDINT; n Instance Id:UDINT; n Attribute Id:UDINT; n Reserved Id:UDINT; n General Status:UDINT; n Additional Status:UDINT; n Data Len:UDINT; END_STRUCT END_TYPE TYPE DUT_Incoming Msg Request: STRUCT req Hdr:DUT_Msgto Ams Port Header; 28 Version: 1.3.3 TF6280
## Page 29

Configuration req Data:ARRAY [0…991] OF BYTE; END_STRUCT END_TYPE TYPE DUT_Outgoing Msg Response: STRUCT res Hdr:DUT_mag To Ams Port Header; res Data:ARRAY [0…991] OF BYTE; End_Struct END_TYPE The same header is also used for the response. 3. The actual read/write data follows directly after the header (n Data Len <> 0 should be set according to the data length). The maximum supported data length is 992 bytes (+ 32-byte header = 1024 bytes). Potential classes/instances/attribute values Min Max Class 1 0x FFFF Instance 1 0x FFFF Attribute 1 0x FFFF 4. After an indication has been processed, a response must be sent to the source device via the ADSRDWRTRES function block. PROGRAM MAIN VAR i : INT; Idx Group : UDINT; //Ethernet/IP-Treiber -> 16#848180E9 Idx Offset : UDINT; //Slave Id (Adapter) bzw. 0x FFFF (Scanner) fb ADSRDWRTINDEX : ADSRDWRTINDEX; fb Ads Rd Wr Res : ADSRDWRTRES; request : DUT_Incoming Msg Request; response : DUT_Outgoing Msg Response; n Response Len : UINT; n Ads Result : UDINT:=0; n Ads Responses Sent : UDINT; Attributes : ARRAY [1..4] OF STRING :=['Test Read Only Attribute1','Test Read Only Attrib ute2','Test Read Only Attribute3','Test Read Write Attribute4']; END_VAR CASE i OF 0: //check for ADSRead Write-Requests fb ADSRDWRTINDEX ( CLEAR:=FALSE , MINIDXGRP:= 16#84000000, VALID=> , NETID=> , PORT=> , INVOKEID=> , IDXGRP=> , IDXOFFS=> , ); IF fb ADSRDWRTINDEX. VALID THEN Idx Group:= fb ADSRDWRTINDEX. IDXGRP; Idx Offset:= fb ADSRDWRTINDEX. IDXOFFS ; MEMSET(ADR(request), 0, SIZEOF(request)); MEMSET(ADR(response), 0, SIZEOF(response)); n Response Len:=0; //check for Indication Request = Ethernet/IP-driver -> 16#848180E9 IF Idx Group = 16#848180E9 THEN //check for Indication.datalength >= DUT_Msg To Ams Port Header IF fb ADSRDWRTINDEX. WRTLENGTH >= SIZEOF(request.req Hdr) THEN MEMCPY(ADR(request.req Hdr), fb ADSRDWRTINDEX. DATAADDR, SIZEOF(request.req Hdr)); END_IF //check for Indication.datalength > DUT_Msg To Ams Port Header >>> save additional data IF fb ADSRDWRTINDEX. WRTLENGTH > SIZEOF(request.req Hdr) THEN MEMCPY(ADR(request.req Data), fb ADSRDWRTINDEX. DATAADDR+SIZEOF(request.req Hdr), fb ADSRDW RTINDEX. WRTLENGTH-SIZEOF(request.req Hdr)); END_IF i:=10; ELSE i:=20; END_IF END_IF TF6280 Version: 1.3.3 29
## Page 30

Configuration 10: //new Ind from Eth Ip-Drv received response.res Hdr.n Service Code := request.req Hdr.n Service Code OR CONST. CN_SC_REPLY_MASK; response.res Hdr.n General Status := 0; response.res Hdr.n Additional Status := 0; response.res Hdr.n Data Len := 0; IF request.req Hdr.n Service Code = CONST. CN_SC_GET_ATTR_SINGLE OR request.req Hdr.n Service Code = CONS T. CN_SC_SET_ATTR_SINGLE THEN i:=11; ELSE response.res Hdr.n General Status := CONST. CN_GRC_BAD_SERVICE; n Response Len := SIZEOF(response.res Hdr); i:=20; END_IF 11: //case decision for request CASE request.req Hdr.n Class Id OF 16#1000: //erlaubte Beispiel Class 0x10000 CASE request.req Hdr.n Instance Id OF 16#1: //erlaubte Beispiel Instance 0x1 CASE request.req Hdr.n Attribute Id OF // Attributes 1-4 erlaubt; only attr 4 is settable 1,2,3: IF request.req Hdr.n Service Code = CONST. CN_SC_SET_ATTR_SINGLE THEN response.res Hdr.n General Status := CONST. CN_GRC_ATTR_NOT_SETTABLE; n Response Len := SIZEOF(response.res Hdr); i:=20; ELSE i:=12; END_IF 4: IF request.req Hdr.n Service Code = CONST. CN_SC_SET_ATTR_SINGLE THEN i:=14; ELSE i:=12; END_IF ELSE response.res Hdr.n General Status := CONST. CN_GRC_UNDEFINED_ATTR; n Response Len := SIZEOF(response.res Hdr); i:=20; END_CASE ELSE response.res Hdr.n General Status := CONST. CN_GRC_BAD_CLASS_INSTANCE; n Response Len := SIZEOF(response.res Hdr); i:=20; END_CASE ELSE response.res Hdr.n General Status := CONST. CN_GRC_BAD_CLASS_INSTANCE; n Response Len := SIZEOF(response.res Hdr); i:=20; END_CASE 12: //Get Attribute response.res Hdr.n General Status := CONST. CN_GRC_SUCCESS; MEMCPY(ADR(response.res Data), ADR(Attributes[request.req Hdr.n Attribute Id]), SIZEOF(Attributes[requ est.req Hdr.n Attribute Id])); response.res Hdr.n Data Len := INT_TO_UINT(LEN(Attributes[request.req Hdr.n Attribute Id])); n Response Len := UDINT_TO_UINT(response.res Hdr.n Data Len) + SIZEOF(response.res Hdr); i:=20; 14: //Set Attribute response.res Hdr.n General Status := CONST. CN_GRC_SUCCESS; IF request.req Hdr.n Data Len <= SIZEOF(STRING)-1 THEN MEMCPY(ADR(Attributes[request.req Hdr.n Attribute Id]), ADR(request.req Data), request.req Hdr.n Dat a Len); ELSE response.res Hdr.n General Status := CONST. CN_GRC_BAD_DATA; END_IF n Response Len := SIZEOF(response.res Hdr); i:=20; 20: //response to Ethernet/IP-driver fb Ads Rd Wr Res( NETID:= fb ADSRDWRTINDEX. NETID , PORT:= fb ADSRDWRTINDEX. PORT , INVOKEID:= fb ADSRDWRTINDEX. INVOKEID , RESULT:=n Ads Result , LEN:=n Response Len, DATAADDR:=ADR(Response) , RESPOND:=TRUE ); i:=21; n Ads Responses Sent:=n Ads Responses Sent+1; fb ADSRDWRTINDEX (CLEAR:=TRUE); 30 Version: 1.3.3 TF6280
## Page 31

Configuration 21: i:=0; fb Ads Rd Wr Res(RESPOND:=FALSE); END_CASE Implementation RS Logix 5000: 1. At the beginning you have to create a new module, either a "Generic Ethernet Module" or an EDS file exported from Twin CAT. The advantage of the imported EDS file is that it already contains the size of the process data created in the Twin CAT configuration. 2. In the settings of the attached module you may have to adjust the IP and the process data settings. TF6280 Version: 1.3.3 31
## Page 32

Configuration 3. To be able to send and receive messages acyclically, structures of the type "Messages" are necessary. In the sample, one structure is used for sending and one for receiving. You must configure both structures accordingly for sending and for receiving. 4. Right-click on the tag Set Msg-Configure Set Msg to open the configuration settings. These are to be taken over as indicated in the screenshot. The specifications Class, Instance and Attribute are freely selectable. At Service Type set Set Attributes Single. At Source Element, create an array whose contents are to be sent. Select the Source Length so that it does not exceed the length of the target variable created in Twin CAT. 5. Right-click on the tag Get Msg - Configure Get Msg to open the configuration settings. These are to be taken over as indicated in the screenshot. The specifications Class, Instance and Attribute are freely selectable. At Service Type set Get 32 Version: 1.3.3 TF6280
## Page 33

Configuration Attribute Single. Create an array at Destination Element that receives the acyclic messages. The size of the array is to be chosen according to the receiving messages. ð The following sample code sends requests to the Ethernet/IP driver of the TF6280, which forwards them to the Twin CAT PLC for further processing. A single attribute value is read from the Twin CAT PLC with a positive edge at "b Get". In this sample the values "Test Read Only Attribute1, Test Read Only Attribute2 and Test Read Only Attribute3" can be read. A single attribute value is written to the Twin CAT PLC with a positive edge at "b Set". In this sample the fourth attribute in the Twin CAT PLC can be described with the content "123Beckhoff567" and "Hello Beckhoff". //Get Attribute IF b Get THEN b Get:=0; i Case:=20+i Get; END_IF; //Set Attribute IF b Set AND i Old Case=5 THEN b Set:=0; i Case:=6; ELSIF b Set AND i Old Case=6 THEN b Set:=0; i Case:=5; END_IF; CASE i Case OF 5: //Hello Beckhoff --> (ASCII) i Old Case:=i Case; Tx Data[0]:=72; //H Tx Data[1]:=101; //e Tx Data[2]:=108; //l Tx Data[3]:=108; //l Tx Data[4]:=111; //o Tx Data[5]:=66; //B Tx Data[6]:=101; //e Tx Data[7]:=99; //c Tx Data[8]:=107; //k Tx Data[9]:=104; //h Tx Data[10]:=111; //o Tx Data[11]:=102; //f Tx Data[12]:=102; //f i Case:=10; 6: //123Beckhoff567 --> (ASCII) i Old Case:=i Case; TF6280 Version: 1.3.3 33
## Page 34

Configuration Tx Data[0]:=49; //1 Tx Data[1]:=50; //2 Tx Data[2]:=51; //3 Tx Data[3]:=66; //B Tx Data[4]:=101; //e Tx Data[5]:=99; //c Tx Data[6]:=107; //k Tx Data[7]:=104; //h Tx Data[8]:=111; //o Tx Data[9]:=102; //f Tx Data[10]:=102; //f Tx Data[11]:=52; //4 Tx Data[12]:=53; //5 Tx Data[13]:=54; //6 i Case:=10; 10: //Set Attribute msg(Set Msg); IF Set Msg. DN OR Set Msg. ER THEN FOR i Loop:=0 TO 80 DO Tx Data[i Loop]:=0; end_FOR; i Case:=0; END_IF; 20: //Test Read Only Attribute1 Get Msg. Class:=16#1000; Get Msg. Instance:=16#01; Get Msg. Attribute:=16#01; i Case:=30; 21: //Test Read Only Attribute2 Get Msg. Class:=16#1000; Get Msg. Instance:=16#01; Get Msg. Attribute:=16#02; i Case:=30; 22: //Test Read Only Attribute3 Get Msg. Class:=16#1000; Get Msg. Instance:=16#01; Get Msg. Attribute:=16#03; i Case:=30; 30: //Get Attribue msg(Get Msg); IF Get Msg. DN OR Get Msg. ER then i Get:=i Get+1; IF i Get >= 3 THEN i Get:=0; END_IF; i Case:=0; END_IF; END_CASE; You can find the documented example as a Twin CAT project here: https://infosys.beckhoff.com/content/ 1033/TF6280_Tc3_Ethernet IPSlave/Resources/14758092427/.zip. 34 Version: 1.3.3 TF6280
## Page 35

Properties 6 Properties 6.1 Virtual slave Using the TF6280, up to eight slaves can be parameterized with a physical interface. In this case a virtual MAC address is formed for each virtual slave device, so that up to eight Ether Net/IP slaves can be operated on a PC via an Ethernet interface. The advantage is that this option enables convenient connection of eight Ether Net/IP controllers and limitations in the bus communication with the slave can be bypassed without using additional hardware. This feature can be used, for sample, for exchanging large data quantities with an Ether Net/IP master or for connecting with several Ether Net/IP masters in different subnets. Create an additional box in the Twin CAT system configuration and proceed in the same way as for the configuration of a real slave. Unique MAC address If the virtual MAC address is assigned manually, ensure that it is truly unique in your network. TF6280 Version: 1.3.3 35
## Page 36

Properties 6.2 TF6280 - Configuration parameters 6.2.1 Index 0x8000 Slave Settings Index Name Meaning 8000:0 Adapter Settings 8000:1 Adapter Number Adapter Box ID 8000:3 Product Name Name of the device 8000:4 Device Type Device type 8000:5 Vendor ID Vendor number 8000:6 Product Code Product code 8000:7 Revision Version 8000:8 Serial Number Serial number (see object 0x9000) 8000:20 MAC Address MAC address (see object 0x9000) 8000:21 IP Address IP address • 0.0.0.0: Will be assigned dynamically by the DHCP service • 255.255.255.255: The operating system address is used Otherwise: statically assigned IP address 8000:22 Network Mask Subnet mask • 0.0.0.0: Will be assigned dynamically by the DHCP service Otherwise: statically assigned subnet mask 8000:23 Gateway address Gateway address • 0.0.0.0: Will be assigned dynamically by the DHCP service Otherwise: statically assigned gateway address 8000:24 DHCP Max Retries 0: Continuous repetition of the DHCP addressing attempts. (Currently only this mode is implemented, as of: 10-2016) 8000:25 TCP/IP TTL “Time to live” – value for unicast TCP/UDP communication 8000:26 TCP/IP UDP Checksum Checksum function (Unicast): • 0: UDP checksum disabled. • 1: UDP checksum enabled 8000:27 TCP/IP TCP Timeout Time switch for inactive TCP connection in seconds • 0: Time switch disabled 8000:28 Multicast TTL “Time to live” value for multicast UDP communication 8000:29 Multicast UDP Checksum function (Multicast): checksum • 0: UDP checksum disabled • 1: UDP checksum enabled 8000:2A Forward Class3 to PLC Message forwarding to the PLC (Currently not implemented, as of: 10-2016) 8000:2B Advanced adapter “Store Category” parameter options • Bit9=Cat2, • Bit8=Cat1 see Writing the IP address from the PLC [} 19] 36 Version: 1.3.3 TF6280
## Page 37

Properties 6.2.2 Index 0x8001 IO Assembly Settings Index Name Meaning 8001:0 IO Assembly Settings 8001:1 Assembly Number Assembly Id 8001:1 Configuration Instance Configuration instance 8001:3 Configuration Size Configuration size (always 0) 8001:4 Input Instance (T->O) Link point for input values (T->O: Target->Originator) 8001:5 Input Size (T->O) Size of the input values (in bytes) 8001:6 Output Instance (O->T) Link point for output values (O->T, Originator->Target) 8001:7 Output Size (O-T) Size of the output values (in bytes) 8001:8 Heartbeat Instance (Listen Only)* Heartbeat link point (only for monitoring connections) 8001:9 Heartbeat Size (Listen Only)* always 0 8001:A Heartbeat Instance (Input Only)** Heartbeat link point (only for input connections) 8001:B Heartbeat Size (Input Only)** always 0 8001:C Advanced Assembly Options Bit 14: 0x4000 hex • 0 = default • 1 = disables the link between “Conn Ctrl“ and ”Conn State“ for the Ether Net/IP IO connection The other bits are always set to 0 (reserved) * Heartbeat Instance (Listen Only): Enables monitoring of the input data (output data for TF6280) if a connection exists. The "Listen Only" connection is also terminated when the normal connection is terminated. ** Heartbeat Instance (Input Only): Enables reading of the input data (output data for TF6280). This connection is independent of the actual communication. The heartbeat is necessary for the monitoring of both connection types (Listen Only and Input Only). 6.2.3 Index 0x9000 Adapter Info The current valid settings are displayed here; these can differ from the object 0x8000. The object 0x9000 displays the active parameters. 6.2.4 Index 0x9001 IO Assembly Info The current valid assembly settings are displayed here; these can differ from the object 0x8001. The object 0x9001 displays the active parameters. TF6280 Version: 1.3.3 37
## Page 38

Diagnostic history 7 Diagnostic history The diagnostics history is a tool for monitoring the status of the Ether Net/IP interface and displaying the diagnostic messages with timestamps in plain text. In addition, information / errors that occurred in the past are logged, in order to enable precise troubleshooting at a later stage. This also applies for errors that only occurred for such a short time that any corresponding messages were not visible. The diagnostic history is part of the Twin CAT system, where it can be found under Devices, Ether Net/IP in the Diag History tab. 38 Version: 1.3.3 TF6280
## Page 39

Diagnostic history 7.1 Error codes TF6280 Error Code Description Remedy/meaning hex / (decimal) CN_ORC_ALREADY_USED 0x100 / Connection already The connection is already (256) in use established; use another connection or close this one CN_ORC_BAD_TRANSPORT 0x103 / Transport type not The transport type is not supported (259) supported CN_ORC_OWNER_CONFLICT 0x106 / More than one guy A connection already exists; a further (262) configuring connection cannot be established CN_ORC_BAD_CONNECTION 0x107 / Trying to close Faulty connection (263) inactive conn CN_ORC_BAD_CONN_TYPE 0x108 / Unsupported The Connection type is not (264) connection type supported, check your settings. CN_ORC_BAD_CONN_SIZE 0x109 / Connection size The connection size does not match, (265) mismatch check your settings. CN_ORC_CONN_UNCONFIGUR 0x110 / Connection Connection was not configured ED (272) unconfigured CN_ORC_BAD_RPI 0x111 / Unsupportable RPI The task time usually doesn't match; (273) make sure that the EL6652 operates internally with 1 ms and that you can adjust this with the Cycle Time Multiplier. Otherwise adjust the task time. CN_ORC_NO_CM_RESOURCES 0x113 / Conn Mgr out of No further resources are available (275) connections CN_ORC_BAD_VENDOR_PROD 0x114 / Mismatch in Wrong vendor number UCT (276) electronic key CN_ORC_BAD_DEVICE_TYPE 0x115 / Mismatch in Wrong device type (277) electronic key CN_ORC_BAD_REVISION 0x116 / Mismatch in Wrong revision number (278) electronic key CN_ORC_BAD_CONN_POINT 0x117 / Non-existent Wrong connection number (279) instance number CN_ORC_BAD_CONFIGURATIO 0x118 / Bad config instance Faulty configuration N (280) number CN_ORC_CONN_REQ_FAILS 0x119 / No controlling Connection could not be established (281) connection open CN_ORC_NO_APP_RESOURCE 0x11A / App out of No more free connections available. S (282) connections If you cannot fix this error yourself, Support will require the following information: • Twin CAT version and build number and a • Wireshark recording Prepare Wireshark recording The Wireshark recording can be created with a network hub, a network switch with port mirroring, e.g. the Beckhoff ET2000, or with the Promiscuous Mode of the Twin CAT system. TF6280 Version: 1.3.3 39
## Page 40

Diagnostic history 40 Version: 1.3.3 TF6280
## Page 41

Appendix 8 Appendix 8.1 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF6280 Version: 1.3.3 41
## Page 43

More Information: www.beckhoff.com/tf6280 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
