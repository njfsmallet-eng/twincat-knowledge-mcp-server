---
title: "TwinCAT_3_PLC_Lib_Tc2_MC2_Drive_EN"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "DRIVE", "LIB", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.13.1"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc2_MC2_Drive_EN.pdf"
release_date: "2025-09-24"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc2_MC2_Drive 2025-09-24 | Version: 1.13.1
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 Functions................................................................................................................................................. 11 3.1 F_Get Version Tc Mc2Drive............................................................................................................... 11 4 Function blocks....................................................................................................................................... 12 4.1 General Beckhoff............................................................................................................................ 12 4.1.1 Function blocks for determining current values................................................................ 12 4.1.2 FB_Delete Position Offset.................................................................................................. 14 4.1.3 FB_Brake Control.............................................................................................................. 15 4.1.4 FB_Set Position Offset....................................................................................................... 17 4.1.5 FB_Read Drive Info............................................................................................................ 18 4.1.6 FB_Park Axis.................................................................................................................... 19 4.2 General So E.................................................................................................................................... 20 4.2.1 FB_So ERead................................................................................................................... 20 4.2.2 FB_So EWrite................................................................................................................... 23 4.2.3 FB_So EReset.................................................................................................................. 26 4.2.4 FB_So EWrite Password.................................................................................................... 28 4.2.5 FB_So ESet Data Access Mode.......................................................................................... 29 4.2.6 Function blocks for command.......................................................................................... 30 4.2.7 Function blocks for diagnostics........................................................................................ 34 4.2.8 Function blocks for determining current values................................................................ 40 4.3 General Co E................................................................................................................................... 45 4.3.1 FB_Co ERead................................................................................................................... 45 4.3.2 FB_Co EWrite................................................................................................................... 47 4.3.3 FB_Co EExecute Command.............................................................................................. 49 4.4 AX5000 So E.................................................................................................................................... 50 4.4.1 FB_So EAX5000Read Act Main Voltage............................................................................. 50 4.4.2 FB_So EAX5000Set Motor Ctrl Word.................................................................................. 52 4.4.3 FB_So EAX5000Firmware Update.................................................................................... 53 4.4.4 FB_So EAX5000Set Position Offset................................................................................... 57 4.4.5 FB_So EAX5000Delete Position Offset.............................................................................. 58 4.4.6 FB_So EAX5000Park Axis................................................................................................. 59 4.5 AX8000 Co E................................................................................................................................... 60 4.5.1 FB_Co EAX8000Brake Control.......................................................................................... 60 4.5.2 FB_Co EAX8000Brake Test.............................................................................................. 61 4.5.3 FB_Co EAX8000Set Position Offset................................................................................... 63 4.5.4 FB_Co EAX8000Delete Position Offset.............................................................................. 64 4.5.5 FB_Co EAX8000Park Axis................................................................................................. 65 4.6 EL72xx Co E.................................................................................................................................... 66 4.6.1 FB_Co EEL72xx Brake Control........................................................................................... 66 TE1000 Version: 1.13.1 3
## Page 4

Table of contents 4.6.2 FB_Co EEL72xx Set Position Offset.................................................................................... 67 4.6.3 FB_Co EEL72xx Delete Position Offset............................................................................... 68 5 Data types................................................................................................................................................ 70 5.1 E_Fw Update State........................................................................................................................... 70 5.2 E_Drive Error Codes......................................................................................................................... 71 5.3 E_Position Offset Memory................................................................................................................ 71 5.4 E_Position Offset Feedback.............................................................................................................. 72 5.5 E_Brake Mode................................................................................................................................. 72 5.6 E_Device Type................................................................................................................................. 72 5.7 E_Park Mode................................................................................................................................... 73 5.8 ST_Drive Info................................................................................................................................... 73 5.9 E_So EData Access Mode................................................................................................................. 74 5.10 E_AX5000Park Mode....................................................................................................................... 74 5.11 E_Drive Parameter Number.............................................................................................................. 74 5.12 E_Read Write Mode.......................................................................................................................... 75 5.13 ST_Serial Number............................................................................................................................ 75 6 Global constants..................................................................................................................................... 76 6.1 So E Parameter Access................................................................................................................... 76 7 Support and Service............................................................................................................................... 77 4 Version: 1.13.1 TE1000
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.13.1 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.13.1 TE1000
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.13.1 7
## Page 8

Overview 2 Overview The Tc2_MC2_Drive library includes functions and function blocks for So E drives that access the drive by MC2 axis structure (AXIS_REF). Drive libraries The three drive libraries Tc2_Drive, Tc2_Nc Drive and Tc2_MC2_Drive were developed for different functional purposes but are almost identical in their functionality. The function blocks of the libraries Tc2_Nc Drive and Tc_MC2_Drive form wrapper function blocks around the function blocks of the Tc2_Drive library. Drive library Use Access to the drive Remarks Tc2_Drive Use the Tc2_Drive The drive is accessed via a drive If you want to access library if you use reference. Within the library, the parameters in the drive for which See documentation the drive entirely ST_Drive Ref structure is used no special function block has Twin CAT 3 PLC Lib: from the PLC (i.e. for this with the Net ID as a been implemented, use the Tc2_Drive without NC). string. For linking purposes, a function blocks structure called ST_Plc Drive Ref FB_So ERead_By Drive Ref and is also provided with the Net ID FB_So EWrite_By Drive Ref. as a byte array. These function blocks are implemented in the PLC Lib (See Drive reference Tc2_Ether CAT in the ST_Drive Ref) So E Interface folder. Tc2_Nc Drive Use the The drive is accessed via the If you want to access Tc2_Nc Drive library NC axis structure parameters in the drive for which See documentation if you are using the (NC_TO_PLC). The function no special function block has Twin CAT 3 PLC Lib: drive via the NC blocks of the Tc2_Nc Drive been implemented, use the Tc2_Nc Drive with the Tc2_Nc library independently determine function blocks FB_So ERead libraries. the access data to the drive and FB_So EWrite. (Net ID, address and channel number) via the NC axis ID from the NC axis structure. Tc2_MC2_Drive Use the The drive is accessed via the If you want to access Tc2_MC2_Drive MC2 axis reference parameters in the drive for which See: Twin CAT 3 library if you are (AXIS_REF). The function no special function block has PLC Lib using the drive via blocks of the Tc2_MC2_Drive been implemented, use the Tc2_MC2_Drive the NC with the library independently determine function blocks FB_So ERead documentation Tc2_MC2 library. the access data to the drive and FB_So EWrite. (Net ID, address and channel number) via the NC axis ID from the MC2 axis reference. Functions Name Description F_Get Version Tc Mc2Drive [} 11] Reads version information from the PLC library. The function has been replaced by the global structure st Lib Version_Tc2_MC2_Drive. F_Conv Word To STAX5000C1D Converts the C1D word (S-0-0011) of the AX5000 to an ST_AX5000_C1D structure. See: Twin CAT 3 PLC Library:Tc2_Drive documentation. Function blocks General Beckhoff Name Description FB_Brake Control [} 15] For opening and closing the motor brake. 8 Version: 1.13.1 TE1000
## Page 9

Overview Name Description FB_Set Position Offset [} 17] Saves a position offset. FB_Delete Position Offset [} 14] Deletes a position offset. FB_Read Drive Info [} 18] Reads basic information. FB_Park Axis [} 19] For parking and releasing the axis General So E Name Description FB_So ERead [} 20] Reads a parameter. FB_So EWrite [} 23] Writes a parameter. FB_So EReset [} 26] Resets the drive (S-0-0099). FB_So EWrite Password [} 28] Sets the drive password (S-0-0267). FB_So ESet Data Access Mode [} 29] Sets the access mode of So E parameters. FB_So EExecute Command [} 30] Executes a command. FB_So EWrite Command Control [} 31] Sets the Command Control. FB_So ERead Command State [} 32] Checks the command state. FB_So ERead Diag Message [} 34] Reads the diagnostic message (S-0-0095). FB_So ERead Diag Number [} 35] Reads the diagnostic number (S-0-0390). FB_So ERead Diag Number List [} 37] Reads the diagnostic number list (up to 30 entries) (S-0-0375). FB_So ERead Class XDiag [} 38] Reads the Class 1 diagnosis (S-0-0011) and the Class 3 diagnosis (S-0-0013). FB_So ERead Amplifier Temperature [} 40] Reads the drive temperature (S-0-0384). FB_So ERead Motor Temperature [} 41] Reads the motor temperature (S-0-0383). FB_So ERead Dc Bus Current [} 43] Reads the DC bus current (S-0-0381). FB_So ERead Dc Bus Voltage [} 44] Reads the DC bus voltage (S-0-0380). General Co E Name Description FB_Co ERead [} 45] Reads a parameter. FB_Co EWrite [} 47] Writes a parameter. FB_Co EExecute Command [} 49] Executes a command. AX5000 So E FB_So EAX5000Read Act Main Voltage [} 50] Reads the mains voltage (P-0-0200). FB_So EAX5000Set Motor Ctrl Word [} 52] Sets the Motor Control Word (P-0-0096). FB_So EAX5000Firmware Update [} 53] Executes an automatic firmware update for the AX5000. FB_So EAX5000Set Position Offset [} 57] Saves a position offset. FB_So EAX5000Delete Position Offset [} 58] Deletes a position offset. FB_So EAX5000Park Axis [} 59] For parking and releasing the axis. AX8000 Co E TE1000 Version: 1.13.1 9
## Page 10

Overview Name Description FB_Co EAX8000Brake Control [} 60] For opening and closing the motor brake. FB_Co EAX8000Brake Test [} 61] Performs a brake test. FB_Co EAX80000Set Position Offset [} 63] Saves a position offset. FB_Co EAX80000Delete Position Offset [} 64] Deletes a position offset. FB_Co EAX8000Park Axis [} 65] For parking and releasing the axis. EL72xx Co E Name Description FB_Co EEL72xx Brake Control [} 66] For opening and closing the motor brake. FB_Co EEL72xx Set Position Offset [} 67] Saves a position offset. FB_Co EEL72xx Delete Position Offset [} 68] Deletes a position offset. 10 Version: 1.13.1 TE1000
## Page 11

Functions 3 Functions 3.1 F_Get Version Tc Mc2Drive This function can be used to read PLC library version information. FUNCTION F_Get Version Tc Mc2Drive: UINT VAR_INPUT n Version Element : INT; END_VAR n Version Element: Version element to be read. Possible parameters: • 1 : major number; • 2 : minor number; • 3 : revision number; TE1000 Version: 1.13.1 11
## Page 12

Function blocks 4 Function blocks 4.1 General Beckhoff 4.1.1 Function blocks for determining current values 4.1.1.1 FB_Read Drive Parameter FB_Read Drive Parameter ↔ Axis Reference To AXIS_REF BOOL Valid Execute BOOL BOOL Busy Parameter Number E_Drive Parameter Number BOOL Error Mode E_Read Write Mode UDINT Error Id Interval TIME Value Any Type The FB_Read Drive Parameter function block can be used to read various parameters of the Beckhoff servo hardware asynchronously. Supported Beckhoff hardware AX5xxx AX8xxx / AMP8xxx / MD8xxx Compact drive technology (servo) from FW v2.11 b0001 from FW v1.04 b0001 from FW v01 (AMI8xxx only Drive) Inputs VAR_INPUT Execute : BOOL; Parameter Number : E_Drive Parameter Number; Mode : E_Read Write Mode; Interval : TIME; Value : ANY; END_VAR Name Type Description Execute BOOL The function block is activated by a positive edge at this input. Parameter Numb E_Drive Parameter Numbe Specifies which parameter is to be read. er r [} 74] Mode E_Read Write Mode Specifies whether the parameter is to be read once or cyclically (as quickly as possible). [} 75] Interval TIME In addition to E_Read Write Mode. Cyclic, an interval time can be specified here in which the parameter is to be read. Value ANY A variable of the correct type must be passed for the parameter. The required type is specified as a comment after the entry in the E_Drive Parameter Number [} 74] structure. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR 12 Version: 1.13.1 TE1000
## Page 13

Function blocks Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Valid : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Valid BOOL This output is set if valid information has been written to the "Value" variable. Busy BOOL This output is set when the function block is activated, and remains set until feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development envi- Target platform type PLC libraries to in- Firmware version Revision ronment clude Twin CAT ≥4024.67 PC or CX (x86 or x64) Tc2_MC2_Drive ≥0032 ≥V3.3.51.0 4.1.1.2 FB_Write Drive Parameter FB_Write Drive Parameter ↔ Axis Reference To AXIS_REF BOOL Valid Execute BOOL BOOL Busy Parameter Number E_Drive Parameter Number BOOL Error Mode E_Read Write Mode UDINT Error Id Interval TIME Value Any Type The FB_Write Drive Parameter function block can be used to write various parameters of the Beckhoff servo hardware asynchronously. Supported Beckhoff hardware AX5xxx AX8xxx / AMP8xxx / MD8xxx Compact drive technology (servo) from FW v2.11 b0001 from FW v1.04 b0001 from FW v01 (AMI8xxx only Drive) Inputs VAR_INPUT Execute : BOOL; Parameter Number : E_Drive Parameter Number; Mode : E_Read Write Mode; Interval : TIME; Value : ANY; END_VAR TE1000 Version: 1.13.1 13
## Page 14

Function blocks Name Type Description Execute BOOL The function block is activated by a positive edge at this input. Parameter Numb E_Drive Parameter Numbe Specifies which parameter is to be written. er r [} 74] Mode E_Read Write Mode Specifies whether the parameter is to be written once or cyclically (as quickly as possible). [} 75] Interval TIME In addition to E_Read Write Mode. Cyclic, an interval time can be specified here in which the parameter is to be written. Value ANY A variable of the correct type must be passed for the parameter. The required type is specified as a comment after the entry in the E_Drive Parameter Number [} 74] structure. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Valid : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Valid BOOL This output is set when valid information has been written to the drive. Busy BOOL This output is set when the function block is activated, and remains set until feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development envi- Target platform type PLC libraries to in- Firmware version Revision ronment clude Twin CAT ≥4024.67 PC or CX (x86 or x64) Tc2_MC2_Drive ≥0032 ≥V3.3.51.0 4.1.2 FB_Delete Position Offset FB_Delete Position Offset Execute BOOL BOOL Busy Feedback E_Position Offset Feedback BOOL Error Memory E_Position Offset Memory UDINT Error ID ↔ Axis Reference To AXIS_REF The FB_Delete Position Offset function block can be used to delete a position offset in the memory of a Beckhoff servo hardware. 14 Version: 1.13.1 TE1000
## Page 15

Function blocks Supported Beckhoff hardware AX5xxx AX8xxx / AMP8xxx / MD8xxx Compact drive technology (servo) from FW v2.11 b0001 from FW v1.04 b0001 from FW v01 (AMI8xxx only Drive) Inputs VAR_INPUT Execute : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies the memory from which the position offset is to be deleted. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environment Target platform type PLC library Twin CAT ≥4024.48 PC or CX (x86 or x64) Tc2_MC2_Drive ≥V3.3.34.0 4.1.3 FB_Brake Control FB_Brake Control Execute BOOL BOOL Busy Mode E_Brake Mode BOOL Error ↔ Axis Reference To AXIS_REF UDINT Error ID TE1000 Version: 1.13.1 15
## Page 16

Function blocks The FB_Brake Control function block can be used to manually open or close the brake of a motor that is operated on Beckhoff servo hardware. It should be noted that the brake is permanently closed or opened via "Lock" or "Unlock". It is recommended to open or close the brake manually only for the necessary duration. The brake should then be set back to "Automatic" mode using the function block. Supported Beckhoff hardware AX5xxx AX8xxx / AMP8xxx / MD8xxx Compact drive technology (servo) from FW v1.07 b0001 from FW v1.04 b0001 from FW v01 (EL72xx only with OCT and from FW v16) Inputs VAR_INPUT Execute : BOOL; Mode : E_Brake Mode; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Mode E_Brake Mode [} 72] The mode with which the brake is controlled. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environment Target platform type PLC library Twin CAT ≥4024.48 PC or CX (x86 or x64) Tc2_MC2_Drive ≥V3.3.34.0 16 Version: 1.13.1 TE1000
## Page 17

Function blocks 4.1.4 FB_Set Position Offset FB_Set Position Offset Execute BOOL BOOL Busy Position LREAL BOOL Error Relative BOOL UDINT Error ID Feedback E_Position Offset Feedback Memory E_Position Offset Memory ↔ Axis Reference To AXIS_REF The FB_Set Position Offset function block can be used to store a position offset in the memory of a Beckhoff servo hardware. Saving in the digital nameplate of the connected motor encoder is also possible. To do this, the offset must first be configured with the Drive Manager and then the same memory location (encoder / drive) must be used in the function block. Supported Beckhoff hardware AX5xxx AX8xxx / AMP8xxx / MD8xxx Compact drive technology (servo) from FW v2.11 b0001 from FW v1.04 b0001 from FW v01 (AMI8xxx only Drive) Inputs VAR_INPUT Execute : BOOL; Position : LREAL; Relative : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Position LREAL New actual position of the NC axis Relative BOOL When this flag is set, the position is interpreted relatively. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies which memory the newly calculated position offset should be stored in. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR TE1000 Version: 1.13.1 17
## Page 18

Function blocks Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environment Target platform type PLC library Twin CAT ≥4024.48 PC or CX (x86 or x64) Tc2_MC2_Drive ≥V3.3.34.0 4.1.5 FB_Read Drive Info FB_Read Drive Info Execute BOOL BOOL Done ↔ Axis Reference To AXIS_REF BOOL Busy BOOL Error UDINT Error ID ST_Drive Info Drive Info The FB_Read Drive Info function block can be used to read basic information for communication with a Beckhoff servo hardware. Supported Beckhoff hardware AX5xxx AX8xxx / AMP8xxx / MD8xxx Compact drive technology Inputs VAR_INPUT Execute : BOOL; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; Drive Info : ST_Drive Info; END_VAR 18 Version: 1.13.1 TE1000
## Page 19

Function blocks Name Type Description Done BOOL TRUE if the command was executed successfully. Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Drive Info ST_Drive Info [} 73] Data structure with basic information to communicate with a Beckhoff servo hardware. Requirements Development environment Target platform type PLC library Twin CAT ≥4024.48 PC or CX (x86 or x64) Tc2_MC2_Drive ≥V3.3.34.0 4.1.6 FB_Park Axis FB_Park Axis ↔ Axis Reference To AXIS_REF BOOL Busy Execute BOOL BOOL Error Mode E_Park Mode UDINT Error ID The function block FB_Park Axis enables the parking functionality of a supported Beckhoff drive. A parked channel of a drive is temporarily disabled. In the case of a modular machine concept, certain motors may not be available. So that this does not lead directly to errors (e.g. feedback errors), the channels can be disabled via this. NOTICE Unintentional stopping of axes For multi-channel devices, the controller enables must be switched off for all axes of the corresponding channels before one or more channels are parked. The same applies to activating channels of a multi- channel device. Otherwise, the axes of the other channels may be deactivated unintentionally. Supported Beckhoff hardware AX5xxx AX8xxx / MD8xxx Compact drive technology from FW v2.12 b0001 from FW v1.06 b0003 Inputs VAR_INPUT Execute : BOOL; Mode : E_Park Mode; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Mode E_Park Mode [} 74] Mode for selecting whether the FB parks or releases the axis. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR TE1000 Version: 1.13.1 19
## Page 20

Function blocks Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environment Target platform type PLC library Twin CAT ≥4024.60 PC or CX (x86 or x64) Tc2_MC2_Drive ≥V3.3.41.0 Twin CAT ≥4026.8 4.2 General So E 4.2.1 FB_So ERead FB_So ERead Net Id T_Ams Net ID BOOL Busy Idn WORD BOOL Error Element BYTE UINT Ads Err Id p Dst Buf PVOID UINT Sercos Err Id Buf Len UDINT DWORD Attribute Execute BOOL Timeout TIME ↔ Axis Reference To AXIS_REF With the FB_So ERead function block a parameter can be read. By default, attributes and values are read in parallel. If the call generates an ADS error on a third-party device, the lack of support for this faster parameter access method may be the cause. In this case, the FB_So ESet Data Access Mode [} 29] function block can be used to switch to the slower sequential access method, if required. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Idn : WORD; Element : BYTE; p Dst Buf : PVOID; Buf Len : UDINT; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR 20 Version: 1.13.1 TE1000
## Page 21

Function blocks Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Idn WORD Parameter number that FB_So ERead refers to, e.g. "S_0_IDNs + 33" for S-0-0033 Element BYTE Specifies which part of the parameter should be accessed, e.g. 16#40 is the value (Value) of the parameter. EC_SOE_ELEMENT_DATASTATE :BYTE :=16#01; EC_SOE_ELEMENT_NAME :BYTE :=16#02; EC_SOE_ELEMENT_ATTRIBUTE :BYTE :=16#04; EC_SOE_ELEMENT_UNIT :BYTE :=16#08; EC_SOE_ELEMENT_MIN :BYTE :=16#10; EC_SOE_ELEMENT_MAX :BYTE :=16#20; EC_SOE_ELEMENT_VALUE :BYTE :=16#40; EC_SOE_ELEMENT_DEFAULT :BYTE :=16#80; p Dst Buf PVOID ADR() of the variables that the value should be read to. Buf Len UDINT SIZEOF() of the variables that the value should be read to. Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. The Idns can be taken from the corresponding drive documentation. For the AX5000 from Beckhoff see AX5000 Idn description. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. TE1000 Version: 1.13.1 21
## Page 22

Function blocks Name Type Description Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Read : FB_So ERead; Read : BOOL; Idn : WORD; Read Value : UINT; (* Nc Axis *) Axis : AXIS_REF; IF Read THEN Idn := S_0_IDNs + 33; fb Read( Axis := Axis, Idn := Idn, Element := 16#40, p Dst Buf := ADR(Read Value), Buf Len := SIZEOF(Read Value), Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, ); IF NOT fb Read. Busy THEN fb Read(Axis := Axis, Execute := FALSE); Read := FALSE; END_IF END_IF Parameter access Note that for some parameters, the additional items of information "Actual Length" & "Max Length" are necessary for the parameter access. In order to determine the parameters for which this is necessary, the attributes can be displayed in the parameter list of the Drive Manager via the context menu of the header. 22 Version: 1.13.1 TE1000
## Page 23

Function blocks If the fifth place from the right contains the value 4, 5, 6 or 7, then the additional items of information are also transmitted. The structure to read out the serial number (S-0-0432) then looks like, see ST_Serial Number [} 75]: 4.2.2 FB_So EWrite FB_So EWrite Net Id T_Ams Net ID BOOL Busy Idn WORD BOOL Error Element BYTE UINT Ads Err Id p Src Buf PVOID UINT Sercos Err Id Buf Len UDINT Execute BOOL Timeout TIME Password ST_So E_String ↔ Axis Reference To AXIS_REF With the FB_So EWrite function block a parameter can be written. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Idn : WORD; Element : BYTE; Src Buf : PVOID; Buf Len : UDINT; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; Password : ST_So E_String; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Idn WORD Parameter number that FB_So ERead refers to, e.g. "S_0_IDNs + 47" for S-0-0047, see AX5000 Idn description. TE1000 Version: 1.13.1 23
## Page 24

Function blocks Name Type Description Element BYTE Specifies which part of the parameter should be accessed, e.g. 16#40 is the value (Value) of the parameter. Usually there is only write access to the value, other components of the parameter are read-only. EC_SOE_ELEMENT_DATASTATE :BYTE :=16#01; EC_SOE_ELEMENT_NAME :BYTE :=16#02; EC_SOE_ELEMENT_ATTRIBUTE :BYTE :=16#04; EC_SOE_ELEMENT_UNIT :BYTE :=16#08; EC_SOE_ELEMENT_MIN :BYTE :=16#10; EC_SOE_ELEMENT_MAX :BYTE :=16#20; EC_SOE_ELEMENT_VALUE :BYTE :=16#40; EC_SOE_ELEMENT_DEFAULT :BYTE :=16#80; Src Buf PVOID ADR() of the variable containing the value to be written. Buf Len UDINT SIZEOF() of the variables that the value should be read to. Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Password ST_So E_String Password as Sercos string. Currently not used. The password must be written with FB_So EWrite Password. The Idns can be taken from the corresponding drive documentation. For the AX5000 from Beckhoff see AX5000 Idn description. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UDINT In the case of a set Error output returns the Sercos error of the last executed command. 24 Version: 1.13.1 TE1000
## Page 25

Function blocks Sample fb Write : FB_So EWrite; Idn : WORD; Write : BOOL; Write Value : UINT; Password : ST_So E_String; (* Nc Axis *) Axis : AXIS_REF; IF Write THEN Idn := S_0_IDNs + 33; fb Write( Axis := Axis, Idn := Idn, Element := 16#40, p Src Buf := ADR(Write Value), Buf Len := SIZEOF(Write Value), Password := Password, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, ); IF NOT fb Write. Busy THEN fb Write(Axis := Axis, Execute := FALSE); Write := FALSE; END_IF END_IF Parameter access Note that for some parameters, the "Actual Length" and "Max Length" additional items of information are necessary for parameter access. In order to determine the parameters that this is necessary for, the attributes can be displayed in the parameter list of the Drive Manager via the context menu of the header. If the fifth place from the right contains the value 4, 5, 6 or 7, then the additional items of information are also transmitted. TE1000 Version: 1.13.1 25
## Page 26

Function blocks The structure for reading out the serial number (S-0-0432), see ST_Serial Number [} 75]. 4.2.3 FB_So EReset FB_So EReset Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id The drive (S-0-0099) can be reset with the function block FB_So EReset. In the case of multiple-channel devices if necessary, both channels will have to perform a reset. The timeout time must be 10 s, as the reset can take up to 10 s depending on the error. The flag "Wait For Wc State is OK" must be enabled in the advanced Ether CAT settings for the AX5000. 26 Version: 1.13.1 TE1000
## Page 27

Function blocks An NC reset will not be performed. If an NC reset is necessary, it can be executed via the function block MC_Reset from the Tc2_MC2 PLC library. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := T#10s; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Sample fb So EReset : FB_So EReset; So EReset : BOOL; (* Nc Axis *) Axis : AXIS_REF; IF So EReset THEN fb So EReset( Axis := Axis, Execute := TRUE, ); IF NOT fb So EReset. Busy THEN fb So EReset(Axis := Axis, Execute := FALSE); So EReset := FALSE; END_IF END_IF TE1000 Version: 1.13.1 27
## Page 28

Function blocks 4.2.4 FB_So EWrite Password FB_So EWrite Password Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id Password ST_So E_String UINT Sercos Err Id ↔ Axis Reference To AXIS_REF With the FB_So EWrite Password function block (S-0-0267) the drive password can be set. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; Password : ST_So E_String; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Password ST_So E_String Password as a Sercos string. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. 28 Version: 1.13.1 TE1000
## Page 29

Function blocks Sample fb Write Password : FB_So EWrite Password; Write Password : BOOL; Password : ST_So E_String; (* Nc Axis *) Axis : AXIS_REF; IF Write Password THEN fb Write Password( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Password := Password ); IF NOT fb Write Password. Busy THEN fb Write Password(Axis := Axis, Execute := FALSE); Write Password := FALSE; END_IF END_IF 4.2.5 FB_So ESet Data Access Mode FB_So ESet Data Access Mode Execute BOOL BOOL Busy Mode E_So EData Access Mode BOOL Error UINT Err Id The So E parameter access mode is set with the function block FB_So ESet Data Access Mode. Attributes & Value are accessed in parallel by default. If this access mode is not supported by the device manufacturer, sequential access can be enforced. Generally, however, parallel access is faster. Inputs VAR_INPUT Execute : BOOL; Mode : E_So EData Access Mode := E_So EData Access Mode.e So EData Access Mode_Parallel; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Mode E_So EData Access Mode [} 74] Defines the access mode. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Err Id UINT In the event of a set error output returns the ADS error code. TE1000 Version: 1.13.1 29
## Page 30

Function blocks 4.2.6 Function blocks for command 4.2.6.1 FB_So EExecute Command FB_So EExecute Command Net Id T_Ams Net ID BOOL Busy Idn WORD BOOL Error Execute BOOL UINT Ads Err Id Timeout TIME UINT Sercos Err Id ↔ Axis Reference To AXIS_REF With the FB_So EExecute Command function block a command can be executed. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Idn : WORD; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Idn WORD Parameter number that FB_So EExecute Command refers to, e.g. "P_0_IDNs + 160" for P-0-0160. Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. 30 Version: 1.13.1 TE1000
## Page 31

Function blocks Sample fb Execute Command : FB_So EExecute Command; Execute Command : BOOL; Idn : WORD; (* Nc Axis *) Axis : AXIS_REF; IF Execute Command THEN Idn := P_0_IDNs + 160; fb Execute Command( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Idn := Idn, ); IF NOT fb Execute Command. Busy THEN fb Execute Command(Axis := Axis, Execute := FALSE); Execute Command := FALSE; END_IF END_IF 4.2.6.2 FB_So EWrite Command Control FB_So EWrite Command Control Net Id T_Ams Net ID BOOL Busy Idn WORD BOOL Error Cmd Control E_So E_Cmd Control UINT Ads Err Id Execute BOOL UINT Sercos Err Id Timeout TIME ↔ Axis Reference To AXIS_REF With the FB_So EWrite Command Control function block a command can be prepared, started or canceled. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Idn : WORD; Cmd Control : E_So E_Cmd Control; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Idn WORD Parameter number that FB_So EWrite Command Control refers to, e.g. "P_0_IDNs + 160" for P-0-0160. Cmd Control E_So E_Cmd Control Indicates whether a command should be prepared (e So E_Cmd Control_Set := 1), executed (e So E_Cmd Control_Set And Enable := 3), or aborted (e So E_Cmd Control_Cancel := 0). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR TE1000 Version: 1.13.1 31
## Page 32

Function blocks Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Sample fb Write Command Control : FB_So EWrite Command Control; Write Command Control : BOOL; Idn : WORD; Cmd Control : E_So E_Cmd Control; (* Nc Axis *) Axis : AXIS_REF; IF Write Command Control THEN Idn := P_0_IDNs + 160; fb Write Command Control( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Idn := Idn, Cmd Control := Cmd Control ); IF NOT fb Write Command Control. Busy THEN fb Write Command Control(Axis := Axis, Execute := FALSE); Write Command Control := FALSE; END_IF END_IF 4.2.6.3 FB_So ERead Command State FB_So ERead Command State Net Id T_Ams Net ID BOOL Busy Idn WORD BOOL Error Execute BOOL E_So E_Cmd State Cmd State Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id With the FB_So ERead Command State function block the command execution can be checked. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Idn : WORD; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR 32 Version: 1.13.1 TE1000
## Page 33

Function blocks Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Idn WORD Parameter number that FB_So ERead Command State_By Drive Ref refers to, e.g. "P_0_IDNs + 160" for P-0-0160 Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Cmd State : E_So E_Cmd State; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Cmd State E_So E_Cmd State Returns the command status: e So E_Cmd State_Not Set = 0 - kein Kommando aktiv e So E_Cmd State_Set = 1 - Kommando gesetzt (vorbereitet) aber (noch ) nicht ausgeführt e So E_Cmd State_Executed = 2 - Kommando wurde ausgeführt e So E_Cmd State_Set Enabled Executed = 3 - Kommando gesetzt (vorbereitet) und ausgef ührt e So E_Cmd State_Set And Interrupted = 5 - Kommando wurde gesetzt aber unterbrochen e So E_Cmd State_Set Enabled Not Executed = 7 - Kommandoausführung ist noch aktiv TE1000 Version: 1.13.1 33
## Page 34

Function blocks Name Type Description e So E_Cmd State_Error = 15 - Fehler bei der Kommandoausführung, es wur de in den Fehlerstate gewechselt Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Sample fb Read Command State : FB_So ERead Command State; Read Command State : BOOL; Idn : WORD; Cmd State : E_So E_Cmd State; (* Nc Axis *) Axis : AXIS_REF; IF Read Command State THEN Idn := P_0_IDNs + 160; fb Read Command State( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Idn := Idn, Cmd State => Cmd State ); IF NOT fb Read Command State. Busy THEN fb Read Command State(Axis := Axis, Execute := FALSE); Read Command State := FALSE; END_IF END_IF 4.2.7 Function blocks for diagnostics 4.2.7.1 FB_So ERead Diag Message FB_So ERead Diag Message Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id ST_So E_String Diag Message DWORD Attribute With the FB_So ERead Diag Message function block the diagnosis message can be read out as a Sercos string (S-0-0095). Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. 34 Version: 1.13.1 TE1000
## Page 35

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Diag Message : ST_So E_String; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Diag Message ST_So E_String Returns the diagnosis message. Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Diag Message : FB_So ERead Diag Message; b Diag Message : BOOL; Diag Message : ST_So E_String; (* Nc Axis *) Axis : AXIS_REF; IF b Diag Message THEN fb Diag Message( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Diag Message => Diag Message ); IF NOT fb Diag Message. Busy THEN fb Diag Message(Axis := Axis, Execute := FALSE); b Diag Message := FALSE; END_IF END_IF 4.2.7.2 FB_So ERead Diag Number FB_So ERead Diag Number Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id UDINT Diag Number DWORD Attribute TE1000 Version: 1.13.1 35
## Page 36

Function blocks With the FB_So ERead Diag Number function block the current diagnostic number can be read out as UDINT (S-0-0390). Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Diag Number : UDINT; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Diag Number UDINT Returns the current diagnostic number. Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Diag Number : FB_So ERead Diag Number; b Diag Number : BOOL; Diag Number : UDINT; (* Nc Axis *) Axis : AXIS_REF; IF b Diag Number THEN fb Diag Number( Axis := Axis, Execute := TRUE, 36 Version: 1.13.1 TE1000
## Page 37

Function blocks Timeout := DEFAULT_ADS_TIMEOUT, Diag Number => Diag Number ); IF NOT fb Diag Number. Busy THEN fb Diag Number(Axis := Axis, Execute := FALSE); b Diag Number := FALSE; END_IF END_IF 4.2.7.3 FB_So ERead Diag Number List FB_So ERead Diag Number List Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id p Diag Number Pointer To ST_So E_Diag Num List UINT Sercos Err Id Size UDINT DWORD Attribute ↔ Axis Reference To AXIS_REF With the FB_So ERead Diag Number List function block a history of the diagnosis numbers can be read out as a list (S-0-0375). Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; p Diag Number : POINTER TO ST_So E_Diag Num List; Size : UDINT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. p Diag Number POINTER TO ST_So E_Diag N Pointer to the list of the last max. 30 error numbers. The um List list consists of the current and maximum number of bytes in the list as well as the 30 list items. Size UDINT Size of the list in bytes (as Sizeof()) Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Attribute : DWORD; END_VAR TE1000 Version: 1.13.1 37
## Page 38

Function blocks Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Diag Number List : FB_So ERead Diag Number List; Diag Number List : BOOL; st Diag Number List : ST_So E_Diag Num List; (* Nc Axis *) Axis : AXIS_REF; IF Diag Number List THEN fb Diag Number List( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, p Diag Number := ADR(st Diag Number List), Size := SIZEOF(st Diag Number List), ); IF NOT fb Diag Number List. Busy THEN fb Diag Number List(Axis := Axis, Execute := FALSE); Diag Number List := FALSE; END_IF END_IF 4.2.7.4 FB_So ERead Class XDiag FB_So ERead Class XDiag Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Diag Class USINT UINT Ads Err Id Timeout TIME UINT Sercos Err Id ↔ Axis Reference To AXIS_REF WORD Class XDiag DWORD Attribute With the function block FB_So ERead Class XDiag, the current Class 1 diagnosis (S-0-0011) ... Class 3 diagnosis (S-0-0013) can be read out as WORD. There is the conversion function F_Conv Word To STAX5000C1D for the evaluation of the Class 1 diagnosis as a structure ST_AX5000_C1D, (see Twin CAT 3 PLC Lib Tc2_Drive documentation). Inputs VAR_INPUT Net Id : T_Ams Net Id := ''; Execute : BOOL; Diag Class : USINT:= 1; (* 1: C1D (S-0-0011) is default, 2: C2D (S-0-0012), 3: C3D (S-0-0013) *) Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net Id String, which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. 38 Version: 1.13.1 TE1000
## Page 39

Function blocks Name Type Description Diag Class USINT Specifies which diagnosis should be read. The diagnostics parameters may vary from vendor to vendor. All diagnostics parameters (C1D ... C3D) or all bits are not always implemented in them. 1: Error: Class 1 Diag (S-0-0011) 2: Warnings: Class 2 Diag (S-0-0012) 3: Information: Class 3 Diag (S-0-0013) Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Class XDiag : WORD; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Class XDiag WORD Returns the current Class X diagnosis. Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Class XDiag : FB_So ERead Class XDiag; b Class XDiag : BOOL; Diag Class : USINT := 1; Class1Diag : WORD; st AX5000C1D : ST_AX5000_C1D; Class2Diag : WORD; (* Nc Axis *) Axis : AXIS_REF; IF b Class XDiag THEN fb Class XDiag( Axis := Axis, Execute := TRUE, Diag Class := Diag Class, Timeout := DEFAULT_ADS_TIMEOUT ); IF NOT fb Class XDiag. Busy THEN fb Class XDiag(Axis := Axis, Execute := FALSE); TE1000 Version: 1.13.1 39
## Page 40

Function blocks b Class XDiag := FALSE; CASE fb Class XDiag. Diag Class OF 1: Class1Diag := fb Class XDiag. Class XDiag; st AX5000C1D := F_Conv Word To STAX5000C1D(Class1Diag); 2: Class2Diag := fb Class XDiag. Class XDiag; END_CASE END_IF END_IF 4.2.8 Function blocks for determining current values 4.2.8.1 FB_So ERead Amplifier Temperature FB_So ERead Amplifier Temperature Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id REAL Amplifier Temperature DWORD Attribute With the FB_So ERead Amplifier Temperature function block the temperature of the drive (S-0-0384) can be read. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Amplifier Temperature : REAL; Attribute : DWORD; END_VAR 40 Version: 1.13.1 TE1000
## Page 41

Function blocks Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Amplifier Tempera REAL Returns the drive temperature (e.g. 26.2 corresponds to ture 26.2 °C). Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Read Amplifier Temp : FB_So ERead Amplifier Temperature; Read Amplifier Temp : BOOL; Amplifier Temperature : REAL; (* Nc Axis *) Axis : AXIS_REF; IF Read Amplifier Temp THEN fb Read Amplifier Temp( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Amplifier Temperature => Amplifier Temperature ); IF NOT fb Read Amplifier Temp. Busy THEN fb Read Amplifier Temp(Axis := Axis, Execute := FALSE); Read Amplifier Temp := FALSE; END_IF END_IF 4.2.8.2 FB_So ERead Motor Temperature FB_So ERead Motor Temperature Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id REAL Motor Temperature DWORD Attribute With the function block FB_So ERead Motor Temperature the temperature of the motor (S-0-0383) can be read. If the motor does not contain a temperature sensor, this is 0.0, i.e. 0.0 °C. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. TE1000 Version: 1.13.1 41
## Page 42

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Motor Temperature : REAL; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Motor Temperatur REAL Returns the motor temperature (e.g. 30.5 corresponds to e 30.5 °C). If the motor does not contain a temperature sensor, this is 0.0, i.e. 0.0 °C. Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Read Motor Temp : FB_So ERead Motor Temperature; Read Motor Temp : BOOL; Motor Temperature : REAL; (* Nc Axis *) Axis : AXIS_REF; IF Read Motor Temp THEN fb Read Motor Temp( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Motor Temperature => Motor Temperature ); IF NOT fb Read Motor Temp. Busy THEN fb Read Motor Temp(Axis := Axis, Execute := FALSE); Read Motor Temp := FALSE; END_IF END_IF 42 Version: 1.13.1 TE1000
## Page 43

Function blocks 4.2.8.3 FB_So ERead Dc Bus Current FB_So ERead Dc Bus Current Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id REAL Dc Bus Current DWORD Attribute With the FB_So EAX5000Read Dc Bus Current function block the DC-Bus current (S-0-0381) can be read. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Dc Bus Current : REAL; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Dc Bus Current REAL Returns the DC bus current (e.g. 2,040 equals 2,040 A). Attributes DWORD Returns the attributes of the Sercos parameter. TE1000 Version: 1.13.1 43
## Page 44

Function blocks Sample fb Read Dc Bus Current : FB_So ERead Dc Bus Current; Read Dc Bus Current : BOOL; Dc Bus Current : REAL; (* Nc Axis *) Axis : AXIS_REF; IF Read Dc Bus Current THEN fb Read Dc Bus Current( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Dc Bus Current => Dc Bus Current ); IF NOT fb Read Dc Bus Current. Busy THEN fb Read Dc Bus Current(Axis := Axis, Execute := FALSE); Read Dc Bus Current := FALSE; END_IF END_IF 4.2.8.4 FB_So ERead Dc Bus Voltage FB_So ERead Dc Bus Voltage Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id REAL Dc Bus Voltage DWORD Attribute With the FB_So ERead Dc Bus Voltage function block the Dc-Bus voltage of the drive (S-0-0380) can be read. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; 44 Version: 1.13.1 TE1000
## Page 45

Function blocks Sercos Err Id : UINT; Dc Bus Voltage : REAL; Attribute : DWORD; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Dc Bus Voltage REAL Returns the DC-Bus voltage (e.g. 294.0 corresponds to 294.0 V). Attributes DWORD Returns the attributes of the Sercos parameter. Sample fb Read Dc Bus Voltage : FB_So ERead Dc Bus Voltage; Read Dc Bus Voltage : BOOL; Dc Bus Voltage : REAL; (* Nc Axis *) Axis : AXIS_REF; IF Read Dc Bus Voltage THEN fb Read Dc Bus Voltage( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Dc Bus Voltage => Dc Bus Voltage ); IF NOT fb Read Dc Bus Voltage. Busy THEN fb Read Dc Bus Voltage(Axis := Axis, Execute := FALSE); Read Dc Bus Voltage := FALSE; END_IF END_IF 4.3 General Co E 4.3.1 FB_Co ERead FB_Co ERead Net Id T_Ams Net ID BOOL Busy Index WORD BOOL Error Sub Index BYTE UINT Ads Err Id p Dst Buf PVOID UINT CANopen Err Id Buf Len UDINT Execute BOOL Timeout TIME Complete Access BOOL ↔ Axis Reference To AXIS_REF The function block FB_Co ERead allows data to be read from an object directory of an Ether CAT slave through an SDO (Service Data Object) access. This requires the slave to have a mailbox and to support the Co E (CANopen over Ether CAT) protocol. With the help of the Sub Index and Index parameters a selection is made as to which object should be read out. Via Complete Access := TRUE the parameter can be read with sub-elements. TE1000 Version: 1.13.1 45
## Page 46

Function blocks Inputs VAR_INPUT Net Id : T_Ams Net ID;(*net ID of PC with NC*) Index : WORD;(*Co E object index*) Sub Index : BYTE;(*Co E sub index*) p Dst Buf : PVOID;(*Contains the address of the buffer for the received data*) Buf Len : UDINT;(*Contains the max. number of bytes to be received*) Execute : BOOL;(*Function block execution is triggered by a rising edge at this input.*) Timeout : TIME := DEFAULT_ADS_TIMEOUT;(*States the time before the function is cancelled.*) Complete Access : BOOL;(*Function block reads the complete object with all sub index*) END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Index WORD Index of the object that is to be read. Sub Index BYTE Subindex of the object that is to be read. p Dst Buf PVOID Address (pointer) to the receive buffer Buf Len UDINT Maximum available buffer size (in bytes) for the data to be read Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Complete Access BOOL Via Complete Access the complete object can be accessed at once. Index and Sub Index can be taken from the corresponding drive documentation. For the AX8000 from Beckhoff see AX8000 object description. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; CANopen Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the event of a set error output returns the ADS error code. CANopen Err Id UINT In the event of a set error output returns the CANopen error code. 46 Version: 1.13.1 TE1000
## Page 47

Function blocks Example for implementation in ST: PROGRAM MAIN VAR fb Co ERead : FB_Co ERead; Net Id : T_Ams Net ID := ''; Index : WORD := 16#1018; Sub Index : BYTE := 1; Execute : BOOL := TRUE; Timeout : TIME := T#5S; Complete Access : BOOL := TRUE; Axis : AXIS_REF; vendor Id : UDINT := 2; Error : BOOL; Ads Err Id : UDINT; CANopen Err Id : UDINT; END_VAR fb Co ERead( Net Id := Net Id, Index := Index, Sub Index := Sub Index, p Dst Buf := ADR(vendor Id), Buf Len := SIZEOF(vendor Id), Execute := Execute, Timeout := Timeout, Complete Access := Complete Access, Axis := Axis ); IF NOT fb Co ERead. Busy THEN Error :=fb Co ERead. Error; Ads Err Id :=fb Co ERead. Ads Err Id; CANopen Err Id :=fb Co ERead. CANopen Err Id; Execute := FALSE; fb Co ERead(Execute := Execute, Axis := Axis); END_IF 4.3.2 FB_Co EWrite FB_Co EWrite Net Id T_Ams Net ID BOOL Busy Index WORD BOOL Error Sub Index BYTE UINT Ads Err Id p Src Buf PVOID UINT CANopen Err Id Buf Len UDINT Execute BOOL Timeout TIME Complete Access BOOL ↔ Axis Reference To AXIS_REF With the function block FB_Co EWrite, an object from the object directory of an Ether CAT slave can be written via an SDO (Service Data Object) download. This requires the slave to have a mailbox and to support the Co E (CANopen over Ether CAT) protocol. With the help of the Sub Index and Index parameters a selection is made as to which object should be written. Via Complete Access := TRUE the parameter can be written with sub-elements. Inputs VAR_INPUT Net Id : T_Ams Net ID;(*net ID of PC with NC*) Index : WORD;(*Co E object index*) Sub Index : BYTE;(*Co E sub index*) p Src Buf : PVOID;(*Contains the address of the buffer containing the data to be send*) Buf Len : UDINT;(*Contains the max. number of bytes to be received*) Execute : BOOL;(*Function block execution is triggered by a rising edge at this input.*) Timeout : TIME := DEFAULT_ADS_TIMEOUT; (*States the time before the function is cancelled.*) Complete Access : BOOL;(*Function block reads the complete object with all sub index*) END_VAR TE1000 Version: 1.13.1 47
## Page 48

Function blocks Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Index WORD Index of the object that is supposed to be written. Sub Index BYTE Subindex of the object that is supposed to be written. p Dst Buf PVOID Address (pointer) to the transmit buffer Buf Len UDINT Amount of data to be sent in bytes Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Complete Access BOOL The complete object can be accessed all at once via Complete Access. Index and Sub Index can be taken from the corresponding drive documentation. For the AX8000 from Beckhoff see AX8000 object description. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; CANopen Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the event of a set error output returns the ADS error code. CANopen Err Id UINT In the event of a set error output returns the CANopen error code. Example for implementation in ST: PROGRAM MAIN VAR fb Co EWrite : FB_Co EWrite; Net Id : T_Ams Net ID := ''; Index : WORD := 16#1018; Sub Index : BYTE := 1; Execute : BOOL := TRUE; Timeout : TIME := T#5S; Complete Access : BOOL := TRUE; Axis : AXIS_REF; vendor Id : UDINT := 2; Error : BOOL; Ads Err Id : UDINT; 48 Version: 1.13.1 TE1000
## Page 49

Function blocks CANopen Err Id : UDINT;END_VAR fb Co EWrite( Net Id := Net Id, Index := Index, Sub Index := Sub Index, p Src Buf := ADR(vendor Id), Buf Len := SIZEOF(vendor Id), Execute := Execute, Timeout := Timeout, Complete Access := Complete Access, Axis := Axis ); IF NOT fb Co EWrite. Busy THEN Error := fb Co EWrite. Error; Ads Err Id := fb Co EWrite. Ads Err Id; CANopen Err Id :=fb Co EWrite. CANopen Err Id; Execute := FALSE; fb Co EWrite(Execute := Execute, Axis := Axis); END_IF 4.3.3 FB_Co EExecute Command FB_Co EExecute Command Net Id T_Ams Net ID BOOL Busy Index WORD BOOL Error p Src Buf PVOID UDINT Error Id Src Buf Len UDINT _E_Coe Command Status Status p Dst Buf PVOID Dst Buf Len UDINT Execute BOOL Timeout TIME ↔ Axis Reference To AXIS_REF With the function block FB_Co EExecute Command a command can be executed. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Index : WORD; p Src Buf : PVOID; Src Buf Len : UDINT; p Dst Buf : PVOID; Dst Buf Len : UDINT; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Index WORD Co E object index that FB_Co EExecute Command refers to. p Src Buf PVOID Address of the structure of the data to be sent Src Buf Len UDINT Size in bytes of the structure of the data to be sent p Dst Buf PVOID Address of the structure of the data to be received Dst Buf Len UDINT Size in bytes of the structure of the data to be received Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. TE1000 Version: 1.13.1 49
## Page 50

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error Id : UDINT; Status : _E_Co ECommand Status; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error Id UDINT In the event of a set error output returns the ADS error code. Status _E_Co ECommand Status Status of the command execution 4.4 AX5000 So E 4.4.1 FB_So EAX5000Read Act Main Voltage FB_So EAX5000Read Act Main Voltage Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id ↔ Axis Reference To AXIS_REF UINT Sercos Err Id DWORD Attribute LREAL Actual Main Voltage With the FB_So EAX5000Read Act Main Voltage function block the current peak value of the mains voltage of the AX5000 (P-0-0200) can be read. Inputs VAR_INPUT Net Id : T_Ams Net ID := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID String which contains the AMS Network ID of the PC (type: T_Ams Net Id). Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. 50 Version: 1.13.1 TE1000
## Page 51

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; Attribute : DWORD; Actual Main Voltage : LREAL; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Attributes DWORD Returns the attributes of the Sercos parameter. Actual Main Voltag LREAL Returns the peak value of the current mains voltage of the e AX5000 (e.g. 303.0 corresponds to 303.0 V). Sample fb Read Act Main Voltage : FB_So EAX5000Read Act Main Voltage; Read Act Main Voltage : BOOL; Actual Main Voltage : REAL; (* Nc Axis *) Axis : AXIS_REF; IF Read Act Main Voltage THEN fb Read Act Main Voltage( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Actual Main Voltage => Actual Main Voltage ); IF NOT fb Read Act Main Voltage. Busy THEN fb Read Act Main Voltage(Axis := Axis, Execute := FALSE); Read Act Main Voltage := FALSE; END_IF END_IF Requirements Development environ- Target platform type PLC library AX5000 Firmware ment Twin CAT 3 PC or CX (x86 or x64) Tc2_MC2_Drive ≥v1.07 b0001 TE1000 Version: 1.13.1 51
## Page 52

Function blocks 4.4.2 FB_So EAX5000Set Motor Ctrl Word FB_So EAX5000Set Motor Ctrl Word Net Id T_Ams Net ID BOOL Busy Execute BOOL BOOL Error Timeout TIME UINT Ads Err Id Force Lock BOOL UINT Sercos Err Id Force Unlock BOOL ↔ Axis Reference To AXIS_REF With the function block FB_So EAX5000Set Motor Ctrl Word the Force Lock bit (Bit 0) or the Force Unlock bit can be set in the Motor Control Word (P-0-0096) to activate or release the brake. Normally the brake is automatically controlled via the Enable of the drive. With the Force Lock bit, the brake can be activated independently from the Enable, with the Force Unlock bit, the brake can be released independently from the Enable. In the case of simultaneously set Force Lock and Force Unlock, Force Lock (Brake activated) has the higher priority. Inputs VAR_INPUT Net Id : T_Ams Net Id := ''; Execute : BOOL; Timeout : TIME := DEFAULT_ADS_TIMEOUT; Force Lock : BOOL; Force Unlock : BOOL; END_VAR Name Type Description Net Id T_Ams Net ID String containing the AMS network ID of the PC. Execute BOOL The function block is enabled via a positive edge at this input. Timeout TIME Maximum time allowed for the execution of the function block. Force Lock BOOL Activates the brake independently of the enable. Force Unlock BOOL Releases the brake independently of the enable. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Ads Err Id : UINT; Sercos Err Id : UINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. 52 Version: 1.13.1 TE1000
## Page 53

Function blocks Name Type Description Ads Err Id UINT In the case of a set Error output returns the ADS error code of the last executed command. Sercos Err Id UINT In the case of a set Error output returns the Sercos error of the last executed command. Sample fb Set Motor Ctrl Word : FB_So EAX5000Set Motor Ctrl Word; Set Motor Ctrl Word : BOOL; Force Lock : BOOL; Force Unlock : BOOL; (* Nc Axis *) Axis : AXIS_REF; IF Set Motor Ctrl Word THEN fb Set Motor Ctrl Word( Axis := Axis, Execute := TRUE, Timeout := DEFAULT_ADS_TIMEOUT, Force Lock := Force Lock, Force Unlock := Force Unlock ); IF NOT fb Set Motor Ctrl Word. Busy THEN fb Set Motor Ctrl Word(Axis := Axis, Execute := FALSE); Set Motor Ctrl Word := FALSE; END_IF END_IF Requirements Development environ- Target platform type PLC library AX5000 Firmware ment Twin CAT 3 PC or CX (x86 or x64) Tc2_MC2_Drive ≥v1.07 b0001 4.4.3 FB_So EAX5000Firmware Update FB_So EAX5000Firmware Update s Net Id T_Ams Net ID BOOL b Busy b Execute BOOL BOOL b Error s Firmware Version STRING(20) UINT i Ads Err Id s Firmware Path T_Max String UINT i Sercos Err Id i Req Ec State UINT UDINT i Diag Number t Timeout TIME E_Fw Update State e Fw Update State ↔ Axis Reference To AXIS_REF INT i Load Progress STRING(255) s Selected Firmware File With the FB_So EAX5000Firmware Update function block the Firmware of the AX5000 can be checked and automatically changed to a given version (Revision and Build) or to the current Build of the configured revision. For the update: • The configured slave type is determined, e.g. AX5103-0000-0010. • The current slave is determined with the predefined slave address, e.g. AX5103-0000-0009. • The current slave firmware is determined, e.g. v1.05_b0009. • A comparison of the configuration and the found slave regarding number of channels, current, revision and firmware is made. • The name of the required firmware file is determined and a search for the file performed. • The firmware update is executed (if necessary). • The current slave with the predefined slave address is determined again. • The slave is switched to the predefined Ether CAT state. TE1000 Version: 1.13.1 53
## Page 54

Function blocks A successful update ends with e Fw Update State = e Fw U_Fw Update Done. If the update is not required, this is signaled via e Fw Update State = e Fw U_No Fw Update Required. The firmware update takes place via the specified channel (A=0 or B=1) from st Drive Ref. In the case of two- channel devices only one of the two channels can be used. The other channel signals e Fw Update State = e Fw U_Update Via Other Channel Active or e Fw Update State = e Fw U_Update Via Other Channel. During the firmware update (e Fw Update State = e Fw U_Fw Update In Progress), i Load Progress signals the progress in percent. NOTICE Faulty update due to interruptions Interruptions during the update may result in it not being executed or executed incorrectly. Afterwards, the terminal may no longer be usable without the appropriate firmware. The rules during the update are: • The PLC and Twin CAT must not be stopped. • The Ether CAT connection must not be interrupted. • The AX5000 must not be switched off. Inputs VAR_INPUT s Net Id : T_Ams Net ID; b Execute : BOOL; s Firmware Version : STRING(20); (* version string vx.yy_bnnnn, e.g. "v1.05_b0009" for v1.05 Build 0009*) s Firmware Path : T_Max String; (* drive:\path, e.g. "C: \Twin CAT\Io\Tc Drive Manager\Firmware Pool" *) i Req Ec State : UINT := EC_DEVICE_STATE_OP; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; END_VAR Name Type Description Net Id T_Ams Net ID AMS-Net ID of the controller (IPC) b Execute BOOL The function block is activated by a positive edge at this input. s Firmware Versio STRING(20) Specifies the desired firmware version in the form of n vx.yy_bnnnn, e.g. "v1.05_b0009" for Version v1.05 Build 0009. Release builds: • "v1.05_b0009" for a specific build, e.g. v1.05 Build 0009 • "v1.05_b00??" latest build of a specified version, e.g. v1.05 • "v1.??_b00??" latest build of a specified main version, e.g. v1 • "v?.??_b00??" latest build of the latest version • " " latest build of the latest version Custom firmware builds: • "v1.05_b1009" for a specific build, e.g. v1.05 Build 0009 • "v1.05_b10??" latest build of a specified version, e.g. v1.05 • "v1.??_b10??" latest build of a specified main version, e.g. v1 • "v?.??_b10??" latest build of the latest version 54 Version: 1.13.1 TE1000
## Page 55

Function blocks Name Type Description ... • "v1.05_b8909" for a specific build, e.g. v1.05 Build 8909 • "v1.05_b89??" latest build of a specified version, e.g. v1.05 • "v1.??_b89??" latest build of a specified main version, e.g. v1 • "v?.??_b89??" latest build of the latest version Debug builds: • "v1.05_b9009" for a specific build, e.g. v1.05 Build 9009 • "v1.05_b90??" latest build of a specified version, e.g. v1.05 • "v1.??_b90??" latest build of a specified main version, e.g. v1 • "v?.??_b90??" latest build of the latest version s Firmware Path T_Max String Specifies the path for the firmware pool in which the firmware files are located, e.g. C: \Twin CAT\Io\Tc Drive Manager\Firmware Pool. i Req Ec State UINT Desired Ether CAT state after the update (only if an update is actually being executed). The statuses are defined as global constants in PLC Lib Tc2_Ether CAT. t Timeout TIME Since the firmware update for large Ether CAT networks can take longer, only the timeout for individual internal ADS instances is specified here. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; i Ads Err Id : UINT; i Sercos Err Id : UINT; i Diag Number : UDINT; e Fw Update State : E_Fw Update State; i Load Progress : INT; s Selected Firmware File : STRING(MAX_STRING_LENGTH); (* found firmware file, e.g. "AX5yxx_xxxx_-00 10_v1_05_b0009.efw" *) END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. b Error BOOL This output is set after the b Busy output has been reset when an error occurs in the transmission of the command. TE1000 Version: 1.13.1 55
## Page 56

Function blocks Name Type Description i Ads Err Id UINT Returns the ADS error code of the last executed command when the b Error output is set. i Sercos Err Id UINT In the case of a set b Error output returns the Sercos error of the last executed command. i Diag Number UDINT In the case of a set b Error output returns the drive error of the last executed firmware update. e Fw Update State E_Fw Update State Returns the status of the firmware update. i Load Progress INT Returns the progress of the actual firmware update as a percentage. s Selected Firmwa STRING(MAX_STRING_LEN Displays the name of the firmware file being searched for. re File GTH) Sample VAR CONSTANT i Num Of Drives : INT := 2; END_VAR VAR fb Firmware Update : ARRAY [1..i Num Of Drives] OF FB_So EAX5000Firmware Update; Axes : ARRAY [1..i Num Of Drives] OF AXIS_REF; s Firmware Version : ARRAY [1..i Num Of Drives] OF STRING(20)(* := 2('v1.04_b0002')*); e Fw Update State : ARRAY [1..i Num Of Drives] OF E_Fw Update State; s Selected Firmware File : ARRAY [1..i Num Of Drives] OF STRING(MAX_STRING_LENGTH); i Update State : INT; b Execute : BOOL; s Net Id IPC : T_Ams Net Id := ''; s Firmware Path : T_Max String := 'C:\Twin CAT\Io\Tc Drive Manager\Firmware Pool'; I : INT; b Any Busy : BOOL; b Any Error : BOOL; END_VAR CASE i Update State OF 0: IF b Execute THEN i Update State := 1; END_IF 1: FOR I := 1 TO i Num Of Drives DO fb Firmware Update[I]( Axis := Axes[I], b Execute := TRUE, t Timeout := T#15s, s Firmware Version := s Firmware Version[I], s Firmware Path := s Firmware Path, s Net Id := s Net Id IPC, i Req Ec State := EC_DEVICE_STATE_OP, e Fw Update State => e Fw Update State[I], ); END_FOR i Update State := 2; 2: b Any Busy := FALSE; b Any Error := FALSE; FOR I := 1 TO i Num Of Drives DO fb Firmware Update[I]( Axis := Axes[I], e Fw Update State => e Fw Update State[I], s Selected Firmware File => s Selected Firmware File[I], ); IF NOT fb Firmware Update[I].b Busy THEN fb Firmware Update[I](b Execute := FALSE, Axis := Axes[I]); IF fb Firmware Update[I].b Error THEN b Any Error := TRUE; END_IF ELSE b Any Busy := TRUE; END_IF END_FOR IF NOT b Any Busy THEN b Execute := FALSE; IF NOT b Any Error THEN 56 Version: 1.13.1 TE1000
## Page 57

Function blocks i Update State := 0; (* OK *) ELSE i Update State := 0; (* Error *) END_IF END_IF END_CASE Requirements Development environ- Target platform type PLC libraries AX5000 Firmware ment Twin CAT 3 PC or CX (x86 or x64) Tc2_MC2_Drive ≥v1.00 b0001 4.4.4 FB_So EAX5000Set Position Offset FB_So EAX5000Set Position Offset Execute BOOL BOOL Busy Position LREAL BOOL Error Relative BOOL UDINT Error ID Feedback E_Position Offset Feedback Memory E_Position Offset Memory ↔ Axis Reference To AXIS_REF With the function block FB_So EAX5000Set Position Offset a position offset can be saved in the memory of the AX5000 or of the digital nameplate of the connected motor encoder. To do this, the offset must first be configured with the Drive Manager and then the same memory location (encoder / drive) must be used in the function block. Alternatively, the function block FB_Set Position Offset [} 17] can also be used. Inputs VAR_INPUT Execute : BOOL; Position : LREAL; Relative : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Position LREAL New actual position of the NC axis Relative BOOL When this flag is set, the position is interpreted relatively. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies which memory the newly calculated position offset should be stored in. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. TE1000 Version: 1.13.1 57
## Page 58

Function blocks Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library AX5000 Firmware ment Twin CAT ≥4020.57 PC or CX (x86 or x64) Tc2_MC2_Drive ≥v2.11 b0001 ≥V3.3.16.0 Twin CAT ≥4022.30 4.4.5 FB_So EAX5000Delete Position Offset FB_So EAX5000Delete Position Offset Execute BOOL BOOL Busy Feedback E_Position Offset Feedback BOOL Error Memory E_Position Offset Memory UDINT Error ID ↔ Axis Reference To AXIS_REF With the function block FB_So EAX5000Delete Position Offset, a position offset can be deleted from the memory of the AX5000 or from the digital nameplate of the connected motor encoder. Alternatively, the function block FB_Delete Position Offset [} 14] can also be used. Inputs VAR_INPUT Execute : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies the memory from which the position offset is to be deleted. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR 58 Version: 1.13.1 TE1000
## Page 59

Function blocks Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library AX5000 Firmware ment Twin CAT ≥4020.57 PC or CX (x86 or x64) Tc2_MC2_Drive ≥v2.11 b0001 ≥V3.3.16.0 Twin CAT ≥4022.30 4.4.6 FB_So EAX5000Park Axis FB_So EAX5000Park Axis ↔ Axis Reference To AXIS_REF BOOL Busy Execute BOOL BOOL Error Mode E_Park Mode UDINT Error Id This function block enables the parking functionality of an AX5000. A parked channel of an AX5000 is temporarily disabled. In the case of a modular machine concept, certain motors may not be available. So that this does not lead directly to errors (e.g. feedback errors), the channels can be disabled via this. Alternatively, the function block FB_Park Axis [} 19] can also be used. Inputs VAR_INPUT Execute : BOOL; Mode : E_Park Mode END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Mode E_Park Mode [} 73] Mode for selecting whether the FB parks or releases the axis. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR TE1000 Version: 1.13.1 59
## Page 60

Function blocks Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC libraries AX5000 Firmware ment Twin CAT ≥ 4022.32 PC or CX (x86 or x64) Tc2_MC2_Drive ≥v2.12 b0001 ≥V3.3.21.0 Twin CAT ≥ 4024.6 4.5 AX8000 Co E 4.5.1 FB_Co EAX8000Brake Control FB_Co EAX8000Brake Control Execute BOOL BOOL Busy Mode E_Brake Mode BOOL Error ↔ Axis Reference To AXIS_REF UDINT Error ID This function block can be used to manually open or close the brake of a motor that is operated on an AX8000. It should be noted that the brake is permanently closed or opened via "Lock" or "Unlock". It is recommended to open or close the brake manually only for the necessary duration. The brake should then be set back to "Automatic" mode using the function block. Alternatively, the function block FB_Brake Control [} 15] can also be used. Inputs VAR_INPUT Execute : BOOL; Mode : E_Brake Mode; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Mode E_Brake Mode [} 72] The mode with which the brake is controlled. 60 Version: 1.13.1 TE1000
## Page 61

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library Firmware version ment Twin CAT ≥ 4022.36 PC or CX (x86 or x64) Tc2_MC2_Drive v1.04 b0001 Twin CAT ≥ 4024.15 ≥V3.3.23.0 4.5.2 FB_Co EAX8000Brake Test FB_Co EAX8000Brake Test Execute BOOL BOOL Busy Succeeded BOOL BOOL Error Torque LREAL UDINT Error ID Velocity Limit LREAL Timeout TIME ↔ Axis Reference To AXIS_REF The function block FB_Co EAX8000Brake Test can be used to implement a functional brake test. This function block is used to switch the AX8000 to torque mode (Cyclic Synchronous Torque Mode (CST)). The torque parameterized at the input is transmitted to the drive as a setpoint. The torque is held until the "Timeout" has elapsed or a feedback ("Succeeded") is sent to the function block. This feedback is typically sent from the safety controller to the PLC. The AX8000 is then set to the original operation mode. If the brake was not closed before the FB_Co EAX8000Brake Test was called, or if the brake does not hold the required test torque, then the speed limitation integrated in the AX8000 prevents uncontrolled acceleration of the axis. The velocity limit is parameterized via the "Velocity Limit" variable. TE1000 Version: 1.13.1 61
## Page 62

Function blocks DANGER Danger to life or risk of serious injury or damage to property due to unintentional movements of the axis When using the function block, the axis is switched to CST mode. After using the function block (especially after error situations), the axis may still be in CST mode. This can lead to sudden and unplanned movements (especially with lifting axes) when the axis is released. • Ensure that there is no hazard as defined by the risk assessment. • Check the current operation mode via the function block MC_Read Drive Operation Mode. • If the axis is not in a position-related operation mode (CSV/CSP), transfer it before an enable: – directly with MC_Write Drive Operation Mode into the desired position-related operation mode (CSV/ CSP) or – indirectly with MC_Halt / MC_Stop into the desired position-related operation mode (CSV/CSP) (from Twin CAT 3.1.4024.40) Other function blocks that switch the axis indirectly into a position-related operation mode can only do this to a limited extent and are therefore not to be used for a deliberate operation mode change. ð Subsequently, it is necessary to check again whether the axis is really in a position-related operation mode (CSV/CSP), if not, an abort with error handling is required. Information on the necessary changes in the configuration of the AX8000 can be found in the AX8000 | Multi-axis servo system Functional description. Inputs VAR_INPUT Execute : BOOL; Succeeded : BOOL; Torque : LREAL; Velocity Limit : LREAL; Timeout : TIME; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Succeeded BOOL Feedback that the brake has held the specified torque. This feedback usually comes from the safety controller. Torque LREAL Torque that should be effective [Nm]. Velocity Limit LREAL Velocity limit to prevent uncontrolled acceleration in torque mode. Timeout TIME Maximum time for which the specified torque is effective. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR 62 Version: 1.13.1 TE1000
## Page 63

Function blocks Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library Firmware version ment Twin CAT ≥ 4022.36 PC or CX (x86 or x64) Tc2_MC2_Drive v1.04 b0001 Twin CAT ≥ 4024.15 ≥V3.3.23.0 4.5.3 FB_Co EAX8000Set Position Offset FB_Co EAX8000Set Position Offset Execute BOOL BOOL Busy Position LREAL BOOL Error Relative BOOL UDINT Error ID Feedback E_Position Offset Feedback Memory E_Position Offset Memory ↔ Axis Reference To AXIS_REF With the FB_Co EAX8000Set Position Offset function block, a position offset can be saved in the memory of the AX8000 or of the digital nameplate of the connected motor encoder. To do this, the offset must first be configured with the Drive Manager and then the same memory location (encoder / drive) must be used in the function block. Alternatively, the function block FB_Set Position Offset [} 17] can also be used. Inputs VAR_INPUT Execute : BOOL; Position : LREAL; Relative : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Position LREAL New actual position of the NC axis Relative BOOL When this flag is set, the position is interpreted relatively. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies which memory the newly calculated position offset should be stored in. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR TE1000 Version: 1.13.1 63
## Page 64

Function blocks Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC libraries Firmware version ment Twin CAT ≥4020.57 PC or CX (x86 or x64) Tc2_MC2_Drive v1.04 b0001 Twin CAT ≥4022.30 ≥V3.3.16.0 4.5.4 FB_Co EAX8000Delete Position Offset FB_Co EAX8000Delete Position Offset Execute BOOL BOOL Busy Feedback E_Position Offset Feedback BOOL Error Memory E_Position Offset Memory UDINT Error ID ↔ Axis Reference To AXIS_REF With the function block FB_Co EAX8000Delete Position Offset, a position offset can be deleted from the memory of the AX8000 or from the digital nameplate of the connected motor encoder. Alternatively, the function block FB_Delete Position Offset [} 14] can also be used. Inputs VAR_INPUT Execute : BOOL; Position : LREAL; Relative : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Position LREAL New position of the NC axis is displayed. Relative BOOL When this flag is set, the position is interpreted relatively. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies the memory from which the position offset is to be deleted. [} 71] 64 Version: 1.13.1 TE1000
## Page 65

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC libraries Firmware version ment Twin CAT ≥4020.57 PC or CX (x86 or x64) Tc2_MC2_Drive v1.04 b0001 Twin CAT ≥4022.30 ≥V3.3.16.0 4.5.5 FB_Co EAX8000Park Axis FB_Co EAX8000Park Axis ↔ Axis Reference To AXIS_REF BOOL Busy Execute BOOL BOOL Error Mode E_Park Mode UDINT Error Id This function block enables the parking functionality of an AX8000. A parked channel of an AX8000 is temporarily disabled. In the case of a modular machine concept, certain motors may not be available. So that this does not lead directly to errors (e.g. feedback errors), the channels can be disabled via this. Alternatively, the function block FB_Park Axis [} 19] can also be used. Inputs VAR_INPUT Execute : BOOL; Mode : E_Park Mode; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Mode E_Park Mode [} 73] [} 74] Mode for selecting whether the FB parks or releases the axis. TE1000 Version: 1.13.1 65
## Page 66

Function blocks Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC libraries to include Firmware version ment Twin CAT ≥4024.60 PC or CX (x86 or x64) Tc2_MC2_Drive v1.06 b0003 Twin CAT ≥4026.8 ≥V3.3.41.0 4.6 EL72xx Co E 4.6.1 FB_Co EEL72xx Brake Control FB_Co EEL72xx Brake Control Execute BOOL BOOL Busy Mode E_Brake Mode BOOL Error ↔ Axis Reference To AXIS_REF UDINT Error ID This function block can be used to manually open or close the brake of a motor that is operated on an EL72xx. It should be noted that the brake is permanently closed or opened via "Lock" or "Unlock". It is recommended to open or close the brake manually only for the necessary duration. The brake should then be set back to "Automatic" mode using the function block. Alternatively, the function block FB_Brake Control [} 15] can also be used. Inputs VAR_INPUT Execute : BOOL; Mode : E_Brake Mode; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. 66 Version: 1.13.1 TE1000
## Page 67

Function blocks Name Type Description Mode E_Brake Mode [} 72] The mode with which the brake is controlled. Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library Firmware version ment Twin CAT ≥4024.48 PC or CX (x86 or x64) Tc2_MC2_Drive From FW v01 ≥V3.3.34.0 (EL72xx only with OCT and from FW v16) 4.6.2 FB_Co EEL72xx Set Position Offset FB_Co EEL72xx Set Position Offset Execute BOOL BOOL Busy Position LREAL BOOL Error Relative BOOL UDINT Error ID Feedback E_Position Offset Feedback Memory E_Position Offset Memory ↔ Axis Reference To AXIS_REF With the function block FB_Co EEL72xx Set Position Offset, a position offset can be saved in the memory of the EL72xx. Saving in the digital nameplate of the connected motor encoder is currently not planned. Alternatively, the function block FB_Set Position Offset [} 17] can also be used. Inputs VAR_INPUT Execute : BOOL; Position : LREAL; Relative : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR TE1000 Version: 1.13.1 67
## Page 68

Function blocks Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Position LREAL New actual position of the NC axis Relative BOOL When this flag is set, the position is interpreted relatively. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies which memory the newly calculated position offset should be stored in. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library Firmware version ment Twin CAT >4020.57 PC or CX (x86 or x64) Tc2_MC2_Drive From FW v01 Twin CAT >4022.30 ≥V3.3.17.0 (AMI8xxx only Drive) Twin CAT ≥4024.4 4.6.3 FB_Co EEL72xx Delete Position Offset FB_Co EEL72xx Delete Position Offset Execute BOOL BOOL Busy Feedback E_Position Offset Feedback BOOL Error Memory E_Position Offset Memory UDINT Error ID ↔ Axis Reference To AXIS_REF With the function block FB_Co EEL72xx Delete Position Offset, a position offset can be deleted from the memory of the EL72xx. Alternatively, the function block FB_Delete Position Offset [} 14] can also be used. 68 Version: 1.13.1 TE1000
## Page 69

Function blocks Inputs VAR_INPUT Execute : BOOL; Position : LREAL; Relative : BOOL; Feedback : E_Position Offset Feedback; Memory : E_Position Offset Memory; END_VAR Name Type Description Execute BOOL The function block is enabled via a positive edge at this input. Position LREAL New position of the NC axis is displayed. Relative BOOL When this flag is set, the position is interpreted relatively. Feedback E_Position Offset Feedback Specifies which feedback is considered. [} 72] Memory E_Position Offset Memory Specifies the memory from which the position offset is to be deleted. [} 71] Inputs/outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure that unambiguously addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Busy BOOL This output is set when the function block is activated, and remains set until a feedback is received. Error BOOL This output is set after the Busy output has been reset when an error occurs in the transmission of the command. Error ID UDINT In the event of a set error output returns the ADS error code. Requirements Development environ- Target platform type PLC library Firmware version ment Twin CAT >4020.57 PC or CX (x86 or x64) Tc2_MC2_Drive From FW v01 Twin CAT >4022.30 ≥V3.3.17.0 (AMI8xxx only Drive) Twin CAT ≥4024.4 TE1000 Version: 1.13.1 69
## Page 70

Data types 5 Data types 5.1 E_Fw Update State The enumeration E_Fw Update State describes the state of a firmware update. TYPE E_So E_Cmd State :( (* update states *) e Fw U_No Error := 0, e Fw U_Check Cfg Identity, e Fw U_Check Slave Count, e Fw U_Check Find Slave Pos, e Fw U_Wait For Scan, e Fw U_Scanning Slaves, e Fw U_Check Scanned Identity, e Fw U_Check Scanned Firmware, e Fw U_Find Firmware File, e Fw U_Wait For Update, e Fw U_Wait For Slave State, e Fw U_Start Fw Update, e Fw U_Fw Update In Progress, e Fw U_Fw Update Done, e Fw U_No Fw Update Required, (* not updating via this channel *) e Fw U_Update Via Other Channel Active, e Fw U_Updated Via Other Channel, (* error states *) e Fw U_Get Slave Identity Error := -1, e Fw U_Get Slave Count Error := -2, e Fw U_Get Slave Addr Error := -3, e Fw U_Start Scan Error := -4, e Fw U_Scan State Error := -5, e Fw U_Scan Identity Error := -6, e Fw U_Get Slave State Error := -7, e Fw U_Scan Firmware Error := -8, e Fw U_Find File Error := -9, e Fw U_Cfg Type In No AX5xxx := -10, e Fw U_Scanned Type In No AX5xxx := -11, e Fw U_Channel Mismatch := -12, e Fw U_Channel Mismatch_1Cfg_2Scanned := -13, e Fw U_Channel Mismatch_2Cfg_1Scanned := -14, e Fw U_Current Mismatch := -15, e Fw U_Fw Update Error := -16, e Fw U_Req Slave State Error := -17 ); END_TYPE Update Status Name Description e Fw U_No Error Initial state e Fw U_Check Cfg Identity Read the configured slave types (number of channels, current, revision). e Fw U_Check Slave Count Determine the configured number of slaves. e Fw U_Check Find Slave Pos Search for the slave address in the master object directory. e Fw U_Wait For Scan Wait for online scan. e Fw U_Scanning Slaves Online scan of the slaves. e Fw U_Check Scanned Identity Read the scanned slave types (number of channels, current, revision). e Fw U_Check Scanned Firmware Read the firmware version. e Fw U_Find Firmware File Search for the selected firmware file. e Fw U_Wait For Update Wait for status of the update. e Fw U_Wait For Slave State Determine the Ether CAT slave status. e Fw U_Start Fw Update Start the firmware update. e Fw U_Fw Update In Progress Firmware update active. 70 Version: 1.13.1 TE1000
## Page 71

Data types Name Description e Fw U_Fw Update Done Firmware update successfully completed. e Fw U_No Fw Update Required No firmware update required. e Fw U_Update Via Other Channel Active Update takes place via the other axis channel. e Fw U_Updated Via Other Channel Update took place via the other axis channel. Update error Name Description e Fw U_Get Slave Identity Error Reading of the configured slave type failed (see i Ads Err Id). e Fw U_Get Slave Count Error Determination of the configured number of slaves failed (see i Ads Err Id). e Fw U_Get Slave Addr Error Search for the slave address in the master object directory failed (see i Ads Err Id). e Fw U_Start Scan Error Start of the online scan failed (see i Ads Err Id). e Fw U_Scan State Error Online scan failed (see i Ads Err Id). e Fw U_Scan Identity Error Reading of the scanned slave types (number of channels, current, revision) failed (see i Ads Err Id). e Fw U_Get Slave State Error Determination of the Ether CAT slave status failed (see i Ads Err Id). e Fw U_Scan Firmware Error Reading of the firmware version failed (see i Ads Err Id + i Sercos Err Id). e Fw U_Find File Error Search for the selected firmware file failed (see i Ads Err Id). e Fw U_Cfg Type In No AX5xxx The configured slave is not an AX5000. e Fw U_Scanned Type In No AX5xxx The scanned slave is not an AX5000. e Fw U_Channel Mismatch The number of configured and found channels of the AX5000 do not match. e Fw U_Channel Mismatch_1Cfg_2Scan Single-channel device configured, but two-channel device found. ned e Fw U_Channel Mismatch_2Cfg_1Scan Two-channel device configured, but single-channel device found. ned e Fw U_Current Mismatch AX5000 type does not match in terms of current, e.g. AX5103 (3 A) configured, but AX5106 (6 A) found. e Fw U_Fw Update Error General update error (see i Ads Err Id) e Fw U_Req Slave State Error Switching to the desired Ether CAT status failed. 5.2 E_Drive Error Codes TYPE E_Drive Error Codes :( MC_Error_Max Nc Position Overrun := 16#4BB0, MC_Error_Max Position Offset Overrun := 16#4BB1, MC_Error_Min Nc Position Underrun := 16#4BB2, MC_Error_Min Position Offset Underrun := 16#4BB3, MC_Error_Wrong Target For Feedback Or Memory := 16#4BB4, MC_Error_Position Reinitialization Failed := 16#4BB5, MC_Error_Command Rejected No Response := 16#4BB6, MC_Error_Command Rejected With Response := 16#4BB7 ) UDINT; END_TYPE 5.3 E_Position Offset Memory TYPE E_Position Offset Memory :( e Position Offset Memory_Encoder := 0, e Position Offset Memory_Drive := 1 ) BYTE; END_TYPE TE1000 Version: 1.13.1 71
## Page 72

Data types Name Description e Position Offset Memory_Encoder As memory for the new position offset the motor name plate of the encoder is selected. e Position Offset Memory_Drive As memory for the new positions offset the internal memory of the drive is selected. 5.4 E_Position Offset Feedback TYPE E_Position Offset Feedback :( e Position Offset Feedback1 := 0, e Position Offset Feedback2 := 1 ) BYTE; END_TYPE Name Description e Position Offset Feedback1 Reference for the recalculation of the position offset is Feedback System 1. e Position Offset Feedback2 Reference for the recalculation of the position offset is Feedback System 2. 5.5 E_Brake Mode Sets the mode for manual brake control. TYPE E_Brake Mode : ( e Brake Mode_Automatic, e Brake Mode_Lock, e Brake Mode_Unlock ) INT; END_TYPE Name Description e Brake Mode_Automatic The brake of the connected motor is automatically opened or closed. e Brake Mode_Lock The brake of the connected motor remains permanently closed. Enabling the axis via the MC_Power does not release the brake. e Brake Mode_Unlock The brake of the connected motor is opened permanently. Disabling the axis via the MC_Power does not close the brake. See warning. WARNING Risk of fatal or serious injury Note that vertical axes can fall down and prevent this from happening! 5.6 E_Device Type Enumeration for defining the Beckhoff drive device. TYPE E_Device Type : ( DEVICETYPE_UNKNOWN := 0, DEVICETYPE_SOE_DEFAULT := 1, DEVICETYPE_AX2000 := 21, DEVICETYPE_EL72x1 := 22, DEVICETYPE_EL72x1_OCT := 23, DEVICETYPE_EL72x1_OCT_SAFETY := 24, DEVICETYPE_AX8000 := 31, DEVICETYPE_AMI8xxx := 41, DEVICETYPE_AMP8xxx := 51, DEVICETYPE_EL74x1 := 61, DEVICETYPE_EL74x1_SAFETY := 62, DEVICETYPE_ELM72xx_OCT := 71, 72 Version: 1.13.1 TE1000
## Page 73

Data types DEVICETYPE_ELM72xx_OCT_SAFETY := 72 )UDINT; END_TYPE Name Description DEVICETYPE_UNKNOWN Unknown drive unit DEVICETYPE_SOE_DEFAULT Standard So E-drive DEVICETYPE_AX2000 AX2000 DEVICETYPE_EL72x1 EL72x1 DEVICETYPE_EL72x1_OCT EL72x1 with OCT DEVICETYPE_EL72x1_OCT_SAFETY EL72x1 with OCT and Safety DEVICETYPE_AX8000 AX8000 DEVICETYPE_AMI8xxx AMI8xxx DEVICETYPE_AMP8xxx AMP8xxx DEVICETYPE_EL74x1 EL74x1 DEVICETYPE_EL74x1_SAFETY EL74x1 with Safety DEVICETYPE_ELM72xx_OCT ELM72xx with OCT DEVICETYPE_ELM72xx_OCT_SAFETY ELM72xx with OCT and Safety 5.7 E_Park Mode This ENUM determines whether the function block FB_Park Axis [} 19] parks or releases the corresponding channel of the drive. TYPE E_Park Mode : ( e Park Mode_Park, e Park Mode_Release )INT; END_TYPE Name Description e Park Mode_Park Channel is to be parked. e Park Mode_Release Channel is to be released. 5.8 ST_Drive Info Structure with basic information on the Beckhoff servo hardware used, which is returned via the FB_Read Drive Info [} 18] function block. TYPE ST_Drive Info : STRUCT Net Id : T_Ams Net Id; Slave Address : T_Ams Port; Channel : USINT; MDPProfile : BOOL; Device Name : STRING; Device Type : E_Device Type; END_STRUCT END_TYPE Name Type Description Net Id T_Ams Net Id String containing the AMS network ID of the Ether CAT master device. Slave Address T_Ams Port Fixed address of the Ether CAT slave Channel USINT Channel of the Ether CAT slave MDPProfile BOOL TRUE if an MDP protocol is used. Device Name STRING Contains the name of the device (not the free name of the device) in the I/O tree. Device Type E_Device Type Enumeration that specifies which Beckhoff drive device is involved. [} 72] TE1000 Version: 1.13.1 73
## Page 74

Data types 5.9 E_So EData Access Mode TYPE E_So EData Access Mode : ( e So EData Access Mode _Parallel := 0, e So EData Access Mode _Sequencial := 1 )INT; END_TYPE 5.10 E_AX5000Park Mode This ENUM determines whether the FB_So EAX5000Park Axis [} 59] parks or releases the corresponding channel of the AX5000. TYPE E_AX5000Park Mode : ( e AX5000Park Mode_Park, e AX5000Park Mode_Release )INT; END_TYPE Name Description e AX5000Park Mode_Park AX5000 channel is to be parked. e AX5000Park Mode_Release AX5000 channel is to be released. 5.11 E_Drive Parameter Number Specifies the parameter for reading/writing from the Beckhoff servo hardware. TYPE E_Drive Parameter Number: ( Invalid , // Invalid Drive Vendor Id , // STRING / Read Only / Drive Product Code , // STRING / Read Only / Drive Revision , // STRING / Read Only / Drive Serial Number , // STRING / Read Only / Drive Firmware , // STRING / Read Only / Motor Vendor Id , // STRING / Read Only / Motor Order Code , // STRING / Read Only / Motor Electric Type , // STRING / Read Only / Motor Serial Number , // STRING / Read Only / Motor Type , // E_Motortype / Read Only / Motor Max Speed , // LREAL / Read Only / rpm Motor Act Torque Nm , // LREAL / Read Only / Nm Motor Standstill Current , // LREAL / Read Only / A Motor Standstill Torque , // LREAL / Read Only / Nm Motor Peak Current , // LREAL / Read Only / A Motor Peak Torque , // LREAL / Read Only / Nm Has Motor Brake , // BOOL / Read Only / Motor Brake Status , // E_Brake State / Read Only / Has Drive Safety , // BOOL / Read Only / Drive Safety Version , // STRING / Read Only / Drive Safe State , // E_Drive Safety State / Read Only / Gear Ratio , // LREAL / Read Only / Drive Bipolar Torque Limit , // LREAL / Read/Write / % Drive Positive Torque Limit , // LREAL / Read/Write / % Drive Negative Torque Limit , // LREAL / Read/Write / % Drive Bipolar Torque Limit Nm , // LREAL / Read/Write / Nm Drive Positive Torque Limit Nm , // LREAL / Read/Write / Nm Drive Negative Torque Limit Nm // LREAL / Read/Write / Nm ) UDINT; END_TYPE 74 Version: 1.13.1 TE1000
## Page 75

Data types 5.12 E_Read Write Mode Specifies the mode for reading/writing parameters of the Beckhoff servo hardware. TYPE E_Read Write Mode : ( ONCE, CYCLIC, ) INT; END_TYPE 5.13 ST_Serial Number The structure for reading out the serial number. TYPE ST_Serial Number: STRUCT Actual Length : UINT; Max Length : UINT; Serial Number : T_Max String; END_STRUCT END_TYPE TE1000 Version: 1.13.1 75
## Page 76

Global constants 6 Global constants 6.1 So E Parameter Access The parameters of the individual parameter sets can be accessed with the help of these constants. Global_Variables VAR_GLOBAL CONSTANT S_0_IDNs : WORD := 16#0000; S_1_IDNs : WORD := 16#1000; S_2_IDNs : WORD := 16#2000; S_3_IDNs : WORD := 16#3000; S_4_IDNs : WORD := 16#4000; S_5_IDNs : WORD := 16#5000; S_6_IDNs : WORD := 16#6000; S_7_IDNs : WORD := 16#7000; P_0_IDNs : WORD := 16#8000; P_1_IDNs : WORD := 16#9000; P_2_IDNs : WORD := 16#A000; P_3_IDNs : WORD := 16#B000; P_4_IDNs : WORD := 16#C000; P_5_IDNs : WORD := 16#D000; P_6_IDNs : WORD := 16#E000; P_7_IDNs : WORD := 16#F000; END_VAR 76 Version: 1.13.1 TE1000
## Page 77

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TE1000 Version: 1.13.1 77
## Page 78

Trademark statements Beckhoff®, ATRO®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar® and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H.
## Page 79

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
