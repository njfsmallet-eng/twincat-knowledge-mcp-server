---
title: "TwinCAT_3_ADS_Powershell_Module_EN"
product: "TwinCAT"
category: "Communication"
tags: ["ADS", "CAT", "MODULE", "POWERSHELL", "TWIN"]
language: "EN"
document_type: "Manual"
version: "1.4.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_ADS_Powershell_Module_EN.pdf"
release_date: "2025-06-04"
---
Manual | EN TE1000 Twin CAT 3 | ADS Power Shell Module 2025-06-04 | Version: 1.4.2
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 Requirements............................................................................................................................................ 9 4 Installation and Activation...................................................................................................................... 10 4.1 Installation by Package Manager (Power Shell Gallery, Internet access necessary)....................... 10 4.2 Manual Installation without Internet access.................................................................................... 11 4.3 Check succeeded installation.......................................................................................................... 12 5 How To..................................................................................................................................................... 13 5.1 Getting Help.................................................................................................................................... 13 5.2 Argument Completers..................................................................................................................... 13 5.3 Getting registered Routes and Broadcast Search........................................................................... 14 5.4 Adding / Removing Routes............................................................................................................. 14 5.5 Setting Device Ams Net Id................................................................................................................ 17 5.6 Configure Device Realtime Settings............................................................................................... 17 5.7 (Re)Starting and Stopping Twin CAT............................................................................................... 17 5.8 Starting and Stopping the PLC and other ADS Servers.................................................................. 19 5.9 Reading / Writing Data.................................................................................................................... 19 5.9.1 Connect to a target device / ADS Server......................................................................... 19 5.9.2 Symbolic / Handle / Index Group Index Offset Access...................................................... 20 5.9.3 Read Write Values........................................................................................................... 22 5.9.4 Calling Rpc Methods and accessing PLC Properties........................................................ 25 5.10 Twin CAT / Device Diagnosis........................................................................................................... 26 5.10.1 Testing Device Availability and Latencies........................................................................ 26 5.10.2 Get the local Ams Net Id or Route..................................................................................... 27 5.10.3 Get information about a Twin CAT device........................................................................ 27 5.10.4 Accessing Symbolic Information...................................................................................... 28 5.10.5 Getting Realtime Performance Information...................................................................... 29 6 Tc Xae Mgmt Version 6. X......................................................................................................................... 31 6.1 Ads File Provider............................................................................................................................... 31 6.2 Ads Symbol Provider......................................................................................................................... 32 6.3 Tc Xae Mgmt..................................................................................................................................... 32 6.4 Get-Ams Net Id................................................................................................................................. 41 6.5 Restart-Twin CAT............................................................................................................................. 42 6.6 Set-Ams Net Id.................................................................................................................................. 49 6.7 Set-RTime Cpu Settings................................................................................................................... 52 6.8 Start-Ads Process............................................................................................................................ 57 6.9 Get-Ads Remote Connections.......................................................................................................... 61 6.10 Get-TCom Object............................................................................................................................. 62 6.11 Get-Tc Symbol Statistics................................................................................................................... 64 6.12 Set-Ads Route Property.................................................................................................................... 67 TE1000 Version: 1.4.2 3
## Page 4

Table of contents 6.13 About Tc Xae Mgmt.......................................................................................................................... 71 6.14 Add-Ads Route................................................................................................................................. 80 6.15 Add-Mqtt Route................................................................................................................................ 92 6.16 Close-Tc Session............................................................................................................................. 96 6.17 Copy-Ads File................................................................................................................................... 98 6.18 Get-Ads Route............................................................................................................................... 101 6.19 Get-Ads State................................................................................................................................. 106 6.20 Get-Ams Router Endpoint............................................................................................................... 110 6.21 Get-Ec Boxes................................................................................................................................. 111 6.22 Get-Ec Frame Statistics.................................................................................................................. 113 6.23 Get-Ec Master................................................................................................................................ 115 6.24 Get-IODevice................................................................................................................................ 118 6.25 Get-Io Free Run.............................................................................................................................. 121 6.26 Get-Mqtt Route............................................................................................................................... 123 6.27 Get-RTime Cpu Settings................................................................................................................. 124 6.28 Get-RTime Latency........................................................................................................................ 126 6.29 Get-RTime Performance................................................................................................................ 130 6.30 Get-Tc Data Type............................................................................................................................ 133 6.31 Get-Tc Event.................................................................................................................................. 137 6.32 Get-Tc License............................................................................................................................... 141 6.33 Get-Tc Router Info.......................................................................................................................... 146 6.34 Get-Tc Session.............................................................................................................................. 149 6.35 Get-Tc Symbol............................................................................................................................... 150 6.36 Get-Tc Target Info........................................................................................................................... 156 6.37 Get-Tc Version............................................................................................................................... 159 6.38 New-Tc Session............................................................................................................................. 162 6.39 Read-Tc Value............................................................................................................................... 165 6.40 Register-Ads Handle...................................................................................................................... 172 6.41 Register-Ads Nat Route.................................................................................................................. 176 6.42 Remove-Ads Route........................................................................................................................ 179 6.43 Remove-Mqtt Route....................................................................................................................... 182 6.44 Reset-Io Free Run........................................................................................................................... 185 6.45 Restart-Ads Computer................................................................................................................... 188 6.46 Send-Tc Read Write........................................................................................................................ 192 6.47 Set-Ads State................................................................................................................................. 199 6.48 Set-Ams Router Endpoint............................................................................................................... 205 6.49 Set-Io Free Run............................................................................................................................... 207 6.50 Stop-Ads Computer........................................................................................................................ 210 6.51 Test-Ads Route.............................................................................................................................. 214 6.52 Unregister-Ads Handle................................................................................................................... 219 6.53 Write-Tc Value............................................................................................................................... 222 7 Support and Service............................................................................................................................. 230 4 Version: 1.4.2 TE1000
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.4.2 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.4.2 TE1000
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.4.2 7
## Page 8

Overview 2 Overview What is Power Shell Excerpt from Wikipedia: “Power Shell is a task automation and configuration management framework from Microsoft, consisting of a command-line shell and associated scripting language built on the . NET Framework and . NET Core.” “In Power Shell, administrative tasks are generally performed by cmdlets (pronounced command-lets), which are specialized . NET classes implementing a particular operation. Sets of cmdlets may be combined into scripts, executables (which are standalone applications), or by instantiating regular . NET classes (or WMI/ COM Objects). These work by accessing data in different data stores, like the file system or registry, which are made available to the Power Shell runtime via Power Shell providers.” (link) These Cmdlets are packaged and deployed in so called Power Shell Modules. What is the Power Shell Ads Module (Extension) named ‘Tc Xae Mgmt’ The so called Tc Xae Mgmt module contains a number of useful Cmdlets and Providers for Twin CAT Management/Administration and accessing Ads Devices natively via Power Shell. • Route Management (Add-Ads Route, Remove-Ads Route) and Broadcast search (Get-Ads Route) • Testing Route Connections (Test-Ads Route, Get-Ads State) • Establish Ads Communication channels via Sessions and Connection (New-Tc Session, Close- Tc Session) • Type-Safe Read/Write Value Access via ADS protocol (Read-Tc Value, Write-Tc Value) • Symbol and Data Type Browsing (Get-Tc Symbol, Get-Tc Data Type) • Further Administrative Tasks (Copy-Ads File, Get-Tc Version, etc.) The package is published via the Power Shell Gallery at https://www.powershellgallery.com/packages/ Tc Xae Mgmt/. Versions There exist two different series of the ‘Tc Xae Mgmt’ module: Versions Power Shell Version Twin CAT Version Description 6. X [} 31] Microsoft Power Shell >= 7.0 >= 3.1.4024.10 Platform independent version 3. X Windows Power Shell >= 3.0 All Running on Windows Versions >= Windows 10 Please be aware of the Differences Microsoft Power Shell vs. Windows Power Shell. 8 Version: 1.4.2 TE1000
## Page 9

Requirements 3 Requirements Version 6. X Version 3.2. X • Microsoft Power Shell >= 7.0 • Windows 10 SP1 and newer • Installed Twin CAT 3.1.4024.10 or newer (minimum • Windows Power Shell 4.0 and newer RT / ADS level) • . NET Framework 4.5 and newer • Installed Twin CAT 3 or Twin CAT 2 (minimum RT / ADS level) TE1000 Version: 1.4.2 9
## Page 10

Installation and Activation 4 Installation and Activation 4.1 Installation by Package Manager (Power Shell Gallery, Internet access necessary) Installation by Package Manager (Power Shell Gallery) For newer versions of Windows and Power Shell the most easiest way to install the Tc Xae Mgmt Module is to use the Power Shell Gallery. Power Shell Gallery access is available without installation if one of the following setups is already on the system: Windows 10 or newer Windows Server 2016 or newer Windows Management Framework (WMF) 5.0 or newer Power Shell 6 or newer. In this case just type PS> Install-Module -Name Tc Xae Mgmt from the Power Shell console. Further information about the package and its installation is available on the Gallery Website: https:// www.powershellgallery.com/packages/Tc Xae Mgmt/ Installation of Power Shell Get Module In all other cases the Power Shell Get module must be installed on the machine most likely. On Power Shell the availability can be checked with the following command: PS> get-module Power Shell Get –listavailable Directory: C:\Program Files\Windows Power Shell\Modules Module Type Version Name Exported Commands ---------- ------- ---- ---------------- Script 2.2.5 Power Shell Get {Find-Command, Find-DSCResource, Find-Module, Find-Role Capability...} Please assure, that at minimum Version 2.2.5 is available. The Power Shell version can be determined as follows: PS> $PSVersion Table Name Value ---- ----- PSVersion 5.0.10514.6 WSMan Stack Version 3.0 Serialization Version 1.1.0.1 CLRVersion 4.0.30319.42000 Build Version 10.0.10514.6 PSCompatible Versions {1.0, 2.0, 3.0, 4.0...} PSRemoting Protocol Version 2.3 If the Power Shell Get Module is not existing please follow the instructions of the following websites • https://www.powershellgallery.com/packages/Package Management/ • https://learn.microsoft.com/en-us/powershell/gallery/powershellget/install-powershellget? view=powershellget-2.x Now, when the Power Shell Get Module is available, the command PS> Install-Module -Name Tc Xae Mgmt 10 Version: 1.4.2 TE1000
## Page 11

Installation and Activation from the Power Shell console should work. 4.2 Manual Installation without Internet access Because the Twin CAT XAE Management Power Shell Module (Tc Xae Mgmt) is now available on the Power Shell Gallery (https://www.powershellgallery.com/packages/Tc Xae Mgmt/) it is not necessary to activate the Power Shell Module manually if Internet access available. For completeness and if no Internet is present the following steps show the manual installation process. Check Installed Power Shell Module The Twin CAT Installation includes the setup for the Power Shell Tc Xae Mgmt Module. It should already be existing under the folder [TWINCATINSTALL]/Ads Api/Power Shell/Tc Xae Mgmt where [TWINCATINSTALL] indicates the Twin CAT root folder (c:\Twin CAT by default). Check the Power Shell Cmdlet Execution policy What is left actually to the user is to activate that module in the Power Shell environment. PS> get-execution Policy Restricted If the policy is not set to ‘Unrestricted’ or ‘Remote Signed’, Power Shell does not allow to process scripts or Cmdlets. For more information, please see PS> get-help about_Execution_Policies If the execution policy is restricted, it has to be set to ‘Remote Signed’ by a Power Shell console with administrative rights: PS C:\tfs> Set-Execution Policy Remote Signed Execution Policy Change The execution policy helps protect you from scripts that you do not trust. Changing the execution policy might expose you to the security risks described in the about_Execution_Policies help topic at http://go.microsoft.com/fwlink/? Link ID=135170. Do you want to change the execution policy? [Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "N"): y Extend Power Shell Module Search Path (PSModule Path) As next step, the Power Shell Search path for Power Shell Modules must be extended, so that Power Shell can find the Tc Xae Mgmt Cmdlets in the [TWINCATINSTALL]/Ads Api/Power Shell/ folder. Please check the Enviroment variable ‘PSModule Path’: PS> $env:PSModule Path D:\Users\User\Documents\Windows Power Shell\Modules\;C:\Program Files\Windows Power Shell\Modules;C: \Windows\system32\Windows Power Shell\v1.0\Modules\; If the Twin CAT Ads Api path is not contained in the PSModule Path Variable, it should be set via the Windows Control Panel → System Properties → Advanced → Environment Variables Dialog. Please add [TWINCATINSTALLDIR]\Ads Api\Power Shell\ e.g with C:\Twin CAT\Ads Api\Power Shell to the System wide ‘PSModule Path’ Variable. After a Power Shell Console restart, the new setting should be available: PS C:\tfs> $env:PSModule Path D:\Users\User\Documents\Windows Power Shell\Modules\;C:\Program Files\Windows Power Shell\Modules;C: \Windows\system32\Windows Power Shell\v1.0\Modules;c:\Twin CAT\Ads Api\Power Shell\ TE1000 Version: 1.4.2 11
## Page 12

Installation and Activation 4.3 Check succeeded installation To check that the Tc Xae Mgmt Module can be loaded successfully and is operational type: PS > get-module Tc Xae Mgmt –listavailable Directory: C:\Program Files\Windows Power Shell\Modules Module Type Version Name Exported Commands ---------- ------- ---- ---------------- Binary 3.1.1122 Tc Xae Mgmt {Add-Ads Route, Close-Tc Session, Copy-Ads File, Get-Ads Route...} Now the contained cmdlets can be accessed: PS> get-command -module Tc Xae Mgmt Command Type Name ----------- ---- Cmdlet Add-Ads Route Cmdlet Close-Tc Session Cmdlet Copy-Ads File Cmdlet Get-Ads Route Cmdlet Get-Ads State Cmdlet Get-Tc Data Type Cmdlet Get-Tc Session Cmdlet Get-Tc Symbol Cmdlet Get-Tc Target Info Cmdlet Get-Tc Version Cmdlet New-Tc Session Cmdlet Read-Tc Value Cmdlet Remove-Ads Route Cmdlet Set-Ads State Cmdlet Test-Ads Route Cmdlet Write-Tc Value PS> get-adsstate Name State OK Time (ms) Address --------- ----- -- --------- ------- CX_000001 Run True 2 14.5.137.176.1.1 Help is included for an overview of the features and concepts: PS > get-help about_Tc Xae Mgmt Or for specific Cmdlet information: PS > get-help Read-Tc Value –full 12 Version: 1.4.2 TE1000
## Page 13

How To 5 How To 5.1 Getting Help Getting list of Cmdlets (Commands) in the Tc Xae Mgmt module. PS> get-command -module Tc Xae Mgmt Get Syntax information about a Cmdlet. PS> get-help get-Ads Route Get Examples for a Cmdlet. PS> get-help get-Ads Route -examples Get Full Help for a Cmdlet. PS> get-help get-Ads Route -full Get Full Help for a Cmdlet online from Twin CAT Info Sys. PS> get-help get-Ads Route -online Get summary information about the Tc Xae Mgmt Powershell module. PS> get-help about_Tc Xae Mgmt 5.2 Argument Completers Beneath predictive intellisense, Argument Completers provide dynamic tab completion for parameter values while typing Powershell Cmdlets into the shell. Power Shell provides completions on input to provide hints, enable discovery, and speed up input entry. Command names, parameter names, argument values and file paths can all be completed by pressing the <Tab> key. Powershell also provides a Menu Complete function that's bound to <Ctrl+Space>. The Menu Complete function displays a list of matching completions below the command line. The Tc Xae Mgmt Powershell module supports Argument Completers in many variations. Device Address Completers Typing Ctrl+Space while inserting the Parameters that specify the Address (here Net Id, Route or Address), opens a list of registered routes of the Target System + the local system. These are the reachable routes. PS> $s = new-Tc Session -Net Id 172.17.60.197.1.1 MYSYSTEM (192.168.0.2.1.1) REMOTESYSTEM (192.168.0.3.1.1) PS> $s = new-Tc Session -Route MYSYSTEM MYSYSTEM (192.168.0.2.1.1) REMOTESYSTEM (192.168.0.3.1.1) PS> $s = new-Tc Session -Address 192.168.0.2 MYSYSTEM (192.168.0.2.1.1) REMOTESYSTEM (192.168.0.3.1.1) Symbol Path Completers The -Path Parameter describes the path to the symbol. If the target device system (with symbolic information) is already known by the Cmdlet (here by -Session parametrization), the argument completer can load the symbolic information from the target system and present the available Symbol Path options in the list. If the target address is unavailable or not specified, no selection is proposed. PS> $s = new-Tc Session -Net Id Local -port 851 PS> read-Tc Value -session $s -Path '.tc2v Bool' '.tc2v Bool' '.tc2v Struct' 'FB_Test' 'MAIN' '.tc2v Int' '.tc2v Struct Array' 'Global_Version' 'Slow' '.tc2v Int Array' 'Constants' 'GVL' 'Twin CAT_System Info Var List' TE1000 Version: 1.4.2 13
## Page 14

How To Depending on the size of the target symbolic information, downloading the symbolic information can take some time! Using the -session parameter here instead of -net Id and -port ensures that the Symbolic Information is loaded only one time and cached in the Session object! Data Type Name Completers Here, the same session object is used for accessing the list of Data types. PS> $s = new-Tc Session -Net Id Local -port 851 PS> get-Tc Data Type -session $s -name 'BIT' 'BIT' 'BOOL' 'BYTE' Depending on the size of the target symbolic information, downloading the symbolic information can take some time! Using the -session parameter here instead of -net Id and -port ensures that the Symbolic Information is loaded only one time and cached in the Session object! And many more … Argument completers are available for many Cmdlet Parameters. Just try out <TAB> and <CTRL + TAB>. 5.3 Getting registered Routes and Broadcast Search Getting locally registered routes: PS> Get-Ads Route Name Net Id Protocol TLS Address Finger Print ---- ----- -------- --- ------- ----------- CX_111111 192.168.0.2.1.1 Tcp IP 192.168.0.2 a783645203c138fb49abc0d10eac4f… CX_222222 192.168.0.3.1.1 Tcp IP 192.168.0.3 Broadcast Search: PS> Get-Ads Route -all Name Net Id Protocol TLS Address Finger Print ---- ----- -------- --- ------- ----------- MYDESKTOP 192.168.0.5.1.1 Tcp IP X 192.168.0.5 2f72d63cba3069b5e15a3983fbfa1da7914f7c1… CX_111111 192.168.0.2.1.1 Tcp IP X 192.168.0.2 1ab3994a2ee6fbcdc999d5d1735cb9d5a12366d… CX_222222 192.168.0.3.1.1 Tcp IP X 192.168.0.3 4864cc5d2fbdcfe2128ddaab222fe1a6faa0a4d… CX_333333 192.168.0.4.1.1 Tcp IP X 192.168.0.4 efcd5570e981784342bcf2b2fd03b54b22746c4… 5.4 Adding / Removing Routes Search Routes and add the result at the Local Twin CAT System PS> Get-Ads Route -All -name "Tc3*" Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 192.168.0.105.1.1 192.168.0.105 3.1.4021 Win7 TC3Test13-C6650 172.17.60.239.1.1 192.168.0.156 2.11.2246 Win7 PS> $cred = Get-Credential -Message "Get Credentials" -User Name "User Name" PS> Add-Ads Route -Credential $cred -Address "TC3Test A1-CP67x" -temporary -passthru Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 192.168.0.105.1.1 192.168.0.105 3.1.4021 Win7 PS> Get-Ads Route -name "TC3Test A1-CP67x" | Test-Ads Route 14 Version: 1.4.2 TE1000
## Page 15

How To Search for Systems that start with the name "TC3*", then asks the user for Credentials and adds the Route as 'temporary' (with TC2 compatible security, clear text password). Afterwards, the connection is checked via 'Test-Ads Route'. The route is specified by its name (Computer Name). To find out the address of the route an under the hood broadcast search is necessary what means that the target system must be online available in the network. Add a route to the local system (Single Sided) PS> Add-Ads Route -name Test -Net Id 1.2.3.4.1.1 -IPOr Host Name 1.2.3.4 Adds a Route named 'Test' to the local routes with the specified Net Id and IPAddress. Because Net Id and IPOr Host Name are defined AND no credentials are set, this route is added locally only. Be aware that to get the route functional, the target system must define the backroute. Add a single sided temporary route Add-Ads Route -name "Test Route" -Net Id 1.2.3.4.1.1 -IPOr Host Name 1.2.3.4 -Temporary - Remote Persistance None Adding a route 'Test Route' single sided and temporary only to the local system. The remote device doesn't need to be online. Add a self-signed route PS> Get-Ads Route -All -name "Tc3*" Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 192.168.0.105.1.1 192.168.0.105 3.1.4021 Win7 TC3Test13-C6650 172.17.60.239.1.1 192.168.0.156 2.11.2246 Win7 PS> $cred = Get-Credential -Message "Get Credentials" -User Name "User Name" PS> Add-Ads Route -Credential $cred -name "TC3Test A1-CP67x" -self Signed -passthru Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 192.168.0.105.1.1 192.168.0.105 3.1.4021 Win7 PS> Get-Ads Route -name "TC3Test A1-CP67x" | Test-Ads Route Search for Systems that start with the name "TC3*", then asks the user for Credentials and adds the Route with 'Self Signed' Ads Secure settings. Afterwards, the connection is checked via 'Test-Ads Route'. The route is specified by its name (Computer Name). To find out the address of the route an under the hood broadcast search is necessary what means that the target system must be online available in the network. Add a route with (S)hared (C)ertification (A)Authority (SCA) PS> Add-Ads Route -Address 192.168.0.105 -sca -paththru Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 192.168.0.105.1.1 192.168.0.105 3.1.4021 Win7 Searches for the system with the specified IPAddress, and add the Route with Shared Certification Authority settings without password. The precondition is, that valid certificates are already established on both (engineering and remote) systems, within their Static Routes.xml files. The route is specified by its Address only. TE1000 Version: 1.4.2 15
## Page 16

How To Because the Net Id is missing a broadcast search is necessary what means that the target system must be online available in the network. Add a Route with (N)etwork (A)Address (T)ranslation (NAT) PS> $cred = Get-Credential -Message "Get Credentials" -User Name "User Name" PS> Add-Ads Route -Credential $cred -Net Id 192.168.0.105 -Nat 1.2.3.4.1.1 Name Net Id Address Sub Tc Version RTSystem --------------- ----------- ------------- --- --------- ------------ TC3Test A1-CP67x 1.2.3.4.1.1 192.168.0.105 3.1.4024 Win10 (2004) Add a route with a local network address translation (NAT Ams Net Id) to project a remote Ams Net Id (Remote Net Id) locally to a different address. Adding a (S)hared (C)ertificate (A)uthority route PS> $route = get-adsroute CX_01234 -all PS> $route Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 172.17.60.197.1.1 X 172.17.60.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535… PS> $route | add-adsroute -Shared Cert Auth -Ignore CN -passthru Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 172.17.60.197.1.1 X 172.17.60.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535… Broadcast search for a Device with Hostname CX_01234 and adding of a ADSSecure route via 'Shared Certificate Authority' (SCA) to the local system. Both systems must contain certificates derived from the same root CA certificate. Adding a route with User Name/Password (P)re (S)hared (Key) (PSK) PS> $cred = get-credential User Name: My User Password: ******** PS> $route = get-adsroute CX_01234 -all PS> $route Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 172.17.60.197.1.1 X 172.17.60.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535… PS> $route | add-adsroute -Pre Shared Key -Credential $cred Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 172.17.60.197.1.1 X 172.17.60.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535… Broadcast search for a Device with Hostname CX_01234 and adding of a ADSSecure route via 'Preshared key' (User Name, Password) to the local system. The target system must already contain the preshared key configuration (as PSK Identity/Password) in its Static Routes.xml configuration file. Adding a route with Binary Key (P)re (S)hared (Key) (PSK) PS> $route = get-adsroute CX_01234 -all PS> $route Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 172.17.60.197.1.1 X 172.17.60.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535… PS> $route | add-adsroute -Pre Shared Key -Identity My User - 16 Version: 1.4.2 TE1000
## Page 17

How To Binary Key 1,2,3,4,5,6,7,8,9,0xa,0xb,0xc,0xd,0xe,0xf Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 172.17.60.197.1.1 X 172.17.60.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535… Broadcast search for a Device with Hostname CX_01234 and adding of a ADSSecure route via 'Preshared key' (Identity, Binary Key) to the local system. The target system must already contain the preshared key configuration (as Psk Identity/Binary Key) in its Static Routes.xml configuration file. Removing Routes by Address PS> Get-Ads Route Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- CP-15ECA0 192.168.0.128.1.1 192.168.0.178 0.0 Unknown TC3TESTA1-CP67X 192.168.0.105.1.1 192.168.0.105 0.0 Unknown PS> Remove-Ads Route -Name "CP-15ECA0","TC3TESTA1*" Removes the Routes "CP-15ECA0" and "TC3TESTA1-CP67X" from the local system. Removing Routes from the local registered configuration PS> Get-Ads Route | Remove-Ads Route -silent Removes all registered routes from the local system. 5.5 Setting Device Ams Net Id CAUTION CRASH and Reboot With actual Twin CAT Versions the command crashes and reboots the device! PS> Set-Ams Net Id -New Id 1.1.1.1.1.1 Changeing Ams Net Id of target system. Change the Net Id of system '192.168.0.2.1.1' to '1.1.1.1.1.1' [Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "Y"): y Changing the Net Id of system '192.168.0.2.1.1' to '1.1.1.1.1.1' is succeeded. All preexisting connec tions to this system a invalid now. A reboot of this system is necessary! Sets the Ams Net Id of the Local system to '1.1.1.1.1.1'. 5.6 Configure Device Realtime Settings PS> Set-RTime Cpu Settings -Shared Cores 6 Setting CPU cores Setting Windows Cores: 6, Isolated Cores: 6 to device '192.168.0.146.1.1'? [Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "Y"): y Number of processors successfully set to '6'. A reboot is necessary to activate settings! Sets the CPU Core Settings to 6 Shared and 6 Isolated on a 12 Core System. 5.7 (Re)Starting and Stopping Twin CAT Restart Twin CAT (Succeeding) PS> Restart-Twin Cat -command Reset -force Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) TE1000 Version: 1.4.2 17
## Page 18

How To -- ------ ----- ---- --------- --------- -------- ------- ------------ X CX_1111 192.168.0.2.1.1 10000 Succeeded Reset Run Run 2853 Restarts the local Twin CAT System. The ‘X’ in the ‘Ok’ Column indicates the success. Restart Twin CAT (Failing) PS> Restart-Twin Cat -command Reset -force WARNING: 192.168.0.2.1.1:10 ERR | 18:26:28:108 |'TCOM Server' (10): Device 1 (Ether CAT) (Adapter): Failed to connect to network adapt er! WARNING: 192.168.0.2.1.1:10 WRN | 18:26:28:108 |'TCOM Server' (10): PREOP to SAFEOP of 'Device 1 (Ether CAT) (Adapter)' (0x03010011) f ailed - 'request is aborted' 0x9811071F WARNING: 192.168.0.2.1.1:10000 ERR | 18:26:28:117 |'Twin CAT System' (10000): Sending ams command >> Init12\IO: Set State TCom Obj SAFEOP: Set Objects (4) to SAFEOP >> Ads Error: 1823 (0x71f, ADS ERROR: device aborted the action) << failed ! Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ CX_1111 192.168.0.2.1.1 10000 Succeeded Reset Config Config 3427 Calls a Reset to the local System Service that fails! Error log messages will be logged out. Restart Twin CAT and Analyze Errors on failed start. PS> Restart-Twin CAT -command Reset -force | select-object -Expand Property Log Messages WARNING: 192.168.0.2.1.1:10 ERR | 18:20:45:969 |'TCOM Server' (10): Device 1 (Ether CAT) (Adapter): Failed to connect to network adapt er! WARNING: 192.168.0.2.1.1:10 WRN | 18:20:45:969 |'TCOM Server' (10): PREOP to SAFEOP of 'Device 1 (Ether CAT) (Adapter)' (0x03010011) f ailed - 'request is aborted' 0x9811071F WARNING: 192.168.0.2.1.1:10000 ERR | 18:20:45:979 |'Twin CAT System' (10000): Sending ams command >%gt; Init12\IO: Set State TCom Obj SAFE OP: Set Objects (4) to SAFEOP >%gt; Ads Error: 1823 (0x71f, ADS ERROR: device aborted the action) << failed! Type Time Stamp Device Name Port Message ---- --------- ---------- ---- ------- Message 18:20:44.874 Twin CAT System 10000 Twin CAT System Restart initiated from Ams Net Id: 192.168.0. 2.1.1 port 34564. Message 18:20:44.879 Twin CAT System 10000 Saving configuration of COM server Tc Vn Service ! Message 18:20:44.880 Twin CAT System 10000 Saving configuration of COM server Tc Event Logger ! Message 18:20:44.970 Twin CAT System 10000 Shutting down COM Server Tc Vn Service ! Message 18:20:44.971 Twin CAT System 10000 Shutting down COM Server Tc Event Logger ! Message 18:20:45.745 Twin CAT System 10000 Loading configuration of COM server Tc Vn Service ! Message 18:20:45.747 Twin CAT System 10000 Loading configuration of COM server Tc Event Logger ! Message 18:20:45.748 Twin CAT System 10000 Initializing COM Server Tc Vn Service ! Message 18:20:45.773 Twin CAT System 10000 Initializing COM Server Tc Event Logger ! Message 18:20:45.783 Twin CAT System 10000 Tc Io Eth Server started: Tc Io Eth. Message 18:20:45.791 Twin CAT System 10000 Tc Rts Objects Server started: Tc Rts Objects. Message 18:20:45.798 Twin CAT System 10000 Tc Io ECat Server started: Tc Io ECat. Message 18:20:45.805 Twin CAT System 10000 Tc Io Server started: Tc Io. Message 18:20:45.814 Twin CAT System 10000 Tc Plc30 Server started: Tc Plc30. Message 18:20:45.821 Twin CAT System 10000 Tc RTime Server started: Tc RTime. Message 18:20:45.927 License Server 30 license validation status is Valid(3) Error 18:20:45.969 TCOM Server 10 Device 1 (Ether CAT) (Adapter): Failed to connect to networ k adapter! Warning 18:20:45.969 TCOM Server 10 PREOP to SAFEOP of 'Device 1 (Ether CAT) (Adapter)' (0x0301 0011) failed - 'request is aborted' 0x9811071F Error 18:20:45.979 Twin CAT System 10000 Sending ams command >%gt; Init12\IO: Set State TCom Obj SAF EOP: Set Objects (4) to SAFEOP >%gt; Ads Error: 1823 (0x71f, ADS ERROR: device aborted the action) %l t;%lt; failed! Message 18:20:47.879 Twin CAT System 10000 Loading configuration of COM server Tc Vn Service Message 18:20:47.881 Twin CAT System 10000 Loading configuration of COM server Tc Event Logger Message 18:20:47.882 Twin CAT System 10000 Initializing COM Server Tc Vn Service Message 18:20:47.910 Twin CAT System 10000 Initializing COM Server Tc Event Logger Message 18:20:47.922 Twin CAT System 10000 TCIO Server started: TCIO. Message 18:20:47.931 Twin CAT System 10000 TCRTIME Server started: TCRTIME. Message 18:20:47.939 Twin CAT System 10000 TCRTSOBJECTS Server started: TCRTSOBJECTS. Message 18:20:47.948 Twin CAT System 10000 TCIOETH Server started: TCIOETH. 18 Version: 1.4.2 TE1000
## Page 19

How To Message 18:20:47.956 Twin CAT System 10000 TCIOECAT Server started: TCIOECAT. Message 18:20:47.963 Twin CAT System 10000 TCIODRIVERS Server started: TCIODRIVERS. Message 18:20:48.078 Twin CAT System 10000 Starting COM Server Tc Vn Service Message 18:20:48.078 Twin CAT System 10000 Starting COM Server Tc Event Logger Tries to restart the local Twin CAT system and write the log messages to the output. This Command fails. 5.8 Starting and Stopping the PLC and other ADS Servers Start the PLC on the local system PS> Set-Ads State -port 851 -command Run -force Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X CX-11111 1.1.1.1.1.1 851 No Error Run Stop Run 293 The ‘X’ indicates the success. Start the PLC on all registered routes PS> $r = Get-Ads Route PS> Set-Ads State -port 851 -command Run -Input Object $r -force Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X CX-11111 1.1.1.1.1.1 851 No Error Run Stop Run 293 X CX-22222 1.1.1.2.1.1 851 No Error Run Stop Run 357 X CX-22222 1.1.1.3.1.1 851 No Error Run Stop Run 218 X CX-22222 1.1.1.4.1.1 851 No Error Run Stop Run 324 Start the PLC on all registered target systems. The ‘X’ indicates the success. Restart the Twin CAT System Service PS> Set-Ads State -port 10000 -command Reset -force Ok Target Net Id Port Error Code Requested Original Reached Latency(ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X My System 172.168.0.1.1.1 10000 No Error Reset Run Run 5007 Restart the local System Service. This is an alternative to the ‘Restart-Twin CAT’ Cmdlet. 5.9 Reading / Writing Data 5.9.1 Connect to a target device / ADS Server In the Twin CAT world, every software/hardware instance participating at the ADS communication network is an ADS Server. To access these servers various implementations of ADS Clients for different programming languages are available. To establish an ADS connection in Powershell, the ‘New-Tc Session’ Cmdlet is used. Internally it uses the . NET ‘Twin CAT. Ads. Ads Client’ object for communicating. If using the -Net Id, -Port, -Route or -Address Arguments of the ‘Tc Xae Mgmt’ Module Cmdlets, the connection (and therefore the Ads Client) is established on the fly. The connection is shut down after the single Cmdlet is executed. The advantage of the ‘Session’ is, that leaves the connection established until ‘Close-Tc Session’ is called, or the Powershell host process (the Powershell-Session) ends. Existing ADS Sessions can be stored in variables or can be accessed by ‘Get-Tc Session’. TE1000 Version: 1.4.2 19
## Page 20

How To These Cmdlets use Argument Completers proposing registered Routes. Open an ADS Session PS> New-Tc Session -Net Id '172.17.62.105.1.1' -port 851 ID Address Connected State Cycles Losses Last Error Established Last Succee d -- ------- --------- ----- ------ ------ --------- ----------- ----------- 5 172.17.62.105.1.1:851 True Succeeded 0 0 2024-01-08T12:50:58 Establishes a new Ads Session/Connection to the specified Net Id/Port address. Opens an ADS Session, use it and closes it afterwards PS> $session = New-Tc Session -Net Id '1.2.3.4.1.1' -port 10000 PS> $session | Get-Ads State Target Net Id Port State Latency (ms) ------ ----- ---- ----- ------- CX_1234 1.2.3.4.1.1 10000 Config 3 PS> $session | Close-Tc Session Opens a session to the registered route with Ams Net Id: 1.2.3.4.1.1 and closes the ADS Session again. Open an ADS Session with wildcard name pattern. PS> $route = Get-Ads Route -Name "Tc3*" PS> $session = New-Tc Session -Route $route -Port 851 PS> $session ID Address Connected State Cycles Losses Last Error Established Last Succee d -- ------- --------- ----- ------ ------ --------- ----------- ----------- 5 172.17.62.105.1.1:851 True Succeeded 0 0 2024-01-08T12:50:58 Establishes a new ADS Session/Connection to the specified route destination that has the name pattern "tc3*" via port 851 (PLC1). List established ADS Sessions PS> Get-Tc Session ID Address Connected State Cycles Losses Last Error Established Last Succee d -- ------- --------- ----- ------ ------ --------- ----------- ----------- 5 172.17.62.105.1.1:851 True Succeeded 0 0 2024-01-08T12:50:58 Lists all actual initiated sessions. Close ADS Sessions PS> Close-Tc Session -Id 5 Closes the session with id 5. 5.9.2 Symbolic / Handle / Index Group Index Offset Access 5.9.2.1 Symbolic Access Because the symbolic information can be downloaded from the target (done by Get-Tc Symbol), the Read- Tc Value and Write-Tc Value Cmdlets are able to use . NET objects type-safe and seamlessly. All data – if possible – is marshaled transparently via the network. 20 Version: 1.4.2 TE1000
## Page 21

How To Reading a value using a symbol object PS> $session = New-Tc Session -Net Id '1.2.3.4.5.6' -Port 851 PS> $symbol = $session | get-Tc Symbol -Path 'Twin CAT_System Info Var List._App Info. Project Name' PS> $symbol | Read-Tc Value ADS_Dyn Symbols Create an ADS Session/Connection, determine the 'Project Name' Symbol from the running PLC Project, read the current value of the symbol and print it to the console. 5.9.2.2 Handle Access Register/Unregister a handle to a Symbol Path PS> $session = New-Tc Session -Net Id '1.2.3.4.5.6' -Port 851 PS> $handle Info = $session | Register-Ads Handle - Path 'Twin CAT_System Info Var List._App Info. Project Name' PS> $handle Info = Register-Ads Handle -Path 'Twin CAT_System Info Var List._App Info. Project Name' - Session $s PS> $handle Info Instance Path Result Handle ------------ ------ ------ Twin CAT_System Info Var List._App Info. Project Name No Error 0x428000FC (1115685116) PS> Read-Tc Value -Session $session -Index Group Symbol Value By Handle -Index Offset $handle Info. Handle - Type String My Project PS> $handle | Unregister-Ads Handle -Session $session PS> $session | Close-tcsession Opens a new device session, registers a Symbol Handle to the Project Name of the running PLC Project, Reads the value by handle unregisters the handle and closes the session again. 5.9.2.3 Index Group/Index Offset Access Read from Index Group/Index Offset and cast to a . NET type PS> Read-Tc Value -session $session -Index Group 0x4040 -Index Offset 0x1247A8 -Value Type String ADS_Dyn Symbols Reads a string typed value from Index Group / Index Offset. In this example the Project Name of the running PLC Project resides at that Process Image Address. Read from Index Group/Index Group generically (number of bytes) PS> Read-Tc Value -Index Group 0x4040 -Index Offset 0x1247a8 -Net Id 192.168.0.105.1.1 -port 851 - size 0xff | format-hex 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 00000000 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 00 00 ADS_Dyn Symbols.. 00000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000070 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080 11 00 01 01 A0 86 01 00 14 00 5E 01 21 C2 15 00 .... ?....^.! A.. 00000090 00 7F F1 57 3B 83 6C 07 1E 00 00 00 00 00 00 00 .⌂ñW;?l......... 000000A0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000C0 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 5F 50 ADS_Dyn Symbols_P 000000D0 6C 63 54 61 73 6B 00 00 00 00 00 00 00 00 00 00 lc Task.......... 000000E0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000F0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ............... TE1000 Version: 1.4.2 21
## Page 22

How To Reads 256 Bytes via Index Group/Index Offset from the specified target system and prints the out formatted as hexdump. 5.9.3 Read Write Values 5.9.3.1 Read The Read-Tc Value Cmdlet can be called via Index Group/Index Offset (Raw Data), via Handle or with Symbolic Information (Symbol path or Symbol Object). If symbolic information is used, then the calls will be type safe and the returned data is automatically mapped to appropriate (dynamically) created . NET types. Read type safe data with symbolic information PS> $session = New-Tc Session -Net Id '1.2.3.4.5.6' -Port 851 PS> $symbol = $session | get-Tc Symbol -Path 'Twin CAT_System Info Var List._App Info. Project Name' PS> $symbol | Read-Tc Value ADS_Dyn Symbols Create an ADS Session/Connection, determine the 'Project Name' Symbol from the running PLC Project, read the current value of the symbol and print it to the console. Read amount of bytes from Index Group/Index Offset PS> Read-Tc Value -Index Group 0x4040 -Index Offset 0x1247a8 -Net Id 172.17.62.105.1.1 -port 851 - size 0xff | format-hex 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 00000000 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 00 00 ADS_Dyn Symbols.. 00000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000070 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080 11 00 01 01 A0 86 01 00 14 00 5E 01 21 C2 15 00 .... ?....^.! A.. 00000090 00 7F F1 57 3B 83 6C 07 1E 00 00 00 00 00 00 00 .⌂ñW;?l......... 000000A0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000C0 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 5F 50 ADS_Dyn Symbols_P 000000D0 6C 63 54 61 73 6B 00 00 00 00 00 00 00 00 00 00 lc Task.......... 000000E0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000F0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ............... Reads 256 Bytes via Index Group/Index Offset from the specified target system and prints the out formatted as hexdump. Read data with Index Group/Index Offset and specify the returned data type. PS> Read-Tc Value -session $session -Index Group 0x4040 -Index Offset 0x1247A8 -Value Type String ADS_Dyn Symbols Reads a string typed value from Index Group / Index Offset. In this example the Project Name of the running PLC Project resides at that Process Image Address. Read data by Symbol handle PS> $route = Get-Ads Route -Name 'CX-123456' PS> $session = $route | New-Tc Session -Port 851 PS> $handle = $session | Send-Tc Read Write -Index Group Symbol Handle By Name -Write Value "GVL.vg Int" - Read Type Int32 -force PS> $session | Read-Tc Value -Index Group Symbol Value By Handle -Index Offset $handle -Value Type Int16 42 22 Version: 1.4.2 TE1000
## Page 23

How To Create a session to the PLC (Port 851) of a target system, determine the Symbol Handle by Instance Path and use this handle to read its 'Int16' Value (INT on PLC System). Accessing Complex Objects (e.g Structs or FBs) Also complex types will be resolved transparently. E.g. a DT type with 3 fields (v Bool, v Int, v String) on the PLC side can be accessed as a whole. Reading the Symbol Information PS> $symbol2 = $session | Get-Tc Symbol -path 'MAIN.vm Simple Struct' Getting the value of the struct. The subvalues will be created type-safe on-the-fly as . NET Types PS> $val2 = $symbol2 | Read-Tc Value PS> $val2 v Bool v Int v String PSValue ----- ---- ------- ------- True -12121 QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_ ... PS> $val2 | Get-Member Type Name: System. Management. Automation. PSCustom Object Name Member Type Definition ---- ---------- ---------- Equals Method bool Equals(System. Object obj) Get Hash Code Method int Get Hash Code() Get Type Method type Get Type() To String Method string To String() PSValue Note Property Dynamic Value PSValue=... v Bool Note Property bool v Bool=True v Int Note Property short v Int=-12121 v String Note Property string v String=QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_ Also Sub Values can be accessed. This doesn’t trigger a new ADS Read (and uses internally cached data). The data is consistent to the timepoint of the ‘Read-Tc Value’ PS> $val2.v String QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_ To access the more detailed internal Data of the Value, the ‘PSValue’ can be accessed. PS> $val2. PSValue Symbol Data Type Byte Size Time Stamp Cached Raw ------ -------- -------- --------- --------- MAIN.vm Simple Struct ST_Simple Struct 165 2024-01-11T15:24:33 01 A7 D0 51 00 57 00 45 00 52 00 54 00 5A 00 55 PS> $val2. PSValue | format-list * Value Factory : Twin CAT. Value Access. Dynamic Value Factory Time Stamp : 1/11/2024 3:24:33 PM +01:00 Symbol : MAIN.vm Simple Struct (IG: 0x4040, IO: 0x10e7b8, Size: 165 bytes)' Update Mode : None Parent Value : Root Value : ... Age : 00:07:18.2760087 Data Type : ST_Simple Struct Cached Raw : System. Read Only Memory<Byte>[165] Is Primitive : False v Bool : True v Int : -12121 v String : QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_ TE1000 Version: 1.4.2 23
## Page 24

How To 5.9.3.2 Write The Write-Tc Value Cmdlet can be called via Index Group/Index Offset (Raw Data), via Handle or with Symbolic Information (Symbol path or Symbol Object). If symbolic information is used, then the calls will be type safe and the write data is automatically mapped to appropriate (Plc) Data on the target side, dynamically. Write Symbolic Data PS> $session = New-Tc Session -Net Id 1.2.3.4.5.6 -Port 851 PS> $project Name Symbol = $session | Get-Tc Symbol -path "*Project Name" PS> $project Name Symbol Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name PS> $project Name Symbol | Read-Tc Value Old Project Name PS> $project Name Symbol | Write-Tc Value -Value "New Project Name" -force PS> $project Name Symbol | Read Tc Value New Project Name This example shows how to create a session, determining the Symbol 'Project Name within the _App Info Struct on a running PLC project and reading its value. After that, the Value will be overwritten with 'New Project Name'. Write Index Group/Index Offset Data Write-Tc Value -session $session -Index Group 0x4040 -Index Offset 0x1247A8 -Value "New Project Name" Writes a string typed Value to the specified Index Group/Index Offset Address. 5.9.3.3 Read Write ADS Read Write requests send data to the ADS Server and get a Data response in one roundtrip. The Powershell command to request an ADS Read Write is the Send-Tc Read Write Cmdlet. Send an ADS Read Write Request with Index Group/Index Offset (Return Data as string) PS> Send-Tc Read Write -Net Id 1.2.3.4.5.6 -Port 851 -Index Group Symbol Value By Name -Index Offset 0 - Write Value "Twin CAT_System Info Var List._App Info. Project Name" -Read Type string -Read Length 1024 Read Write access of process image on target '1.2.3.4.5.6:851': Start Read Write operation Write Data: 'Twin CAT_System Info Var List._App Info. Project Name'(IG:0xf004,IO:0 x0000,Len:47), Read: Type 'System. String' (Len:'1024) on target '1.2.3.4.5.6:851'? [Y] Yes[A] Yes to All[N] No[L] No to All[S] Suspend[?] Help(default is "Y"): y ADS_Dyn Symbols Sends a Read/Write request with index group 0xf004 (Symbol Value By Name) and offset 0. The write data will be initialized with the project symbol path and an returned (read) string (Default encoded) returned. Send an ADS Read Write Request with Index Group/Index Offset (return data as byte{}) PS> Send-Tc Read Write -Net Id 1.2.3.4.5.6 -Port 851 -Index Group Symbol Value By Name - Write Value "Twin CAT_System Info Var List._App Info. Project Name" -Read Length 64 | format-hex Read Write access of process image on target '1.2.3.4.5.6:851': Start Read Write operation Write Data: 'Twin CAT_System Info Var List._App Info. Project Name'(IG:0xf004,IO:0 x0000,Len:47), Read: Type 'System. Byte[]' (Len:'64) on target '1.2.3.4.5.6:851'? [Y] Yes[A] Yes to All[N] No[L] No to All[S] Suspend[?] Help(default is "Y"): y 24 Version: 1.4.2 TE1000
## Page 25

How To 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 00000000 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 00 00 ADS_Dyn Symbols.. 00000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ Sends a Read/Write request with index group 0xf004 (Symbol Value By Name) and offset 0. The write data will be initialized with the project symbol path and the returned (read) data is by default a byte array of 64 bytes. The result value will be formatted as hex code. Send an ADS Read Write Request with Index Group/Index Offset (using handle) PS> $route = Get-Ads Route -Name 'CX-123456' PS> $session = $route | New-Tc Session -Port 851 PS> $handle = $session | Send-Tc Read Write -Index Group Symbol Handle By Name -Write Value "GVL.vg Int" - Read Type Int32 -force PS> $session | Read-Tc Value -Index Group Symbol Value By Handle -Index Offset $handle -Value Type Int16 42 Create a session to the PLC (Port 851) of a target system, determine the Symbol Handle by Instance Path and use this handle to read its 'Int16' Value (INT on PLC System). 5.9.4 Calling Rpc Methods and accessing PLC Properties Rpc Methods can be directly called type safe on the value dynamically read by a symbolic Read-Tc Value. The Rpc Method In-/ and Out-/ Parameters are automatically marshalled to/from they . NET counterparts – so that the access is easy and transparently. Accessing the RPC Methods needs to open an ADS Session and loading the symbolic information. Here we open a new session to the local PLC. PS> $session = new-tc Session -port 851 PS> $rpc Symbol | Get-Tc Symbol -path 'MAIN.fb Rpc' The ‘rpc Symbol’ object now contains the Symbol of the FB instance ‘fb Rcp’. This FB has a Rpc Method ‘Add Values’ with 2 INT parameters and a Property ‘Prop Int’ defined (on the PLC side). Information about these defined symbol instance can be browsed. PS> $rpc Symbol Instance Path Category Data Type Size Static Persistant IG IO ------------ -------- -------- ---- ------ ---------- -- -- MAIN.fb Rpc Struct FB_Rpc Pou 1152 False False 4040 10DEE8 Beneath Properties and Methods of the Instance base class, the ‘rpc Symbol’ contains dynamically generated access properties and methods. PS> $rpc Symbol | Get-Member Type Name: Twin CAT. Type System. Dynamic Struct Instance … Name Member Type Definition ---- ---------- ---------- Add Values Dynamic dynamic Add Values Add Values Async Dynamic dynamic Add Values Async Prop Int Dynamic dynamic Prop Int …. Accessing the Rpc Method metadata of the symbol: PS> $rpc Symbol. Rpc Methods Name Return Type Declaration TE1000 Version: 1.4.2 25
## Page 26

How To ---- ---------- ----------- Add Values INT INT Add Values([in] INT i1,[in] INT i2) __get Prop Int INT INT __get Prop Int() __set Prop Int __set Prop Int([in] INT Prop Int) The method can be called transparently in Powershell PS> $rpc Symbol. Add Values(39,3) 42 The same is true for the dynamic property PS> $rpc Symbol. Prop Int Instance Path Category Data Type Size Static Persistant IG IO ------------ -------- -------- ---- ------ ---------- -- -- MAIN.fb Rpc. Prop Int Primitive INT 2 False False 4040 10DEE8 PS> $rpc Symbol. Prop Int | Read-Tc Value 29224 5.10 Twin CAT / Device Diagnosis 5.10.1 Testing Device Availability and Latencies The Test-Ads Route Cmdlet provides information about • System availability • Ads Server existence • Available System Ports • Access latencies/roundtrip times Check local PLC availability PS> Test-Ads Route -Port 851 Name Net Id Port Latency Result (ms) ---- ----- ---- ------- ------ CX-11111 192.168.0.2.1.1 851 3 Ok Test the Port 851 of the local system (PLC 1) for availablity. Check the registered routes for availabilty PS> Get-Ads Route | Test-Ads Route Name Net Id Port Latency Result (ms) ---- ----- ---- ------- ------ CX-11111 192.168.0.2.1.1 10000 4 Ok CX-22222 192.168.0.3.1.1 10000 Failed CX-33333 192.168.0.4.1.1 10000 4 Ok Get the locally registered routes and test if they are reachable (on Ams Port 10000) Port scan of the local Twin CAT System PS> Test-Ads Route -Online Ports Name Net Id Port Latency Result (ms) ---- ----- ---- ------- ------ CX-11111 192.168.0.2.1.1 10 0.6 Ok CX-11111 192.168.0.2.1.1 11 1.3 Ok CX-11111 192.168.0.2.1.1 12 1.2 Ok CX-11111 192.168.0.2.1.1 30 3 Ok 26 Version: 1.4.2 TE1000
## Page 27

How To CX-11111 192.168.0.2.1.1 131 75 Ok CX-11111 192.168.0.2.1.1 32829 125 Ok CX-11111 192.168.0.2.1.1 340 122 Ok CX-11111 192.168.0.2.1.1 850 171 Ok CX-11111 192.168.0.2.1.1 32830 174 Ok CX-11111 192.168.0.2.1.1 351 171 Ok CX-11111 192.168.0.2.1.1 350 172 Ok CX-11111 192.168.0.2.1.1 270 219 Ok CX-11111 192.168.0.2.1.1 851 220 Ok Scans the propagated Ams Ports for the local system. Measure latencies of a specific ADS Port Test-Ads Route -port 10000 -count 10 Name Net Id Port Latency Result (ms) ---- ----- ---- ------- ------ MYSYSTEM 192.168.56.1.1.1 10000 1.5 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.6 Ok MYSYSTEM 192.168.56.1.1.1 10000 3 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.9 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.9 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.8 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.9 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.9 Ok MYSYSTEM 192.168.56.1.1.1 10000 3 Ok MYSYSTEM 192.168.56.1.1.1 10000 1.7 Ok 5.10.2 Get the local Ams Net Id or Route Get the Local Ams Net Id PS> Get-Ams Net Id 192.168.0.2.1.1 Gets the Ams Net Id of the Local system. Get the Local System as Route object PS> Get-Ads Route -local Name Net Id Protocol TLS Address Finger Print ---- ----- -------- --- ------- ----------- MYSYSTEM 192.168.56.1.1.1 Tcp IP X 192.168.60.213 2f72d63cba30 69b5e15a3983fbfa1da7914f7c1… 5.10.3 Get information about a Twin CAT device Getting information from Broadcast Search PS> Get-Ads Route -Name CX-1CEEDA -All Name Net Id Address Sub Version RTSystem ---- ----- ------- --- ------- -------- CX-1CEEDA 5.16.136.222.1.1 192.168.0.139 3.1.4020 Win7 Getting extended information about the Hardware, Image and OS PS> Get-Tc Target Info Target Net Id Version OS Image Device CPUArch System Id Fingerprint ------ ----- ------- -- ----- ------ ------- -------- ----------- CX_1111 192.168.0.1.1.1 3.1.4026.2 Win10 AMD64 5b42297a-a9dd-6623-1780- e52074e54f71 2f72d63cba3069b5e1… TE1000 Version: 1.4.2 27
## Page 28

How To Getting Twin CAT License information PS> $session = New-Tc Session -Route TC3TESTA1-CP67X -Port 30 PS> Get-Tc License -Status All -name *scope* -session $session Name Valid Validity Code Expire Time Available Used Volume No ---- ----- ------------ ---------- --------- ---- -------- TC3 Scope Server X Valid CPU License 0 0 TC3 Scope View Professional X Valid CPU License 0 0 Create a session to the License Server on target 'TC3TESTA1-CP67X' and return all valid and invalid licenses that contain 'scope' in their name. Getting actual Twin CAT Router information of a target system PS> Get-Tc Router Info Target Result Total Mem(kb) Avail Mem(kb) Ports Drivers Transports Mailbox Size(kb) Mailbox Queue ------ ------ ------------- ------------- ----- ------- ---------- ----------------- ------------- CX_1234 Ok 32768 32759 31 4 11 0 0 Get router information from the local system. 5.10.4 Accessing Symbolic Information Getting Root Symbols PS> Get-Tc Symbol -port 851 Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ tc2v Bool BOOL 1 .tc2v Bool tc2v Int INT 2 .tc2v Int Constants 0 Constants GVL 0 GVL MAIN 0 MAIN Slow 0 Slow Twin CAT_System Info Var List 0 Twin CAT_System Info Var List Get the root symbolic information from the local system (Port 851): Browsing through Symbols recursively and filter with wildcards PS> $session = New-Tc Session -Name 'CX_123456' -port 851 PS> $session | Get-Tc Symbol -recurse | where Instance Name -like 'Project*' Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name Gets an ADS-Session/Connection to the target system CX_123456 on port 851, downloads the symbol information recursively and returns all Instances where the instance name is like the pattern 'Project*'. Browsing Data Types PS> Get-Tc Data Type -port 851 Name Size Category Base Type ---- ---- -------- -------- BYTE 1 Primitive WORD 2 Primitive DINT 4 Primitive UDINT 4 Primitive DWORD 4 Primitive E_Byte Enum 1 Enum BYTE FB_Test 12424 Struct PLC. Plc App System Info 256 Struct PLC. Plc Task System Info 128 Struct POINTER TO BYTE 4 Pointer BYTE R_Range 2 Alias INT (-6..12) REFERENCE TO BOOL 4 Reference BOOL ST_Simple Struct 166 Struct 28 Version: 1.4.2 TE1000
## Page 29

How To STRING(80) 81 String ... 5.10.5 Getting Realtime Performance Information Get the Realtime CPU Settings PS> Get-RTime Cpu Settings Net Id Windows Non Win Real Time Cpu Type Cpu Cpu Frequency Cores Cores Cores Family (GHz) ----- ---------- ---------- ---------- -------- -------- ------------ 172.17.60.167.1.1 22 2 1 0 4 3793 Getting the CPU Settings of the local system. Get the Realtime Latency of the CPU PS> Get-RTime Latency Net Id Core Id Latency Max Latency Limit (us) (us) ---------------- ------ ---------- ---------- ----- 5.91.172.198.1.1 1 0 20 0 Getting the Realtime latency of all Realtime cores on the local system. Test the Realtime Latency of specific CPU cores. PS> Get-RTime Latency -Net Id 5.91.172.198.1.1 -core 1 -count 5 -Delay 0 Net Id Core Id Latency Max Latency Limit (us) (us) ---------------- ------ ---------- ---------- ----- 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 Get the Realtime Latency of the System with Net Id 5.91.172.198.1.1 and Core Id 1 5 times without delay between values. Get Realtime Performance Date of all CPU cores. PS> Get-RTime Performance Net Id Core Id Last Delay Max Delay Delay Limit Load (%) Max Load (us) (us) (us) (%) ----- ------ ---------- ---------- ---------- -------- -------- 192.168.0.2.1.1 1 0 109 0 0 80 192.168.0.2.1.1 2 0 109 0 0 80 Getting the Performance Data from all Realtime CPUs on the local target system. Test Realtime Performance Data of specific CPU cores. PS> Get-RTime Performance -core 1 -count 5 -Delay 0 -no Reset Net Id Core Id Last Delay Max Delay Delay Limit Load (%) Max Load (us) (us) (us) (%) ----- ------ ---------- ---------- ---------- -------- -------- 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 Getting the Performance Data from the local System (Core 1) 5 times as fast as possible. TE1000 Version: 1.4.2 29
## Page 30

How To The Max Delay will not be reset on each call. 30 Version: 1.4.2 TE1000
## Page 31

Tc Xae Mgmt Version 6. X 6 Tc Xae Mgmt Version 6. X This is the Platform independent version of the ‘Tc Xae Mgmt’ Module. This can run on all Platforms that are supported by ‘Microsoft Powershell’ and ‘Windows Powerhell’ >= Version 5. Differences between Microsoft Powershell and Windows Powershell are documented here. Supported Twin CAT Versions are Twin CAT 3.1.4024 and newer. If an older Version of Twin CAT is installed locally, please use the Version 3. X series of the ‘Tc Xae Mgmt’ module. 6.1 Ads File Provider PS> New-PSDrive -name CX_01234 -PSProvider Ads File Provider -Address CX_01234 -Root '' PS> dir CX_01234: Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 30.11.2021 16:11:31 Boot Dir d---- 03.12.2021 01:17:20 Boot Project d---- 17.03.2021 14:33:53 Config Dir d---- 03.12.2021 01:17:20 Generic d---- 18.06.2021 08:00:22 Install Dir d---- 03.12.2021 01:17:20 Repository Dir d---- 03.12.2021 15:32:03 Target Dir > cd CX_01234:/Boot Dir PS CX_01234:\Boot Dir> dir Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 05.10.2021 10:36:34 Current Config -a--- 05.10.2021 10:36:34 4563 Current Config.tszip -a--- 05.10.2021 10:36:34 17113 Current Config.xml -a--- 30.11.2021 16:11:31 126976 Logged Events.db d---- 27.10.2021 11:32:43 Plc More Information about Providers PS> get-help about_providers Example: Create a new Ads File Provider Drive to the Twin CAT Device CX_01234 > New-PSDrive -name CX_01234 -PSProvider Ads File Provider -Address CX_01234 -Root '' Name Used (GB) Free (GB) Provider Root Current Location ---- --------- --------- -------- ---------- --------------- CX_01234 Ads File Provider \Target Dir Example: Browse the files on the Twin CAT Device CX_01234 > dir Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 26.11.2021 17:44:27 CACerts -a--- 14.03.2012 14:50:50 619 Default Config.xml d---- 11.05.2021 14:42:45 License d---- 18.06.2021 08:01:03 Resource d---- 17.03.2021 15:15:51 Routes d---- 18.06.2021 08:00:33 Start Menu Admin d---- 17.03.2021 14:33:35 Start Up -a--- 30.11.2021 18:46:08 2253 Static Routes.xml -a--- 01.02.2012 16:42:58 494 Target Features.xml -a--- 17.03.2021 14:42:50 3113 Tc Self Signed.xml Example: Read the content of the Static Routs.xml on target CX_01234 r> get-content .\Static Routes.xml <?xml version="1.0"?> <Tc Config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> TE1000 Version: 1.4.2 31
## Page 32

Tc Xae Mgmt Version 6. X <Remote Connections> <Route> <Name>Target IPC</Name> <Address>172.17.60.147</Address> <Net Id>172.17.60.147.1.1</Net Id> <Type>TCP_IP</Type> <Tls Ignore Cn="true"> <Ca>...</Ca> </Tls> </Route> <Server> <Tls Ignore Cn="true"> <Ca>c:\twincat\3.1\target\CACerts\Root CA.pem</Ca> <Cert>c:\twincat\3.1\target\CACerts\Target IPC.crt</Cert> <Key>c:\twincat\3.1\target\CACerts\Target IPC.key</Key> </Tls> </Server> </Remote Connections> </Tc Config> 6.2 Ads Symbol Provider Binds the target device symbolic information to a PSDrive. To register a symbol server as PSDrive type (here the Target Route 'CX_01234' with Ams Port: 851) PS> New-PSDrive -Name CX_01234_Symbols -PSProvider Ads Symbol Provider -Address CX_01234 -Port 851 - Root PS> cd CX_01234_Symbols: PS> CX_01234_Symbols:> dir 6.3 Tc Xae Mgmt about_Tc Xae Mgmt Power Shell Twin CAT XAE Management Console (Tc Xae Mgmt) SHORT DESCRIPTION Cmdlets for managing and accessing ADS Routes, Reading/Writing Values and managing Remote targets. LONG DESCRIPTION The Powershell Twin CAT Management Console is a Power Shell module that provides a number of useful cmdlets for Twin CAT System Management and for communicating with ADS devices over the ADS protocol. This includes the following tasks/features: • Establishing/Removing Route Connections (Add-Ads Route, Remove-Ads Route) • Browsing Routes locally and within the network (Broadcast Search, Get-Ads Route) • Getting remote device states and information (Get-Ads State, Get-Tc Target Info, Get-Tc Version Info) • Establishing and Closing Remote communication sessions (New-Tc Session,Get-Tc Session,Close- Tc Session) • Browsing Symbol Information (Get-Tc Symbol, Get-Tc Data Type) • Reading/Writing raw and symbolic values (Read-Tc Value, Write-Tc Value, Send-Tc Read Write) • Uploading/Downloading files to/from remote devices (Copy-Ads File) • Browsing License information (Get-Tc License) This Module is usable under all Powershell Version \>= 5.1 including 'Windows Powershell' and 'Powershell Core' Versions. 32 Version: 1.4.2 TE1000
## Page 33

Tc Xae Mgmt Version 6. X As Prerequisite the Tc Xae Mgmt Module needs a local Twin CAT installation larger equals than Twin CAT 4024.10. There are no limitations to access other/older Twin CAT Versions remotely. PREREQUISITES \>= Twin CAT 3.1.4024.10 (XAR Runtime or Full) (local installation) POWERSHELL COMPATIBILITY \>= Windows Powershell 5.1 \>= Powershell (Core) 6.0 CMDLETS To see what cmdlets are provided by the Tc Xae Mgmt Module, execute the command: PS> Get-Command -Module Tc Xae Mgmt -Command Type Cmdlet The actual Tc Xae Mgmt cmdlets are listed below: Add-Ads Route [} 80] Cmdlet for adding Twin CAT Routes. Add-Mqtt Route [} 92] Adds an MQTT route to the destination system. Close-Tc Session [} 96] Closes the specified session. Copy-Ads File [} 98] Uploads / Downloads files from/to Twin CAT target. Get-Ads Remote Connections Get-Ads Route [} 101] List routes on a Twin CAT System / Broadcast search. Get-Ads State [} 106] Gets the Ads State of a Twin CAT Target. Get-Ams Net Id Get the local Net Id of the Twin CAT System. Get-Ams Router Endpoint [} 110] Get the actual Ams Configuration / Router Endpoint of the process. Get-Ec Boxes [} 111] Gets the Ether CAT Boxes actually loaded on the specified target system. TE1000 Version: 1.4.2 33
## Page 34

Tc Xae Mgmt Version 6. X Get-Ec Frame Statistics [} 113] Gets the Ether CAT Frame statistics from an Ether CAT master. Get-Ec Master [} 115] Gets actually loaded Ether CAT Master devices on the target system. Get-IODevice [} 118] Gets actually loaded IO Devices of the target system. Get-Io Free Run [} 121] Gets the IO Free Run State of the specified target. Get-Mqtt Route [} 123] Remove a MQTT Route. Get-RTime Cpu Settings [} 124] Getting the Cpu Settings of the Twin CAT System Get-RTime Latency [} 126] Get the latency of Twin CAT Realtime Cores of the specified Twin CAT target system. Get-RTime Performance [} 130] Gets the Realtime Performance of the specified system. Get-Tc Data Type [} 133] Get the Data Types from a Twin CAT target system / Device. Get-Tc Event [} 137] Gets Twin CAT events from event logs on local and remote computers. Get-Tc License [} 141] Get Twin CAT License information. Get-TCom Object Gets the actual loaded TCOM objects in the Twin CAT environment. Get-Tc Router Info [} 146] Gets the router status information of the specified target system. Get-Tc Session [} 149] List the currently established Sessions. Get-Tc Symbol [} 150] Get the symbols from a Twin CAT target system / Device. 34 Version: 1.4.2 TE1000
## Page 35

Tc Xae Mgmt Version 6. X Get-Tc Symbol Statistics Get the Symbol statistics from a Twin CAT target system / Device. Get-Tc Target Info [} 156] Get Twin CAT Device Target information. Get-Tc Version [} 159] Get the Twin CAT Version of a target system. New-Tc Session [} 162] Create a new session to a Twin CAT Target. Read-Tc Value [} 165] Reads values from Twin CAT devices. Register-Ads Handle [} 172] Registers and returns a symbol handle. Register-Ads Nat Route [} 176] Changes an standard Route to an Ams NAT route on the target system (obsolete). Remove-Ads Route [} 179] Remove an ADS Route. Remove-Mqtt Route [} 182] Remove a MQQT Route. Reset-Io Free Run [} 185] Resets the IO Free Run state on the specified target. Restart-Ads Computer [} 188] Restarts ("reboots") the operating system on local and remote Twin CAT computers. Restart-Twin CAT Restarts or Resets a specified Twin CAT System. Send-Tc Read Write [} 192] Sends a Read/Write access to ADS Server / Twin CAT Devices. Set-Ads Route Property Sets route properties. Set-Ads State [} 199] Writes a Ads State control request to the specified target. TE1000 Version: 1.4.2 35
## Page 36

Tc Xae Mgmt Version 6. X Set-Ams Net Id Sets the Ams Net Id of a device. Set-Ams Router Endpoint [} 205] Sets the Ams Configuration (Loopback address and port, Router Endpoint). Set-Io Free Run [} 207] Sets the IO Free Run state of the target. Set-RTime Cpu Settings Sets the Windows (Shared) CPU cores and Isolated cores for Twin CAT. Start-Ads Process Start a process via ADS on the target system. Stop-Ads Computer [} 210] Stops (shuts down) local and remote Twin CAT computers. Test-Ads Route [} 214] Test the specified route connection. Unregister-Ads Handle [} 219] Unregisters a symbol handle. Write-Tc Value [} 222] Write values to Twin CAT devices. EXAMPLES Getting Route PS> $route = get-adsroute TC3TEST* PS> $route Name Net Id Address Sub Version RTSystem ---- ----- ------- --- ------- -------- TC3TESTA1-CP67X 172.17.62.105.1.1 172.17.62.105 0.0 Unknown Create Session PS> $session = New-Tc Session -Route $route -Port 851 PS> $session ID Address Is Connected Established At -- ------- ----------- ------------- 1 172.17.62.105.1.1:851 True 12/12/2016 12:22:02 PM Read Ads Value (Struct) PS> $v1 = Read-Tc Value -Session Id 1 -Path "GVL.vg Struct" PS> $v1 v Bool : True v Byte : 123 v Word : 12345 v DWord : 12345678 v SInt : -121 36 Version: 1.4.2 TE1000
## Page 37

Tc Xae Mgmt Version 6. X v USInt : 212 v Int : -12121 v UInt : 21212 v DInt : -1212121 v UDInt : 2121212 v Real : 123,456 v LReal : 1234567890,12346 v String : QWERTZUIOPÃœASDFGHJKLÃ–Ã„YXCVBNM;:_ v Time : 01:02:03.0040000 v Tod : 23:45:06.7890000 v Date : 17.11.2005 00:00:00 v DT : 17.11.2005 12:34:56 v Alias : 8 v Enum : 8 v Range : 7 PSValue : ... Read Ads Value (Boolean) PS> $v2 = Read-Tc Value -Session Id 1 -Path "Main.b Change" PS> $v2 False Read Ads Value (Array of Strings) PS> $v3 = Read-Tc Value -Session Id 1 -path "GVL.vga String" Dimensions Elements PSValue ---------- -------- ------- {Twin CAT. Type System. Dimension} {QWERTZUIOPÃœASDFGHJKLÃ–Ã„YXCVBNM;:_, _:;MNBVCXYÃ„Ã– LKJHGFDSAÃœPOIUZTREWQ} ... Read Array Of Structs PS> $v4 = Read-Tc Value -Session Id 1 -path "GVL.vgastruct" Dimensions Elements ---------- -------- {Twin CAT. Type System. Dimension} {@{v Bool=True; v Byte=123; v Word=12345; v DWord=12345678; v SInt=-121; v USInt=212; v Int=-12121; v UInt=21212; v DInt=-1212121; v UD... Dump Array Elements PS> $v4. Dimensions. Element Count 2 PS> $v4. Elements v Bool : True v Byte : 123 v Word : 12345 v DWord : 12345678 v SInt : -121 v USInt : 212 v Int : -12121 v UInt : 21212 v DInt : -1212121 v UDInt : 2121212 v Real : 123,456 v LReal : 1234567890,12346 v String : QWERTZUIOPÃœASDFGHJKLÃ–Ã„YXCVBNM;:_ v Time : 01:02:03.0040000 v Tod : 23:45:06.7890000 v Date : 17.11.2005 00:00:00 v DT : 17.11.2005 12:34:56 v Alias : 8 v Enum : 8 v Range : 7 PSValue : ... v Bool : False v Byte : 234 TE1000 Version: 1.4.2 37
## Page 38

Tc Xae Mgmt Version 6. X v Word : 23456 v DWord : 23456789 v SInt : 121 v USInt : 131 v Int : 12121 v UInt : 13131 v DInt : 1212121 v UDInt : 1313131 v Real : 456,321 v LReal : 987654321,123457 v String : _:;MNBVCXYÃ„Ã–LKJHGFDSAÃœPOIUZTREWQ v Time : 11:22:33.0440000 v Tod : 11:22:33.4440000 v Date : 22.01.1999 00:00:00 v DT : 22.01.1999 11:22:33 v Alias : 9 v Enum : 9 v Range : -5 PSValue : ... ## Browse Data Types (Query by Category) PS> $session | Get-Tc Data Type | where Category -eq "Array" } Name Size Category Comment Element Type Dimensions Mem bers ---- ---- -------- ------- ----------- ---------- ------- ARRAY [-1..1] OF INT 6 Array INT {Twin CAT. Type... ARRAY [-10..-8] OF BOOL 3 Array BOOL {Twin CAT. Type... ARRAY [0..1] OF A_Alias 4 Array A_Alias {Twin CAT. Type... Browse Data Types by name PS> $session | Get-Tc Data Type -name "Array*" Browse all Symbols recursively PS> $session | Get-Tc Symbol -recurse ... returns all symbols Browse Symbols recursivly by Symbol Path (Here specific array index 'Task Info[1]'( PS> $session | Get-Tc Symbol -recurse -path "*Task Info``[1``]*","*. Project Name" Instance Name Data Type Size Instance Path Comment ------------ -------- ---- ------------ ------- Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name _Task Info[1] PLC. Plc Task System Info 128 Twin CAT_System Info Var List._Task Info[1] Obj Id OTCID 4 Twin CAT_System Info Var List._Task Info[1]. Obj Id Cycle Time UDINT 4 Twin CAT_System Info Var List._Task Info[1]. Cycle Time Priority UINT 2 Twin CAT_System Info Var List._Task Info[1]. Priority Ads Port UINT 2 Twin CAT_System Info Var List._Task Info[1]. Ads Port Cycle Count UDINT 4 Twin CAT_System Info Var List._Task Info[1]. Cycle Count Dc Task Time LINT 8 Twin CAT_System Info Var List._Task Info[1]. Dc Task Time Last Exec Time UDINT 4 Twin CAT_System Info Var List._Task Info[1]. Last Exec Ti me First Cycle BOOL 1 Twin CAT_System Info Var List._Task Info[1]. First Cycle Cycle Time Exceeded BOOL 1 Twin CAT_System Info Var List._Task Info[1]. Cycle Time E xceeded In Call After Output Update BOOL 1 Twin CAT_System Info Var List._Task Info[1]. In Call Afte r Output Update RTViolation BOOL 1 Twin CAT_System Info Var List._Task Info[1]. RTViolatio n Task Name STRING(63) 64 Twin CAT_System Info Var List._Task Info[1]. Task Name Browse only Symbols ending with path *. Project Name PS>$project = Get-Tc Symbol -Session $session -recurse -path "*. Project Name" Instance Name Data Type Size Instance Path Comment ------------ -------- ---- ------------ ------- Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name 38 Version: 1.4.2 TE1000
## Page 39

Tc Xae Mgmt Version 6. X Ads Read Project Name PS>$project | Read-Tc Value -Session $session ADS_Dyn Symbols Ads Write Project Name PS>$project | Write-Tc Value -Session $session -Value "New Project Name" PS>$project | Read-Tc Value -Session $session New Project Name Read Write by Symbol Path PS>Read-Tc Value -Session Id 1 -Path "Main.b Change" false PS>Write-Tc Value -Session Id 1 -Symbol "Main.b Change" -Value True PS>Read-Tc Value -Session Id 1 -Path "GVL.vg Bool" PS>Write-Tc Value -Session Id 1 -Path "GVL.vg Bool" -value $true Read Write by Piping PS> $project Name Symbol = $session | Get-Tc Symbol -Recurse -path "*Project Name" PS> $project Name Symbol | Read-Tc Value -Session Id 1 PS> $project Name Symbol | Write-Tc Value -Session Id 1 -Value "New Project Name" PS> $project Name Symbol | Read-Tc Value -Session Id 1 Get Target Information PS> get-adsroute | Get-Tc Target Info Target Version Level OS Image Device CPUArch ------ ------- ----- -- ----- ------ ------- TC3TESTA1-CP67X 3.1.4021.131 CP Win7 Intel X86 PS> get-adsroute | Get-Tc Version Major Minor Build Revision ----- ----- ----- -------- 3 1 4021 131 PROVIDERS The Tc Xae Mgmt module includes the Ads Symbol Provider and the Ads File Provider Ads Symbol Provider Binds the target device symbolic information to a PSDrive. To register a symbol server as PSDrive type (here the Target Route 'CX_01234' with Ams Port: 851) PS> New-PSDrive -Name CX_01234_Symbols -PSProvider Ads Symbol Provider -Address CX_01234 -Port 851 - Root PS> cd CX_01234_Symbols: PS> CX_01234_Symbols:> dir Ads File Provider PS> New-PSDrive -name CX_01234 -PSProvider Ads File Provider -Address CX_01234 -Root '' PS> dir CX_01234: Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 30.11.2021 16:11:31 Boot Dir d---- 03.12.2021 01:17:20 Boot Project d---- 17.03.2021 14:33:53 Config Dir d---- 03.12.2021 01:17:20 Generic d---- 18.06.2021 08:00:22 Install Dir d---- 03.12.2021 01:17:20 Repository Dir d---- 03.12.2021 15:32:03 Target Dir TE1000 Version: 1.4.2 39
## Page 40

Tc Xae Mgmt Version 6. X > cd CX_01234:/Boot Dir PS CX_01234:\Boot Dir> dir Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 05.10.2021 10:36:34 Current Config -a--- 05.10.2021 10:36:34 4563 Current Config.tszip -a--- 05.10.2021 10:36:34 17113 Current Config.xml -a--- 30.11.2021 16:11:31 126976 Logged Events.db d---- 27.10.2021 11:32:43 Plc More Information about Providers PS> get-help about_providers Example: Create a new Ads File Provider Drive to the Twin CAT Device CX_01234 > New-PSDrive -name CX_01234 -PSProvider Ads File Provider -Address CX_01234 -Root '' Name Used (GB) Free (GB) Provider Root Current Location ---- --------- --------- -------- ---------- --------------- CX_01234 Ads File Provider \Target Dir Example: Browse the files on the Twin CAT Device CX_01234 > dir Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 26.11.2021 17:44:27 CACerts -a--- 14.03.2012 14:50:50 619 Default Config.xml d---- 11.05.2021 14:42:45 License d---- 18.06.2021 08:01:03 Resource d---- 17.03.2021 15:15:51 Routes d---- 18.06.2021 08:00:33 Start Menu Admin d---- 17.03.2021 14:33:35 Start Up -a--- 30.11.2021 18:46:08 2253 Static Routes.xml -a--- 01.02.2012 16:42:58 494 Target Features.xml -a--- 17.03.2021 14:42:50 3113 Tc Self Signed.xml Example: Read the content of the Static Routs.xml on target CX_01234 r> get-content .\Static Routes.xml <?xml version="1.0"?> <Tc Config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <Remote Connections> <Route> <Name>Target IPC</Name> <Address>172.17.60.147</Address> <Net Id>172.17.60.147.1.1</Net Id> <Type>TCP_IP</Type> <Tls Ignore Cn="true"> <Ca>...</Ca> </Tls> </Route> <Server> <Tls Ignore Cn="true"> <Ca>c:\twincat\3.1\target\CACerts\Root CA.pem</Ca> <Cert>c:\twincat\3.1\target\CACerts\Target IPC.crt</Cert> <Key>c:\twincat\3.1\target\CACerts\Target IPC.key</Key> </Tls> </Server> </Remote Connections> </Tc Config> FEEDBACK Please submit any feedback, including defects and enhancement requests, to 40 Version: 1.4.2 TE1000
## Page 41

Tc Xae Mgmt Version 6. X support@beckhoff.com We are also interested in suggestions you may have for cmdlets. Over time, we hope to be able to add some more features. NOTE To see what functions are provided by Tc Xae Mgmt, execute the command: PS> Get-Command -Module Tc Xae Mgmt -Command Type Function For more information, most of the cmdlets have help associated with them e.g.: PS> Get-Help Add-Ads Route -full The definitive information on a cmdlet's parameters can be obtained by executing: PS> Get-Command Add-Ads Route -syntax or more tersely: PS> gcm Add-Ads Route -syn SEE ALSO Documentation Tc Xae Mgmt Module About the Tc Xae Mgmt Module Beckhoff Homepage PS> get-help about_providers KEYWORDS • ADS • Twin CAT • Management Console • Routes 6.4 Get-Ams Net Id SYNOPSIS Get the local Net Id of the Twin CAT System. SYNTAX Get-Ams Net Id [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet returns the Ams Net Id of the local Twin CAT System. For getting more information about the local system the Cmdlets 'Get-Ads Route -local' or 'Get-Tc Target Info' can be used. TE1000 Version: 1.4.2 41
## Page 42

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Get-Ams Net Id 192.168.0.2.1.1 Gets the Ams Net Id of the Local system. PARAMETERS -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.5 Restart-Twin CAT SYNOPSIS Restarts or Resets a specified Twin CAT System. SYNTAX Net Id (Default) Restart-Twin CAT [[-Net Id] <Ams Net Id[]>] [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [- No Reinit] [-No Wait] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Command <Twin CATRestart Command>] [-Throw Error] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Restart-Twin CAT [-Input Object] <IRoute[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [- No Reinit] [-No Wait] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Command <Twin CATRestart Command>] [- Throw Error] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] 42 Version: 1.4.2 TE1000
## Page 43

Tc Xae Mgmt Version 6. X Address Str Restart-Twin CAT [-Address] <String[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [- No Reinit] [-No Wait] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Command <Twin CATRestart Command>] [-Throw Error] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Restart-Twin CAT -Session <ISession[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [- No Reinit] [-No Wait] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Command <Twin CATRestart Command>] [-Throw Error] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Restart-Twin CAT -Session Id <Int32[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [- No Reinit] [-No Wait] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Command <Twin CATRestart Command>] [-Throw Error] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet Restarts or Resets the specified Twin CAT System dependant of its command parameter. The Twin CAT system will end up in ADS State 'Run' or 'Config'. EXAMPLES EXAMPLE 1 PS> Restart-Twin CAT -command Restart -force Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X CX_1111 192.168.0.2.1.1 10000 Succeeded Reset Run Run 2853 Restarts the local Twin CAT System. The 'X' in the 'Ok' Column indicates the success. EXAMPLE 2 PS> Restart-Twin CAT -command Restart -force WARNING: 192.168.0.2.1.1:10 ERR | 18:26:28:108 |'TCOM Server' (10): Device 1 (Ether CAT) (Adapter): Failed to connect to network adapt er! WARNING: 192.168.0.2.1.1:10 WRN | 18:26:28:108 |'TCOM Server' (10): PREOP to SAFEOP of 'Device 1 (Ether CAT) (Adapter)' (0x03010011) f ailed - 'request is aborted' 0x9811071F WARNING: 192.168.0.2.1.1:10000 ERR | 18:26:28:117 |'Twin CAT System' (10000): Sending ams command >> Init12\IO: Set State TCom Obj SAFEOP: Set Objects (4) to SAFEOP >> Ads Error: 1823 (0x71f, ADS ERROR: device aborted the action) << failed ! Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ CX_1111 192.168.0.2.1.1 10000 Succeeded Reset Config Config 3427 Calls a Reset to the local System Service that fails!. Error log messages will be logged out. EXAMPLE 3 PS> Restart-Twin CAT -command Restart -force | select-object -Expand Property Log Messages WARNING: 192.168.0.2.1.1:10 ERR | 18:20:45:969 |'TCOM Server' (10): Device 1 (Ether CAT) (Adapter): Failed to connect to network adapt er! TE1000 Version: 1.4.2 43
## Page 44

Tc Xae Mgmt Version 6. X WARNING: 192.168.0.2.1.1:10 WRN | 18:20:45:969 |'TCOM Server' (10): PREOP to SAFEOP of 'Device 1 (Ether CAT) (Adapter)' (0x03010011) f ailed - 'request is aborted' 0x9811071F WARNING: 192.168.0.2.1.1:10000 ERR | 18:20:45:979 |'Twin CAT System' (10000): Sending ams command >%gt; Init12\IO: Set State TCom Obj SAFE OP: Set Objects (4) to SAFEOP >%gt; Ads Error: 1823 (0x71f, ADS ERROR: device aborted the action) << failed! Type Time Stamp Device Name Port Message ---- --------- ---------- ---- ------- Message 18:20:44.874 Twin CAT System 10000 Twin CAT System Restart initiated from Ams Net Id: 192.168.0. 2.1.1 port 34564. Message 18:20:44.879 Twin CAT System 10000 Saving configuration of COM server Tc Vn Service ! Message 18:20:44.880 Twin CAT System 10000 Saving configuration of COM server Tc Event Logger ! Message 18:20:44.970 Twin CAT System 10000 Shutting down COM Server Tc Vn Service ! Message 18:20:44.971 Twin CAT System 10000 Shutting down COM Server Tc Event Logger ! Message 18:20:45.745 Twin CAT System 10000 Loading configuration of COM server Tc Vn Service ! Message 18:20:45.747 Twin CAT System 10000 Loading configuration of COM server Tc Event Logger ! Message 18:20:45.748 Twin CAT System 10000 Initializing COM Server Tc Vn Service ! Message 18:20:45.773 Twin CAT System 10000 Initializing COM Server Tc Event Logger ! Message 18:20:45.783 Twin CAT System 10000 Tc Io Eth Server started: Tc Io Eth. Message 18:20:45.791 Twin CAT System 10000 Tc Rts Objects Server started: Tc Rts Objects. Message 18:20:45.798 Twin CAT System 10000 Tc Io ECat Server started: Tc Io ECat. Message 18:20:45.805 Twin CAT System 10000 Tc Io Server started: Tc Io. Message 18:20:45.814 Twin CAT System 10000 Tc Plc30 Server started: Tc Plc30. Message 18:20:45.821 Twin CAT System 10000 Tc RTime Server started: Tc RTime. Message 18:20:45.927 License Server 30 license validation status is Valid(3) Error 18:20:45.969 TCOM Server 10 Device 1 (Ether CAT) (Adapter): Failed to connect to networ k adapter! Warning 18:20:45.969 TCOM Server 10 PREOP to SAFEOP of 'Device 1 (Ether CAT) (Adapter)' (0x0301 0011) failed - 'request is aborted' 0x9811071F Error 18:20:45.979 Twin CAT System 10000 Sending ams command >%gt; Init12\IO: Set State TCom Obj SAF EOP: Set Objects (4) to SAFEOP >%gt; Ads Error: 1823 (0x71f, ADS ERROR: device aborted the action) %l t;%lt; failed! Message 18:20:47.879 Twin CAT System 10000 Loading configuration of COM server Tc Vn Service Message 18:20:47.881 Twin CAT System 10000 Loading configuration of COM server Tc Event Logger Message 18:20:47.882 Twin CAT System 10000 Initializing COM Server Tc Vn Service Message 18:20:47.910 Twin CAT System 10000 Initializing COM Server Tc Event Logger Message 18:20:47.922 Twin CAT System 10000 TCIO Server started: TCIO. Message 18:20:47.931 Twin CAT System 10000 TCRTIME Server started: TCRTIME. Message 18:20:47.939 Twin CAT System 10000 TCRTSOBJECTS Server started: TCRTSOBJECTS. Message 18:20:47.948 Twin CAT System 10000 TCIOETH Server started: TCIOETH. Message 18:20:47.956 Twin CAT System 10000 TCIOECAT Server started: TCIOECAT. Message 18:20:47.963 Twin CAT System 10000 TCIODRIVERS Server started: TCIODRIVERS. Message 18:20:48.078 Twin CAT System 10000 Starting COM Server Tc Vn Service Message 18:20:48.078 Twin CAT System 10000 Starting COM Server Tc Event Logger Tries to restart the local Twin CAT system and write the log messages to the output. This Command fails. PARAMETERS -Net Id The Net Id address where to set the state (Local system by default). Multiple values are allowed. Type: Ams Net Id[] Parameter Sets: Net Id Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object Target route(s), where to set the state. Multiple values are allowed. 44 Version: 1.4.2 TE1000
## Page 45

Tc Xae Mgmt Version 6. X Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address The address of the system where to set the state. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards and multiple values are permitted. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The ADS Session to use for the Cmdlet. Multiple sessions are allowed. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the Cmdlet (multiple values are allowed) Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Quiet Sets the Quiet mode of the command. The Cmdlet then returns a $true or $false but not the actual states of the targets. The return value will be $true if all operations succeed and it will be $false if at least one have failed. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named TE1000 Version: 1.4.2 45
## Page 46

Tc Xae Mgmt Version 6. X Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -State Only This Cmdlet return only the Ads State instead of full information. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -No Reinit Activates a state check before sending Write Control if the target system is already in the expected target state Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -No Wait The -No Wait parameter skips the waiting for the target end state. If set, the Cmdlet returns immediatly after sending the Write Control request, without waiting for the state change. 46 Version: 1.4.2 TE1000
## Page 47

Tc Xae Mgmt Version 6. X Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Wait Timeout The wait timout for the state change in ms. This Cmdlet waits for the target state changes which is limited by this Wait Timeout. A value \<= 0 sets the Default (45000 ms). This parameter is only used if -No Wait is not set. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Polling Rate The Wait polling rate in Milliseconds. A value \<= 0 sets the Default polling rate (200 ms for local systems, 1000ms for remote systems). This parameter is only used, if -No Wait is not set. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Command The timeout to wait for restart. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Possible values: Restart, Reset, Reconfig, Config Type: Twin CATRestart Command Parameter Sets: (All) Aliases: Accepted values: Restart, Reset, Reconfig, Config Required: False Position: Named Default value: Restart Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 47
## Page 48

Tc Xae Mgmt Version 6. X -Throw Error Throws an error, if the target system(s) not reaching the expected state. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] Target route(s), where to set the state. 48 Version: 1.4.2 TE1000
## Page 49

Tc Xae Mgmt Version 6. X Multiple values are allowed. Twin CAT. ISession[] The ADS Session to use for the Cmdlet. Multiple sessions are allowed. OUTPUTS NOTES 6.6 Set-Ams Net Id SYNOPSIS Sets the Ams Net Id of a device. SYNTAX Net Id (Default) Set-Ams Net Id [[-Target] <Ams Net Id>] [-New Id] <Ams Net Id> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Set-Ams Net Id [-New Id] <Ams Net Id> [-Input Object] <IRoute> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Set-Ams Net Id [-New Id] <Ams Net Id> [-Address] <String> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Set-Ams Net Id [-New Id] <Ams Net Id> -Session <ISession> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Set-Ams Net Id [-New Id] <Ams Net Id> -Session Id <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet configurates the Ams Net Id (Target Net Id) of a device. A reboot is necessary after configuration (e.g. with 'Restart-Ads Computer') To contact the target system, it must be available as actual route. All actual connections to that systems via ADS are not valid anymore after calling this Cmdlet. EXAMPLES EXAMPLE 1 PS> Set-Ams Net Id -New Id 1.1.1.1.1.1 Changeing Ams Net Id of target system. Change the Net Id of system '192.168.0.2.1.1' to '1.1.1.1.1.1' TE1000 Version: 1.4.2 49
## Page 50

Tc Xae Mgmt Version 6. X [Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "Y"): y Changing the Net Id of system '192.168.0.2.1.1' to '1.1.1.1.1.1' is succeeded. All preexisting connec tions to this system a invalid now. A reboot of this system is necessary! Sets the Ams Net Id of the Local system to '1.1.1.1.1.1'. PARAMETERS -Target Net Id of the target system. Type: Ams Net Id Parameter Sets: Net Id Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -New Id The New Net Id. Type: Ams Net Id Parameter Sets: (All) Aliases: Required: True Position: 2 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The route object where to set the CPUs. This parameter support pipelining. Type: IRoute Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Target names/addresses where to configure the CPU. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True 50 Version: 1.4.2 TE1000
## Page 51

Tc Xae Mgmt Version 6. X -Session The Session where to configure the CPU (supports pipeline) Type: ISession Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) where to configure the CPU Core settings. Type: Int32 Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Forces this command. It suppresses the Should Continue settings and bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False TE1000 Version: 1.4.2 51
## Page 52

Tc Xae Mgmt Version 6. X Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute The route object where to set the CPUs. This parameter support pipelining. Twin CAT. ISession The Session where to configure the CPU (supports pipeline) OUTPUTS NOTES 6.7 Set-RTime Cpu Settings SYNOPSIS Sets the Windows (Shared) CPU cores and Isolated cores for Twin CAT. 52 Version: 1.4.2 TE1000
## Page 53

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port Shared (Default) Set-RTime Cpu Settings [[-Net Id] <Ams Net Id>] -Shared Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id Port Isolated Set-RTime Cpu Settings [[-Net Id] <Ams Net Id>] -Isolated Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id Port Reset Set-RTime Cpu Settings [[-Net Id] <Ams Net Id>] [-Reset] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Shared Set-RTime Cpu Settings [-Input Object] <IRoute> -Shared Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Isolated Set-RTime Cpu Settings [-Input Object] <IRoute> -Isolated Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Reset Set-RTime Cpu Settings [-Input Object] <IRoute> [-Reset] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Shared Set-RTime Cpu Settings [-Address] <String> -Shared Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Isolated Set-RTime Cpu Settings [-Address] <String> -Isolated Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Reset Set-RTime Cpu Settings [-Address] <String> [-Reset] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Shared Set-RTime Cpu Settings -Session <ISession> -Shared Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Isolated Set-RTime Cpu Settings -Session <ISession> -Isolated Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Reset Set-RTime Cpu Settings -Session <ISession> [-Reset] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] TE1000 Version: 1.4.2 53
## Page 54

Tc Xae Mgmt Version 6. X Session Id Shared Set-RTime Cpu Settings -Session Id <Int32> -Shared Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Isolated Set-RTime Cpu Settings -Session Id <Int32> -Isolated Cores <Int32> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Reset Set-RTime Cpu Settings -Session Id <Int32> [-Reset] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet configurates the CPU settings. A reboot is necessary after configuration. EXAMPLES EXAMPLE 1 PS> Set-RTime Cpu Settings -Shared Cores 6 Setting CPU cores Setting Windows Cores: 6, Isolated Cores: 6 to device '172.17.62.146.1.1'? [Y] Yes [A] Yes to All [N] No [L] No to All [S] Suspend [?] Help (default is "Y"): y Number of processors successfully set to '6'. A reboot is necessary to activate settings! Sets the CPU Core Settings to 6 Shared and 6 Isolated on a 12 Core System PARAMETERS -Net Id Net Id of the target system. Type: Ams Net Id Parameter Sets: Net Id Port Shared, Net Id Port Isolated, Net Id Port Reset Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The route object where to set the CPUs. This parameter support pipelining. Type: IRoute Parameter Sets: Route Shared, Route Isolated, Route Reset Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False 54 Version: 1.4.2 TE1000
## Page 55

Tc Xae Mgmt Version 6. X -Address Target names/addresses where to configure the CPU. Wildcards are permitted. Type: String Parameter Sets: Address Str Shared, Address Str Isolated, Address Str Reset Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session where to configure the CPU (supports pipeline) Type: ISession Parameter Sets: Session Shared, Session Isolated, Session Reset Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) where to configure the CPU Core settings. Type: Int32 Parameter Sets: Session Id Shared, Session Id Isolated, Session Id Reset Aliases: Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Shared Cores The number of shared windows cores (Isolated cores will be: isolated Cores = all Cores - shared Cores. Type: Int32 Parameter Sets: Net Id Port Shared, Route Shared, Address Str Shared, Session Shared, Session Id Shared Aliases: Required: True Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Isolated Cores Number of Isolated cores. Shared cores will be: shared Cores = all Cores - isolated Cores. Type: Int32 Parameter Sets: Net Id Port Isolated, Route Isolated, Address Str Isolated, Session Isolated, Session Id Isol ated Aliases: Required: True Position: Named Default value: 0 TE1000 Version: 1.4.2 55
## Page 56

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Reset Resets the number of shared cores. After reboot all Cores are dedicated to windows (shared). Type: Switch Parameter Parameter Sets: Net Id Port Reset, Route Reset, Address Str Reset, Session Reset, Session Id Reset Aliases: Required: True Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Forces this command. It suppresses the Should Continue settings and bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False 56 Version: 1.4.2 TE1000
## Page 57

Tc Xae Mgmt Version 6. X -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute The route object where to set the CPUs. This parameter support pipelining. Twin CAT. ISession The Session where to configure the CPU (supports pipeline) OUTPUTS NOTES 6.8 Start-Ads Process SYNOPSIS Start a process via ADS on the target system. SYNTAX Net Id Port (Default) Start-Ads Process [[-Net Id] <Ams Net Id[]>] -File Path <String> [-Argument List <String[]>] [- Working Dir <String>] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] TE1000 Version: 1.4.2 57
## Page 58

Tc Xae Mgmt Version 6. X Route Start-Ads Process [-Input Object] <IRoute[]> -File Path <String> [-Argument List <String[]>] [- Working Dir <String>] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Start-Ads Process [-Address] <String[]> -File Path <String> [-Argument List <String[]>] [- Working Dir <String>] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Start-Ads Process -Session <ISession[]> -File Path <String> [-Argument List <String[]>] [- Working Dir <String>] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Start-Ads Process -Session Id <Int32[]> -File Path <String> [-Argument List <String[]>] [- Working Dir <String>] [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet starts a processs on the Target system. EXAMPLES EXAMPLE 1 PS> Start-Ads Process -Address CX_1234 -path "notepad.exe" Starts the notepad.exe on the target system. PARAMETERS -Net Id Net Id(s) of the target system. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The route object where to get the Target information from.. Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False 58 Version: 1.4.2 TE1000
## Page 59

Tc Xae Mgmt Version 6. X -Address Target names/addresses. These can consist of Route Name, Net ID, Host Name or IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the value read. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the value read. Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -File Path Path to the executable of the target system. Type: String Parameter Sets: (All) Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Argument List Specifies parameters or parameter values to use when this cmdlet starts the process. Arguments can be accepted as a single string with the arguments separated by spaces, or as an array of strings separated by commas. The cmdlet joins the array into a single string with each element of the array separated by a single space. Type: String[] Parameter Sets: (All) Aliases: TE1000 Version: 1.4.2 59
## Page 60

Tc Xae Mgmt Version 6. X Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Working Dir The working directory on the target system Type: String Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Force reading value. This flag bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False 60 Version: 1.4.2 TE1000
## Page 61

Tc Xae Mgmt Version 6. X Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The route object where to get the Target information from.. Twin CAT. ISession[] The Session to use for the value read. OUTPUTS NOTES 6.9 Get-Ads Remote Connections SYNOPSIS SYNTAX Get-Ads Remote Connections [[-Address] <String[]>] [-Input Object <IRoute>] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION {{ Fill in the Description }} EXAMPLES Example 1 PS C:\> {{ Add example code here }} {{ Add example description here }} PARAMETERS -Address The Name / Address of the route to get. The address of the route can be coded as Net Id, the Host Name or the IPAddress in string representation. Wildcards are permitted. Type: String[] Parameter Sets: (All) Aliases: Name Required: False Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: True TE1000 Version: 1.4.2 61
## Page 62

Tc Xae Mgmt Version 6. X -Input Object The Destination address specifies the target source, where the routes are determined. Use this to get the registered routes of a remote system. The Destination system can be specified by Route Name (route name on local system), Ams Net Id, IPAddress or Host Name. The destination system must be reachable by the local registered routes. Type: IRoute Parameter Sets: (All) Aliases: Destination Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.10 Get-TCom Object SYNOPSIS Gets the actual loaded TCOM objects in the Twin CAT environment. SYNTAX Net Id Port List (Default) Get-TCom Object [-Timeout <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Get-TCom Object [-Net Id <Ams Net Id>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] 62 Version: 1.4.2 TE1000
## Page 63

Tc Xae Mgmt Version 6. X Address Str Get-TCom Object [-Address] <String> [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Session Get-TCom Object -Session <ISession> [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command lists the actually loaded TCOM Objects on the target system. EXAMPLES EXAMPLE 1 PS> Get-TCom Object -Net Id 1.2.3.4.1.1 Name Object Id Class Id State Ref Count ---- -------- ------- ----- -------- IO 50331648 03000000-0000-0000-f000-000000000064 Op 2 I/O Idle Task 50331665 01020001-0000-0000-f000-000000000064 Op 4 Plc Ctrl 139460608 08500000-0000-0000-f000-000000000064 Op 9 Tc Os RTime Um 33554432 38e506a5-5b67-4107-9e77-8c8d5e4d6399 Op 39 Router 16777216 01000000-0000-0000-f000-000000000064 Op 22 Tc Loader 16777217 01000001-0000-0000-f000-000000000064 Op 4 TCom Server Task 16777232 01000010-0000-0000-f000-000000000064 Op 4 Tc Event Logger 16777328 01000070-0000-0000-f000-000000000064 Op 2 Getting the TCOM Objects from Net Id 1.2.3.4.1.1 PARAMETERS -Net Id The address where to get TCOM Objects. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to get the TCOM Objects. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True TE1000 Version: 1.4.2 63
## Page 64

Tc Xae Mgmt Version 6. X -Session The Session to use for the Cmdlet, must be connected to port 10, R0_TCom Server Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 10, R0_TCom Server OUTPUTS NOTES 6.11 Get-Tc Symbol Statistics SYNOPSIS Get the Symbol statistics from a Twin CAT target system / Device. 64 Version: 1.4.2 TE1000
## Page 65

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port (Default) Get-Tc Symbol Statistics [-Net Id <Ams Net Id>] [-Port <Int32>] [-Force] [-Reset] [-Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc Symbol Statistics -Route <IRoute> [-Port <Int32>] [-Force] [-Reset] [- Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Tc Symbol Statistics -Address <String> [-Port <Int32>] [-Force] [-Reset] [- Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc Symbol Statistics -Session <ISession> [-Force] [-Reset] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Tc Symbol Statistics -Session Id <Int32> [-Force] [-Reset] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet gets the Symbol statistics from a target system if symbolic information is provided by the device (Symbol Server available). The Statistic information include information about the amount of available Symbols and Datatypes, how they are configured and the actual caching information. EXAMPLES EXAMPLE 1 Get the data types from the local system (Port 851): PARAMETERS -Net Id The Net ID address of the target system where get the statistic information. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route The Route target where the the statistic information to load (Route Target. Local by default). TE1000 Version: 1.4.2 65
## Page 66

Tc Xae Mgmt Version 6. X Type: IRoute Parameter Sets: Route Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address where to load the statistic information. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Port The Port where to load the datatype descriptions (Default Port 851) Type: Int32 Parameter Sets: Net Id Port, Route, Address Str Aliases: Required: False Position: Named Default value: 851 Accept pipeline input: False Accept wildcard characters: False -Session The session object to use for the statistic information upload. Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id The unique session Identifier that represents the session to use for statistic information upload. Type: Int32 Parameter Sets: Session Id Aliases: Id Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False 66 Version: 1.4.2 TE1000
## Page 67

Tc Xae Mgmt Version 6. X -Force Forces to load the statistic information. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Reset Resets and reloads all cached symbolic information. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The session object to use for the statistic information upload. OUTPUTS NOTES 6.12 Set-Ads Route Property SYNOPSIS Sets route properties. TE1000 Version: 1.4.2 67
## Page 68

Tc Xae Mgmt Version 6. X SYNTAX Net Id (Default) Set-Ads Route Property [-Route Name] <String> [[-Net Id] <Ams Net Id>] -Property Name <String> - Value <Object> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Route Set-Ads Route Property [-Route Name] <String> -Input Object <IRoute> -Property Name <String> - Value <Object> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Address Str Set-Ads Route Property [-Route Name] <String> -Address <String> -Property Name <String> -Value <Object> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Session Set-Ads Route Property [-Route Name] <String> -Session <ISession> -Property Name <String> - Value <Object> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Session Id Set-Ads Route Property [-Route Name] <String> -Session Id <Int32> -Property Name <String> -Value <Object> [-Timeout <Int32>] [-Force] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet sets properties at existing routes, for example enabling/disabling a route. EXAMPLES EXAMPLE 1 PS> Set-Ads Route Property -Route Name My Route -Property Name Disabled -value true Disables the Route 'My Route' on the Local system. EXAMPLE 2 PS> Set-Ads Route Property -Route Name My Route -Property Name Enabled -value true Enables 'My Route' on the Local system. PARAMETERS -Route Name Name of the Route to be changed. Type: String Parameter Sets: (All) Aliases: Required: True Position: 2 Default value: None 68 Version: 1.4.2 TE1000
## Page 69

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Net Id Specifies the target system as Net Id (where to change the property). Type: Ams Net Id Parameter Sets: Net Id Aliases: Required: False Position: 1 Default value: 192.168.2.84.1.1 Accept pipeline input: False Accept wildcard characters: False -Input Object Specifies the target system as IRoute object (where to change the route property) Type: IRoute Parameter Sets: Route Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Specifies the target system as Route Name/IPAddress/Host Name or Ams Net Id as string (where to change the property). Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session Specifies the target system (where to change the route property) as session. Type: ISession Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) where to change the route property. Type: Int32 Parameter Sets: Session Id Aliases: Required: True TE1000 Version: 1.4.2 69
## Page 70

Tc Xae Mgmt Version 6. X Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Property Name Sets the specified property of the route. The property value is in the 'Value' argument. Type: String Parameter Sets: (All) Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Value Sets property value of the route. The property itself is specified by the 'Property Name' argument. Type: Object Parameter Sets: (All) Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Forces this command. It suppresses the Should Continue settings and bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False 70 Version: 1.4.2 TE1000
## Page 71

Tc Xae Mgmt Version 6. X -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute Specifies the target system as IRoute object (where to change the route property) Twin CAT. ISession Specifies the target system (where to change the route property) as session. OUTPUTS NOTES 6.13 About Tc Xae Mgmt Power Shell Twin CAT XAE Management Console (Tc Xae Mgmt) TE1000 Version: 1.4.2 71
## Page 72

Tc Xae Mgmt Version 6. X SHORT DESCRIPTION Cmdlets for managing and accessing ADS Routes, Reading/Writing Values and managing Remote targets. LONG DESCRIPTION The Powershell Twin CAT Management Console is a Power Shell module that provides a number of useful cmdlets for Twin CAT System Management and for communicating with ADS devices over the ADS protocol. This includes the following tasks/features: • Establishing/Removing Route Connections (Add-Ads Route, Remove-Ads Route) • Browsing Routes locally and within the network (Broadcast Search, Get-Ads Route) • Getting remote device states and information (Get-Ads State, Get-Tc Target Info, Get-Tc Version Info) • Establishing and Closing Remote communication sessions (New-Tc Session, Get-Tc Session, Close- Tc Session) • Browsing Symbol Information (Get-Tc Symbol, Get-Tc Data Type) • Reading/Writing raw and symbolic values (Read-Tc Value, Write-Tc Value, Send-Tc Read Write) • Uploading/Downloading files to/from remote devices (Copy-Ads File) • Browsing License information (Get-Tc License) This Module is usable under all Powershell Version >= 5.1 including 'Windows Powershell' and 'Powershell Core' Versions. As Prerequisite the Tc Xae Mgmt Module needs a local Twin CAT installation larger equals than Twin CAT 4024.10. There are no limitations to access other/older Twin CAT Versions remotely. PREREQUISITES >= Twin CAT 3.1.4024.10 (XAR Runtime or Full) (local installation) POWERSHELL COMPATIBILITY >= Windows Powershell 5.1 >= Powershell (Core) 6.0 CMDLETS To see what cmdlets are provided by the Tc Xae Mgmt Module, execute the command: PS> Get-Command -Module Tc Xae Mgmt -Command Type Cmdlet The actual Tc Xae Mgmt cmdlets are listed below: Add-Ads Route [} 80] Cmdlet for adding Twin CAT Routes. Add-Mqtt Route [} 92] Adds an MQTT route to the destination system. Close-Tc Session [} 96] Closes the specified session object. 72 Version: 1.4.2 TE1000
## Page 73

Tc Xae Mgmt Version 6. X Copy-Ads File [} 98] Uploads / Downloads files from/to Twin CAT target. Get-Ads Route [} 101] List routes on a Twin CAT System / Broadcast search. Get-Ads State [} 106] Gets the Ads State of a Twin CAT Target. Get-Ams Router Endpoint [} 110] Get the actual Ams Configuration / Router Endpoint of the process. Get-Ec Boxes [} 111] Gets the Ether CAT Boxes actually loaded ton the target system. Get-Ec Frame Statistics [} 113] Gets the Ether CAT Frame statistics from an ETher CAT master. Get-Ec Master [} 115] Gets the Ads State of a Twin CAT Target. Get-IODevice [} 118] Gets actually loaded IO Devices of the target system. Get-Io Free Run [} 121] Gets the IO Free Run State of the specified target. Get-Mqtt Route [} 123] Remove a MQTT Route. Get-RTime Cpu Settings [} 124] Getting the Cpu Settings of the Twin CAT System Get-RTime Latency [} 126] Get the latency of Twin CAT Realtime Cores of the specified Twin CAT target system. Get-RTime Performance [} 130] Gets the Realtime Performance of the specified system. Get-Tc Data Type [} 133] Get the Data Types from a Twin CAT target system / Device. Get-Tc Event [} 137] Gets Twin CAT events from event logs on local and remote computers. TE1000 Version: 1.4.2 73
## Page 74

Tc Xae Mgmt Version 6. X Get-Tc License [} 141] Get Twin CAT License information. Get-Tc Router Info [} 146] Gets the router status information of the specified target system. Get-Tc Session [} 149] List the currently established Sessions. Get-Tc Symbol [} 150] Get the symbols from a Twin CAT target system / Device. Get-Tc Target Info [} 156] Get Twin CAT Device Target information. Get-Tc Version [} 159] Get the Twin CAT Version of a target system. New-Tc Session [} 162] Create a new session to a Twin CAT Target. Read-Tc Value [} 165] Reads values from Twin CAT devices. Register-Ads Handle [} 172] Registers and returns a symbol handle. Register-Ads Nat Route [} 176] Changes an standard Route to an Ams NAT route on the target system (obsolete). Remove-Ads Route [} 179] Remove an ADS Route. Remove-Mqtt Route [} 182] Remove a MQQT Route. Reset-Io Free Run [} 185] Resets the IO Free Run state on the specified target. Restart-Ads Computer [} 188] Restarts ("reboots") the operating system on local and remote Twin CAT computers. Send-Tc Read Write [} 192] Sends a Read/Write access to ADS Server / Twin CAT Devices. 74 Version: 1.4.2 TE1000
## Page 75

Tc Xae Mgmt Version 6. X Set-Ads State [} 199] Set the ADS State of a Twin CAT Target. Set-Ams Router Endpoint [} 205] Sets the Ams Configuration (Loopback address and port, Router Endpoint). Set-Io Free Run [} 207] Sets the IO Free Run state of the target. Stop-Ads Computer [} 210] Stops (shuts down) local and remote Twin CAT computers. Test-Ads Route [} 214] Test the specified route connection. Unregister-Ads Handle [} 219] Unregisters a symbol handle. Write-Tc Value [} 222] Write values to Twin CAT devices. EXAMPLES Getting Route PS> $route = get-adsroute TC3TEST* PS> $route Name Net Id Address Sub Version RTSystem ---- ----- ------- --- ------- -------- TC3TESTA1-CP67X 172.17.62.105.1.1 172.17.62.105 0.0 Unknown Create Session PS> $session = New-Tc Session -Route $route -Port 851 PS> $session ID Address Is Connected Established At -- ------- ----------- ------------- 1 172.17.62.105.1.1:851 True 12/12/2016 12:22:02 PM Read Ads Value (Struct) PS> $v1 = Read-Tc Value -Session Id 1 -Path "GVL.vg Struct" PS> $v1 v Bool : True v Byte : 123 v Word : 12345 v DWord : 12345678 v SInt : -121 v USInt : 212 v Int : -12121 v UInt : 21212 v DInt : -1212121 v UDInt : 2121212 v Real : 123,456 v LReal : 1234567890,12346 v String : QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_ v Time : 01:02:03.0040000 v Tod : 23:45:06.7890000 TE1000 Version: 1.4.2 75
## Page 76

Tc Xae Mgmt Version 6. X v Date : 17.11.2005 00:00:00 v DT : 17.11.2005 12:34:56 v Alias : 8 v Enum : 8 v Range : 7 PSValue : ... Read Ads Value (Boolean) PS> $v2 = Read-Tc Value -Session Id 1 -Path "Main.b Change" PS> $v2 False Read Ads Value (Array of Strings) PS> $v3 = Read-Tc Value -Session Id 1 -path "GVL.vga String" Dimensions Elements PSValue ---------- -------- ------- {Twin CAT. Type System. Dimension} {QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_, _:;MNBVCXYÄÖLKJHGFDSAÜPOIUZTREWQ} ... Read Array Of Structs PS> $v4 = Read-Tc Value -Session Id 1 -path "GVL.vgastruct" Dimensions Elements ---------- -------- {Twin CAT. Type System. Dimension} {@{v Bool=True; v Byte=123; v Word=12345; v DWord=12345678; v SInt=-121; v USInt=212; v Int=-12121; v UInt=21212; v DInt=-1212121; v UD... Dump Array Elements PS> $v4. Dimensions. Element Count 2 PS> $v4. Elements v Bool : True v Byte : 123 v Word : 12345 v DWord : 12345678 v SInt : -121 v USInt : 212 v Int : -12121 v UInt : 21212 v DInt : -1212121 v UDInt : 2121212 v Real : 123,456 v LReal : 1234567890,12346 v String : QWERTZUIOPÜASDFGHJKLÖÄYXCVBNM;:_ v Time : 01:02:03.0040000 v Tod : 23:45:06.7890000 v Date : 17.11.2005 00:00:00 v DT : 17.11.2005 12:34:56 v Alias : 8 v Enum : 8 v Range : 7 PSValue : ... v Bool : False v Byte : 234 v Word : 23456 v DWord : 23456789 v SInt : 121 v USInt : 131 v Int : 12121 v UInt : 13131 v DInt : 1212121 v UDInt : 1313131 v Real : 456,321 v LReal : 987654321,123457 76 Version: 1.4.2 TE1000
## Page 77

Tc Xae Mgmt Version 6. X v String : _:;MNBVCXYÄÖLKJHGFDSAÜPOIUZTREWQ v Time : 11:22:33.0440000 v Tod : 11:22:33.4440000 v Date : 22.01.1999 00:00:00 v DT : 22.01.1999 11:22:33 v Alias : 9 v Enum : 9 v Range : -5 PSValue : ... ## Browse Data Types (Query by Category) PS> $session | Get-Tc Data Type | where Category -eq "Array" } Name Size Category Comment Element Type Dimensions Mem bers ---- ---- -------- ------- ----------- ---------- ------- ARRAY [-1..1] OF INT 6 Array INT {Twin CAT. Type... ARRAY [-10..-8] OF BOOL 3 Array BOOL {Twin CAT. Type... ARRAY [0..1] OF A_Alias 4 Array A_Alias {Twin CAT. Type... .... Browse Data Types by name PS> $session | Get-Tc Data Type -name "Array*" Browse all Symbols recursively PS> $session | Get-Tc Symbol -recurse ... returns all symbols Browse Symbols recursivly by Symbol Path (Here specific array index 'Task Info[1]'( PS> $session | Get-Tc Symbol -recurse -path "*Task Info``[1``]*","*. Project Name" Instance Name Data Type Size Instance Path Comment ------------ -------- ---- ------------ ------- Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name _Task Info[1] PLC. Plc Task System Info 128 Twin CAT_System Info Var List._Task Info[1] Obj Id OTCID 4 Twin CAT_System Info Var List._Task Info[1]. Obj Id Cycle Time UDINT 4 Twin CAT_System Info Var List._Task Info[1]. Cycle Time Priority UINT 2 Twin CAT_System Info Var List._Task Info[1]. Priority Ads Port UINT 2 Twin CAT_System Info Var List._Task Info[1]. Ads Port Cycle Count UDINT 4 Twin CAT_System Info Var List._Task Info[1]. Cycle Count Dc Task Time LINT 8 Twin CAT_System Info Var List._Task Info[1]. Dc Task Time Last Exec Time UDINT 4 Twin CAT_System Info Var List._Task Info[1]. Last Exec Ti me First Cycle BOOL 1 Twin CAT_System Info Var List._Task Info[1]. First Cycle Cycle Time Exceeded BOOL 1 Twin CAT_System Info Var List._Task Info[1]. Cycle Time E xceeded In Call After Output Update BOOL 1 Twin CAT_System Info Var List._Task Info[1]. In Call Afte r Output Update RTViolation BOOL 1 Twin CAT_System Info Var List._Task Info[1]. RTViolatio n Task Name STRING(63) 64 Twin CAT_System Info Var List._Task Info[1]. Task Name Browse only Symbols ending with path *. Project Name PS>$project = Get-Tc Symbol -Session $session -recurse -path "*. Project Name" Instance Name Data Type Size Instance Path Comment ------------ -------- ---- ------------ ------- Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name Ads Read Project Name PS>$project | Read-Tc Value -Session $session ADS_Dyn Symbols TE1000 Version: 1.4.2 77
## Page 78

Tc Xae Mgmt Version 6. X Ads Write Project Name PS>$project | Write-Tc Value -Session $session -Value "New Project Name" PS>$project | Read-Tc Value -Session $session New Project Name Read Write by Symbol Path PS>Read-Tc Value -Session Id 1 -Path "Main.b Change" false PS>Write-Tc Value -Session Id 1 -Symbol "Main.b Change" -Value True PS>Read-Tc Value -Session Id 1 -Path "GVL.vg Bool" PS>Write-Tc Value -Session Id 1 -Path "GVL.vg Bool" -value $true Read Write by Piping PS> $project Name Symbol = $session | Get-Tc Symbol -Recurse -path "*Project Name" PS> $project Name Symbol | Read-Tc Value -Session Id 1 PS> $project Name Symbol | Write-Tc Value -Session Id 1 -Value "New Project Name" PS> $project Name Symbol | Read-Tc Value -Session Id 1 Get Target Information PS> get-adsroute | Get-Tc Target Info Target Version Level OS Image Device CPUArch ------ ------- ----- -- ----- ------ ------- TC3TESTA1-CP67X 3.1.4021.131 CP Win7 Intel X86 PS> get-adsroute | Get-Tc Version Major Minor Build Revision ----- ----- ----- -------- 3 1 4021 131 PROVIDERS The Tc Xae Mgmt module includes the Ads Symbol Provider and the Ads File Provider Binds the target device symbolic information to a PSDrive. To register a symbol server as PSDrive type (here the Target Route 'CX_01234' with Ams Port: 851) PS> New-PSDrive -Name CX_01234_Symbols -PSProvider Ads Symbol Provider -Address CX_01234 -Port 851 - Root PS> cd CX_01234_Symbols: PS> CX_01234_Symbols:> dir PS> New-PSDrive -name CX_01234 -PSProvider Ads File Provider -Address CX_01234 -Root '' PS> dir CX_01234: Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 30.11.2021 16:11:31 Boot Dir d---- 03.12.2021 01:17:20 Boot Project d---- 17.03.2021 14:33:53 Config Dir d---- 03.12.2021 01:17:20 Generic d---- 18.06.2021 08:00:22 Install Dir d---- 03.12.2021 01:17:20 Repository Dir d---- 03.12.2021 15:32:03 Target Dir > cd CX_01234:/Boot Dir PS CX_01234:\Boot Dir> dir Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 05.10.2021 10:36:34 Current Config -a--- 05.10.2021 10:36:34 4563 Current Config.tszip -a--- 05.10.2021 10:36:34 17113 Current Config.xml -a--- 30.11.2021 16:11:31 126976 Logged Events.db d---- 27.10.2021 11:32:43 Plc 78 Version: 1.4.2 TE1000
## Page 79

Tc Xae Mgmt Version 6. X More Information about Providers PS> get-help about_providers Example: Create a new Ads File Provider Drive to the Twin CAT Device CX_01234 > New-PSDrive -name CX_01234 -PSProvider Ads File Provider -Address CX_01234 -Root '' Name Used (GB) Free (GB) Provider Root Current Location ---- --------- --------- -------- ---------- --------------- CX_01234 Ads File Provider \Target Dir Example: Browse the files on the Twin CAT Device CX_01234 > dir Mode Last Write Time Length Name ---- ------------- ------ ---- d---- 26.11.2021 17:44:27 CACerts -a--- 14.03.2012 14:50:50 619 Default Config.xml d---- 11.05.2021 14:42:45 License d---- 18.06.2021 08:01:03 Resource d---- 17.03.2021 15:15:51 Routes d---- 18.06.2021 08:00:33 Start Menu Admin d---- 17.03.2021 14:33:35 Start Up -a--- 30.11.2021 18:46:08 2253 Static Routes.xml -a--- 01.02.2012 16:42:58 494 Target Features.xml -a--- 17.03.2021 14:42:50 3113 Tc Self Signed.xml Example: Read the content of the Static Routs.xml on target CX_01234 r> get-content .\Static Routes.xml <?xml version="1.0"?> <Tc Config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"> <Remote Connections> <Route> <Name>Target IPC</Name> <Address>172.17.60.147</Address> <Net Id>172.17.60.147.1.1</Net Id> <Type>TCP_IP</Type> <Tls Ignore Cn="true"> <Ca>...</Ca> </Tls> </Route> <Server> <Tls Ignore Cn="true"> <Ca>c:\twincat\3.1\target\CACerts\Root CA.pem</Ca> <Cert>c:\twincat\3.1\target\CACerts\Target IPC.crt</Cert> <Key>c:\twincat\3.1\target\CACerts\Target IPC.key</Key> </Tls> </Server> </Remote Connections> </Tc Config> FEEDBACK Please submit any feedback, including defects and enhancement requests, to support@beckhoff.com We are also interested in suggestions you may have for cmdlets. Over time, we hope to be able to add some more features. NOTE To see what functions are provided by Tc Xae Mgmt, execute the command: PS> Get-Command -Module Tc Xae Mgmt -Command Type Function TE1000 Version: 1.4.2 79
## Page 80

Tc Xae Mgmt Version 6. X For more information, most of the cmdlets have help associated with them e.g.: PS> Get-Help Add-Ads Route -full The definitive information on a cmdlet's parameters can be obtained by executing: PS> Get-Command Add-Ads Route -syntax or more tersely: PS> gcm Add-Ads Route -syn SEE ALSO Documentation Tc Xae Mgmt Module About the Tc Xae Mgmt Module Beckhoff Homepage PS> get-help about_providers KEYWORDS • ADS • Twin CAT • Management Console • Routes 6.14 Add-Ads Route SYNOPSIS Cmdlet for adding Twin CAT Routes. SYNTAX Routes (Default) Add-Ads Route [-Remote Persistance <Route Persistance Type>] -Input Object <IRoute[]> [- Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [- Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Address Add-Ads Route [-Name <String>] [-Address] <String[]> [-Remote Persistance <Route Persistance Type>] [-Broadcast Timeout <Int32>] [-Destination <String>] [-Destination Credential <PSCredential>] [-Credential <PSCredential>] [-Host Name] [-Temporary] [-Unidirectional] [-Quiet] [-Force] [- Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address PSK Add-Ads Route [-Name <String>] [-Address] <String[]> [-Broadcast Timeout <Int32>] [- Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [- Pre Shared Key] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [- 80 Version: 1.4.2 TE1000
## Page 81

Tc Xae Mgmt Version 6. X Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address PSKKey Add-Ads Route [-Name <String>] [-Address] <String[]> [-Broadcast Timeout <Int32>] [- Destination <String>] [-Destination Credential <PSCredential>] -Identity <String> -Binary Key <Byte[]> [-Host Name] [- Temporary] [-Pre Shared Key] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address SCA Add-Ads Route [-Name <String>] [-Address] <String[]> [-Broadcast Timeout <Int32>] [- Destination <String>] [-Destination Credential <PSCredential>] [-Host Name] [-Temporary] [-Shared Cert Auth] [-Ignore CN] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address SSC Add-Ads Route [-Name <String>] [-Address] <String[]> [-Broadcast Timeout <Int32>] [- Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [- Self Signed] [-Finger Print <String>] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id Add-Ads Route [-Name <String>] [-Net Id] <Ams Net Id> [-IPOr Host Name <String>] [-Remote Persistance <Route Persistance Type>] [-Destination <String>] [- Destination Credential <PSCredential>] [-Credential <PSCredential>] [-Host Name] [-Temporary] [-Unidirectional] [-Quiet] [-Force] [- Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id PSK Add-Ads Route [-Name <String>] [-Net Id] <Ams Net Id> [-IPOr Host Name <String>] [-Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [- Pre Shared Key] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id PSKKey Add-Ads Route [-Name <String>] [-Net Id] <Ams Net Id> [-IPOr Host Name <String>] [-Destination <String>] [-Destination Credential <PSCredential>] -Identity <String> -Binary Key <Byte[]> [-Host Name] [- Temporary] [-Pre Shared Key] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id SCA Add-Ads Route [-Name <String>] [-Net Id] <Ams Net Id> [-IPOr Host Name <String>] [-Destination <String>] [-Destination Credential <PSCredential>] [-Host Name] [-Temporary] [-Shared Cert Auth] [-Ignore CN] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id SSC Add-Ads Route [-Name <String>] [-Net Id] <Ams Net Id> [-IPOr Host Name <String>] [-Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [- Self Signed] TE1000 Version: 1.4.2 81
## Page 82

Tc Xae Mgmt Version 6. X [-Finger Print <String>] [-Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Routes PSK Add-Ads Route -Input Object <IRoute[]> [-Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [-Pre Shared Key] [-Unidirectional] [-Quiet] [- Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Routes PSKKey Add-Ads Route -Input Object <IRoute[]> [-Destination <String>] [-Destination Credential <PSCredential>] -Identity <String> -Binary Key <Byte[]> [-Host Name] [-Temporary] [-Pre Shared Key] [- Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Routes SCA Add-Ads Route -Input Object <IRoute[]> [-Destination <String>] [-Destination Credential <PSCredential>] [-Host Name] [-Temporary] [-Shared Cert Auth] [-Ignore CN] [-Unidirectional] [-Quiet] [-Force] [- Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Routes SSC Add-Ads Route -Input Object <IRoute[]> [-Destination <String>] [-Destination Credential <PSCredential>] -Credential <PSCredential> [-Host Name] [-Temporary] [-Self Signed] [-Finger Print <String>] [- Unidirectional] [-Quiet] [-Force] [-Nat <Ams Net Id>] [-Pass Thru] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] DESCRIPTION Adds a Route to the destination target System (Temporary or statically). Dependant on the used parameters, this Cmdlet uses an internal broadcast search to determine the target system Addresses (Net Id, Host Name or IPAddress) to establish a full defined route. To find the specified target it is necessary that the target system is running/online and reachable from the local system. Another use case is to establish a route on the local system for preparation before the targeting system is available. In that case the full target address represented by the -Net ID and -IPOr Host Name parameter must be given, while leaving out the -Credential parameter. EXAMPLES EXAMPLE 1 > Get-Ads Route -All -name "Tc3*" Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 172.17.62.105.1.1 172.17.62.105 3.1.4021 Win7 TC3Test13-C6650 192.168.0.239.1.1 172.17.62.156 2.11.2246 Win7 PS> $cred = Get-Credential -Message "Get Credentials" -User Name "User Name" PS> Add-Ads Route -Credential $cred -Address "TC3Test A1-CP67x" -temporary -passthru Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 172.17.62.105.1.1 172.17.62.105 3.1.4021 Win7 82 Version: 1.4.2 TE1000
## Page 83

Tc Xae Mgmt Version 6. X PS> Get-Ads Route -name "TC3Test A1-CP67x" | Test-Ads Route Search for Systems that start with the name "TC3*", then asks the user for Credentials and adds the Route as 'temporary' (with TC2 compatible security, clear text password). Afterwards, the connection is checked via 'Test-Ads Route'. The route is specified by its name (Computer Name). To find out the address of the route an under the hood broadcast search is necessary what means that the target system must be online available in the network. EXAMPLE 2 > Add-Ads Route -name Test -Net Id 1.2.3.4.1.1 -IPOr Host Name 1.2.3.4 Adds a Route named 'Test' to the local routes with the specified Net Id and IPAddress. Because Net Id and IPOr Host Name are defined AND no credentials are set, this route is added locally only. Be aware that to get the route functional, the target system must define the backroute. EXAMPLE 3 > Get-Ads Route -All -name "Tc3*" Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 172.17.62.105.1.1 172.17.62.105 3.1.4021 Win7 TC3Test13-C6650 192.168.0.239.1.1 172.17.62.156 2.11.2246 Win7 PS> $cred = Get-Credential -Message "Get Credentials" -User Name "User Name" PS> Add-Ads Route -Credential $cred -Address "TC3Test A1-CP67x" -self Signed -passthru Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 172.17.62.105.1.1 172.17.62.105 3.1.4021 Win7 PS> Get-Ads Route -name "TC3Test A1-CP67x" | Test-Ads Route Search for Systems that start with the name "TC3*", then asks the user for Credentials and adds the Route with 'Self Signed' Ads Secure settings. Afterwards, the connection is checked via 'Test-Ads Route'. The route is specified by its name (Computer Name). To find out the address of the route an under the hood broadcast search is necessary what means that the target system must be online available in the network. EXAMPLE 4 PS> Add-Ads Route -Address 172.17.62.105 -sca -passthru Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- TC3Test A1-CP67x 172.17.62.105.1.1 172.17.62.105 3.1.4021 Win7 Searches for the system with the specified IPAddress, and add the Route with Shared Certification Authority settings without password. The precondition is, that valid certificates are already established on both (engineering and remote) systems, within their Static Routes.xml files. The route is specified by its Address only. TE1000 Version: 1.4.2 83
## Page 84

Tc Xae Mgmt Version 6. X Because the Net Id is missing a broadcast search is necessary what means that the target system must be online available in the network. EXAMPLE 5 PS> $cred = Get-Credential -Message "Get Credentials" -User Name "User Name" PS> Add-Ads Route -Credential $cred -Net Id 172.17.62.105 -Nat 1.2.3.4.1.1 Name Net Id Address Sub Tc Version RTSystem --------------- ----------- ------------- --- --------- ------------ TC3Test A1-CP67x 1.2.3.4.1.1 172.17.62.105 3.1.4024 Win10 (2004) Add a route with a local network address translation (NAT Ams Net Id) to project a remote Ams Net Id (Remote Net Id) locally to a different address. EXAMPLE 6 Add-Ads Route -name "Test Route" -Net Id 1.2.3.4.1.1 -IPOr Host Name 1.2.3.4 -Temporary - Remote Persistance None Adding a route 'Test Route' single sided and temporary only to the local system. The remote device doesn't need to be online. EXAMPLE 7 PS> $route = get-adsroute CX_01234 -all PS> $route Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 192.168.0.197.1.1 X 192.168.0.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535â€¦ PS> $route | add-adsroute -Shared Cert Auth -Ignore CN -passthru Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 192.168.0.197.1.1 X 192.168.0.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535â€¦ Broadcast search for a Device with Hostname CX_01234 and adding of a ADSSecure route via 'Shared Certificate Authority' (SCA) to the local system. Both systems must contain certificates derived from the same root CA certificate. EXAMPLE 8 PS> $cred = get-credential User Name: My User Password: ******** PS> $route = get-adsroute CX_01234 -all PS> $route Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 192.168.0.197.1.1 X 192.168.0.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535â€¦ PS> $route | add-adsroute -Pre Shared Key -Credential $cred Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 192.168.0.197.1.1 X 192.168.0.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535â€¦ Broadcast search for a Device with Hostname CX_01234 and adding of a ADSSecure route via 'Preshared key' (User Name, Password) to the local system. 84 Version: 1.4.2 TE1000
## Page 85

Tc Xae Mgmt Version 6. X The target system must already contain the preshared key configuration (as Psk Identity/Password) in its Static Routes.xml configuration file. EXAMPLE 9 PS> $route = get-adsroute CX_01234 -all PS> $route Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 192.168.0.197.1.1 X 192.168.0.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535â€¦ PS> $route | add-adsroute -Pre Shared Key -Identity My User - Binary Key 1,2,3,4,5,6,7,8,9,0xa,0xb,0xc,0xd,0xe,0xf Name Net Id TLS Address Finger Print ---- ----- --- ------- ----------- CX_01234 192.168.0.197.1.1 X 192.168.0.197 7835dae7a079c4f296c84109b2e6d7156b66e6b cc39e386c3576d7535â€¦ Broadcast search for a Device with Hostname CX_01234 and adding of a ADSSecure route via 'Preshared key' (Identity, Binary Key) to the local system. The target system must already contain the preshared key configuration (as Psk Identity/Binary Key) in its Static Routes.xml configuration file. PARAMETERS -Name The name of the route(s) to add. If the Routes address is ambiguous and more than one route will be found online for adding then the route names will be numbered to be distinct. Without setting this parameter, the default route name will be its Computername / Hostname. Type: String Parameter Sets: Address, Address PSK, Address PSKKey, Address SCA, Address SSC, Net Id, Net Id PSK, Net Id PS KKey, Net Id SCA, Net Id SSC Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address for the ADS route. This can be the Route Name, Net Id, the Host Name or the IPAddress. Type: String[] Parameter Sets: Address, Address PSK, Address PSKKey, Address SCA, Address SSC Aliases: Target Address Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: True -Net Id The Ams Net ID for the ADS route to add. If no further IPAddress or Host Name is specified with the -IPOr Host Name parameter, a broadcast search is triggered to find an online device. TE1000 Version: 1.4.2 85
## Page 86

Tc Xae Mgmt Version 6. X If a single sided route should be added, specify the IPAddress or Host Name Parameter in combination with -Remote Persistance:None and without -Credential. Type: Ams Net Id Parameter Sets: Net Id, Net Id PSK, Net Id PSKKey, Net Id SCA, Net Id SSC Aliases: Target Net Id Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -IPOr Host Name The Host Name Address of the target route or the IPAddress. Because the Host Name or IPAddress is necessary in addition to the Net Id for a functional route, the Add- Ads Route Cmdlet tries to detect the Host Name/IPAddress via a Broadcast search in the Network when it is not specified. That means the target must be available and reachable within the network in that case. If not the Add-Ads Route Cmdlet will fail. If the IP or Host Name in combination with the -Net Id is specified, the target availability is not necessary and Add-Route will register the Route whatever is specified as address. Type: String Parameter Sets: Net Id, Net Id PSK, Net Id PSKKey, Net Id SCA, Net Id SSC Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Remote Persistance The persistance type of the remmote route. None/Server means no remote route will be created. Other valid values are 'Static' or 'Temporary' Possible values: None, Server, Temporary, Static Type: Route Persistance Type Parameter Sets: Routes, Address, Net Id Aliases: Accepted values: None, Server, Temporary, Static Required: False Position: Named Default value: Static Accept pipeline input: False Accept wildcard characters: False -Broadcast Timeout (Broadcast) Search Timeout for searching the unregistered target in seconds (Default 0, Dynamic detection). Type: Int32 Parameter Sets: Address, Address PSK, Address PSKKey, Address SCA, Address SSC Aliases: Required: False Position: Named Default value: 0 86 Version: 1.4.2 TE1000
## Page 87

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Input Object The input Ads Routes. Type: IRoute[] Parameter Sets: Routes, Routes PSK, Routes PSKKey, Routes SCA, Routes SSC Aliases: Route, Target Route Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Destination The Destination Address, where the route is added. Type: String Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Destination Credential The credentials of the destination system, where to add the route. Local system by default. Type: PSCredential Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Credential Credentials of the route to be added to the destination system. This parameter is only necessary, when a bidirectional route will be added. When specifying IMPORTANT: Please be aware, that in the current version, tha password is transferred as clear text through the network. Use this only in safe subnetworks. Type: PSCredential Parameter Sets: Routes, Address PSK, Address SSC, Net Id PSK, Net Id SSC, Routes PSK, Routes SSC Aliases: Target Credential Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 87
## Page 88

Tc Xae Mgmt Version 6. X Type: PSCredential Parameter Sets: Address, Net Id Aliases: Target Credential Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Identity The Binary Key can be used instead of the credential Password on Secure Settings. Pre Shared Keys (PSK). There is no function for this parameter on other security settings. Type: String Parameter Sets: Address PSKKey, Net Id PSKKey, Routes PSKKey Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Binary Key The Binary Key can be used instead of the credential Password on Secure Settings. Pre Shared Keys (PSK). There is no function for this parameter on other security settings. Type: Byte[] Parameter Sets: Address PSKKey, Net Id PSKKey, Routes PSKKey Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Host Name If set, the route will be registered as Host Name Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Temporary If set, the Route will be registered as temporary route. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False 88 Version: 1.4.2 TE1000
## Page 89

Tc Xae Mgmt Version 6. X -Self Signed Gets or sets the Self Signed (SSC) mode for adding the route. Type: Switch Parameter Parameter Sets: Address SSC, Net Id SSC, Routes SSC Aliases: SSC Required: True Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Finger Print The Fingerprint used for adding the route. This parameter can be used when the parameter '-Self Signed' is set. If specified, the found Online Target will be checked against this fingerprint. If not specified, the 'Add-Ads Route' Cmdlet doesn't check the fingerprint, always adding the route. Using the fingerprint means that only single routes can be added, multi-adding routes with fingerprint is not supported. Type: String Parameter Sets: Address SSC, Net Id SSC, Routes SSC Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Pre Shared Key Gets or sets the Pre Shared Key (PSK) mode for adding the route. Because a valid certificate is expected at the target, it is not necessary to enter credentials. Type: Switch Parameter Parameter Sets: Address PSK, Address PSKKey, Net Id PSK, Net Id PSKKey, Routes PSK, Routes PSKKey Aliases: PSK Required: True Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Shared Cert Auth Gets or sets the Shared Certificate Authority (SCA) mode for adding the route. Because a valid certificate is expected at the target, it is not necessary to enter credentials. Type: Switch Parameter Parameter Sets: Address SCA, Net Id SCA, Routes SCA Aliases: SCA Required: True Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 89
## Page 90

Tc Xae Mgmt Version 6. X -Ignore CN Gets or sets the 'Ignore Common Name' mode for Shared Certificate Authority (SCA) while adding the route. The "Common Name" of the certificate must correspond to the name used when establishing the connection in the certificate. This behavior can be deactivated by this option. Type: Switch Parameter Parameter Sets: Address SCA, Net Id SCA, Routes SCA Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Unidirectional Gets or sets the unidirectional setting. The Unidirectional setting registers the ADS Route as 'one-way' channel. That means that the engineering/source system (thats where the route request is initiated) can send requests to the remote target, but not in the opposite direction. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Nat The 'Nat' parameter sets the local representation of the routes Ams Net Id. 90 Version: 1.4.2 TE1000
## Page 91

Tc Xae Mgmt Version 6. X All (local) addressing to this net Id will be translated to the remote/network Ams Address of the route. If using the '-Nat' parameter, the 'Add-Ads Route' Cmdlet is limited to single route additions. Multi-adding is not supported. This Parameter can be used with Twin CAT Versions \>= 3.1.4024.11. Type: Ams Net Id Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Pass Thru If the passthrough parameter is set, the successfully created route will be returned as object. By default, this Cmdlet will not create any output. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi TE1000 Version: 1.4.2 91
## Page 92

Tc Xae Mgmt Version 6. X Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The input Ads Routes. OUTPUTS NOTES 6.15 Add-Mqtt Route SYNOPSIS Adds an MQTT route to the destination system. SYNTAX Default (Default) Add-Mqtt Route [-Address] <String> [-Port] <Int32> [[-Topic] <String>] [-Destination <String>] [- Quiet] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Identity Add-Mqtt Route [-Address] <String> [-Port] <Int32> [[-Topic] <String>] [-Destination <String>] -Credential <PSCredential> [-Identity Case Sensitive] [-Quiet] [-Force] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Psk Add-Mqtt Route [-Address] <String> [-Port] <Int32> [[-Topic] <String>] [-Destination <String>] -Identity <String> -Pre Shared Key <String> [-Quiet] [-Force] [-Progress Action <Action Preference>] [- What If] [-Confirm] [<Common Parameters>] SCA Add-Mqtt Route [-Address] <String> [-Port] <Int32> [[-Topic] <String>] [-Destination <String>] - CA <String> -Cert <String> -Key <String> [-Quiet] [-Force] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet adds an MQTT route to the destination system. To add the route, the Address of a MQTT route must be specified. 92 Version: 1.4.2 TE1000
## Page 93

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Add-Mqtt Route -Address 1.2.3.4 -port 42 Adds the MQTT route to an MQTT Broker system with the IPAddress '1.2.3.4' and Port '42' on the local system. EXAMPLE 2 PS> Add-Mqtt Route -Address Mqtt System -port 42 -Destination CX_1234 Adds the MQTT route on the destination System 'CX_1234' to the MQTT Broker with Address '1.2.3.4' and Port '42'. PARAMETERS -Address The Address of the MQTT Broker to add. This can be the Host Name or the IPAddress. Type: String Parameter Sets: (All) Aliases: Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Port The TCP/IP Port of the MQTT Broker to add. Type: Int32 Parameter Sets: (All) Aliases: Required: True Position: 1 Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Topic The MQTT Topic string under which this MQTT Consumer sends/receives data. Type: String Parameter Sets: (All) Aliases: Required: False Position: 2 Default value: None Accept pipeline input: False Accept wildcard characters: False -Destination The Destination Address, where the MQTT route is added remotely. Type: String Parameter Sets: (All) Aliases: TE1000 Version: 1.4.2 93
## Page 94

Tc Xae Mgmt Version 6. X Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Credential Credentials of the Preshared Key Identity. IMPORTANT: Please be aware, that in the current version, tha password is transferred as clear text through the network. Use this only in safe subnetworks. Type: PSCredential Parameter Sets: Identity Aliases: Target Credential Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Identity Case Sensitive Key will be generated Sha256(Identity+Pwd), Identity in upper case if 'Identity Case Sensitive' = false - UTF8 Type: Switch Parameter Parameter Sets: Identity Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Identity The identity name used to talk to the MQTT message broker (Preshared Key method). Type: String Parameter Sets: Psk Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Pre Shared Key The Preshared key used togehter with the identity for MQTT message broker communication. Type: String Parameter Sets: Psk Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -CA Path to the Certificate Authority file. 94 Version: 1.4.2 TE1000
## Page 95

Tc Xae Mgmt Version 6. X Certificates of MQTT broker, signed by this CA will be accepted for connection. The file must be already located on the target system. Type: String Parameter Sets: SCA Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Cert Path to the public key Certificate (X.509). The file must be already located on the target system. Type: String Parameter Sets: SCA Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Key Path of the private Key file of the X.509 Certifcate. The file must be already located on the target system. Type: String Parameter Sets: SCA Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False TE1000 Version: 1.4.2 95
## Page 96

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.16 Close-Tc Session SYNOPSIS Closes the specified session. 96 Version: 1.4.2 TE1000
## Page 97

Tc Xae Mgmt Version 6. X SYNTAX Default (Default) Close-Tc Session -Id <Int32> [-Progress Action <Action Preference>] [<Common Parameters>] Session Close-Tc Session -Input Object <ISession> [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet closes the specified Point-To-Point Connection to the Twin CAT Target that is represented by the returned session object. All registered Session Provider types of Sessions can be used here. If using ADS as protocol, this Cmdlet is equivalent to Close/Dispose/Disconnect an ADS Client. EXAMPLES EXAMPLE 1 PS> $session = New-Tc Session -Net Id '1.2.3.4.1.1' -port 10000 PS> $session | Get-Ads State Target Net Id Port State Latency (ms) ------ ----- ---- ----- ------- CX_1234 1.2.3.4.1.1 10000 Config 3 PS> $session | Close-Tc Session Opens a session to the registered route with Ams Net Id: 1.2.3.4.1.1 and closes the ADS Session again.: PARAMETERS -Id The session object to close is specified by this session ID. Type: Int32 Parameter Sets: Default Aliases: Required: True Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Input Object The Session object to close. Type: ISession Parameter Sets: Session Aliases: Session Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} TE1000 Version: 1.4.2 97
## Page 98

Tc Xae Mgmt Version 6. X Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session object to close. OUTPUTS NOTES 6.17 Copy-Ads File SYNOPSIS Uploads / Downloads files from/to Twin CAT target. SYNTAX Net Id (Default) Copy-Ads File [-Path] <String> [[-Destination] <String>] [-Directory <Path Specifier>] [-Upload] [- Force] [-Net Id <Ams Net Id>] [-Progress Action <Action Preference>] [<Common Parameters>] Route Copy-Ads File [-Path] <String> [[-Destination] <String>] [-Directory <Path Specifier>] [-Upload] [- Force] -Input Object <IRoute> [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Copy-Ads File [-Path] <String> [[-Destination] <String>] [-Directory <Path Specifier>] [-Upload] [- Force] -Address <String> [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Copy-Ads File [-Path] <String> [[-Destination] <String>] [-Directory <Path Specifier>] [-Upload] [- Force] -Session Id <Int32> [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet implements ADS file transfer operations with Twin CAT Systems. 98 Version: 1.4.2 TE1000
## Page 99

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS > Copy-Ads File -address CX_00001 -path Current Config.xml -Destination c:\tmp\Config1.xml - Directory Boot Dir Downloads the the Current Config.xml from the Boot Dir of the target system to 'c:\tmp\Config1.xml' EXAMPLE 2 PS > Copy-Ads File -address CX_00001 -upload -path c:\tmp\Config1.xml - destination Current Config.xml -Directory Boot Dir Uploads the file "c:\tmp\Config1.xml" on local system to the Target Boot Folder of system CX_00001 EXAMPLE 3 PS > Copy-Ads File -address CX_0001 -path c:\Read Me.txt -destination d:\tmp\ Downloads the File "C:\Read Me.txt" form System CX_0001 to the local system and store it under d: \tmp\Read Me.txt PARAMETERS -Path The source path specifier, where the file is taken from. If this Cmdlet is in Download mode, this is the specifier or Full Path of the (remote) file, dependant of the Standard Folder Parameter. In case of 'Uploading' this is the Full Path of the file to be transferred. Type: String Parameter Sets: (All) Aliases: Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Destination The Destination path/specifier, where the file is stored. If the Cmdlet is in Download mode, this has to be the Full Path of the target location. In case of 'Uploading' this can be the File Name or a Full Path dependent of the Standard Directory Parameter. Type: String Parameter Sets: (All) Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Directory The Directory specifier on the remote system. The Default is "Generic". TE1000 Version: 1.4.2 99
## Page 100

Tc Xae Mgmt Version 6. X Possible values: Generic, Boot Dir, Target Dir, Config Dir, Install Dir, Repository Dir, User Path1, User Path2, User Path3, User Path4, User Path5, User Path6, User Path7, User Path8, User Path9 Type: Path Specifier Parameter Sets: (All) Aliases: Accepted values: Generic, Boot Dir, Target Dir, Config Dir, Install Dir, Repository Dir, User Path1, User P ath2, User Path3, User Path4, User Path5, User Path6, User Path7, User Path8, User Path9 Required: False Position: Named Default value: Generic Accept pipeline input: False Accept wildcard characters: False -Upload Switches the Cmdlet to Upload mode. If not set, the Cmdlet is in 'Download' mode. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces to create the Directory on the target side (and overwrites any preexisting file). Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Net Id The address (Ams Net Id) of the system where the file is Downloaded from / Uploaded to (Default: Local) Type: Ams Net Id Parameter Sets: Net Id Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The address (Route) of the system where the file is Downloaded from / Uploaded to (Default: Local) Type: IRoute Parameter Sets: Route Aliases: Route Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False 100 Version: 1.4.2 TE1000
## Page 101

Tc Xae Mgmt Version 6. X -Address The address of the system where the file is Downloaded from / Uploaded to (Default: Local) This can be the Route Name, Net Id, the Host Name or the IPAddress. Type: String Parameter Sets: Address Str Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session Id The target system address is derived from the Session Information where the file is Downloaded from / Uploaded to. Type: Int32 Parameter Sets: Session Id Aliases: Id Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute The address (Route) of the system where the file is Downloaded from / Uploaded to (Default: Local) OUTPUTS NOTES 6.18 Get-Ads Route SYNOPSIS List routes on a Twin CAT System / Broadcast search. TE1000 Version: 1.4.2 101
## Page 102

Tc Xae Mgmt Version 6. X SYNTAX Get Routes (Default) Get-Ads Route [-Broadcast Timeout <Int32>] [[-Address] <String[]>] [-Input Object <Ams Net Id>] [-Access <Route Access Type>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Broadcast Get-Ads Route [-All] [-Broadcast Timeout <Int32>] [-Net Adapter <String[]>] [[-Address] <String[]>] [-Input Object <Ams Net Id>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Local System Get-Ads Route [-Input Object <Ams Net Id>] [-Local] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet can list the routes configured on a Twin CAT local/remote system, or start determining all Twin CAT Systems within the current subnet. EXAMPLES EXAMPLE 1 PS> Get-Ads Route Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- --------- CP-15ECA0 172.17.62.128.1.1 172.17.62.178 [UNKNOWN] [UNKNOWN] CP-15ECA1 172.17.62.105.1.1 172.17.62.105 [UNKNOWN] [UNKNOWN] Lists all registered local routes. Because only the local port 10000 is addressed, the Tc Version and RTSystem is unknown (the Cmdlet doesn't contact the targets and doesn't produce additional roundtrips. EXAMPLE 2 PS> get-Ads Route -All Name Net Id Address Sub Version RTSystem ---- ----- ------- --- ------- -------- CX-1CEEDA 5.16.136.222.1.1 172.17.62.139 3.1.4020 Win7 CX-20BC62 5.32.188.98.1.1 172.17.62.90 3.1.4020 CE6.0 CX-10A87B 5.16.168.123.1.1 172.17.62.140 2.11.2254 CE7.0 CP-15ECA0 172.17.62.128.1.1 172.17.62.178 3.1.4021 Win7 CX-0A7F60 5.10.127.96.1.1 172.17.62.148 3.1.4020 XP CX2030-B4018 172.17.60.157.1.1 172.17.60.159 2.11.2256 Win7 CP_11BB16 5.17.187.22.1.1 172.17.60.180 2.11.2038 CE6.0 CX-128CE5 172.17.60.165.1.1 172.17.62.191 2.11.2237 CE7.0 CX-124218 5.18.66.24.1.1 172.17.60.192 3.1.4021 Win7 CX-1D82AA 172.17.62.180.1.1 172.17.62.180 3.1.4021 Win8 CX_0AB4F0 5.10.180.240.1.1 172.17.60.195 2.11.2243 XP CP-1DFA0A 172.17.62.118.1.1 172.17.62.118 3.1.4021 Win7 CX-AF0001 172.17.62.75.1.1 172.17.62.70 3.1.4020 Win10 Start a Broadcast search from the local system and lists the devices within the connected network. EXAMPLE 3 PS> Get-Ads Route -Name "Tc3*" Name Net Id Address Sub Version RTSystem ---- ----- ------- --- ------- -------- TC3TESTA1-CP67X 172.17.62.105.1.1 172.17.62.105 0.0 Unknown Get the (actual) route assigned to the local system that has the name pattern "Tc3*" 102 Version: 1.4.2 TE1000
## Page 103

Tc Xae Mgmt Version 6. X EXAMPLE 4 PS> Get-Ads Route -All | where Tc Version -lt "3.1.0.0" Name Net Id Address Sub Version RTSystem ---- ----- ------- --- ------- -------- TC3Test17-C6930 172.17.62.98.1.1 172.17.62.98 2.11.2234 Win7 CX2030-B4018 172.17.60.157.1.1 172.17.60.159 2.11.2256 Win7 CX-10A87B 5.16.168.123.1.1 172.17.62.140 2.11.2254 CE7.0 TC3Test13-C6650 172.17.60.239.1.1 172.17.62.156 2.11.2246 Win7 ECATTest01 172.17.61.6.1.1 172.17.61.31 2.11.2239 Win7 CX-128CE5 172.17.60.165.1.1 172.17.62.191 2.11.2237 CE7.0 CX_0AB4F0 5.10.180.240.1.1 172.17.60.195 2.11.2243 XP CP_11BB16 5.17.187.22.1.1 172.17.60.180 2.11.2038 CE6.0 Find out all Twin CAT Systems within the network with Version numbers lower than '3.1.0.0' EXAMPLE 5 PS> $running Adaptors = @(get-netadapter | Where-Object -Property Status -eq Up) PS> get-Ads Route -all -Net Adapter Name $running Adaptors[0]. Name -verbose VERBOSE: Broadcast search from system 'CX_11111' ... VERBOSE: Broadcasting over the Network Adapter(s) 'Ethernet 1' Name Net Id Protocol TLS Address Finger Print ---- ----- -------- --- ------- ----------- CX_22222 192.168.0.2.1.1 Tcp IP X 192.168.0.2 xxxxxxxxxxx VERBOSE: Broadcast search finished. Found '1' route(s) Determines the first active Network adapter for broadcasting and returns the found targets. PARAMETERS -All Broadcast switch. If activated a broadcast search is triggered within the local network. The search can be constrained additionally by the -Address/-Name parameter. Searching by Address (direct access of targets if no wildcards, otherwise using Broadcast search): - Host Name: Searching the target by dns resolution and then via IP (fallback broadcast search filtering Device Name/Hostname, not working over subnets!) - IPAddress: Directly accessing via IP (works also over subnets) - Ams Net Id: Working via Broadcast search (not working over subnet segments!) Searching by Name: Works always via Broadcast search, wildcards permitted Type: Switch Parameter Parameter Sets: Broadcast Aliases: Broadcast Required: True Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Broadcast Timeout (Broadcast) Search Timeout in Seconds (Default 0 Seconds) 0 Seconds means that the Length of the search operation will be determined dynamically. If for a longer period no targets are arriving. Type: Int32 Parameter Sets: Get Routes, Broadcast Aliases: Required: False Position: Named TE1000 Version: 1.4.2 103
## Page 104

Tc Xae Mgmt Version 6. X Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Net Adapter The Network adapter name of the Network Adapter to use. By default e.g. Broadcast searches go out via all active Network adapters. This parameter can be use to restrict this. Type: String[] Parameter Sets: Broadcast Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The Name / Address of the route to get. The address of the route can be coded as Net Id, the Host Name or the IPAddress in string representation. Wildcards are permitted. Type: String[] Parameter Sets: Get Routes, Broadcast Aliases: Name Required: False Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: True -Input Object The Destination address specifies the target source, where the routes are determined. Use this to get the registered routes of a remote system. The Destination system can be specified by Route Name (route name on local system), Ams Net Id, IPAddress or Host Name. The destination system must be reachable by the local registered routes. Type: Ams Net Id Parameter Sets: (All) Aliases: Destination Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Access Defines the strategy how to get the remote routes. Valid methods are 'Merged', 'Actual', 'Configuration', 'Registry'. The default value is 'Default' / 'Merged' 104 Version: 1.4.2 TE1000
## Page 105

Tc Xae Mgmt Version 6. X Possible values: None, Actual, Registry, Configured, Merged, Xml Config, Default Type: Route Access Type Parameter Sets: Get Routes Aliases: Accepted values: None, Actual, Registry, Configured, Merged, Xml Config, Default Required: False Position: Named Default value: Default Accept pipeline input: False Accept wildcard characters: False -Local If set, the local system route will be returned. By default a list of the actual registered routes will be returned. Type: Switch Parameter Parameter Sets: Local System Aliases: Self Required: True Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force If set, the broadcast search won't use cached routes. The Route will be determined by broadcast always. Only available with the -All parameter. Type: Switch Parameter Parameter Sets: Get Routes, Broadcast Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. TE1000 Version: 1.4.2 105
## Page 106

Tc Xae Mgmt Version 6. X INPUTS OUTPUTS NOTES 6.19 Get-Ads State SYNOPSIS Gets the Ads State of a Twin CAT Target. SYNTAX Net Id Port (Default) Get-Ads State [[-Net Id] <Ams Net Id[]>] [[-Port] <Int32>] [-Quiet] [-State Only] [-Force] [- Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Ads State [[-Port] <Int32>] [[-Address] <String[]>] [-Quiet] [-State Only] [-Force] [- Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-Ads State [[-Port] <Int32>] -Session <ISession[]> [-Quiet] [-State Only] [-Force] [- Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Ads State [[-Port] <Int32>] -Session Id <Int32[]> [-Quiet] [-State Only] [-Force] [- Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Route Get-Ads State [[-Port] <Int32>] [-Input Object] <IRoute[]> [-Quiet] [-State Only] [-Force] [- Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command let gets the ADS state of a Twin CAT target. EXAMPLES EXAMPLE 1 PS > Get-Ads State 1.2.3.4.5.6 Name State OK Time (ms) Address ---- ----- -- --------- ------- WORK01 Config True 0 1.2.3.4.5.6 Gets the actual Ads State from the remote target with Net Id 1.2.3.4.5.6. 106 Version: 1.4.2 TE1000
## Page 107

Tc Xae Mgmt Version 6. X EXAMPLE 2 PS> Get-Ads State Name State OK Time (ms) Address ---- ----- -- --------- ------- WORK01 Config True 0 1.2.3.4.5.6 Gets the actual Ads State from the Local system. EXAMPLE 3 PS> Get-Ads State 1.2.3.4,CX_0130C7 Gets the Ads State of target system with IPAddress 1.2.3.4 and Route name 'CX_0130C7'. EXAMPLE 4 PS> get-route | get-ads State Name State OK Time (ms) Address ---- ----- -- --------- ------- WORK01 Config True 0 1.2.3.4.5.6 CX_0130C7 Config True 0 5.1.48.199.1.1 Get the current target state from all registered routes. EXAMPLE 5 PS> get-adsroute | get-adsstate -port 10000 -state Only Invalid Config Gets the Ads State information from all actual routes. EXAMPLE 6 PS> get-adsroute | get-adsstate -port 10000 -quiet false true Gets availability information from all actual routes. PARAMETERS -Net Id The Addresses of the target systems, where to get the Ads State. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Port The Ams Port of the target system. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: 2 Default value: 10000 TE1000 Version: 1.4.2 107
## Page 108

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to get the State. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Str Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the Cmdlet. Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The target systems, where to get the Ads State from. Type: IRoute[] Parameter Sets: Route Aliases: Destination,Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Quiet The quiet mode Type: Switch Parameter Parameter Sets: (All) Aliases: 108 Version: 1.4.2 TE1000
## Page 109

Tc Xae Mgmt Version 6. X Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -State Only The State Only mode Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forced Mode Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Count Specifies the number of state requests to send. The default value is 1. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Delay Specifies the interval between Ads State requests, in seconds. TE1000 Version: 1.4.2 109
## Page 110

Tc Xae Mgmt Version 6. X This is used only in combination with the 'Count' parameter. The default value is 1 Second. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession[] The Session to use for the Cmdlet. Twin CAT. IRoute[] The target systems, where to get the Ads State from. OUTPUTS NOTES 6.20 Get-Ams Router Endpoint SYNOPSIS Get the actual Ams Configuration / Router Endpoint of the process. SYNTAX Get-Ams Router Endpoint [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet returns actual process-wide settings for the Ams Configuration that define the TCP/IP Loopback Address that is used from the communication between Ads Client/Server and Router locally. For more information please have a look at the Set Ams Router Endpoint Cmdlet Cmdlet help. 110 Version: 1.4.2 TE1000
## Page 111

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Get-Ams Router Endpoint Address Family Address Port ------------- ------- ---- Inter Network 127.0.0.1 48898 Returns the actual Loopback endpoint settings. PARAMETERS -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.21 Get-Ec Boxes SYNOPSIS Gets the Ether CAT Boxes actually loaded on the specified target system. SYNTAX Get-Ec Boxes [-Input Object] <Ec Master> [-Configured] [-Timeout <Int32>] [-Detailed] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command list the Ether CAT Boxes actually loaded on the target system. EXAMPLES EXAMPLE 1 PS> $m = Get-Ec Master -Net Id 5.62.192.46.1.1 PS> $m | Get-Ec Boxes Pos Name Type Port State Crc Error FW HW Production --- ---- ---- ---- ----- --------- -- -- ---------- 2 Term 2 (EL1808) EL1808-0000-0018 1001 Pre Op A:0,B:0 7 0 2021-5-29 TE1000 Version: 1.4.2 111
## Page 112

Tc Xae Mgmt Version 6. X 3 Term 3 (EL2088) EL2088-0000-0018 1002 Pre Op A:0,B:0 9 0 2021-6-04 4 Term 4 (EL2624) EL2624-0000-0018 1003 Pre Op A:0,B:0 12 1 2021-5-25 5 Term 5 (EL3064) EL3064-0000-0020 1004 Pre Op A:0,B:0 15 9 2021-6-01 6 Term 6 (EL4004) EL4004-0000-0020 1005 Pre Op A:0,B:0 19 4 2021-5-31 7 Term 7 (EL6021) EL6021-0000-0021 1006 Pre Op A:0,B:0 13 9 2021-6-01 8 Term 8 (EL9110) EL9110-0000-0018 1007 Pre Op A:0,B:0 14 0 2021-5-17 9 Term 9 (EL1004) EL1004-0000-0016 1008 Pre Op A:0,B:0 0 0 2000-1-02 10 Term 10 (EL2008) EL2008-0000-0016 1009 Pre Op A:0,B:0 0 0 2000-1-02 Get the Ether CAT Master from Net ID 5.62.192.46.1.1 and scan the connected (online) Boxes below this master EXAMPLE 2 PS> $m = Get-Ec Master -Net Id 5.62.192.46.1.1 PS> $m | Get-Ec Boxes -configured Pos Name Type Port State Crc Error FW HW Production --- ---- ---- ---- ----- ------------ -- -- ---------- 2 Term 2 (EL1808) EL1808-0000-0018 1001 Pre Op A:0,B:0 7 0 2021-5-29 3 Term 3 (EL2088) EL2088-0000-0018 1002 Pre Op A:0,B:0 9 0 2021-6-04 4 Term 4 (EL2624) EL2624-0000-0018 1003 Pre Op A:0,B:0 12 1 2021-5-25 5 Term 5 (EL3064) EL3064-0000-0020 1004 Pre Op A:0,B:0 15 9 2021-6-01 6 Term 6 (EL4004) EL4004-0000-0020 1005 Pre Op A:0,B:0 19 4 2021-5-31 7 Term 7 (EL6021) EL6021-0000-0021 1006 Pre Op A:0,B:0 13 9 2021-6-01 8 Term 8 (EL9110) EL9110-0000-0018 1007 Pre Op A:0,B:0 14 0 2021-5-17 9 Term 9 (EL1004) EL1004-0000-0016 1008 Pre Op A:0,B:0 0 0 2000-1-02 10 Term 10 (EL2008) EL2008-0000-0016 1009 Pre Op A:0,B:0 0 0 2000-1-02 Get the Ether CAT Master from Net ID 5.62.192.46.1.1 and scan the configured Boxes below this master PARAMETERS -Input Object The Ether CAT master where to scan the slaves. Type: Ec Master Parameter Sets: (All) Aliases: Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Configured The List of Configured Boxes will be returned if specified. If not specified, this Cmdlet will return the Online Boxes. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). 112 Version: 1.4.2 TE1000
## Page 113

Tc Xae Mgmt Version 6. X Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 5000 Accept pipeline input: False Accept wildcard characters: False -Detailed Reads addional Info fromt he Ether CAT Slave EEPROM (Hw version, FW Version, Manufacturing Date). Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Ether CAT. Ec Master The Ether CAT master where to scan the slaves. OUTPUTS NOTES 6.22 Get-Ec Frame Statistics SYNOPSIS Gets the Ether CAT Frame statistics from an Ether CAT master. TE1000 Version: 1.4.2 113
## Page 114

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port List (Default) Get-Ec Frame Statistics [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Default Get-Ec Frame Statistics [-Input Object] <Ec Master> [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION Gets the Ether CAT Frame statistics from an ETher CAT master. EXAMPLES EXAMPLE 1 PS> $m = Get-Ec Master -Net Id 5.62.192.46.1.1 PS> $m | Get-Ec Frame Statistics -count 5 -delay 0 Frames(1/s) Queued(1/s) Lost(1/ s) Queued Lost Total Frames Total Queued Total Lost Total Queued (1/s) ------------ ------------ ---------- ------------ ----------- ----------- --------- ----------- 100 30 0 0 1524222 572157 0 0 100 30 0 0 1524232 572160 0 0 101 40 0 0 1524242 572164 0 0 101 40 0 0 1524252 572168 0 0 99 39 0 0 1524262 572172 0 0 Getting the Ether CAT frame statistics of an Ether CAT Master. This example calculates the statistics 5 times with a minimal delay (0). PARAMETERS -Input Object The Ether CAT master. Type: Ec Master Parameter Sets: Default Aliases: Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Timeout ADS Communication timeout Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 5000 Accept pipeline input: False Accept wildcard characters: False 114 Version: 1.4.2 TE1000
## Page 115

Tc Xae Mgmt Version 6. X -Count Specifies the number of statistic requests (Default is 1) Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Delay Delay in Seconds between requests in Seconds (Default is 1s) Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Ether CAT. Ec Master The Ether CAT master. OUTPUTS NOTES 6.23 Get-Ec Master SYNOPSIS Gets actually loaded Ether CAT Master devices on the target system. TE1000 Version: 1.4.2 115
## Page 116

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port List (Default) Get-Ec Master [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Get-Ec Master [-Net Id <Ams Net Id>] [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Ec Master [-Address] <String> [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Session Get-Ec Master -Session <ISession> [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command lists the loaded Ether CAT master devices on the specified target system. The devices must be already loaded and being active on the Ether CAT Network. EXAMPLES EXAMPLE 1 PS> Get-Ec Master -Net Id 5.91.172.198.1.1 ID Name Type Device Net Id Port Slaves Slaves State Port Crc Error (Online) (Config) -- ---- ---- ----------- ---- ---------- ---------- ----- ------------ 1 Device 1 (Ether CAT) P06b80001 R00000000 5.91.172.198.2.1 65535 9 9 Op A:0,B:0,C:0,D:0 PS> Get-Ec Boxes -Input Object $m Pos Name Type Port State Crc Error FW HW Production --- ---- ---- ---- ----- -------- -- -- ---------- 2 Term 2 (EL1808) EL1808-0000-0018 1001 Op A:0,B:0 7 0 2021-5-29 3 Term 3 (EL2088) EL2088-0000-0018 1002 Op A:0,B:0 9 0 2021-6-04 4 Term 4 (EL2624) EL2624-0000-0018 1003 Op A:0,B:0 12 1 2021-5-25 5 Term 5 (EL3064) EL3064-0000-0020 1004 Op A:0,B:0 15 9 2021-6-01 6 Term 6 (EL4004) EL4004-0000-0020 1005 Op A:0,B:0 19 4 2021-5-31 7 Term 7 (EL6021) EL6021-0000-0021 1006 Op A:0,B:0 13 9 2021-6-01 8 Term 8 (EL9110) EL9110-0000-0018 1007 Op A:0,B:0 14 0 2021-5-17 9 Term 9 (EL1004) EL1004-0000-0016 1008 Op A:0,B:0 0 0 2000-1-02 10 Term 10 (EL2008) EL2008-0000-0016 1009 Op A:0,B:0 0 0 2000-1-02 Getting Ether CAT master and connected boxes from target system. PARAMETERS -Net Id Gets or sets the Net Id of the target system. 116 Version: 1.4.2 TE1000
## Page 117

Tc Xae Mgmt Version 6. X Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) of the target system(s) where to get the Ether CAT Master devices. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Id Specifies the Device Id to scan by the Cmdlet. If not specified, all Devices will be scanned. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named TE1000 Version: 1.4.2 117
## Page 118

Tc Xae Mgmt Version 6. X Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO OUTPUTS NOTES 6.24 Get-IODevice SYNOPSIS Gets actually loaded IO Devices of the target system. SYNTAX Net Id Port List (Default) Get-IODevice [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Get-IODevice [-Net Id <Ams Net Id>] [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-IODevice [-Address] <String> [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] 118 Version: 1.4.2 TE1000
## Page 119

Tc Xae Mgmt Version 6. X Session Get-IODevice -Session <ISession> [-Id <Int32>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command lists the actually loaded IO Devices of the target system. The list can be filted by specific Device IDs. EXAMPLES EXAMPLE 1 PS> Get-IODevice -Net Id 5.62.192.46.1.1 ID Device Name Device Type Device Net Id Boxes Count -- ---------- ---------- ----------- ---------- 1 Device 1 (Ether CAT) Ether CAT_Direct Mode V210 172.16.1.3.2.1 4 Getting the IO Devices from Net ID 5.62.192.46.1.1 EXAMPLE 2 PS> (Get-IODevice -Address CX_01234 -Id 1). Boxes ID Name Box Type Port Comment -- ---- ------- ---- ------- 1 Box 1 (IFC2422) Ether CAT_EXXXXX 1001 2 Box 2 (IFC2421m) Ether CAT_EXXXXX 1002 3 Box 3 (IFC2421m1) Ether CAT_EXXXXX 1003 4 Box 4 (IFC2421m2) Ether CAT_EXXXXX 1004 Getting the Boxes of Device with Id 1 from the target system with Name/Address CX_01234 PARAMETERS -Net Id The address where to get the device. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to get Devices. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None TE1000 Version: 1.4.2 119
## Page 120

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Id Specifies the Device Id to scan by the Cmdlet. If not specified, all Devices will be scanned. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. 120 Version: 1.4.2 TE1000
## Page 121

Tc Xae Mgmt Version 6. X INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO OUTPUTS NOTES 6.25 Get-Io Free Run SYNOPSIS Gets the IO Free Run State of the specified target. SYNTAX Net Id Port List (Default) Get-Io Free Run [-Timeout <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Get-Io Free Run [-Net Id <Ams Net Id>] [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Io Free Run [-Address] <String> [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] Session Get-Io Free Run -Session <ISession> [-Timeout <Int32>] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command gets the IO Free Run state of specified target when the target is in config mode. If the target system is not in config mode, a warning is produced. EXAMPLES EXAMPLE 1 PS> Get-Io Free Run -Net Id 5.62.192.46.1.1 $true Getting the IO Free Run State from Net ID 5.62.192.46.1.1 PARAMETERS -Net Id The address where to get the free run state. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: TE1000 Version: 1.4.2 121
## Page 122

Tc Xae Mgmt Version 6. X Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to get the free run state. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False 122 Version: 1.4.2 TE1000
## Page 123

Tc Xae Mgmt Version 6. X Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO OUTPUTS NOTES 6.26 Get-Mqtt Route SYNOPSIS Remove a MQTT Route. SYNTAX Get-Mqtt Route [-Destination <String>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION Removes a MQTT Route of the specified system. EXAMPLES EXAMPLE 1 PS> Get-Mqtt Route -destination CX_1234 Address Tcp Port Topic Qos Security ------- ------- ----- --- -------- 192.168.2.1 44124 Topic1 TLS 192.200.2.2 44124 Topic2 PSK 192.200.3.3 44124 Topic3 None Gets the MQTT Routes registered on the destination System 'CX_1234'. PARAMETERS -Destination The destination address, where to Remove the specified Mqtt route. This can be the Net Id, the Host Name or the IPAddress Type: String Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} TE1000 Version: 1.4.2 123
## Page 124

Tc Xae Mgmt Version 6. X Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.27 Get-RTime Cpu Settings SYNOPSIS Getting the Cpu Settings of the Twin CAT System SYNTAX Net Id Port (Default) Get-RTime Cpu Settings [-Net Id <Ams Net Id>] [-Timeout <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-RTime Cpu Settings [-Address] <String> [-Timeout <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-RTime Cpu Settings -Session <ISession> [-Timeout <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This command lists the actually configured Relatime, Windows and Realtime cores of the Twin CAT System. EXAMPLES EXAMPLE 1 PS> Get-RTime Cpu Settings Net Id Windows Non Win Realtime CPUArch CPUVendor CPUFrequency Threads/ Core Cores Cores Cores (GHz) ----- ---------- ---------- ---------- ------- --------- ------------ ------------ 192.168.2.84.1.1 6 6 1 X86/AMD64 Intel 2712 2 Getting the CPU Settings of the local system. 124 Version: 1.4.2 TE1000
## Page 125

Tc Xae Mgmt Version 6. X PARAMETERS -Net Id The Ams Net Id of the Target system. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The target address(es) where to get the CPU Settings. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} TE1000 Version: 1.4.2 125
## Page 126

Tc Xae Mgmt Version 6. X Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO OUTPUTS NOTES 6.28 Get-RTime Latency SYNOPSIS Get the latency of Twin CAT Realtime Cores of the specified Twin CAT target system. SYNTAX Net Id Port (Default) Get-RTime Latency [-Net Id <Ams Net Id>] [-Core <Int32>] [-Scan Timeout <Int32>] [-Timeout <Int32>] [- Count <Int32>] [-Delay <Int32>] [-No Reset] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-RTime Latency [-Address] <String> [-Core <Int32>] [-Scan Timeout <Int32>] [-Timeout <Int32>] [- Count <Int32>] [-Delay <Int32>] [-No Reset] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-RTime Latency -Session <ISession> [-Core <Int32>] [-Scan Timeout <Int32>] [-Timeout <Int32>] [- Count <Int32>] [-Delay <Int32>] [-No Reset] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This commands lists the Realtime Cores of specified Twin CAT target systems. The values can be repeated by count parameter and a repeat delay can be set. 126 Version: 1.4.2 TE1000
## Page 127

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Get-RTime Latency Net Id Core Id Latency Max Latency Limit (us) (us) ---------------- ------ ---------- ---------- ----- 5.91.172.198.1.1 1 0 20 0 Getting the Realtime latency of all Realtime cores on the local system. EXAMPLE 2 PS> Get-RTime Latency -Net Id 5.91.172.198.1.1 -core 1 -count 5 -Delay 0 Net Id Core Id Latency Max Latency Limit (us) (us) ---------------- ------ ---------- ---------- ----- 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 5.91.172.198.1.1 1 0 20 0 Get the Realtime Latency of the System witt Net Id 5.91.172.198.1.1 and Core Id 1 5 times without delay between values. PARAMETERS -Net Id The Ams Net Id of the target system. The Default is the local system (if left out). Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to get the Realtime latency. This can be the Route Name, Net Id, the Host Name or the IPAddress. Multiple Addresses and Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO TE1000 Version: 1.4.2 127
## Page 128

Tc Xae Mgmt Version 6. X Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Core Specifies the Core ID of the Realtime Core. If not specified, this Cmdlet returns all Realtime Cores. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Scan Timeout Scannning timeout in milliseconds (Default 5000 ms) This is the timeout for each single ADS roundtrip used by this Cmdlet. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Count Specifies the number request repeatations (Default is 1). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 128 Version: 1.4.2 TE1000
## Page 129

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Delay Delay in Milliseconds between requests (Default is 1000ms) Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1000 Accept pipeline input: False Accept wildcard characters: False -No Reset By default, the Maximum Latency of the data is reset in each polling cycle. Switching to -No Reset remains the maximum Latency between calls. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO TE1000 Version: 1.4.2 129
## Page 130

Tc Xae Mgmt Version 6. X OUTPUTS NOTES 6.29 Get-RTime Performance SYNOPSIS Gets the Realtime Performance of the specified system. SYNTAX Net Id Port (Default) Get-RTime Performance [-Net Id <Ams Net Id>] [-Core <Int32>] [-Count <Int32>] [-Delay <Int32>] [- Timeout <Int32>] [-No Reset] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-RTime Performance [-Address] <String> [-Core <Int32>] [-Count <Int32>] [-Delay <Int32>] [- Timeout <Int32>] [-No Reset] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-RTime Performance -Session <ISession> [-Core <Int32>] [-Count <Int32>] [-Delay <Int32>] [- Timeout <Int32>] [-No Reset] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION Gets the Realtime Performance of the specified Twin CAT Target systems. The output can be filtered for specified Realtime CPUs and contains the actual CPU Latency and CPU Load. This Cmdlet is preliminary and subject of change. Performance Data is not supported before Twin CAT Build 4026. EXAMPLES EXAMPLE 1 PS> Get-RTime Performance Net Id Core Id Last Delay Max Delay Delay Limit Load (%) Max Load (us) (us) (us) (%) ----- ------ ---------- ---------- ---------- -------- -------- 192.168.0.2.1.1 1 0 109 0 0 80 192.168.0.2.1.1 2 0 109 0 0 80 Getting the Performance Data from all Realtime CPUs on the local target system. EXAMPLE 2 PS> Get-RTime Performance -core 1 -count 5 -Delay 0 -no Reset Net Id Core Id Last Delay Max Delay Delay Limit Load (%) Max Load (us) (us) (us) (%) ----- ------ ---------- ---------- ---------- -------- -------- 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 192.168.0.2.1.1 1 0 1659 0 0 80 130 Version: 1.4.2 TE1000
## Page 131

Tc Xae Mgmt Version 6. X Getting the Performance Data from the local System (Core 1) 5 times as fast as possible. The Max Delay will not be reset on each call. PARAMETERS -Net Id The Ams Net Id of the target system. Uses the Local system if empty. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to get the performance data. This can be the Route Name, Net Id, the Host Name or the IPAddress. Multiple addresses and wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Core Specifies the ID of the Core where to determine the performance data. If not specified, all Realtime CPUs will be returned. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 131
## Page 132

Tc Xae Mgmt Version 6. X -Count Specifies the number of performance requests (Default is 1) per target and CPU. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Delay Delay in Milliseconds between performance requests (Default is 1000ms) Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1000 Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -No Reset By default, the Maximum Delay of the Performance Data before getting new data is reset. Switching to -No Reset remains the maximum Delay between calls. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None 132 Version: 1.4.2 TE1000
## Page 133

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO OUTPUTS NOTES 6.30 Get-Tc Data Type SYNOPSIS Get the Data Types from a Twin CAT target system / Device. SYNTAX Net Id Port (Default) Get-Tc Data Type [[-Name] <String[]>] [-Net Id <Ams Net Id>] -Port <Int32> [-Reset Symbols] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc Data Type [[-Name] <String[]>] -Route <IRoute> -Port <Int32> [-Reset Symbols] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Tc Data Type [[-Name] <String[]>] -Address <String> -Port <Int32> [-Reset Symbols] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc Data Type [[-Name] <String[]>] -Session <ISession> [-Reset Symbols] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Tc Data Type [[-Name] <String[]>] -Session Id <Int32> [-Reset Symbols] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet get the Data Types from a target system if symbolic information is provided by the device (Symbol Server running). The Data Types can be determined via different Providers (e.g. ADS, MQTT, OPC, see the '-Provider' parameter.) TE1000 Version: 1.4.2 133
## Page 134

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Get-Tc Data Type -port 851 Name Size Category Base Type ---- ---- -------- -------- BYTE 1 Primitive WORD 2 Primitive DINT 4 Primitive UDINT 4 Primitive DWORD 4 Primitive E_Byte Enum 1 Enum BYTE FB_Test 12424 Struct PLC. Plc App System Info 256 Struct PLC. Plc Task System Info 128 Struct POINTER TO BYTE 4 Pointer BYTE R_Range 2 Alias INT (-6..12) REFERENCE TO BOOL 4 Reference BOOL ST_Simple Struct 166 Struct STRING(80) 81 String ... Get the data types from the local system (Port 851): EXAMPLE 2 PS> $types = Get-Tc Data Type -Name 'ST_*' -Net Id 1.2.3.4.5.6 -Port 851 Gets the Data Types with name pattern 'ST_*' from the Net Id / Port address symbol server. EXAMPLE 3 PS> $session = New-Tc Session -Name 'CX_123456' -port 851 PS> Get-Tc Data Type -Session $session | where Byte Size -gt 1KB Gets an ADS-Session/Connection to the target system CX_123456 on port 851, downloads the datatype information and returns all the Data Types that are larger than 1KB of Size. PARAMETERS -Name The data type name(s) to get. Wildcards are permitted. Type: String[] Parameter Sets: (All) Aliases: Required: False Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: True -Net Id The Net ID address of the target system where to load the datatypes (Local by default). Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False 134 Version: 1.4.2 TE1000
## Page 135

Tc Xae Mgmt Version 6. X -Route The Route object where to load the datatypes from (Route Target. Local by default). Type: IRoute Parameter Sets: Route Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address where to load the datatype descriptions. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Port The Port where to load the datatype descriptions. Type: Int32 Parameter Sets: Net Id Port, Route, Address Str Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Session The session object to use for datatype upload. Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id The unique session Identifier that represents the session to ose for the datatype upload. Type: Int32 Parameter Sets: Session Id Aliases: Id Required: True Position: Named Default value: -1 TE1000 Version: 1.4.2 135
## Page 136

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Reset Symbols Resets the symbols and datatypes cache. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the ADS access. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The session object to use for datatype upload. 136 Version: 1.4.2 TE1000
## Page 137

Tc Xae Mgmt Version 6. X OUTPUTS NOTES 6.31 Get-Tc Event SYNOPSIS Gets Twin CAT events from event logs on local and remote computers. SYNTAX Get-Tc Event [-Max Events <Int32>] [-Computer Name <String>] [-Credential <PSCredential>] [- Level <String[]>] [-Source <String[]>] [-Start Time <Date Time Offset>] [-End Time <Date Time Offset>] [-ID <Int32[]>] [-Timeout <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION Twin CAT creates Log Entries in the Application log. These most important entries for system diagnostics source from the Tc Sys UI Application and the Twin CAT System Service (Tc Sys Srv) containing the logentries from the Twin CAT Drivers. This Get-Tc Event Cmdlet gets these events from the local system and as well from other reachable systems within the corporate network. If you're not running Power Shell as an Administrator, you might see error messages that you cannot retrieve information about a log. EXAMPLES EXAMPLE 1 PS> get-tcevent -Max Events 30 Provider Name: Tc Sys Ui Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:56:44 3 Information Process startup apps was already triggerd. 17.08.2021 15:56:44 1 Information Process startup apps after reaching RUN state. Provider Name: Tc Sys Srv Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:56:44 66 Information Starting COM Server Tc Event Logger ! 17.08.2021 15:56:44 20000 Information Twin CAT System Message: Source: License Server; Times tamp: 8/17/2021 3:56:44 PM 345 ms Message: license validation status is Valid(3) 17.08.2021 15:56:44 15 Information Tc RTime Server started: Tc RTime. 17.08.2021 15:56:44 15 Information Tc Rts Objects Server started: Tc Rts Objects. 17.08.2021 15:56:44 15 Information Tc Plc30 Server started: Tc Plc30. 17.08.2021 15:56:44 15 Information Tc Io Server started: Tc Io. 17.08.2021 15:56:44 69 Information Initializing COM Server Tc Event Logger ! 17.08.2021 15:56:44 71 Information Loading configuration of COM server Tc Event Logger ! Provider Name: Tc Sys Ui Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:56:44 2 Information Process startup apps skipped after reaching state '4' . 17.08.2021 15:56:44 2 Information Process startup apps skipped after reaching state '6' . Provider Name: Tc Sys Srv Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:56:43 67 Information Stopping COM Server Tc Event Logger ! TE1000 Version: 1.4.2 137
## Page 138

Tc Xae Mgmt Version 6. X 17.08.2021 15:56:43 28 Information TCIODRIVERS Server stopped. 17.08.2021 15:56:43 28 Information TCIOECAT Server stopped. 17.08.2021 15:56:43 28 Information TCIOETH Server stopped. 17.08.2021 15:56:43 28 Information TCRTSOBJECTS Server stopped. 17.08.2021 15:56:43 28 Information TCRTIME Server stopped. 17.08.2021 15:56:43 28 Information TCIO Server stopped. 17.08.2021 15:56:43 68 Information Shutting down COM Server Tc Event Logger ! 17.08.2021 15:56:42 70 Information Saving configuration of COM server Tc Event Logger ! Provider Name: Tc Sys Ui Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:56:42 2 Information Process startup apps skipped after reaching state '17 '. Provider Name: Tc Sys Srv Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:56:42 33 Information Twin CAT System Restart initiated from Ams Net Id: 172.1 7.60.197.1.1 port 32894. Provider Name: Tc Sys Ui Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:50:56 2 Information Process startup apps skipped after reaching state '15 '. Provider Name: Tc Sys Srv Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:50:56 66 Information Starting COM Server Tc Event Logger ! 17.08.2021 15:50:55 15 Information TCIODRIVERS Server started: TCIODRIVERS. Gets last 30 events (all events) on the local system. EXAMPLE 2 PS> get-tcevent -computer Name CX_1234 -Level Critical, Error, Warning -source Tc Sys Srv - Start Time([Date Time]::Now -[Time Span]::From Days(1)) Provider Name: Tc Sys Srv Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:50:53 89 Error Error: .. checking Twin CAT Licenses! 17.08.2021 15:50:53 20000 Error Twin CAT System Message: Source: License Server; Timestamp: 8/17/2021 3:50:53 PM 145 ms Message: License Violation: License 'TC3 PLC' not found, Requested by 'P LC1 Instance', License Id = {666â€¦ Getting the logged errors/warnings of system 'CX_1234' of the last 24 hours and filter the events for the Event provider 'Tc Sys Srv' (the Twin CAT System Service) EXAMPLE 3 PS> get-tcevent --Start Time '2021-08-17 15:50:55' -End Time '2021-08-17 15:55:56' -source Tc Sys Srv Provider Name: Tc Sys Srv Time Created Id Level Display Name Message ----------- -- ---------------- ------- 17.08.2021 15:50:56 66 Information Starting COM Server Tc Event Logger ! 17.08.2021 15:50:55 15 Information TCIODRIVERS Server started: TCIODRIVERS. 17.08.2021 15:50:55 15 Information TCIOECAT Server started: TCIOECAT. 17.08.2021 15:50:55 15 Information TCIOETH Server started: TCIOETH. 17.08.2021 15:50:55 15 Information TCRTSOBJECTS Server started: TCRTSOBJECTS. 17.08.2021 15:50:55 15 Information TCRTIME Server started: TCRTIME. 17.08.2021 15:50:55 15 Information TCIO Server started: TCIO. 17.08.2021 15:50:55 69 Information Initializing COM Server Tc Event Logger ! 17.08.2021 15:50:55 71 Information Loading configuration of COM server Tc Event Logger ! 138 Version: 1.4.2 TE1000
## Page 139

Tc Xae Mgmt Version 6. X 17.08.2021 15:50:55 67 Information Stopping COM Server Tc Event Logger ! 17.08.2021 15:50:55 68 Information Shutting down COM Server Tc Event Logger ! Show Event Log of Twin CAT System Service between two points in time. PARAMETERS -Max Events Specifies the maximum number of events that are returned. Enter an integer such as 100. The default is to return all Twin CAT events. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Computer Name Specifies the name of the computer that this cmdlet gets events from the event logs. Type the Net BIOS name, an IP address, or the fully qualified domain name (FQDN) of the computer. The default value is the local computer, localhost. Type: String Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Credential Specifies a user account that has permission to perform this action. The default value is the current user. Type a user name, such as User01 or Domain01\User01. Or, enter a PSCredential object, such as one generated by the Get-Credential cmdlet. Type: PSCredential Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Level The log level, that is determined. By default, all Event Log content will be returned. Allowed values are: - All - Critical - Error - Warning - Informational - Verbose TE1000 Version: 1.4.2 139
## Page 140

Tc Xae Mgmt Version 6. X Type: String[] Parameter Sets: (All) Aliases: Required: False Position: Named Default value: All Accept pipeline input: False Accept wildcard characters: False -Source The log level, that is determined. By default, all Twin CAT Event Log content will be returned. Actually allowed values are: - All - Tc Sys UI - Tc Sys Srv - Tc Event Logger - Tc3Scope Server - 'TF3300 Twin CAT 3 Scope Server' - 'Twin CAT3 Scope Server' Type: String[] Parameter Sets: (All) Aliases: Required: False Position: Named Default value: All Accept pipeline input: False Accept wildcard characters: False -Start Time Filters the Event Log to return only entries that were produced after the specified start time. By default the start time is not set, returning Events from the beginning of the log. Type: Date Time Offset Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -End Time Filters the Event Log to return only entries that were produced up to the specified end time. By default the end time is not set, returning the newest entries. Type: Date Time Offset Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -ID Filters the Event Log to the specified Event Ids. Type: Int32[] Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None 140 Version: 1.4.2 TE1000
## Page 141

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Timeout Timeout of the Read event log operation (default: no timeout). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.32 Get-Tc License SYNOPSIS Get Twin CAT License information. SYNTAX Net Id Port (Default) Get-Tc License [-Name <String[]>] [-Order Id <String[]>] [-Net Id <Ams Net Id>] [- Status <License Status>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc License [-Name <String[]>] [-Order Id <String[]>] -Route <IRoute> [-Status <License Status>] [- Force] [-Progress Action <Action Preference>] [<Common Parameters>] TE1000 Version: 1.4.2 141
## Page 142

Tc Xae Mgmt Version 6. X Address Str Get-Tc License [-Name <String[]>] [-Order Id <String[]>] -Address <String> [- Status <License Status>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc License [-Name <String[]>] [-Order Id <String[]>] -Session <ISession> [- Status <License Status>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Tc License [-Name <String[]>] [-Order Id <String[]>] -Session Id <Int32> [- Status <License Status>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet gets information about Twin CAT licenses from the target system. To contact the target system, it must be available as actual route or the local system. EXAMPLES EXAMPLE 1 PS> Get-Tc License Get the the valid licenses from the local system. EXAMPLE 2 PS> $session = New-Tc Session -Route TC3TESTA1-CP67X -Port 30 PS> Get-Tc License -Status All -name *scope* -session $session Name Valid Validity Code Expire Time Available Used Volume No ---- ----- ------------ ---------- --------- ---- -------- TC3 Scope Server X Valid CPU License 0 0 TC3 Scope View Professional X Valid CPU License 0 0 Create a session to the License Server on target 'TC3TESTA1-CP67X' and return all valid and invalid licenses that contain 'scope' in their name. EXAMPLE 3 PS> Get-Tc License -Route TC3TESTA1-CP67X -Status Valid Name Valid Validity Code Expire Time Available Used Volume No ---- ----- ------------ ---------- --------- ---- -------- TC3 C++ / Mat Sim X Valid CPU License 0 0 TC3 CNC X Valid CPU License 0 0 TC3 Target For Matlab Simulink X Valid CPU License 0 0 TC3 CNC Axis X Valid CPU License 0 0 TC3 Serial-Communication X Valid CPU License 0 0 TC3 NC PTP Axes Pack unlimited X Valid CPU License 0 0 TC3 PLC / C++ / Mat Sim X Valid CPU License 0 0 TC3 Kinematic Transformation L4 X Valid CPU License 0 0 TC3 NC Camming X Valid CPU License 0 0 TC3 PLC-HMI Web X Valid CPU License 0 0 TC3 NC Flying Saw X Valid CPU License 0 0 TC3 CNC Spline X Valid CPU License 0 0 TC3 SMS-SMTP X Valid CPU License 0 0 TC3 Hydraulic Positioning X Valid CPU License 0 0 TC3 Kinematic Transformation L1 X Valid CPU License 0 0 ... Connect to the License Server on target 'TC3TESTa1-CP67X' and return all valid licenses. 142 Version: 1.4.2 TE1000
## Page 143

Tc Xae Mgmt Version 6. X EXAMPLE 4 > Get-Tc License -Net Id 172.17.60.153.1.1 -Status Invalid | format-list Id : 4c256767-e6e6-4af5-bd68-9f7abad0c200 Name : TC3 ADS Expire Time : 8/17/2017 12:00:00 AM Validity Code : Expired Valid : False Available Licenses : 0 Used Licenses : 0 Volume No : 0 Id : 66689887-ccbd-452c-ac9a-039d997c6e66 Name : TC3 PLC Expire Time : 8/17/2017 12:00:00 AM Validity Code : Expired Valid : False Available Licenses : 0 Used Licenses : 0 Volume No : 0 Id : 3ff18e97-7754-401b-93fb-70544de28a13 Name : TC3 IO Expire Time : 8/17/2017 12:00:00 AM Validity Code : Expired Valid : False Available Licenses : 0 Used Licenses : 0 Volume No : 0 Connect to Net Id 172.17.60.153.1.1, determine all invalid licenses and format the result into a list. EXAMPLE 5 > Get-Tc License -Order Id TE* Order ID Name Valid Validity Code Expire Time Available Used Volume No ------- ---- ----- ------------ ---------- --------- ---- -------- TE1400 TC3 Target For Matlab Simulink X Valid CPU License 0 0 TE1500 TC3 Valve-Diagram-Editor X Valid CPU License 0 0 TE1120 TC3 XCAD Interface X Valid CPU License 0 0 TE1510 TC3 Cam-Design-Tool X Valid CPU License 0 0 TE1110 TC3 Simulation Manager X Valid CPU License 0 0 TE1111 TC3 Ether CAT Simulation X Valid CPU License 0 0 TE1410 TC3 Interface For Matlab Simulink X Valid CPU License 0 0 TE1300 TC3 Scope View Professional X Valid CPU License 0 0 Get the valid licenses from local system and filter them for Order Ids starting with TE*. PARAMETERS -Name The name of the license to get. Wildcards are permitted. Type: String[] Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Order Id The Order ID of the license. TE1000 Version: 1.4.2 143
## Page 144

Tc Xae Mgmt Version 6. X Wildcards are permitted. Type: String[] Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Net Id The Net ID address of the target system where to load the licenses (Local by default). Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route The Route object where to load the licenses from (Route Target. Local by default). Type: IRoute Parameter Sets: Route Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address The address where to load the licenses. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The session object to use for license upload. This must target port 30 (Ams Port. R0_License Server). Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None 144 Version: 1.4.2 TE1000
## Page 145

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Session Id The unique session Identifier that represents the session to use for the license upload. Type: Int32 Parameter Sets: Session Id Aliases: Id Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Status The Status parameter selects the Licenses to return. Available is 'Valid' (the valid licenses), 'Invalid' (the invalid licenses) and 'All' ('Valid' + 'Invalid') licenses. The Default Value is 'All' Possible values: None, Valid, Invalid, All Type: License Status Parameter Sets: (All) Aliases: Accepted values: None, Valid, Invalid, All Required: False Position: Named Default value: All Accept pipeline input: False Accept wildcard characters: False -Force Force reading value. This flag bypasses internal caches and the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 145
## Page 146

Tc Xae Mgmt Version 6. X Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute The Route object where to load the licenses from (Route Target. Local by default). OUTPUTS NOTES 6.33 Get-Tc Router Info SYNOPSIS Gets the router status information of the specified target system. SYNTAX Net Id Port (Default) Get-Tc Router Info [[-Net Id] <Ams Net Id[]>] [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc Router Info [-Input Object] <IRoute[]> [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Tc Router Info [-Address] <String[]> [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc Router Info -Session <ISession[]> [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Tc Router Info -Session Id <Int32[]> [-Timeout <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet gets status information from the specified target system. To contact the target system, it must be available as actual route or must be the local system. The status information contains the amout of overall router memory and the used memory. Furthermore the number of active connections and the size of the actual router mailbox will be shown. 146 Version: 1.4.2 TE1000
## Page 147

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Get-Tc Router Info Target Result Total Mem(kb) Avail Mem(kb) Ports Drivers Transports Mailbox Size(kb) Mailbox Queue ------ ------ ------------- ------------- ----- ------- ---------- ----------------- ------------- CX_1234 Ok 32768 32759 31 4 11 0 0 Get router information from the local system. PARAMETERS -Net Id Net Id(s) of the target system. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The route object where to get the Target information from.. Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Target names/addresses. These can consist of Route Name, Net ID, Host Name or IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the value read. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None TE1000 Version: 1.4.2 147
## Page 148

Tc Xae Mgmt Version 6. X Accept pipeline input: True (By Property Name) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the value read. Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 2500 Accept pipeline input: False Accept wildcard characters: False -Count Specifies the number of repeats for this Cmdlet (Default is 1). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Delay The Delay in Seconds between repeated requests in Seconds (Default is 1s). A delay of 0 Seconds means as fast as possible. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} 148 Version: 1.4.2 TE1000
## Page 149

Tc Xae Mgmt Version 6. X Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The route object where to get the Target information from.. Twin CAT. ISession[] The Session to use for the value read. OUTPUTS NOTES 6.34 Get-Tc Session SYNOPSIS List the currently established Sessions. SYNTAX Default (Default) Get-Tc Session [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Id Get-Tc Session -Id <Int32> [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet lists all actually Point-To-Point connections to Twin CAT Targets in form of their session representation. Different types of Sessions can be accessed via the registered types of Session Providers (e.g. ADS, MQTT, OPC). EXAMPLES EXAMPLE 1 PS> Get-Tc Session Lists all actual initiated sessions. TE1000 Version: 1.4.2 149
## Page 150

Tc Xae Mgmt Version 6. X PARAMETERS -Id Specifies the ID of the session to get. Type: Int32 Parameter Sets: Id Aliases: Session ID Required: True Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Force Forces the Cmdlet to determine also the internal used sessions. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.35 Get-Tc Symbol SYNOPSIS Get the symbols from a Twin CAT target system / Device. 150 Version: 1.4.2 TE1000
## Page 151

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port (Default) Get-Tc Symbol [[-Path] <String[]>] [-Net Id <Ams Net Id>] -Port <Int32> [-Recurse] [-Reset Symbols] [- Force] [-Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Tc Symbol [[-Path] <String[]>] -Address <String> -Port <Int32> [-Recurse] [-Reset Symbols] [- Force] [-Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc Symbol [[-Path] <String[]>] -Route <IRoute> -Port <Int32> [-Recurse] [-Reset Symbols] [-Force] [-Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc Symbol [[-Path] <String[]>] -Session <ISession> [-Recurse] [-Reset Symbols] [-Force] [- Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Tc Symbol [[-Path] <String[]>] -Session Id <Int32> [-Recurse] [-Reset Symbols] [-Force] [- Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Literal Get-Tc Symbol -Literal Path <String[]> [-Net Id <Ams Net Id>] -Port <Int32> [-Recurse] [-Reset Symbols] [- Force] [-Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str Literal Get-Tc Symbol -Literal Path <String[]> -Address <String> -Port <Int32> [-Recurse] [-Reset Symbols] [- Force] [-Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Route Literal Get-Tc Symbol -Literal Path <String[]> -Route <IRoute> -Port <Int32> [-Recurse] [-Reset Symbols] [- Force] [-Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Session Literal Get-Tc Symbol -Literal Path <String[]> -Session <ISession> [-Recurse] [-Reset Symbols] [-Force] [- Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Literal Get-Tc Symbol -Literal Path <String[]> -Session Id <Int32> [-Recurse] [-Reset Symbols] [-Force] [- Include Arrays] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet get the symbolic information from a target system if symbols are provided. TE1000 Version: 1.4.2 151
## Page 152

Tc Xae Mgmt Version 6. X The information can be determined via different Providers (e.g. ADS, MQTT, OPC). EXAMPLES EXAMPLE 1 PS> Get-Tc Symbol -port 851 Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ tc2v Bool BOOL 1 .tc2v Bool tc2v Int INT 2 .tc2v Int Constants 0 Constants GVL 0 GVL MAIN 0 MAIN Slow 0 Slow Twin CAT_System Info Var List 0 Twin CAT_System Info Var List Get the root symbolic information from the local system (Port 851): EXAMPLE 2 PS>$session = New-Tc Session -Net Id 1.2.3.4.5.6 -Port 851 PS>$session | Get-Tc Symbol "Twin CAT_System Info Var List._App Info" -recurse Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ _App Info PLC. Plc App System Info 256 Twin CAT_System Info Var List._App Info Obj Id OTCID 4 Twin CAT_System Info Var List._App Info. Obj Id Task Cnt UDINT 4 Twin CAT_System Info Var List._App Info. Task Cnt Online Change Cnt UDINT 4 Twin CAT_System Info Var List._App Info. Online Change Cnt Flags DWORD 4 Twin CAT_System Info Var List._App Info. Flags Ads Port UINT 2 Twin CAT_System Info Var List._App Info. Ads Port Boot Data Loaded BOOL 1 Twin CAT_System Info Var List._App Info. Boot Data Loaded Old Boot Data BOOL 1 Twin CAT_System Info Var List._App Info. Old Boot Data App Timestamp DT 4 Twin CAT_System Info Var List._App Info. App Timestamp Keep Outputs On BP BOOL 1 Twin CAT_System Info Var List._App Info. Keep Outputs On BP Shutdown In Progress BOOL 1 Twin CAT_System Info Var List._App Info. Shutdown In Progress Licenses Pending BOOL 1 Twin CAT_System Info Var List._App Info. Licenses Pending BSODOccured BOOL 1 Twin CAT_System Info Var List._App Info. BSODOccured TCom Srv Ptr ITCom Object Server 4 Twin CAT_System Info Var List._App Info. TCom Srv Ptr App Name STRING(63) 64 Twin CAT_System Info Var List._App Info. App Name Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name Create a session to the target system '1.2.3.4.5.6' Port: 851 and get the symbol 'Twin CAT_System Info Var List._App Info' and its subsymbols recursively. EXAMPLE 3 PS> $session = New-Tc Session -Name 'CX_123456' -port 851 PS> $session | Get-Tc Symbol -recurse | where Instance Name -like 'Project*' Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name Gets an ADS-Session/Connection to the target system CX_123456 on port 851, downloads the symbol information recursively and returns all Instances where the instance name is like the pattern 'Project*'. EXAMPLE 4 PS> $s = New-Tc Session -port 851 PS> $s | Get-Tc Symbol -path '.tc2v Struct Array`[0`]','.tc2v Struct Array`[1`]' Instance Path Category Data Type Size Static Persistant IG IO ------------ -------- -------- ---- ------ ---------- ---- ------ .tc2v Struct Array[0] Struct ST_Simple Struct 165 False False 4040 117942 .tc2v Struct Array[1] Struct ST_Simple Struct 165 False False 4040 1179E7 Gets an ADS-Session/connection to the local system PLC (Port 851) and get two Array Elements. 152 Version: 1.4.2 TE1000
## Page 153

Tc Xae Mgmt Version 6. X Because the -path parameter uses the wildcard paramater '\[' and '\]' these characters must be escaped with backtick '\`'. EXAMPLE 5 PS> $s = New-Tc Session -port 851 PS> $s | Get-Tc Symbol -literal Path '.tc2v Struct Array[0]','.tc2v Struct Array[1]' Instance Path Category Data Type Size Static Persistant IG IO ------------ -------- -------- ---- ------ ---------- ---- ------ .tc2v Struct Array[0] Struct ST_Simple Struct 165 False False 4040 117942 .tc2v Struct Array[1] Struct ST_Simple Struct 165 False False 4040 1179E7 Gets an ADS-Session/connection to the local system PLC (Port 851) and gets two Array Elements with their literal path. PARAMETERS -Path The instance path of the Symbol(s). Because wildcards are permitted with path, the wildcard parameters '\[' and '\]' must be escaped with a backtick. Type: String[] Parameter Sets: Net Id Port, Address Str, Route, Session, Session Id Aliases: Required: False Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: True -Literal Path The literal instance path of the symbol (Path access without wildcard). Type: String[] Parameter Sets: Net Id Port Literal, Address Str Literal, Route Literal, Session Literal, Session Id Literal Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Net Id The target system Net Id. Type: Ams Net Id Parameter Sets: Net Id Port, Net Id Port Literal Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route The target system route. Type: IRoute Parameter Sets: Route, Route Literal Aliases: TE1000 Version: 1.4.2 153
## Page 154

Tc Xae Mgmt Version 6. X Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address for the target system where to get the symbol.. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str, Address Str Literal Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Port The target system port. Type: Int32 Parameter Sets: Net Id Port, Address Str, Route, Net Id Port Literal, Address Str Literal, Route Literal Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Session The session object that is used to get the symbols. Type: ISession Parameter Sets: Session, Session Literal Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id The unique id of the session object that is used to get the symbols. Type: Int32 Parameter Sets: Session Id, Session Id Literal Aliases: Id Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Recurse Gets the symbol recursively. Often used in conjunction with Wildcards in -Path 154 Version: 1.4.2 TE1000
## Page 155

Tc Xae Mgmt Version 6. X Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Reset Symbols Resets the symbols and datatypes cache. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the ADS access. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Include Arrays Active only in recursive mode - ignored otherwise. This parameter forces the Cmdlet to output all symbols - even Array Elements. Please take care because the output can be very lengthy dependent on the Size of the Array. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 155
## Page 156

Tc Xae Mgmt Version 6. X Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The session object that is used to get the symbols. OUTPUTS NOTES 6.36 Get-Tc Target Info SYNOPSIS Get Twin CAT Device Target information. SYNTAX Net Id Port (Default) Get-Tc Target Info [[-Net Id] <Ams Net Id[]>] [-Timeout <Int32>] [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc Target Info [-Input Object] <IRoute[]> [-Timeout <Int32>] [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Tc Target Info [-Address] <String[]> [-Timeout <Int32>] [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc Target Info -Session <ISession[]> [-Timeout <Int32>] [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] Session Id Get-Tc Target Info -Session Id <Int32[]> [-Timeout <Int32>] [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet gets information from the specified target system. To contact the target system, it must be available as actual route. The information contains the Target Name, Twin CAT Version, Running Operating system, CPU Architecture and Image Information. 156 Version: 1.4.2 TE1000
## Page 157

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Get-Tc Target Info Target Net Id Version OS Image Device CPUArch System Id Fingerprint ------ ----- ------- -- ----- ------ ------- -------- ----------- CX_11111 192.168.0.1.1.1 3.1.4026.2 Win10 AMD64 5b42297a-a9dd-6623-1780- e52074e54f71 2f72d63cba3069b5e1â€¦ Get the target information of the local system. EXAMPLE 2 PS> Get-Ads Route | Get-Tc Target Info Target Version Level OS Image Device CPUArch ------ ------- ----- -- ----- ------ ------- CP-15ECA0 3.1.4021.50 CP Win7 Intel X86 TC3TESTA1-CP67X 3.1.4021.54 CP Win7 Intel X86 Get the target information of the actual connected routes. PARAMETERS -Net Id Net Id(s) of the target system. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The route object where to get the Target information from.. Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Target names/addresses. These can consist of Route Name, Net ID, Host Name or IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None TE1000 Version: 1.4.2 157
## Page 158

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the value read. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the value read. Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Force reading value. This flag bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} 158 Version: 1.4.2 TE1000
## Page 159

Tc Xae Mgmt Version 6. X Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The route object where to get the Target information from.. Twin CAT. ISession[] The Session to use for the value read. OUTPUTS NOTES 6.37 Get-Tc Version SYNOPSIS Get the Twin CAT Version of a target system. SYNTAX Net Id Port (Default) Get-Tc Version [[-Net Id] <Ams Net Id[]>] [-Timeout <Int32>] [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] Route Get-Tc Version [-Timeout <Int32>] [-Input Object] <IRoute[]> [-Force] [- Progress Action <Action Preference>] [<Common Parameters>] Address Str Get-Tc Version [-Timeout <Int32>] [-Address] <String[]> [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Session Get-Tc Version [-Timeout <Int32>] -Session <ISession[]> [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] TE1000 Version: 1.4.2 159
## Page 160

Tc Xae Mgmt Version 6. X Session Id Get-Tc Version [-Timeout <Int32>] -Session Id <Int32[]> [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet gets the Twin CAT version of the specified target version and returns the version object. EXAMPLES EXAMPLE 1 PS> Get-Tc Version Major Minor Build Revision ----- ----- ----- -------- 3 1 4021 50 Get the Twin CAT version of the local system. EXAMPLE 2 PS> Get-Ads Route | Get-Tc Version Major Minor Build Revision ----- ----- ----- -------- 3 1 4021 50 3 1 4021 54 Get the Twin CAT version actual routes. PARAMETERS -Net Id The target address. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Input Object The target routes where to determine the Version information. 160 Version: 1.4.2 TE1000
## Page 161

Tc Xae Mgmt Version 6. X Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Addresses where to determine the Version information. The Addresses can consist of Net Id, IPAddress or Host Name. Wildcards are permitted. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the Cmdlet. Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Force Forces reading the version. This flag bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 161
## Page 162

Tc Xae Mgmt Version 6. X -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The target routes where to determine the Version information. Twin CAT. ISession[] The Session to use for the Cmdlet. OUTPUTS NOTES 6.38 New-Tc Session SYNOPSIS Create a new session to a Twin CAT Target. SYNTAX Net Id Port (Default) New-Tc Session [[-Net Id] <Ams Net Id>] [-Port] <Int32> [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Route New-Tc Session -Input Object <IRoute> [-Port] <Int32> [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] Address Str New-Tc Session [-Provider <String>] [-Address] <String> [[-Port] <Int32>] [-Force] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION Creates a new Point-To-Point Connection to a Twin CAT Target that is represented by the returned session object. Different types of Sessions can be accessed by the registered types of Session Providers (e.g. 162 Version: 1.4.2 TE1000
## Page 163

Tc Xae Mgmt Version 6. X ADS, MQTT, OPC). If using ADS as protocol, this Cmdlet is equivalent to create and connect an ADSClient. The Address of the remote system is the Ams Net Id and Ams Port. EXAMPLES EXAMPLE 1 PS> $route = Get-Ads Route -Name "Tc3*" PS> $session = New-Tc Session -Route $route -Port 851 PS> $session ID Address Connected State Cycles Losses Last Error Established Last Succee d -- ------- --------- ----- ------ ------ --------- ----------- ----------- 5 172.17.62.105.1.1:851 True Connected 0 0 2016-12-12T12:22:02 Establishes a new ADS Session/Connection to the specified route destination that has the name pattern "tc3*" via port 851 (PLC1) EXAMPLE 2 PS> New-Tc Session -Net Id '172.17.62.105.1.1' -port 851 ID Address Connected State Cycles Losses Last Error Established Last Succee d -- ------- --------- ----- ------ ------ --------- ----------- ----------- 5 172.17.62.105.1.1:851 True Connected 0 0 2016-12-12T12:22:02 Establishes a new Ads Session/Connection to the specified Net Id/Port address. EXAMPLE 3 PS> New-Tc Session -Name 'CX_123456' -port 851 ID Address Connected State Cycles Losses Last Error Established Last Succee d -- ------- --------- ----- ------ ------ --------- ----------- ----------- 5 172.17.62.105.1.1:851 True Connected 0 0 2016-12-12T12:22:02 Establishes a new Ads Session/Connection to the target system with the Name/Host Name 'CX_123456' (Port 851). PARAMETERS -Net Id The Net ID Address Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The route target object. TE1000 Version: 1.4.2 163
## Page 164

Tc Xae Mgmt Version 6. X Type: IRoute Parameter Sets: Route Aliases: Destination, Route Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Provider Selects the session provider registered on the System (ADS by default) Type: String Parameter Sets: Address Str Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The target address of the new session. This can be the Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Port The Ams Port Address of the new session. Type: Int32 Parameter Sets: Net Id Port, Route Aliases: Required: True Position: 2 Default value: 10000 Accept pipeline input: False Accept wildcard characters: False Type: Int32 Parameter Sets: Address Str Aliases: Required: False Position: 2 Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Force Forces to create the session independant of Reachable Routes 164 Version: 1.4.2 TE1000
## Page 165

Tc Xae Mgmt Version 6. X Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute The route target object. OUTPUTS NOTES 6.39 Read-Tc Value SYNOPSIS Reads values from Twin CAT devices. SYNTAX Net Id Port Symbol (Default) Read-Tc Value [-Net Id <Ams Net Id[]>] -Port <Int32> [-Path] <String> [-Extended] [-Force] [- Reset Symbols] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Indexed Read-Tc Value [-Net Id <Ams Net Id[]>] -Port <Int32> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Size] <Int32> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [- Progress Action <Action Preference>] [<Common Parameters>] TE1000 Version: 1.4.2 165
## Page 166

Tc Xae Mgmt Version 6. X Net Id Port Indexed Typed Read-Tc Value [-Net Id <Ams Net Id[]>] -Port <Int32> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Value Type] <Type> [-Size] <Int32> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Route Indexed Read-Tc Value -Route <IRoute[]> -Port <Int32> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [- Size] <Int32> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [- Progress Action <Action Preference>] [<Common Parameters>] Route Indexed Typed Read-Tc Value -Route <IRoute[]> -Port <Int32> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Value Type] <Type> [[-Size] <Int32>] [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Route Symbol Read-Tc Value -Route <IRoute[]> -Port <Int32> [-Path] <String> [-Extended] [-Force] [-Reset Symbols] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Address Indexed Read-Tc Value -Address <String[]> -Port <Int32> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [- Size] <Int32> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [- Progress Action <Action Preference>] [<Common Parameters>] Address Indexed Typed Read-Tc Value -Address <String[]> -Port <Int32> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Value Type] <Type> [[-Size] <Int32>] [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Address Symbol Read-Tc Value -Address <String[]> -Port <Int32> [-Path] <String> [-Extended] [-Force] [-Reset Symbols] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Indexed Read-Tc Value -Session <ISession[]> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [- Size] <Int32> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Indexed Typed Read-Tc Value -Session <ISession[]> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [- Value Type] <Type> [[-Size] <Int32>] [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [- Progress Action <Action Preference>] [<Common Parameters>] Session Symbol Read-Tc Value -Session <ISession[]> [-Path] <String> [-Extended] [-Force] [-Reset Symbols] [- Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] 166 Version: 1.4.2 TE1000
## Page 167

Tc Xae Mgmt Version 6. X Session Id Indexed Read-Tc Value -Session Id <Int32[]> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [- Size] <Int32> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Indexed Typed Read-Tc Value -Session Id <Int32[]> [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [- Value Type] <Type> [[-Size] <Int32>] [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [- Progress Action <Action Preference>] [<Common Parameters>] Session Id Symbol Read-Tc Value -Session Id <Int32[]> [-Path] <String> [-Extended] [-Force] [-Reset Symbols] [- Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] Input Object Read-Tc Value [-Input Object] <ISymbol> [-Force] [-Timeout <Int32>] [-Encoding <Encoding>] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet read values from Twin CAT Devices. The devices can be accessed via different Value Providers. EXAMPLES EXAMPLE 1 PS> $session = New-Tc Session -Net Id '1.2.3.4.5.6' -Port 851 PS> $symbol = $session | get-Tc Symbol -Path 'Twin CAT_System Info Var List._App Info. Project Name' PS> $symbol | Read-Tc Value ADS_Dyn Symbols Create an ADS Session/Connection, determine the 'Project Name' Symbol from the running PLC Project, read the current value of the symbol and print it to the console. EXAMPLE 2 PS> Read-Tc Value -Index Group 0x4040 -Index Offset 0x1247a8 -Net Id 172.17.62.105.1.1 -port 851 - size 0xff | format-hex 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 00000000 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 00 00 ADS_Dyn Symbols.. 00000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000040 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000050 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000060 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000070 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000080 11 00 01 01 A0 86 01 00 14 00 5E 01 21 C2 15 00 .... ?....^.! A.. 00000090 00 7F F1 57 3B 83 6C 07 1E 00 00 00 00 00 00 00 .âŒ‚Ã±W;?l......... 000000A0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000B0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000C0 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 5F 50 ADS_Dyn Symbols_P 000000D0 6C 63 54 61 73 6B 00 00 00 00 00 00 00 00 00 00 lc Task.......... 000000E0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 000000F0 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ............... Reads 256 Bytes via Index Group/Index Offset from the specified target system and prints the out formatted as hexdump. TE1000 Version: 1.4.2 167
## Page 168

Tc Xae Mgmt Version 6. X EXAMPLE 3 PS> Read-Tc Value -session $session -Index Group 0x4040 -Index Offset 0x1247A8 -Value Type String ADS_Dyn Symbols Reads a string typed value from Index Group / Index Offset. In this example the Project Name of the running PLC Project resides at that Process Image Address. EXAMPLE 4 PS> $route = Get-Ads Route -Name 'CX-123456' PS> $session = $route | New-Tc Session -Port 851 PS> $handle = $session | Send-Tc Read Write -Index Group Symbol Handle By Name -Write Value "GVL.vg Int" - Read Type Int32 -force PS> $session | Read-Tc Value -Index Group Symbol Value By Handle -Index Offset $handle -Value Type Int16 42 Create a session to the PLC (Port 851) of a target system, determine the Symbol Handle by Instance Path and use this handle to read its 'Int16' Value (INT on PLC System). PARAMETERS -Net Id The Net Id part of the Ams Address for the value read. Type: Ams Net Id[] Parameter Sets: Net Id Port Symbol, Net Id Port Indexed, Net Id Port Indexed Typed Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route Specifies the target system(s) to read value from. Type: IRoute[] Parameter Sets: Route Indexed, Route Indexed Typed, Route Symbol Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The Address(es) of the system(s) where to read the value. The Address can consist of Net Id, IPAddress or Host Name. Wildcards are permitted. Type: String[] Parameter Sets: Address Indexed, Address Indexed Typed, Address Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True 168 Version: 1.4.2 TE1000
## Page 169

Tc Xae Mgmt Version 6. X -Session The Session to use for the value read. Type: ISession[] Parameter Sets: Session Indexed, Session Indexed Typed, Session Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the value read. Type: Int32[] Parameter Sets: Session Id Indexed, Session Id Indexed Typed, Session Id Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Port The address Port to use for the value read. Type: Int32 Parameter Sets: Net Id Port Symbol, Net Id Port Indexed, Net Id Port Indexed Typed, Route Indexed, Route Indexed Typed, Route Symbol, Address Indexed, Address Indexed Typed, Address Symbol Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Index Group The Index Group of the Symbol to read from target system. Only for Index Group/Index Offset access. Type: UInt32 Parameter Sets: Net Id Port Indexed, Net Id Port Indexed Typed, Route Indexed, Route Indexed Typed, Address Ind exed, Address Indexed Typed, Session Indexed, Session Indexed Typed, Session Id Indexed, Session Id Indexed Ty ped Aliases: IG Required: True Position: 1 Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Index Offset The Index Offset of the Symbol to read from the target system. Only for Index Group/Index Offset access. Type: UInt32 Parameter Sets: Net Id Port Indexed, Net Id Port Indexed Typed, Route Indexed, Route Indexed Typed, Address Ind exed, Address Indexed Typed, Session Indexed, Session Indexed Typed, Session Id Indexed, Session Id Indexed Ty ped Aliases: IO TE1000 Version: 1.4.2 169
## Page 170

Tc Xae Mgmt Version 6. X Required: False Position: 2 Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Value Type The data Type of the Value for a 'Read Any' access. Only usable with Index Group/Index Offset access. Type: Type Parameter Sets: Net Id Port Indexed Typed, Route Indexed Typed, Address Indexed Typed, Session Indexed Typed, Session Id Indexed Typed Aliases: Type, Read Type Required: True Position: 3 Default value: None Accept pipeline input: False Accept wildcard characters: False -Size The 'Size' of Value (in bytes) to read. Type: Int32 Parameter Sets: Net Id Port Indexed, Net Id Port Indexed Typed, Route Indexed, Address Indexed, Session Indexe d, Session Id Indexed Aliases: Read Size, Length Required: True Position: 3 Default value: -1 Accept pipeline input: False Accept wildcard characters: False Type: Int32 Parameter Sets: Route Indexed Typed, Address Indexed Typed, Session Indexed Typed, Session Id Indexed Typed Aliases: Read Size, Length Required: False Position: 3 Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Path The instance path of the symbol to read (symbolic access). This parameter supports wildcards. Type: String Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol, Session Symbol, Session Id Symbol Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Input Object The symbol object to read value from. Type: ISymbol Parameter Sets: Input Object Aliases: Symbol 170 Version: 1.4.2 TE1000
## Page 171

Tc Xae Mgmt Version 6. X Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Extended Switch on 'Extended Mode', what means that primitive values are not resolved to their primitive managed (powershell) counterparts, but still contain rich metadata as Dynamic Values. Type: Switch Parameter Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol, Session Symbol, Session Id Symbol Aliases: Full Metadata Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Force reading value. This flag bypasses the Fail Fast Interceptor to retry communication in every case. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Reset Symbols Resets the symbols and datatypes cache when using symbolic access. Type: Switch Parameter Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol, Session Symbol, Session Id Symbol Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 171
## Page 172

Tc Xae Mgmt Version 6. X -Encoding Specifies the Encoding for strings. The Default Encoding is ANSI with actual code page. Type: Encoding Parameter Sets: (All) Aliases: Required: False Position: Named Default value: System. Text. SBCSCode Page Encoding Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession[] The Session to use for the value read. Twin CAT. Type System. ISymbol The symbol object to read value from. OUTPUTS NOTES 6.40 Register-Ads Handle SYNOPSIS Registers and returns a symbol handle. SYNTAX Net Id Port Symbol (Default) Register-Ads Handle [-Net Id <Ams Net Id>] -Port <Int32> [-Path] <String[]> [- Progress Action <Action Preference>] [<Common Parameters>] 172 Version: 1.4.2 TE1000
## Page 173

Tc Xae Mgmt Version 6. X Route Symbol Register-Ads Handle -Route <IRoute> -Port <Int32> [-Path] <String[]> [- Progress Action <Action Preference>] [<Common Parameters>] Address Symbol Register-Ads Handle -Address <String> -Port <Int32> [-Path] <String[]> [- Progress Action <Action Preference>] [<Common Parameters>] Session Symbol Register-Ads Handle -Session <ISession> [-Path] <String[]> [-Progress Action <Action Preference>] [<Common Parameters>] Session Id Symbol Register-Ads Handle -Session Id <Int32> [-Path] <String[]> [-Progress Action <Action Preference>] [<Common Parameters>] Input Object Register-Ads Handle [-Input Object] <ISymbol[]> [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet registers a symbol handle at the connected system. The handle is returned as Ads Handle Info. EXAMPLES EXAMPLE 1 PS> $session = New-Tc Session -Net Id '1.2.3.4.5.6' -Port 851 PS> $handle Info = $session | Register-Ads Handle - Path 'Twin CAT_System Info Var List._App Info. Project Name' PS> $handle Info = Register-Ads Handle -Path 'Twin CAT_System Info Var List._App Info. Project Name' - Session $s PS> $handle Info Instance Path Result Handle ------------ ------ ------ Twin CAT_System Info Var List._App Info. Project Name No Error 0x428000FC (1115685116) PS> Read-Tc Value -Session $session -Index Group Symbol Value By Handle -Index Offset $handle Info. Handle - Type String My Project PS> $handle | Unregister-Ads Handle -Session $session PS> $session | Close-tcsession Opens a new device session, registers a Symbol Handle to the Project Name of the running PLC Project, Reads the value by handle unregisters the handle and closes the session again. PARAMETERS -Net Id The Net Id address of the Target system Type: Ams Net Id Parameter Sets: Net Id Port Symbol Aliases: TE1000 Version: 1.4.2 173
## Page 174

Tc Xae Mgmt Version 6. X Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route Specifies the route of the target system. Type: IRoute Parameter Sets: Route Symbol Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The Address of the target system where to register the symbol handle. The Address can consist of Route Name, Net Id, IPAddress or Host Name. Wildcards are permitted. Type: String Parameter Sets: Address Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use (instead of addressing the target system). Type: ISession Parameter Sets: Session Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use instead of specifying the target address. Type: Int32 Parameter Sets: Session Id Symbol Aliases: Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Port The address Port to use (always in combination with the Net Id). Argument Completer is supported. 174 Version: 1.4.2 TE1000
## Page 175

Tc Xae Mgmt Version 6. X Type: Int32 Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Path The instance path to the symbol. Type: String[] Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol, Session Symbol, Session Id Symbol Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Input Object The symbol object. Type: ISymbol[] Parameter Sets: Input Object Aliases: Symbol Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use (instead of addressing the target system). Twin CAT. Type System. ISymbol[] The symbol object. TE1000 Version: 1.4.2 175
## Page 176

Tc Xae Mgmt Version 6. X OUTPUTS NOTES 6.41 Register-Ads Nat Route SYNOPSIS Changes an standard Route to an Ams NAT route on the target system (obsolete). SYNTAX Name (Default) Register-Ads Nat Route [-Name] <String> -NATNet Id <Ams Net Id> [-Destination <String>] [-Quiet] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id Register-Ads Nat Route [-Net Id] <Ams Net Id> -NATNet Id <Ams Net Id> [-Destination <String>] [-Quiet] [- Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet Changes an standard Route to an Ams NAT route on the target system. The route must be preexisting and the cmdlet adds the Remote Net Id/Ams NAT information to the Static Routes.xml of the destination system. Afterwards the destination system needs a Twin CAT Restart. For Twin CAT Versions \>= 3.1.4024.11 (or newer), the Add-Ads Route Cmdlet should be used with the -NAT Parameter as Replacement. Therefore, this 'Register-Ads Nat Route' Cmdlet is classified as 'obsolete' and of limitied use and could be removed in future. EXAMPLES EXAMPLE 1 PS> Register-Ads Nat Route -Name My Route -NATNet Id 1.2.3.4.2.2 Adds an Ams NAT address translation to the existing route 'My Route' on the local system (e.g. from '1.2.3.4.1.1' to '1.2.3.4.2.2'). EXAMPLE 2 PS> Register-Ads Nat Route -Net Id 1.2.3.4.1.1 -NATNet Id 1.2.3.4.2.2 -Destination CX_1234 Adds an Ams NAT address translation to the existing route with Net Id '1.2.3.4.1.1' to NATNet Id '1.2.3.4.2.2' on System 'CX_1234'. PARAMETERS -Name The Name of the Route where to add an Ams NAT entry. Type: String Parameter Sets: Name Aliases: 176 Version: 1.4.2 TE1000
## Page 177

Tc Xae Mgmt Version 6. X Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Net Id The Net ID which specifies the existing route where to add an Ams NAT entry. This Net Id becomes the 'Remote Net Id' afterwards. Type: Ams Net Id Parameter Sets: Net Id Aliases: Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -NATNet Id The NATNet Id (the local representation of the remote system). Type: Ams Net Id Parameter Sets: (All) Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Destination The Destination system, where the Ams NAT translation is added. This Parameter allows Route Name, Ams Net Id, IPAddress or Host Name Type: String Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) TE1000 Version: 1.4.2 177
## Page 178

Tc Xae Mgmt Version 6. X Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. 178 Version: 1.4.2 TE1000
## Page 179

Tc Xae Mgmt Version 6. X INPUTS OUTPUTS NOTES 6.42 Remove-Ads Route SYNOPSIS Remove an ADS Route. SYNTAX Address (Default) Remove-Ads Route [-Destination <IRoute>] [-Address] <String[]> [-Quiet] [-Force] [- Credentials <PSCredential>] [-Mode <Route Change Mode>] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Net Id Remove-Ads Route [-Destination <IRoute>] [-Net Id] <Ams Net Id> [-Quiet] [-Force] [- Credentials <PSCredential>] [-Mode <Route Change Mode>] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Route Remove-Ads Route [-Destination <IRoute>] [-Input Object] <Route Target Collection> [-Quiet] [-Force] [-Credentials <PSCredential>] [-Mode <Route Change Mode>] [-Progress Action <Action Preference>] [- What If] [-Confirm] [<Common Parameters>] DESCRIPTION Removes static or temporary routes from the local system or from remote systems. If access is available, the route is removed on both endpoints of the Route. EXAMPLES EXAMPLE 1 PS> Get-Ads Route Name Net Id Address Sub Tc Version RTSystem ---- ----- ------- --- --------- -------- CP-15ECA0 172.17.62.128.1.1 172.17.62.178 0.0 Unknown TC3TESTA1-CP67X 172.17.62.105.1.1 172.17.62.105 0.0 Unknown PS> Remove-Ads Route -Name "CP-15ECA0","TC3TESTA1*" Removes the Routes "CP-15ECA0" and "TC3TESTA1-CP67X" from the local system. EXAMPLE 2 PS> Get-Ads Route | Remove-Ads Route -silent Removes all registered routes from the local system. TE1000 Version: 1.4.2 179
## Page 180

Tc Xae Mgmt Version 6. X PARAMETERS -Destination The destination address, where to Remove the specified route. This can be the Net Id, the Host Name or the IPAddress Type: IRoute Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address for the ADS route to remove. This can be the Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Aliases: Name Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: True -Net Id The Net ID of the route to remove. Type: Ams Net Id Parameter Sets: Net Id Aliases: Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object A collection of routes to remove (Pipeline support). Type: Route Target Collection Parameter Sets: Route Aliases: Required: True Position: 0 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. 180 Version: 1.4.2 TE1000
## Page 181

Tc Xae Mgmt Version 6. X Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Credentials Destination system route credentials (only if removing remotely). Type: PSCredential Parameter Sets: (All) Aliases: Required: False Position: Named Default value: System. Management. Automation. PSCredential Accept pipeline input: False Accept wildcard characters: False -Mode The Mode parameter indicates if the Router should be deleted on on side or on both sides (default). Possible values: Single, Both Type: Route Change Mode Parameter Sets: (All) Aliases: Accepted values: Single, Both Required: False Position: Named Default value: Both Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 181
## Page 182

Tc Xae Mgmt Version 6. X -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. Route Target Collection A collection of routes to remove (Pipeline support). OUTPUTS NOTES 6.43 Remove-Mqtt Route SYNOPSIS Remove a MQQT Route. SYNTAX Address (Default) Remove-Mqtt Route [-Address] <String> [[-Port] <Int32>] [-Destination <String>] [-Quiet] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Info Remove-Mqtt Route -Input Object <Mqtt Config[]> [-Destination <String>] [-Quiet] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] 182 Version: 1.4.2 TE1000
## Page 183

Tc Xae Mgmt Version 6. X DESCRIPTION Removes a MQQT Route of the specified system. EXAMPLES EXAMPLE 1 PS> Remove-Mqtt Route -address 1.2.3.4 -port 42 -Destination CX_1234 Removes the MQTT route on the destination System 'CX_1234' to MQTT Broker with Address '1.2.3.4' and Port '42'. PARAMETERS -Address The IPAddress or Host Name of the Mqtt broker system to remove. Type: String Parameter Sets: Address Aliases: Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Port The TCP/IP port specification. Type: Int32 Parameter Sets: Address Aliases: Required: False Position: 1 Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Input Object The Mqtt routes to remove. Type: Mqtt Config[] Parameter Sets: Route Info Aliases: Mqtt Route Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Destination The destination address, where to Remove the specified Mqtt route. This can be the Net Id, the Host Name or the IPAddress Type: String Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None TE1000 Version: 1.4.2 183
## Page 184

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False 184 Version: 1.4.2 TE1000
## Page 185

Tc Xae Mgmt Version 6. X Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. Ads. Configuration. Mqtt Config[] The Mqtt routes to remove. OUTPUTS NOTES 6.44 Reset-Io Free Run SYNOPSIS Resets the IO Free Run state on the specified target. SYNTAX Net Id Port List (Default) Reset-Io Free Run [-Quiet] [-Timeout <Int32>] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Net Id Port Reset-Io Free Run -Net Id <Ams Net Id> [-Quiet] [-Timeout <Int32>] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Reset-Io Free Run [[-Address] <String>] [-Quiet] [-Timeout <Int32>] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Reset-Io Free Run -Session <ISession> [-Quiet] [-Timeout <Int32>] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION Resets the IO Free Run state on the specified target if its in Config state. If its not in config state an error will be produced TE1000 Version: 1.4.2 185
## Page 186

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Reset-IOFree Run -Net Id 5.62.192.46.1.1 Reset the IO Free Run mode of the target system with Net ID 5.62.192.46.1.1. PARAMETERS -Net Id Net Id of the target system where to Reset the Free Run. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to set the free run. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet, must be connected to port 300, R0_IO Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False 186 Version: 1.4.2 TE1000
## Page 187

Tc Xae Mgmt Version 6. X -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. TE1000 Version: 1.4.2 187
## Page 188

Tc Xae Mgmt Version 6. X INPUTS Twin CAT. ISession The Session to use for the Cmdlet, must be connected to port 300, R0_IO OUTPUTS NOTES 6.45 Restart-Ads Computer SYNOPSIS Restarts ("reboots") the operating system on local and remote Twin CAT computers. SYNTAX Net Id Port (Default) Restart-Ads Computer [-Wait] [-Wait Timeout <Int32>] [-Delay <Int32>] [[-Net Id] <Ams Net Id[]>] [- Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Restart-Ads Computer [-Wait] [-Wait Timeout <Int32>] [-Delay <Int32>] [-Input Object] <IRoute[]> [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Address Str Restart-Ads Computer [-Wait] [-Wait Timeout <Int32>] [-Delay <Int32>] [-Address] <String[]> [- Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Restart-Ads Computer [-Wait] [-Wait Timeout <Int32>] [-Delay <Int32>] -Session <ISession[]> [- Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Restart-Ads Computer [-Wait] [-Wait Timeout <Int32>] [-Delay <Int32>] -Session Id <Int32[]> [- Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION The Restart-Ads Computer cmdlet restarts the operating system on the local and remote Twin CAT computers. You can use the parameters of Restart-Ads Computer to specify available ADS target systems to restart. The restart can be done delayed if Users are logged into the target system (existant Session UI) or forced immediatly. You can wait for the restart to complete before you run the next command and specify a waiting time-out. This feature makes it practical to use Restart-Ads Computer in scripts and functions. 188 Version: 1.4.2 TE1000
## Page 189

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Restart-Ads Computer CX_1111,CX_2222 -force Restarts the computers CX_1111 and CX_2222 immediatly without warning logged in users on the target system and returns immediatly without waiting the finished reboot. The Force parameter supresses the Should Process query. EXAMPLE 2 PS> Restart-Ads Computer -net Id '1.2.3.4.1.1', '1.2.3.5.1.1' -Delay 30 -Wait -Wait Timeout 240 -force Restarts the Twin CAT targets '1.2.3.4.1.1' and 1.2.3.5.1.1' without Should Process query after a delay of 30 Seconds (if a user is logged in) and waits for the reboot before continuing. The Wait timeout is set to 240 Seconds. PARAMETERS -Wait Activates a wait until the rebooted system is available again. The parameter -Wait Timeout specifies how long the script waits for the reboot. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Wait Timeout The Wait time for the reboot of the target system (default 120 Seconds). This parameter is used in conjunction with the -Wait parameter. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 120 Accept pipeline input: False Accept wildcard characters: False -Delay The delay time for the reboot/shutdown of the target system(s) in seconds. The default is 120 Seconds. If no user is logged in the target system the reboot/shotdown occurs always immediatly without warning. In case of a log in, a Warning message with countdown will be presented to the user. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named TE1000 Version: 1.4.2 189
## Page 190

Tc Xae Mgmt Version 6. X Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Net Id Net Id(s) of the target system. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The ADS routes to shutdown/reboot. Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Target names/addresses. These can consist of Route Name, Net ID, Host Name or IPAddress. This parameter supports wildcards. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session(s) to use for addressing the target systems. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Sessions (with unique ID) to use for addressing the target systems. Type: Int32[] Parameter Sets: Session Id Aliases: 190 Version: 1.4.2 TE1000
## Page 191

Tc Xae Mgmt Version 6. X Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. TE1000 Version: 1.4.2 191
## Page 192

Tc Xae Mgmt Version 6. X The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The ADS routes to shutdown/reboot. Twin CAT. ISession[] The Session(s) to use for addressing the target systems. OUTPUTS NOTES 6.46 Send-Tc Read Write SYNOPSIS Sends a Read/Write access to ADS Server / Twin CAT Devices. SYNTAX Net Id Port Indexed (Default) Send-Tc Read Write -Index Group <UInt32> [-Index Offset <UInt32>] [-Write Value <Object>] [- Write Length <Int32>] [-Read Length <Int32>] [-Read Type <Type>] [-Net Id <Ams Net Id[]>] -Port <Int32> [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Indexed Send-Tc Read Write -Index Group <UInt32> [-Index Offset <UInt32>] [-Write Value <Object>] [- Write Length <Int32>] [-Read Length <Int32>] [-Read Type <Type>] -Address <String[]> -Port <Int32> [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Indexed Send-Tc Read Write -Index Group <UInt32> [-Index Offset <UInt32>] [-Write Value <Object>] [- Write Length <Int32>] [-Read Length <Int32>] [-Read Type <Type>] -Route <IRoute[]> -Port <Int32> [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] 192 Version: 1.4.2 TE1000
## Page 193

Tc Xae Mgmt Version 6. X Session Indexed Send-Tc Read Write -Index Group <UInt32> [-Index Offset <UInt32>] [-Write Value <Object>] [- Write Length <Int32>] [-Read Length <Int32>] [-Read Type <Type>] -Session <ISession[]> [-Encoding <Encoding>] [- Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Indexed Send-Tc Read Write -Index Group <UInt32> [-Index Offset <UInt32>] [-Write Value <Object>] [- Write Length <Int32>] [-Read Length <Int32>] [-Read Type <Type>] -Session Id <Int32[]> [-Encoding <Encoding>] [- Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet Read/Writes values from/to Twin CAT Devices and works with different Value Providers. Because this is a low level data access, only Index Group/Index Offset addressing is available. IMPORTANT: Sending Read/Write commands should be done with highest care because it could destabilize the Twin CAT System when the write operation is not addressed properly. To enhance secure operation, the user is enforced to use Length parameters in conjunction with the in/out values which will be checked by the Cmdlet. The highest attention should also be taken with the Index Group/Index Offset because that represents the Address in the Process Image and cannot be checked by principle. To prevent that process image overwrites important data by accident please use the -What If and -Confirm parameters whenever it is appropriate and inform about the $Confirm Preference settings ( PS\> get-help about_Preference_Variables) before usage of the Send-Tc Read Write Cmdlet. EXAMPLES EXAMPLE 1 PS> Send-Tc Read Write -Net Id 1.2.3.4.5.6 -Port 851 -Index Group Symbol Value By Name -Index Offset 0 - Write Value "Twin CAT_System Info Var List._App Info. Project Name" -Read Type string -Read Length 1024 Read Write access of process image on target '1.2.3.4.5.6:851': Start Read Write operation Write Data: 'Twin CAT_System Info Var List._App Info. Project Name'(IG:0xf004,IO:0 x0000,Len:47), Read: Type 'System. String' (Len:'1024) on target '1.2.3.4.5.6:851'? [Y] Yes[A] Yes to All[N] No[L] No to All[S] Suspend[?] Help(default is "Y"): y ADS_Dyn Symbols Sends a Read/Write request with index group 0xf004 (Symbol Value By Name) and offset 0. The write data will be initialized with the project symbol path and an returned (read) string (Default encoded) returned. EXAMPLE 2 PS> Send-Tc Read Write -Net Id 1.2.3.4.5.6 -Port 851 -Index Group Symbol Value By Name - Write Value "Twin CAT_System Info Var List._App Info. Project Name" -Read Length 64 | format-hex Read Write access of process image on target '1.2.3.4.5.6:851': Start Read Write operation Write Data: 'Twin CAT_System Info Var List._App Info. Project Name'(IG:0xf004,IO:0 x0000,Len:47), Read: Type 'System. Byte[]' (Len:'64) on target '1.2.3.4.5.6:851'? [Y] Yes[A] Yes to All[N] No[L] No to All[S] Suspend[?] Help(default is "Y"): y 00 01 02 03 04 05 06 07 08 09 0A 0B 0C 0D 0E 0F 00000000 41 44 53 5F 44 79 6E 53 79 6D 62 6F 6C 73 00 00 ADS_Dyn Symbols.. 00000010 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ TE1000 Version: 1.4.2 193
## Page 194

Tc Xae Mgmt Version 6. X 00000020 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ 00000030 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 ................ Sends a Read/Write request with index group 0xf004 (Symbol Value By Name) and offset 0. The write data will be initialized with the project symbol path and the returned (read) data is by default a byte array of 64 bytes. The result value will be formatted as hex code. EXAMPLE 3 PS> $route = Get-Ads Route -Name 'CX-123456' PS> $session = $route | New-Tc Session -Port 851 PS> $handle = $session | Send-Tc Read Write -Index Group Symbol Handle By Name -Write Value "GVL.vg Int" - Read Type Int32 -force PS> $session | Read-Tc Value -Index Group Symbol Value By Handle -Index Offset $handle -Value Type Int16 42 Create a session to the PLC (Port 851) of a target system, determine the Symbol Handle by Instance Path and use this handle to read its 'Int16' Value (INT on PLC System). PARAMETERS -Index Group Index Group of the Value to Read Write, only for Index Group/Index Offset access. IMPORTANT: Please be aware, that writing data via Index Group/Index Offset can overwrite data in the Process Image and posibly destabilizes the system. No validity check is done for the symbol alignment and therefore this should be done with highest care! Type: UInt32 Parameter Sets: (All) Aliases: IG Required: True Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Index Offset Index Offset of the Value to write, only for Index Group/Index Offset access. IMPORTANT: Please be aware, that writing data via Index Group/Index Offset simply overwrites data in the Process Image and can destabilize the system. No validity check is done for the symbol alignment and therefore this should be done with highest care! If applicable writing data via symbolic information should be preferred! Type: UInt32 Parameter Sets: (All) Aliases: IO Required: False Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Write Value The value to write. 194 Version: 1.4.2 TE1000
## Page 195

Tc Xae Mgmt Version 6. X If no additional Length parameter is set, the Write-Tc Value Cmdlet marshals this value to its appropriate size. To not overwrite data of other symbols within the process image, special attention must be taken (see the Confirm and Whatif parameters). Type: Object Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Write Length The Length of the data that will be overwritten within the process image. By default the marshal size of the object used in the -Write Value parameter is taken. This parameter is used to override the marshal size and can be helpful to secure the write operation - to not overwrite more data then expected. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Read Length The Length of the data that will be read from the process image. By default, when not specifiying this parameter the marshalling size of the -Read Type parameter will be taken. This -Read Length parameter is only helpful when the marshalling size cannot be determined from the read type (e.g. byte\[\]) Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Read Type Use the Read Type parameter to specify the Read/Return type of the data. If not used, this cmdlet returns the raw byte\[\] as result. Type: Type Parameter Sets: (All) Aliases: Required: False Position: Named Default value: System. Byte[] TE1000 Version: 1.4.2 195
## Page 196

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Net Id The ADS target Net ID(s) of the system(s) where to read/write the Value. More than one target will be supported. When not specified, this argument defaults to Ams Net Id. Local. Type: Ams Net Id[] Parameter Sets: Net Id Port Indexed Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route The target system (as Route) where to read/write the value. Type: IRoute[] Parameter Sets: Route Indexed Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The target address where to read/write the Value. The Address can consist of Route Name, Net Id, Host Name or IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Indexed Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The session object represents the target session where to read/write the value. Type: ISession[] Parameter Sets: Session Indexed Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Session Id The session ID represents the target session where to read/write the value. 196 Version: 1.4.2 TE1000
## Page 197

Tc Xae Mgmt Version 6. X Type: Int32[] Parameter Sets: Session Id Indexed Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Port The Port, where to read/write the value. This Parameter is used in combination with the Net Id, Route or Address input parameter. Type: Int32 Parameter Sets: Net Id Port Indexed, Address Indexed, Route Indexed Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Encoding Specifies the Encoding for strings. The Default is ANSI with actual code page. Type: Encoding Parameter Sets: (All) Aliases: Required: False Position: Named Default value: System. Text. SBCSCode Page Encoding Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Forces the Read/Write operation, even if the Fail Fast Handler is active. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False TE1000 Version: 1.4.2 197
## Page 198

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. 198 Version: 1.4.2 TE1000
## Page 199

Tc Xae Mgmt Version 6. X INPUTS Twin CAT. ISession[] The session object represents the target session where to read/write the value. OUTPUTS NOTES 6.47 Set-Ads State SYNOPSIS Writes a Ads State control request to the specified target. SYNTAX Net Id Port (Default) Set-Ads State [-Command] <Ads State Command> [[-Net Id] <Ams Net Id[]>] [[-Port] <Int32>] [-Quiet] [- Force] [-State Only] [-Timeout <Int32>] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Throw Error] [- No Reinit] [-Reinitialize] [-No Wait] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Address Str Set-Ads State [-Command] <Ads State Command> [[-Port] <Int32>] [-Address] <String[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Throw Error] [- No Reinit] [-Reinitialize] [-No Wait] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Route Set-Ads State [-Command] <Ads State Command> [[-Port] <Int32>] [-Input Object] <IRoute[]> [-Quiet] [- Force] [-State Only] [-Timeout <Int32>] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Throw Error] [- No Reinit] [-Reinitialize] [-No Wait] [-Progress Action <Action Preference>] [-What If] [- Confirm] [<Common Parameters>] Session Set-Ads State [-Command] <Ads State Command> -Session <ISession[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Throw Error] [-No Reinit] [- Reinitialize] [-No Wait] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Set-Ads State [-Command] <Ads State Command> -Session Id <Int32[]> [-Quiet] [-Force] [-State Only] [-Timeout <Int32>] [-Wait Timeout <Int32>] [-Polling Rate <Int32>] [-Throw Error] [-No Reinit] [- Reinitialize] [-No Wait] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet sets the ADS State of the specified Twin CAT Targets/Ads Servers (E.g. Start / Stop / Config / Reconfig/ Reset) For setting the System Service (Port 10000) please see also the 'Restart-Twin CAT' Cmdlet, which is optimized for that case. TE1000 Version: 1.4.2 199
## Page 200

Tc Xae Mgmt Version 6. X EXAMPLES EXAMPLE 1 PS> Set-Ads State -port 851 -command Run -force Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X CX-11111 1.1.1.1.1.1 851 No Error Run Stop Run 293 Sets the Local PLC on port 851 to RUN. The 'X' in the 'Ok' Column indicates the success. EXAMPLE 2 PS> Set-Ads State -port 10000 -command Reset -force Ok Target Net Id Port Error Code Requested Original Reached Latency(ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X My System 172.168.0.1.1.1 10000 No Error Reset Run Run 5007 Restart the local System Service EXAMPLE 3 PS> $r = get-Ads Route PS> Set-Ads State -port 851 -command Run -Input Object $r -force Ok Target Net Id Port Error Code Requested Original Reached Latency (ms) -- ------ ----- ---- --------- --------- -------- ------- ------------ X CX-11111 1.1.1.1.1.1 851 No Error Run Stop Run 293 X CX-22222 1.1.1.2.1.1 851 No Error Run Stop Run 357 X CX-22222 1.1.1.3.1.1 851 No Error Run Stop Run 218 X CX-22222 1.1.1.4.1.1 851 No Error Run Stop Run 324 Start the PLC on all registered target systems. PARAMETERS -Command The state command. Possible values: None, Reset, Start, Stop, Reconfig, Run Type: Ads State Command Parameter Sets: (All) Aliases: Accepted values: None, Reset, Start, Stop, Reconfig, Run Required: True Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Net Id The Net Id address where to set the state (Local system by default). Multiple values are allowed. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False Position: 1 Default value: None 200 Version: 1.4.2 TE1000
## Page 201

Tc Xae Mgmt Version 6. X Accept pipeline input: False Accept wildcard characters: False -Port Port Address of the Ads Server where to set the state (Port 10000, System Service by default) Type: Int32 Parameter Sets: Net Id Port, Address Str, Route Aliases: Required: False Position: 2 Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Input Object Target route(s), where to set the state. Multiple values are allowed. Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address The address of the system where to set the state. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards and multiple values are permitted. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The ADS Session to use for the Cmdlet. Multiple sessions are allowed. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use for the Cmdlet (multiple values are allowed) TE1000 Version: 1.4.2 201
## Page 202

Tc Xae Mgmt Version 6. X Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Quiet Sets the Quiet mode of the command. The Cmdlet then returns a $true or $false but not the actual states of the targets. The return value will be $true if all operations succeed and it will be $false if at least one have failed. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -State Only The State Only mode Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value \<= 0 sets the Default Timeout (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False 202 Version: 1.4.2 TE1000
## Page 203

Tc Xae Mgmt Version 6. X -Wait Timeout The wait timout for the state change in ms. This Cmdlet waits for the target state changes which is limited by this Wait Timeout. A value \<= 0 sets the Default (45000 ms). This parameter is only used if -No Wait is not set. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Polling Rate The Wait polling rate in Milliseconds. A value \<= 0 sets the Default polling rate (200 ms for local systems, 1000ms for remote systems). This parameter is only used, if -No Wait is not set. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Throw Error Throws an error, if the target system(s) not reaching the expected state. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -No Reinit Activates a state check before sending Write Control if the target system is already in the expected target state Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Reinitialize This parameter is obsolete and will be removed in future versions. TE1000 Version: 1.4.2 203
## Page 204

Tc Xae Mgmt Version 6. X Please use -No Reinit instead. This parameter forces the reinitialization of the target. It is the opposite of the -No Reinit parameter. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: True Accept pipeline input: False Accept wildcard characters: False -No Wait The -No Wait parameter skips the waiting for the target end state. If set, the Cmdlet returns immediatly after sending the Write Control request, without waiting for the state change. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False 204 Version: 1.4.2 TE1000
## Page 205

Tc Xae Mgmt Version 6. X Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] Target route(s), where to set the state. Multiple values are allowed. Twin CAT. ISession[] The ADS Session to use for the Cmdlet. Multiple sessions are allowed. OUTPUTS NOTES 6.48 Set-Ams Router Endpoint SYNOPSIS Sets the Ams Configuration (Loopback address and port, Router Endpoint). SYNTAX Set-Ams Router Endpoint [[-IP] <IPAddress>] [[-Port] <Int32>] [-Quiet] [-Force] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet sets the Ams Configuration setting of the current running process. By default the Ads Clients and Ads Servers are connected to the Twin CAT Router./\> Actually the this Cmdlet doesn't work properly. Please use the 'AMSROUTER_LOOPBACK_IP', and 'AMSROUTER_LOOPBACK_PORT' environment variables to set the Router Loopback endpoint. The environment variables must be set at the hosting process before the 'Tc Xae Mgmt' module is loaded! Ideally, this Cmdlet is called first after loading the Tc Xae Mgmt module to configure the system. The involved communication uses the local Loopback address with port 0x BF02 by default. To enable virtualization scenarios, where Ads Client / Ads Server / Router applications run in their own (virtual) environment, this address has to be changed for the actual running process. This can be done in two different ways: 1. Setting of the following Environment Variables before this Powershell Module (Tc Xae Mgmt) is loaded: $env:Ams Configuration:Loopback Address = "168.0.1.1" $env:Ams Configuration:Loopback Port = "1234" Both Variables are optional 2. Set the Ams Configuration with the 'Set-Ams Router Endpoint' Cmdlet. TE1000 Version: 1.4.2 205
## Page 206

Tc Xae Mgmt Version 6. X When processing this Cmdlet, all prexisting open Ads Sessions will be invalid.\> The Default Router Endpoint is IPAddess:127.0.0.1 and Port 0x BF02. EXAMPLES EXAMPLE 1 PS > Set-Ams Router Endpoint -IP '168.0.1.1' -Port 1234 Set the process wide Router Endpoint to IPAddress '168.0.1.1' and port 1234. PARAMETERS -IP The state/value to set. Type: IPAddress Parameter Sets: (All) Aliases: Required: False Position: 0 Default value: 127.0.0.1 Accept pipeline input: False Accept wildcard characters: False -Port The state/value to set. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: 1 Default value: 48898 Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Force Forces the command (no confirmation, Resets the Fail Fast Handler) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False 206 Version: 1.4.2 TE1000
## Page 207

Tc Xae Mgmt Version 6. X -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS OUTPUTS NOTES 6.49 Set-Io Free Run SYNOPSIS Sets the IO Free Run state of the target. TE1000 Version: 1.4.2 207
## Page 208

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port List (Default) Set-Io Free Run [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Net Id Port Set-Io Free Run [-Net Id <Ams Net Id>] [-Timeout <Int32>] [-Quiet] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Set-Io Free Run [-Address] <String> [-Timeout <Int32>] [-Quiet] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Set-Io Free Run -Session <ISession> [-Timeout <Int32>] [-Quiet] [- Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION Sets the IO Free Run state of a Twin CAT target. The target must be in Config mode, otherwise an error will be produced. EXAMPLES EXAMPLE 1 PS> Set-IOFree Run -Net Id 5.62.192.46.1.1 Setting the target system with Net ID 5.62.192.46.1.1 to IO Free Run mode. PARAMETERS -Net Id The address where to set the Twin CAT Free Run state. Type: Ams Net Id Parameter Sets: Net Id Port Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The address(es) where to set the Twin CAT Free Run state. This can be the Route Name, Net Id, the Host Name or the IPAddress. Wildcards are permitted. Type: String Parameter Sets: Address Str Aliases: 208 Version: 1.4.2 TE1000
## Page 209

Tc Xae Mgmt Version 6. X Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session to use for the Cmdlet Type: ISession Parameter Sets: Session Aliases: Input Object Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} TE1000 Version: 1.4.2 209
## Page 210

Tc Xae Mgmt Version 6. X Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session to use for the Cmdlet OUTPUTS NOTES 6.50 Stop-Ads Computer SYNOPSIS Stops (shuts down) local and remote Twin CAT computers. SYNTAX Net Id Port (Default) Stop-Ads Computer [-Delay <Int32>] [[-Net Id] <Ams Net Id[]>] [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Stop-Ads Computer [-Delay <Int32>] [-Input Object] <IRoute[]> [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Str Stop-Ads Computer [-Delay <Int32>] [-Address] <String[]> [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] 210 Version: 1.4.2 TE1000
## Page 211

Tc Xae Mgmt Version 6. X Session Stop-Ads Computer [-Delay <Int32>] -Session <ISession[]> [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Id Stop-Ads Computer [-Delay <Int32>] -Session Id <Int32[]> [-Timeout <Int32>] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION The Stop-Ads Computer cmdlet shuts the operating system on the local and remote Twin CAT computers down. You can use the parameters of Stop-Ads Computer to specify available ADS target systems to shutdown. The shutdown can be done delayed if Users are logged into the target system (existant Session UI) or forced immediatly. EXAMPLES EXAMPLE 1 PS> Stop-Ads Computer CX_1111,CX_2222 -force Immediate shutdown of the computers CX_1111 and CX_2222. The Force parameter supresses the Should Process query. EXAMPLE 2 PS> Stop-Ads Computer -net Id '1.2.3.4.1.1', '1.2.3.5.1.1' -Delay 30 -force Stops the Twin CAT targets '1.2.3.4.1.1' and 1.2.3.5.1.1' without Should Process query after a delay of 30 Seconds (if a user is logged in). PARAMETERS -Delay The delay time for the reboot/shutdown of the target system(s) in seconds. The default is 120 Seconds. If no user is logged in the target system the reboot/shotdown occurs always immediatly without warning. In case of a log in, a Warning message with countdown will be presented to the user. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Net Id Net Id(s) of the target system. Type: Ams Net Id[] Parameter Sets: Net Id Port Aliases: Required: False TE1000 Version: 1.4.2 211
## Page 212

Tc Xae Mgmt Version 6. X Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The ADS routes to shutdown/reboot. Type: IRoute[] Parameter Sets: Route Aliases: Destination, Route Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Address Target names/addresses. These can consist of Route Name, Net ID, Host Name or IPAddress. This parameter supports wildcards. Type: String[] Parameter Sets: Address Str Aliases: Name Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session(s) to use for addressing the target systems. Type: ISession[] Parameter Sets: Session Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Session Id Specifies the Sessions (with unique ID) to use for addressing the target systems. Type: Int32[] Parameter Sets: Session Id Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. 212 Version: 1.4.2 TE1000
## Page 213

Tc Xae Mgmt Version 6. X A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 213
## Page 214

Tc Xae Mgmt Version 6. X Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. IRoute[] The ADS routes to shutdown/reboot. Twin CAT. ISession[] The Session(s) to use for addressing the target systems. OUTPUTS NOTES 6.51 Test-Ads Route SYNOPSIS Test the specified route connection. SYNTAX Address Str (Default) Test-Ads Route [[-Name] <String[]>] [[-Port] <Int32[]>] [-Source Route <Route Target>] [- Mode <Ping Strategy>] [-Scan Seconds <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Default Ports] [-Online Ports] [-Quiet] [-Progress Action <Action Preference>] [<Common Parameters>] Net Id Test-Ads Route -Net Id <Ams Net Id[]> [[-Port] <Int32[]>] [-Source Route <Route Target>] [- Mode <Ping Strategy>] [-Scan Seconds <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Default Ports] [-Online Ports] [-Quiet] [-Progress Action <Action Preference>] [<Common Parameters>] Route Test-Ads Route [[-Port] <Int32[]>] [-Source Route <Route Target>] -Input Object <Route Target Collection> [-Mode <Ping Strategy>] [-Scan Seconds <Int32>] [-Count <Int32>] [-Delay <Int32>] [-Default Ports] [- Online Ports] [-Quiet] [-Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet establishes a connection to the specified target system and tests if the connection is working. A Port scan can be executed. EXAMPLES EXAMPLE 1 PS> Test-Ads Route -Port 851 Name Net Id Port Latency Result (ms) 214 Version: 1.4.2 TE1000
## Page 215

Tc Xae Mgmt Version 6. X ---- ----- ---- ------- ------ CX-11111 192.168.0.2.1.1 851 3 Ok Test the Port 851 of the local system (PLC 1) for availablity. EXAMPLE 2 PS> Get-Ads Route | Test-Ads Route Name Net Id Port Latency Result (ms) ---- ----- ---- ------- ------ CX-11111 192.168.0.2.1.1 10000 4 Ok CX-22222 192.168.0.3.1.1 10000 Failed CX-33333 192.168.0.4.1.1 10000 4 Ok Get the locally registered routes and test if they are reachable (on Ams Port 10000) EXAMPLE 3 PS> Test-Ads Route -Online Ports Name Net Id Port Latency Result (ms) ---- ----- ---- ------- ------ CX-11111 192.168.0.2.1.1 10 0.6 Ok CX-11111 192.168.0.2.1.1 11 1.3 Ok CX-11111 192.168.0.2.1.1 12 1.2 Ok CX-11111 192.168.0.2.1.1 30 3 Ok CX-11111 192.168.0.2.1.1 131 75 Ok CX-11111 192.168.0.2.1.1 32829 125 Ok CX-11111 192.168.0.2.1.1 340 122 Ok CX-11111 192.168.0.2.1.1 850 171 Ok CX-11111 192.168.0.2.1.1 32830 174 Ok CX-11111 192.168.0.2.1.1 351 171 Ok CX-11111 192.168.0.2.1.1 350 172 Ok CX-11111 192.168.0.2.1.1 270 219 Ok CX-11111 192.168.0.2.1.1 851 220 Ok Scans the propagated Ams Ports for the local system. PARAMETERS -Name The name(s) or address(es) of the systems to test. These can consist of Route Name, Net ID, Host Name or IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Str Aliases: Address Required: False Position: 0 Default value: None Accept pipeline input: False Accept wildcard characters: False -Net Id The Net Id(s) of the target system to test (Ams Net Id. Local by default) Type: Ams Net Id[] Parameter Sets: Net Id Aliases: Required: True Position: Named Default value: None TE1000 Version: 1.4.2 215
## Page 216

Tc Xae Mgmt Version 6. X Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Port The Port(s) of the target system to test. Type: Int32[] Parameter Sets: Address Str, Route Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False Type: Int32[] Parameter Sets: Net Id Aliases: Required: False Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: False -Source Route The source system where to test the Route. Type: Route Target Parameter Sets: (All) Aliases: Source Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Input Object The routes targets to test with this Cmdlet. Type: Route Target Collection Parameter Sets: Route Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Mode The Ping Strategy (Ping Strategy. Ads by default) Possible values: None, IP, Host Name, IPOr Host Name, Ads, Ads Get State, Ads Test Connection, Default Type: Ping Strategy Parameter Sets: (All) Aliases: Accepted values: None, IP, Host Name, IPOr Host Name, Ads, Ads Get State, Ads Test Connection, Default Required: False Position: Named Default value: Ads Get State Accept pipeline input: False Accept wildcard characters: False 216 Version: 1.4.2 TE1000
## Page 217

Tc Xae Mgmt Version 6. X -Scan Seconds Sets timeout for each single test request. The test fails if a (single) response isn't received before the timeout expires. The default timeout is 2 seconds. Type: Int32 Parameter Sets: (All) Aliases: TTL, Time To Live, Timeout Seconds Required: False Position: Named Default value: 2 Accept pipeline input: False Accept wildcard characters: False -Count Specifies the number of echo/ping requests to send. The default value is 1. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Delay Specifies the interval between pings/tests, in seconds. This is used only in combination with the 'Count' parameter. The default value is 1 Second. Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: 1 Accept pipeline input: False Accept wildcard characters: False -Default Ports Tests all default ports. The following ports will be tested: 10000, 300, 301, 302, 303, 501, 801, 811, 821, 831, 850, 851, 852, 853, 854, 855, 19200 The 'Default Ports' switch overrides the 'Port' parameter. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False TE1000 Version: 1.4.2 217
## Page 218

Tc Xae Mgmt Version 6. X -Online Ports Determines all active/online ports from the target and tests them. The 'Online Ports' switch overrides the 'Default Ports' and 'Port' parameters. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet mode. Returns a boolean only ($true, if one ping succeeded and $false if all failed) Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. Ads. Ams Net Id[] The Net Id(s) of the target system to test (Ams Net Id. Local by default) System. Int32[] The Port(s) of the target system to test. Twin CAT. Route Target Collection The routes targets to test with this Cmdlet. 218 Version: 1.4.2 TE1000
## Page 219

Tc Xae Mgmt Version 6. X OUTPUTS NOTES 6.52 Unregister-Ads Handle SYNOPSIS Unregisters a symbol handle. SYNTAX Net Id Port Handle (Default) Unregister-Ads Handle [-Net Id <Ams Net Id>] -Port <Int32> [-Handle] <UInt32[]> [-Progress Action <Action Preference>] [<Common Parameters>] Net Id Port Info Unregister-Ads Handle [-Net Id <Ams Net Id>] -Port <Int32> [-Input Object] <Ads Handle Info[]> [-Progress Action <Action Preference>] [<Common Parameters>] Route Handle Unregister-Ads Handle -Route <IRoute> -Port <Int32> [-Handle] <UInt32[]> [- Progress Action <Action Preference>] [<Common Parameters>] Route Info Unregister-Ads Handle -Route <IRoute> -Port <Int32> [-Input Object] <Ads Handle Info[]> [-Progress Action <Action Preference>] [<Common Parameters>] Address Handle Unregister-Ads Handle -Address <String> -Port <Int32> [-Handle] <UInt32[]> [- Progress Action <Action Preference>] [<Common Parameters>] Address Info Unregister-Ads Handle -Address <String> -Port <Int32> [-Input Object] <Ads Handle Info[]> [-Progress Action <Action Preference>] [<Common Parameters>] Session Handle Unregister-Ads Handle -Session <ISession> [-Handle] <UInt32[]> [-Progress Action <Action Preference>] [<Common Parameters>] Session Info Unregister-Ads Handle -Session <ISession> [-Input Object] <Ads Handle Info[]> [- Progress Action <Action Preference>] [<Common Parameters>] Session Id Handle Unregister-Ads Handle -Session Id <Int32> [-Handle] <UInt32[]> [-Progress Action <Action Preference>] [<Common Parameters>] TE1000 Version: 1.4.2 219
## Page 220

Tc Xae Mgmt Version 6. X Session Id Info Unregister-Ads Handle -Session Id <Int32> [-Input Object] <Ads Handle Info[]> [- Progress Action <Action Preference>] [<Common Parameters>] DESCRIPTION This Cmdlet unregisters an already registered symbol handle from the target system. The Cmdlet supports raw \[uint\] handles or Ads Handle Info objects. EXAMPLES EXAMPLE 1 PS> $session = New-Tc Session -Net Id '1.2.3.4.5.6' -Port 851 PS> $handle Info = $session | Register-Ads Handle - Path 'Twin CAT_System Info Var List._App Info. Project Name' PS> $handle Info = Register-Ads Handle -Path 'Twin CAT_System Info Var List._App Info. Project Name' - Session $s PS> $handle Info Instance Path Result Handle ------------ ------ ------ Twin CAT_System Info Var List._App Info. Project Name No Error 0x428000FC (1115685116) PS> Read-Tc Value -Session $session -Index Group Symbol Value By Handle -Index Offset $handle Info. Handle - Type String My Project PS> $handle | Unregister-Ads Handle -Session $session PS> $session | Close-tcsession Opens a new device session, registers a Symbol Handle to the Project Name of the running PLC Project, Reads the value by handle unregisters the handle and closes the session again. PARAMETERS -Net Id The Net Id part of the device target address. Type: Ams Net Id Parameter Sets: Net Id Port Handle, Net Id Port Info Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route Specifies the target system. Type: IRoute Parameter Sets: Route Handle, Route Info Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False 220 Version: 1.4.2 TE1000
## Page 221

Tc Xae Mgmt Version 6. X -Address The target address of the system. The Address can consist of Route Name, Net Id, IPAddress or Host Name. Wildcards are permitted and Argument Completer is supported. Type: String Parameter Sets: Address Handle, Address Info Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The Session object (instead of specifieng the target system address). Type: ISession Parameter Sets: Session Handle, Session Info Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Session Id Specifies the Session (with unique ID) to use (instead of specifying the address). Type: Int32 Parameter Sets: Session Id Handle, Session Id Info Aliases: Required: True Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Port The address Port to use. Clear Text names for the Port and Argument Completer are supported. Type: Int32 Parameter Sets: Net Id Port Handle, Net Id Port Info, Route Handle, Route Info, Address Handle, Address Info Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Handle The instance path of the symbol to read (symbolic access). This parameter supports wildcards. Type: UInt32[] Parameter Sets: Net Id Port Handle, Route Handle, Address Handle, Session Handle, Session Id Handle Aliases: TE1000 Version: 1.4.2 221
## Page 222

Tc Xae Mgmt Version 6. X Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Input Object The Ads Handle Info object (produced by Register-Ads Handle Cmdlet) Type: Ads Handle Info[] Parameter Sets: Net Id Port Info, Route Info, Address Info, Session Info, Session Id Info Aliases: Handle Info Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession The Session object (instead of specifieng the target system address). Twin CAT. Management. Automation. Ads Handle Info[] The Ads Handle Info object (produced by Register-Ads Handle Cmdlet) OUTPUTS NOTES 6.53 Write-Tc Value SYNOPSIS Write values to Twin CAT devices. 222 Version: 1.4.2 TE1000
## Page 223

Tc Xae Mgmt Version 6. X SYNTAX Net Id Port Symbol (Default) Write-Tc Value [-Net Id <Ams Net Id[]>] -Port <Int32> [-Value <Object>] [-Path] <String> [- Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Reset Symbols] [-Quiet] [-Progress Action <Action Preference>] [- What If] [-Confirm] [<Common Parameters>] Net Id Port Indexed Write-Tc Value [-Net Id <Ams Net Id[]>] -Port <Int32> [-Value <Object>] [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Size <Int32>] [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [- Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Indexed Write-Tc Value -Route <IRoute[]> -Port <Int32> [-Value <Object>] [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Size <Int32>] [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [- Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Route Symbol Write-Tc Value -Route <IRoute[]> -Port <Int32> [-Value <Object>] [-Path] <String> [- Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Reset Symbols] [-Quiet] [-Progress Action <Action Preference>] [- What If] [-Confirm] [<Common Parameters>] Address Indexed Write-Tc Value -Address <String[]> -Port <Int32> [-Value <Object>] [-Index Group] <UInt32> [[-Index Offset] <UInt32>] [-Size <Int32>] [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [- Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Address Symbol Write-Tc Value -Address <String[]> -Port <Int32> [-Value <Object>] [-Path] <String> [- Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Reset Symbols] [-Quiet] [-Progress Action <Action Preference>] [- What If] [-Confirm] [<Common Parameters>] Session Indexed Write-Tc Value -Session <ISession[]> [-Value <Object>] [-Index Group] <UInt32> [[- Index Offset] <UInt32>] [-Size <Int32>] [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Session Symbol Write-Tc Value -Session <ISession[]> [-Value <Object>] [-Path] <String> [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Reset Symbols] [-Quiet] [-Progress Action <Action Preference>] [- What If] [-Confirm] [<Common Parameters>] Session Id Indexed Write-Tc Value -Session Id <Int32[]> [-Value <Object>] [-Index Group] <UInt32> [[- Index Offset] <UInt32>] [-Size <Int32>] [-Encoding <Encoding>] [-Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] TE1000 Version: 1.4.2 223
## Page 224

Tc Xae Mgmt Version 6. X Session Id Symbol Write-Tc Value -Session Id <Int32[]> [-Value <Object>] [-Path] <String> [-Encoding <Encoding>] [- Timeout <Int32>] [-Force] [-Reset Symbols] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] Input Object Write-Tc Value [-Value <Object>] [-Input Object] <ISymbol> [-Encoding <Encoding>] [- Timeout <Int32>] [-Force] [-Quiet] [-Progress Action <Action Preference>] [-What If] [-Confirm] [<Common Parameters>] DESCRIPTION This Cmdlet writes values to Twin CAT Devices. The devices can be accessed via different Value Providers. All sorts of ADS-addressing will be supported by this Cmdlet: Addressing by Index Group / Index Offset (see Index Group, Index Offset paramters) Addressing by Instance Path (see path parameter) Addressing by Symbol (see Input Object / Symbol parameter) IMPORTANT: Writing values should be done with highest care because it could destabilize the Twin CAT System when the write operation is not addressed properly. While writing with available symbol information is not critical and should be preferred the size and position of symbol data is known within the process image), the access via Instance path is less secure. The size of the overwritten data is not known and therefore not checked by the Cmdlet. The highest attention should be taken with write Index Group / Index Offset write operations because beneath the unknown data size even the position of the data is not checked. The data is written directly into the process image. EXAMPLES EXAMPLE 1 PS> $session = New-Tc Session -Net Id 1.2.3.4.5.6 -Port 851 PS> $project Name Symbol = $session | Get-Tc Symbol -path "*Project Name" PS> $project Name Symbol Instance Name Data Type Size Instance Path ------------ -------- ---- ------------ Project Name STRING(63) 64 Twin CAT_System Info Var List._App Info. Project Name PS> $project Name Symbol | Read-Tc Value Old Project Name PS> $project Name Symbol | Write-Tc Value -Value "New Project Name" -force PS> $project Name Symbol | Read Tc Value New Project Name This example shows how to create a session, determining the Symbol 'Project Name within the _App Info Struct on a running PLC project and reading its value. After that, the Value will be overwritten with 'New Project Name'. EXAMPLE 2 Write-Tc Value -session $session -Index Group 0x4040 -Index Offset 0x1247A8 -Value "New Project Name" Writes a string typed Value to the specified Index Group/Index Offset Address. 224 Version: 1.4.2 TE1000
## Page 225

Tc Xae Mgmt Version 6. X PARAMETERS -Net Id The ADS target Net ID(s) of the system(s) where to write the Value. More than one target will be supported. Type: Ams Net Id[] Parameter Sets: Net Id Port Symbol, Net Id Port Indexed Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Route The target system (as Route) where to write the value. Type: IRoute[] Parameter Sets: Route Indexed, Route Symbol Aliases: Destination Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Address The target address where to write the Value. The Address can consist of Route Name, Net Id, Host Name or IPAddress. Wildcards are permitted. Type: String[] Parameter Sets: Address Indexed, Address Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: True -Session The session object represents the target session where to write the value. Type: ISession[] Parameter Sets: Session Indexed, Session Symbol Aliases: Required: True Position: Named Default value: None Accept pipeline input: True (By Property Name, By Value) Accept wildcard characters: False -Session Id The session ID represents the target session where to write the value. Type: Int32[] Parameter Sets: Session Id Indexed, Session Id Symbol Aliases: TE1000 Version: 1.4.2 225
## Page 226

Tc Xae Mgmt Version 6. X Required: True Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Port The Port, where to write the value. This Parameter is used in combination with the Net Id, Route or Address input parameter. Type: Int32 Parameter Sets: Net Id Port Symbol, Net Id Port Indexed, Route Indexed, Route Symbol, Address Indexed, Addres s Symbol Aliases: Required: True Position: Named Default value: 10000 Accept pipeline input: False Accept wildcard characters: False -Value The value to write. If no additional Length parameter is set, the Write-Tc Value Cmdlet marshalls this value to its appropiate size. To not overwrite data of other symbols within the process image, special attention must be taken (see the Confirm and Whatif parameters). Type: Object Parameter Sets: (All) Aliases: Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Index Group Index Group of the Value to write, only for Index Group/Index Offset access. IMPORTANT: Please be aware, that writing data via Index Group/Index Offset simply overwrites data in the Process Image and can destabilize the system. No validity check is done for the symbol alignment and therefore this should be done with highest care! If applicable writing data via symbolic information should be preferred! Type: UInt32 Parameter Sets: Net Id Port Indexed, Route Indexed, Address Indexed, Session Indexed, Session Id Indexed Aliases: IG Required: True Position: 1 Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Index Offset Index Offset of the Value to write, only for Index Group/Index Offset access. IMPORTANT: Please be aware, that writing data via Index Group/Index Offset simply overwrites data in the Process Image and can destabilize the system. 226 Version: 1.4.2 TE1000
## Page 227

Tc Xae Mgmt Version 6. X No validity check is done for the symbol alignment and therefore this should be done with highest care! If applicable writing data via symbolic information should be preferred! Type: UInt32 Parameter Sets: Net Id Port Indexed, Route Indexed, Address Indexed, Session Indexed, Session Id Indexed Aliases: IO Required: False Position: 2 Default value: 0 Accept pipeline input: False Accept wildcard characters: False -Size The Length of the data that will be overwritten within the process image. IMPORTANT: Please be aware, that writing data via Index Group/Index Offset simply overwrites data in the Process Image and could destabilize the system. No further validity check is done for the symbol alignment and therefore this should be done with highest care (best with use of the -Confirm and -Whatif Cmdlet arguments). If applicable writing data via symbolic information should be preferred! Type: Int32 Parameter Sets: Net Id Port Indexed, Route Indexed, Address Indexed, Session Indexed, Session Id Indexed Aliases: Length, Write Size Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Path The instance path to the symbol to write (Symbolic access). Wildcards are permitted. Type: String Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol, Session Symbol, Session Id Symbol Aliases: Required: True Position: 1 Default value: None Accept pipeline input: False Accept wildcard characters: True -Input Object The symbol object on which to write the value. Type: ISymbol Parameter Sets: Input Object Aliases: Symbol Required: True Position: 1 Default value: None Accept pipeline input: True (By Value) Accept wildcard characters: False -Encoding Specifies the Encoding for strings. The Default is ANSI with actual code page. TE1000 Version: 1.4.2 227
## Page 228

Tc Xae Mgmt Version 6. X Type: Encoding Parameter Sets: (All) Aliases: Required: False Position: Named Default value: System. Text. SBCSCode Page Encoding Accept pipeline input: False Accept wildcard characters: False -Timeout The communication ADS timeout in milliseconds. A value of 0 disables the timeout. A value \<= 0 sets the Default (5000 ms). Type: Int32 Parameter Sets: (All) Aliases: Required: False Position: Named Default value: -1 Accept pipeline input: False Accept wildcard characters: False -Force Forces the write operation, even if the Fail Fast Handler is active. Type: Switch Parameter Parameter Sets: (All) Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Reset Symbols Resets the symbols and datatypes cache when using symbolic access. Type: Switch Parameter Parameter Sets: Net Id Port Symbol, Route Symbol, Address Symbol, Session Symbol, Session Id Symbol Aliases: Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False -Quiet The Quiet parameter suppresses the 'Should Process' messsage and the Cmdlet will be processed without further user confirmation. Type: Switch Parameter Parameter Sets: (All) Aliases: Silent Required: False Position: Named Default value: False Accept pipeline input: False Accept wildcard characters: False 228 Version: 1.4.2 TE1000
## Page 229

Tc Xae Mgmt Version 6. X -Confirm Prompts you for confirmation before running the cmdlet. Type: Switch Parameter Parameter Sets: (All) Aliases: cf Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -Progress Action {{ Fill Progress Action Description }} Type: Action Preference Parameter Sets: (All) Aliases: proga Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False -What If Shows what would happen if the cmdlet runs. The cmdlet is not run. Type: Switch Parameter Parameter Sets: (All) Aliases: wi Required: False Position: Named Default value: None Accept pipeline input: False Accept wildcard characters: False Common Parameters This cmdlet supports the common parameters: -Debug, -Error Action, -Error Variable, -Information Action, -Information Variable, -Out Variable, -Out Buffer, -Pipeline Variable, -Verbose, -Warning Action, and -Warning Variable. For more information, see about_Common Parameters. INPUTS Twin CAT. ISession[] The session object represents the target session where to write the value. Twin CAT. Type System. ISymbol The symbol object on which to write the value. OUTPUTS NOTES TE1000 Version: 1.4.2 229
## Page 230

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 230 Version: 1.4.2 TE1000
## Page 231

Trademark statements Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Third-party trademark statements Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies.
## Page 232

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
