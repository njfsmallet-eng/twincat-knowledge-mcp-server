---
title: "TF5050 Twin CAT 3"
product: "TF5050"
category: "Motion_Control"
tags: ["CAT", "NC", "TWIN"]
language: "EN"
document_type: "Manual"
version: "1.8.3"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5050_TC3_NC_Camming_EN.pdf"
release_date: "2025-05-15"
---
Manual | EN TF5050 Twin CAT 3 | NC Camming 2025-05-15 | Version: 1.8.3
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 Overview of the PLC library..................................................................................................................... 9 4 Cam plates............................................................................................................................................... 11 4.1 MC_Cam Table Select...................................................................................................................... 11 4.2 MC_Cam Out................................................................................................................................... 13 4.3 MC_Cam In...................................................................................................................................... 15 4.4 MC_Camin Appendix....................................................................................................................... 18 4.5 MC_Cam Scaling............................................................................................................................. 21 5 Multi cam plates...................................................................................................................................... 23 5.1 MC_Cam In_V2................................................................................................................................ 23 5.2 MC_Cam Add................................................................................................................................... 26 5.3 MC_Cam Exchange......................................................................................................................... 28 5.4 MC_Cam Remove............................................................................................................................ 30 5.5 MC_Cam Scaling_V2....................................................................................................................... 32 6 Motion functions..................................................................................................................................... 34 6.1 MC_Read Motion Function............................................................................................................... 34 6.2 MC_Read Motion Function Point....................................................................................................... 36 6.3 MC_Write Motion Function................................................................................................................ 37 6.4 MC_Write Motion Function Point....................................................................................................... 39 6.5 MC_Set Cam Online Change Mode.................................................................................................... 41 6.6 MC_Read Motion Function Values.................................................................................................... 43 7 Status....................................................................................................................................................... 45 7.1 MC_Read Cam Table Slave Dynamics............................................................................................... 45 7.2 MC_Cam Info................................................................................................................................... 47 7.3 MC_Cam Info_V2............................................................................................................................. 49 7.4 MC_Read Cam Table Characteristics................................................................................................ 51 7.5 MC_Read Cam Table Master Position................................................................................................ 52 8 Data type.................................................................................................................................................. 54 8.1 MC_CAM_ID................................................................................................................................... 54 8.2 MC_CAM_REF................................................................................................................................ 55 8.3 MC_Cam Activation Mode................................................................................................................ 56 8.4 MC_Cam Scaling Mode.................................................................................................................... 59 8.5 MC_Cam Info Data........................................................................................................................... 62 8.6 MC_Interpolation Type..................................................................................................................... 63 8.7 MC_Motion Function Point................................................................................................................ 64 8.8 MC_Motion Function Point_ID.......................................................................................................... 65 8.9 MC_Motion Function Type................................................................................................................ 66 8.10 MC_Motion Point Type...................................................................................................................... 67 TF5050 Version: 1.8.3 3
## Page 4

Table of contents 8.11 MC_Table Charac Values................................................................................................................. 68 8.12 MC_Table Error Codes..................................................................................................................... 69 8.13 MC_Table Type................................................................................................................................ 69 8.14 MC_Value Select Type..................................................................................................................... 69 8.15 MC_Start Mode................................................................................................................................ 70 8.16 ST_Cam In Options........................................................................................................................... 71 8.17 Cam Master Data.............................................................................................................................. 72 8.18 MC_Cam Operation Mode................................................................................................................ 72 8.19 ST_Cam Scaling Data....................................................................................................................... 73 8.20 ST_Read Cam Table Slave Dynamics Options................................................................................... 74 8.21 ST_Set Online Change Mode Options................................................................................................ 74 8.22 ST_Write Motion Function Options.................................................................................................... 74 9 Example programs.................................................................................................................................. 75 4 Version: 1.8.3 TF5050
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TF5050 Version: 1.8.3 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.8.3 TF5050
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF5050 Version: 1.8.3 7
## Page 8

Overview 2 Overview In many applications it is necessary to synchronize two or more axes. Axes can be coupled together in the Twin CAT NC PTP. A master axis is then actively controlled, and the position of one or more coupled slave axes is synchronously controlled by the NC. The simplest type of coupling is linear coupling with a fixed ratio of transmission (electronic gearing). Some applications require a more complex coupling of master and slave, one which cannot be described by a simple mathematical formula. Such a dependency can be described by means of a table that specifies an associated slave position for every master position. The Twin CAT NC PTP offers the possibility of coupling a slave axis to a master axis by means of a table (electronic cam plate) Here the table contains a certain number of prescribed interpolation points, and the NC interpolates position and speed between them. The Tc2_MC2_Camming library contains function blocks for handling cam plates. Two types of cam plates are supported. One option is a cam plate in the form of a 2-column table containing master and slave positions (position table). The master column defines interpolation points via the travel path of the master, ascending from a minimum position value to a maximum value. The associated slave position is determined from the second column using the interpolation points of the table. Values between these interpolation points are interpolated. Another option is to define a cam plate as a so-called motion function. A motion function is a single-column table of interpolation points. Each interpolation point not only contains a position, but a complete description of the course of the curve within a section (segment) of the cam plate. In addition to the master and slave position at the start of the segment, the course of the function for example is specified up to the next interpolation point in the form of a mathematical function. Using this procedure, a motion function requires only very few interpolation points. Despite this, each point between the interpolation points is precisely defined through the mathematical function, and there are no uncertainties due to interpolation. Unlike a position table, the points of a motion function can be manipulated at run time. The system ensures that a manipulation only becomes effective once an alteration has no direct influence on the slave. Position jumps are thus avoided. 8 Version: 1.8.3 TF5050
## Page 9

Overview of the PLC library 3 Overview of the PLC library Below is an overview of the TF5050 Twin CAT 3 MC Camming (cam plates) PLC library. Tc2_MC2_Camming from version 3.4.0 The Tc2_MC2_Camming library requires at least Twin CAT 3.1.4024.55 on the runtime system from version 3.4.0. Cam Plates Function Block Description MC_Cam Table Select [} 11] Specifies a table and loads it into the NC. MC_Cam Out [} 13] Deactivates a master-slave coupling. MC_Cam In [} 15] Activates master-slave coupling with a certain cam plate. MC_Cam Scaling [} 21] Scales a cam plate coupling. Multi Cam Plates Function Block Description MC_Cam In_V2 [} 23] Several cam plates can be superimposed. MC_Cam Add [} 26] Adds a cam plate to a multi cam. MC_Cam Exchange [} 28] Exchanges a cam in a multi cam. MC_Cam Remove [} 30] Removes a cam from a multi cam environment. MC_Cam Scaling_V2 [} 32] Scales a cam plate coupling. Motion Functions Function Block Description MC_Read Motion Function [} 34] Read the data of a motion function. MC_Read Motion Function Point [} 36] Read the data of a motion function interpolation point. MC_Write Motion Function [} 37] Write the data of a motion function into the NC. MC_Write Motion Function Point [} 39] Write the data of a motion function interpolation point. MC_Set Cam Online Change Mode [} 41] Specifies the mode for write access to cam plate data. MC_Read Motion Function Values [} 43] Reads the interpolated data of a motion function in form of a table. Status Function Block Description MC_Read Cam Table Slave Dynamics [} 45] Determines the slave dynamics at a certain point of a cam plate table. MC_Cam Info [} 47] Obtains data relating to the current state and current parameterization of a cam plate coupling. MC_Cam Info_V2 [} 49] Obtains data relating to the current state and current parameterization of a cam plate coupling. MC_Read Cam Table Characteristics [} 51] Calculates and reads the characteristic parameters of a motion function. MC_Read Cam Table Master Position [} 52] Calculates a master position for a given slave position. TF5050 Version: 1.8.3 9
## Page 10

Overview of the PLC library Data Types Data Type Description MC_CAM_ID [} 54] Type definition for the table ID. MC_CAM_REF [} 55] Describes the data memory of a cam plate in a further PLC variable. MC_Cam Activation Mode [} 56] Specifies timing and type of change for a cam plate. MC_Cam Scaling Mode [} 59] Contains type and scope of the scaling of a cam plate coupling, used by the function block MC_Cam Scaling. MC_Cam Info Data [} 62] Contains data on the current state of a cam plate coupling. MC_Interpolation Type [} 63] Interpolation mode for position tables. MC_Motion Function Point [} 64] Describes an interpolation point of a motion function. MC_Motion Function Point_ID [} 65] Type definition for the point ID of the points of a motion function. MC_Motion Function Type [} 66] Type definition for motion functions. MC_Motion Point Type [} 67] Type definition for a table point. MC_Table Charac Values [} 68] Type definition for the characteristic parameters of a motion function. MC_Table Error Codes [} 69] Type definition of table error codes. MC_Table Type [} 69] Type definition of table types. MC_Value Select Type [} 69] Type definition for access to value tables with the function block MC_Read Motion Function Values. MC_Start Mode [} 70] Defines whether a cam plate is interpreted absolute to the origin of the axis coordinate system or relative to the coupling position. ST_Cam In Options [} 71] Data of type ST_Cam In Options can optionally be transferred to the function block MC_Cam In. Cam Master Data [} 72] Data of type Cam Master Data are optionally transferred by function block MC_Read Cam Table Master Position. MC_Cam Operation Mode [} 72] Used for managing couplings with superimposed cam plates with the function block MC_Cam In_V2. ST_Cam Scaling Data [} 73] Contains information for scaling a cam plate, used with the function block MC_Cam In_V2. 10 Version: 1.8.3 TF5050
## Page 11

Cam plates 4 Cam plates 4.1 MC_Cam Table Select MC_Cam Table Select Execute BOOL BOOL Done Periodic BOOL BOOL Busy Cam Table ID MC_CAM_ID BOOL Error ↔ Cam Table Reference To MC_CAM_REF UDINT Error ID With the function block MC_Cam Table Select, a table can be specified and loaded into the NC. The function block creates a new table and simultaneously fills it with data provided by the PLC. MC_Cam Table Select does not have to be used, if a table created with the Twin CAT cam plate editor is to be used. In this case, simple coupling with MC_Cam In [} 15] is sufficient. Inputs VAR_INPUT Execute : BOOL; Periodic : BOOL; Cam Table ID : MC_CAM_ID; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Periodic BOOL Periodic is TRUE if the cam plate is cyclically repeated. Cam Table ID MC_CAM_ID ID of the cam plate used for the coupling. Inputs/outputs VAR_IN_OUT Cam Table : MC_CAM_REF; END_VAR Name Type Description Cam Table MC_CAM_REF The data structure of type MC_CAM_REF [} 55] describes the data storage for the cam plate in the PLC. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the cam plate was created successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. TF5050 Version: 1.8.3 11
## Page 12

Cam plates Name Type Description Error ID UDINT If the error output is set, this parameter supplies the error number. 12 Version: 1.8.3 TF5050
## Page 13

Cam plates 4.2 MC_Cam Out MC_Cam Out Execute BOOL BOOL Done Options ST_Cam Out Options BOOL Busy ↔ Slave Reference To AXIS_REF BOOL Error UDINT Error ID The function block MC_Cam Out disables a master-slave coupling. If a slave axis is uncoupled during the movement, it is not automatically stopped, but reaches a continuous velocity with which it will continue to travel endlessly. The axis can be stopped with a Stop command. NOTICE Calling during the movement After decoupling, the slave axis switches to acceleration-free state and continues to move with the resulting constant velocity. There is no positioning based on the master travel path calculated with the coupling factor. Instead, the behavior matches the behavior after a MC_Move Velocity command. Inputs VAR_INPUT Execute : BOOL; Options : ST_Gear Out Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Options ST_Cam Out Options Currently not implemented. Inputs/outputs VAR_IN_OUT Slave : AXIS_REF; END_VAR Name Type Description Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the cam plate was created successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. TF5050 Version: 1.8.3 13
## Page 14

Cam plates Name Type Description Error ID UDINT If the error output is set, this parameter supplies the error number. 14 Version: 1.8.3 TF5050
## Page 15

Cam plates 4.3 MC_Cam In MC_Cam In Execute BOOL BOOL In Sync Master Offset LREAL BOOL Busy Slave Offset LREAL BOOL Active Master Scaling LREAL BOOL Command Aborted Slave Scaling LREAL BOOL Error Start Mode MC_Start Mode UDINT Error ID Cam Table ID MC_CAM_ID Buffer Mode MC_Buffer Mode Options ST_Cam In Options ↔ Master Reference To AXIS_REF ↔ Slave Reference To AXIS_REF The function block MC_Cam In activates master-slave coupling with a certain cam plate. In addition it is possible to switch to a new cam plate in coupled state. The switching rules, in particular the time or position, can be specified. The status flag Axis. Status. Cam Table Queued (AXIS_REF) can be used to check whether a cam plate is queued for switchover. Important: Further information on coupling with cam plates [} 18] Activation Mode [} 56] (coupling or switching of cam plates) Start Mode [} 70] Scaling Mode [} 59] Inputs VAR_INPUT Execute : BOOL; Master Offset : LREAL; Slave Offset : LREAL; Master Scaling : LREAL := 1.0; Slave Scaling : LREAL := 1.0; Start Mode : MC_Start Mode; Cam Table ID : MC_CAM_ID; Buffer Mode : MC_Buffer Mode; Options : ST_Cam In Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Master Offset LREAL Offset to the master position of the cam plate. Slave Offset LREAL Offset to the slave position of the cam plate. Master Scaling LREAL Scaling of the master position of the cam plate. Slave Scaling LREAL Scaling of the slave position of the cam plate. Start Mode MC_Start Mode Start Mode [} 70] determines whether the cam positions are interpreted absolutely or relative to the coupling position. Start Mode can be relative or absolute for master (X coordinate) and slave (Y coordinate) respectively. Cam Table ID MC_CAM_ID ID [} 54] of the cam plate used for the coupling. Buffer Mode MC_Buffer Mode Currently not implemented. Options ST_Cam In Options Data structure [} 71] with further coupling and switching options: TF5050 Version: 1.8.3 15
## Page 16

Cam plates Name Type Description Activation Mode The Activation Mode [} 56] is used to specify the time or position at which the cam plate coupling or switchover is to take place. Activation Mode can also be specified when a slave is coupled for the first time. Activation Position Optional master position at which a cam plate is switched, depending on the Activation Mode. (Not required for first coupling.) If the Activation Mode MC_CAMACTIVATION_ATMASTE RCAMPOS is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Master Scaling Mode Optional Scaling mode [} 59] for the master position of the cam plate. Slave Scaling Mode Optional Scaling mode [} 59] for the slave position of the cam plate. Interpolation Type Interpolation type [} 63] for position tables. Not required for motion functions. Inputs/outputs VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR Name Type Description Master AXIS_REF Axis data structure of the master. Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT In Sync : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description In Sync BOOL Becomes TRUE if the coupling was successful and the cam plate is active. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. 16 Version: 1.8.3 TF5050
## Page 17

Cam plates Name Type Description Active BOOL Active indicates that the command is executed. For cam plate switching, Active becomes TRUE if the coupling command was executed successfully but the cam plate is still queued. If the cam plate is activated depending on the Activation Mode, Active becomes FALSE and In Sync is set. Command Aborted BOOL Becomes TRUE if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 17
## Page 18

Cam plates 4.4 MC_Camin Appendix Coupling with cam plates The function block MC_Cam In [} 15] can be used to establish a cam plate coupling (or table coupling) between a master axis and a slave axis. Note that prior to the coupling the slave axis has to be at a position defined by the cam plate. After the coupling and once the master has been started, the slave position is calculated directly from the cam plate. The slave axis is therefore not slowly synchronized with the cam plate, but it will jump if it is not already at the table position. In practice the question arises what position the slave should be in prior to the coupling, and how this is calculated. The following figures illustrate the procedure. NOTICE Possible calculation errors • For all subsequent calculations only axis set positions are used. The actual positions are not used in the calculations, since they would lead to calculation errors, particularly with cyclic cam plates. • Only absolute table couplings are considered. For relative couplings, the coupling position of the master or slave axis is considered in the calculations as an additional offset. Linear cam plates A linear cam plate is only defined via a limited master position range. Outside this range the slave position is defined by the first or last table position. The slave therefore stops at the table edges as soon as the master leaves the defined range. The diagram shows that the absolute axis coordinate system (blue) does not have to be identical to the cam plate coordinate system (red). The cam plate coordinate system may be offset by a master offset or a slave offset. Scaling is also possible. The slave position relating to a certain master position can be determined via the function block MC_Read Cam Table Slave Dynamics [} 45]. The block refers to the raw table data, which means that offsets and scaling factors have to be considered via the PLC program itself. Initially, the master offset is added to the current master position. If the cam plate is to be scaled, it is divided by this scaling factor. Master Cam Table Position := (Master Position + Master Offset) / Master Scaling; The master table position is used as input parameter for the function block MC_Read Cam Table Slave Dynamics [} 45]. The result is converted to an absolute slave position with slave offset and scaling, if necessary. Slave Cam Table Position := Read Slave Dynamics. Slave Position; Slave Position := (Slave Cam Table Position * Slave Scaling) + Slave Offset; 18 Version: 1.8.3 TF5050
## Page 19

Cam plates The slave is moved to this position prior to the coupling. Alternatively, the master may be moved to a position that corresponds to the current slave position. However, generally this position cannot be determined from the cam plate, since the cam plate may be ambiguous. Since the master offset is added in the first formula, a positive offset leads to the cam plate coordinate system being shifted to the left in negative direction. Accordingly, the master offset in the diagram is negative. A positive slave offset leads to the cam plate coordinate system being shifted upwards in positive direction. Cyclic cam plates without lift A cyclic cam plate without lift is characterized by the fact that the slave start and end positions in the table are identical. The slave therefore moves cyclically within a defined range, without changing its position permanently in a particular direction. For these cam plate types, master/slave coupling requires the same preparation as for a linear cam plate. The starting position of the slave can therefore be calculated as described above. It is not necessary to use the modulo position of the master for the calculation, since the absolute position is already correctly taken into account via the coupling command. Cyclic cam plates with lift The lift of a cyclic cam plate is the difference between the last and the first table position of the slave. TF5050 Version: 1.8.3 19
## Page 20

Cam plates Such a cam plate is continued cyclically at the end of the table. The slave position does not jump back to the initial table value. Instead, the motion continues steadily. With each new cycle, the lift is therefore added as an additional internal slave offset or subtracted if the motion is reversed. Uncoupling and re-coupling for cyclic cam plates with lift If a slave is coupled to a cam plate with lift, the coupling is always done in the basic cycle (red coordinate system), i.e. without added lifting distances. If the slave is uncoupled after a few cycles and then re-coupled, the slave position returns to the basic cycle. If necessary, this behavior has to be taken into account and compensated by re-calculating the slave offset. Master Cam Table Pos := (Master Position + Master Offset) / Master Scaling; The master table position is used as input parameter for the function block MC_Read Cam Table Slave Dynamics [} 45]. The result is converted to an absolute slave position with slave offset and scaling, if necessary. In addition, the number of pending lifts must be calculated and added to the slave position. Slave Cam Table Position := Read Slave Dynamics. Slave Position; Lift Numberl := MODTURNS( (Slave Position - Slave Offset), Slave Hub ); New Slave Offset := Slave Offset + (Slave Hub * lift number); Slave Position := (Slave Cam Table Position * Slave Scaling) + New Slave Offset; The Autooffset [} 59] function can simplify the calculation of offsets, particularly for switching of cam plates. 20 Version: 1.8.3 TF5050
## Page 21

Cam plates 4.5 MC_Cam Scaling MC_Cam Scaling Execute BOOL BOOL Done Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Active Master Scaling Mode MC_Cam Scaling Mode BOOL Command Aborted Slave Scaling Mode MC_Cam Scaling Mode BOOL Error Master Offset LREAL UDINT Error ID Slave Offset LREAL Master Scaling LREAL Slave Scaling LREAL ↔ Slave Reference To AXIS_REF A cam plate coupling can be scaled with the function block MC_Cam Scaling. The raw table data of the cam plate are not affected, however the scaling refers to an existing master/slave coupling. The following parameters can be modified: scaling factors for master and slave, and offsets for the cam plate within the coordinate system. Optionally, the modification will only take effect from a certain master position, enabling precise scaling during the motion. Caution when scaling during motion. The slave position at the time of scaling should only be affected slightly by the change. The status flag Axis. Status. Cam Scaling Pending (AXIS_REF) can be used to check whether a scaling procedure is queued. Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode; Activation Position : LREAL; Master Scaling Mode : MC_Cam Scaling Mode; Slave Scaling Mode : MC_Cam Scaling Mode; Master Offset : LREAL; Slave Offset : LREAL; Master Scaling : LREAL := 1.0; Slave Scaling : LREAL := 1.0; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Activation Mode [} 56] specifies the scaling time or position. Mode Activation Position LREAL Master position at which a cam plate is scaled depending on the Activation Mode [} 56]. If the Activation Mode MC_CAMACTIVATION_ATMASTERCAMPOS is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Master Scaling Mode MC_Cam Scaling Mo Optional Scaling mode [} 59] for the master position of the cam de plate. Slave Scaling Mode MC_Cam Scaling Mo Optional Scaling mode [} 59] for the slave position of the cam de plate. Master Offset LREAL Offset to the master position of the cam plate. Slave Offset LREAL Offset to the slave position of the cam plate. Master Scaling LREAL Scaling of the master position of the cam plate. Slave Scaling LREAL Scaling of the slave position of the cam plate. TF5050 Version: 1.8.3 21
## Page 22

Cam plates Inputs/outputs VAR_IN_OUT Slave : AXIS_REF; END_VAR Name Type Description Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the cam plate was created successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Active BOOL Active indicates that the command is executed. For cam plate switching Active becomes TRUE, if the coupling command was executed successfully but the cam plate is still queued. If the cam plate is activated depending on the Activation Mode, Active becomes FALSE and In Sync is set. Command Aborte BOOL Becomes TRUE, if the command could not be fully d executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 22 Version: 1.8.3 TF5050
## Page 23

Multi cam plates 5 Multi cam plates 5.1 MC_Cam In_V2 MC_Cam In_V2 Execute BOOL BOOL In Sync Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Active Cam Table ID MC_CAM_ID BOOL Command Aborted Scaling ST_Cam Scaling Data BOOL Error Options ST_Cam In Options_V2 UDINT Error ID ↔ Master Reference To AXIS_REF ↔ Slave Reference To AXIS_REF MC_Cam In_V2 is a further development of the function block MC_Cam In [} 15] and is able to operate with several superimposed cam plates (Multi-Cam). When MC_Cam In_V2 is first called it creates a master/slave coupling with the cam plate. Subsequent calls during runtime can be used to superimpose additional cam plates for the same slave axis or remove them again. The switching rules, in particular the time or position, can be specified. MC_Cam In_V2 can only be used as an alternative to MC_Cam In. The two function blocks cannot be used together for the same slave axis. For addition, replacement and removal of cam plates the function blocks MC_Cam Add [} 26], MC_Cam Exchange [} 28] and MC_Cam Remove [} 30] are available as alternatives. All operations can also be carried out with MC_Cam In_V2. The status flag Axis. Status. Cam Table Queued (AXIS_REF) can be used to check whether a cam plate is queued for addition or switchover. Important: Activation Mode [} 56] (time or position from which the operation takes place) Cam Operation Mode [} 72] (adding, switching or removal of superimposed cam plates) Scaling Mode [} 59] Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode := MC_CAMACTIVATION_INSTANTANEOUS; Activation Position : LREAL; Cam Table ID : MC_CAM_ID; Scaling : ST_Cam Scaling Data; Options : ST_Cam In Options_V2; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Mode Activation Mode [} 56] specifies the scaling time or position. Activation Position LREAL Master position at which a cam plate is scaled depending on the Activation Mode [} 56]. If the Activation Mode MC_CAMACTIVATION_ATMASTERCAMPOS is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Cam Table ID MC_CAM_ID ID [} 54] of the cam plate used for the coupling. Scaling ST_Cam Scaling Data Optional scaling parameters [} 73] for the cam plate. TF5050 Version: 1.8.3 23
## Page 24

Multi cam plates Name Type Description Options ST_Cam In Options_V2 Data structure [} 71] with further coupling and switching options: Interpolation type Interpolation type [} 63] for position tables. Not required for motion functions. Cam Operation Mode The Cam Operation Mode [} 72] defines the way the specified cam plate (Cam Table ID) has to act in the coupled system. Cam plates can be added, switched or removed. Reference Cam Table ID Optional ID [} 54] of a cam plate that is already active in the coupling. This ID is specially required for operations that would otherwise be ambiguous, e.g. replacement of certain cam plates in multi-couplings. In unambiguous operations the value can remain 0. Inputs/outputs VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR Name Type Description Master AXIS_REF Axis data structure of the master. Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT In Sync : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description In Sync BOOL Becomes TRUE if the cam plate operation was completed successfully. In operations with activation position, In Sync only becomes TRUE after the actual activation. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, In Sync or Error, is set. Active BOOL Active indicates that the command is executed. For cam plate switching, Active becomes TRUE if the coupling command was executed successfully but the cam plate is still queued. If the cam plate is activated depending on the Activation Mode, Active becomes FALSE and In Sync is set. 24 Version: 1.8.3 TF5050
## Page 25

Multi cam plates Name Type Description Command Aborted BOOL Becomes TRUE if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 25
## Page 26

Multi cam plates 5.2 MC_Cam Add MC_Cam Add Execute BOOL BOOL In Sync Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Active Cam Table ID MC_CAM_ID BOOL Command Aborted Scaling ST_Cam Scaling Data BOOL Error Options ST_Cam Add Options UDINT Error ID ↔ Master Reference To AXIS_REF ↔ Slave Reference To AXIS_REF MC_Cam Add adds a cam plate to a multi-cam coupling. The cam plate coupling is initially created with MC_Cam In_V2 [} 23]. Alternatively, a cam plate can be added with MC_Cam In_V2. The status flag Axis. Status. Cam Table Queued (AXIS_REF) can be used to check whether a cam plate is queued for addition or switchover. Important: Activation Mode [} 56] (time or position from which the operation takes place) Cam Operation Mode [} 72] (adding, switching or removal of superimposed cam plates) Scaling Mode [} 59] Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode := MC_CAMACTIVATION_INSTANTANEOUS; Activation Position : LREAL; Cam Table ID : MC_CAM_ID; Scaling : ST_Cam Scaling Data; Options : ST_Cam Add Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Mode The Activation Mode [} 56] is used to specify the time or position at which the cam plate coupling or switchover is to take place. Activation Mode [} 56] can also be specified when a slave is coupled for the first time. Activation Position LREAL Optional master position at which a cam plate is switched, depending on the Activation Mode [} 56]. (Not required for first coupling.) If the MC_CAMACTIVATION_ATMASTERCAMPOS Activation Mode [} 56] is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Cam Table ID MC_CAM_ID ID [} 54] of the cam plate used for the coupling. Scaling ST_Cam Scaling Data Optional scaling parameters [} 73] for the cam plate. Options ST_Cam Add Options Interpolation Type Interpolation type [} 63] for position tables. Not required for motion functions. 26 Version: 1.8.3 TF5050
## Page 27

Multi cam plates Inputs/outputs VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR Name Type Description Master AXIS_REF Axis data structure of the master. Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT In Sync : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description In Sync BOOL Becomes TRUE if the cam plate operation was completed successfully. In operations with activation position, In Sync only becomes TRUE after the actual activation. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, In Sync or Error, is set. Active BOOL Active indicates that the command is executed. For cam plate switching, Active becomes TRUE if the coupling command was executed successfully but the cam plate is still queued. If the cam plate is activated depending on the Activation Mode, Active becomes FALSE and In Sync is set. Command Aborted BOOL Becomes TRUE if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 27
## Page 28

Multi cam plates 5.3 MC_Cam Exchange MC_Cam Exchange Execute BOOL BOOL In Sync Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Active Cam Table ID MC_CAM_ID BOOL Command Aborted Reference Cam Table ID MC_CAM_ID BOOL Error Scaling ST_Cam Scaling Data UDINT Error ID Options ST_Cam Exchange Options ↔ Master Reference To AXIS_REF ↔ Slave Reference To AXIS_REF MC_Cam Exchange exchanges a cam plate in a multi-cam coupling. The cam plate coupling is initially created with MC_Cam In_V2 [} 23]. Alternatively, a cam plate can be exchanged with MC_Cam In_V2. The status flag Axis. Status. Cam Table Queued (AXIS_REF) can be used to check whether a cam plate is queued for addition or switchover. Important: Activation Mode [} 56] (time or position from which the operation takes place) Cam Operation Mode [} 72] (adding, switching or removal of superimposed cam plates) Scaling Mode [} 59] Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode := MC_CAMACTIVATION_INSTANTANEOUS; Activation Position : LREAL; Cam Table ID : MC_CAM_ID; Reference Cam Table ID : MC_CAM_ID; Scaling : ST_Cam Scaling Data; Options : ST_Cam Exchange Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Mode The Activation Mode [} 56] is used to specify the time or position at which the cam plate coupling or switchover is to take place. Activation Mode [} 56] can also be specified when a slave is coupled for the first time. Activation Position LREAL Optional master position at which a cam plate is switched, depending on the Activation Mode [} 56]. (Not required for first coupling.) If the MC_CAMACTIVATION_ATMASTERCAMPOS Activation Mode [} 56] is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Cam Table ID MC_CAM_ID ID [} 54] of the cam plate used for the coupling. Reference Cam Ta MC_CAM_ID Optional ID of a cam plate that is already active in the ble ID coupling. This ID is specially required for operations that would otherwise be ambiguous, e.g. replacement of certain cam plates in multi-couplings. In unambiguous operations the value can remain 0. 28 Version: 1.8.3 TF5050
## Page 29

Multi cam plates Name Type Description Scaling ST_Cam Scaling Data Optional scaling parameters [} 73] for the cam plate. Options ST_Cam Add Options Interpolation Type Interpolation type [} 63] for position tables. Not required for motion functions. Inputs/outputs VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR Name Type Description Master AXIS_REF Axis data structure of the master. Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT In Sync : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description In Sync BOOL Becomes TRUE if the cam plate operation was completed successfully. In operations with activation position, In Sync only becomes TRUE after the actual activation. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, In Sync or Error, is set. Active BOOL Active indicates that the command is executed. For cam plate switching, Active becomes TRUE if the coupling command was executed successfully but the cam plate is still queued. If the cam plate is activated depending on the Activation Mode, Active becomes FALSE and In Sync is set. Command Aborted BOOL Becomes TRUE if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 29
## Page 30

Multi cam plates 5.4 MC_Cam Remove MC_Cam Remove Execute BOOL BOOL Done Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Command Aborted Cam Table ID MC_CAM_ID BOOL Active Options ST_Cam Remove Options BOOL Error ↔ Master Reference To AXIS_REF UDINT Error ID ↔ Slave Reference To AXIS_REF MC_Cam Remove removes a cam plate from a multi-cam environment. See also MC_Cam In_V2 [} 23]. Important: Activation Mode [} 56] (time or position from which the operation takes place) Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode := MC_CAMACTIVATION_INSTANTANEOUS; Activation Position : LREAL; Cam Table ID : MC_CAM_ID; Options : ST_Cam Remove Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Mode The Activation Mode [} 56] is used to specify the time or position at which the cam plate coupling or switchover is to take place. Activation Mode [} 56] can also be specified when a slave is coupled for the first time. Activation Position LREAL Optional master position at which a cam plate is switched, depending on the Activation Mode [} 56]. (Not required for first coupling.) If the MC_CAMACTIVATION_ATMASTERCAMPOS Activation Mode [} 56] is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Cam Table ID MC_CAM_ID ID [} 54] of the cam plate that is removed from the coupled system. Options ST_Cam Remove Option Currently not used. s Inputs/outputs VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR Name Type Description Master AXIS_REF Axis data structure of the master. Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. 30 Version: 1.8.3 TF5050
## Page 31

Multi cam plates Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the cam plate operation was completed successfully. In operations with activation position, Done only becomes TRUE after the actual deactivation. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Active BOOL Active indicates that the command is executed. Active becomes TRUE if the command was issued successfully but the operation is still queued. If the cam plate is activated depending on the Activation Mode [} 56], Active becomes FALSE and In Sync is set. Command Aborted BOOL Becomes TRUE if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 31
## Page 32

Multi cam plates 5.5 MC_Cam Scaling_V2 MC_Cam Scaling_V2 Execute BOOL BOOL Done Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Active Cam Table ID MC_CAM_ID BOOL Command Aborted Scaling ST_Cam Scaling Data BOOL Error Options ST_Cam Scaling Options_V2 UDINT Error ID ↔ Slave Reference To AXIS_REF A cam plate coupling can be scaled with the MC_Cam Scaling_V2 function block. The raw table data of the cam plate are not affected, however the scaling refers to an existing master/slave coupling. The following parameters can be modified: scaling factors for master and slave, and offsets for the cam plate within the coordinate system. Optionally, the modification will only take effect from a certain master position, enabling precise scaling during the motion. Caution when scaling during motion. The slave position at the time of scaling should only be affected slightly by the change. The Axis. Status. Cam Scaling Pending (AXIS_REF) status flag can be used to check whether a scaling procedure is queued. Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode; Activation Position : LREAL; Cam Table ID : MC_CAM_ID; Scaling : ST_Cam Scaling Data; Options : ST_Cam Scaling Options_V2; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Activation Mode [} 56] specifies the scaling time or position. Mode Activation Position LREAL Master position at which a cam plate is scaled depending on the Activation Mode [} 56]. If the MC_CAMACTIVATION_ATMASTERCAMPOS Activation Mode [} 56] is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Cam Table ID MC_CAM_ID ID [} 54] of the cam plate that is scaled. Scaling ST_Cam Scaling Dat Scaling data such as mode, offset and scaling factor a Options ST_Cam Scaling Opt Not used ions_V2 Inputs/outputs VAR_IN_OUT Slave : AXIS_REF; END_VAR Name Type Description Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. 32 Version: 1.8.3 TF5050
## Page 33

Multi cam plates Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if scaling was successful. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Active BOOL Active indicates that the command is executed. For cam plate switching, Active becomes TRUE if the coupling command was executed successfully but the cam plate is still queued. If the cam plate is activated depending on the Activation Mode, Active becomes FALSE and In Sync is set. Command Aborted BOOL Becomes TRUE if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 33
## Page 34

Motion functions 6 Motion functions 6.1 MC_Read Motion Function MC_Read Motion Function Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Point ID MC_Motion Function Point_ID BOOL Error Num Points UDINT UDINT Error ID ↔ Cam Table Reference To MC_CAM_REF UDINT Num Points Read The MC_Read Motion Function function block can be used to read the data of a motion function. Either the complete function with all interpolation points or only a part can be read. The data are stored within the PLC in the structure described by Cam Table [} 55]. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Point ID : MC_Motion Function Point_ID; Num Points : UDINT; (* 0 = fill MFsize *) END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table ID MC_CAM_ID ID [} 54] of the loaded table. Point ID MC_Motion Function Point ID [} 65] of the first point of the motion function to be Point_ID read. Num Points UDINT Number of motion function points to be read. For reading all points, 0 can be specified here, in which case the number that is actually read is returned in the output variable Num Points Read. Inputs/outputs VAR_IN_OUT Cam Table : MC_CAM_REF; END_VAR Name Type Description Cam Table MC_CAM_REF Reference [} 55] to the table (structure). Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; Num Points Read : UDINT; (* return value <= Num Points *) END_VAR Name Type Description Done BOOL Becomes TRUE if the data have been read successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. 34 Version: 1.8.3 TF5050
## Page 35

Motion functions Name Type Description Error ID UDINT If the error output is set, this parameter supplies the error number. Num Points Read UDINT The number of points that were actually read. The number can be less than or equal to Num Points. TF5050 Version: 1.8.3 35
## Page 36

Motion functions 6.2 MC_Read Motion Function Point MC_Read Motion Function Point Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Point ID MC_Motion Function Point_ID BOOL Error ↔ Point Reference To MC_Motion Function Point UDINT Error ID The function block MC_Read Motion Function Point can be used to read the data of a motion function interpolation point. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Point ID : MC_Motion Function Point_ID; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table ID MC_CAM_ID ID [} 54] of the loaded table. Point ID MC_Motion Function Point ID [} 65] of the first point of the motion function to be Point_ID read. Inputs/outputs VAR_IN_OUT Point : MC_Motion Function Point; END_VAR Name Type Description Point MC_Motion Function Point Data structure [} 64] containing the data of a motion function interpolation point. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the data have been read successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 36 Version: 1.8.3 TF5050
## Page 37

Motion functions 6.3 MC_Write Motion Function MC_Write Motion Function Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Point ID MC_Motion Function Point_ID BOOL Error Num Points UDINT UDINT Error ID Cam Table MC_CAM_REF Options ST_Write Motion Function Options The MC_Write Motion Function function block can be used to write the data of a motion function into the NC. Either the complete function with all interpolation points or only a part can be written. First, the data are stored within the PLC in the structure described by Cam Table [} 55]. The MC_Set Cam Online Change Mode [} 41] function block can be used to define when the data is transferred to the cam plate. If activation of the data is to be delayed until the master reaches a certain position, the system will initially queue the written data and activate them at the master position. The Axis. Status. Cam Data Queued (AXIS_REF) status flag can be used to check whether data have been queued, i.e. written but not yet activated. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Point ID : MC_Motion Function Point_ID; Num Points : UDINT; Cam Table : MC_CAM_REF; Options : ST_Write Motion Function Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table ID MC_CAM_ID ID [} 54] of the loaded table. Point ID MC_Motion Function Point ID [} 65] of the first point of the motion function to be Point_ID read. Num Points UDINT Number of motion function points to be written. Cam Table MC_CAM_REF Reference [} 55] to the table (structure). The start address of the table data structure (Cam Table.p Array) indicates the first point to be written. Options ST_Write Motion Fun Data structure with additional options: ction Options [} 74] Synchronous Access Writing takes place via synchronous access without a time delay. Should only be used for applications that are extremely time-critical. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the data have been read successfully. TF5050 Version: 1.8.3 37
## Page 38

Motion functions Name Type Description Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 38 Version: 1.8.3 TF5050
## Page 39

Motion functions 6.4 MC_Write Motion Function Point MC_Write Motion Function Point Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Point ID MC_Motion Function Point_ID BOOL Error Options ST_Write Motion Function Options UDINT Error ID ↔ Point Reference To MC_Motion Function Point The function block MC_Write Motion Function Point can be used to write the data of a motion function interpolation point. The function block MC_Set Cam Online Change Mode [} 41] can be used to define when the data is transferred to the cam plate. If activation of the data is to be delayed until the master reaches a certain position, the system will initially queue the written data and activate them at the master position. The status flag Axis. Status. Cam Data Queued (AXIS_REF) can be used to check whether data have been queued, i.e. written but not yet activated. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Point ID : MC_Motion Function Point_ID; Options : ST_Write Motion Function Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table ID MC_CAM_ID ID [} 54] of the loaded table. Point ID MC_Motion Function Point ID [} 65] of the first point of the motion function to be Point_ID written. Options ST_Write Motion Fun Data structure with additional options: ction Options [} 74] Synchronous Access Writing takes place via synchronous access without a time delay. Should only be used for applications that are extremely time-critical. Inputs/outputs VAR_IN_OUT Point : MC_Motion Function Point; END_VAR Name Type Description Point MC_Motion Function Point Data structure [} 64] containing the data of a motion function interpolation point. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the data have been read successfully. TF5050 Version: 1.8.3 39
## Page 40

Motion functions Name Type Description Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 40 Version: 1.8.3 TF5050
## Page 41

Motion functions 6.5 MC_Set Cam Online Change Mode MC_Set Cam Online Change Mode Execute BOOL BOOL Done Activation Mode MC_Cam Activation Mode BOOL Busy Activation Position LREAL BOOL Error Master Scaling Mode MC_Cam Scaling Mode UDINT Error ID Slave Scaling Mode MC_Cam Scaling Mode Cam Table ID MC_CAM_ID Options ST_Set Online Change Mode Options The function block MC_Set Cam Online Change Mode specifies the mode for write access to cam plate data. Cam plates can be modified at runtime via the PLC (see MC_Write Motion Function [} 37], MC_Write Motion Function Point [} 39]). The function block MC_Set Cam Online Change Mode is used to specify when and how these changes take effect. The set mode affects all subsequent write operations. It is therefore not necessary to call the function block before each write access. This function specifies the activation mode for modifications but does not affect a change or changeover of cam plates. Inputs VAR_INPUT Execute : BOOL; Activation Mode : MC_Cam Activation Mode; Activation Position : LREAL; Master Scaling Mode : MC_Cam Scaling Mode; Slave Scaling Mode : MC_Cam Scaling Mode; Cam Table ID : MC_CAM_ID; Options : ST_Set Online Change Mode Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Activation Mode MC_Cam Activation Defines when and how scaling takes place. Mode (MC_Cam Activation Mode [} 56]) Activation Position LREAL Optional master position at which scaling is performed (depending on Activation Mode [} 56]). If the Activation Mode [} 56] MC_CAMACTIVATION_ATMASTERCAMPOS is used, the position refers to the unscaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. Master Scaling Mode MC_Cam Scaling Mo Type of master scaling. (MC_Cam Scaling Mode [} 59]) de Slave Scaling Mode MC_Cam Scaling Mo Type of slave scaling. (MC_Cam Scaling Mode [} 59]) de Cam Table ID MC_CAM_ID Table ID [} 54]. Options ST_Set Online Chang Data structure with additional options: e Mode Options Synchronous Access Writing takes place via [} 74] synchronous access without a time delay. Should only be used for applications that are extremely time-critical. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; TF5050 Version: 1.8.3 41
## Page 42

Motion functions Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE when the function has been successfully executed. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 42 Version: 1.8.3 TF5050
## Page 43

Motion functions 6.6 MC_Read Motion Function Values MC_Read Motion Function Values Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Value Select Mask UINT BOOL Error Start Pos Master LREAL UDINT Error ID End Pos Master LREAL Increment LREAL ↔ Cam Table Reference To MC_CAM_REF The function block MC_Read Motion Function Values can be used to read the interpolated data of a motion function in the form of a table. This function can be used for visualizing a motion function, for example. The complete curve is digitized with a parameterizable step size. The data determined in this way are easier to display then a motion function. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Value Select Mask : UINT; (* MC_Value Select Type; position, velocity, acceleration, jerk… *) Start Pos Master : LREAL; (* master position of first point *) End Pos Master : LREAL; (* master position of last point *) Increment : LREAL; (* increment of master position *) END_VAR Name Type Description Execute BOOL The command is executed with the rising edge. Cam Table ID MC_CAM_ID ID [} 54] of the loaded table (motion function type). Value Select Mask UINT The selection mask can be used to specify which data are to be interpolated and returned. The value is created by adding single values of the data type MC_Value Select Type [} 69]. The number of columns of the data structure described by Cam Table [} 55] must correspond to the number of columns determined by Value Select Mask [} 69]. If, for example, only position data are read, the number of columns is 2 (master and slave position). With each further derivative (velocity, acceleration, jerk), the number of columns increases by 1. Start Pos Master LREAL Position value of the master axis of the first interpolated point. End Pos Master LREAL Position value of the master axis of the last interpolated point. Increment LREAL Interpolation step size Inputs/outputs VAR_IN_OUT Cam Table : MC_CAM_REF; END_VAR Name Type Description Cam Table MC_CAM_REF Reference [} 55] to the table (structure). Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR TF5050 Version: 1.8.3 43
## Page 44

Motion functions Name Type Description Done BOOL Becomes TRUE if the data have been read successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 44 Version: 1.8.3 TF5050
## Page 45

Status 7 Status 7.1 MC_Read Cam Table Slave Dynamics MC_Read Cam Table Slave Dynamics Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Master Position LREAL BOOL Error Options ST_Read Cam Table Slave Dynamics Options UDINT Error ID LREAL Slave Position LREAL Slave Velocity LREAL Slave Acceleration The function block MC_Read Cam Table Slave Dynamics can be used to determine the slave dynamics at a certain point of a cam plate table. The function evaluates the raw table data. Any scaling of the cam plate is not taken into account. For older cam plate table types [} 69], not all dynamic parameters can be determined. The following overview shows the expected result: MC_TABLETYPE_MOTIONFUNCTION: slave position, velocity and acceleration are determined. MC_TABLETYPE_EQUIDISTANT: slave position and velocity are determined. The acceleration is always 0. MC_TABLETYPE_NONEQUIDISTANT: the slave position is determined. Velocity and acceleration are always 0. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Master Position : LREAL; Options : ST_Read Cam Table Slave Dynamics Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table ID MC_CAM_ID ID [} 54] of the loaded table. Master Position LREAL Master position within the table for which the slave dynamics is to be determined. Options ST_Read Cam Table Sl Data structure with additional options: ave Dynamics Option Synchronous Access Writing takes place via s [} 74] synchronous access without a time delay. Should only be used for applications that are extremely time-critical. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Slave Position : LREAL; Slave Velocity : LREAL; Slave Acceleration : LREAL; Error : BOOL; Error ID : UDINT; END_VAR TF5050 Version: 1.8.3 45
## Page 46

Status Name Type Description Done BOOL Becomes TRUE, if the command was executed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Slave Position LREAL Position of the slave within the cam plate table at the specified master position. Slave Velocity LREAL Velocity of the slave within the cam plate table at the specified master position. Slave Acceleratio LREAL Acceleration of the slave within the cam plate table at the n specified master position. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 46 Version: 1.8.3 TF5050
## Page 47

Status 7.2 MC_Cam Info MC_Cam Info Execute BOOL BOOL Done At Master Position BOOL BOOL Busy Master Position LREAL BOOL Error ↔ Slave Reference To AXIS_REF UDINT Error ID MC_Cam Info Data Cam Info The MC_Cam Info function block is used to determine data on the current state and the current parameterization of a cam plate coupling. The command assumes that the slave axis is coupled by a cam plate. If the At Master Position input is TRUE, not the current state but the state related to the specified master position is determined. The data obtained is placed into the Cam Info data structure. If the coupled axis group gets into an error situation (e.g. emergency stop), the function block will return the most recent valid state of the coupling. The function block must be called before decoupling the slave. The data that has been obtained can be used to restore the coupling to the original axis position. Inputs VAR_INPUT Execute : BOOL; At Master Position : BOOL; Master Position : LREAL; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. At Master Position BOOL If At Master Position is TRUE, the data related to the specified Master Position is determined. Otherwise the data refers to the current master position. Master Position LREAL Master position to which the data that is determined refers. This input parameter is not necessary if At Master Position is FALSE. Inputs/outputs VAR_IN_OUT Slave : AXIS_REF; END_VAR Name Type Description Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; Cam Info : MC_Cam Info Data; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was executed successfully. TF5050 Version: 1.8.3 47
## Page 48

Status Name Type Description Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Cam Info MC_Cam Info Data The Cam Info [} 62] data structure contains all the data determined about the cam plate coupling 48 Version: 1.8.3 TF5050
## Page 49

Status 7.3 MC_Cam Info_V2 MC_Cam Info_V2 Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy At Master Position BOOL BOOL Error Master Position LREAL UDINT Error ID ↔ Slave Reference To AXIS_REF MC_Cam Info Data Cam Info The MC_Cam Info_V2 function block obtains data relating to the current state and current parameterization of a cam plate coupling. The command assumes that the slave axis is coupled by a cam plate. If the At Master Position input is TRUE, not the current state but the state related to the specified master position is determined. The data obtained is placed into the Cam Info data structure. For multi-cam plate coupling, the Cam Table Id also has to be transferred explicitly. If a single cam plate is involved in the coupling, the Cam Table Id can be set to 0. If the coupled axis group gets into an error situation (e.g. emergency stop), the function block will return the most recent valid state of the coupling. The function block must be called before decoupling the slave. The data that has been obtained can be used to restore the coupling to the original axis position. Inputs VAR_INPUT Execute : BOOL; Cam Table Id : BOOL; At Master Position : BOOL; Master Position : LREAL; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table Id BOOL For multi-cam plate coupling, this has to be transferred explicitly, in order to identify the cam unambiguously within the system. At Master Position BOOL If At Master Position is TRUE, the data related to the specified Master Position is determined. Otherwise the data refers to the current master position. Master Position LREAL Master position to which the data that is determined refers. This input parameter is not necessary if At Master Position is FALSE. Inputs/outputs VAR_IN_OUT Slave : AXIS_REF; END_VAR Name Type Description Slave AXIS_REF Axis data structure of the Slave. The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR TF5050 Version: 1.8.3 49
## Page 50

Status Name Type Description Done BOOL Becomes TRUE when the function has been successfully executed. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 50 Version: 1.8.3 TF5050
## Page 51

Status 7.4 MC_Read Cam Table Characteristics MC_Read Cam Table Characteristics Execute BOOL BOOL Done Cam Table ID UDINT BOOL Busy Options ST_Read Cam Table Characteristics Options BOOL Error ↔ Cam Table Charac Reference To MC_Table Charac Values UDINT Error ID The function block MC_Read Cam Table Characteristics is used to calculate and read the characteristic parameters of a motion function. This includes minimum and maximum values of position, velocity, acceleration and jerk. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Options : ST_Read Cam Table Characteristics Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table Id MC_CAM_ID Table ID [} 54] Options ST_Read Cam Table Reserved for future extensions Characteristics Optio ns Inputs/outputs VAR_IN_OUT Cam Table Charac : MC_Table Charac Values; END_VAR Name Type Description Cam Table Charac MC_Table Charac V Data structure [} 68] with characteristic parameters of the alues motion function Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the calculation was carried out successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5050 Version: 1.8.3 51
## Page 52

Status 7.5 MC_Read Cam Table Master Position MC_Read Cam Table Master Position Execute BOOL BOOL Done Cam Table ID MC_CAM_ID BOOL Busy Slave Position LREAL BOOL Error Master Offset LREAL UDINT Error ID Slave Offset LREAL ST_Cam Master Data Master Low Master Scaling LREAL ST_Cam Master Data Master High Slave Scaling LREAL Master Start Position LREAL Master Accuracy LREAL The function block MC_Read Cam Table Master Position can be used to calculate the master position for a given slave position. While the slave position for a given master position must be unique, the inverse is not true. In order to limit the number of master output options for the function block, for a given master position (Master Start Position) the smaller (Master Low) and larger master position (Master High) for the slave value is output. For example, for the cam plate in Fig. 1, for a slave value of 80 and a master start value of 180, the output values are 225 for Master High and 135 for Master Low. If the cam plate is cyclic, for a master start value of 90 in addition to the Master High of 135 a Master Low of -135 is calculated. In the linear cam plate case (non- cyclic) only the value Master High is shown as valid in figure 2. Fig. 1 In cyclic cam plates with hub the master position can not only lie in one of the cycles adjacent to the Start Masterpos, but several cycles further, depending on the slave position. 52 Version: 1.8.3 TF5050
## Page 53

Status Fig. 2 The master position is calculated with numeric algorithms, whose accuracy can be set via the variable Master Accuracy. Inputs VAR_INPUT Execute : BOOL; Cam Table ID : MC_CAM_ID; Slave Position : LREAL; (* absolute slave axis position *) Master Offset : LREAL; (* E *) Slave Offset : LREAL; (* E *) Master Scaling : LREAL := 1.0; (* E *) Slave Scaling : LREAL := 1.0; (* E *) Master Start Position : LREAL; (* Master position to start the iteration from *) Master Accuracy : LREAL; (* Master iteration accuracy *) END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Cam Table Id MC_CAM_ID Table ID [} 54] Slave Position LREAL The slave position for which the master position is sought. Master Offset LREAL Offset to the master position of the cam plate Slave Offset LREAL Offset to the slave position of the cam plate Master Scaling LREAL Scaling of the master position of the cam plate Slave Scaling LREAL Scaling of the slave position of the cam plate Master Start Position LREAL Start position of the master Master Accuracy LREAL Accuracy for the calculation Outputs VAR_OUTPUT Execute : BOOL; Done : BOOL; Busy : BOOL; Active : BOOL; Error : BOOL; Error ID : UDINT; Master Low : ST_Cam Master Data; (* position information of the lower bound master position *) Master High : ST_Cam Master Data; (* position information of the upper bound master position *) END_VAR Name Type Description Done BOOL Becomes TRUE, if the coupling was successful and the cam plate is active. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Master Low ST_Cam Master Data Master position is smaller than the Master Start Position in the data structure ST_Cam Master Data [} 72] Master High ST_Cam Master Data Master position is greater than the Master Start Position in the data structure ST_Cam Master Data [} 72] TF5050 Version: 1.8.3 53
## Page 54

Data type 8 Data type 8.1 MC_CAM_ID TYPE MC_CAM_ID : UDINT; END_TYPE Type definition for the tables ID. 54 Version: 1.8.3 TF5050
## Page 55

Data type 8.2 MC_CAM_REF TYPE MC_CAM_REF : STRUCT p Array : UDINT; Array Size : UDINT; Table Type : MC_Table Type; No Of Rows : UDINT; No Of Columns : UDINT; END_STRUCT END_TYPE The data structure MC_CAM_REF describes the data memory of a cam plate in a further PLC variable (ARRAY). The first parameter p Array is a pointer to a data structure containing the cam plate data. The data structure depends on the table type n Table Type. The number of rows is entered in the component n No Of Rows, the number of columns in n No Of Cols (usually 1 or 2). Example 1: Position table structure description Name Type Description p Array UDINT Address of a two-dimensional array. The first column contains an ascending list of master positions. The second column contains the associated slave positions. The address can be assigned with the ADR function. Example: Table1 : ARRAY[0..360, 0..1] OF LREAL; p Array := ADR( Table1 ); Array Size UDINT Storage capacity of the two-dimensional array, which can be determined with the SIZEOF function. Example: Array Size := SIZEOF( Table1 ); Table Type MC_Table Type The table type [} 69] is MC_TABLETYPE_EQUIDISTANT, if the master positions have the same distance or MC_TABLETYPE_NONEQUIDISTANT if the distance is variable. No Of Rows UDINT The number or rows corresponds to the number of table points. No Of Columns UDINT The number of columns is 2. Example 2: Structure description of a motion function Name Type Description p Array UDINT Address of a one-dimensional array of type MC_Motion Function Point. [} 64] Each array element contains a description of a cam plate interpolation point. Example: Motion Function : ARRAY[1..10] OF MC_Motion Function Point; p Array := ADR( Motion Function ); Array Size UDINT Storage capacity of the one-dimensional array, which can be determined with the SIZEOF function. Example: Array Size := SIZEOF( Motion Function ); Table Type MC_Table Type The table type is MC_TABLETYPE_MOTIONFUNCTION. No Of Rows UDINT The number or rows corresponds to the number of table points. No Of Columns UDINT The number of columns is 1. TF5050 Version: 1.8.3 55
## Page 56

Data type 8.3 MC_Cam Activation Mode TYPE MC_Cam Activation Mode : ( (* instantaneous change *) MC_CAMACTIVATION_INSTANTANEOUS, (* modify the data at a defined master position referring to the cam tables master position *) MC_CAMACTIVATION_ATMASTERCAMPOS, (* modify the data at a defined master position referring to the absolute master axis position *) MC_CAMACTIVATION_ATMASTERAXISPOS (* modify the data at the beginning of the next cam table cycle *) MC_CAMACTIVATION_NEXTCYCLE, (* not yet implemented! modify the data at the beginning of the next cam table cycle, activation is valid for one cycle only *) MC_CAMACTIVATION_NEXTCYCLEONCE, (* modify the data as soon as the cam table is in a safe state to change its data *) MC_CAMACTIVATION_ASSOONASPOSSIBLE, (* don't accept any modification *) MC_CAMACTIVATION_OFF, (* delete all data which was written to modify the cam table but is still not activated *) MC_CAMACTIVATION_DELETEQUEUEDDATA, (* special mode at a defined master axis position in a defined positive direction *) MC_CAMACTIVATION_ATMASTERAXISPOS_POSITVEDIRECTION, (* special mode at a defined master axis position in a defined negative direction *) MC_CAMACTIVATION_ATMASTERAXISPOS_NEGATIVEDIRECTION ); END_TYPE MC_Cam Activation Mode specifies the timing and type of change for a cam plate. Changes can be affected through scaling, modification of the cam plate data, or switching of cam plates. The following modes are possible: Scaling of cam plates Cam plates can be scaled with the function block MC_Cam Scaling [} 21]. The following activation modes are available. MC_CAMACTIVATION_INSTANTANEOUS Scaling takes effect immediately. MC_CAMACTIVATION_ATMASTERCAMPOS Scaling takes effect at a certain cam plate position (master position within the cam plate). The scaling command must be issued ahead of this position. The position refers to the non-scaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. MC_CAMACTIVATION_ATMASTERAXISPOS Scaling takes effect at a certain absolute position of the master axis. The scaling command must be issued ahead of this position. MC_CAMACTIVATION_NEXTCYCLE For a cyclic cam plate, scaling takes effect at the transition to the next period. MC_CAMACTIVATION_OFF No scaling is carried out. This can be used to limit scaling to one axis (master or slave), for example. Setting the mode for changing a cam plate online (writing of point data) MC_Set Cam Online Change Mode [} 41] is used to specify when modified cam plate data become active (see also MC_Write Motion Function [} 37] and MC_Write Motion Function Point [} 39]). In both cases the following modes are possible: 56 Version: 1.8.3 TF5050
## Page 57

Data type MC_CAMACTIVATION_INSTANTANEOUS The change takes effect immediately. MC_CAMACTIVATION_ATMASTERCAMPOS The change takes effect at a certain cam plate position (master position within the cam plate). The command must be issued ahead of this position. The position refers to the non-scaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. MC_CAMACTIVATION_ATMASTERAXISPOS The change takes effect at a certain absolute position of the master axis. The command must be issued ahead of this position. MC_CAMACTIVATION_NEXTCYCLE For a cyclic cam plate, the change takes effect at the transition to the next period. MC_CAMACTIVATION_ASSOONASPOSSIBLE Modified cam plate data take effect as soon as system dynamics allow. MC_CAMACTIVATION_OFF Changes in cam plate data are ignored. MC_CAMACTIVATION_DELETEQUEUEDDATA Queued cam plate data are deleted. Data are queued if the change was requested at a certain master position or at the end of the cycle, for example. Coupling with cam plates The function block MC_Cam In [} 15] can be used to couple axes with cam plates. Activation Mode can optionally be used to specify from which position the slave axis becomes active. MC_CAMACTIVATION_INSTANTANEOUS Cam plate coupling takes effect immediately, and the slave moves according to the cam plate data. MC_CAMACTIVATION_ATMASTERCAMPOS Cam plate coupling activation is suspended. The slave only moves from a defined cam plate position (master position within the cam plate) according to the cam plate data. In coupling mode, the Activation Mode cannot be used in conjunction with MC_Start Mode [} 70] = MC_STARTMODE_RELATIVE or MC_STARTMODE_MASTERREL_SLAVEABS. The position refers to the non-scaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. MC_CAMACTIVATION_ATMASTERAXISPOS Cam plate coupling activation is suspended. The slave only moves from a defined absolute position of the master axis according to the cam plate data. MC_CAMACTIVATION_NEXTCYCLE Cam plate coupling activation is suspended. The slave moves from the next cycle transition (for cyclic cam plates). In coupling mode, the Activation Mode cannot be used in conjunction with MC_Start Mode [} 70] = MC_STARTMODE_RELATIVE or MC_STARTMODE_MASTERREL_SLAVEABS. MC_CAMACTIVATION_ATMASTERAXISPOS_POS The cam plate coupling is performed at a defined ITVEDIRECTION absolute position of the master axis, when the master passes the position in positive direction. (This mode is a special case of MC_CAMACTIVATION_ATMASTERAXISPOS, which ensures safe activation in the immediate proximity around the current position, even at very low speeds with short-term changes of direction (noise)) TF5050 Version: 1.8.3 57
## Page 58

Data type MC_CAMACTIVATION_ATMASTERAXISPOS_NEG The cam plate coupling is performed at a defined ATIVEDIRECTION absolute position of the master axis, when the master passes the position in negative direction. (This mode is a special case of MC_CAMACTIVATION_ATMASTERAXISPOS, which ensures safe activation in the immediate proximity around the current position, even at very low speeds with short-term changes of direction (noise)) Switching of cam plates The function block MC_Cam In [} 15] can be used to switch between cam plates in coupled state. Activation Mode can be used to specify from which position the changeover takes place. MC_CAMACTIVATION_INSTANTANEOUS The cam plate is switched immediately, and the slave moves according to the new cam plate data. MC_CAMACTIVATION_ATMASTERCAMPOS Cam plate switching takes place at a defined cam plate position (master position within the cam plate). The position refers to the non-scaled cam plate. If the position in the application refers to the scaled cam plate, it can be divided by the Master Scaling before the function block is called. MC_CAMACTIVATION_ATMASTERAXISPOS Cam plate switching takes place at a defined absolute master axis position. MC_CAMACTIVATION_NEXTCYCLE For cyclic cam plates cam plate switching takes place at the next cycle transition. For linear cam plates the switchover takes place at the edges of a defined region. MC_CAMACTIVATION_DELETEQUEUEDDATA A suspended cam plate switching process that has not been activated is discarded. MC_CAMACTIVATION_ATMASTERAXISPOS_POS The cam plate switching is performed at a defined ITVEDIRECTION absolute position of the master axis, when the master passes the position in positive direction. (This mode is a special case of MC_CAMACTIVATION_ATMASTERAXISPOS, which ensures safe activation in the immediate proximity around the current position, even at very low speeds with short-term changes of direction (noise)) MC_CAMACTIVATION_ATMASTERAXISPOS_NEG The cam plate switching is performed at a defined ATIVEDIRECTION absolute position of the master axis, when the master passes the position in negative direction. (This mode is a special case of MC_CAMACTIVATION_ATMASTERAXISPOS, which ensures safe activation in the immediate proximity around the current position, even at very low speeds with short-term changes of direction (noise)) 58 Version: 1.8.3 TF5050
## Page 59

Data type 8.4 MC_Cam Scaling Mode TYPE MC_Cam Scaling Mode : ( (* user defines scaling parameters -scaling and -offset *) MC_CAMSCALING_USERDEFINED, (* offset is calculated automatically for best result *) MC_CAMSCALING_AUTOOFFSET, (* no modification accepted *) MC_CAMSCALING_OFF ); END_TYPE Type and scope of the scaling of a cam plate coupling via function block MC_Cam Scaling [} 21]. MC_CAMSCALING_USERDEFINED : The scaling and offset are retained unchanged. The user has to calculate the scaling and offset such that a jump in the position is avoided. MC_CAMSCALING_AUTOOFFSET : The scaling takes effect and the system adjusts the offset such that a jump in the position is avoided. Scaling should nevertheless occur during a phase with slave velocity 0, since otherwise a jump in velocity cannot be avoided. MC_CAMSCALING_OFF: The scaling and offset are ignored. This mode is used when only slave scaling (i.e. without master scaling) is to be implemented. Autooffset Autooffset mode ensures automatic adaptation of a cam plate offset. Autooffset can be used independently for the master or slave axis of a cam plate and affects both switchover and scaling of cam plates. The function operates based on the rules described below. Master-Autooffset Master-Autooffset prevents discontinuity of the master position of the cam plate in the axis coordinate system during switching of cam plates with different master cycle or scaling of cam plates (master scaling). This function is required because the relative position of a cam plate in the axis coordinate system depends on the master cycle. If the master cycle is changed, e.g. through scaling, the position would change. As a rule, Master Autooffset assumes that a cam plate already exists as reference for the corresponding axis coupling. This option is therefore not available during initial coupling. Master-Autooffset determines the master offset of the cam plate such that the master position within the cam plate is maintained. For scaling or switchover to a cam plate with a different master cycle this means that the relative (percentage) position before and after the switchover is identical. Example: A cam plate has master cycle of 360° and is scaled by a factor of 2 to 720°. Scaling takes place at the 90° position within the cam plate, i.e. at 25 % of the start of a cycle. After the scaling the relative master position in the cam plate at 180° is therefore also 25 % of the start of a cycle. TF5050 Version: 1.8.3 59
## Page 60

Data type During a switchover at the edges of a cam plate (see MC_Cam Activation Mode [} 56] = MC_CAMACTIVATION_NEXTCYCLE), Master-Autooffset ensures a seamless sequence of cam plates, both for cyclic and linear cam plates. Master-Autooffset cannot be used for a cam plate with relative coupling or switching, since these functions are mutually exclusive. Further restrictions apply to initial coupling. These are shown in the following table. 60 Version: 1.8.3 TF5050
## Page 61

Data type Slave-Autooffset Slave-Autooffset calculates a slave offset such that discontinuities in the slave position are avoided during cam plate switching or scaling. The slave offset is adjusted to ensure that the slave position is identical before and after the action. If both Master Autooffset and Slave-Autooffset are used for cam plate switching or scaling, the master offset is calculated first, followed by the slave offset. Slave Autooffset can be used in conjunction with any MC_Start Mode [} 70]. It adjusts the cam plate such that there is no jump in the slave position. TF5050 Version: 1.8.3 61
## Page 62

Data type 8.5 MC_Cam Info Data TYPE MC_Cam Info Data : STRUCT Cam Table Id : MC_CAM_ID; Table Type : MC_Table Type; Periodic : BOOL; Interpolation Type : MC_Interpolation Type; Number Of Rows : UDINT; (* number of cam table entries, e. g. number of points *) Number Of Columns : UDINT; (* number of table columns, typically 1 or 2 *) Master Axis Id : UDINT; (* Axis Id of the master axis *) Slave Axis Id : UDINT; (* Axis Id of the slave axis *) Master Cam Start Pos : LREAL; (* Master pos. of the first cam table point (raw, unscaled cam table pos.) *) Slave Cam Start Pos : LREAL; (* Slave pos. of the first cam table point (raw, unscaled cam table pos.) *) Raw Master Period : LREAL; (* raw, unscaled difference between last and first cam point *) Raw Slave Stroke : LREAL; (* raw, unscaled difference between last and first cam point *) Master Axis Coupling Pos : LREAL; (* Master axis position when slave has been coupled *) Slave Axis Coupling Pos : LREAL; (* Slave axis position when slave has been coupled *) Master Absolute : BOOL; (* raw, unscaled distance from first to last master cam table position *) Slave Absolute : BOOL; (* raw, unscaled distance from first to last slave cam table position *) Master Offset : LREAL; (* total master offset *) Slave Offset : LREAL; (* total slave offset *) Master Scaling : LREAL; (* total master scaling factor *) Slave Scaling : LREAL; (* total slave scaling factor *) Sum Of Slave Strokes : LREAL; (* sum of the slave strokes up to Actual Master Axis Pos *) Sum Of Superposition Distance : LREAL; (* sum of additional moves through MC_Move Superimposed *) Actual Master Axis Pos : LREAL; (* absolute set position of the master axis *) Actual Slave Axis Pos : LREAL; (* absolute set position of the slave axis *) Actual Master Cam Pos : LREAL; (* raw, unscaled cam table position of the master *) Actual Slave Cam Pos : LREAL; (* raw, unscaled cam table position of the slave *) (* mode for the scaling of cam tables *) Scaling Pending : BOOL; (* a change is currently pending *) Scaling Activation Mode : MC_Cam Activation Mode; Scaling Activation Pos : LREAL; Scaling Master Scaling Mode : MC_Cam Scaling Mode; Scaling Slave Scaling Mode : MC_Cam Scaling Mode; (* mode for online changes of cam table data *) Cam Data Queued : BOOL; (* a change is currently pending *) Online Change Activation Mode : MC_Cam Activation Mode; Online Change Activation Pos : LREAL; Online Change Master Scaling Mode: MC_Cam Scaling Mode; Online Change Slave Scaling Mode : MC_Cam Scaling Mode; (* mode for exchanging cam tables with MC_Cam In *) Cam Table Queued : BOOL; (* a change is currently pending *) Cam Exchange Cam Table ID : MC_CAM_ID; Cam Exchange Activation Mode : MC_Cam Activation Mode; Cam Exchange Activation Pos : LREAL; Cam Exchange Master Scaling Mode : MC_Cam Scaling Mode; Cam Exchange Slave Scaling Mode : MC_Cam Scaling Mode; END_STRUCT END_TYPE The MC_Cam Info Data data structure contains data on the current state of a cam plate coupling. The data are determined with the MC_Cam Info [} 47] function block. The structure contains absolute axis positions which refer to the master or slave axis coordinate system. It also contains cam plate positions which refer to the cam plate coordinate system (e.g. Actual Master Cam Pos and Actual Slave Cam Pos). All cam positions refer to the non-scaled cam plate coordinate system and can be converted to the scaled coordinate system, if required. A master cam position can be multiplied with the Master Scaling factor and a slave cam position can be multiplied with the Slave Scaling factor. The Activation Pos activation positions refer to the master axis coordinate system or the cam plate coordinate system, depending on the Activation Mode. In the latter case, an unscaled cam plate position is specified. 62 Version: 1.8.3 TF5050
## Page 63

Data type 8.6 MC_Interpolation Type Interpolation mode for position tables (cam plates). Position tables consist of a list of master and slave positions between which interpolation can take place in different ways. The interpolation type is not used for extended cam plates (motion functions). TYPE MC_Interpolation Type : ( (* linear 2 point interpolation *) MC_INTERPOLATIONTYPE_LINEAR := 0, (* no longer supported - 4 point interpolation (for equidistant tables only) *) MC_INTERPOLATIONTYPE_4POINT := 1, (* spline interpolation (tangential or cyclic depending on table) *) MC_INTERPOLATIONTYPE_SPLINE := 2, (* moving cubic spline interpolation with n sampling points ('local spline') *) MC_INTERPOLATIONTYPE_SLIDINGSPLINE := 3 ); END_TYPE TF5050 Version: 1.8.3 63
## Page 64

Data type 8.7 MC_Motion Function Point The data structure MC_Motion Function Point describes an interpolation point of a motion function. A motion function is a one-dimensional list (array) of type MC_Motion Function Point. TYPE MC_Motion Function Point : STRUCT Point Index : MC_Motion Function Point_ID; Function Type : MC_Motion Function Type; Point Type : MC_Motion Point Type; Rel Index Next Point : MC_Motion Function Point_ID; Master Pos : LREAL; (* X *) Slave Pos : LREAL; (* Y *) Slave Velo : LREAL; (* Y' *) Slave Acc : LREAL; (* Y'' *) Slave Jerk : LREAL; (* Y''' *) END_STRUCT END_TYPE Name Type Description Point Index MC_Motion Function Point Absolute index of this interpolation point within the motion _ID function. The point index of all interpolation points must increase strictly monotonously and must have no gaps and be greater than 0. Function Type MC_Motion Function Type Type MC_Motion Function Type [} 66] of the mathematical function between this and the subsequent interpolation point. Point Type MC_Motion Point Type Type MC_Motion Point Type [} 67] of this interpolation point Rel Index Next Point MC_Motion Function Point Relative reference to the subsequent interpolation point _ID (usually 1). This reference must also be set accordingly for subsequent "MOTIONPOINTTYPE_IGNORE". Master Pos LREAL Position of the master axis at this interpolation point Slave Pos LREAL Position of the slave axis at this interpolation point Slave Velo LREAL Velocity of the slave axis at this interpolation point Slave Acc LREAL Acceleration of the slave axis at this interpolation point Slave Jerk LREAL Jerk of the slave axis at this interpolation point 64 Version: 1.8.3 TF5050
## Page 65

Data type 8.8 MC_Motion Function Point_ID TYPE MC_Motion Function Point_ID : UDINT; END_TYPE Type definition for the point IDs for a motion function. TF5050 Version: 1.8.3 65
## Page 66

Data type 8.9 MC_Motion Function Type TYPE MC_Motion Function Type : ( MOTIONFUNCTYPE_NOTDEF, MOTIONFUNCTYPE_POLYNOM1 := 1, (* 1: polynom with order 1 (Synchron)*) MOTIONFUNCTYPE_POLYNOM3 := 3, (* 3: polynom with order 3 (rest <-> rest) *) MOTIONFUNCTYPE_POLYNOM5 := 5, (* 5: polynom with order 5 (rest <-> rest) *) MOTIONFUNCTYPE_POLYNOM7 := 7, (* 7: polynom with order 7 (rest <-> rest) *) MOTIONFUNCTYPE_POLYNOM8 := 8, (* 8: polynom with order 8 (rest <-> rest) *) MOTIONFUNCTYPE_POLYNOM9 := 9, (* 9: polynom with order 9 (rest <-> rest) *) MOTIONFUNCTYPE_SINUSLINIE := 10, MOTIONFUNCTYPE_MODSINUSLINIE := 11, MOTIONFUNCTYPE_BESTEHORN := 12, MOTIONFUNCTYPE_BESCHLTRAPEZ := 13, (* 13: Beschleunigungstrapez *) MOTIONFUNCTYPE_POLYNOM5_MM := 15, (* 15: polynom with order 5 (motion <-> motion) *) MOTIONFUNCTYPE_HARMONIC_KOMBI_RT := 17, MOTIONFUNCTYPE_HARMONIC_KOMBI_TR := 18, MOTIONFUNCTYPE_HARMONIC_KOMBI_VT := 19, MOTIONFUNCTYPE_HARMONIC_KOMBI_TV := 20, MOTIONFUNCTYPE_BESCHLTRAPEZ_RT := 21, (* 21: Beschleunigungstrapez (rest <-> turn) *) MOTIONFUNCTYPE_BESCHLTRAPEZ_TR := 22, (* 22: Beschleunigungstrapez (turn <-> rest) *) MOTIONFUNCTYPE_MODSINUSLINIE_VV := 23, MOTIONFUNCTYPE_POLYNOM7_MM := 24, (* 24: polynom with order 7 (motion <-> motion) *) MOTIONFUNCTYPE_BESCHLTRAPEZ_RV := 38, (* 38: Beschleunigungstrapez (rest <-> velocity) *) MOTIONFUNCTYPE_BESCHLTRAPEZ_VR := 39, (* 39: Beschleunigungstrapez (velocity <-> rest) *) MOTIONFUNCTYPE_POLYNOM3_VV := 40, (* 40: polynom with order 3 (Velo <-> velo) *) MOTIONFUNCTYPE_POLYNOM11 := 41, (* 41: polynom with order 11 (rest <-> rest) *) MOTIONFUNCTYPE_PEISEKAH11 := 45, (* 45: Peisekah polynom with order 11 (rest <-> rest) *) MOTIONFUNCTYPE_SPLINE := 100, (* 100: inner spline interpolation point *) MOTIONFUNCTYPE_SPLINE_NATURAL := 101, (* 101: first or last spline point *) MOTIONFUNCTYPE_SPLINE_TANGENTIAL := 102, (* 102: first or last spline point *) MOTIONFUNCTYPE_SPLINE_PERIODIC := 103, (* 103: first or last spline point *) MOTIONFUNCTYPE_SPLNE_LINEAR := 120 (* 120: first or last spline point *) ); END_TYPE Type definition for motion functions. Note the type The motion function type Automatic used in the Twin CAT Cam Design Editor corresponds to MOTIONFUNCTYPE_POLYNOM5_MM, the motion function type Synchronous corresponds to MOTIONFUNCTYPE_POLYNOM1 66 Version: 1.8.3 TF5050
## Page 67

Data type 8.10 MC_Motion Point Type TYPE MC_Motion Point Type : ( MOTIONPOINTTYPE_IGNORE, (* Ignore point *) MOTIONPOINTTYPE_REST := 16#0001, (* Restpoint – Rastpunkt *) MOTIONPOINTTYPE_VELOCITY := 16#0002, (* Velocity Point - Geschwindigkeitspunkt *) MOTIONPOINTTYPE_TURN := 16#0004, (* Turn Point - Umkehrpunkt *) MOTIONPOINTTYPE_MOTION := 16#0008, (* Motion Point - Bewegungspunkt *) MOTIONPOINTTYPE_ADD := 16#0F00, (* Addieren von Segmenten *) MOTIONPOINTTYPE_ACTIVATION := 16#2000 (* 1: activation point *) ); END_TYPE Type definition for the table point. DANGER Danger to life or risk of serious injury or damage to property due to unintentional movements of the axis Using MOTIONPOINTTYPE_IGNORE for the first and last Motion Function Point of a table definition is not allowed and must not be used. TF5050 Version: 1.8.3 67
## Page 68

Data type 8.11 MC_Table Charac Values TYPE MC_Table Charac Values : STRUCT (* Master Velocity*) f Master Velo Nom : LREAL; (* 1. master nominal velocity (normed: => 1.0) *) (* characteristic slave data *) (*===========================*) (* Start of cam table *) f Master Pos Start : LREAL; (* 2. master start position *) f Slave Pos Start : LREAL; (* 3. slave start position *) f Slave Velo Start : LREAL; (* 4. slave start velocity *) f Slave Acc Start : LREAL; (* 5. slave start acceleration *) f Slave Jerk Start : LREAL; (* 6. slave start jerk *) (* End of cam table*) f Master Pos End : LREAL; (* 7. master end position *) f Slave Pos End : LREAL; (* 8. slave end position *) f Slave Velo End : LREAL; (* 9. slave end velocity *) f Slave Acc End : LREAL; (* 10. slave end acceleration *) f Slave Jerk End : LREAL; (* 11. slave end jerk *) (* minimum slave position *) f MPos At SPos Min : LREAL; (* 12. master position AT slave minimum position *) f Slave Pos Min : LREAL; (* 13. slave minimum position *) (* minimum Slave velocity *) f MPos At SVelo Min : LREAL; (* 14. master position AT slave minimum velocity *) f Slave Velo Min : LREAL; (* 15. slave minimum velocity *) (* minimum slave acceleration *) f MPos At SAcc Min : LREAL; (* 16. master position AT slave minimum acceleration *) f Slave Acc Min : LREAL; (* 17. slave minimum acceleration *) f SVelo At SAcc Min : LREAL; (* 18. slave velocity AT slave minimum acceleration *) (* minimum slave jerk and dynamic momentum *) f Slave Jerk Min : LREAL; (* 19. slave minimum jerk *) f Slave Dyn Mom Min : LREAL; (* 20. slave minimum dynamic momentum (NOT SUPPORTED YET !) *) (* maximum slave position *) f MPos At SPos Max : LREAL; (* 21. master position AT slave maximum position *) f Slave Pos Max : LREAL; (* 22. slave maximum position *) (* maximum Slave velocity *) f MPos At SVelo Max : LREAL; (* 23. master position AT slave maximum velocity *) f Slave Velo Max : LREAL; (* 24. slave maximum velocity *) (* maximum slave acceleration *) f MPos At SAcc Max : LREAL; (* 25. master position AT slave maximum acceleration *) f Slave Acc Max : LREAL; (* 26. slave maximum acceleration *) f SVelo At SAcc Max : LREAL; (* 27. slave velocity AT slave maximum acceleration *) (* maximum Slave slave jerk and dynamic momentum *) f Slave Jerk Max : LREAL; (* 28. slave maximum jerk *) f Slave Dyn Mom Max : LREAL; (* 29. slave maximum dynamic momentum (NOT SUPPORTED YET !) *) (* mean and effective values *) f Slave Velo Mean : LREAL; (* 30. slave mean absolute velocity (NOT SUPPORTED YET !) *) f Slave Acc Eff : LREAL; (* 31. slave effective acceleration (NOT SUPPORTED YET !) *) (* reserved space for future extension *) reserved : ARRAY[32..47] OF LREAL; (* organization structure of the cam table *) Cam Table ID : UDINT; Number Of Rows : UDINT; (* number of cam table entries, e.g. number of points *) Number Of Columns : UDINT; (* number of table columns, typically 1 or 2 *) Table Type : UINT; (* MC_Table Type *) Periodic : BOOL; reserved2 : ARRAY[1..121] OF BYTE; END_STRUCT END_TYPE Type definition for the characteristic parameters of a motion function. 68 Version: 1.8.3 TF5050
## Page 69

Data type 8.12 MC_Table Error Codes TYPE MC_Table Error Codes : ( (* Cam Table Error Codes *) MC_ERROR_POINTER_INVALID := 16#4B30, (* invalid pointer (address) value *) MC_ERROR_ARRAYSIZE_INVALID := 16#4B31, (* invalid size of data structure *) MC_ERROR_CAMTABLEID_INVALID := 16#4B32, (* invalid cam table ID (not [1..255]) *) MC_ERROR_POINTID_INVALID := 16#4B33, (* invalid point ID *) MC_ERROR_NUMPOINTS_INVALID := 16#4B34, MC_ERROR_MCTABLETYPE_INVALID := 16#4B35, MC_ERROR_NUMROWS_INVALID := 16#4B36, MC_ERROR_NUMCOLUMNS_INVALID := 16#4B37, MC_ERROR_INCREMENT_INVALID := 16#4B38 ); END_TYPE 8.13 MC_Table Type TYPE MC_Table Type : ( (* n*m tabular with equidistant ascending master values *) MC_TABLETYPE_EQUIDISTANT := 10, (* n*m tabular with strictly monotone ascending master values (not imperative equidistant) *) MC_TABLETYPE_NONEQUIDISTANT := 11, (* motion function calculated in runtime *) MC_TABLETYPE_MOTIONFUNCTION := 22 ); END_TYPE 8.14 MC_Value Select Type TYPE MC_Value Select Type : ( (* a bitmask can be created by adding the following values *) MC_VALUETYPE_POSITION := 1, MC_VALUETYPE_VELOCITY := 2, MC_VALUETYPE_ACCELERATION := 4, MC_VALUETYPE_JERK := 8 ); END_TYPE Type definition for access to value tables with the function block MC_Read Motion Function Values [} 43]. TF5050 Version: 1.8.3 69
## Page 70

Data type 8.15 MC_Start Mode TYPE MC_Start Mode : ( MC_STARTMODE_ABSOLUTE := 1, (* cam table is absolute for master and slave *) MC_STARTMODE_RELATIVE := 2, (* cam table is relative for master and slave *) MC_STARTMODE_MASTERABS_SLAVEREL := 3, (* cam table is absolute for master and relative for slave *) MC_STARTMODE_MASTERREL_SLAVEABS := 4 (* cam table is relative for master and absolute for slave *) ); END_TYPE Start Mode is used for coupling with cam plates through MC_Cam In [} 15] and defines whether a cam plate is interpreted absolute (based on the origin of the axis coordinate system) or relative to the coupling position. The mode can be specified as absolute or relative separately for both coordinate axes. With Start Mode Absolut the cam plate coordinate system is congruent with the axis coordinate system and can be moved through an offset, if required (master or slave offset). With Start Mode Relativ the origin of the cam plate coordinate system is at the axis position of the respective axis (master or slave) at the time of coupling or cam plate switching. The cam plate can additionally be moved through an offset. Notice: The modes MC_STARTMODE_RELATIVE and MC_STARTMODE_MASTERREL_SLAVEABS cannot be used in conjunction with automatic master offset calculation (MC_Cam Scaling Mode [} 59]), since this would cause a conflict. 70 Version: 1.8.3 TF5050
## Page 71

Data type 8.16 ST_Cam In Options Data of type ST_Cam In Options can optionally be transferred to the function block MC_Cam In [} 15]. TYPE ST_Cam In Options : STRUCT (* Activation Mode defines when and where the cam table will be activated *) (* (only valid if slave is already coupled and cam table will be exchanged) *) Activation Mode : MC_Cam Activation Mode := MC_CAMACTIVATION_INSTANTANEOUS; Activation Position : LREAL; (* Scaling Modes enable, disable or define the way of scaling the cam table *) Master Scaling Mode : MC_Cam Scaling Mode := MC_CAMSCALING_USERDEFINED; Slave Scaling Mode : MC_Cam Scaling Mode := MC_CAMSCALING_USERDEFINED; (* Interpolation Type is required for position tables only. *) (* Motion Functions don't need an Interpolation Type *) Interpolation Type : MC_Interpolation Type := MC_Interpolation Type_Linear; END_STRUCT END_TYPE TF5050 Version: 1.8.3 71
## Page 72

Data type 8.17 Cam Master Data Data of type Cam Master Data are optionally transferred by function block MC_Read Cam Table Master Position [} 52]. TYPE Cam Master Data : STRUCT Valid : BOOL; (* position information is valid *) Master Axis Position : LREAL; (* absolute master axis position *) Master Cam Position : LREAL; (* local master cam position *) Slave Offset : LREAL; (* slave cam offset corresponding to the master position *) END_STRUCT END_TYPE 8.18 MC_Cam Operation Mode The Cam Operation Mode is used for managing couplings with superimposed cam plates with the function block MC_Cam In_V2 [} 23] (multi-cam). Cam plates can be added, switched or removed. TYPE MC_Cam Operation Mode : ( CAMOPERATIONMODE_DEFAULT, (* same as additive *) CAMOPERATIONMODE_ADDITIVE, (* additive cam in a multi cam scenario *) CAMOPERATIONMODE_EXCHANGE, (* exchange existing cam in a multi cam scenario *) CAMOPERATIONMODE_REMOVE (* remove cam from a multi cam scenario *) ); END_TYPE 72 Version: 1.8.3 TF5050
## Page 73

Data type 8.19 ST_Cam Scaling Data The structure ST_Cam Scaling Data contains information for scaling a cam plate and is used with the function block MC_Cam In_V2 [} 23]. TYPE ST_Cam Scaling Data : STRUCT (* scaling of the X axis of the cam (master scaling) *) Master Scaling Mode : MC_Cam Scaling Mode; Master Relative : BOOL; Master Offset : LREAL; Master Scaling : LREAL := 1.0; (* scaling of the Y axis of the cam (slave scaling) *) Slave Scaling Mode : MC_Cam Scaling Mode; Slave Relative : BOOL; Slave Offset : LREAL; Slave Scaling : LREAL := 1.0; END_STRUCT END_TYPE Name Type Description Master Scaling Mode MC_Cam Scaling Mode Scaling mode [} 59] for the master position of the cam plate Master Relative BOOL If TRUE the cam plate operates relative to the current master position at the time of activation. Master Offset LREAL Master offset for orientation of the cam plate in the axis coordinate system. Master Offset takes effect in absolute mode from the master axis position 0 and in relative mode from the current position at the time of activation. Master Scaling LREAL Scaling of the master position of the cam plate. Default is 1.0 Slave Scaling Mode MC_Cam Scaling Mode Scaling mode [} 59] for the slave position of the cam plate Slave Relative BOOL If TRUE the cam plate operates relative to the current slave position at the time of activation. Slave Offset LREAL Slave offset for orientation of the cam plate in the axis coordinate system. Slave Offset takes effect in absolute mode from the slave axis position 0 and in relative mode from the current position at the time of activation. Slave Scaling LREAL Scaling of the slave position of the cam plate. Default is 1.0 TF5050 Version: 1.8.3 73
## Page 74

Data type 8.20 ST_Read Cam Table Slave Dynamics Options Optional data that can be transferred to the function block MC_Read Cam Table Slave Dynamics [} 45]. TYPE ST_Read Cam Table Slave Dynamics Options : STRUCT Synchronous Access : BOOL; END_STRUCT END_TYPE 8.21 ST_Set Online Change Mode Options Optional data that can be transferred to the function block MC_Set Cam Online Change Mode [} 41]. TYPE ST_Set Online Change Mode Options : STRUCT Synchronous Access : BOOL; END_STRUCT END_TYPE 8.22 ST_Write Motion Function Options Optional data that can be transferred to the function block MC_Write Motion Function [} 37] or MC_Write Motion Function Point [} 39]. TYPE ST_Write Motion Function Options : STRUCT Synchronous Access : BOOL; END_STRUCT END_TYPE 74 Version: 1.8.3 TF5050
## Page 75

Example programs 9 Example programs Electronic Cam Tables The example program couples a master and a slave axis via cam plates. During the coupled movement cam plates are switched, individual sampling points of a cam plate are modified, and the cam plate is scaled. The example program requires the Tc2_MC2_Camming library and operates fully in simulation mode. Progress can be monitored in the included Twin CAT Measurement project. Click here to save the example program: https://infosys.beckhoff.com/content/1033/TF5050_TC3_NC_Camming/Resources/2570265355.zip Rotary Knife and Registration The sample uses a rotational knife to cut sheets of a defined length. For this purpose the circumference speed must be synchronized with the web while cutting a sheet. The rotation knife must the accelerator or deceleration since the circumference of the knife is different from the sheet length. Registration marks are used to synchronize with the product. The knife is continuously adjusted to compensate small differences caused by temperature or stretching. An electronic cam table is used to synchronize the rotational knife with the material. The cam table is a normalized cam table defined with a length of 360°. The tool moves over a full turn while the cam table is executed and the cut position is defined as 0°. The circumference speed is synchronous from 270° to 30°. The range from 30° to 270° is used to adjust the operation to the actual distance of registration marks. https://infosys.beckhoff.com/content/1033/TF5050_TC3_NC_Camming/Resources/2570267019.zip TF5050 Version: 1.8.3 75
## Page 76

Trademark statements Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H.
## Page 77

More Information: www.beckhoff.com/tf5050 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
