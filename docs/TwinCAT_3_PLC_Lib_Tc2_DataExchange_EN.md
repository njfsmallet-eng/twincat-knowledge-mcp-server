---
title: "TwinCAT_3_PLC_Lib_Tc2_DataExchange_EN"
product: "TwinCAT"
category: "PLC"
tags: ["CAT", "DATA", "EXCHANGE", "LIB", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.2.1"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc2_DataExchange_EN.pdf"
release_date: "2024-09-11"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc2_Data Exchange 2024-09-11 | Version: 1.2.1
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Introduction............................................................................................................................................... 8 3 Event driven data exchange..................................................................................................................... 9 3.1 FB_Read Ads Sym By Name................................................................................................................ 9 3.2 FB_Write Ads Sym By Name.............................................................................................................. 10 3.3 FB_Write Bool On Delta..................................................................................................................... 11 3.4 FB_Write Byte On Delta..................................................................................................................... 13 3.5 FB_Write Word On Delta................................................................................................................... 14 3.6 FB_Write DWord On Delta................................................................................................................. 16 3.7 FB_Write Real On Delta..................................................................................................................... 17 3.8 FB_Write LReal On Delta................................................................................................................... 19 4 Watchdog function blocks..................................................................................................................... 21 4.1 FB_Check Watchdog....................................................................................................................... 21 4.2 FB_Write Watchdog......................................................................................................................... 22 5 Data types................................................................................................................................................ 24 5.1 E_Ads Com Mode............................................................................................................................. 24 6 Global constants..................................................................................................................................... 25 6.1 Library version................................................................................................................................. 25 TE1000 Version: 1.2.1 3
## Page 4

Table of contents 4 Version: 1.2.1 TE1000
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. For installation and commissioning of the components, it is absolutely necessary to observe the documentation and the following notes and explanations. The qualified personnel is obliged to always use the currently valid documentation. The responsible staff must ensure that the application or use of the products described satisfies all requirements for safety, including all the relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. No claims to modify products that have already been supplied may be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of designations or trademarks used in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Patents The Ether CAT Technology is covered, including but not limited to the following patent applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 and similar applications and registrations in several other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document as well as the use and communication of its contents without express authorization are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. TE1000 Version: 1.2.1 5
## Page 6

Foreword Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.2.1 TE1000
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.2.1 7
## Page 8

Introduction 2 Introduction The present function blocks simplify event-driven data exchange between the Twin CAT PLC runtime system and/or other ADS devices (Twin CAT NC, Bus Terminal Controller, ...). The FB_Write XXXOn Delta() function block implements a write procedure when the input signal rises above or falls below a specified limit value. The frequency with which the input signal is examined can be set. Event-driven data writing minimizes the loading on the fieldbus. If an error occurs during transmission, the process is repeated until the connection is established once more. All data types supported in the Twin CAT PLC are permitted as source and destination variables. Symbol names are also supported. Watchdog function blocks are available to monitor individual communication partners. The device that is to be monitored cyclically transmits an incrementing counter. A check is made at the receiver to see that the counter state changes within a specific time. Write/Read Blocks Name Description FB_Read Ads Sym By Name [} 9] Reads a variable of any desired data type by variable name FB_Write Ads Sym By Name [} 10] Writes a variable of any desired data type by variable name FB_Write Bool On Delta [} 11] Writes a variable of type BOOLEAN in response to an event. FB_Write Byte On Delta [} 13] Writes a variable of type BYTE in response to an event. FB_Write Word On Delta [} 14] Writes a variable of type WORD in response to an event. FB_Write DWord On Delta [} 16] Writes a variable of type DWORD in response to an event. FB_Write Real On Delta [} 17] Writes a variable of type REAL in response to an event. FB_Write LReal On Delta [} 19] Writes a variable of type LREAL in response to an event. Monitoring Blocks Name Description FB_Write Watchdog [} 22] Writes a watchdog signal (an incrementing counter) cyclically FB_Check Watchdog [} 21] Monitors the received watchdog signal 8 Version: 1.2.1 TE1000
## Page 9

Event driven data exchange 3 Event driven data exchange Write/Read Blocks Name Description FB_Read Ads Sym By Name [} 9] Reads a variable of any desired data type by variable name FB_Write Ads Sym By Name [} 10] Writes a variable of any desired data type by variable name FB_Write Bool On Delta [} 11] Writes a variable of type BOOLEAN in response to an event. FB_Write Byte On Delta [} 13] Writes a variable of type BYTE in response to an event. FB_Write Word On Delta [} 14] Writes a variable of type WORD in response to an event. FB_Write DWord On Delta [} 16] Writes a variable of type DWORD in response to an event. FB_Write Real On Delta [} 17] Writes a variable of type REAL in response to an event. FB_Write LReal On Delta [} 19] Writes a variable of type LREAL in response to an event. 3.1 FB_Read Ads Sym By Name The function block FB_Read Ads Sym By Name enables reading of any value from another controller using the symbol name. On a positive edge at the b Read input the function block reads the value of the variable s Var Name from the selected ADS device (e.g. PLC). The ADS device is indicated by the AMS-Net Id (s Net Id) and the AMS Port number (n Port). The value is written into the variable to which n Dest Addr points. The internal mode of operation of the function block can be changed with the aid of the e Com Mode input: • e Com Mode := e Ads Com Mode Secure Com: After each read process, the handle of the PLC variable is released again. This mode should be used when values are exchanged very slowly. • e Com Mode := e Ads Com Mode Fast Com: As long as the inputs s Var Name, s Net ID and n Port do not change, the handle of the PLC variable will not be released after each read process. This mode should be used when values are exchanged very frequently. Inputs VAR_INPUT b Read : BOOL; s Net Id : T_Ams Net Id; n Port : T_Ams Port := 851; s Var Name : STRING(255); n Dest Addr : PVOID; n Len : UDINT; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; e Com Mode : E_Ads Com Mode := e Ads Com Mode Secure Com; END_VAR Name Type Description b Read BOOL The function block reads the content of the variables s Var Name of the selected ADS device and writes it to the variable to which the pointer n Dest Addr points. TE1000 Version: 1.2.1 9
## Page 10

Event driven data exchange s Net Id T_Ams Net ID AMS-Net Id of the ADS device from which the value is to be read. n Port T_Ams Net ID AMS Port number of the ADS device from which the value is to be read. s Var Name STRING(255) Symbol name of the variable to be read on the selected ADS device (max. 255 characters). n Dest Addr PVOID Address of the variable into which the read value is written. n Len UDINT Length of the variable to be read in bytes. t Timeout TIME Time until processing is aborted. e Com Mode E_Ads Com Mode [} 24] Enum used to specify whether the handle of the PLC variable is released again after each read process. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Error Id : UDINT; END_VAR Name Type Description b Busy BOOL The transmission is active. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. Requirements Development environment required TC3 PLC library Twin CAT v3.1.0 Tc2_Data Exchange 3.2 FB_Write Ads Sym By Name The function block FB_Write Ads Sym By Name enables writing of any value to another controller using the symbol name. On a positive edge at the input b Write the function block writes the value to which the pointer n Src Addr points into the variable s Var Name of the selected ADS device (e.g. PLC). The ADS device is indicated by the AMS-Net Id (s Net Id) and the AMS Port number (n Port). The internal mode of operation of the function block can be changed with the aid of the e Com Mode input: • e Com Mode := e Ads Com Mode Secure Com: After each write process, the handle of the PLC variable is released again. This mode should be used when values are exchanged very slowly. • e Com Mode := e Ads Com Mode Fast Com: As long as the inputs s Var Name, s Net ID and n Port do not change, the handle of the PLC variable is not released after each write operation. This mode should be used when values are exchanged very frequently. 10 Version: 1.2.1 TE1000
## Page 11

Event driven data exchange Inputs VAR_INPUT b Read : BOOL; s Net Id : T_Ams Net Id; n Port : T_Ams Port := 851; s Var Name : STRING(255); n Src Addr : PVOID; n Len : UDINT; t Timeout : TIME := DEFAULT_ADS_TIMEOUT; e Com Mode : E_Ads Com Mode := e Ads Com Mode Secure Com; END_VAR Name Type Description b Write BOOL This function block writes the contents of the variable to which pointer n Src Addr points into the variable s Var Name of the selected ADS device. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. s Var Name STRING(255) Symbol name of the variable to be written on the selected ADS device (max. 255 characters). n Src Addr PVOID Address of the variable in which the value to written is located. n Len UDINT Length in bytes of the variable to be written. t Timeout TIME Time until processing is aborted. e Com Mode E_Ads Com Mode [} 24] Enum used to specify whether the handle of the PLC variable is released again after each write process. Outputs VAR_OUTPUT b Busy : BOOL; b Error : BOOL; n Error Id : UDINT; END_VAR Name Type Description b Busy BOOL The transmission is active. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. Requirements Development environment required TC3 PLC library Twin CAT v3.1.0 Tc2_Data Exchange 3.3 FB_Write Bool On Delta TE1000 Version: 1.2.1 11
## Page 12

Event driven data exchange The function block enables event-driven writing of a variable of type BOOLEAN. The function block FB_Write Bool On Delta checks cyclically whether the value at the input b Signal has changed. The cycle time for checking is determined by the parameter t Cycle Time. If 0 s is given for t Cycle Time, the input signal is examined during every PLC cycle. If a change is detected, the value of the signal is sent to the specified ADS device. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/index offset or by the symbol name. Usually this is the input image or the flags area. If the input b Enable is set to FALSE, no further signal transmission is carried out. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; b Signal : BOOL; t Cycle Time : TIME := t#0s; b Send Now : BOOL; END_VAR Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. n Idx Grp UDINT Index group within the ADS device into which the value is to be transmitted. n Idx Offs UDINT Index offset within the ADS device into which the value is to be transmitted. s Var Name STRING Symbol name within the ADS device into which the value is to be transmitted. b Signal BOOL Variable whose value is to be transmitted. t Cycle Time TIME Cycle time in which the system checks if the input signal has changed. b Send Now BOOL The value is transmitted immediately by a positive edge. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; b Last Signal : BOOL; b Error : BOOL := FALSE; n Error Id : UDINT := 0; n Error Cnt : UDINT := 0; END_VAR Name Type Description b Busy BOOL The transmission is active. b Last Signal BOOL Most recently transmitted value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. n Error Cnt UDINT Number of failed transmission attempts. 12 Version: 1.2.1 TE1000
## Page 13

Event driven data exchange Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange 3.4 FB_Write Byte On Delta The function block enables event-driven writing of a variable of type BYTE. The function block FB_Write Byte On Delta checks cyclically whether the value at the input n Signal has changed. The cycle time for checking is determined by the parameter t Cycle Time. If 0 s is given for t Cycle Time, the input signal is examined during every PLC cycle. If the comparison determines that the current value is greater by the value n Upper Limit or lower by the value n Lower Limit, the value of the signal is sent to the specified ADS device. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/ index offset or by the symbol name. Usually this is the input image or the flags area. If the input b Enable is set to FALSE, no further signal transmission is carried out. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; n Signal : BYTE; n Lower Limit : BYTE; n Upper Limit : BYTE; t Cycle Time : TIME := t#0s; b Send Now : BOOL; END_VAR TE1000 Version: 1.2.1 13
## Page 14

Event driven data exchange Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. n Idx Grp UDINT Index group within the ADS device into which the value is to be transmitted. n Idx Offs UDINT Index offset within the ADS device into which the value is to be transmitted. s Var Name STRING Symbol name within the ADS device into which the value is to be transmitted. n Signal BYTE Variable whose value is to be transmitted. n Lower Limit BYTE Lower limit value. n Upper Limit BYTE Upper limit value. t Cycle Time TIME Cycle time in which the input signal is checked to see whether it has exceeded the limit values. b Send Now BOOL The value is transmitted immediately by a positive edge. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; n Last Signal : BYTE; b Error : BOOL := FALSE; n Error Id : UDINT := 0; n Error Cnt : UDINT := 0; END_VAR Name Type Description b Busy BOOL The transmission is active. n Last Signal BYTE Most recently transmitted value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. n Error Cnt UDINT Number of failed transmission attempts. Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange 3.5 FB_Write Word On Delta The function block enables event-driven writing of a variable of type WORD. 14 Version: 1.2.1 TE1000
## Page 15

Event driven data exchange The function block FB_Write Word On Delta checks cyclically whether the value at the input n Signal has changed. The cycle time for checking is determined by the parameter t Cycle Time. If 0 s is given for t Cycle Time, the input signal is examined during every PLC cycle. If the comparison determines that the current value is greater by the value n Upper Limit or lower by the value n Lower Limit, the value of the signal is sent to the specified ADS device. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/ index offset or by the symbol name. Usually this is the input image or the flags area. If the input b Enable is set to FALSE, no further signal transmission is carried out. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; n Signal : WORD; n Lower Limit : WORD; n Upper Limit : WORD; t Cycle Time : TIME := t#0s; b Send Now : BOOL; END_VAR Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. n Idx Grp UDINT Index group within the ADS device into which the value is to be transmitted. n Idx Offs UDINT Index offset within the ADS device into which the value is to be transmitted. s Var Name STRING Symbol name within the ADS device into which the value is to be transmitted. n Signal WORD Variable whose value is to be transmitted. n Lower Limit WORD Lower limit value. n Upper Limit WORD Upper limit value. t Cycle Time TIME Cycle time in which the input signal is checked to see whether it has exceeded the limit values. b Send Now BOOL The value is transmitted immediately by a positive edge. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; n Last Signal : WORD; b Error : BOOL := FALSE; n Error Id : UDINT := 0; n Error Cnt : UDINT := 0; END_VAR Name Type Description b Busy BOOL The transmission is active. n Last Signal WORD Most recently transmitted value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. n Error Cnt UDINT Number of failed transmission attempts. TE1000 Version: 1.2.1 15
## Page 16

Event driven data exchange Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange 3.6 FB_Write DWord On Delta The function block enables event-driven writing of a variable of type DWORD. The function block FB_Write DWord On Delta checks cyclically whether the value at the input n Signal has changed. The cycle time for checking is determined by the parameter t Cycle Time. If 0 s is given for t Cycle Time, the input signal is examined during every PLC cycle. If the comparison determines that the current value is greater by the value n Upper Limit or lower by the value n Lower Limit, the value of the signal is sent to the specified ADS device. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/ index offset or by the symbol name. Usually this is the input image or the flags area. If the input b Enable is set to FALSE, no further signal transmission is carried out. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; n Signal : BYTE; n Lower Limit : BYTE; n Upper Limit : BYTE; t Cycle Time : TIME := t#0s; b Send Now : BOOL; END_VAR 16 Version: 1.2.1 TE1000
## Page 17

Event driven data exchange Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. n Idx Grp UDINT Index group within the ADS device into which the value is to be transmitted. n Idx Offs UDINT Index offset within the ADS device into which the value is to be transmitted. s Var Name STRING Symbol name within the ADS device into which the value is to be transmitted. n Signal BYTE Variable whose value is to be transmitted. n Lower Limit BYTE Lower limit value. n Upper Limit BYTE Upper limit value. t Cycle Time TIME Cycle time in which the input signal is checked to see whether it has exceeded the limit values. b Send Now BOOL The value is transmitted immediately by a positive edge. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; n Last Signal : DWORD; b Error : BOOL := FALSE; n Error Id : UDINT := 0; n Error Cnt : UDINT := 0; END_VAR Name Type Description b Busy BOOL The transmission is active. n Last Signal DWORD Most recently transmitted value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. n Error Cnt UDINT Number of failed transmission attempts. Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange 3.7 FB_Write Real On Delta The function block enables event-driven writing of a variable of type REAL. TE1000 Version: 1.2.1 17
## Page 18

Event driven data exchange The function block FB_Write Real On Delta checks cyclically whether the value at the input f Signal has changed. The cycle time for checking is determined by the parameter t Cycle Time. If 0 s is given for t Cycle Time, the input signal is examined during every PLC cycle. If the comparison determines that the current value is greater by the value f Upper Limit or less by the value f Lower Limit, the value of the signal is sent to the specified ADS device. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/ index offset or by the symbol name. Usually this is the input image or the flags area. The internal representation of floating point numbers differs according to the hardware being used. While Intel uses the "little endian" format, Motorola uses the "big endian" format. The input variable b Swap Low High Word can be used to make the necessary adjustment in order to be able to exchange floating point numbers. This is necessary if floating point numbers are to be exchanged between the Twin CAT PLC on a PC and a BC9000, for example. If the input b Enable is set to FALSE, no further signal transmission is carried out. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; f Signal : REAL; f Lower Limit : REAL; f Upper Limit : REAL; t Cycle Time : TIME := t#0s; b Send Now : BOOL; b Swap Low High Word : BOOL := FALSE; END_VAR Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. n Idx Grp UDINT Index group within the ADS device into which the value is to be transmitted. n Idx Offs UDINT Index offset within the ADS device into which the value is to be transmitted. s Var Name STRING Symbol name within the ADS device into which the value is to be transmitted. f Signal REAL Variable whose value is to be transmitted. n Lower Limit REAL Lower limit value. n Upper Limit REAL Upper limit value. t Cycle Time TIME Cycle time in which the input signal is checked to see whether it has exceeded the limit values. b Send Now BOOL The value is transmitted immediately by a positive edge. b Swap Low High Wor BOOL The least significant WORD and the most significant d WORD are swapped. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; f Last Signal : REAL; b Error : BOOL := FALSE; n Error Id : UDINT := 0; n Error Cnt : UDINT := 0; END_VAR 18 Version: 1.2.1 TE1000
## Page 19

Event driven data exchange Name Type Description b Busy BOOL The transmission is active. f Last Signal REAL Most recently transmitted value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. n Error Cnt UDINT Number of failed transmission attempts. Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange 3.8 FB_Write LReal On Delta The function block enables event-driven writing of a variable of type LREAL. The function block FB_Write LReal On Delta checks cyclically whether the value at the input f Signal has changed. The cycle time for checking is determined by the parameter t Cycle Time. If 0 s is given for t Cycle Time, the input signal is examined during every PLC cycle. If the comparison determines that the current value is greater by the value f Upper Limit or less by the value f Lower Limit, the value of the signal is sent to the specified ADS device. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/ index offset or by the symbol name. Usually this is the input image or the flags area. If the input b Enable is set to FALSE, no further signal transmission is carried out. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; f Signal : LREAL; f Lower Limit : LREAL; f Upper Limit : LREAL; t Cycle Time : TIME := t#0s; b Send Now : BOOL; END_VAR TE1000 Version: 1.2.1 19
## Page 20

Event driven data exchange Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the value is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the value is to be transmitted. n Idx Grp UDINT Index group within the ADS device into which the value is to be transmitted. n Idx Offs UDINT Index offset within the ADS device into which the value is to be transmitted. s Var Name STRING Symbol name within the ADS device into which the value is to be transmitted. f Signal LREAL Variable whose value is to be transmitted. n Lower Limit LREAL Lower limit value. n Upper Limit LREAL Upper limit value. t Cycle Time TIME Cycle time in which the input signal is checked to see whether it has exceeded the limit values. b Send Now BOOL The value is transmitted immediately by a positive edge. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; f Last Signal : LREAL; b Error : BOOL := FALSE; n Error Id : UDINT := 0; n Error Cnt : UDINT := 0; END_VAR Name Type Description b Busy BOOL The transmission is active. f Last Signal LREAL Most recently transmitted value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. n Error Cnt UDINT Number of failed transmission attempts. Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange 20 Version: 1.2.1 TE1000
## Page 21

Watchdog function blocks 4 Watchdog function blocks Monitoring Blocks Name Description FB_Write Watchdog [} 22] Writes a watchdog signal (an incrementing counter) cyclically FB_Check Watchdog [} 21] Monitors the received watchdog signal 4.1 FB_Check Watchdog Monitoring of a watchdog signal, which is transmitted with the function block FB_Write Watchdog [} 22]. The device to be monitored regularly sends a changing counter value to the device that is to monitor the transmission. The function block FB_Check Watchdog is used there to monitor the counter value. If this does not change within a specific period, the output b Watchdog is set to TRUE. If a value of 0 s is specified for t Watchdog Time, the b Watchdog signal is set to FALSE. The period specified by t Wachtdog Time should be a multiple (5-10 times) of the time in which the monitoring signal is transmitted. Inputs VAR_INPUT b Enable : BOOL := FALSE; t Watchdog Time : TIME := t#0s; n Cnt : UDINT; END_VAR Name Type Description b Enable BOOL Enable function block. t Watchdog Time TIME Duration during which n Cnt has to change. n Cnt UDINT Current counter value of the watchdog signal. Outputs VAR_OUTPUT b Watchdog : BOOL := FALSE; n Last Cnt : UDINT; END_VAR Name Type Description b Watchdog BOOL FALSE indicates a valid monitoring signal. The output will become TRUE if no change is detected in n Cnt during the period of time specified by t Watchdog Time. n Last Cnt UDINT Most recent successfully transmitted counter value of the monitoring signal. Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange TE1000 Version: 1.2.1 21
## Page 22

Watchdog function blocks 4.2 FB_Write Watchdog Writing of a watchdog signal to another ADS device (Twin CAT PLC, Bus Terminal Controller, ...). The FB_Write Watchdog function block cyclically writes the contents of a 32-bit counter into another ADS device. The counter is incremented every time the transmission is successful. The FB_Check Watchdog function block can be used at the receiver to evaluate this signal. The receiver is addressed by means of the AMS-Net Id and the port number (see also ADS Device Identification). The position within the receiver is specified by the index group/index offset or by the symbol name. Usually this is the input image or the flags area. The period for t Wachtdog Time should not be shorter than 1 second, to avoid transmitting the counter state too frequently. If 0 s is given for t Watchdog Time, the signal is not transmitted. Please also note the description of the function block FB_Check Watchdog () [} 21]. If the input b Enable is set to FALSE, no further transfer of the watchdog signal takes place. Inputs VAR_INPUT b Enable : BOOL := FALSE; s Net Id : T_Ams Net Id; n Port : T_Ams Port; n Idx Grp : UDINT; n Idx Offs : UDINT; s Var Name : STRING; t Watchdog Time : TIME := t#0s; b Send Now : BOOL; END_VAR Name Type Description b Enable BOOL Enable function block. s Net Id T_Ams Net ID AMS Net ID of the ADS device to which the watchdog signal is to be transmitted. n Port T_Ams Net ID AMS port number of the ADS device to which the watchdog signal is to be transmitted. n Idx Grp UDINT Index group within the ADS device to which the watchdog signal is to be transmitted. n Idx Offs UDINT Index offset within the ADS device to which the watchdog signal is to be transmitted. s Var Name STRING Symbol name within the ADS device to which the watchdog signal is to be transmitted. t Watchdog Time TIME Cycle time in which the watchdog signal is transmitted. b Send Now BOOL The watchdog signal is transmitted immediately by a positive edge. Outputs VAR_OUTPUT b Busy : BOOL := FALSE; n Last Cnt : UDINT := 0; b Error : BOOL := FALSE; n Error Id : UDINT := 0; END_VAR 22 Version: 1.2.1 TE1000
## Page 23

Watchdog function blocks Name Type Description b Busy BOOL The transmission is active. n Last Cnt BOOL Most recently transmitted counter value. b Error BOOL An error occurred during the transmission. n Error Id UDINT ADS error number if an error has occurred. Requirements Development environment required TC3 PLC library Twin CAT v3.0.0 Tc2_Data Exchange TE1000 Version: 1.2.1 23
## Page 24

Data types 5 Data types Name Description E_ADSCom Mode [} 24] Setting of the communication type: safe or fast. 5.1 E_Ads Com Mode TYPE E_Ads Com Mode : ( e Ads Com Mode Secure Com := 0, e Ads Com Mode Fast Com := 1 ); END_TYPE Requirements Development environment required TC3 PLC library Twin CAT v3.1.0 Tc2_Data Exchange 24 Version: 1.2.1 TE1000
## Page 25

Global constants 6 Global constants 6.1 Library version All libraries have a certain version. The version is indicated in the PLC library repository, for example. A global constant contains the information about the library version: Global_Version VAR_GLOBAL CONSTANT st Lib Version_Tc2_Data Exchange : ST_Lib Version; END_VAR Name Type Description st Lib Version_Tc2_D ST_Lib Version Version information of Tc2_Data Exchange ata Exchange To check whether the version you have is the version you need, use the function F_Cmp Lib Version (defined in the Tc2_System library). All other options for comparing library versions, which you may know from Twin CAT 2, are outdated. TE1000 Version: 1.2.1 25
## Page 27

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
