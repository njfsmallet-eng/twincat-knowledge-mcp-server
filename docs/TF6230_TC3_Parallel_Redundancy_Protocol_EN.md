---
title: "TF6230_TC3_Parallel_Redundancy_Protocol_EN"
product: "TF6230"
category: "Communication"
tags: ["PARALLEL", "PROTOCOL", "REDUNDANCY"]
language: "EN"
document_type: "Manual"
version: "1.0.1"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF6230_TC3_Parallel_Redundancy_Protocol_EN.pdf"
release_date: "2024-10-22"
---
Manual | EN TF6230 Twin CAT 3 | Parallel Redundancy Protocol (PRP) 2024-10-22 | Version: 1.0.1
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 Installation................................................................................................................................................. 9 3.1 System requirements........................................................................................................................ 9 3.2 Installation......................................................................................................................................... 9 3.3 Licensing........................................................................................................................................... 9 4 Technical introduction............................................................................................................................ 12 5 Configuration........................................................................................................................................... 13 5.1 PRP adapter parameters................................................................................................................ 16 5.2 PRP Adapter Diagnosis.................................................................................................................. 16 6 Samples................................................................................................................................................... 19 6.1 Reading the link status.................................................................................................................... 19 6.2 Evaluate the Node Table................................................................................................................. 22 7 Support and Service............................................................................................................................... 24 TF6230 Version: 1.0.1 3
## Page 4

Table of contents 4 Version: 1.0.1 TF6230
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. For installation and commissioning of the components, it is absolutely necessary to observe the documentation and the following notes and explanations. The qualified personnel is obliged to always use the currently valid documentation. The responsible staff must ensure that the application or use of the products described satisfies all requirements for safety, including all the relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. No claims to modify products that have already been supplied may be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of designations or trademarks used in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Patents The Ether CAT Technology is covered, including but not limited to the following patent applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 and similar applications and registrations in several other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document as well as the use and communication of its contents without express authorization are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. TF6230 Version: 1.0.1 5
## Page 6

Foreword Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.0.1 TF6230
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF6230 Version: 1.0.1 7
## Page 8

Overview 2 Overview General overview The Twin CAT 3 Parallel Redundancy Protocol enables real-time capable and redundant Ethernet communication via two separate networks. For this purpose, the Parallel Redundancy Protocol (PRP) according to IEC 62439-3:2018 is implemented and the prerequisite for using a PC with Twin CAT 3 as a so- called "Double Attached Node" (DAN) is created. PRP is a protocol and method for redundancy of Ethernet at the MAC level (or layer 2), which is thus independent of the higher layers and protocols. The Twin CAT PRP Adapter used for this purpose implements the redundancy procedure in the Twin CAT real-time environment, as well as with a virtual adapter to the operating system, and can be used completely transparently for the system. All real-time capable protocols based on the Twin CAT Realtime Ethernet Adapter can communicate via the Twin CAT PRP Adapter. However, any non-real-time protocols and applications that communicate from the operating system via the drivers can also be used via PRP. For example, the real-time capable Ether CAT Automation Protocol can be used for redundant communication via PRP, as can the Twin CAT OPC UA server. Components The Twin CAT PRP Adapter requires two individual network interface cards (NICs), which are supported by the Twin CAT RT network driver (see system requirements [} 9]) and can thus be integrated as Twin CAT Realtime Ethernet Adapters. These two adapters are then used for the interfaces to LAN-A and LAN-B defined in the standard. Functionalities The two network interface cards are combined via the Twin CAT Realtime Ethernet Adapter by means of the Twin CAT PRP Adapter to form a virtual network interface card in accordance with IEC 62439-3. The Twin CAT PRP Adapter can then be used to communicate redundantly via the two networks using PRP. This virtual network interface card then provides all the familiar functions and information as a real NIC. The two set network interface cards then act as a "Double Attached Node" (DAN) in the PRP network. It is still possible to use each individual Twin CAT Realtime Ethernet Adapter in Twin CAT as a "Single Attached Node" (SAN) and without PRP for communication via the individual network. Since the use of PRP is completely transparent for the applications, the Twin CAT PRP Adapter has a corresponding diagnostic interface. This provides the necessary information for the evaluation of redundancy and all states. 8 Version: 1.0.1 TF6230
## Page 9

Installation 3 Installation 3.1 System requirements Technical data Requirement Operating system Windows 10, Twin CAT/BSD Target platform PC (x64) Ethernet interface 2 compatible NICs (see "Supported network controllers") Minimum Twin CAT version Twin CAT 3.1 Build 4026.0 or higher Required Twin CAT setup level Twin CAT 3 XAE, XAR Required Twin CAT license TF6230 | Twin CAT 3 Parallel Redundancy Protocol (PRP) 3.2 Installation Twin CAT Package Manager: Installation (Twin CAT 3.1 Build 4026) Detailed instructions on installing products can be found in the chapter Installing workloads in the Twin CAT 3.1 Build 4026 installation instructions. Install the following workload to be able to use the product: • TF6230 | Twin CAT 3 Parallel Redundancy Protocol 3.3 Licensing The Twin CAT 3 function can be activated as a full version or as a 7-day test version. Both license types can be activated via the Twin CAT 3 development environment (XAE). Licensing the full version of a Twin CAT 3 Function A description of the procedure to license a full version can be found in the Beckhoff Information System in the documentation "Twin CAT 3 Licensing". Licensing the 7-day test version of a Twin CAT 3 Function A 7-day test version cannot be enabled for a Twin CAT 3 license dongle. 1. Start the Twin CAT 3 development environment (XAE). 2. Open an existing Twin CAT 3 project or create a new project. 3. If you want to activate the license for a remote device, set the desired target system. To do this, select the target system from the Choose Target System drop-down list in the toolbar. ð The licensing settings always refer to the selected target system. When the project is activated on the target system, the corresponding Twin CAT 3 licenses are automatically copied to this system. TF6230 Version: 1.0.1 9
## Page 10

Installation 4. In the Solution Explorer, double-click License in the SYSTEM subtree. ð The Twin CAT 3 license manager opens. 5. Open the Manage Licenses tab. In the Add License column, check the check box for the license you want to add to your project (e.g. "TF4100 TC3 Controller Toolbox"). 6. Open the Order Information (Runtime) tab. ð In the tabular overview of licenses, the previously selected license is displayed with the status “missing”. 10 Version: 1.0.1 TF6230
## Page 11

Installation 7. Click 7-Day Trial License... to activate the 7-day trial license. ð A dialog box opens, prompting you to enter the security code displayed in the dialog. 8. Enter the code exactly as it is displayed and confirm the entry. 9. Confirm the subsequent dialog, which indicates the successful activation. ð In the tabular overview of licenses, the license status now indicates the expiry date of the license. 10. Restart the Twin CAT system. ð The 7-day trial version is enabled. TF6230 Version: 1.0.1 11
## Page 12

Technical introduction 4 Technical introduction For PRP, a so-called "Redundancy Control Trailer" (RCT) is attached to each Ethernet frame by the Twin CAT PRP Adapter and the Ethernet frame is sent twice via both NICs. When receiving Ethernet frames the RCT is evaluated, double received Ethernet frames from the individual networks are detected. The RCT is removed from the Ethernet frame received first and transferred to the higher-level applications, and the Ethernet frame received twice later is evaluated and then discarded. In addition, the so-called "Supervision Frame" is sent as a multicast and as a sign of life via both NICs at a configurable interval, and is received and evaluated accordingly by other DANs. For the administration and diagnosis of the redundant communication, information about all known nodes of the network is stored as "Nodes" in a so-called "Nodes Table" on the basis of the received Ethernet frames. This "Node Table" and further information are provided by Twin CAT PRP Adapter and are suitable for a very detailed diagnosis of the network and the detection of errors in the network. (See PRP Adapter Diagnosis [} 16]) For the operating system, the network interface card configured for LAN-A in the Twin CAT PRP Adapter is used as a single virtual interface to the redundant networks. All Ethernet frames sent via this interface in the operating system are sent to both networks using PRP, and all received Ethernet frames are forwarded to the operating system via this interface. Thereby the Twin CAT PRP Adapter already removes the RCT and processes other PRP specific Ethernet frames and does not forward them. In the same way, all Ethernet frames for the functions configured in Twin CAT are passed on by both the Twin CAT Realtime Ethernet Adapter and the Twin CAT PRP Adapter to the corresponding drivers and not to the operating system. The network interface card for LAN-B is disabled for the operating system and displayed as if there were no link. 12 Version: 1.0.1 TF6230
## Page 13

Configuration 5 Configuration To configure a PRP Adapter, first the two NICs (see Supported network controllers) for LAN-A and LAN-B are added as "RT-Ethernet Adapters" and assigned to one network adapter each. 1. To do this, add the Real-Time Ethernet Adapter (Multiple Protocol Handler) twice at I/O and Devices. 2. For each RT-Ethernet Adapter, select the appropriate network interface as Adapter. 3. Under Tc COM Objects , add the PRP Adapter via the Tc Prp Adapter module from the PRP - Parallel Redundancy Protocol group. Select the two NICs for LAN-A and LAN-B each as RT-Ethernet Adapter in the parameters of the PRP adapter. ð Further devices can then be added to the Twin CAT configuration and the PRP adapter can be selected as the network adapter via an adapter reference. TF6230 Version: 1.0.1 13
## Page 14

Configuration For example, for an adapter for communication via the "Ether CAT Automation Protocol" (EAP) the PRP Adapter can be selected as reference and thus transferred via both networks using the Parallel Redundancy Protocol. In the following, a module for real-time communication via TCP or UDP from the Twin CAT Function "TF6311 | Twin CAT 3 TCP/UDP Realtime" was added as an example and the previously created PRP adapter was selected as Ethernet adapter. In this way, communication can take place using TCP or UDP via PRP and thus redundantly via the NICs of LAN-A and LAN-B. The following images show the relationship between the adapters. The "RT-Ethernet Adapters" for LAN-A and LAN-B form the interface to the network adapters or NICs of the system. The PRP adapter combines the two "RT-Ethernet Adapters" into one DAN (Double Attached Node) for communication via PRP. The adapter "EAP-DAN" communicates by means of EAP (Ether CAT Automation Protocol) via PRP or the PRP adapter. The second EAP adapter named "EAP-SAN" is again directly linked to the RT-Ethernet Adapter of LAN-A and would thus communicate as a SAN (Single Attached Node), without the RCT of PRP. 14 Version: 1.0.1 TF6230
## Page 15

Configuration EAP-DAN (Ether CAT Automation Protocol): EAP-SAN (Ether CAT Automation Protocol): TF6230 Version: 1.0.1 15
## Page 16

Configuration 5.1 PRP adapter parameters The configuration of the PRP adapter is done via the "Parameters (Init)". These parameters are based on the standard "IEC 62439-3:2018", from chapter 4.5, table 8. Name Type Default Description Adapter Lan A OTCID Defines the network interface for LAN-A by means of the Object ID from the corresponding RT-Ethernet Adapter. Adapter Lan B OTCID Defines the network interface for LAN-B by means of the Object ID from the corresponding RT-Ethernet Adapter Enable Vlan Tagging BOOL FALSE Enables adding VLAN tags for the PRP supervision frames over LAN-A and LAN-B. Vlan Id UINT 1 Defines the VLAN ID for the VLAN tags in the PRP supervision frames. Vlan Prio USINT 0 Defines the VLAN priority for the VLAN tags in the PRP supervision frames. Vlan DEI BOOL FALSE Defines the "VLAN Drop Eligible Indicator" for the VLAN tags in the PRP supervision frames. Trace Zones UDINT Reserved for later configuration of the trace. Life Check Interval UDINT 2000 Defines the interval in milliseconds for sending PRP supervision frames. Node Forget Time UDINT 60000 Defines the time in milliseconds after which a supposedly obsolete entry is removed from the list of nodes. Entry Forget Time UDINT 400 Defines the time in milliseconds after which an entry was removed from the list of received frames used to detect duplicates. 5.2 PRP Adapter Diagnosis The diagnosis of the PRP adapter is done via the "Parameters (Online)". These parameters and values are based on the standard "IEC 62439-3:2018" from chapter 4.2.7, table 2 and 3. 16 Version: 1.0.1 TF6230
## Page 17

Configuration Name Type Description Link Status Tc Prp Adapter Link St Specifies information about the network interface. See at atus Tc Prp Adapter Link Status structure [} 17] the subelements. Node Table Clear BOOL Allows emptying the "Node Table". Node Count UDINT Indicates the current number of entries in the "Node Table". Node Table Tc Prp Node Entry[51 Provides a table with information about all detected nodes in 2] the network. See Tc Prp Node Entry structure [} 17] for the details and subelements of this table. Tc Prp Adapter Link Status structure The diagnosis from the network interfaces to LAN-A and LAN-B is done by the following structure via the parameter "Link Status". Name Type Description Link Speed A UDINT Specifies the transfer rate from the network interface to the LAN-A. Link Speed B UDINT Specifies the transfer rate from the network interface to LAN- B. b Link A BOOL Indicates whether a connection was detected on the network interface to the LAN-A. b Link B BOOL Indicates whether a connection was detected on the network interface to LAN-B. Tc Prp Node Entry structure TF6230 Version: 1.0.1 17
## Page 18

Configuration The diagnosis of the detected nodes in the network is done via the "Node Table". This "Node Table" consists of an array of structures with up to 1024 entries. A maximum of 64 entries are displayed in the Twin CAT XAE. The complete list can be retrieved via ADS. The current number of entries in this list is specified by the "Node Count" parameter. The following describes the structure of the entries and its values. Name Type Description Mac Address MAC_ADDRESS Specifies the MAC address to the entry of the node. b San A BOOL Indicates whether the node was detected as a SAN (Single Attached Node) on the LAN-A. b San B BOOL Indicates whether the node was detected as a SAN (Single Attached Node) on the LAN-B. Cnt Received A UDINT Specifies the number of frames received from LAN-A. Cnt Received B UDINT Specifies the number of frames received from LAN-B. Cnt Err Wrong Lan A UDINT Specifies the number of frames received from LAN-A indicating a wrong LAN indicator. Cnt Err Wrong Lan B UDINT Specifies the number of frames received from LAN-B indicating a wrong LAN indicator. Cnt Duplicate Discard La UDINT Specifies the number of received duplicates and thus n A discarded frames from LAN-A. Cnt Duplicate Discard La UDINT Specifies the number of received duplicates and thus n B discarded frames from LAN-B. Cnt Supervision Frame L UDINT Specifies the number of PRP supervision frames received an A from LAN-A. Cnt Supervision Frame L UDINT Indicates the number of received PRP supervision frames an B from LAN-B. Cnt Rx Err Lan A UDINT Specifies the number of errors when receiving frames from LAN-A. Cnt Rx Err Lan B UDINT Specifies the number of errors when receiving frames from LAN-B. Cnt Tx Err Lan A UDINT Specifies the number of errors when sending frames in LAN- A. Cnt Tx Err Lan B UDINT Specifies the number of errors when sending frames in LAN- B. Time Last Seen A UDINT Specifies the time in milliseconds before which a frame was last received from these nodes on the LAN-A. Time Last Seen B UDINT Specifies the time in milliseconds before which a frame was last received from these nodes on the LAN-B. 18 Version: 1.0.1 TF6230
## Page 19

Samples 6 Samples These examples demonstrate the diagnosis of a PRP connection. Sample code and configurations for this product can be obtained from the corresponding repository on Git Hub: https://github.com/Beckhoff/TF6230_Samples. You have the option of cloning the repository or downloading a ZIP file with the sample. 6.1 Reading the link status Download: https://github.com/Beckhoff/TF6230_Samples/tree/main/Tc Prp Link Status Sample In this sample the Tc Prp Adapter Link Status structure [} 17] is queried by Twin CAT PRP module to evaluate the link status of the two RT-Ethernet Adapters used. In this way, it can be determined whether there is an active connection on the respective adapter to the next node in the network, such as to a switch. A single active connection should be sufficient to continue to reach the other devices in the PRP network. However, the inactive connection should already be an indication of an error in the network. ü To put the sample into operation, the adapters for the two RT-Ethernet Adapters must first be configured. TF6230 Version: 1.0.1 19
## Page 20

Samples 1. At Adapter, set the compatible Network Adapter on both the X000 and X001 I/O devices. 2. On the Twin CAT PRP module, here with the name PRP, select the two RT-Ethernet Adapters at Parameters (Init) for the LAN-A and LAN-B 20 Version: 1.0.1 TF6230
## Page 21

Samples 3. In the PLC project an interface pointer to the Twin CAT PRP module is used. Configure this interface pointer with the Symbol Initialization to select and assign the Object ID from the Twin CAT PRP module. 4. Activate the Twin CAT project and start the PLC project. ð Both adapters should indicate an active link by having the variables b Link A and b Link B both TRUE. TF6230 Version: 1.0.1 21
## Page 22

Samples ð For example, if you now disconnect the Ethernet cable from the adapter X001, this is immediately detected and indicated by a change of the variable b Link B to FALSE. 6.2 Evaluate the Node Table Download: https://github.com/Beckhoff/TF6230_Samples/tree/main/Tc Prp Node Table Sample Building on the previous sample, the "Node Table" with the Tc Prp Node Entry structure [} 17] is also queried here. The table of nodes in the network is read from the Twin CAT PRP module using ADS Read (see FB_Tc Prp Adapter. Get Node Table) and a specific node in the list is searched for and evaluated on the basis of a defined MAC address (see FB_Tc Prp Adapter. Get Node Index By Mac and FB_Tc Prp Adapter. Get Node Entry). The various values from the "Node Entry" are summarized using LAN-A and LAN-B to determine whether communication to the node has been interrupted. If no frames from the respective LAN were received by this node for more than two seconds, this is recognized as a "Timeout" (see FB_Tc Prp Node.b Timeout{A,B}). If neither frames on LAN-A nor on LAN-B are detected, this is indicated as "Disconnect" (see FB_Tc Prp Node.b Disconnect). 22 Version: 1.0.1 TF6230
## Page 23

Samples TF6230 Version: 1.0.1 23
## Page 24

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 24 Version: 1.0.1 TF6230
## Page 26

More Information: www.beckhoff.com/tf6230 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
