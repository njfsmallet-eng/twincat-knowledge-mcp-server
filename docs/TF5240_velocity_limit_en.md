---
title: "TF5240_velocity_limit_en"
product: "TF5240"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.1"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5240_velocity_limit_en.pdf"
release_date: "2025-06-10"
---
Functional description | EN TF5240 | Twin CAT 3 CNC TCP Velocity limitation 6/10/2025 | Version: 1.1
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5240 | Twin CAT 3 CNC Version: 1.1 3 TCP Velocity limitation
## Page 4

Notes on information security Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. 4 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 5

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. TF5240 | Twin CAT 3 CNC Version: 1.1 5 TCP Velocity limitation
## Page 6

Contents Contents Notes on the documentation.................................................................................................................... 3 Notes on information security................................................................................................................. 4 General and safety instructions.............................................................................................................. 5 1 Overview.................................................................................................................................................... 8 2 Description................................................................................................................................................ 9 2.1 Tool parameter modes.................................................................................................................... 10 2.2 Application examples...................................................................................................................... 11 2.3 Parameterisation example for operation mode in T1 mode............................................................ 12 2.4 Universal Kinematics ID 91 and V. G. LIMIT. KIN[i]. TOOL................................................................ 12 3 Programming........................................................................................................................................... 13 3.1 Programming example – Update the kinematic.............................................................................. 13 4 Parameter................................................................................................................................................. 14 4.1 Overview......................................................................................................................................... 14 4.2 Channel parameters........................................................................................................................ 15 4.3 HLI parameters............................................................................................................................... 16 5 Error messages....................................................................................................................................... 17 6 Support and Service............................................................................................................................... 18 Index......................................................................................................................................................... 19 6 Version: TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 7

List of figures List of figures Fig. 1 Limiting the TCP velocity.............................................................................................................. 9 TF5240 | Twin CAT 3 CNC Version: 1.1 7 TCP Velocity limitation
## Page 8

Overview 1 Overview Task This function limits the TCP (tool centre point) velocity of any kinematic to a maximum value. The function is used, for example, with industrial robots that are equipped with the T1 operation mode according to EN ISO 10218-1. This allows operators to enter the robot workspace in order to carry out set-up work. If set-up work is carried out with a CNC that controls the robot, the operator can limit the TCP velocity to a non-hazardous value. Properties The function is independent of the kinematic used in the NC program. The TCP velocity limit of a kinematic is enabled and disabled via the HLI of the CNC before program start or even during operation. This function is available as of CNC Build V3.1.3079.26. Parameterisation See Parameterisation example for operation mode in T1 mode [} 12] Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 8 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 9

Description 2 Description NOTICE On its own, the kinematic velocity limit is not a safety function. To ensure T1 operation safety, the TCP velocity of the robot must additionally be monitored in a safety PLC. The aim is to provide error-free control of a robot in T1 mode. It prevents the velocity monitor from reporting a velocity that is too high. This would result in the machine changing to an error state. This also applies to operation without active transformation (cf. Reduced velocity). The velocity limit has the following properties: • The limit acts in NC automatic and manual modes. • When the limit is enabled via the HLI, the lowest velocity is used for all the set kinematics. • The velocity override continues to act on the programmed velocity. • One kinematic and one velocity can be specified for each limit. Operating principle The velocity limit calculates a Cartesian position using the forward transformation of the specified kinematic. This is then used in motion blocks to calculate the path velocity, provided it does not exceed the specified maximum velocity of the Cartesian motion. When the tcp_velocity_limit control unit [} 16] is set to TRUE, the new path velocity is applied to the maximum path velocity as an additional limit during interpolation. The velocity limit function can be enabled either at program start or by the NC command #LIMIT ON[TCP_VEL …]. With the program start variant, the channel parameter limit.kin[i].active must be set to 1 (P-CHAN-00464 [} 15]). In both cases, no errors should be made when programming the kinematic to be limited. Fig. 1: Limiting the TCP velocity It is not permitted to perform an axis exchange when the TCP velocity limit function is active. The TCP velocity limit is calculated by setting P-CHAN-00464 [} 15] at program start.. The calculated limit value is used by setting the tcp_velocity_limit control unit [} 16]. TF5240 | Twin CAT 3 CNC Version: 1.1 9 TCP Velocity limitation
## Page 10

Description 2.1 Tool parameter modes The kinematic of the velocity limit is independent of the kinematic processed. The behaviour at tool change can be adapted by the parameter P-CHAN-00469 [} 15]. P-CHAN-00469 = 0 (default) If the T/D word follows a tool change, the tool length and the tool head offsets of the kinematic are updated. If the tool is changed without a following T/D word (e.g. using V. G. WZ_AKT), the kinematic parameters must be explicitly updated using the #LIMIT REFRESH [KIN] [} 13] command. The #TRAFO ON / OFF function does not automatically update the kinematic of the TCP velocity monitor. The same applies if the kinematic parameters themselves are changed, e.g. using V. G. KINEMATIK[i]. PARAM[j]. The parameters of kinematics are always updated: • at program start, • when the D word is set, • by the #LIMIT REFRESH [KIN] command. P-CHAN-00469 = 1 In this mode, the kinematic parameters are not updated by a T/D word. In addition, the length or tool head offsets of the active tool are not added to the kinematic data of the kinematic at any time. However, if tool parameters of the TCP kinematic have to be changed, they can be adapted using the V. G. variables V. G. LIMIT. KIN[i]. TOOL. KIN_PARAM[j] [} 13] and V. G. LIMIT. KIN[i]. TOOL. LENGTH [} 13]. Once the LIMIT parameters are written, they remain effective until they are overwritten or the controller is restarted. These parameters are then used as in Mode=0 of the tool parameters (additional to the kinematic parameters). When the V. G. parameters are written, they are added to the kinematic parameters at the next program start or added immediately by using the NC command #LIMIT REFRESH [KIN]. The #LIMIT REFRESH [KIN] [} 13] command updates all active limit kinematics. The mode then decides whether the parameters of the V. G. LIMIT… or of the active tool are added. Mode = 1 should be used if… • the tool parameters have no relevance for the limit function, • they are not compatible with other kinematics, or • the tool has different parameters for the limit. In combination with the couple kinematic KIN_ID 210, no kinematic parameter changes are adopted by means of the tool or the V. G. LIMIT. 10 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 11

Description 2.2 Application examples P-CHAN-00469 = 0 • KIN_TYP_45 Without a velocity limit, there is no possibility to limit the TCP velocity when the transformation is inactive, for example. If the velocity limit is active, the TCP will not move too rapidly when the limit is activated. This even applies to axis-specific programming. P-CHAN-00469 = 1 • KIN_TYP_45, Monitor the elbow (with Universal Kinematics) When an elbow movement is monitored, it is not recommended to use tool offsets or change them when a tool is changed. • KIN_TYP_45, Moved workpiece When the workpiece is moved, the tool is placed at a fixed position in space. The tool offset can be parameterised using #CS coordinate systems. The offset of the workpiece at the flange is of interest to the TCP velocity limit in order to move the workpiece in certain limits (e.g. with a long rod). When the workpiece is manoeuvred, the offset to the workpiece tip can be parameterised at TCP or with a tool offset using V. G. LIMIT. KIN[i]. TOOL. KIN_PARAM[j] [} 13] without changed in the parameters of kinematic 45. TF5240 | Twin CAT 3 CNC Version: 1.1 11 TCP Velocity limitation
## Page 12

Description 2.3 Parameterisation example for operation mode in T1 mode Extract of parameters entered in the channel parameter list: limit.kin[i].active 1 #P-CHAN-00464 limit.kin[i].id 1 #P-CHAN-00830 limit.kin[i].mode 0 #P-CHAN-00469 limit.kin[i].velocity.max 250000.0 #P-CHAN-00466 limit.kin[i].velocity.ipo_weight_fact 70 #P-CHAN-00478 Explanations: i: Index of the function, 2 > i ≥ 0 active: Activate this limit id: ID the kinematic to limit motion velocity (only kin_step[0]) mode: Set the mode for the tool parameters. velocity.max: The maximum velocity in µm/s velocity.ipo_weight_fact: Weighting factor of the velocity portion of the interpolation when G201 is active. 2.4 Universal Kinematics ID 91 and V. G. LIMIT. KIN[i]. TOOL Do not use any parameters via V. G. or tool head offsets with Universal Kinematics ID 91 since the Universal Kinematics have a different internal structure. Always use V. G. variables in the NC program to adapt the tool in Universal Kinematics, e.g. V. G. KIN[91]. PARAM[i] or V. G. KIN[91]. ZERO. With Universal Kinematics, set the mode (P-CHAN-00469 [} 15]) to 1 for the velocity limit. 12 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 13

Programming 3 Programming NC command for updating all kinematic parameters in the TCP kinematic according to P-CHAN-00469 [} 15]: Syntax: #LIMIT REFRESH [ KIN ] modal Global variables (V. G.) to access the tool parameters of the TCP kinematic in the NC program: LIMIT. KIN[i]. TOOL. Tool length where Real [mm] R/W LENGTH <i>:= 0, 1 index of the configured kinematic LIMIT. KIN[i]. TOOL. Kinematic parameter of the tool where Real [0.1 µm, R/W KIN_PARAM[j] 10-4°] <j>:= 0..69 Index of the kinematic parameter 3.1 Programming example – Update the kinematic Update the kinematic using P-CHAN-00469 [} 15] = 0 %100 N010 G1 G90 F5000 N015 V. G. WZ_AKT. KIN_PARAM[0] = 1000 N020 #LIMIT REFRESH [KIN] N050 … %101 N010 G1 G90 F5000 N015 V. G. WZ_AKT. KIN_PARAM[0] = 1000 N020 T1 D1 N050 … Follow Update the kinematic using P-CHAN-00469 [} 15] = 1 %102 N010 G1 G90 F5000 N015 V. G. LIMIT. KIN[0]. TOOL. KIN_PARAM[0] = 1000 N016 V. G. LIMIT. KIN[0]. TOOL. LENGTH = 1000 N020 #LIMIT REFRESH [KIN] N050 … Update the kinematic parameters The kinematic parameters of KIN_TYP_45 are directly adapted. %103 N010 G1 G90 F5000 N015 V. G. KIN[45]. PARAM[0] = 1000 N020 #LIMIT REFRESH [KIN] N050 … TF5240 | Twin CAT 3 CNC Version: 1.1 13 TCP Velocity limitation
## Page 14

Parameter 4 Parameter 4.1 Overview HLI Description tcp_velocity_limit BAHN_MC_CONTROL_BOOL_UNIT to activate the limit. ID Parameter Description P-CHAN-00464 limit.kin[i].active Activate additional functionality for kinematics P-CHAN-00466 limit. kin Limit velocity in µm/s [i].velocity.max P-CHAN-00469 limit.kin[i].mode Mode for use of parameters with a tool change. P-CHAN-00478 limit.kin[i].velocity.ipo_ Velocity percentage of the interpolation with G201. weight_factor P-CHAN-00830 limit.kin[i].id Transformation ID of the kinematic used. Unit of Permitted In/Output access: V. G.<var_name> Meaning Data type Read/ Write LIMIT. KIN[i]. TOOL. Tool length where Real [mm] R/W LENGTH <i>:= 0, 1 index of the configured kinematic LIMIT. KIN[i]. TOOL. Kinematic parameter of the tool where Real [0.1 µm, R/W KIN_PARAM[j] 10-4°] <j>:= 0..69 Index of the kinematic parameter 14 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 15

Parameter 4.2 Channel parameters P-CHAN-00464 Activate additional functionality for kinematics Description Activates additional functionalities of the specified kinematic. For example, with load model or TCP velocity monitoring [} 8]. When this parameter is set, the specified kinematic is used to calculate the TCP during TCP velocity monitoring. When the limit is switched on via tcp_velocity_limit control unit [} 16] , the limit is applied. Parameter limit.kin[i].active Data type BOOLEAN Data range 0: No calculation 1: The corresponding velocity of the limit is calculated. Dimension ---- Default value 0 Remarks Parameter available as of V3.1.3079.26 P-CHAN-00466 Velocity limit Description The maximum velocity that may be moved for this kinematic system when the function is active. Parameter limit.kin[i].velocity.max Data type REAL64 Data range > 0.001 µm/s Dimension µm/s Default value 0 Remarks Parameter available as of V3.1.3079.26 P-CHAN-00469 Mode for the use of tool head offsets Description This parameter defines the strategy with which tool parameters are used for the calculating kinematics. Parameter limit.kin[i].mode Data type UNS32 Data range 0: If the T/D command is output after a tool change, the tool length and the tool head offsets of the kinematics are updated. 1: In this mode, the kinematic parameters are not updated with a T/D word. In addition, the length or tool head offsets of the active tool are not added to the kinematic data of the kinematic at any time. Dimension --- Default value 0 Remarks Mode = 1 should be used if tool parameters have no relevance for the limit function, they are not compatible between the kinematics or the tool is parameterised differently for the limit. Parameter available as of V3.1.3079.26 P-CHAN-00478 Velocity percentage of the interpolation with G201 Description The parameter defines the velocity percentage [in %] of the interpolation in the velocity P- CHAN-00466 when G201 is active. Parameter limit.kin[i].velocity.ipo_weight_factor Data type UNS16 Data range Dimension 25 <= ipo_weight_factor <= 75 Default value 70 TF5240 | Twin CAT 3 CNC Version: 1.1 15 TCP Velocity limitation
## Page 16

Parameter Remarks Manual mode contains the usual part of 100%; the default value is 70, i.e. 30. Parameter available as of V3.1.3079.26 P-CHAN-00830 Kinematic ID of velocity monitoring Description This parameter defines the ID of the kinematic used to calculate velocity. The kinematic must be defined by the same ID in kin_step[0]. Parameter limit.kin[i].id Data type UNS16 Data range 0... MAX(UNS16) Dimension --- Default value 0 Remarks If the parameter is activated (value unequal to 0), a kinematic type must be specified; otherwise the error message ID 22108 is output. Available as of V3.1.3080.09 4.3 HLI parameters Switch on velocity limit Description By setting this command, the maximum path velocity is limited according to the kinematic and velocity settings. Data type MC_CONTROL_BOOL_UNIT, see description of Control unit Access PLC reads request_r + state_r and writes command_w + enable_w ST path gp Ch[channel_idx]^.bahn_mc_control.tcp_velocity_limit Commanded, requested and return values ST element .command_w .request_r .state_r Data type BOOL Unit Value range [TRUE = limits active, FALSE = limits not active] Redirection ST element .enable_w Special feature Available as of CNC Build V3.1.3079.26 16 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 17

Error messages 5 Error messages Error ID Description 22106 Double programming in #LIMIT command. 22107 Kinematic name of the kinematic velocity limit is unknown. 22108 Kinematic name of the kinematic velocity limit is invalid. 22109 The specified velocity for the kinematic velocity limits is too low. 22110 The weighting factor for the velocity in the kinematic velocity limit is too low. 22111 The weighting factor for the velocity in the kinematic velocity limit is too high. 51025 Initialisation of the kinematic of the TCP velocity limit failed. 120801 Initialisation of the kinematic of the TCP velocity limit failed. TF5240 | Twin CAT 3 CNC Version: 1.1 17 TCP Velocity limitation
## Page 18

Support and Service 6 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 18 Version: 1.1 TF5240 | Twin CAT 3 CNC TCP Velocity limitation
## Page 19

Index Index P P-CHAN-00464 15 P-CHAN-00466 15 P-CHAN-00469 15 P-CHAN-00478 15 P-CHAN-00830 16 S switch on velocity limit 16 TF5240 | Twin CAT 3 CNC Version: 1.1 19 TCP Velocity limitation
## Page 21

More Information: www.beckhoff.com/TF5240 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
