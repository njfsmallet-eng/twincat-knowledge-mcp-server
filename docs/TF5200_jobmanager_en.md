---
title: "TF5200_jobmanager_en"
product: "TF5200"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.0"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_jobmanager_en.pdf"
release_date: "2025-06-10"
---
Functional description | EN TF5200 | Twin CAT 3 CNC Job Manager 6/10/2025 | Version: 1.0
## Page 3

Table of contents Table of contents 1 Overview.................................................................................................................................................... 6 2 Description................................................................................................................................................ 7 2.1 General............................................................................................................................................. 7 2.2 Job management.............................................................................................................................. 7 2.2.1 Start of job.......................................................................................................................... 7 2.2.2 Job status........................................................................................................................... 9 2.2.3 Job ID and job tracking.................................................................................................... 10 2.2.4 Aborting a job................................................................................................................... 11 2.2.5 End of job......................................................................................................................... 13 2.2.6 Job stack.......................................................................................................................... 14 2.2.7 Prioritisation and lock blocks............................................................................................ 15 2.2.8 Synchronisation with agent jobs....................................................................................... 15 2.2.9 Job Manager groups........................................................................................................ 16 2.3 Application scenarios of the Job Manager...................................................................................... 17 2.3.1 Multi-station operation...................................................................................................... 17 2.3.2 Machining in several stations........................................................................................... 17 2.3.3 Die sinking........................................................................................................................ 17 3 Programming........................................................................................................................................... 18 3.1 Job Manager NC commands.......................................................................................................... 18 3.2 Commanding agents....................................................................................................................... 18 3.3 Locking competing clients............................................................................................................... 20 3.4 Waiting for the status of the commanded job.................................................................................. 21 3.5 Requesting the last valid status in #WAIT MC_Status.................................................................... 21 3.6 Channel reset in a commanded channel......................................................................................... 22 3.7 V. G. variables.................................................................................................................................. 23 4 CNC objects............................................................................................................................................. 25 4.1 MC_Move Path + MCV_Grp Path Prepare + MCV_Grp Path Mode.................................................... 25 4.2 MCV_Grp Reset Force...................................................................................................................... 25 4.3 MCV_Grp Read Job Ack.................................................................................................................... 26 5 PLCopen function blocks....................................................................................................................... 27 5.1 MC_Move Path................................................................................................................................ 27 5.2 MCV_Grp Path Mode........................................................................................................................ 29 5.3 MCV_Grp Path Prepare.................................................................................................................... 30 5.4 MCV_Grp Read Job Ack.................................................................................................................... 32 5.5 MCV_Grp Read Job Status List.......................................................................................................... 33 5.6 MCV_Grp Reset Forced.................................................................................................................... 33 5.7 MC_Grp Stop................................................................................................................................... 35 6 Parameter................................................................................................................................................. 36 7 Support and Service............................................................................................................................... 39 Index......................................................................................................................................................... 40 TF5200 | Twin CAT 3 CNC Version: 3 Job Manager
## Page 4

Table of contents 4 Version: TF5200 | Twin CAT 3 CNC Job Manager
## Page 5

List of figures List of figures Fig. 1 Variants to start a job................................................................................................................... 8 Fig. 2 Passing through the job ID from job start through to the display of a job status change............. 11 Fig. 3 Effect of job aborts on client and agent........................................................................................ 12 Fig. 4 End of job messages due to M30 relating to client and agent..................................................... 13 Fig. 5 Assigning channels to Job Manager groups................................................................................ 16 Fig. 6 Values of the V. G. variable V. G. IP_NR relating to the commanding and commanded channels 24 TF5200 | Twin CAT 3 CNC Version: 1.0 5 Job Manager
## Page 6

Overview 1 Overview Task The Job Manager (JM) coordinates the start of NC programs in other channels. Batch mode is possible One or several channels and their CNC programs form the client (previously master) and the other channels are commanded channels (previously slave). Besides the controlled forwarding of jobs, the Job Manager also manages feedback from agents. If several (subordinate) agents were commanded in a job, their feedbacks are summarised and sent to the client in one report. The Job Manager uses specific statuses and basic functions of the PLCopen Organisation and extends them with functions for job identification and management. This function is available as of CNC Build V3.1.3110. Parameterisation Channels are configured as clients or agents in the start-up list. Programming The Programming [} 18] section describes additional commands for commanding channels. Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 6 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 7

Description 2 Description 2.1 General Multi-channel CNC systems are often coordinated by complex PLC programs. The PLC programs: • start parallelised or strictly sequential processes, • command synchronous or asynchronous motions in CNC channels and • recombine processes and motions. In many cases, they are optimised for one application. “Batch mode” or operation with “recipes” are not possible, i.e. commands with deviating processes or rules for a program that the user can modify. The reasons for this are dependencies encoded in the process involving • controller properties • application programs • program synchronisation • the manufactured product itself. When a Job Manager is used, it permits batch mode without PLC support. One or several CNC channels and their CNC programs assume the task of commander, also referred to as “client” (master). The other channels are service providers, referred to as “agents” (slaves). Commanding channels use additional commands for • starting NC programs in agents • blocking other agents from issuing commands and • synchronising program flow in the commanding channel and its agents. All channels not declared as clients display an error message when additional commands are called. 2.2 Job management The primary task of the Job Manager is to manage jobs. A job is defined as a unit with the following attributes: • CNC program to be started. It is identified by the CNC program filename. • Start mode of the CNC program, • optional parameters/values for transfer to the commanded program, • a “Job D” and “Source ID” defined by the user. When the Job Manager is enabled, each channel has a job queue containing jobs waiting to be started. When the channel is free – i.e. no program is running in the channel decoder – the next job in the queue is executed without user confirmation. The start sequence corresponds to the sequence in which the jobs were stored. The program described in the job is loaded and started in the same way as the previously known program start (see MCM automatic state indicator); in addition, optional start modes and parameters are transferred to the program. The job ID helps to keep the job identifiable and traceable for the Job Manager and the user throughout the entire runtime. 2.2.1 Start of job There are three options to store a job in the job queue of a channel. If the options are used in parallel, they are processed from by the interfaces described below in descending order of priority. If the job queue is full, the client must wait. Implicitly, subordinate clients and their jobs also wait. The figure below shows start variants a) to c): TF5200 | Twin CAT 3 CNC Version: 1.0 7 Job Manager
## Page 8

Description Fig. 1: Variants to start a job • Variant a) Commanding via (PLC) PLCopen Part 4 block MC_Move Path [} 27]. The block can be used for both commanding and commanded channels. • Variant b) Describe several CNC objects in specified order. The MC_Move Path function described in a) is triggered. Typically, this access is used by an HMI. The interface can be used for commanding and commanded channels. (see CNC objects [} 25]) • Variant C) A CNC program running in the commanding channel starts a job in another commanded channel using the #MC_Move Path command. (see Commanding agents [} 18]) Variant c) requires at least one commanding channel and one commanded channel. Variant a) can only be commanded by the PLC. Variants a) and b) can basically be used in any CNC channel irrespective of the Job Manager mode. Starting an NC program is still possible using the previously known HLI MCM auto- matic state indicator despite the fact that the Job Manager is in use. Regardless of whether it is started in the agent or client, only a single program is executed without parameters and without job identification. A program start commanded by the MCM automatic state indicator is not stored in the job queue. It does not recognise any job statuses, only known and doc- umented (channel) statuses. NOTICE When both command types are used, the user is responsible for avoiding deadlocks or collisions with Job Manager jobs. 8 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 9

Description 2.2.2 Job status The status of each job is described by statuses that are defined in PLCopen and can assume the following values during the entire life span of a job: • “Busy“ (MC_BUSY): The job is planned but is in the queue. • “Started“(MC_STARTED): The job was started in the decoder. • “Aborted“ (MC_ABORTED): The job was aborted. This was preceded by a stop or reset by the user. • “Error“ (MC_ERROR): An error was detected during a job processing phase. The error may have occurred in the commanding channel itself or in a commanded channel started by the client. • “Done“ (MC_DONE): Error-free end of the job and its commanded channels started by the client. When this status is signalled, the job is removed from the Job Manager system and deleted. PLCopen uses proprietary output interfaces with the value range True/False to dis- play statuses The implementation described here partially deviates from this and uses an enumeration or a numerical value for statuses. The name uses the PLCopen notation where “MC_” (for Motion Control) is placed in front for the sake of unique- ness. TF5200 | Twin CAT 3 CNC Version: 1.0 9 Job Manager
## Page 10

Description 2.2.3 Job ID and job tracking The PLCopen specification does not specify how the completed message - i.e. the job status - of several jobs commanded one after the other by MC_Move Path can be identified at the "Done", "Busy" or "Active" pins. It only stipulates that the completed message at the “Done” pin of the MC_Move Path may only become active when no more jobs are active – i.e. when the system is “empty”. The “Done” status is never active when the machine is at maximum utilisation and the commanding channel is in “continuous mode”. The user can assign a job ID (number) to still receive feedback for each of the commanded jobs and each of the status changes for these jobs. Three blocks are used to command and request jobs: • MCV_Grp Path Mode [} 29] • MCV_Grp Path Prepare [} 30] • MCV_Grp Read Job Ack [} 32] MCV_Grp Path Mode block This block is optional and acts on the “mode” (operation mode) of the job to be started (=CNC program) (see also Channel operation mode). MCV_Grp Path Prepare block The MCV_Grp Path Prepare module adopts this mode and assigns additional job attributes that can be defined by the user, e.g. the job ID which can be specified by the Job ID pin. All attributes are transferred via the “Path Data” pin to the MC_Move Path block at job start. MCV_Grp Read Job Ack block The MCV_Grp Read Job Ack block is supplied by the “Fb” pin of the MC_Move Path block. On the rising edge, the block signals on the "Valid" output that a new state is displayed. Each job status change to MC_BUSY, MC_STARTED, MC_ABORTED, MC_DONE and MC_ERROR is displayed for each job started by MC_Move Path,. At the same time, each job ID assigned by the user at job start is displayed. The figure below shows an example of a job with job ID "1" that was originally started by MCV_Grp Path Prepare and has just been completed. The MCV_Grp Read Job Ack module last showed the MC_DONE status of this job with job ID "1". Previously, this function block first signalled the MC_BUSY status directly after commanding in MC_Move Path, and then the MC_STARTED status after starting in the decoder. After starting the job with job ID "2", the MC_BUSY status for job ID "2" is readable in MCV_Grp Read Job Ack. The statuses MC_STARTED, MC_DONE or, in the event of an error, MC_ABORTED or MC_ERROR, will follow later. 10 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 11

Description Fig. 2: Passing through the job ID from job start through to the display of a job status change If MC_Move Path is executed in conjunction with MCV_Grp Path Prepare, MCV_Grp Read Job Ack must be called permanently to read out the job statuses. If this fails to happen, the internal buffers run full and block new commanded jobs. As an alternative to the PLC blocks MCV_Grp Path Prepare, MC_Move Path and MCV_Grp Read Job Ack, there are CNC objects that allow jobs to be enabled and status messages to be read. See CNC objects [} 25] If the MC_Move Path function is triggered by CNC objects, acknowledgements must be read back by the corresponding CNC objects of the MCV_Grp Read Job Ack. If this fails to happen, the internal buffers of the Job Manager run full and block new commanded jobs. If MC_Move Path is started from a CNC program, the status of the commanded job can be monitored as in Synchronisation with agent jobs [} 15]. Its job ID is required when called. 2.2.4 Aborting a job The following PLC function blocks are intended for the controlled abort of one or several jobs. • MCV_Grp Reset Forced • MC_Grp Stop If one of the function blocks is used on a commanding channel, all waiting and active jobs in the channel are terminated. When they are aborted, all jobs not previously completed in commanded - i.e. subordinate - channels are also aborted. The status of each aborted job (not the channel!) changes to the MC_ABORTED status. TF5200 | Twin CAT 3 CNC Version: 1.0 11 Job Manager
## Page 12

Description The selective abort of single client jobs is currently not supported. Reason for this restriction: In general, #SIGNAL / #WAIT events between channels cannot be reset in a coordinated process. The reason for this are the combinations of the interdependent statuses of all the channels involved and this can become very large. In addition, if an abort occurs, it is usually not possible to determine the actual system status. If there is an incorrect restart, this could result in incorrect program starts or incorrect program flows. If the function blocks for an abort are applied to an commanded channel, all waiting and active jobs are terminated there. If one of the aborted jobs was commanded by a commanding channel, the commanding job in the commanding channel is also set to the MC_ABORTED status and blocked. All jobs previously commanded by the commanding job for other commanded channels are not aborted. Fig. 3: Effect of job aborts on client and agent The difference between MCV_Grp Reset Forced and MC_Grp Stop is that MCV_Grp Reset Forced also resets all the axes of the commanding and commanded channels to their initial statuses. An CNC object exists for MCV_Grp Reset Forced as well as for MC_Move Path and MCV_Grp Read Job Ack. #MCV_Group Reset Forced can also be started from a commanding CNC program. As with MC_Move Path, the user must assign a job ID in order to permit monitoring via the described synchronisation function [} 15]. The abort behaviour is the same as the #MCV_Group Reset Forced function triggered by the PLC on a commanded channel. 12 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 13

Description 2.2.5 End of job From the "classic” interpretation of a CNC program, M30 terminates the running program and "stops" the CNC channel. When the Job Manager is used, M30 not only ends the CNC program in the commanded channel but also sends an MC_DONE to the commanding job or to the client, if available. The client then uses the message to manage its jobs internally. If there is another job in the client queue, it is automatically activated (message MC_ACTIVATED to the client) and the program described in the job is started. On the other hand, if a program is terminated in the commanding channel with M30, the program identified by the next waiting job is started. However, the job belonging to the program containing this M30 is only terminated when all commanded agent jobs terminate by themselves. If this is the case, an MC_DONE is sent to the client, i.e. the PLC waiting for the MCV_Grp Read Job Ack block. Since it can be assumed that commanded agent jobs have not yet been terminated when the next job is started, the result is that several jobs are active. If programs with different agents are commanded consecutively in a client, it is possible that jobs that were started "later" in the sequence are completed "before" the jobs that were commanded previously. The figure below shows the relationship between M30 and MC_DONE by means of a job "J1" and its sub- jobs "J1.1" and "J1.2". If "J1.1" and "J1.2" are terminated with M30, they send an MC_DONE to the client. If the program of "J1" itself was terminated with M30 and all commanded jobs also have the MC_DONE status, an MC_DONE can be sent for "J1". All other jobs and their associated programs are not yet terminated since the corresponding MC_DONE is missing. Fig. 4: End of job messages due to M30 relating to client and agent TF5200 | Twin CAT 3 CNC Version: 1.0 13 Job Manager
## Page 14

Description 2.2.6 Job stack As described in section Job ID and job tracking [} 10], the job ID assigned by the user at job start is returned when the job is terminated. However, the job ID should also be visible in all agent jobs commanded by the client so that it can be used for testing or logging purposes. The JM uses a “job stack” for this purpose: When a new job is created, it is generated and initialised with the user's job ID via an initial "PUSH". At each commanding level - including in the controller - the stack is extended by an additional "PUSH" of the internal job ID. After a job is terminated, the commanded user sends the current job stack back to its client - together with the status MC_DONE, MC_ABORTED or MC_ERROR. The receiver of the message accesses its job ID via a "POP" and updates its job management as required. The Job Manager supports multi-client operation. This means that agents can be commanded by several clients. Since the job stack and the job status must always be returned to the correct client, an additional "source ID" is entered in each entry in the job stack in addition to the job ID. The source ID is used in the controller to determine the routes used by the job statuses (acknowledgements). The source ID is displayed in the MCV_Grp Read Job Ack block. The precondition for the “source ID” readable by the user in MCV_Grp Read Job Ack is the assignment of a value in the MCV_Grp Path Prepare block. In addition to two job IDs that can be issued by the user, a separate source ID (number) can be assigned here. MCV_Grp Read Job Ack returns all three entries at every status change. Both the source ID and the two job IDs, as well as the job IDs and source ID tuples assigned internally in the controller, can be tracked in the job stack at all levels of job processing via status displays or in the trace. The user can use the job ID to identify workpieces in their user’s production pro- cesses. The source ID helps the user to return acknowledgements directly back to alternative commanding clients. 14 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 15

Description 2.2.7 Prioritisation and lock blocks If there are several commanding channels that command one or more jointly used commanded channels, their jobs - or more precisely their programs - compete to send jobs to the jointly used agent. The Job Manager determines the order of commands. 1. The job that has waited the longest for assignment is prioritised. An internal timestamp is used for this and is reassigned each time a new command is delivered for the first time. If they occur simultan- eously, preference is given to the channel with the lowest configuration number ‘j’ in the parameter master[j].log_id of P-STUP-00206. 2. If the selected client cannot execute its command despite it being assigned (e.g. a job is placed in the agent queue - because the queue is full, for example), the client must wait. All other clients also wait. No reprioritisation takes place. 3. The wait can only be interrupted by an abort (MCV_Grp Reset Forced, MC_Grp Stop), which is ex- ecuted by preference. In extreme cases without additional intervention, several active clients - i.e. several simultaneously running CNC programs - can result in the chaotic processing of competing jobs. If this is not permitted and a commanding job requires exclusive access to the commanding sequence in "its batch", it can create a "lock block". The NC commands for this are: • #LOCK and • #UNLOCK When the #LOCK command is executed, a client permanently blocks all other clients from sending their commands until #UNLOCK - or until the end of the client’s program with M30. The prioritisation described above is disabled for this time. This allows predefined job sequences in the queues of commanded channels and jobs in cooperating channels where their jobs/programs can be stored virtually "simultaneously" and deadlock-free in the agents. The lock block only affects specific Job Manager commands. All other CNC com- mands continue to be executed regardless of this. If no lock block is active, a newly commanded #LOCK command competes with all simultaneous commands in other commanding channels. The prioritisation rule de- scribed above applies. A reset/stop command from any client is always enforced regardless of an active lock block. An active lock block is then deactivated. 2.2.8 Synchronisation with agent jobs A client job can synchronise with one or more of its commanded jobs. The condition is that the "Job ID" assigned by the user at start-up via #MC_Move Path is present. One or several events are waited for with #WAIT MC_Status [Job ID=.. , …] and the known job ID. Events for #WAIT MC_Status are one or more of the four statuses MC_STARTED, MC_ABORTED, MC_ERROR, MC_DONE. If none of the parameters are specified when the call is made, this corresponds to the implicit specification of MC_DONE and MC_ABORTED. Job IDs are stored in a history in order to return a correct status in a “later” request, even after the job is terminated/aborted. If the job ID specified is unknown because it was never commanded or is no longer in the history, an error is output. TF5200 | Twin CAT 3 CNC Version: 1.0 15 Job Manager
## Page 16

Description The job ID history is deleted at program end. It is therefore no longer possible to synchronise with jobs from previous (client) jobs. It is also not possible to synchronise with jobs from another client. 2.2.9 Job Manager groups Currently, a maximum of two independent Job Managers can be configured with their own client and agent channels, whereby one or more channels can be defined as the commanding or commanded channel. A channel can only belong to one of the two Job Manager groups. As a result, a commanded channel of a Job Manager group cannot be the client of another Job Manager group at the same time. It is not possible to change the Agent or Client property or to switch from one Job Manager group to another during controller operation. Fig. 5: Assigning channels to Job Manager groups 16 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 17

Description 2.3 Application scenarios of the Job Manager The examples below use the Job Manager in different application forms. Here, a commanding channel executes the "recipe" with its program while each commanded channel performs predefined services or functions. Each of the participating channels can be used simultaneously as a fully-fledged CNC channel. 2.3.1 Multi-station operation A machine has two machining tables and a machine portal. The portal works on a workpiece or workpieces attached to one or both tables alternately or in parallel. In this configuration, the "tables" are commanding channels, where each "table" commands its machining sequence as single jobs to the agent, i.e. the portal. The two tables can be set up separately from each other and released for production. Contiguous jobs are commanded exclusively for each table by a lock block. For example, if the tool management system or tool changers are also used as independent channels, the commanding table can "simultaneously" command agents working in cooperation by means of a temporarily usable lock block. For example, tools can be provided "in advance" in the exchange position and the "in parallel commanded" CNC program of the machine portal has access to this later. This can reduce auxiliary and set-up times. The jobs commanded in the client channels correspond to a "pallet job". 2.3.2 Machining in several stations A client job starts a sequence of work steps (=jobs) on a workpiece. The Job Manager distributes this sequence to separate machining units whose functions are mainly “autonomous”. An example of a rotary indexing table would be the sequence: 1. Transport_to_1 2. Machining_1 3. Transport_1-2 4. Machining_2 5. Transport_2-x 6. … Since the jobs are stored in the job queues of the commanded channels, the client is free after sending its command. It can command further follow-up workpieces (even with a different machining sequence) until the job queue of an agent it requires reports "full” status. The agent then stops. When the station is free, the client sends its next command. Several workpieces (=jobs) are “simultaneously” machined in a machine. The job commanded in the commanding channel corresponds to a “workpiece job”. 2.3.3 Die sinking A special case of machining in multiple stations is “die sinking” (see FCT-C44]. Here, a commanding channel, i.e. the down channel, uses the Job Manager to supply two agent channels, i.e. the orbit channel and the escape channel, with coordinated NC programs. A special feature of this application is that a resulting 3-dimensional movement is created by superimposing the 2-dimensional movements of the down channel and orbit channel. The escape channel also superimposes the movements of the down channel. The job commanded in the commanding channel corresponds to a “workpiece job”. TF5200 | Twin CAT 3 CNC Version: 1.0 17 Job Manager
## Page 18

Programming 3 Programming 3.1 Job Manager NC commands The Job Manager commands and constants described below can only be executed in channels that are configured as clients. If these commands are executed in channels that are configured as agents, error ID 280611 is output. All commands are stopped until the job is successfully completed: In the case of #MC_Move Path and #MCV_Grp Reset Forced, this means placing the job in the queue; with synchronisation commands, it is when the expected status occurs. All commands and parameter names are case-sensitive. 3.2 Commanding agents A CNC program running in the commanding channel starts a job in another channel “agent” using the #MC_Move Path command. Available as of V3.1.3110 Syntax of the NC command: #MC_Move Path [SYN] [ CH=.. Job ID=.. File Name=.. @PL<1…20>=.. [Initialize On Actual Position=..] [Set Default Config=..] [Report Scene Sampling=..] [Report Run Time Measure=..] [Report Axes Position Sample=.]. ] SYN Synchronous command execution of the ISO program. Before the command is executed, an implicit channel synchronisation takes place (implicit #FLUSH WAIT). CH=.. Logical channel number of the channel in which the job is executed. The link between the CNC channel number and the CNC channels is specified in the start- up list. (See Parameter [} 36]). Job ID=.. User-specific job identification number (job ID). Every number must be unique in the commanding program of the master channel. For example, this ID is used in the #WAIT MC_Status command for job identification. File Name=<filename> Filename of the ISO program which is to be started. @P<i>=.. Parameter transfer to the commanded ISO program. These parameters can be accessed in the called “main program” by @PL<i>. Initialize On Actual Positi Requests current positions at program start. on=.. See Channel operation mode- SUPPRESS_POSITION_REQUEST If Initialize On Actual Position is not used, the current configuration specified applies. ON Request the position regardless of the current configuration. 18 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 19

Programming OFF “No position request” regardless of the current configuration. USE_ACTUAL The current configuration specified applies Set Default Config Initialises decoder working data at program start. =.. See Channel operation mode- SUPPRESS_PROG_START_INIT If Set Default Config is not used, the current configuration specified applies. ON Initialisedecoder working data. OFF Deselect initialisation of decoder working data. USE_ACTUAL The current configuration specified applies Report Scene Sample= Enables the interface to log scene data. .. See Channel operation mode- BEARB_MODE_SCENE If Report Scene Sample is not used, the current configuration specified applies. ON Log scene data. OFF Disable scene data logging. USE_ACTUAL The current configuration specified applies Report Run Time Meas Enables the interface to log time stamps. ure=.. See Channel operation mode - ONLINE_PROD_TIME If Report Run Time Measure is not used, the current configuration specified applies. ON Generate time stamp data. OFF Disable logging of time stamp data. USE_ACTUAL The current configuration specified applies Report Axes Position S Enables the interface to log axis positions. ample=.. See Channel operation mode- ON_LINE If Report Axes Position Sample is not used, the current configuration specified applies. ON Generate log data of axis positions. OFF Disable logging of axis positions. USE_ACTUAL The current configuration specified applies. Starting an NC program in another channel Start the CNC program JM-1-ch2.nc in a channel where the log_id is "1" without position request and without initialising the decoder. The transfer parameter @PL5 can be read out in the commanded channel; all other @Plx cannot. An error occurs at a read attempt. %Example MC_Move Path1 Master N010 #MC_Move Path [CH=1, Job ID = 5, File Name = "JM-1-ch2.nc", \ Initialize On Actual Position = OFF, Set Default Config = OFF \ @PL2 = 1000.5 @PL5 = 50] N020 M30 Parameters can be accessed in the JM-1-ch2.nc program. %Example MC_Move Path1 Slave „JM-1-ch2.nc“ N010 V. L. Parameter1 = @PL5 ;V. L. Parameter1 = 50 N020 X@PL2 ;Commanded X Position 1000.5 ;… After reading in #MC_Move Path, the interpretation of the CNC program is not contin- ued until the job commanded by the command is successfully stored in the job queue of the channel agent. TF5200 | Twin CAT 3 CNC Version: 1.0 19 Job Manager
## Page 20

Programming 3.3 Locking competing clients Executing the #LOCK command gives a client exclusive access. Locking access for all other clients (of the same Job Manager group) is cancelled with #UNLOCK. It is not permitted to use further #LOCK commands within a locked block or to use further #UNLOCK commands outside the lock block. If a lock block is still active at the end of the main program (M30), it is implicitly terminated and a warning is output. Syntax: #LOCK Enable exclusive access #UNLOCK Disable exclusive access The lock block only affects specific Job Manager commands. All other CNC com- mands continue to be executed regardless of this. Properties of the #LOCK command: Every new incoming #LOCK receives an initial timestamp in the controller. This timestamp is used to prioritise several (possibly already waiting) #LOCK requests. The channel with the oldest #LOCK timestamp is granted access and the lock property. If another #LOCK is pending after an #UNLOCK, the timestamp prioritisation takes effect again and enables the next oldest #LOCK. If they occur simultaneously, the channel with the lowest configuration number ‘j’ in the parameter master[j].log_id has priority (P-STUP-00206 [} 36]). 20 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 21

Programming 3.4 Waiting for the status of the commanded job The #WAIT command is used to synchronise a commanding program with a job that the client previously commanded (requested). The commanding program is stopped until the expected status occurs. If several alternative states are specified, it is enough to fulfil one of the requested statuses for the program to continue running. The last valid return value of #WAIT MC_Status can be read out by the MCV_WAIT_STATUS function and used to continue program execution. Available as of V3.1.3110 Syntax of the NC command: #WAIT MC_Status [ Job ID=.. [MC_NEW] [MC_BUSY] [MC_ACTIVE] [MC_DONE] [MC_ABORTED] [MC_ERROR] ] Job ID=.. User-specific Job ID/job identification number. Every number must be unique in the commanding program. MC_NEW New job received but not yet processed in the commanded channel. MC_BUSY New job waits for execution in the commanded channel. MC_ACTIVE The job is active in the commanded channel but was not completed. MC_DONE The job was successfully completed in the commanded channel. MC_ABORTED The job was aborted in the commanded channel before completion. An abort can be forced by a reset command, e.g. #MC_Group Reset Forced. MC_ERROR An error occurred while the job is in progress. Properties: • Job IDs are stored in a history when #WAIT MC_Status is called in order to return a correct status in a “later” request even after the job is completed/cancelled. If the job ID specified in Job ID is unknown because it was never commanded or is no longer in the history, an error is output. • The job ID history is deleted at program end. It is therefore no longer possible to synchronise with jobs from previous (client) jobs. It is also not possible to synchronise with jobs from another client. If no expected status is defined for #WAIT MC_Status, an implicit MC_DONE and MC_ABORTED apply. Waiting for job state The program starts a “Slave File”.nc program in logical channel 3 with job 633, then waits for the job to be completed with the alternative states MC_DONE, MC_ABORTED or MC_ERROR. If none of the states is reached, the program stops. %Example MC_Wait N010 #MC_Move Path SYN[ CH=3 Job ID=633 File Name=”Slave File.nc”] N020 #WAIT MC_Status [Job ID=633 MC_DONE MC_ABORTED MC_ERROR] N100 M30 3.5 Requesting the last valid status in #WAIT MC_Status After one or more previous #WAIT MC_Status [} 21] commands, the last valid return value of #WAIT MC_Status can be read out by the MCV_WAIT_STATUS function and used to continue program execution. The numerical values stored in the constants apply as return values. TF5200 | Twin CAT 3 CNC Version: 1.0 21 Job Manager
## Page 22

Programming The following constants for status are available in the CNC code: • MC_NEW • MC_BUSY • MC_ACTIVE • MC_DONE • MC_ERROR • MC_ABORTED They are used to compare a stored variable after a #MCV_WAIT_STATUS. Available as of V3.1.3110. Syntax: #MCV_WAIT_STATUS [Job ID=..] Job ID=.. User-specific Job ID/job identification number. The number must be unique in the commanding program. To call this function, it requires one or more #WAIT MC_Status commands with the same Job ID=... for the number stored in <Job ID>. If this is not the case, an error is output. Waiting for a job signal The program starts a “Slave File”.nc program in logical channel 3 with job 633, then waits for the job to be completed with the alternative states MC_DONE, MC_ABORTED or MC_ERROR. The valid state when #WAIT MC_Status is enabled can be analysed. %Example MC_Wait N010 #MC_Move Path SYN[ CH=3 Job ID=633 File Name=”Slave File.nc”] N010 #WAIT MC_Status [Job ID=633 MC_DONE MC_ABORTED MC_ERROR] N020 V. P. Mc Status = MCV_WAIT_STATUS [633] N030 $IF V. P. Mc Status != MC_DONE N040 #ERROR [ID455 MID0 RC2 PV1=V. P. Mc Status \ PV2=MC_DONE PM1=3 PM2=633] N050 $ENDIF N100 M30 3.6 Channel reset in a commanded channel The MCV_Grp Reset Forced command forces a channel reset in another channel. Available as of V3.1.3110. Syntax: #MCV_Grp Reset Forced [SYN] [CH=.. Job ID=..] SYN Synchronous command execution of the ISO program. Before the command is executed, an implicit channel synchronisation takes place (implicit #FLUSH WAIT). Without SYN the command is executed without channel synchronisation. CH=.. Logical channel number P-STUP-00208 [} 36] of the channel in which the job is executed. 22 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 23

Programming Job ID=.. User-specific job identification number(Job ID). Every number must be unique in the current commanding program of the master channel. For example, this Job ID is used in the #WAIT MC_Status [} 21] command for job identification. Executes a reset in another channel The executed program resets channel 3. %Example MCV_Grp Reset Forced N010 N030 #MCV_Grp Reset Forced SYN [ CH=3 ID=634] N020 M30 3.7 V. G. variables The state variable V. G. IP_NR is assigned in conjunction with the Job Manager. The variable is read only. The value of the variable is the logical number of the commanding channel. V. G. IP_NR returns its own logical channel number to the NC program of a commanding channel, . The variable is defined in the configuration of the Job Manager in P-STUP-00206 [} 36]. If the variable is used in a commanded channel, it returns the logical channel number of the commanding channel if the job was started by a commanding job. If the program was started directly in the commanded channel, the value of P-STUP-00208 [} 36] in the configuration is returned. TF5200 | Twin CAT 3 CNC Version: 1.0 23 Job Manager
## Page 24

Programming Fig. 6: Values of the V. G. variable V. G. IP_NR relating to the commanding and commanded channels 24 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 25

CNC objects 4 CNC objects The CNC object described below are accessible via the COM task. They represent interfaces of PLC blocks. The tables describe the initial values which can be overwritten if necessary and the corresponding input pins of the PLC blocks. 4.1 MC_Move Path + MCV_Grp Path Prepare + MCV_Grp Path Mode Object Initial value Corresponding element or constant in PLCopen mc_plco_move_path_file_name_w “” MCV_Grp Path Prepare >File Name mc_plco_move_path_fb_id_w HMI - mc_plco_move_path_jstack_count 0 2, if (0) and (1) are described _w 1, if only (0) contains valid data 0, if no Job ID data is valid mc_plco_move_path_jstack_id_0_ 0 MCV_Grp Path Prepare w >Job ID. Job ID (0) mc_plco_move_path_jstack_index 0 MCV_Grp Path Prepare _0_w mc_plco_move_path_jstack_id_1_ 0 MCV_Grp Path Prepare w >Job ID. Job ID (0) mc_plco_move_path_jstack_index 0 MCV_Grp Path Prepare _1_w >Job ID. Ifc ID.i_index [Source-ID (1)] mc_plco_move_path_parameter_w “” MCV_Grp Path Prepare >Path Parmeter mc_plco_move_path_coord_sys_w 0 - mc_plco_move_path_buffer_mode 0 - _w mc_plco_move_path_trans_mode_ 0 - w mc_plco_move_path_init_on_act_p USE_ACTUAL MCV_Grp Path Mode os_w >Initialize On Actual Position mc_plco_move_path_set_def_confi USE_ACTUAL MCV_Grp Path Mode g_w >Set Default Config mc_plco_move_path_rep_scene_s USE_ACTUAL MCV_Grp Path Mode amp_w >Report Scene Sample mc_plco_move_path_rep_ax_pos_ USE_ACTUAL MCV_Grp Path Mode samp_w >Report Axes Position Sample Writing mc_plco_move_path_file_name_w triggers the command; the other objects can be previously written in any order. 4.2 MCV_Grp Reset Force Object Initial value Corresponding element or con- stant in PLCopen mc_plco_reset_w “” 1 TF5200 | Twin CAT 3 CNC Version: 1.0 25 Job Manager
## Page 26

CNC objects Object Initial value Corresponding element or con- stant in PLCopen mc_plco_reset_fb_id_w HMI - mc_plco_reset_jstack_count_w 0 2, if (0) and (1) are described 1, if only (0) contains valid data 0, if no Job ID data is valid mc_plco_reset_jstack_id_0_w 0 Job ID. Job ID (0) mc_plco_reset_jstack_index_0_w 0 Job ID. Ifc ID.i_index [Source-ID (0)] mc_plco_reset_jstack_id_1_w 0 Job ID. Job ID (1) mc_plco_reset_jstack_index_1_w 0 Job ID. Ifc ID.i_index [Source-ID (1)] Writing mc_plco_reset_w triggers the command; the other objects can be previously written in any order. 4.3 MCV_Grp Read Job Ack Object Corresponding element or constant in PLCopen mc_plco_resp_job_state_r 0: no data read 1: data read and valid mc_plco_resp_fb_id_r Current value of HMI interface mc_plco_resp_error_id_r MCV_Grp Read Job Ack>Error ID mc_plco_resp_jstack_count_r 2, if (0) and (1) are described 1, if only (0) is described 0, if no parameter is valid mc_plco_resp_jstack_id_0_r MCV_Grp Read Job Ack>Job ID. Job ID (0) mc_plco_resp_jstack_index_0_r MCV_Grp Read Job Ack>Job ID. Ifc ID [Source-ID (0)] mc_plco_resp_jstack_id_1_r MCV_Grp Read Job Ack>Job ID. Job ID (1) mc_plco_resp_jstack_index_1_r MCV_Grp Read Job Ack>Job ID. Ifc ID [Source-ID (1)] Reading mc_plco_resp_job_state_r triggers the read operation; then the other objects each have their value. 26 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 27

PLCopen function blocks 5 PLCopen function blocks 5.1 MC_Move Path When implemented, this function block enables the execution of an NC program. The name of the file containing the NC program is specified in the data structure MC_PATH_DATA_REF. Block diagram MC_Move Path Axes Group Axes Group Path Data Path Data Execute Done Buffer Mode Busy Active Command Aborted Error Error ID Job ID Fb FB parameters VAR_IN_OUT Variable name Data type Description Axes Group AXES_GROUP_REF Axis group reference Path Data MC_PATH_DATA_REF Reference to the path description. This implementation means an NC program. VAR_INPUT Variable name Data type Description Execute BOOL Starts the command on the rising edge. Buffer Mode MC_BUFFER_MODE The input defines when a job is activated provided that other jobs are already active when the FB is commanded or are waiting for execution. It also defines the path generated at the transition between 2 jobs. The following values are possible: mc Aborting = 0 mc Buffered = 1 mc Blending Prev = 3 VAR_OUTPUT Variable name Data type Description Done BOOL NC program execution is completed. Busy BOOL TRUE indicates that the function block is executing a job. Active BOOL The command for the FB is not yet completed. Command Aborted BOOL NC program execution was aborted. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code TF5200 | Twin CAT 3 CNC Version: 1.0 27 Job Manager
## Page 28

PLCopen function blocks Job ID UDINT Ordinal number of the last job sent by the FB. Fb MCV_FB_REF Optional for use in applications with job management (MCV_Grp Read Job Ack) [} 32] This output is available as of CNC Build V3.1.3103.1. 28 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 29

PLCopen function blocks 5.2 MCV_Grp Path Mode This function block is available as of CNC Build V3.1.3103.1. The function block is used for entering options to execute a job to be started in the data structure MCV_PATH_MODE of the "Path Mode" output. The output is linked to the “Path Mode” input of an instance of the type MCV_Grp Path Prepare [} 30]. Block diagram MCV_Grp Path Mode Execute Done Initialize On Actual Position Error Set Default Config Error ID Report Scene Sample Path Mode Report Run Time Measure Report Axes Position Sample FB parameters VAR_INPUT Variable name Data type Description Execute BOOL On the rising edge at the input, the values of the input pins referring to start options are entered in a data structure of the type PATH_MODE and output at the Path Mode output. Initialize On Actual Positi MCV_START_MODE on Set Default Config MCV_START_MODE Report Scene Sample MCV_START_MODE Report Run Time Measur MCV_START_MODE e Report Axes Position Sa MCV_START_MODE mple VAR_OUTPUT Variable name Data type Description Done BOOL TRUE indicates that the values of the start options at the Path Mode output are available in a structure of the type MCV_PATH_MODE. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code Path Mode MCV_PATH_MODE Parameter for program mode of a job TF5200 | Twin CAT 3 CNC Version: 1.0 29 Job Manager
## Page 30

PLCopen function blocks 5.3 MCV_Grp Path Prepare This function block is available as of CNC Build V3.1.3103.1. The function block is used to transfer job data, program parameters and program modes to a data structure of the MC_PATH_DATA_REF type. This structure is output at the Path Data output and must be transferred to the corresponding input of an MC_Move Path [} 27] instance. The function block inputs can be written by the user. Alternatively, the function block can be linked to the outputs of an MCV_Grp Get Job Request instance to forward jobs generated by an HMI or another NC channel, for example. The structure MC_PATH_DATA_REF may only be described by instances of the type MCV_Grp Path Prepare. This ensures that future changes to the library have no im- pacts on existing PLC programs. What remains permitted is the direct entry of a name or path for an NC program on MC_PATH_DATA_REF. Existing PLC applications can then be used unchanged without job management or parameterisation. In this case, it is not permitted to use MCV_Grp Path Prepare. Block diagram MCV_Grp Path Prepare Execute Done File Name Error Job ID Error ID Path Parameter Path Data Path Mode Buffer Mode Out Buffer Mode In Job Stack Job Attribute FB parameters VAR_INPUT Variable name Data type Description Execute BOOL The function block is executed on a rising edge at the input. File Name STRING(MCV_PROG_NAM Program name of a job. E_STRLEN) Job ID MCV_GRP_JOB_ID Job information Path Parameter MCV_PATH_PARAM Program parameters of a job. Parameters can be accessed in the called NC program (File Name). PL[0] corresponds to the variable @PL1 and PL[19] corresponds to the variable @PL20. Unused parameters are prefixed by “0”. Path Mode MCV_PATH_MODE Parameter for program mode of a job. The following are available: 30 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 31

PLCopen function blocks - Initialize On Actual Position, - Set Default Config, - Report Scene Sample, - Report Run Time Measure, - Report Axes Position Sample where 0 = HLI_MC_START_MODE_NOT_USED 1 = HLI_MC_START_MODE_OFF 2 = HLI_MC_START_MODE_ON 3 = HLI_MC_START_MODE_USE_ACTUAL Buffer Mode In MC_BUFFERMODE Buffer Mode of a job. The following values (similar to the Buffer Mode interface in the MC_Move Path [} 27]) are possible: mc Aborting= 0 mc Buffered= 1 mc Blending Prev= 3 Job Stack HLI_MC_JOB_STACK Information on the job source Only needed if the job was read in by an instance of the MCV_Grp Get Job Request. Otherwise, the input must remain unassigned. Job Attribute UDINT Identification number which is freely assignable by the user. VAR_OUTPUT Variable name Data type Description Done BOOL TRUE indicates that the data structure MC_PATH_DATA_REF was correctly filled out and can be transferred together with the value of the "Buffer Mode Out” output to an instance of the MC_Move Path [} 27] function block. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code Path Data MC_PATH_DATA_REF Structure for use at the “Path Data” input of an instance of the MC_Move Path [} 27]. Buffer Mode Out MC_BUFFERMODE Buffer Mode for use at the “Buffer Mode” input of an instance of the MC_Move Path function block. TF5200 | Twin CAT 3 CNC Version: 1.0 31 Job Manager
## Page 32

PLCopen function blocks 5.4 MCV_Grp Read Job Ack This function block is available as of CNC Build V3.1.3103.1. The function block is used to evaluate the end or abort operations of jobs commanded by an MC_Move Path [} 27] . The instance of the MC_Move Path [} 27] whose job acknowledgements are evaluated is identified via the “Fb” input. When the function block is created and the “Enable” input is set to TRUE, the func- tion block must be called cyclically. Otherwise, job acknowledgements to any func- tion blocks are blocked, even to other PLCopen Part 4 function blocks. Block diagram MCV_Grp Read Job Ack Enable Valid Ack Error Fb Error ID Job ID Job State Job Stack Job Attribute FB parameters VAR_INPUT Variable name Data type Description Enable BOOL As long as “Enable” is TRUE, job acknowledgements are read. Only acknowledgements are displayed if they refer to jobs sent by the instance of an MC_Move Path [} 27] registered at the “Fb” input. New acknowledgements are then only displayed if the “Ack” input is FALSE. Ack BOOL The input defines that the information indicated at the function block outputs was read. Fb MCV_FB_REF Reference to an instance of an MC_Move Path [} 27] function block with the output of the same type. VAR_OUTPUT Variable name Data type Description Valid BOOL TRUE indicates that new data is ready to be fetched. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code Job ID MCV_GRP_JOB_INFO Job description and job state. Job State : MCV_JOB_STATE Job information Job Stack HLI_MC_JOB_STACK Information on the job source Only needed if the job is to be read by an instance of the MCV_Grp Set Job Response. Job Attribute UDINT Identification number specified by the user and output together with the state of a job. 32 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 33

PLCopen function blocks 5.5 MCV_Grp Read Job Status List This function block is available as of CNC Build V3.1.3103.1. The function block is used to display the states of all jobs currently commanded for an axis group. Block diagram MCV_Grp Read Job Status List Axes Group Axes Group Enable Valid Error Error ID Status List FB parameters VAR_IN_OUT Variable name Data type Description Axes Group AXES_GROUP_REF Axis group reference VAR_INPUT Variable name Data type Description Enable BOOL If the input is TRUE, the function block outputs are updated. VAR_OUTPUT Variable name Data type Description Valid BOOL TRUE indicates that the requested update was executed. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code Status List MCV_GRP_JOB_DISPLAY Structure that describes the states of all current MC_Move Path [} 27] commands in a channel. 5.6 MCV_Grp Reset Forced This function block is available as of CNC Build V3.1.3103.1. The function block leads to a controlled motion stop. It aborts every ongoing command by other motion FBs. The axis group changes to the “Group Stopping” state until velocity 0 is reached. If the “Done” and “Execute” outputs are set to FALSE, the axis group state changes to “Group Standby”. The function block is not interruptible. In addition to the motion stop which is implemented identically to the MC_Grp Stop [} 35], this FB reverts the axis group to its initial state. Block diagram TF5200 | Twin CAT 3 CNC Version: 1.0 33 Job Manager
## Page 34

PLCopen function blocks MCV_Grp Reset Forced Axes Group Axes Group Execute Done Buffer Mode Busy Active Command Aborted Error Error ID Job ID FB parameters VAR_IN_OUT Variable name Data type Description Axes Group AXES_GROUP_REF Axis group reference VAR_INPUT Variable name Data type Description Execute BOOL Starts the command on the rising edge. Buffer Mode MC_BUFFER_MODE The input defines when a job is activated provided that other jobs are already active when the FB is commanded or are waiting for execution. The following modes are supported: mc Aborting = 0 mc Buffered = 1 VAR_OUTPUT Variable name Data type Description Done BOOL TRUE indicates that 0 velocity was reached. The axes are at standstill. Busy BOOL TRUE indicates that the function block is executing a job. Active BOOL The command is not yet completed. Command Aborted BOOL The command to stop was aborted by another command. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code Job ID UDINT Ordinal number of the last job sent by the FB. 34 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 35

PLCopen function blocks 5.7 MC_Grp Stop The function block leads to a controlled motion stop. It aborts every ongoing command by other motion FBs. The axis group changes to the “Group Stopping” state until velocity 0 is reached. If the “Done” and “Execute” outputs are set to FALSE, the axis group state changes to “Group Standby”. The function block is not interruptible. Block diagram MC_Grp Stop Axes Group Axes Group Execute Done Buffer Mode Busy Active Command Aborted Error Error ID Job ID FB parameters VAR_IN_OUT Variable name Data type Description Axes Group AXES_GROUP_REF Axis group reference VAR_INPUT Variable name Data type Description Execute BOOL Starts the command on the rising edge. Buffer Mode MC_BUFFER_MODE The input defines when a job is activated provided that other jobs are already active when the FB is commanded or are waiting for execution. The following modes are supported: mc Aborting = 0 mc Buffered = 1 VAR_OUTPUT Variable name Data type Description Done BOOL TRUE indicates that 0 velocity was reached. The axes are at standstill. Busy BOOL TRUE indicates that the function block is executing a job. Active BOOL The command is not yet completed. Command Aborted BOOL The command to stop was aborted by another job. Error BOOL TRUE indicates that an error occurred. Error ID WORD Error code Job ID UDINT Ordinal number of the last job sent by the FB. TF5200 | Twin CAT 3 CNC Version: 1.0 35 Job Manager
## Page 36

Parameter 6 Parameter P-STUP-00206 Logical ID of a client channel in a Job Manager group Description The parameter defines the logical ID of a client channel. This logical ID can be requested in the agent channel by V. G. IP_NR. Due to the necessary uniqueness, no second agent channel may use the same logical ID in the same Job Manager group. Parameter jobmanager.group[i].master[j].log_id where i = 0, 1 (index of the Job Manager group, max. 1) where j = 0 … n (index of a continuous list element. n: application-specific) Data type UNS16 Data range 1 … 65536 Dimension ---- Default value 0 Remarks Available as of V3.1.3110 IMPORTANT: If the agent is not commanded by a client, the call of "V. G. IP_NR" returns the "log_id" of the agent. P-STUP-00207 Logical ID of a client channel in a Job Manager group Description The client channel (master) designated by this parameter in a Job Manager group corresponds to an existing CNC channel. It cannot be assigned to any other group, neither as an agent (slave) nor as a client (master) The number used must correspond to an existing channel number. Parameter jobmanager.group[i].master[j].channel_id (application-specific) where i = 0, 1 (index of Job Manager group, max. 1) where j = 0..n (index of a continuous list element. n: application-specific) Data type UNS16 Data range 1 to 12 (application-specific) Dimension ---- Default value 0 * Remarks Available as of V3.1.3110 * The value corresponds to the statement: Parameter is not used. If all jobmanager. group[i].master[j].channel_id parameters in a Job Manager group are "0", the Job Manager is deactivated for the group. The client channel corresponds to a “normal” channel. The Job Manager configuration extends the command set to include Job Manager commands [} 18] (see [FCT-M10] [} 6]). This also includes commanding all agents (slaves) in the same Job Manager group with jobs. P-STUP-00208 Logical ID of an agent channel in a Job Manager group Description The parameter defines the logical ID of an agent channel. Every agent (slave) in a Job Manager group is invoked by commands from the client by its logical ID "log_id” at the start. Due to the necessary uniqueness, no second agent channel may use the same logical ID in the same Job Manager group. Parameter Jobmanager.group[i].cnc_slave[j].log_idwhere where i = 0, 1 (index of Job Manager group, max. 1) where j = 0..n (index of a continuous list element. n: application-specific) Data type UNS16 Data range 1 … 65536 Dimension ---- Default value 0 Remarks Available as of V3.1.3110 There are two types of agent: CNC channels and PLC units. The logical ID always refers to a particular type 36 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 37

Parameter P-STUP-00209 Agent channel in a Job Manager group Description The agent channel (slave) designated by this parameter in a Job Manager group corresponds to an existing CNC channel. It cannot be assigned to any other group, neither as an agent (slave) nor as client (master). The number used must correspond to an existing channel number. Parameter jobmanager.group[i]. cnc_slave[j].channel_id (application-specific) where i = 0, 1 (index of Job Manager group, max. 1) where j = 0..n (index of a continuous list element. n: application-specific) Data type UNS16 Data range 1 … (application-specific) Dimension ---- Default value 0 Remarks Available as of V3.1.3110 The agent channel behaves like a "normal" channel. It has the additional property of being requested by any master in the same Job Manager group to execute a job. Job completion is signalled back to the client in the controller. P-STUP-00210 Logical ID of agent PLC unit in a Job Manager group Description The parameter defines the logical ID of an agent PLC unit. Every PLC agent (slave) in a Job Manager group is invoked by commands from the client by its logical ID "log_id”. Due to the necessary uniqueness, no second agent PLC unit may use the same logical ID in the same Job Manager group. Parameter jobmanager.group[i]. Plc_slave[j].log_id where i = 0, 1 (index of the Job Manager group, max. 1) where j = 0…n (index of a continuous HLI list element. n: application-specific) Data type UNS16 Data range 1 … 65536 Dimension ---- Default value 0 Remarks Available as of V3.1.3110 P-STUP-00211 Agent PLC unit in a Job Manager group Description The agent PLC unit (slave) in a Job Manager group designated by this parameter corresponds to an interface on the HLI. After assignment it cannot be assigned to any other group. Parameter jobmanager.group[i].hli_index (application-specific) where i = 0, 1 (index of the Job Manager group, max. 1) where j = 0..n (index of a continuous HLI list element n: application-specific) Data type UNS08 Data range 0 to 31 (application-specific) Dimension ---- Default value 0 Remarks Available as of V3.1.3110 An agent PLC unit has the property of being requested by any master in the same Job Manager group to execute a job. Job completion is signalled back to the client in the controller. P-STUP-00212 Parameter list of an agent PLC unit in a Job Manager group Description The agent PLC unit (slave) in a Job Manager group can receive parameters from the client at the start. The data structure described a declared parameter list in "jobmanager.coding[i].list" (P-STUP-00204). The parameter required here corresponds to the index [i] in "jobmanager.coding[i].list". TF5200 | Twin CAT 3 CNC Version: 1.0 37 Job Manager
## Page 38

Parameter Parameter Jobmanager.group[i].plc_slave[j].coding where i = 0, 1 (index of the Job Manager group, max. 1) where j = 0..n (index of a continuous HLI list element n: application-specific) Data type UNS08 Data range 0 to 2 (application-specific) Dimension ---- Default value 0 Remarks Available as of V3.1.3110 38 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 39

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5200 | Twin CAT 3 CNC Version: 1.0 39 Job Manager
## Page 40

Index Index D D-MCP-P4- MCV_Grp Read Job Ack 32 D-MCP-P4- MCV_Grp Reset Forced 34 D-MCP-P4-MC_Grp Stop 35 D-MCP-P4-MC_Move Path 27 D-MCP-P4-MCV_Grp Path Mode 29 D-MCP-P4-MCV_Grp Path Prepare 30 D-MCP-P4-MCV_Grp Read Job Status List 33 M MC_Grp Stop 35 MC_Move Path 27 MCV_Grp Path Mode 29 MCV_Grp Path Prepare 30 MCV_Grp Read Job Ack 32 MCV_Grp Read Job Status List 33 MCV_Grp Reset Forced 34 P P-STUP-00206 36 P-STUP-00207 36 P-STUP-00208 36 P-STUP-00209 37 P-STUP-00210 37 P-STUP-00211 37 P-STUP-00212 37 40 Version: 1.0 TF5200 | Twin CAT 3 CNC Job Manager
## Page 42

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
