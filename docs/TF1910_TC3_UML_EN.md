---
title: "TF1910 Twin CAT 3"
product: "TF1910"
category: "Fundamentals"
tags: ["CAT", "TWIN"]
language: "EN"
document_type: "Manual"
version: "2.8.2"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF1910_TC3_UML_EN.pdf"
release_date: "2025-03-27"
---
Manual | EN TF1910 Twin CAT 3 | UML 2025-03-27 | Version: 2.8.2

## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 6 1.3 Notes on information security............................................................................................................ 7 1.4 Information on the security risk analysis........................................................................................... 8 2 Overview.................................................................................................................................................... 9 3 Installation............................................................................................................................................... 10 3.1 Licensing......................................................................................................................................... 10 3.2 System requirements...................................................................................................................... 11 4 Settings.................................................................................................................................................... 12 4.1 Options............................................................................................................................................ 12 4.2 UML compiler version..................................................................................................................... 14 5 Commands............................................................................................................................................... 18 5.1 Create bitmap.................................................................................................................................. 18 5.2 Grid Enabled................................................................................................................................... 19 5.3 Grid Disabled.................................................................................................................................. 19 6 UML class diagram................................................................................................................................. 20 6.1 Basic principles............................................................................................................................... 20 6.2 Commands...................................................................................................................................... 22 6.2.1 Creating a new class diagram.......................................................................................... 22 6.2.2 Adding existing elements to a diagram............................................................................ 23 6.2.3 Editing a class diagram.................................................................................................... 25 6.3 Editor............................................................................................................................................... 27 6.4 Elements......................................................................................................................................... 28 6.4.1 Class................................................................................................................................ 28 6.4.2 Interface........................................................................................................................... 34 6.4.3 Global Variable List.......................................................................................................... 37 6.4.4 User-defined data type..................................................................................................... 39 6.4.5 Variable declaration......................................................................................................... 42 6.4.6 Property............................................................................................................................ 42 6.4.7 Method............................................................................................................................. 43 6.4.8 Action............................................................................................................................... 44 6.4.9 Composition..................................................................................................................... 44 6.4.10 Association....................................................................................................................... 47 6.4.11 Implementation................................................................................................................. 49 6.4.12 Generalization.................................................................................................................. 51 6.4.13 Note.................................................................................................................................. 53 7 UML state diagram.................................................................................................................................. 55 7.1 Basic principles............................................................................................................................... 55 7.2 Commands...................................................................................................................................... 58 7.2.1 Creating a new Statechart................................................................................................ 58 7.2.2 Editing Statechart............................................................................................................. 59 7.2.3 Go to definition................................................................................................................. 62 TF1910 Version: 2.8.2 3

## Page 4

Table of contents 7.2.4 Find All References.......................................................................................................... 62 7.2.5 Add Watch........................................................................................................................ 62 7.3 Editor............................................................................................................................................... 62 7.4 Elements......................................................................................................................................... 63 7.4.1 Start State........................................................................................................................ 63 7.4.2 End State......................................................................................................................... 64 7.4.3 State................................................................................................................................. 64 7.4.4 Composite State............................................................................................................... 68 7.4.5 Fork.................................................................................................................................. 78 7.4.6 Choice.............................................................................................................................. 80 7.4.7 Transition......................................................................................................................... 81 7.4.8 Completion Transition...................................................................................................... 83 7.4.9 Exception Transition......................................................................................................... 84 7.4.10 Note.................................................................................................................................. 87 7.5 Object Properties............................................................................................................................ 88 7.6 Online Mode.................................................................................................................................... 89 8 FAQ........................................................................................................................................................... 92 9 Samples................................................................................................................................................... 94 9.1 UML class diagram......................................................................................................................... 94 9.1.1 1 Basics............................................................................................................................ 94 9.1.2 2 Simple machine............................................................................................................. 94 9.2 UML state diagram.......................................................................................................................... 95 9.2.1 1 Lamp............................................................................................................................. 95 9.2.2 2 Pedestrian traffic light.................................................................................................... 96 9.2.3 3 Save Text simulation...................................................................................................... 96 9.2.4 4 Call Behavior - Basis..................................................................................................... 98 9.2.5 5 Call behavior - transition action................................................................................... 101 10 Support and Service............................................................................................................................. 104 4 Version: 2.8.2 TF1910

## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS®, and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. TF1910 Version: 2.8.2 5

## Page 6

Foreword 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 2.8.2 TF1910

## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF1910 Version: 2.8.2 7

## Page 8

Foreword 1.4 Information on the security risk analysis If you have installed this product, Beckhoff will provide you with the following information for a security risk analysis of your system. Engineering Workload: Twin CAT. Standard. XAE Only the standard stated workload needs to be installed in order to be able to use the engineering components of the TF1910 function. See also: • Information on the security risk analysis of the Twin CAT standard XAE workload Runtime Workload: Twin CAT. Standard. XAR Only the standard stated workload needs to be installed in order to be able to use the runtime components of the TF1910 function. See also: • Information on the security risk analysis of the Twin CAT standard XAR workload 8 Version: 2.8.2 TF1910

## Page 9

Overview 2 Overview UML: general information Unified Modeling Language (UML) is a graphical language that can be used for software analysis, design and documentation. UML is particularly suitable for object-oriented implementations. The unified modelling of the PLC application creates an easy-to-follow software documentation that can also be analyzed and discussed by departments other than the Software Development Dept. Diagram categories Some of the UML diagrams can be categorized as structure diagrams, others as behavior diagrams. Structure diagram are mainly used for static modelling and analysis, since they represent the software architecture schematically. Behavior diagrams are used for dynamic modelling. They are executable models, from which program code can be generated directly. UML in Twin CAT 3.1 PLC With the integration of UML (Unified Modelling Language) in Twin CAT 3.1, two additional editors for modelling of PLC software are available. The existing Twin CAT PLC programming languages are extended by the UML classes and the UML Statechart. • : the functionality of the object UML class diagram • : Programming a POU in the implementation language UML Statechart UML class diagram The UML class diagram belongs to the group of UML structure diagrams and can be used for schematic representation of the software architecture. In this way it is possible to represent object classes and the elements contained within them, as well as object relationships in a transparent manner. UML Statechart The UML Statechart is part of the UML behavior diagrams and is used for dynamic software modeling. It can be used for a graphic specification of the dynamic response or the state-dependent system behavior. Compilation of the statechart generates program code, so that the state machine can be executed directly. The development process is supported by an online debugging option. Advantages There are many advantages to using UML diagrams for the analysis, design and/or documentation of software. The essential aspects are covered in the following points: • First of all, a graphic illustration that doesn't focus on technical details offers a good overview with which to check software requirements before the implementation. This avoids an incomplete or erroneous implementation of the application. • The development of a well-conceived software architecture is greatly supported by the graphic illustration of the control code. Such an architecture forms the basis for the simple and goal-oriented implementation of even complex systems or requirements. Furthermore, a well-conceived software architecture can contribute towards the development of autonomous modules that can be reused, saving time and costs. In general, a well-planned software leads as a rule to fewer programming errors and thus to a higher code quality. • Graphic access to the software facilitates maintenance and debugging. • An generally understandable documentation of the software is usually created with the help of UML diagrams. On the one hand this can be used as a coordination tool in the development team, for example to exchange ideas and concepts or to define requirements. On the other, UML diagrams can be used to illustrate the control application to other technology specialists, for example mechanical engineers or process technicians. TF1910 Version: 2.8.2 9

## Page 10

Installation 3 Installation The “TF1910 | Twin CAT 3 UML” function is already installed together with the installation of the Twin CAT 3 development environment/runtime. Accordingly, there is no separate TF1910 setup/package. Distinction between engineering and runtime: The standard engineering workload contains the following components, which can be used directly after installation (no licensing required): • the engineering components for the UML class diagram • the engineering components for the UML state diagram The standard runtime workload contains: • the runtime components for the UML state diagram Information on licensing the runtime components can be found under Licensing [} 10]. Twin CAT Package Manager: Installation (Twin CAT 3.1 Build 4026) Detailed instructions on installing products can be found in the chapter Installing workloads in the Twin CAT 3.1 Build 4026 installation instructions. Install the following workload to be able to use the product: • Engineering: Twin CAT. Standard. XAE • Runtime: Twin CAT. Standard. XAR Twin CAT setup: Installation (Twin CAT 3.1 Build 4024 and earlier) Install the following setup in order to be able to use the product: • Engineering + Runtime: Twin CAT 3.1 e Xtended Automation Engineering (XAE) (full installation) • Runtime: Twin CAT 3.1 e Xtended Automation Runtime (XAR) Detailed installation instructions can be found in the Installation Twin CAT 3.1 Build 4024 chapter. 3.1 Licensing The engineering-side use of the UML class and state diagram is possible free of charge without a license. You will require the TF1910 runtime license for the additional runtime component UML state diagram. See also the documentation on Licensing. Test mode You can test the UML state diagram with a 7-day trial license without the license for TF1910. You can continuously regenerate the trial license during the test phase. See also the documentation on the Twin CAT 3 trial licenses. 10 Version: 2.8.2 TF1910

## Page 11

Installation 3.2 System requirements UML class diagram => Engineering (XAE) Technical data Requirements Operating system • Windows 10 • Windows 11 Target platform • x86 • x64 Twin CAT Version Twin CAT 3.1.4018.16 and above Required Twin CAT license - UML state diagram => Engineering (XAE) + Runtime (XAR) Technical data Engineering (XAE) Runtime (XAR) Operating system • Windows 10 • Windows 10 • Windows 11 • Windows 11 • Windows CE • Twin CAT/BSD Target platform • x86 • x86 • x64 • x64 • Arm® Twin CAT Version Twin CAT 3.1.4016.0 and above Required Twin CAT license TF1910 runtime license TF1910 Version: 2.8.2 11

## Page 12

Settings 4 Settings 4.1 Options In the Twin CAT UML options (Tools > Options >Twin CAT > PLC Environment > UML) you can configure the settings relating to the UML editors for the entire project. Modified options take effect when the dialog is closed, even in UML editors that are already open. General Contact spacing Grid line spacing in pixels. Default: 10 Hook onto the grid (default): Elements in the UML editors are aligned to the grid when the position is changed. : Elements in the UML editors are not aligned to the grid when the position is changed. This setting can also be changed using a command in the editor. Display grid points : The grid is visible in the editor as a grid of points. (default): The grid is not visible in the editor. Note element: If the text to be displayed is longer than the defined size of the Note element, ellipses (...) are displayed. In these cases, the tooltip of the Note element displays the full text. Maximum width Maximum number of pixels that can be displayed in a line. Minimum value: 100 Maximum value: 2000 Default: 300 Maximum number of Number of lines that are displayed in the Note element. lines Minimum value: 1 Maximum value: 100 Default: 10 See also: Settings tab State diagram Position Condition and : A guard condition and an action belonging to the same transition are always Action of a relation repositioned together in the diagram. together (default): A guard condition and an action can be positioned independently of each other in the diagram. 12 Version: 2.8.2 TF1910

## Page 13

Settings Class diagram Show prompt when (default): When using the command to remove the selected elements from deleting objects from the diagram, a query dialog with the following options appears first: diagram • Remove from diagram • Remove from project and diagram (no undo possible) : When using the command to remove the selected elements, they are only deleted from the diagram. The elements remain in the project. Skip refactoring preview : If refactoring is initiated in the diagram, the project-wide change is made without first opening the Refactoring dialog with a preview of all change points. (default): When refactoring is initiated in the diagram, the Refactoring dialog opens with a preview of all change points. Hide variables: Available from TC3.1 Build 4026 To reduce the amount of information within the class diagram to the desired focus, the following options are available. Hide internal variables Internal variables have one of the following scopes: VAR, VAR_TEMP, VAR_STAT, VAR_INST : All internal variables are hidden in the programming objects in the class diagram. (default): Internal variables are displayed. Hide signature variables Signature variables have one of the following scopes: VAR_INPUT, VAR_OUTPUT, VAR_IN_OUT, VAR_EXTERNAL : All signature variables are hidden in the programming objects in the class diagram. (default): Signature variables are displayed. Hiding POU components according to access level: Available from Twin CAT 3.1.4026.12 The following options can be used to hide or show access modifiers for methods, actions, transitions and properties. Components with an access modifier with a lower access level are shown or hidden in each case The priority of the access levels in descending order is as follows: • INTERNAL • PROTECTED • PRIVATE TF1910 Version: 2.8.2 13

## Page 14

Settings Hide PRIVATE : All POU components with the access modifier PRIVATE are hidden in the components class diagram. (default): POU components with the access modifier PRIVATE are displayed. If this option is disabled, the following three options (PROTECTED, INTERNAL, all) are also automatically disabled. Hide PROTECTED : All POU components with the access modifier PROTECTED are hidden in the components class diagram. If this option is enabled, the previous option (PRIVATE) is automatically enabled as well. (default): POU components with the access modifier PROTECTED are displayed. If this option is disabled, the following two options (INTERNAL, all) are also automatically disabled. Hide INTERNAL : All POU components with the access modifier INTERNAL are hidden in the components class diagram. If this option is enabled, the previous two options (PRIVATE, PROTECTED) are automatically enabled as well. (default): POU components with the access modifier INTERNAL are displayed. If this option is disabled, the following option (all) is also automatically disabled. Hide all components : All POU components are hidden in the class diagram. If this option is enabled, the previous three options (PRIVATE, PROTECTED, INTERNAL) are automatically enabled as well. (default): Not all POU components are hidden. Whether some components are hidden depends on the other options. Hiding POU components by type: Available from Twin CAT 3.1.4026.12 Hide METHODS : All methods are hidden in the class diagram. (default): Methods are displayed in the class diagram. Hide ACTIONS : All actions are hidden in the class diagram. (default): Actions are displayed in the class diagram. Hide PROPERTIES : All properties are hidden in the class diagram. (default): Properties are displayed in the class diagram. 4.2 UML compiler version The UML compiler version can be changed in the following dialogs: • PLC project properties • Profile Update dialog In addition, the following option is available with regard to the UML compiler version: • Autoupdate UML Profile 14 Version: 2.8.2 TF1910

## Page 15

Settings The UML compiler version is only relevant if the UML Statechart language is used. Scope of the setting “UML compiler version” The setting of the UML compiler version is a “solution option” and therefore does not only affect the PLC project, whose properties you are currently configuring, i.e. set UML compiler version applies to all PLC projects in the development environment. PLC project properties You can change the UML compiler version in the properties of the PLC project. Open the PLC project properties and click on the category UML. • UML compiler version in project: Indicates the UML compiler version currently used in the project. • Recommended, newest version: Indicates the latest available UML compiler version, whose application is recommended. • Action: In this dropdown menu you can select the required action. The action is executed directly when you select it. Example actions: ◦ Do not update. ◦ Update to 4.0.2.1 Profile Update dialog If you open a PLC project, in which an outdated UML compiler version is used, a corresponding warning appears in the message window (“New version found for UML”). Double-click this warning to open the Profile Update dialog, in which you can change the UML compiler version. TF1910 Version: 2.8.2 15

## Page 16

Settings • UML compiler version in project: Indicates the UML compiler version currently used in the project. • Recommended, newest version: Indicates the latest available UML compiler version, whose application is recommended. • Action: In this dropdown menu you can select the required action. The action is executed when the dialog is confirmed via OK. Example actions: ◦ Do not update. ◦ Update to 4.0.2.1 • Set all to newest: Click the button to set the UML compiler version to the latest version. Autoupdate UML Profile The option Autoupdate UML Profile is available in the Advanced category of the PLC project properties. It can be used to configure the automatic update behavior of the UML compiler version. If you open a PLC project, in which an outdated UML compiler version is used, a corresponding warning appears in the message window (“New version found for UML”). : In such a case, the UML compiler version is automatically set to the latest version, if the option Autoupdate UML profile is enabled. On such an automatic update of the UML compiler version, the message window shows a corresponding warning (e.g. “UML set from '4.0.2.0' to '4.0.2.1'”). 16 Version: 2.8.2 TF1910

## Page 17

Settings : If the option Autoupdate UML Profile is disabled, the UML compiler version is not changed automatically. Double-click on the warning “New version found for UML” to open the Profile Update dialog [} 15], in which you can change the UML compiler version manually. TF1910 Version: 2.8.2 17

## Page 18

Commands 5 Commands Common commands for all UML diagrams If a UML diagram is selected in the project tree, the following command is available in the context menu: • Generate bitmap from the selected UML diagram [} 18] The alignment of the elements relative to a grid can be enabled or disabled within the editor of a UML diagram. • Grid activated [} 19] • Grid deactivated [} 19] 5.1 Create bitmap The Create bitmap command is available when • the focus is on the project tree, and • a class diagram or state diagram is selected in the project tree and the context menu is open Use the command to create a bitmap from of a class diagram or state diagram in BMP, PNG or JPG format and to save it in your file system. When you execute the Create bitmap command, the associated dialog opens. This dialog offers the following configuration options. Size of the longer side (in pixels): • The value displayed refers to the edge length of the bitmap. Depending on the layout of the UML diagram, the bitmap is exported either in landscape or portrait format. If the diagram is in landscape format, the value contains the length of the bitmap. If the diagram is in portrait format, the value contains the height of the bitmap. Save bitmap to desktop: • : If this option is enabled, the object name is used as the file name, e.g. "FB_UML_SC.bmp" for an object with the name "FB_UML_SC". The BMP format is used as the file type. ◦ If you confirm the setting with [ OK ], the bitmap is saved on the desktop. Notice With this option, any existing files with this name on the desktop are overwritten without warning. ◦ Use [ Cancel ] to terminate the dialog without saving. • : The name, directory and format of the bitmap can be edited. ◦ Confirming the setting with [ OK ] opens the standard dialog for saving a file. Enter a directory and file name there, select BMP, PNG or JPG as the format and exit the dialog with [ Save ]. The bitmap is saved in your file system. Access by Automation Interface: The Create bitmap command is reachable using the Consume XML method on the POU node via Automation Interface. <Tree Item> <Plc Pou Def> <Commands> <Create Bitmap Command> <Active>true</Active> <Parameters> <File Name>d:\tmp\Bitmap.png</File Name> <Width>1200</Width> <Height>-1</Height> (* -1 adapts the height to the width to keep the ratio; alternatively, you can enter a fix height which might deform the bi tmap *) 18 Version: 2.8.2 TF1910

## Page 19

Commands </Parameters> </Create Bitmap Command> </Commands> </Plc Pou Def> </Tree Item> 5.2 Grid Enabled Symbol: If this command is available in the context menu of a focused class diagram or statechart, an element is aligned along the grid when changing its position. The option Snap to grid with grid space in the Twin CAT UML options (Extras > Options > PLC Environment > UML) is ticked. If you perform the command, the diagram will switch to Grid disabled. The option won't be ticked. See also: • “Grid Disabled” [} 19] • “Options [} 12]” 5.3 Grid Disabled Symbol: If this command is available in the context menu of a focused class diagram or statechart, an element is positioned without a grid when changing its position. Snap to grid with grid space in the Twin CAT UML options (Extras > Options > PLC Environment > UML) is not ticked. If you perform the command, the diagram will switch to Grid enabled. The option will be ticked. See also: • “Grid Enabled” [} 19] • “Options [} 12]” TF1910 Version: 2.8.2 19

## Page 20

UML class diagram 6 UML class diagram In addition to the following information, please also note the samples [} 94] that give a first introduction to the tool. 6.1 Basic principles The UML class diagram can be used to document, analyze, design and expand the structure of a (sophisticated) system. In the process, classes can be designed and relationships between them can be mapped. The clear representation of PLC program elements includes, among other things, inheritance and implementation relationships, so as to clearly visualizing interrelationships. A UML class diagram is therefore ideal for graphical system documentation and offers a comprehensible basis for conveying technical content. The class diagram editor provides elements that map the object orientation of the project. Since the editor is embedded in the PLC area of the Twin CAT 3 development environment, automatic generation of code is possible. An extensive range of features and tools is integrated. The class diagram can be used in two directions. The existing project structure can be imported into the class diagram, or selected elements of the existing project structure can be added to the class diagram. As a result, the already existing software architecture can be documented and analyzed. Secondly, the class diagram offers the possibility to change and expand existing PLC elements or the existing project structure. This modification can be carried out with the aid of the class diagram editor [} 27] and the associated elements [} 28] of the toolbox. These allow the software architecture to be changed and expanded and at the same time to be documented and analyzed. Terms from the object orientation Synonym in IEC 61131-3 or in Twin CAT 3.1 Class (UML: class) POU types: • Program (PRG): PROGRAM • Function block (FB): FUNCTION_BLOCK • Function (FUN): FUNCTION Attribute (UML: attribute) Variable types: • Internal variable • Variables: VAR • Parameter: {input} • Input variables: VAR_INPUT • Property: {property} • Property: PROPERTY • Output parameter: {output} • Output variables: VAR_OUTPUT Operation (UML: operation) • Method: METHOD • Action Interface (UML: interface) Interface: INTERFACE Global variable list (GVL): VAR_GLOBAL User-defined data type (DUT): TYPE Synchronicity Objects in the class diagram and the project are kept identical, so that user inputs affect both views. This means the corresponding objects in the project tree are changed automatically when objects are changed via the class diagram. On the other hand, modifications in the project tree automatically become visible in the class diagram, if the corresponding objects are shown in the class diagram. Application options In general, the following applies: • Not all elements of a project have to be shown in the class diagram. • Several class diagrams can be added to a project. 20 Version: 2.8.2 TF1910

## Page 21

UML class diagram In the interest of clarity it is generally preferable to show only a few objects in a class diagram. In this way it is possible to create subject-related or project section-related class diagrams, as sample. The objects shown can have particular dependencies, so that the objects and their dependencies are clearly displayed. On the other hand, objects without explicit dependencies to one another can also be shown in a diagram, so that they can be compared in parallel. Based on this, the class diagram can be used for various purposes: • As design and development tool • As analysis tool for existing projects • As project navigator Information on which commands or actions can be used for the individual purposes is provided below. As design and development tool • Create a new, empty class diagram [} 22]. • The class diagram can be edited [} 25] by means of various action options. → All inputs also affect the objects in the project and are immediately visible in the project tree. As analysis tool for existing projects • Add existing elements to the class diagram [} 23]. • Analyze the existing project structure with the aid of the class diagram you created and edit the diagram [} 25] if required. → All inputs also affect the objects in the project and are immediately visible in the project tree. As project navigator • Open a class diagram and double-click on an element in the class diagram to open the corresponding editor. • The declaration and implementation can be edited as usual, if required. → Any changes of the declaration are automatically updated in the class diagram. Commands The following commands or action options are available for the class diagram: • Creating a new class diagram [} 22] • Adding existing elements to a diagram [} 23] • Editing a class diagram [} 25] Also note the commands, which are available for all UML diagrams: Common commands for all UML diagrams [} 18] Access modifier Available from TC3.1 Build 4026 The access modifier of a method or a property is displayed in the class diagram by means of a symbol. The following table shows which symbol stands for which access modifier. Symbol Access modifier + PUBLIC # PROTECTED - PRIVATE ~ INTERNAL TF1910 Version: 2.8.2 21

## Page 22

UML class diagram 6.2 Commands 6.2.1 Creating a new class diagram If you create a class diagram, you can optionally import the existing project structure. If this option is used, all relevant objects are imported into the class diagram. Relevant objects are programs, function blocks, functions, interfaces, DUTs, GVLs and their respective components (methods, properties, variables etc.). 1. In the context menu of the project tree select the command Add object, then select the Class diagram object. 2. In the Add UML class diagram dialog that opens enter a name for the class diagram. 3. Enable the option Import project structure into class diagram to import the existing project structure into the new class diagram. Disable the option to generate an empty class diagram. 4. Import options (only relevant for importing the project structure): Enable the option Collapse elements to display the element details (attribute or operation list) in minimized form. Disable the option to display the element details in expanded form. 5. Confirm the inputs and configurations with the Open button. ð The new class diagram object is added in the project tree, and the editor for the new diagram opens. 22 Version: 2.8.2 TF1910

## Page 23

UML class diagram 6.2.2 Adding existing elements to a diagram Existing project elements can be added to a class diagram in a number of ways. On the one hand, several elements can be added simultaneously by importing the whole project structure or a selected folder via a command. On the other hand, an individual element can be added by dragging & dropping it onto the class diagram editor. Depending on the number of elements, the following action options are available. • Adding several existing elements: ◦ Import whole project structure when a new diagram is created ◦ Import whole project structure into an empty diagram ◦ Import whole folder structure into an empty diagram • Adding an individual existing element: ◦ Visualize existing element from the project tree on the diagram ◦ Visualize existing element from the cross-references on the diagram Import whole project structure when a new diagram is created 1. Create a new class diagram [} 22] and activate the option Import project structure into class diagram. ð The new class diagram object is added to the project tree. The class diagram editor opens and shows the class diagram for the existing project. Import whole project structure into an empty diagram 1. Open an empty class diagram, which sits directly at the top project level in the project tree, not in a project folder. 2. Execute the command Import project structure to active class diagram, which is available in the context menu of the class diagram editor. ð The class diagram shows the existing structure of the whole project. Import whole folder structure into an empty diagram 1. Open an empty class diagram from the folder whose structure you want to import into the class diagram. TF1910 Version: 2.8.2 23

## Page 24

UML class diagram 2. Execute the command Import project structure to active class diagram, which is available in the context menu of the class diagram editor. ð The class diagram shows the existing structure of the folder containing the class diagram. Visualize existing element from the project tree on the diagram 1. Select an element of type POU, INTERFACE, GVL or DUT in the project tree and drag & drop it onto the opened class diagram. Drop it in a suitable location to visualize it there. ð The corresponding element is shown in the diagram. If relationships with already shown elements exist, these are displayed automatically. Visualize existing element from the cross-references on the diagram The class element, which has a relationship with the selected element but is not included in the class diagram, is shown in the Toolbox window under the heading Incoming cross references or Outgoing cross references. First, the relationship type that links the two elements is shown as a symbol. This is followed by the name of the target or source element. You can drag and drop the element onto the diagram, so that the element is shown in the class diagram. Showing cross-references 1. Open the Toolbox window via the View menu. 2. Select a rectangle element in the opened class diagram, which has relationships that are not shown in the class diagram. ð Under Toolbox the relationships with the elements are listed, which are not yet shown in the class diagram. Under Incoming cross references missing incoming relationships with source elements are listed. Under Outgoing cross references missing outgoing relationships are listed, together with target elements. Visualize existing element from the cross-references on the diagram 1. Drag & drop the element, which is listed under Incoming cross references or Outgoing cross references and which is to be shown in the diagram, onto the class diagram. Drop it in a suitable location to visualize it there. 24 Version: 2.8.2 TF1910

## Page 25

UML class diagram ð The corresponding element is shown in the diagram. The relationships with the already shown elements are displayed automatically. 6.2.3 Editing a class diagram The actions available for editing a class diagram include the following. Further editing options can be found under Editor [} 27]. Adding a new element 1. Open the Tools window via the View menu. 2. Select an element [} 28] in the Tools view and drag & drop it onto the opened class diagram. Drop it in a suitable location to visualize it there. ð The new element is created in the project tree and shown in the diagram. Deselect “Toolbox” view ü An element is selected in the Toolbox window. In the editor the cursor has the form of the selected element. 1. Press the right mouse button. ð The element is deselected, and the standard Pointer element is selected. Editing identifiers 1. Open the line editor of an identifier with two single clicks. 2. Enter a new name and confirm it via the [Enter] key or by clicking in an empty area of the diagram. ð The identifier has the new name. Visualize existing element from the project tree on the diagram 1. Select an element of type POU, INTERFACE, GVL or DUT in the project tree and drag & drop it onto the opened class diagram. Drop it in a suitable location to visualize it there. ð The corresponding element is shown in the diagram. If relationships with already shown elements exist, these are displayed automatically. Cross-references The class element, which has a relationship with the selected element but is not included in the class diagram, is shown in the Toolbox window under the heading Incoming cross references or Outgoing cross references. First, the relationship type that links the two elements is shown as a symbol. This is followed by the name of the target or source element. You can drag and drop the element onto the diagram, so that the element is shown in the class diagram. Showing cross-references TF1910 Version: 2.8.2 25

## Page 26

UML class diagram 1. Open the Toolbox window via the View menu. 2. Select a rectangle element in the opened class diagram, which has relationships that are not shown in the class diagram. ð Under Toolbox the relationships with the elements are listed, which are not yet shown in the class diagram. Under Incoming cross references missing incoming relationships with source elements are listed. Under Outgoing cross references missing outgoing relationships are listed, together with target elements. Visualize existing element from the cross-references on the diagram 1. Drag & drop the element, which is listed under Incoming cross references or Outgoing cross references and which is to be shown in the diagram, onto the class diagram. Drop it in a suitable location to visualize it there. ð The corresponding element is shown in the diagram. The relationships with the already shown elements are displayed automatically. Generate relationship between diagram elements Option 1 – via icon: 1. Select an element in the opened class diagram. 2. Click on a relationship icon, which appears above the element (the selected element acts as source element). 3. Click on the target element of the selected relationship. ð You have created a relationship between the source and target element, which is active in the project and shown in the diagram. Option 2 – via Toolbox: 1. Click on a relationship element from Toolbox. 2. In the opened class diagram first click on the source element, then on the target element. ð You have created a relationship between the source and target element, which is active in the project and shown in the diagram. Removing an element from the diagram Option 1 – via icon: 1. Select the element in the class diagram, which you want to remove from the diagram. 2. Use the icon Remove from diagram, which appears above the element. ð The selected element is removed from the diagram. Option 2 – via the [Del] key 1. Select the element in the class diagram, which you want to remove from the diagram. 2. Press the [Del] key. If the option [} 12] Show prompt when deleting objects from diagram is disabled, the object is only deleted from the diagram by default. If the option is enabled, select the option “Remove from diagram” in the dialog that opens. ð The selected element is removed from the diagram. Removing an element from the diagram and the project Option 1 – via icon: 1. Select the element in the class diagram, which you want to remove from the diagram and the project. 2. Use the icon Remove from project and diagram, which appears above the element. ð The selected element is removed from the diagram and the project. Option 2 – via the [Del] key 26 Version: 2.8.2 TF1910

## Page 27

UML class diagram 1. Enable the option [} 12] Show prompt when deleting objects from diagram. 2. Select the element in the class diagram, which you want to remove from the diagram and the project. 3. Press the [Del] key and select the option Remove from project and diagram in the dialog that opens. ð The selected element is removed from the diagram and the project. As project navigator 1. Open a class diagram and double-click on an element in the class diagram. ð The editor pertaining to the element opens. 2. If necessary, you can edit the declaration and implementation in the opened editor as usual. ð Any changes of the declaration are automatically updated in the class diagram. Multiple selections • If Pointer is enabled in Toolbox (default), you can drag a rectangle over several elements in the class diagram while pressing the left mouse button. All elements covered by the rectangle are then selected. • Multiple selections are also possible by successively selecting the required elements while pressing the [Ctrl] key. • [Ctrl+A] or Select all selects all the elements within a rectangle, but no relationship elements. Refactoring The following changes, which are made in the class diagram editor, can be applied simply to the complete project by refactoring: • Renaming of variables, function blocks or properties • Addition and removal of variables of the type VAR_INPUT, VAR_OUTPUT or VAR_IN_OUT By default, the Refactoring functionality and the associated preview (Refactoring dialog) is activated in the class diagram. However, this can be restricted using the following options dialogs: • Dialog: Options – PLC environment - Refactoring – UML class diagram • Dialog: Options – PLC environment – UML – Class diagram [} 12] Note above all that the preview dialog can be skipped in the options for the UML class diagram and that in this case the change will be applied project-wide without requesting confirmation. 6.3 Editor A UML class diagram visualizes the static structure of a project and the elements declarations. For a special or filtered view of the project, you can drag a selection of objects from the project tree into the class diagram, or selected elements can be removed from the diagram. The class diagram can be edited through various actions. Further information on the editing options can be found under Editing a class diagram [} 25]. In addition, there are further, element-specific user inputs: • Edit class [} 29] • Edit interface [} 35] • Edit generalization [} 52] • Edit realization [} 50] • Edit association [} 48] • Edit composition [} 45] TF1910 Version: 2.8.2 27

## Page 28

UML class diagram 6.4 Elements The Tools window provides the elements of the class diagram. They can be added to the class diagram window via drag & drop. The elements can be positioned freely. Insert element 1. Open View > Tools to access the elements. 2. Drag an element into the class diagram window and drop it at a suitable location. Class [} 28] (POU) Interface [} 34] Global variable list [} 37] (GVL) Data type [} 39] (DUT) Variable Declaration [} 42] Property [} 42] Method [} 43] Action [} 44] Composition [} 44] (VAR) Association [} 47] (POINTER) or Association [} 47] (REFERENCE) Realization relationship [} 49] (IMPLEMENTS) Generalization [} 51] (EXTENDS) Note [} 53] 6.4.1 Class A class is a logical unit in which data and operations are encapsulated. It also represents a variable type that can be instantiated. A class can have an FB_Init method that is called when an instance is initialized. A class can have the following relationship types: • Composition: a class can contain other program elements. • Association: a class can know other program elements. • Realization: a class can implement an interface. • Generalization: a class can inherit from another class. 28 Version: 2.8.2 TF1910

## Page 29

UML class diagram A class is represented by a three-part rectangle. • Orange with heading <<program>>: POU (PROGRAM) • Blue without heading: POU (FUNCTION_BLOCK or FUNCTION) • Blue with heading <<library>>: POU (FUNCTION_BLOCK or FUNCTION) from a library (library function block) • Greyed with heading <<missing>>: POU (FUNCTION_BLOCK or FUNCTION) from a library, which is currently not integrated in the project The class name follows in bold. All attributes are shown after the first dividing line. Each visible attribute has an identifier. If {input} in curly brackets is appended, it is a variable of type VAR_INPUT; {output} indicates a variable of type VAR_OUTPUT. A property has the ID {property}. An internal (non-visible) variable of type VAR has no ID: <Attribute name> : <Data type> {'{input}' | '{output}' | '{property}'} The second dividing line is followed by all operations for the class, i.e. its methods or actions. The name of the operation is followed by closing parentheses. This is followed by {action} to identify an action: <action name>() {action} If it is a method, the parentheses may indicate a variable transfer. If a return type is declared for a method, this follows in the right-hand column. Unlike actions ({action}), methods have no concluding ID: <Method name>(…) : <Return type> Properties “Property” Description “Identifier” Class name Sample: FB_Event Logger User inputs for a class The following user inputs are available if “Pointer” is enabled in the toolbox (default). TF1910 Version: 2.8.2 29

## Page 30

UML class diagram User input in the class dia- Response in the class diagram Description gram Select the tool “Class (POU)”: A class is created. The object exists in the diagram and in the project. The view in the project tree is updated automatically. Click in an empty area of the diagram. The dialog “Add POU” opens. Enter a name for the new object, adjust the settings and close the dialog with "Add". Select a class. The class has expanded attribute and operation lists, which are identified with . Command icons for adding relationship elements are now visible to the left above the class. Tip: If the class has relationships that are currently not shown in the class diagram (missing rectangular elements), a list of “Incoming cross-references” and/ or “Outgoing cross-references” appears in the "Toolbox" view. Below this the missing rectangular elements are listed, which you can drag & drop into the class diagram for display. The class is removed in the Use "flat" removal of a class to Click on . diagram, so that it is no longer remove it from the class diagram displayed. view only. The object still exists and is visible in the project tree. Tip: The class is shown in “Toolbox” under “Incoming cross- references” and/or “Outgoing cross-references”, if a rectangle element with a relationship to the remote element is selected in the class diagram. The class is removed from the The object no longer appears as Click on . diagram and the project. object in the class diagram or the project tree. It no longer exists. A composition arrow points from The existing class contains an Click on and then in an the existing class to the new instance pointing to the new empty area of the diagram. The class. class. Sample: dialog “Add POU” opens. Enter a fb New : FB_New; name for the new object, adjust the settings and close the dialog with "Add". A composition arrow points from The first class contains an Click on , then on an the first class to the second instance pointing to the second existing class. class. class. Sample: fb Existent : FB_Existent; 30 Version: 2.8.2 TF1910

## Page 31

UML class diagram User input in the class dia- Response in the class diagram Description gram A new class with an association A new class FB_New is created. Click on and then in an arrow pointing to the existing The existing class now knows empty area of the diagram. The class is created in the diagram. the new class and contains an dialog “Add POU” opens. Enter a association with the new class. name for the new object, adjust Sample: the settings and close the dialog p New : POINTER TO FB_New . with "Add". An association arrow points from The first class knows the second Click on , then on an the second class to the first class. It now contains a new existing class. class. variable of type. Sample: p Existent : POINTER TO FB_Existent; A generalization points from the The existing class contains the Click on and then in an existing class to the new class. declaration. Sample: empty area of the diagram. The The existing class inherits from FUNCTION_BLOCK FB_Sub dialog “Add POU” opens. Enter a the new class. EXTENDS FB_New name, adjust the settings and close the dialog with "Add". A generalization points from the The first class contains the Click on , then on an first class to second class. declaration. Sample: existing class. FUNCTION_BLOCK FB_Sub EXTENDS FB_Existent A realization arrow points from The class implements the new Click on and then in an the class to the new interface. interface. The declaration section empty area of the diagram. The of the class contains. Sample: dialog “Add interface” opens. FUNCTION_BLOCK FB_Sample Enter an interface name, adjust IMPLEMENTS I_Sample New the settings and close the dialog with "Add". A realization arrow points from The class now implements the Click on , then on an the class to the interface. interface. The declaration section interface. of the class contains. Sample: FUNCTION_BLOCK FB_Sample IMPLEMENTS I_Sample Existent The attribute or operation list is Click on . minimized. The attribute or operation list Click on . expands. Click on the class name. Once it After the first click, the name has The change is applied is selected, click on it once a blue border. After the second synchronously and automatically again. click the line editor opens. to the project. That is, the object name in the project tree and in the declaration section of the POU is adjusted immediately. Click twice on an attribute or After the first click, the name has The change is applied operation name. Then change a blue border. After the second synchronously and automatically the name in the line editor. click the line editor opens. to the project. TF1910 Version: 2.8.2 31

## Page 32

UML class diagram User input in the class dia- Response in the class diagram Description gram Double-click on the class The corresponding object editor You can change the declaration element. opens, and the declaration and or the implementation. After implementation are displayed. closing of the object you are returned to class diagram. The changes are automatically applied to the class diagram. Keep in mind that the default settings in the dialog 'Add POU' or 'Add interface' originate from the last application of this dialog. Samples • Composition PROGRAM Test VAR fb Sample : FB_Sample; a Sample : ARRAY[1..10] OF FB_Sample; END_VAR • Association 32 Version: 2.8.2 TF1910

## Page 33

UML class diagram PROGRAM Test VAR p Sample : POINTER TO FB_Sample; a Sample : ARRAY[1..10] OF POINTER TO FB_Sample; END_VAR • Generalization FUNCTION_BLOCK FB_Sub EXTENDS FB_Base • Implementation TF1910 Version: 2.8.2 33

## Page 34

UML class diagram INTERFACE I_Cylinder EXTENDS I_Base FUNCTION_BLOCK FB_Cylinder IMPLEMENTS I_Cylinder 6.4.2 Interface An interface defines methods and property declarations that describe an externally visible behavior. It contains no variables and no implementation, but only the definition of methods and/or properties. An interface is a variable type that can be instantiated. An interface can have the following relationship type: • Generalization: An interface can inherit from another interface. Like classes, interfaces are shown divided into three parts. The rectangle is green and overwritten with <<interface>>. The interface name follows below in bold. The interface properties are displayed after the first dividing line, based on the following syntax: <property name>: <data type> {property} All interface methods follow after the second dividing line. After the method name there may be a reference to the variable transfer in parentheses. If a return type is declared for a method, this follows in the right-hand column. <method name>(…): <return type> Properties “Property” Description “Identifier” Insert here an unique name for the selected element. The name can be modified here, however also within the class diagram by selecting the name and then opening an inline editor by a further mouse click. 34 Version: 2.8.2 TF1910

## Page 35

UML class diagram Edit interface The following user inputs are available if “Selection” is enabled in "Toolbox" (default). TF1910 Version: 2.8.2 35

## Page 36

UML class diagram User input in the class dia- Response in the class diagram Description gram Select the tool "Interface": An interface is created. The object exists in the diagram and in the project. The view in the project tree is updated automatically. Click in an empty area of the diagram. The dialog “Add interface” opens. Enter a name for the new object, adjust the settings and close the dialog with "Add". Click on an interface icon. To the left above the interface, icons are now visible, which make it possible to add relationship elements. The example on the left has expanded property and method lists after . The interface is only removed Use "flat" removal of an interface Click on . from the diagram. to remove it from the class diagram view only. The object still exists and is visible in the project tree. The interface is removed from The object is removed. It then no Click on . the diagram and the project. longer exists. A generalization points from the The existing interface contains Click on and then in an existing interface outward to the the declaration. Example: empty area of the diagram. The new interface. The existing INTERFACE I_Sample dialog “Add interface” opens. interface inherits from the new EXTENDS I_New Enter a name and exit the dialog interface. Keep in mind that the default with "Add". settings in the dialog 'Add interface' originate from the last application of this dialog. A generalization points from the The first interface contains the Click on , then on an second interface to the first declaration. Example: existing interface. interface. INTERFACE I_Sample EXTENDS I_Existent The property or method list is Click on . minimized. The property or method list is Click on . expanded. Click on the name. Once it is After the first click, the name has Change the interface name in the selected, click on it once again. a blue border. After the second line editor. The change is applied click the line editor opens. synchronously and automatically to the project. That is, the object name in the project tree and in the declaration section of the POU is adjusted immediately. 36 Version: 2.8.2 TF1910

## Page 37

UML class diagram User input in the class dia- Response in the class diagram Description gram Double-click on an interface. The corresponding object editor Edit the declaration. After closing opens with the declaration editor. of the object you are returned to class diagram. The changes are automatically applied to the class diagram. Example • Generalization INTERFACE I_Cylinder EXTENDS I_Base 6.4.3 Global Variable List A global variable list (GVL) is used to declare global variables. These are available project-wide. A GVL can have the following relationship types: • Composition: a class can contain other program elements. • Association: a class can know other program elements. A global variable list is represented by a two-part rectangle in pale pink and headed with <<global>>. All attributes are shown after the first dividing line: <attribute name>: <data type> Properties “Property” Description “Identifier” Insert or change an unique name of the selected element. Edit GVL The following user inputs are available if “Selection” is enabled in the toolbox (default). TF1910 Version: 2.8.2 37

## Page 38

UML class diagram User input in the class dia- Response in the class diagram Description gram Select the tool "Global Variable A GVL is created. The object exists in the diagram List (GVL)": and in the project. The view in the project tree is updated automatically. Click in an empty area of the diagram. The dialog "Add Global Variables List" opens. Enter a name for the new object and close the dialog with "Add". Click on a GVL object. Command icons are visible to the left above the object. GVL is only removed from the Use "flat" removal to remove it Click on . diagram. from the class diagram view only. The object still exists and is visible in the project tree. GVL is removed from the The object is removed. It then no Click on . diagram and the project. longer exists. A composition points from the The declaration of GVL contains Click on , then on an GVL to the selected class or the instantiation based on the existing class or a DUT. DUT. selected element. Example: fb Existent : FB_Existent; A composition points from the The GVL contains the Click on and then in an GVL to the new class. declaration. Example: empty area of the diagram. fb New: FB_New; Dialog “Add POU” opens. Enter a name and exit the dialog with "Add". An association points from the The GVL contains the Click on , then on an GVL to the selected class or declaration for the selected existing class or a DUT. DUT. element. Example: p Existent: POINTER TO FB_Existent; An association points from the The GVL contains the Click on and then in an GVL to the new class. declaration for the new class. empty area of the diagram. Example: The dialog “Add POU” opens. p New: POINTER TO FB_New; Enter a name and exit the dialog with "Add". The attribute or operation list is Click on . minimized. The attribute or operation list Click on . expands. Click on an identifier. Once it is After the first click, the name has Change the class name in the selected, click again. a blue border. After the second line editor. The change is applied click the line editor opens. synchronously to the project. That is, the object name in the project tree and in the declaration section of the POU is adjusted immediately. 38 Version: 2.8.2 TF1910

## Page 39

UML class diagram User input in the class dia- Response in the class diagram Description gram Double-click an element. The corresponding object editor Edit the declaration or opens, and the declaration and implementation. After closing of implementation are displayed. the object you are returned to class diagram. The changes are automatically applied to the class diagram. Keep in mind that the default settings in the dialog 'Add POU' originate from the last application of this dialog. Sample • Composition VAR_GLOBAL fb Message : FB_Message; END_VAR 6.4.4 User-defined data type Via a user-defined data type (“Data Unit Type” = DUT) the user can define data types, e.g. in the form of structures or enumerations. A user-defined structure data type can have the following relationship type: • Generalization: a structure can inherit from another structure. A user-defined data type is represented by a two-part rectangle in pale yellow and overwritten with <<struct>>, if it is a structure or a union. <<enum>> indicates an enumeration type. The identifier follows in bold. All attributes are shown after the first dividing line: <attribute name>: <data type> TF1910 Version: 2.8.2 39

## Page 40

UML class diagram Properties “Property” Description “Identifier” Insert or change an unique name of the selected element. Edit DUT The following user inputs are available if “Selection” is enabled in the toolbox (default). 40 Version: 2.8.2 TF1910

## Page 41

UML class diagram User input in the class dia- Response in the class diagram Description gram Select the tool "Data Unit Type A data type object is created. The object exists in the diagram (DUT)": and in the project. The view in the project tree is updated automatically. Click in an empty area of the diagram. The dialog “Add DUT” opens. Enter a name for the new object, adjust the settings and close the dialog with "Add". Click on a DUT. Icons are visible to the left above. DUT is only removed from the Use "flat" removal to remove it Click on . diagram. from the class diagram view only. The object still exists and is visible in the project tree. DUT is removed from the The object is removed. It then no Click on . diagram and the project. longer exists. A generalization points from the The existing DUT contains the Click on and then in an existing DUT to the new DUT. declaration. Example: empty area of the diagram. The existing DUT inherits from TYPE ST_Sample EXTENDS The dialog “Add DUT” opens. the new one. ST_New Enter a name for the parent object and exit the dialog with "Add". A generalization arrow points The first DUT inherits from the Click on , then on an from the second DUT to the first second DUT. The first DUT existing DUT. DUT. contains the declaration. Example: TYPE ST_Sample EXTENDS ST_Existent The attribute or operation list is Click on . minimized. The attribute or operation list Click on . expands. Double-click on the identifier. After the first click, the name has The change is applied Then change the name in the a blue border. After the second synchronously and automatically line editor. click the line editor opens. to the project. Double-click the element. The corresponding object editor Edit the declaration or opens. implementation. After closing of the editor you are returned to class diagram. The changes are automatically applied to the class diagram. The default settings in the dialog “Add DUT” originate from the last application of this dialog. TF1910 Version: 2.8.2 41

## Page 42

UML class diagram Sample • Generalization TYPE ST_Sub EXTENDS ST_Sample : STRUCT a Messages : ARRAY[1..10] OF STRING; END_STRUCT END_TYPE 6.4.5 Variable declaration A “Variable declaration” is used for adding a variable to a class (program, function block, function) or data structure (DUT) in the class diagram. Add Variable In the “Toolbox” click on “Variable declaration”: Then select an element in the diagram for extending by a variable. If you try to select a non-reasonable position, the cursor will look like a prohibition sign. At reasonable position it appears as a blue cross. If you click at such a position, then the dialog “Auto declare” opens for adding a variable to the focused element. Insert the required settings as usual. After having closed the dialog, the focused element gets extended by the new variable. An appropriate update will be done synchronously in the class diagram and in the object editor. Look of the cursor • : At this position, no adding is possible. • : At this position, you can add a variable to the focused element. 6.4.6 Property The "Property" element is used to add a property to a program, function block or interface. Add property Select the "Property" tool: Then you can select the element in the diagram that should be extended by a property. At points that are not meaningful, the cursor has the form of a prohibition sign. At meaningful points the cursor has the form of a blue or black cross. If you click on such a point, a further property is added to the element in focus. The "Add property" dialog opens. Enter the required settings as usual. Closing the dialog expands the program element with this property, which is immediately updated in the class diagram and in the project tree. 42 Version: 2.8.2 TF1910

## Page 43

UML class diagram Cursor shape: • : at these points in the diagram expansion is not possible. • : at these points in the diagram you can add a property to the element in focus. Access modifier Available from TC3.1 Build 4026 The access modifier of a method or a property is displayed in the class diagram by means of a symbol. The following table shows which symbol stands for which access modifier. Symbol Access modifier + PUBLIC # PROTECTED - PRIVATE ~ INTERNAL 6.4.7 Method The element "Method" is used to extend a program, function block or interface with a method. Add method Select the tool "Method": In the diagram you can then select the element that is to be extended with a method. At points that are not meaningful, the cursor has the form of a prohibition sign. At meaningful points the cursor has the form of a blue or black cross. If you click on such a point, a further method is added to the element in focus. The dialog "Add method" opens. Enter the required settings as usual. Closing the dialog expands the program element with this method, which is immediately updated in the class diagram and in the project tree. Cursor • : at these points in the diagram expansion is not possible. • : at these points in the diagram you can add a method to the element in focus. Access modifier Available from TC3.1 Build 4026 The access modifier of a method or a property is displayed in the class diagram by means of a symbol. The following table shows which symbol stands for which access modifier. TF1910 Version: 2.8.2 43

## Page 44

UML class diagram Symbol Access modifier + PUBLIC # PROTECTED - PRIVATE ~ INTERNAL 6.4.8 Action The "Action" element is used to extend a program or a function block by an action. Add Action Select the "Action" tool: Subsequently, the element to be extended by an action can be selected in the diagram. At points that are not meaningful, the cursor has the form of a prohibition sign. At meaningful points the cursor has the form of a blue or black cross. If you click such a point, a further action will be added to the focused element. The "Add action" dialog opens. Enter the required settings as usual. Closing the dialog expands the program element with this action, which is immediately updated in the class diagram and in the project tree. Cursor • : at these points in the diagram expansion is not possible. • : at these points in the diagram you can extend the focused element by an action. 6.4.9 Composition A composition is a UML relationship that expresses a "contained" property: an element contains another element. In IEC code, this corresponds to the instantiation of an element: fb Sample: FB_Sample. The cardinality indicates how often the relationship exists. In IEC code this corresponds to an ARRAY [...]. If a cardinality greater than 1 is specified, the declaration is as follow: a Sample: ARRAY[1..10] OF FB_Sample. A composition is represented as an arrow with a solid black diamond, pointing from a class or a global variable list to a class of type FUNCTION_BLOCK or a DUT. 44 Version: 2.8.2 TF1910

## Page 45

UML class diagram Property “Property” Description “Relationship” Composition (not editable) “Optimize route” If the option is enabled, the route of the relationship arrow is optimized automatically. The starting point at the start element and the end point at the target element are fixed. If, for sample, the target element is moved, the point to which the arrow points on the target element is retained. If the option is disabled, the route is retained. This option is deselected when a relationship element is positioned manually in the class diagram. Activate the option if automatic optimization is required. “Start element” The name of the element at which the relationship element starts is displayed. “Target element” The name of the element to which the relationship element points is displayed. “Identifier” The name of the relationship element is displayed. Edit composition User input in the class dia- Response in the class diagram Description gram Select the tool "Composition": A composition between the The IEC code is automatically elements is drawn. adapted by extending the declaration section of the existing element. Example: Select a class or a GVL, then fb Existent: FB_Existent; click on the element to include. Select the tool "Composition": A composition pointing from the The IEC code is automatically class or GVL to the new class is adapted by extending the created. declaration section of the existing element. Example: Select a class or a GVL, then fb New: FB_New; click in an empty area of the diagram. The dialog “Add POU” opens. Enter a name, adjust the settings and close the dialog with "Add". Select the tool "Pointer“. The selected (and therefore blue) Click on a composition and move composition runs at the new the line with the mouse. position. The property "Optimize routing" is automatically disabled. Select the tool "Pointer“. The association is removed from Click on a composition and use diagram and the IEC code. The the [Del] key or click on "Delete" instantiation of the class or the in the context menu. data type is removed from the declaration section of the element. Samples • Composition of a class TF1910 Version: 2.8.2 45

## Page 46

UML class diagram • Single composition PROGRAM Test VAR fb Sample : FB_Sample; END_VAR • Multiple composition PROGRAM Test VAR a Sample : ARRAY[1..10] OF FB_Sample; END_VAR • Composition of a data object FUNCTION_BLOCK FB_Message VAR_INPUT st Message Station1 : ST_Message; END_VAR • Composition in GVL 46 Version: 2.8.2 TF1910

## Page 47

UML class diagram VAR_GLOBAL fb Message : FB_Message; END_VAR 6.4.10 Association An association is a UML relationship that expresses "knowing". The knowing element points as a pointer or reference to another element. In IEC code this corresponds to a POINTER TO instruction (p Sample : POINTER TO FB_Sample) or a REFERENCE TO instruction (ref Sample : REFERENCE TO FB_Sample). In the case of pointers, the cardinality specifies how often the relationship exists. In IEC code this corresponds to an ARRAY [...]. If a cardinality greater than 1 is specified, the declaration is as follow: a Sample : ARRAY[1..10] OF POINTER TO FB_Sample. An association is represented as an arrow pointing from a class or a global variable list to a class of type FUNCTION_BLOCK or DUT. TF1910 Version: 2.8.2 47

## Page 48

UML class diagram Property “Property” Description “Relationship” Association (cannot be edited) “Optimize route” If the option is enabled, the route of the relationship arrow is optimized automatically. The starting point at the start element and the end point at the target element are fixed. If, for sample, the target element is moved, the point to which the arrow points on the target element is retained. If the option is disabled, the route is retained. This option is deselected when a relationship element is positioned manually in the class diagram. Activate the option if automatic optimization is required. “Start element” The name of the element at which the relationship element starts is displayed. “Target element” The name of the element to which the relationship element points is displayed. “Identifier” The name of the relationship element is displayed. Edit association User input in the class dia- Response in the class diagram Description gram Select the tool "Association": An association between the The IEC code is automatically elements is drawn. adapted by extending the declaration part of the existing element. Example: Select a class or a GVL, then p Existent : POINTER TO click on the object to be used for FB_Existent; the association. Select the tool "Association": An association pointing from the The IEC code is automatically class or GVL to the new class is adapted by extending the created. declaration part of the existing element. Example: Select a class or a GVL, then p New : POINTER TO FB_New; click in an empty area of the diagram. The dialog "Add POU" opens. Enter a name, adjust the settings and close the dialog with "Add". Select the tool "Pointer". The selected (and therefore blue) Click on an association and association runs at the new move the line with the mouse. position. The property "Optimize routing" is automatically disabled. Select the tool "Pointer". The association is removed from Click on an association and use diagram and the IEC code. The the [Del] key or click on "Delete" POINTER TO or REFERENCE in the context menu. TO instruction is removed from the declaration part of the element. Samples • Association with a class (of a program) – single and multiple 48 Version: 2.8.2 TF1910

## Page 49

UML class diagram PROGRAM Test VAR p Sample : POINTER TO FB_Sample; a Sample : ARRAY[1..10] OF POINTER TO FB_Sample; END_VAR • Association with a data structure (of a GVL) – single VAR_GLOBAL p Message : POINTER TO ST_Message; END_VAR 6.4.11 Implementation A realization is a UML relationship that expresses an interface implementation. The realizing or implementing class object (function block) implements the properties and methods of the interface. In IEC coding this relationship corresponds to the keyword IMPLEMENTS. A realization is indicated by a dashed arrow, pointing from a class of type FUNCTION_BLOCK to an interface. TF1910 Version: 2.8.2 49

## Page 50

UML class diagram Property “Property” Description “Relationship” Realization (not editable) Edit realization User input in the class dia- Response in the class diagram Description gram Select the tool "Realization": A realization is created, pointing The IEC code is automatically from the class to the interface. adapted to indicate the interface in the declaration section of the class. Example: Select a class and then an FUNCTION_BLOCK FB_Sample interface. IMPLEMENTS I_Existent Select the tool "Realization": A realization is created, pointing The IEC code is automatically from the class to the new adapted by creating a new interface. interface and indicating this interface in the declaration Select a class, then click in an section of the class. Example: empty area of the diagram. FUNCTION_BLOCK FB_Sample The dialog “Add interface” opens. IMPLEMENTS I_New Enter a name, adjust the settings and close the dialog with "Add". Select the tool "Pointer“. The selected (and therefore blue) Click on a realization and move realization runs at the new the line with the mouse. position. Select the tool "Pointer“. The realization is removed from Click on a realization and use the diagram and the IEC code. The [Del] key or click on "Delete" in IMPLEMENTS statement is the context menu. removed from the declaration section of the class. Example • Realization INTERFACE I_Cylinder EXTENDS I_Base FUNCTION_BLOCK FB_Cylinder IMPLEMENTS I_Cylinder 50 Version: 2.8.2 TF1910

## Page 51

UML class diagram 6.4.12 Generalization A generalization is a UML relationship that expresses an inheritance or specialization. The inheriting element has the attributes and operations of the element from which it inherits. In IEC coding this relationship corresponds to the keyword EXTENDS. A generalization indicated by an arrow with a solid tip, pointing from the inheriting class to the base class from which it inherits. The direction of the arrow indicates which component inherits from which. Inheritance is possible between classes, interfaces and user-defined data types: • A function block can inherit from another function block. • An interface can inherit from another interface. • A DUT can inherit from another DUT. • Programs and functions cannot inherit or pass on. Property “Property” Description “Relationship” Generalization (not editable) TF1910 Version: 2.8.2 51

## Page 52

UML class diagram Edit generalization User input in the class dia- Response in the class diagram Description gram Select the tool “Generalization”: A generalization is created, The IEC code is automatically pointing from the inheriting adapted to indicate the parent element to the parent element. element in the declaration section of the inheriting class. Select the object that is to inherit, Example: then click on the parent object. FUNCTION_BLOCK FB_Sample EXTENDS FB_Base Existent Select the tool “Generalization”: A generalization is created, The IEC code is automatically pointing from the inheriting adapted by creating a new object element to the new parent and indicating the parent object element. in the declaration section of the Select the object that is to inherit, inheriting object. Example: and then click on an empty area FUNCTION_BLOCK FB_Sample in the diagram. EXTENDS FB_Base New A dialog for creating a new object opens. Enter a name, adjust the settings and close the dialog with "Add". Select the tool "Pointer“. The selected (and therefore blue) Click on a generalization and generalization runs at the new move the line with the mouse. position. Select the tool "Pointer“. The generalization is removed Click on a realization and use the from the diagram and the IEC [Del] key or click on "Delete" in code. The EXTENDS statement the context menu. is removed from the declaration section of the inheriting object Samples • Function block FUNCTION_BLOCK FB_Sub EXTENDS FB_Base • Interface 52 Version: 2.8.2 TF1910

## Page 53

UML class diagram INTERFACE I_Cylinder EXTENDS I_Base • DUT TYPE ST_Sub EXTENDS ST_Sample : STRUCT a Messages : ARRAY[1..10] OF STRING; END_STRUCT END_TYPE 6.4.13 Note You can use the element "Note" to insert a comment in the editor of a class diagram or state diagram. Adding a note Select the "Note" tool: In the editor, click the desired insertion position. Then double-click the text in the element and replace it with the desired text. Cursor • : The cursor has the form of a prohibition sign at points where insertion is not allowed. • : The cursor is a blue cross at points where it is allowed. Multilinearity Multi-line notes are available from TC3.1.4026.12. TF1910 Version: 2.8.2 53

## Page 54

UML class diagram Explicit line breaks can be added using CTRL + space. Size The size of the note element is limited. If the text exceeds the element size, the content is truncated. The entire text is displayed in a tooltip when the mouse pointer is positioned on the note element. You can configure the maximum size of the note element in the Options [} 12]: • General > Note element 54 Version: 2.8.2 TF1910

## Page 55

UML state diagram 7 UML state diagram In addition to the following information, please refer to the samples [} 95], which provide an introduction to the tool and to the call behavior of the UML state diagram. 7.1 Basic principles The UML state diagram is a graphical formalism to specify and design the sequence of a system with discrete events or to program a time behavior. Integrated in the PLC area of the Twin CAT 3 development environment, a state diagram has an editor with state and transition elements. When the application is compiled, executable code is generated. By default, the switching behavior of a state diagram is clocked depending on the task cycle when it is executed, but depending on how the states are configured, it can also switch independently. In this case, these are cycle-internal states. Powerful functionalities such as syntax monitoring or debugging in online mode support the development process. Application case A Statechart is used for programming time-discrete systems. Programs, function blocks, functions, methods or actions can be created as a graph from states and transitions with the Statechart implementation language. Functions/methods and their data are normally temporary. If you implement a function/method with the UML Statechart implementation language, the chart contains cycle-internal states and re-initializes the data at the start of the task cycle. With methods, conversely, there is a possibility to declare the method as VAR_INST. The data are then retained as with a function block and are not temporary, therefore the Statechart will be run through in several task cycles as usual. Refer also to Option Use Var Inst [} 88] regarding this. This option is not available with functions. Syntax The syntax is under compiler control: • a transition between states lying in different regions are not allowed • orthogonal states cannot be nested in other states • exactly one exception transition or completion transition is allowed to exit a composite state • a conditional transition going into an orthogonal state is not allowed, then a fork/join is required Commands The following commands or action options are available for the Statechart: • Creating a new Statechart [} 58] • Editing Statechart [} 59] • Go to Definition [} 62] Also note the commands, which are available for all UML diagrams: Common commands for all UML diagrams. [} 18] Implicit variables of a state diagram The implicit variables are located in the program unit that maps the state diagram (e.g. in the instance of the function block or in a program). The internal variables are located inside the program unit under the element name "UML_SC_<POU name>" with the data type "UML_SC_<id>". For the function block "FB_UML", the element name of the implicit variables is "UML_SC_FB_UML", for example. They are located in the function block instance "fb Uml". TF1910 Version: 2.8.2 55

## Page 56

UML state diagram "UML_SC_<POU name>" of the data type _UML_SC_<id>: Some implicit variables reflect the state of the object during the runtime (In Final State, States), while others serve to control the behavior at runtime (Reinit, Abort, Auto Re Init). Name Data type Meaning In Final State BOOL This variable has the value TRUE if the state diagram is in the end state. Re Init BOOL Setting this variable to TRUE will cause the state diagram to be re-initialized, i.e. the start state of the diagram is activated. Abort BOOL Setting this variable to TRUE will cause the current operation of the diagram to be aborted and the end state of the diagram to be activated. Auto Re Init BOOL If the value of this variable is TRUE, the start state of the diagram is automatically restored as soon as the end state is reached. Default value: TRUE States ARRAY[<number of states>] see below OF _UML_SC_State Names _UML_SC_<id>_Names see below "UML_SC_<POU name>. States" of the data type ARRAY[<number of states>] OF _UML_SC_State: The variables of the structure _UML_SC_State serve to describe a state. This data type is the base type of an array with the name "States", which is declared in the implicit variables and describes the individual states of the state diagram. The individual variables of the structure _UML_SC_State are described in the following table. 56 Version: 2.8.2 TF1910

## Page 57

UML state diagram Name Data type Meaning Active BOOL Flag for determining whether the state is currently active. Fast Execution Fault BOOL Relevant for Intra Cycle states: if an Intra Cycle state is active for longer than a cycle, this flag is set by the system. The flag is reset on exiting from the Intra Cycle state. ID INT ID of the state The ID of the state corresponds to the index at which the state is described in the "States" array. Activation Time TIME Time stamp of the last activation of the state Name STRING Name of the state "UML_SC_<POU name>. Names" of the data type _UML_SC_<id>_Names: The data type _UML_SC_<id>_Names contains an INT variable for each state of the state diagram. This variable is declared with the name of the state and its value indicates the ID of the state. The ID of the state corresponds to the index at which the state is described in the "States" array. Name Data type Meaning <Name of the state> INT ID of the state (= index at which the state is described in the "States" array) Example: Start State1 Example: ID of the state "Start State1", e.g. 4 <Name of the state> INT ID of the state (= index at which the state is described in the "States" array) Example: State1 Example: ID of the state "State1", e.g. 5 <Name of the state> INT ID of the state (= index at which the state is described in the "States" array) Example: State2 Example: ID of the state "State2", e.g. 6 … … … Example: A function block is created with the implementation language UML SC and the name "FB_UML". The statechart diagram has a state named "My State Name". The FB also contains the "My Method" method in the ST language. In the following sample, it is queried from inside and outside the FB whether the statechart diagram is currently in the "My State Name" state. Access from inside the FB / in FB_UML. My Method: FUNCTION_BLOCK FB_UML VAR b In Specific State : BOOL; … END_VAR METHOD My Method : BOOL b In Specific State := UML_SC_FB_UML. States[UML_SC_FB_UML. Names. My State Name]. Active; Access from outside the FB / in MAIN: PROGRAM MAIN VAR fb Instance : FB_UML; b In Specific State : BOOL; END_VAR TF1910 Version: 2.8.2 57

## Page 58

UML state diagram fb Instance(); fb Instance. My Method(); b In Specific State := fb Instance. UML_SC_FB_UML. States[fb Instance. UML_SC_FB_UML. Names. My State Name]. Acti ve; 7.2 Commands 7.2.1 Creating a new Statechart Programs, function blocks, functions, methods or actions can be created as a graph from states and transitions with the Statechart implementation language. 1. In the context menu of the project tree select the command for adding the required program element (e.g. function block, method). 2. Configure the opening dialog as usual (for a POU element, e.g. name and type) and select UML Statechart (SC) as the implementation language. 3. Confirm the inputs and configurations with the Open button. ð The new statechart object is added in the project tree, and the editor for the new diagrams opens. 58 Version: 2.8.2 TF1910

## Page 59

UML state diagram 7.2.2 Editing Statechart The actions available for editing a Statechart include the following. Further editing options can be found under e [} 62]ditor. Adding a new element 1. Open the Toolbox window via the View menu. 2. Select an element [} 63] in the Toolbox view and drag & drop it onto the opened Statechart. Drop it in a suitable location to visualize it there. ð The new element is shown in the diagram. Deselect “Toolbox” view ü An element is selected in the Toolbox window. In the editor the cursor has the form of the selected element. 1. Press the right mouse button. ð The element is deselected, and the standard Pointer element is selected. Editing identifiers 1. Open the line editor of an identifier with two single clicks. 2. Enter a new name and confirm it via the [Enter] key or by clicking in an empty area of the diagram. ð The identifier has the new name. Adding a new action object 1. Click on the symbol New <ENTRY/DO/EXIT> action/method, which appears at the end of an action line for a state and at the start of an action line for a composite state. Requirement: So far the action line has no declaration or implementation. ð The dialog New action object opens. 2. Specify the object type in the left part of the dialog by selecting Action or Method. 3. If the object type Action is selected: Configure the name and the implementation language for the new action. If the object type Method is selected: Configure the name, the return type, the implementation language TF1910 Version: 2.8.2 59

## Page 60

UML state diagram and the access modifier for the new method. 4. Confirm the inputs and configurations with the Add button. ð The new action or method object is added to the project tree and displayed as linked object in the edited state. In addition, the editor for the new action or the new method opens. Creating a new transition Transitions can be created based on various source elements: start state, state, composite state, choice, fork/join. The possible target elements, for which an incoming transition is created, depend on the source element type and the transition type (transition, completion transition, exception transition). The general procedure for generating a transition is explained below. Option 1 – via icon: 1. Select an element in the opened Statechart. 2. Click on a transition icon, which appears above the element (the selected element acts as source element). 3. Click on an existing element to configure it as target element for the selected transition. Alternatively, click in a blank area of the editor to generate a new state. 60 Version: 2.8.2 TF1910

## Page 61

UML state diagram 4. Configure the action and the guard condition for the transition as required by opening the respective line editors with two single clicks. If the guard condition depends on more than one variable, you can insert a new line via [Ctrl+Enter] during the configuration of the transition condition, in order to show the whole transition more clearly. ð You have created a transition from source to target element, which determines the switching characteristics of the Statechart. Option 2 – via Toolbox: 1. Click on a transition element from Toolbox. 2. In the open Statechart first click on the source element, then on an existing element in order to configure it as target element for the selected transition. Alternatively, click in a blank area of the editor to generate a new state. 3. Configure the action and the guard condition for the transition as required by opening the respective line editors with two single clicks. If the guard condition depends on more than one variable, you can insert a new line via [Ctrl+Enter] during the configuration of the transition condition, in order to show the whole transition more clearly. ð You have created a transition from source to target element, which determines the switching characteristics of the Statechart. Changing the end points of an existing transition The end points of an existing transition can be linked to other source or target elements using the Reconnect functionality. As a result, existing transition configurations (action, guard condition) are retained, while the transition connections change. 1. Click on the start or the end of a transition, depending on whether you want to change the source element or the target element. ð The reconnect symbol appears at the transition connection. 2. Drag & drop the symbol onto another source or target element to connect the transition there. ð The transition was linked to another source/target element, without changing the other transition configurations. As project navigator 1. Open a Statechart and double-click on an action object of a (composite) state. ð The editor for the action object opens. 2. If required, you can change the declaration and implementation of the action object in the open editor. ð Use the project navigator functionality to view or adjust the behavior of the selected action object. Multiple selections • If Pointer is enabled in Toolbox (default), you can drag a rectangle over several elements in the Statechart while pressing the left mouse button. All elements covered by the rectangle are then selected. TF1910 Version: 2.8.2 61

## Page 62

UML state diagram • Multiple selections are also possible by successively selecting the required elements while pressing the [Ctrl] key. • Use [Ctrl+A] or Select all to select all elements of the diagram. 7.2.3 Go to definition For transitions, the command Go To Definition is available in the corresponding context menu. The command is available in offline and online mode. 1. Right-click on a transition to open the corresponding context menu. 2. Select the command Go to Definition. ð The editor, in which the first variable of the transition or the transition expression is declared, opens and the variable is marked in the declaration editor. 7.2.4 Find All References For transitions, the command Find All References is available in the corresponding context menu. The command is available in offline and online mode. 1. Right-click on a transition to open the corresponding context menu. 2. Select the command Find All References. ð The Cross Reference List view opens and shows the locations where the first variables of the transition or transition expression are used. 7.2.5 Add Watch For transitions, the command Add Watch is available in the corresponding context menu. The command is only available in online mode and provides a further debugging option – in addition to the integrated online view available with the transition – for transferring the variables of a transition to the watch list via a command. This command is particularly useful if a transition expression consists of a combination of several variables (e.g. "b Condition1 AND b Condition2"). If you execute the command Add Watch for this transition, both variables of the transition expression are added to the watch list, i.e. b Condition1 and b Condition2. This gives you a simple overview of which sub-signal of the overall expression does not yet have the required value for switching to the next state. 1. Right-click on a transition to open the corresponding context menu. The transition expression can consist of one or more variables. 2. Select the Add Watch command. ð The transition expression variable(s) is/are inserted in the currently open watch list. If no watch list is currently open, the command inserts the variable(s) into Watch List 1 and opens its view. 7.3 Editor The Statechart editor is used for designing and programming procedures based on a Statechart. The state is the main element of the Statechart. A Statechart is usually clocked via the task cycle, although cycle-internal state machines are also possible (see configuration of a state [} 64]). The Statechart can be edited through various actions. The editing options are documented here [} 59]. In addition, there are further, element-specific user inputs: • Edit state [} 66] • Edit transition [} 83] • Edit completion transition [} 84] • Edit exception transition [} 87] 62 Version: 2.8.2 TF1910

## Page 63

UML state diagram • Edit start state [} 64] • Edit choice [} 81] • Edit composite state [} 71] • Edit fork/join [} 79] 7.4 Elements The Tools window shows the elements of the statechart. They can be added to the State diagram window via drag & drop. States and pseudo states can be positioned as required. Insert element 1. Open View > Tools to access the elements. 2. Drag an element into the State diagram window and drop it at a suitable location. Start state [} 63] End state [} 64] State [} 64] Composite state [} 68] Fork/Join [} 78] Choice [} 80] Transition [} 81] Completion transition [} 83] Exception transition [} 84] Note [} 87] 7.4.1 Start State A start state is a pseudo state that indicates the initial state. If it is at top-level, the sequence of the state chart starts there. If it is in a composite states or in region of an orthogonal state, the sequence of the region starts. The start state is displayed as a black, filled circle. TF1910 Version: 2.8.2 63

## Page 64

UML state diagram Properties "Property" Description "Identifier" Here you can enter a name. It is not displayed in the state diagram. Edit start state User input in the Statechart Response in the State- Description chart Focus on a start state. The start state is editable. • A completion transition can be added via the command icon that is displayed above the start state. A completion transition is added. If you click on an existing state, it becomes the target Click on the symbol state of the transition. Click in an empty area to create a new state. 7.4.2 End State An End state is a pseudo state that indicates that the execution of the region containing this end state has been completed. End states can be located in statecharts at top level, in composite states, or in regions of orthogonal states. An end state is displayed as a little black, filled circle within a second empty circle. Properties "Property" Description "Identifier" Here you can enter a name. It is not displayed in the state diagram. 7.4.3 State A state is the main element of a state diagram. A state machine (or state diagram) passes through various states and executes their actions during its runtime. A state can have ENTRY, DO or EXIT actions, which are executed at specified times during the runtime of the state. A state is displayed as a rectangle with rounded corners. Normal state A normal state is clocked by the task in which it is called. This means that the transition into the next state is not called before the next task cycle switches. 64 Version: 2.8.2 TF1910

## Page 65

UML state diagram Cycle-internal state If a state machine consists of cycle-internal states, the switching characteristics are independent of the task cycle. This means that completion of the actions of an internal state is followed immediately by the transition. The transition condition is checked immediately, and the transition action is executed when the condition is met. Also, the system immediately switches to the target state when the transition condition is met. Whether a state switches cycle-internally is set in the property “Internal state”. ENTRY, DO, EXIT actions/methods A state can have an ENTRY, DO and/or EXIT action or method. For these actions or methods you can choose any implementation language. • The ENTRY action can initialize the state. It is executed once when all incoming transitions switch, so that the state becomes active. • The DO action is executed as long as the state is active. • The EXIT action is intended to ensure that the state is exited in a valid state. The EXIT action is executed once when all outgoing transitions switch, so that the state is exited. Call behavior Make sure you refer to the samples [} 95], which describe and illustrate the call behavior of the UML state diagram. Properties "Property" Description "Identifier" Name of the state Example: Enable, Production, Error Handling "Color" Color of the state Click on the set color to change the color of the state via the drop-down menu that opens. Default: "Implicit start state" • No: [Default] set the property to No if you require a normal state. • Diagram: set the property to diagram if you want that the state to be also a start state. A state machine requires a start state at the top level and also each region in a composite state. "Cycle-internal" • : tick the checkbox to set the state cycle to internal. In "Cycle-internal" the transition is immediately switched to the next state. • : [Default] untick the checkbox to set the state cycle to normal. The state then changes with the task cycle. A transition to the next state is executed with a cycle change of the task. "Max. DO cycle Requirement: this property is available if the property "Cycle-internal" is activated. calls" Define the maximum number of calls of the DO action per cycle. Enter a number between 1 and 32767. This setting is relevant for the cycle-internal states if the outgoing transition of the cycle-internal state is not fulfilled during the processing of the cycle-internal state and will also not be fulfilled during the DO calls. Setting the maximum number of calls ensures that calling the cycle-internal state does not lead to an infinite loop. "ENTRY action" Assign an action to the selected state by specifying its action name. "DO action" "EXIT action" TF1910 Version: 2.8.2 65

## Page 66

UML state diagram Edit state The following user inputs are available, provided "Pointer" or "Choice" is enabled in "Toolbox" (standard mode). 66 Version: 2.8.2 TF1910

## Page 67

UML state diagram User input in the state dia- Response in the state dia- Description gram gram Focus on a state. The state is editable. • You can edit the name through two single clicks on the name. • You can add outgoing transitions via the command icon above the state. • Via the three icons in the center of the state you can extend the state with an ENTRY, DO and/or EXIT action. • The state can be removed with the [Del] key. Click on the green symbol An outgoing transition is created. If you click on an existing state, it becomes the target state of the transition. Click in an empty area to create a new state. Generate several transitions on If a state has more than one outgoing/ the same state. incoming transition, the priorities of the transitions define their execution order. The priority of the transitions is shown in a small circle. The state is extended by an ENTRY action/method. Click on : The state is extended by a DO action/ method. Click on : The state is extended by an EXIT action/ method. Click on : Focus on a state, which was For action lines the symbol appears at the extended by an action, and end of the line, if no action has been assigned yet. click on the symbol . The dialog "New action object" opens for generating a new action. The name of the action is shown after a slash. See also: "Add new action object" [} 59] Click twice (two single clicks) The line editor opens with Intelli Sense on the ENTRY, DO or EXIT support, so that a new action can be expression (irrespective of assigned. If the required action is selected whether an action was already in Intelli Sense, the action can be selected assigned or not). by double-clicking or single-clicking plus [Enter]. TF1910 Version: 2.8.2 67

## Page 68

UML state diagram User input in the state dia- Response in the state dia- Description gram gram Focus on a state that was The assigned action, "Sample Method" in assigned an action. Click on the the sample, opens in the editor. The action object can be edited in the POU symbol or double-click on editor that opens. the assigned action. The action list for the state collapses. Click on : The action list for the state expands. Click on : 7.4.4 Composite State A composite state is used for grouping the states it covers. It can be used for two different use cases: • Grouping/Nesting: ◦ If a composite state consists of precisely one region, the inner states are passed through sequentially at runtime. An inner state can thereby be a composite state again, so that a nesting of composite states is created. In addition, such composite states can call ENTRY/DO/EXIT actions. ◦ Composite states, each with a particular region, are used to group states, so that shared forwarding or shared error handling can be implemented, e.g. with the aid of (pseudo) exception transitions. In addition or alternatively, the composite state can be provided with its own ENTRY/ DO/EXIT actions, which can be topically assigned to the inner states. This is interesting, for example, if a higher-level DO action is to be called in addition to the DO actions of the inner states. In this case the higher-level DO action could be placed in the composite state. ◦ If multiple composite states are nested, only the innermost composite state may have more than one region. • Parallel sub-state machines: ◦ If a composite state consists of several regions, the inner states are grouped orthogonally. The regions of the composite state are assigned priorities, which control the processing order at runtime. The states of the regions are passed through pseudo-parallel, according to their internal sequencing. ◦ Composite states with several regions or so-called orthogonal states are used for programming parallel states. Samples of the implementation of various use cases can be found at the foot of this page. 68 Version: 2.8.2 TF1910

## Page 69

UML state diagram A composite state is shown as a yellow, filled rectangle with rounded corners. Its name is displayed in the upper left corner of the rectangle. Regions are separated by black dashed lines. In the case of a composite state with several regions, the priority of each region is displayed in the top right- hand corner and the name of each region in top left-hand corner of the region. The lines, names and priorities are editable. Syntax rules General syntax rules for composite states • A composite state can have one or several outgoing exception transitions. An error handling, for example, can be implemented with the aid of an exception transition. • Completion transition ◦ A composite state can only have one outgoing completion transition. ◦ If a composite state has an outgoing completion transition, each region must contain a start and end state. ◦ The regions do not require an end state if the composite state has no outgoing completion transition. ◦ However, the composite state must have an outgoing completion transition if all regions of the composite state contain an end state. ◦ The composite state reaches its end state when all regions have reached their respective end states. Syntax rules for a composite state with precisely one region • Activate start state/composite state ◦ If the composite state has an outgoing completion transition, the region must have a start and end state (refer also to the general syntax rules regarding the end state) and the incoming transition must be connected to the composite state to activate it. ◦ If the composite state does not have an outgoing completion transition, the region can optionally contain a start state. If a start state exists, to activate the composite state, the incoming transition must be connected to the composite state. A direct connection via a conditional transition between a state inside the composite state and a state outside the composite state is not allowed - neither from outside to inside nor from inside to outside. On the other hand, if there is no start state, the incoming transitions are directly connected to the inner states. This could be one or more incoming transitions. Furthermore, the other direction is also possible in this case: starting from the states inside the composite state, outgoing conditional TF1910 Version: 2.8.2 69

## Page 70

UML state diagram transitions can be connected directly to states outside of the composite state. This could be one or more outgoing transitions. Please note that states inside and outside of a composite state may only be directly connected to one another (regardless of the direction) if the inner and outer state are separated only by one level of a composite state. This means that a state located inside a composite state that is in turn located inside another composite state (nesting) cannot be directly connected to a state located outside this nesting of composite states. This connection would cross two borders of composite states, but it is only allowed to cross one border. The named state can only be directly connected with an outside state if this target state is located in the outer composite state (only one level crossed). • Nesting ◦ A composite state with precisely one region can contain another composite state. In this case the states are nested. ◦ The nesting of composite states may be arbitrarily deep, with only the innermost composite state having more than one region. Syntax rules for a composite state with multiple regions • Activate start state/composite state ◦ The incoming transition must be linked with the composite state to activate it. ◦ Each region must contain a start state. • Transitions between states in different regions are not permitted. • A direct connection via a conditional transition between a state inside the composite state and a state outside the composite state is not allowed - neither from outside to inside nor from inside to outside. Exception: using a fork that is outside the composite state, you can create transitions that go to states inside the composite state. ENTRY, DO, EXIT actions/methods A composite state that has precisely one region can be assigned ENTRY/DO/EXIT actions/methods. In order to enable this function, the option "Allow ENTRY/DO/EXIT actions" must be activated. This option is located in the properties of the composite state. For these actions or methods you can choose any implementation language. • The ENTRY action can initialize the composite state. It is executed once when all incoming transitions switch or when an internal state becomes active, so that the composite state is activated. • Note the description of the property "Execute DO actions, even if inner composite states are active", which determines the behavior of the DO action. • The EXIT action is intended to ensure that the composite state is exited in a valid state. The EXIT action is executed once when all outgoing transitions switch or when an outer state becomes active, so that the composite state is exited. Call behavior Make sure you refer to the samples [} 95], which describe and illustrate the call behavior of the UML state diagram. 70 Version: 2.8.2 TF1910

## Page 71

UML state diagram Properties "Property" Description "Identifier" Name of the composite state Example: Door Automation "Color" Color of the composite state Click on the set color to change the color of the composite state via the drop-down menu that opens. Default: "Allow ENTRY/DO/ Requirement: this property is available when the selected composite state has exactly EXIT actions" one region. In this case you can also assign actions to a composite state if it is part of a nesting of composite states. : you can assign an ENTRY, DO or EXIT action to the selected composite state. : you cannot assign ENTRY, DO or EXIT actions to the selected composite state. "Execute DO Requirement: several composite states are graphically nested within each other. actions, even if inner The option is only available for the outer composite state and is passed on to the inner composite states are composite states. active" : at runtime the DO action of the outer composite state is executed continuously, even if an inner composite state is active. In the editor the note "{is also executed for inner composite states}" appears next to the DO action, in order to highlight this action behavior. : when one of the inner composite states becomes active, the DO action of the outer composite state pauses. "ENTRY action" Requirement: the selected composite state has precisely one region and the property "Allow ENTRY/DO/EXIT actions" is activated. "DO action" "EXIT action" Assign an action to the selected state by specifying its action name. Edit composite state The user inputs in the state diagram editor can be summarized as follows: TF1910 Version: 2.8.2 71

## Page 72

UML state diagram User input in the state dia- Response in the state dia- Description gram editor gram Focus on a composite state. The composite state is editable. • You can edit the name through two single clicks on the name. • You can add outgoing transitions via the command icons that are shown above the state. • The size of the composite state is adjustable. • The state can be removed with the [Del] key. Conditional editing options: • The composite state can be extended with an ENTRY, DO and/or EXIT action, if the composite state has a region and the property "Allow ENTRY / DO / EXIT actions" is enabled. Click on the green symbol A completion transition is added. If you click on an existing state, it becomes the target state of the transition. Click in an empty area to create a new state. Click on the green symbol An exception transition is added. If you click on an existing state, it becomes the target state of the transition. Click in an empty area to create a new state. Focus on a composite state and hold the mouse pointer over the state. The size of the composite state was Pull one of the blue adjusted. squares to another position. The state is subdivided, and a further Click on the green symbol region is added. The name and priority are displayed for each region. Click twice (two single clicks) The name of the region is editable. on the name of a region. 72 Version: 2.8.2 TF1910

## Page 73

UML state diagram User input in the state dia- Response in the state dia- Description gram editor gram Click twice (two single clicks) The priority of the region is editable. Enter on the priority of a region. a number to define the priority of the region. The priorities of the other regions are automatically adjusted. Click on the dividing line and The dividing line is moved to adjust the move it. size of the regions. Click on the dividing line and The dividing line is removed, so that the press the [Del] key. regions that were separated by it become one region. Focus on a composite state and Requirements: hold the mouse pointer over the • The composite state has one region. state. • The property "Allow ENTRY / DO / EXIT actions" is enabled Click on one of the three These command icons extend a symbols composite state with an ENTRY, DO or EXIT action. Clicking on one of the rectangles brings up the following: • : extension by ENTRY action • : extension by DO action • : extension by EXIT action Focus on a state, which was For action lines the symbol appears at the extended by an action, and end of the line, if no action has been assigned yet. click on the symbol . The dialog "New action object" opens for generating a new action. The name of the action is shown after a slash. See also: "Add new action object" [} 59] Click twice (two single clicks) The line editor opens with Intelli Sense on the ENTRY, DO or EXIT support, so that a new action can be expression (irrespective of assigned. If the required action is selected whether an action was already in Intelli Sense, the action can be selected assigned or not). by double-clicking or single-clicking plus [Enter]. TF1910 Version: 2.8.2 73

## Page 74

UML state diagram User input in the state dia- Response in the state dia- Description gram editor gram Focus on a state that was The assigned action, "Sample Method" in assigned an action. Click on the the sample, opens in the editor. The action object can be edited in the POU symbol or double-click on editor that opens. the assigned action. Pull a composite state from the The composite states are nested. Toolbox view to a composite If the property "Allow ENTRY / DO / EXIT state with precisely one region. actions" is enabled for the outermost state, you can assign each composite state its own actions (ENTRY/ DO / EXIT). Add a DO action to the At runtime the DO action, e.g. outermost composite state and "Do Method", is executed continuously, activate the option "Execute DO even if one of the inner composite states actions, even if inner composite is active. states are active" under With deeper nesting, this option and its Properties. value are passed on to inner states. The note "{is also executed for inner composite states}" appears in the editor. Pull a state from the "Toolbox" The state is assigned to this region. window to a region of the composite state. If the symbol appears, the insert position to which the mouse points is not allowed. Samples of composite states Composite state with exception and completion transition and with a region with start and end state: 74 Version: 2.8.2 TF1910

## Page 75

UML state diagram Composite state without completion transition and with a region without start and end state: TF1910 Version: 2.8.2 75

## Page 76

UML state diagram Composite state with one region and its own DO action: Nested composite states, some with their own ENTRY/DO/EXIT action: 76 Version: 2.8.2 TF1910

## Page 77

UML state diagram Composite state with several regions/orthogonal state with fork: Sample "Lift": orthogonal state with completion and exception transition: TF1910 Version: 2.8.2 77

## Page 78

UML state diagram 7.4.5 Fork Fork is a pseudo status for forking transitions. A fork can have one or more incoming transitions. It has several outgoing transitions, which must end in different regions of a composite/orthogonal state. The fork must have the same number of outgoing transitions as there are regions in the composite/orthogonal state. All outgoing transitions from a fork are completion transitions. They look like normal transitions, because unlike completion transitions they are not displayed with a small circle with a cross in it. However, they are unconditional and output a signal following a concluding event. A fork is displayed as a black bar; aligned horizontally or vertically. 78 Version: 2.8.2 TF1910

## Page 79

UML state diagram Properties "Property" Description "Identifier" You can enter a name here. It is not displayed in the state diagram. "Vertical direction" • : [Default] tick the checkbox to align the bar vertically. • : untick the checkbox to align the bar horizontally. Edit fork User input in the state diagram Response in the state diagram Description Focus on a fork. The fork is editable. • You can adjust the size of the fork. • You can add a completion transition via the command icon displayed above the fork. A completion transition is added. If you click on an existing state, it Click on the green symbol becomes the target state for the transition. Click on an empty area to create a new state. The size of the fork has been Pull one of the blue squares to adjusted. another position. Example Fork with orthogonal states TF1910 Version: 2.8.2 79

## Page 80

UML state diagram 7.4.6 Choice A Choice is a node in a state machine; at the node, an in-cycle evaluation of the subsequent guard conditions is done. It has at least one incoming and one outgoing transition. Choice nodes can be positioned top-level in statecharts, in composite states, and in regions. If several choices are connected by transitions, the connection must be designed in a way that no circular connection exists, such as recirculation to a choice that is already the source element of a transition in this chain. A choice is displayed as a diamond. The circle with the flow-control number indicates the order of processing. Properties "Property" Description "Identifier" Here you can enter a name. It is not displayed in the state diagram. 80 Version: 2.8.2 TF1910

## Page 81

UML state diagram Edit choice User input in the state diagram Response in the state diagram Description Focus on a choice. The choice is editable. • You can add outgoing transitions via the command icon above the choice. An outgoing transition is created. If you click on an existing state, it Click on the green symbol becomes the target state of the transition. Click in an empty area to create a new state. Example of a choice 7.4.7 Transition A transition controls the transition behavior between states. A transition is possible if one of the following events occurs: • conditional event or change event • Termination event (when the actions of the source state are complete) • Time event A transition has a guard condition and an optional action. The state transition is usually executed when the evaluation of the guard condition detects a rising edge. Alternatively, the transition can be configured to detect whether the guard condition is TRUE. In this case, advancing is independent of the edge behavior of the guard condition. When the state transition is executed with the next clock cycle, first the transition action is executed, then the target state is assumed. If a source state has several outgoing transitions, each transition is assigned a priority. These can be changed in the element properties (View → “Properties” → “Priority”). The priority determines the order in which the guard conditions are checked and therefore in which order the transitions are switched. A transition is displayed as a thin arrow pointing to the next state. TF1910 Version: 2.8.2 81

## Page 82

UML state diagram The guard condition of a transition can consist of several Boolean variables or expressions. In addition, transition elements, which can be added to a POU object as separate objects, can be used as transition condition. A new line can be added in the line editor for the transition condition via [Ctrl+Enter], in order to display the individual conditions more clearly. Properties "Property" Description "Relationship type" Transition (not editable) "Priority" Priority, which determines the processing order Sample: 1 Note: if the state has further transitions and you change the priority, all transitions are affected by the change and are automatically adjusted. "Rising edge" • : if the guard condition returns a rising edge (from 0 to 1), the transition is passed through and the state transition is executed. Tip: in the editor, a transition that behaves in this way is marked with the symbol . • : if the guard condition is TRUE, the transition is executed. Tip: if the guard condition is always TRUE, the transition is executed once. 82 Version: 2.8.2 TF1910

## Page 83

UML state diagram Edit transition User input in the state diagram Response in the state diagram Description Selecting "Transition" in "Toolbox". A transition with TRUE condition Click on a state (source state) in and an action icon is created. Use the state diagram, then click on this method to generate a transition another state (target state). between existing states. Click on a state (source state) in The icon through which an the state diagram. outgoing transition can be added to the selected state is available. If you use it, the state is extended with an outgoing transition. The target state is determined with a further click. Double-click on the symbol An input field with Intelli Sense functionality opens. Select a Boolean variable or a Boolean expression. When the required option is selected in Intelli Sense, it can be activated by double-clicking or by focusing plus [Enter]. An input field with Intelli Sense functionality opens. Select a Two single clicks on : method or action. When the required option is selected in Intelli Sense, it can be activated by double-clicking or by focusing plus [Enter]. This selected method or action is executed when the transition has switched. Click once on a transition, the The transition is selected (indicated action icon or the guard icon: by a blue arrow). A selected transition can be moved via drag and drop. The position of the linked states remains unchanged. Click on the start or end of a transition. The symbol enables reconnecting of the transition, while retaining the existing transition configuration. You can pull the symbol to another source or target state in order to connect the transition there. The corresponding condition and action are retained. 7.4.8 Completion Transition A completion transition is unconditional. That is, it has no guard condition that triggers a switching operation. Instead, it switches without an additional condition, once the source state has been fully processed. During the next task cycle any action that may have been assigned is executed. All outgoing transitions of a start state and a fork/join are completion transitions. A composite state can also have a completion transition (depending on the application case of the composite state). TF1910 Version: 2.8.2 83

## Page 84

UML state diagram A completion transition is displayed as a thin arrow pointing to the target state. The small circle with a cross at the start of the arrow indicates that it is a completion transition. Properties "Property" Description "Relationship type" Completion transition (not editable) "Priority" 1 (not editable) Edit completion transition The user inputs in the state diagram editor can be summarized as follows: User input in the state diagram Response in the state diagram Description Select "Completion transition" in An unconditional transition with an the toolbox. Click on a state and action icon is created. This method then on another state (target state). for generating a transition is used if the transition is to link existing states. The icon is available when the corresponding state is selected. If Click on . you use it, the state is extended with an outgoing completion transition. The target state is determined with a further click. Click on the transition itself or on The transition is selected (indicated the action icon. by a blue arrow). A selected transition can be moved via drag and drop. The position of the linked states remains unchanged. An input field with Intelli Sense functionality opens. Select a Click twice. method or action. When the required option is selected in Intelli Sense, it can be activated by double-clicking or by focusing plus [Enter]. This selected method or action is executed when the transition has switched. Click on the start or end of a completion transition. The symbol enables reconnecting of the transition, while retaining the existing transition configuration. You can pull the symbol to another source or target state in order to connect the transition there. The corresponding action is maintained. 7.4.9 Exception Transition An exception transition controls the switching to the next state or pseudo state, if an error or an exception occurs. It has a guard condition and an optional action. The source state is usually a composite or orthogonal state. Exception transitions cannot be used for "normal" states. However, a "normal" state is active as a rule within the composite or orthogonal state, which has an exception transition. 84 Version: 2.8.2 TF1910

## Page 85

UML state diagram An exception transition interrupts the current processing. The currently active state is first processed until the end of the cycle, so that the execution of the currently executed DO action(s) is completed. The system then enters the state that is intended in response to this exception. In this state, error handling and exception handling are executed. The source state is usually a composite or orthogonal state. The exception transition is used to exit a composite state from every substate. Its state is evaluated after the DO action for the active state has been executed. Thus, even if the condition for the exception transition is already TRUE on the first occurrence of a composite state, the DO action of the first state is executed. Since ENTRY and EXIT actions are not linked to conditions, they are always executed independent of the exception transition. An exception transition can be interpreted such that it does not originate from a composite state, but directly from each substate. The conditions for the exception transitions are evaluated after their DO actions. Since ENTRY and EXIT actions are not linked to conditions, they are always executed independent of the exception transition. An exception transition is indicated by a red dashed arrow pointing to the next state. Pseudo exception transitions A pseudo exception transition replaces the end state in a composite state. It is indicated by a blue dashed arrow. In some cases it is clearer to draw a transition at the edge of the composite state whose condition is used as a basis for exiting the whole composite state, instead of an end state in a composite state that is linked to many transitions. This is similar to an exception transition, but without the interpretation that this represents a malfunction. It is therefore referred to as a pseudo exception transition. A pseudo exception transition has no influence on the cyclic execution behavior. TF1910 Version: 2.8.2 85

## Page 86

UML state diagram Properties "Property" Description "Relationship type" Exception transition (not editable) "Priority" Priority, which determines the processing order Sample: 3 Note: if the state has further transitions and you change the priority, all transitions are affected by the change and are automatically adjusted. "Pseudo exception" • : exception transition. The arrow is shown with a dashed red line in the editor. [Default] • : pseudo exception transitions. The arrow is shown with a dashed blue line in the editor. If the condition is met, the state is exited. However, it is not a fault signal that triggers advancing. "Rising edge" • : if the guard condition returns a rising edge (from 0 to 1), the transition is passed through and the state transition is executed. Tip: in the editor, a transition that behaves in this way is marked with the symbol . • : if the guard condition is TRUE, the transition is passed through. 86 Version: 2.8.2 TF1910

## Page 87

UML state diagram Edit exception transition User input in the state diagram Response in the state diagram Description Select "Exception transition" in the An exception transition with TRUE toolbox. Click on a composite state condition and an action icon is (source state) and then on another created. state (target state). Click on a composite state (source The icon through which an state) in the state diagram. outgoing exception transition can be added to the selected state is available. If you use it, the state is extended with an outgoing exception transition. The target state is determined with a further click. Double-click on the symbol An input field with Intelli Sense functionality opens. Select a Boolean variable or a Boolean expression. When the required option is selected in Intelli Sense, it can be activated by double-clicking or by focusing plus [Enter]. An input field with Intelli Sense functionality opens. Select a Click the symbol twice method or action. When the required option is selected in Intelli Sense, it can be activated by double-clicking or by focusing plus [Enter]. This selected method or action is executed when the transition has switched. Click on the transition, the action The transition is selected (indicated icon or the guard icon. by a blue arrow). A selected transition can be moved via drag and drop. The position of the linked states remains unchanged. Click on the start or end of an exception transition. The symbol enables reconnecting of the transition, while retaining the existing transition configuration. You can pull the symbol to another source or target state in order to connect the transition there. The corresponding condition and action are retained. 7.4.10 Note You can use the element "Note" to insert a comment in the editor of a class diagram or state diagram. Adding a note Select the "Note" tool: TF1910 Version: 2.8.2 87

## Page 88

UML state diagram In the editor, click the desired insertion position. Then double-click the text in the element and replace it with the desired text. Cursor • : The cursor has the form of a prohibition sign at points where insertion is not allowed. • : The cursor is a blue cross at points where it is allowed. Multilinearity Multi-line notes are available from TC3.1.4026.12. Explicit line breaks can be added using CTRL + space. Size The size of the note element is limited. If the text exceeds the element size, the content is truncated. The entire text is displayed in a tooltip when the mouse pointer is positioned on the note element. You can configure the maximum size of the note element in the Options [} 12]: • General > Note element 7.5 Object Properties 1. Select an UML Statechart in the project tree. 2. Open the context menu and select Properties or click on View > Properties. The tabs that are relevant for UML are described below. UML • Abortable: ◦ Option available for: all Statecharts ◦ Option enabled (default): Processing of the Statechart can be aborted. Such a Statechart has an additional internal variable: _UML_SC_<name>. Abort. If this variable is set with IEC code, processing of the Statechart can be stopped immediately, regardless of the internal state. ◦ Option disabled: Processing of the Statechart cannot be aborted. • Use Var Inst: ◦ Option available for: Statecharts, which were created as "Method" program elements and belong to a function block ◦ Option enabled (default): The data of the Statechart methods are not temporary; they are held as instance variables for the corresponding function block. If you declare the variables of the method as VAR_INST, the data are held in the same way as for a function block and are no longer temporary, so that the Statechart is passed through in several task cycles as usual. ◦ Option disabled: The data of the Statechart methods are held on a temporary basis. Methods and their data are usually temporary. If you implement a method with the implementation language UML Statechart and disable the option “Use Var Inst”, the method behaves like a cycle-internal state and reinitializes the data at the start of the task cycle. In this case only cycle-internal states can be used. ◦ Note that this option is only available for Statechart methods that belong to a function block, not for methods that belong to a program, since programs cannot contain VAR_INST declarations. 88 Version: 2.8.2 TF1910

## Page 89

UML state diagram 7.6 Online Mode The behavior of Statechart objects in online mode corresponds to the normal online behavior in Twin CAT 3. As usual it is possible to monitor a loaded application, write or force variables, set breakpoints or process a program in single cycles. In online mode an active state is shown in blue, an active composite state in light blue. In online mode the value of a transition expression is displayed next to the transition. If the transition consists of only one transition variable, the value of the variable can be changed for writing or forcing by double-clicking on the monitoring value. If a value has been prepared for writing or forcing, this is indicated in the top right corner of the monitoring area (see the monitoring field of the transition variable b Leave State4 in the center of right- hand edge in the image below: the blue corner indicates that the variable value TRUE is ready for writing or forcing). An additional debugging option is provided by transferring the variables of a transition to the watch list via a command. To this end select Add Watch [} 62] from the context menu of the transition. This command is particularly useful if a transition expression consists of a combination of several variables (e.g. "b Condition1 AND b Condition2"). If you execute the command Add Watch for this transition, both variables of the transition expression are added to the watch list, i.e. b Condition1 and b Condition2. This gives you a simple overview of which sub-signal of the overall expression does not yet have the required value for switching to the next state. Furthermore, the commands Go To Definition [} 62] and Find All References [} 62] are supported for transitions. TF1910 Version: 2.8.2 89

## Page 90

UML state diagram All possible positions for breakpoints are shown as white circles with grey edge in the Statechart. To set a breakpoint, select a circle. The circle is highlighted in grey: . Select Debug > Toggle Breakpoint or press [F9]. The program stops at the breakpoint, and the point is highlighted in yellow in the Statechart. Online Change Offline edits to an existing Statechart can usually be loaded to the controller with an online change without re-initializing the chart if you change transitions, conditions, priorities, actions or names. The state that was active before the online change is thus still active after the online change. 90 Version: 2.8.2 TF1910

## Page 91

UML state diagram However, in the case of an online change the Statechart is always restarted –i.e. the start state is activated – if a state or a region is added, removed or replaced. This also applies to implicit states such as the "Selection" element, or to the property for making a Statechart "abortable". TF1910 Version: 2.8.2 91

## Page 92

FAQ 8 FAQ OOP and UML Does object-oriented programming (OOP) and UML always have to be used together? • The combined use of OOP and UML offers many benefits (see next question), although it is not compulsory. Object-oriented programming of applications is also possible without using UML. Likewise, UML can be used in PLC projects, which are not based on object-oriented programming. What are the benefits of using OOP and UML together? • In order to make the most of OOP, the structure of an object-oriented software should be designed and created before the implementation (e.g. What classes are available, what is their relationship, what functionalities do they offer, etc.). Before, during and after programming, documentation helps to understand, analyze and maintain the software. • As an analysis, design and documentation tool for software, UML offers options for planning, creating and documenting the application. UML is particularly suitable for object-oriented implementations, since modular software is particularly suitable for representation with the aid of a graphical language. • For example, the class diagram is used for analyzing and creating the program structure. The more modular the software structure, the easier and more efficient the class diagram can be used (e.g. Graphical representation of separate function blocks with individual methods for providing the functionalities etc.). • The state diagram can be used to specify the sequence of a system with discrete events. The more consistent the object- and event-orientation of the software structure, the more transparent and effective the state machines can be designed (e.g. The behavior of modules/systems is based on a state model with states (such as startup, production, pause); within the states corresponding functionalities are called, which are encapsulated in methods (such as startup, execute, pause) etc.). UML state diagram methods with deactivated "Use Var Inst" option The following three queries refer to methods with the implementation language UML state diagram, which in addition meet one of the following conditions: • The state diagram method belongs to a program. • The state diagram method belongs to a function block, and the option Use Var Inst of the method is disabled. State diagram methods that meet these conditions are referred to as "the methods mentioned" in the questions below. Further information on the option Use Var Inst can be found under UML state diagram > Object properties. [} 88] Why can these methods only contain cycle-internal states, and why is there no online view? • As a general rule, all data of a method are temporary and only valid while the method is executed (stack variables). If, however, a method variable is declared as instance variable with VAR_INST, it is not stored on the methods stack, but on the stack for the function block instance. It therefore behaves like other variables of the function block instance and is not reinitialized with each call of the method. • Since the data of the state diagram method mentioned are not declared as instance variables, they are cycle-internal state machines. The states contained in the diagrams are therefore switched cycle- internally, not by the task cycle, since the method execution "restarts" with each task cycle, due to the temporary nature of the data management. Online view is therefore not available for these state diagram methods, since the variables of the state machine are temporary, and the active state can change repeatedly within a cycle. • This is in contrast to state diagrams without temporary data management (e.g. programs or function blocks as state diagram, function block method as state diagram with Use Var Inst option enabled), in which the states are switched by the task cycle as standard and can optionally be configured as "cycle- internal". Why does the tool list for the methods mentioned not contain composite states, forks and joins? 92 Version: 2.8.2 TF1910

## Page 93

FAQ • Since the data of these methods are temporary and only valid while the method is executed, the UML state diagram methods can only have cycle-internal states (see previous question). • A composite state would therefore have to be completed within a cycle. This means the element would always be processed sequentially, even if execution of a region is not completed. • This behavior would therefore be fundamentally different than for "normal" composite states, which can remember their internal state. • So as not to offer different behaviors for a composite state, depending on the POU type with which the element is used, the composite states are not allowed in the methods mentioned. • Since forks and joins are only permitted in conjunction with composite states, these elements are not available in den state diagram methods mentioned. What should be considered when programming the methods mentioned? What could be the reason for high system load when these methods are executed? • As explained under the previous questions, the UML state diagram methods are cycle-internal state machines. Therefore, they are operated cycle-internally, not based on the task cycle. • This means that completion of the actions of an internal state is followed immediately by the transition. The transition condition is checked immediately, and the transition action is executed when the condition is met. Also, the system immediately switches to the target state when the transition condition is met. • If the transition condition is not met, the system does not switch to the target state, and the current state remains active. Due to the cycle-internal states, the DO action for the current state is called again in the same cycle, if the maximum number of DO-cycle calls was not yet reached. ◦ Max. DO-cycle calls: The maximum number of DO-cycle calls for a state can be configured, whereby a value between 1 and 32767 can be set. This number indicates the maximum number of DO-action calls. • Note the following: If the transition condition is not met during the whole task cycle, the DO-action of the current active state is executed in this cycle until the maximum number of DO-cycle calls in this state is reached. Sample: If a value of 32767 is set for "max. DO-cycle calls" and the transition condition is not met during the task cycle, the DO-action of the corresponding state is executed 32767 times in a cycle! Since this could lead to high system load, depending on the scope of the DO-action, the state machine and in particular the transition condition and the maximum number of DO-cycle calls should be verified for compliance with the required application behavior. TF1910 Version: 2.8.2 93

## Page 94

Samples 9 Samples 9.1 UML class diagram 9.1.1 1 Basics This UML class diagram example illustrates the basic functionality of the UML class diagram [} 20]. Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716013451.zip Class Diagram_1 This class diagram illustrates the structure of the PLC project. It contains various PLC elements (such as function block, interface, global variable list etc.). The class diagram also illustrates the relationship between the elements (inheritance between function blocks, implementation of an interface, instantiation of a function block). Class Diagram_2 This class diagram explains and explores the following basic functionalities: • Visualize existing element from the cross-references on the diagram ◦ Display the "Toolbox" window ◦ Select FB_Info Data on the class diagram ◦ Toolbox: elements that are related to the selected element but are not included in the class diagram are displayed under the headings "Incoming cross references" and "Outgoing cross references". ◦ You can drag and drop the element onto the diagram, so that the element is shown in the class diagram. ◦ For more information see: Adding existing elements to a diagram [} 23]. • Visualize existing element from the project tree on the diagram ◦ Select an element of type POU, INTERFACE, GVL or DUT in the project tree and drag and drop it onto the opened class diagram. ◦ Drop it in a suitable location to visualize it there. ◦ The corresponding element is then displayed in the diagram. If relationships with already shown elements exist, these are displayed automatically. ◦ For more information see: Adding existing elements to a diagram [} 23]. • Adding new elements or creating new relationships between elements ◦ Use the elements of the "Toolbox" window. ◦ For more information see: Editing a class diagram [} 25] and Elements [} 28]. 9.1.2 2 Simple machine This "UML class diagram" sample illustrates the basic functionality of the UML class diagram [} 20] based on a machine with object-oriented programming. Note that the modules have not been functionally implemented. The sample is designed to describe the functionalities of the UML class diagram and to demonstrate them using an exemplary program structure. With the help of the class diagram, the structure of a PLC program can be created, extended and modified. In addition, as in this sample, the structure of a PLC program can be documented with the help of the class diagram and easily understood on the basis of this graphic. 94 Version: 2.8.2 TF1910

## Page 95

Samples Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716015115.zip Machine modules The application has the following levels and modules. Machine level: machine (FB_Machine) Subsystem level: ejection (FB_Ejector) Submodule level: cylinder with or without hardware feedback signal (FB_Cylinder, FB_Cylinder Feedback) Inheritance Since all these function blocks have common features (common data and functionalities), a base class is provided where these common features are implemented once for all function blocks. These implementations are passed on to the subclasses via the inheritance mechanism offered by object-oriented programming. • The four machine modules extend FB_Module Root. Furthermore, the cylinder with feedback functionality represents an extension of the cylinder without this functionality. Therefore, inheritance is also used here. • FB_Cylinder Feedback extends FB_Cylinder. Interface To define the requirements for different cylinder types, the basic methods and properties that a cylinder must provide are defined in an interface. • I_Cylinder defines the cylinder requirements. • FB_Cylinder implements I_Cylinder. Instantiation • MAIN instantiates FB_Machine. • FB_Machine instantiates FB_Ejector twice, since the machine has two ejector modules. • FB_Ejector instantiates I_Cylinder, FB_Cylinder and FB_Cylinder Feedback. As an example, only one cylinder is active at a time, either the cylinder with feedback functionality or the cylinder without feedback functionality. The interface variable i Cylinder is assigned the currently active cylinder instance. This allows the active cylinder to be controlled in a generalized manner via the interface variable. • FB_Module Root instantiates ST_Error. 9.2 UML state diagram In the following UML SC samples, the level of difficulty and the scope increase with ascending number of the sample. 9.2.1 1 Lamp This "UML state diagram" sample illustrates the basic functionality of the UML state diagram [} 55] and contains the following UML SC elements: • Start State [} 63] • State [} 64] • Transition [} 81] Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716016779.zip TF1910 Version: 2.8.2 95

## Page 96

Samples Overview UML SC is used to program the behavior of a lamp, which can be switched on and off via a switch on the visualization. The lamp has two states, "On" and "Off". Each state contains one ENTRY action and one DO action. • The lamp is switched on or off in the ENTRY actions. The ENTRY action is called once whenever the corresponding state is activated. • An ON or OFF counter is incremented in the DO actions. This indicates that a DO action is called permanently as long as the corresponding state is active. • The value of the switch is requested as a transition between the states. Visualization In addition to the convenient online mode [} 89] of the UML SC diagram, the behavior of the lamp and the values of the counters can be followed via the visualization. 9.2.2 2 Pedestrian traffic light This "UML state diagram" sample illustrates the basic functionality of the UML state diagram [} 55] and contains the following UML SC elements: • Start State [} 63] • State [} 64] • Transition [} 81] Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716018443.zip Overview UML SC is used to program the behavior of a pedestrian traffic light. A green-phase request can be sent via a push button on the visualization. The pedestrian traffic light has the two states, "Red" and "Green". If a green phase is requested, the traffic light switches to green after the time "c Time Wait For Green" has elapsed. The traffic light switches back to red once the time "c Time Green Phase" has elapsed. The two states "Red" and "Green" each contain an ENTRY action and a DO action. • The ENTRY actions are used to switch the traffic light to red or green. In addition, the respective timer function block (of type TON) is reset. The ENTRY action is called once whenever the corresponding state is activated. • In the DO actions a Red or Green counter is incremented. This indicates that a DO action is called permanently as long as the corresponding state is active. The respective timer function block is also called. • The Q output of the respective timer function block is used as a transition between the states, so that the state is changed after the corresponding time has elapsed. Visualization In addition to the convenient online mode [} 89] of the UML SC diagram, the behavior of the pedestrian lights, the values of the counters and the waiting time that has already elapsed can be tracked via the visualization. 9.2.3 3 Save Text simulation This "UML state diagram" sample illustrates the basic functionality of the UML state diagram [} 55] and contains the following UML SC elements: • Start State [} 63] • State [} 64] 96 Version: 2.8.2 TF1910

## Page 97

Samples • Transition [} 81] • Choice [} 80] • Composite State [} 68] • Completion Transition [} 83] Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716020107.zip Overview UML SC is used to simulate the behavior of an application in which text is to be saved in XML or text format. The information is then to be sent to a client and a master. This behavior has not actually been implemented in the sample project. Instead, the outer shell or basic structure of the state machine is implemented using UML SC as an example. States The UML SC diagram has the following states: • Init State • Xml Format • Text Format • Publish To Master • Publish To Client Counter/call frequency The states each contain a DO action and an ENTRY and/or EXIT action. Each action increments a corresponding counter. This indicates that: • the ENTRY action is called once each time the corresponding state is activated; • the EXIT action is called once each time the corresponding state is exited; • the DO action is called permanently as long as the associated state is active. Selection element If the "Xml Format" or "Text Format" state is activated, the selection element is used as a decision basis. The element has two outgoing transitions. The transition with the higher priority (i.e. with the lower priority number) is checked first. If the associated transition condition is met, the target state is activated. Composite state The "Publish To Master" and "Publish To Client" states are located in different regions of a composite state, so that they are processed in pseudo-parallel mode. This means that both states are active simultaneously, but the region with the higher priority (i.e. with the lower priority number) is executed first. Colored highlighting on the visualization indicates which region was processed first. Furthermore, during the execution of the sample project it becomes apparent that the composite state is only exited when both substate machines have reached their end state. Project modification possible: the priorities of the regions can be changed by adjusting the number in the upper right corner of the region. If you configure Region1 with priority 1 and download this change via an online change, next time you activate the composite state you can see that "Client first" is now highlighted instead of "Master first". Consequently, Region1 was executed first. Visualization In addition to the convenient online mode [} 89] of the UML SC diagram, the behavior of the state machine and the values of the counters can be tracked via the visualization. Switches on the visualization facilitate switching back and forth between the states. TF1910 Version: 2.8.2 97

## Page 98

Samples The values of the transition conditions can be changed not only via the visualization or the declaration editor of the FB, but also directly via the UML SC diagram. If the transition consists of only one transition variable, the value of the variable can be changed for writing or forcing by double-clicking on the monitoring value. If a value was prepared for writing or forcing, this is indicated in the upper right-hand corner of the monitoring area (see also: Online Mode [} 89]). 9.2.4 4 Call Behavior - Basis This "UML state diagram" sample illustrates the basic calling behavior of the UML state diagram [} 55] and includes the following UML SC elements: • Start State [} 63] • State [} 64] • Transition [} 81] • Composite State [} 68] • Completion Transition [} 83] • Exception Transition [} 84] Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716021771.zip Overview The following sub-aspects illustrate the call behavior of states and composite states. With the help of different programming means the different calling aspects are illustrated (programming tools => calling aspect). • Counter => Call frequency • Entering the called state action in an array => Call sequence • Task cycle IDs => Assignment of the call to the cycle ID The respective assignment of the programming tools to the call aspect is explained below. Both use cases are applied for the composite state: • Grouping/Nesting, in which case the composite state has its own ENTRY/DO/EXIT actions • Parallel sub-state machines Counter => Call frequency Each ENTRY/DO/EXIT action, that is called in a state or a composite state, increments a corresponding counter. This illustrates the call frequency of an action and indicates that: • the ENTRY action is called once each time the associated (composite) state is activated; • the EXIT action is called once each time the associated (composite) state is exited; • the DO action is called permanently as long as the associated (composite) state is active; • a composite state with a region (use case Grouping/Nesting) is activated if none of the inner states was previously active and as soon as one of the inner states is activated; • a composite state with a region (use case Grouping/Nesting) remains active as long as one of the inner states is active; • a composite state with a region (use case Grouping/Nesting) is exited if one of the inner states was previously active and this state is exited so that none of the inner states is now active; • it depends on the option "Execute DO actions even if inner composite states are active" whether the DO action of an outer composite state (in the sample "Composite State1") is still called if an inner composite state is active (in the sample project: "Composite State2"). 98 Version: 2.8.2 TF1910

## Page 99

Samples Entering the called state action in an array => Call sequence Each ENTRY/DO/EXIT action that is called in a state or in a composite state enters its name (e.g. "State1__Entry") into an array. This illustrates the call sequence of the different actions and indicates that: • the basic call sequence for a state is: first ENTRY, then DO, then EXIT. In the sample project: ◦ State1__Entry ◦ State1__Do ◦ State1__Exit • if an inner state of a composite state is activated with a region (use case grouping/nesting) and if this also activates the composite state, the call sequence "from outside to inside" is: outer state EXIT, composite state ENTRY, inner state ENTRY, composite state DO, inner state DO. In the sample project: ◦ State1__Exit ◦ Comp1_Entry ◦ State2__Entry ◦ Comp1_Do ◦ State2__Do • an inner composite state can be exited via a (pseudo) exception transition of the outer composite state (in the sample project via the transitions: e Leave Comp1_To State1, e Leave Comp1_To Comp3). • if a composite state is exited e.g. via a (pseudo) exception transition, the calling sequence "from inside to outside" is: inner state EXIT, if necessary inner composite state EXIT, outer composite state EXIT, outer state ENTRY. In the sample project: ◦ State4__Exit ◦ Comp2_Exit ◦ Comp1_Exit ◦ State1__Entry / State7__Entry • in a composite state with several regions, the region with the higher priority, i.e. with the lower priority number, is called first. In the sample project: ◦ State7__Entry ◦ State7__Do ◦ State6__Entry ◦ State6__Do Task cycle IDs => Assignment of the call to the cycle ID Each ENTRY/DO/EXIT action that is called in a state or a composite state stores the cycle ID of the first and last call. This illustrates which call takes place in which cycle and indicates that: • if a state is activated, the ENTRY and DO actions are called within the same cycle. In the screenshot "Visu_B_Calling Order_Cycle Nr" of the ZIP: ◦ State1 / ENTRY-Call: 516 (ID of the cycle in which the call occurred) ◦ State1 / DO-First Call: 516 • if a state is exited, the EXIT action is called in the following cycle of the last DO call. In the screenshot "Visu_B_Calling Order_Cycle Nr" of the ZIP: ◦ State1 / DO-Last Call: 1415 ◦ State1 / EXIT-Call: 1416 • if a state is exited, the EXIT action of that state is called in the same cycle as the ENTRY and DO actions of the activated state. In the screenshot "Visu_B_Calling Order_Cycle Nr" of the ZIP: ◦ State2 / DO-Last Call: 1762 ◦ State2 / EXIT-Call: 1763 ◦ State3 / ENTRY-Call: 1763 TF1910 Version: 2.8.2 99

## Page 100

Samples ◦ State3 / DO-First Call: 1763 • if a state is exited and a composite state with a region and its own actions is activated, the EXIT action of the exited state is called in the same cycle as the ENTRY and DO actions of the activated (composite) state. In the screenshot "Visu_B_Calling Order_Cycle Nr" of the ZIP: ◦ State1 / DO-Last Call: 1415 ◦ State1 / EXIT-Call: 1416 ◦ Composite State1 / ENTRY-Call: 1416 ◦ State2 / ENTRY-Call: 1416 ◦ Composite State1 / DO-First Call: 1416 ◦ State2 / DO-First Call: 1416 • if a composite state with a region and its own actions is exited via a pseudo exception transition, the EXIT action of the exited (composite) state is called in the same cycle as the ENTRY and DO actions of the activated state. In the screenshot "Visu_B_Calling Order_Cycle Nr" of the ZIP: ◦ Composite State1 / DO-Last Call: 2367 ◦ Composite State2 / DO-Last Call: 2367 ◦ State4 / DO-Last Call: 2367 ◦ State4 / EXIT-Call: 2368 ◦ Composite State2 / EXIT-Call: 2368 ◦ Composite State1 / EXIT-Call: 2368 ◦ State7 / ENTRY-Call: 2368 ◦ State7 / DO-First Call: 2368 ◦ State6 / ENTRY-Call: 2368 ◦ State6 / DO-First Call: 2368 • if a composite state with a region and its own actions is exited via an exception transition, the EXIT action of the exited (composite) state is called in the same cycle as the last call of the DO action of the exited (composite) state and as the ENTRY and DO actions of the activated state. For example (not shown in the screenshot "Visu_B_Calling Order_Cycle Nr" of the ZIP): ◦ Composite State1 / DO-Last Call: 1050 ◦ Composite State2 / DO-Last Call: 1050 ◦ State4 / DO-Last Call: 1050 ◦ State4 / EXIT-Call: 1050 ◦ Composite State2 / EXIT-Call: 1050 ◦ Composite State1 / EXIT-Call: 1050 ◦ State1 / ENTRY-Call: 1050 ◦ State1 / DO-First Call: 1050 Visualization In addition to the convenient online mode [} 89] of the UML SC diagram, the behavior of the state machine and the values of the counters, the table and the task cycle IDs can be tracked via the visualizations. The visualization also contains switches for switching between the states and for resetting the values. In order to facilitate familiarization with the sample project, two visualizations with different information content are included: • Visu_A_Calling Order contains: ◦ Counter => Call frequency ◦ Entering the called state action in an array => Call sequence • Visu_B_Calling Order_Cycle Nr extends Visu_A by: ◦ Task cycle IDs => Assignment of the call to the cycle ID 100 Version: 2.8.2 TF1910

## Page 101

Samples The values of the transition conditions can be changed not only via the visualization or the declaration editor of the FB, but also directly via the UML SC diagram. If the transition consists of only one transition variable, the value of the variable can be changed for writing or forcing by double-clicking on the monitoring value. If a value was prepared for writing or forcing, this is indicated in the upper right-hand corner of the monitoring area (see also: Online Mode [} 89]). 9.2.5 5 Call behavior - transition action Basic sample This "UML state diagram" sample is based on the sample 4 Call Behavior - Basis [} 98]. All elements and calling aspects of sample 4 are also contained in this sample, so that the explanations there also apply to this sample and are necessary for understanding this sample. Only the additions to sample 4 are described below. Therefore, please read the description of sample 4 first. Complementing sample 4 Call Behavior - Basis [} 98], this "UML state diagram" sample illustrates another aspect of the call behavior from UML state diagram [} 55]. For this purpose, the following UML SC elements are additionally included: • Transitions with transition actions (Transition [} 81], Completion Transition [} 83], Exception Transition [} 84]) Sample project: https://infosys.beckhoff.com/content/1033/TF1910_Tc3_UML/Resources/11716023435.zip Overview: The following sub-aspects illustrate the call behavior of states, composite states and transitions. With the help of different programming means the different calling aspects are illustrated (programming tools => calling aspect). • Counter => Call frequency • Entering the called state action in an array => Call sequence • Task cycle IDs => Assignment of the call to the cycle ID The respective assignment of the programming tools to the call aspect is explained below. Counter => Call frequency: A transition action is called once when the state transition is executed via the transition. Entering the called state action in an array => Call sequence: Each action called in a state, composite state or transition enters its name (e.g. "State1__Entry" or "Transition_Leave State1") into an array. This illustrates the call sequence of the different actions and indicates that: • the basic call sequence for a state is: first ENTRY, DO, EXIT and then the transition action. Then the ENTRY action of the newly activated state is called. In the sample project: ◦ State2__Exit ◦ Transition_Leave State2 ◦ State3__Entry • if an inner state of a composite state is activated with a region (use case grouping/nesting) and if this also activates the composite state, the call sequence "from outside to inside" is: outer state EXIT, transition action, composite state ENTRY, inner state ENTRY, composite state DO, inner state DO. In the sample project: ◦ State1__Exit ◦ Transition_Leave State1 ◦ Comp1_Entry TF1910 Version: 2.8.2 101

## Page 102

Samples ◦ State2__Entry ◦ Comp1_Do ◦ State2__Do • if a composite state is exited e.g. via a (pseudo) exception transition, the calling sequence "from inside to outside" is: inner state EXIT, if necessary inner composite state EXIT, outer composite state EXIT, transition action, outer state ENTRY. In the sample project: ◦ State4__Exit ◦ Comp2_Exit ◦ Comp1_Exit ◦ Transition_Leave Comp1_To Comp3 ◦ State7__Entry Task cycle IDs => Assignment of the call to the cycle ID: Each action called in a state, composite state or transition stores the cycle ID of the respective first and last call. This illustrates which call takes place in which cycle and indicates that: • the state transition is executed in the following cycle after the transition condition is met, and that when a state is exited, the transition action is called in the same cycle as the EXIT action of the exited state and as the ENTRY and DO actions of the activated state. In the screenshot "Visu_Calling Order_Cycle Nr" of the ZIP: ◦ State2 / DO-Last Call: 1233 (ID of the cycle in which the call occurred) ◦ Transition / Rising Edge: 1233 ◦ State2 / EXIT-Call: 1234 ◦ Transition-Call: 1234 ◦ State3 / ENTRY-Call: 1234 ◦ State3 / DO-First Call: 1234 • if a state is exited and a composite state with a region and its own actions is activated, the transition action is called in the same cycle as the EXIT action of the exited state and as the ENTRY and DO actions of the activated (composite) state. In the screenshot "Visu_Calling Order_Cycle Nr" of the ZIP: ◦ State1 / DO-Last Call: 1055 ◦ Transition / Rising Edge: 1055 ◦ State1 / EXIT-Call: 1056 ◦ Transition / Call: 1056 ◦ Composite State1 / ENTRY-Call: 1056 ◦ State2 / ENTRY-Call: 1056 ◦ Composite State1 / DO-First Call: 1056 ◦ State2 / DO-First Call: 1056 • if a composite state with a region and its own actions is deactivated, the transition action is called in the same cycle as the EXIT action of the exited (composite) state and as the ENTRY and DO actions of the activated state. In the screenshot "Visu_Calling Order_Cycle Nr" of the ZIP: ◦ Composite State1 / DO-Last Call: 1743 ◦ Composite State2 / DO-Last Call: 1743 ◦ State4 / DO-Last Call: 1743 ◦ Transition / Rising Edge: 1743 ◦ State4 / EXIT-Call: 1744 ◦ Composite State2 / EXIT-Call: 1744 ◦ Composite State1 / EXIT-Call: 1744 ◦ Transition / Call: 1744 102 Version: 2.8.2 TF1910

## Page 103

Samples ◦ State7 / ENTRY-Call: 1744 ◦ State7 / DO-First Call: 1744 ◦ State6 / ENTRY-Call: 1744 ◦ State6 / DO-First Call: 1744 Visualization: In addition to the convenient online mode [} 89] of the UML SC diagram, the behavior of the state machine and the values of the counters, the table and the task cycle IDs can be tracked via the visualizations. The visualization also contains switches for switching between the states and for resetting the values. The values of the transition conditions can be changed not only via the visualization or the declaration editor of the FB, but also directly via the UML SC diagram. If the transition consists of only one transition variable, the value of the variable can be changed for writing or forcing by double-clicking on the monitoring value. If a value was prepared for writing or forcing, this is indicated in the upper right-hand corner of the monitoring area (see also: Online Mode [} 89]). TF1910 Version: 2.8.2 103

## Page 104

Support and Service 10 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com 104 Version: 2.8.2 TF1910

## Page 105

Trademark statements Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Third-party trademark statements Arm, Arm9 and Cortex are trademarks or registered trademarks of Arm Limited (or its subsidiaries or affiliates) in the US and/or elsewhere. Intel, the Intel logo, Intel Core, Xeon, Intel Atom, Celeron and Pentium are trademarks of Intel Corporation or its subsidiaries.

## Page 106

More Information: www.beckhoff.com/tf1910 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
