---
title: "TwinCAT_3_PLC_Lib_Tc3_MC2_AdvancedHoming_EN"
product: "TwinCAT"
category: "PLC"
tags: ["ADVANCED", "CAT", "HOMING", "LIB", "PLC", "TWIN"]
language: "EN"
document_type: "Library"
version: "1.7.6"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TwinCAT_3_PLC_Lib_Tc3_MC2_AdvancedHoming_EN.pdf"
release_date: "2025-05-26"
---
Manual | EN TE1000 Twin CAT 3 | PLC Library: Tc3_MC2_Advanced Homing 2025-05-26 | Version: 1.7.6
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 2.1 Requirements.................................................................................................................................... 8 2.2 Homing procedures........................................................................................................................... 8 2.3 Function blocks................................................................................................................................. 9 2.4 Structure of custom homing sequences............................................................................................ 9 3 Function blocks....................................................................................................................................... 11 3.1 Finalizing functions.......................................................................................................................... 11 3.1.1 MC_Finish Homing............................................................................................................ 11 3.1.2 MC_Home Direct............................................................................................................... 12 3.1.3 MC_Abort Homing............................................................................................................. 14 3.2 Referencing functions (passive)...................................................................................................... 15 3.2.1 MC_Abort Passive Homing................................................................................................ 15 3.2.2 MC_Step Reference Flying Ref Pulse................................................................................. 16 3.2.3 MC_Step Reference Flying Switch..................................................................................... 18 3.3 Step functions................................................................................................................................. 19 3.3.1 MC_Step Absolute Switch.................................................................................................. 19 3.3.2 MC_Step Absolute Switch Detection.................................................................................. 22 3.3.3 MC_Step Block................................................................................................................. 26 3.3.4 MC_Step Block Detection.................................................................................................. 28 3.3.5 MC_Step Block Lag Based................................................................................................. 31 3.3.6 MC_Step Block Lag Based Detection.................................................................................. 33 3.3.7 MC_Step Limit Switch........................................................................................................ 35 3.3.8 MC_Step Limit Switch Detection......................................................................................... 38 3.3.9 MC_Step Reference Pulse................................................................................................. 40 3.3.10 MC_Step Reference Pulse Detection................................................................................. 42 4 Data types................................................................................................................................................ 45 4.1 General........................................................................................................................................... 45 4.1.1 E_Homing Error Codes...................................................................................................... 45 4.1.2 MC_Home_Direction........................................................................................................ 45 4.1.3 MC_Ref_Signal_Ref........................................................................................................ 46 4.1.4 MC_Switch_Mode............................................................................................................ 46 4.1.5 ST_Home_Options........................................................................................................... 47 4.1.6 ST_Home_Options2......................................................................................................... 47 4.1.7 ST_Home_Options3......................................................................................................... 47 4.1.8 ST_Home_Options4......................................................................................................... 48 4.2 Parameter....................................................................................................................................... 48 4.2.1 MC_Homing Parameter.................................................................................................... 48 4.2.2 MC_Homing Parameter Ctrl Mode...................................................................................... 48 4.2.3 MC_Homing Parameter Drive............................................................................................ 49 TE1000 Version: 1.7.6 3
## Page 4

Table of contents 4.2.4 MC_Homing Parameter Drive General............................................................................... 49 4.2.5 MC_Homing Parameter Nc................................................................................................ 49 4.2.6 MC_Homing Parameter Nc General................................................................................... 50 5 Appendix.................................................................................................................................................. 51 5.1 Samples.......................................................................................................................................... 51 4 Version: 1.7.6 TE1000
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, ATRO® , Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, MX-System®, Safety over Ether CAT®, TC/BSD®, Twin CAT®, Twin CAT/BSD®, Twin SAFE®, XFC®, XPlanar®, and XTS® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany. Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. TE1000 Version: 1.7.6 5
## Page 6

Foreword Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.7.6 TE1000
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TE1000 Version: 1.7.6 7
## Page 8

Overview 2 Overview The Twin CAT Motion Control PLC library Tc3_MC2_Advanced Homing includes function blocks for programming machine applications. The Tc3_MC2_Advanced Homing is based on the similarly revised PLCopen specification for Motion Control function blocks V2.0. This library contains function blocks of Part 5 – Homing Procedures (www. PLCopen.org). Twin CAT Version The Tc3_MC2_Advanced Homing library can be used with Twin CAT version 3.1 Build 4020 or higher. With remote programmed controllers care must be taken that an appropriate version is installed on both the programmer PC and the control PC. In the case of control systems with the operating system Windows CE, the version of the installed image is decisive. 2.1 Requirements In order to use referencing sequences that limit the torque or use the current torque as detection variable, it is necessary to ensure that the current torque is present and linked in the process image of the drive controller. In addition, in the dialog of the Nc drive on the parameter page under Torque and Acceleration Scaling, the Input Scaling Factor (Actual Torque) must be > = 0.0 and set to the correct value (0.1 scales the value for the AX5000 in %): 2.2 Homing procedures Until now referencing procedures have been treated as separate sequences during the start phase of a machine or axis. The actual sequence was not visible to the user. In order to gain more control on the referencing sequence itself, user-specific referencing procedures can now be programmed: 8 Version: 1.7.6 TE1000
## Page 9

Overview • Home Absolute Switch – homing to a sensor with movement range limit position sensors • Home Limit Switch – homing to a movement range limit position sensor • Home Block – homing to a mechanical fixed stop • Home Reference Pulse – homing to the zero track of an encoder • Home Direct – static homing, position is set to the user position • Home Absolute - static homing, position is set to the position of a reference encoder 2.3 Function blocks In order to give the user control over the various referencing procedures, a number of additional function blocks (FBs) is defined. It is possible to describe complex referencing procedures by concatenating these FBs. "Step" function blocks The following FBs are suitable for the homing procedures and are executed in the axis state "Homing" or place the axis in this state. The axis state is not changed after completion, i.e. the axis remains in the "Homing" state afterwards. • MC_Step Absolute Switch / MC_Step Absolute Switch Detection • MC_Step Limit Switch / MC_Step Limit Switch Detection • MC_Step Block / MC_Step Block Detection / MC_Step Block Lag Based / MC_Step Block Lag Based Detection • MC_Step Reference Pulse / MC_Step Reference Pulse Detection Finalizing function blocks These FBs lead to the final position and change the axis state from "Homing" to "Standstill". • MC_Home Direct • MC_Home Absolute • MC_Finish Homing • MC_Abort Homing Function blocks for flying homing In addition, FBs are required that can be executed while the machine is running. The axis state is not "Homing", nor is it changed to this state. These FBs therefore have no effect on the state diagram (cf. PLCopen). Like administrative FBs they can be called in any movement states. • MC_Step Reference Flying Switch • MC_Step Reference Flying Ref Pulse • MC_Abort Passive Homing 2.4 Structure of custom homing sequences User-specific homing sequences can be created in a simple manner from the available function blocks. Note that when doing so every sequence must always be ended by a finalizing FB so that, if necessary, modified parameters of the Twin CAT NC or the drive controller can be reconstructed and the "Homing State" is also changed correspondingly. Example: structure of a "Home-on-block" sequence A "Home-on-block" sequence can be built very easily by using the function blocks MC_Step Block and depending on the result of the function block MC_Finish Homing or MC_Abort Homing. The MC_Step Block is parameterized and triggered accordingly. If the sequence contained therein is run through without errors (Done = TRUE), the function block MC_Finish Homing is called at the end. In the other case (Error = TRUE or Command Aborted = TRUE) a MC_Abort Homing is called to terminate the sequence. TE1000 Version: 1.7.6 9
## Page 10

Overview Also see Samples [} 51]. 10 Version: 1.7.6 TE1000
## Page 11

Function blocks 3 Function blocks 3.1 Finalizing functions 3.1.1 MC_Finish Homing MC_Finish Homing Execute BOOL BOOL Done Distance LREAL BOOL Busy Velocity LREAL BOOL Command Aborted Acceleration LREAL BOOL Error Deceleration LREAL UDINT Error ID Jerk LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options2 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter The MC_Finish Homing function block completes a successful homing sequence and ensures that modified parameters are reset to their original values. Optionally, the function block can send a motion command, e.g. to release a switch or end stop. A Distance must be specified for the movement. To complete a homing sequence (not when using exclusively passive homing functions [} 15]) it is necessary to call a finalizing function block. Inputs VAR_INPUT Execute : BOOL; Distance : LREAL; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options2; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge. Distance LREAL Distance by which the axis moves away from the current position. Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0), if the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Buffer Mode MC_Buffer Mode Not implemented Options ST_Home_Options2 Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). [} 47] TE1000 Version: 1.7.6 11
## Page 12

Function blocks If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted, or Error, is set. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.1.2 MC_Home Direct MC_Home Direct Execute BOOL BOOL Done Set Position LREAL BOOL Busy Buffer Mode MC_Buffer Mode BOOL Active Options ST_Home_Options2 BOOL Command Aborted ↔ Axis Reference To AXIS_REF BOOL Error ↔ Parameter Reference To MC_Homing Parameter UDINT Error ID The MC_Home Direct function block completes a successful homing sequence, resets the axis to a defined value and ensures that modified parameters are reset to their original values. The axis leaves the homing state. To complete a homing sequence (not when using passive homing functions exclusively) it is necessary to call a finalizing FB. 12 Version: 1.7.6 TE1000
## Page 13

Function blocks Inputs VAR_INPUT Execute : BOOL; Set Position : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options2; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge. Set Position LREAL Position value to which the axis position is set to. Buffer Mode MC_Buffer Mode Currently not implemented Options ST_Home_Options2 [} 47] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. TE1000 Version: 1.7.6 13
## Page 14

Function blocks Name Type Description Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.1.3 MC_Abort Homing MC_Abort Homing Execute BOOL BOOL Done Options ST_Home_Options2 BOOL Busy ↔ Axis Reference To AXIS_REF BOOL Command Aborted ↔ Parameter Reference To MC_Homing Parameter BOOL Error UDINT Error ID The MC_Abort Homing function block aborts a homing sequence and ensures that modified parameters are reset to their original values. The axis leaves the homing state. To complete a homing sequence (not when using passive homing functions exclusively) it is necessary to call a finalizing FB. Inputs VAR_INPUT Execute : BOOL; Options : ST_Home_Options2; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge. Options ST_Home_Options2 Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). [} 47] If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. 14 Version: 1.7.6 TE1000
## Page 15

Function blocks Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted, or Error, is set. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.2 Referencing functions (passive) 3.2.1 MC_Abort Passive Homing MC_Abort Passive Homing Execute BOOL BOOL Done Options ST_Home_Options BOOL Busy ↔ Axis Reference To AXIS_REF BOOL Active BOOL Command Aborted BOOL Error UDINT Error ID Inputs VAR_INPUT Execute : BOOL; Options : ST_Home_Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Options ST_Home_Options Currently not used. Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. TE1000 Version: 1.7.6 15
## Page 16

Function blocks Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.2.2 MC_Step Reference Flying Ref Pulse MC_Step Reference Flying Ref Pulse Execute BOOL BOOL Done Reference Signal MC_Ref_Signal_Ref BOOL Busy Set Position LREAL BOOL Active Time Limit TIME BOOL Command Aborted Distance Limit LREAL BOOL Error Buffer Mode MC_Buffer Mode UDINT Error ID Options ST_Home_Options ↔ Axis Reference To AXIS_REF The function block MC_Step Reference Flying Ref Pulse performs referencing during a running movement to the zero pulse of an encoder. The execution does not start or modify any movement itself. Inputs VAR_INPUT Execute : BOOL; Reference Signal : MC_Ref_Signal_Ref; Set Position : LREAL; Time Limit : TIME; Distance Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options; END_VAR 16 Version: 1.7.6 TE1000
## Page 17

Function blocks Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Reference Signal MC_Ref_Signal_Ref Configuration of the reference signal source. [} 46] Set Position LREAL Position value that the axis position is set to. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Buffer Mode MC_Buffer Mode Currently not implemented. Options ST_Home_Options Currently not used. Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TE1000 Version: 1.7.6 17
## Page 18

Function blocks 3.2.3 MC_Step Reference Flying Switch MC_Step Reference Flying Switch Execute BOOL BOOL Done Switch Mode MC_Switch_Mode BOOL Busy Reference Signal MC_Ref_Signal_Ref BOOL Active Set Position LREAL BOOL Command Aborted Time Limit TIME BOOL Error Distance Limit LREAL UDINT Error ID Buffer Mode MC_Buffer Mode Options ST_Home_Options ↔ Axis Reference To AXIS_REF The function block MC_Step Reference Flying Switch performs referencing during a running movement via an absolutely positioned external physical switch. The execution does not start or modify any movement itself. Inputs VAR_INPUT Execute : BOOL; Switch Mode : BOOL; Reference Signal : MC_Ref_Signal_Ref; Set Position : LREAL; Time Limit : TIME; Distance Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Switch Mode BOOL Enumeration that defines the final condition for the search procedure. Reference Signal MC_Ref_Signal_Ref [} 46] Configuration of the reference signal source. Set Position LREAL Position value that the axis position is set to. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Buffer Mode MC_Buffer Mode Currently not implemented. Options ST_Home_Options Currently not used. Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; 18 Version: 1.7.6 TE1000
## Page 19

Function blocks Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.3 Step functions 3.3.1 MC_Step Absolute Switch MC_Step Absolute Switch Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Switch Mode MC_Switch_Mode BOOL Active Reference Signal MC_Ref_Signal_Ref BOOL Command Aborted Velocity LREAL BOOL Error Acceleration LREAL UDINT Error ID Deceleration LREAL Jerk LREAL Set Position LREAL Time Limit TIME Distance Limit LREAL Torque Limit LREAL Positive Limit Switch BOOL Negative Limit Switch BOOL Buffer Mode MC_Buffer Mode Options ST_Home_Options4 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block searches for an absolutely positioned, external physical switch. In general, an absolute switch has two "off" areas and one "on" area. TE1000 Version: 1.7.6 19
## Page 20

Function blocks If the absolute switch cannot be overcrossed, then it has only one "off" area and one "on" area. Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Switch Mode : MC_Switch_Mode; Reference Signal : MC_Ref_Signal_Ref; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Set Position : LREAL; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Positive Limit Switch : BOOL; Negative Limit Switch : BOOL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options4; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Switch Mode MC_Switch_Mode [} 46] Enumeration that defines the final condition for the search procedure. 20 Version: 1.7.6 TE1000
## Page 21

Function blocks Name Type Description Reference Signal MC_Ref_Signal_Ref [} 46] This structure defines the source of the reference cam signal. Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Set Position LREAL Position value that the axis position will be set to. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value in order to avoid mechanical damage. Positive Limit Switch BOOL Signal of the hardware limit switch in the logically positive direction of movement (Positive Limit Switch = FALSE within the permissible travel range). Negative Limit Switch BOOL Signal of the hardware limit switch in the logically negative direction of movement (Negative Limit Switch = FALSE within the permissible travel range). Buffer Mode MC_Buffer Mode Not implemented Options ST_Home_Options4 [} 48] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Enable Lag Error Detection: In the step functions, the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. TE1000 Version: 1.7.6 21
## Page 22

Function blocks Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.3.2 MC_Step Absolute Switch Detection MC_Step Absolute Switch Detection Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Switch Mode MC_Switch_Mode BOOL Active Reference Signal MC_Ref_Signal_Ref BOOL Command Aborted Velocity LREAL BOOL Error Acceleration LREAL UDINT Error ID Deceleration LREAL LREAL Recorded Position Jerk LREAL Time Limit TIME Distance Limit LREAL Torque Limit LREAL Positive Limit Switch BOOL Negative Limit Switch BOOL Buffer Mode MC_Buffer Mode Options ST_Home_Options4 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block searches for an absolutely positioned, external physical switch. In general, an absolute switch has two "off" areas and one "on" area. 22 Version: 1.7.6 TE1000
## Page 23

Function blocks If the absolute switch cannot be overcrossed, then it has only one "off" area and one "on" area. The ".. Detection" version of this function block does not manipulate the current position of the axis at the end of the sequence, but instead returns the detected position to the user as "Recorded Position". Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Switch Mode : MC_Switch_Mode; Reference Signal : MC_Ref_Signal_Ref; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Positive Limit Switch : BOOL; Negative Limit Switch : BOOL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options4; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] TE1000 Version: 1.7.6 23
## Page 24

Function blocks Name Type Description Switch Mode MC_Switch_Mode [} 46] Enumeration that defines the final condition for the search procedure. Reference Signal MC_Ref_Signal_Ref [} 46] This structure defines the source of the reference cam signal. Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value in order to avoid mechanical damage. Positive Limit Switch BOOL Signal of the hardware limit switch in the logically positive direction of movement (Positive Limit Switch = FALSE within the permissible travel range). Negative Limit Switch BOOL Signal of the hardware limit switch in the logically negative direction of movement (Negative Limit Switch = FALSE within the permissible travel range). Buffer Mode MC_Buffer Mode Not implemented Options ST_Home_Options4 [} 48] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Enable Lag Error Detection: In the step functions, the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. 24 Version: 1.7.6 TE1000
## Page 25

Function blocks Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; Recorded Position : LREAL; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. When Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Recorded Position LREAL Axis position at which the event was recorded. Sample for an AX8000 (Co E DS402) VAR axis : AXIS_REF; Homing Parameters : MC_Homing Parameter; Execute Home Detection : BOOL; Reference Signal : MC_Ref_Signal_Ref; Step Absolute Switch Detection : MC_Step Absolute Switch Detection; Recorded Position : LREAL; END_VAR Reference Signal. Touch Probe := Touch Probe1; Reference Signal. Signal Source := Signal Source_Drive Defined; Step Absolute Switch Detection( Axis := axis, Parameter := Homing Parameters, Execute := Execute Home Detection, Direction := mc Negative Direction , // mc Positive Direction Switch Mode := mc Rising Edge, // mc Falling Edge Reference Signal := Reference Signal, Velocity := 20, Acceleration := , Deceleration := , Jerk := , Time Limit := , Distance Limit := , Torque Limit := 100, Positive Limit Switch := , Negative Limit Switch := , Buffer Mode := , Options := , Done => , Busy => , Active => , Command Aborted => , Error => , Error ID => , Recorded Position => Recorded Position); TE1000 Version: 1.7.6 25
## Page 26

Function blocks 3.3.3 MC_Step Block MC_Step Block Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Velocity LREAL BOOL Active Acceleration LREAL BOOL Command Aborted Deceleration LREAL BOOL Error Jerk LREAL UDINT Error ID Set Position LREAL Detection Velocity Limit LREAL Detection Velocity Time TIME Time Limit TIME Distance Limit LREAL Torque Limit LREAL Torque Tolerance LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options3 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block performs the search for a physical object that mechanically blocks the movement. To avoid mechanical damage, the movement is usually performed with reduced torque ("Torque Limit"). Since the actual value is subject to fluctuations, a tolerance must also be specified ("Torque Tolerance"). The condition for successful completion of the sequence consists of two parts. Firstly, the torque within the specified "Torque Tolerance" must correspond to the "Torque Limit" and secondly, the actual velocity for the time "Detection Velocity Time" must be below the "Detection Velocity Limit". Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Set Position : LREAL; Detection Velocity Limit : LREAL; Detection Velocity Time : TIME; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Torque Tolerance : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options3; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. 26 Version: 1.7.6 TE1000
## Page 27

Function blocks Name Type Description Set Position LREAL Position value that the axis position will be set to. Detection Velocity Limit LREAL Limit velocity that must be adhered to (value must be below this) for the time Detection Velocity Time in order to detect driving against the fixed stop. Detection Velocity Time TIME Time for detecting the velocity undershoot when driving against the fixed stop. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value, in relation to the weight counterbalance that is potentially parameterized in the drive, in order to avoid mechanical damage. Torque Tolerance LREAL Tolerance based on the Torque Limit within which driving against the fixed stop is detected within this Torque Limit. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options3 [} 47] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Instant Lag Reduction: When referencing to a mechanical fixed stop, the sudden stop produces a lag error in the NC axis, which is dissipated with the parameterized dynamic values in the further course. This can lead to an assumed delay when observing the sequence, but it is useful with "soft" fixed stops in particular. The lag error is dissipated abruptly by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; TE1000 Version: 1.7.6 27
## Page 28

Function blocks Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.3.4 MC_Step Block Detection MC_Step Block Detection Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Velocity LREAL BOOL Active Acceleration LREAL BOOL Command Aborted Deceleration LREAL BOOL Error Jerk LREAL UDINT Error ID Detection Velocity Limit LREAL LREAL Recorded Position Detection Velocity Time TIME Time Limit TIME Distance Limit LREAL Torque Limit LREAL Torque Tolerance LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options3 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block performs the search for a physical object that mechanically blocks the movement. To avoid mechanical damage, the movement is usually performed with reduced torque ("Torque Limit"). Since the actual value is subject to fluctuations, a tolerance must also be specified ("Torque Tolerance"). The condition for successful completion of the sequence consists of two parts. Firstly, the torque within the specified "Torque Tolerance" must correspond to the "Torque Limit" and secondly, the actual velocity for the time "Detection Velocity Time" must be below the "Detection Velocity Limit". The ".. Detection" version of this function block does not manipulate the current position of the axis at the end of the sequence, but instead returns the detected position to the user as "Recorded Position". 28 Version: 1.7.6 TE1000
## Page 29

Function blocks Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Detection Velocity Limit : LREAL; Detection Velocity Time : TIME; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Torque Tolerance : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options3; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Detection Velocity Limit LREAL Limit velocity that must be adhered to (value must be below this) for the time Detection Velocity Time in order to detect driving against the fixed stop. Detection Velocity Time TIME Time for detecting the velocity undershoot when driving against the fixed stop. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value, in relation to the weight counterbalance that is potentially parameterized in the drive, in order to avoid mechanical damage. Torque Tolerance LREAL Tolerance related to the Torque Limit within which driving against the fixed stop is detected. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options3 [} 47] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Instant Lag Reduction: When referencing to a mechanical fixed stop, the sudden stop produces a lag error in the NC axis, which is dissipated with the parameterized dynamic values in the further course. This can lead to an assumed delay when observing the sequence, but it is useful with "soft" fixed stops in particular. The lag error is dissipated abruptly by setting this flag. TE1000 Version: 1.7.6 29
## Page 30

Function blocks If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; Recorded Position : LREAL; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. When Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Recorded Position LREAL Axis position at which the event was recorded. 30 Version: 1.7.6 TE1000
## Page 31

Function blocks 3.3.5 MC_Step Block Lag Based MC_Step Block Lag Based Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Velocity LREAL BOOL Active Acceleration LREAL BOOL Command Aborted Deceleration LREAL BOOL Error Jerk LREAL UDINT Error ID Set Position LREAL Detection Velocity Limit LREAL Detection Velocity Time TIME Time Limit TIME Distance Limit LREAL Torque Limit LREAL Lag Limit LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options3 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block performs the search for a physical object that mechanically blocks the movement. To avoid mechanical damage, the movement is usually performed with reduced torque ("Torque Limit"). The condition for successful completion of the sequence consists of two parts. First, the lag error must be above the specified "Lag Limit" and second, the actual velocity for the time "Detection Velocity Time" must be below the "Detection Velocity Limit". Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Set Position : LREAL; Detection Velocity Limit : LREAL; Detection Velocity Time : TIME; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Lag Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options3; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Set Position LREAL Position value that the axis position will be set to. TE1000 Version: 1.7.6 31
## Page 32

Function blocks Name Type Description Detection Velocity Limit LREAL Limit velocity that must be adhered to (value must be below this) for the time Detection Velocity Time in order to detect driving against the fixed stop. Detection Velocity Time TIME Time for detecting the velocity undershoot when driving against the fixed stop. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value, in relation to the weight counterbalance that is potentially parameterized in the drive, in order to avoid mechanical damage. Lag Limit LREAL Position lag value which, if exceeded, leads to detection of driving against the fixed stop. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options3 [} 47] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Instant Lag Reduction: When referencing to a mechanical fixed stop, the sudden stop produces a lag error in the NC axis, which is dissipated with the parameterized dynamic values in the further course. This can lead to an assumed delay when observing the sequence, but it is useful with "soft" fixed stops in particular. The lag error is dissipated abruptly by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR 32 Version: 1.7.6 TE1000
## Page 33

Function blocks Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.3.6 MC_Step Block Lag Based Detection MC_Step Block Lag Based Detection Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Velocity LREAL BOOL Active Acceleration LREAL BOOL Command Aborted Deceleration LREAL BOOL Error Jerk LREAL UDINT Error ID Detection Velocity Limit LREAL LREAL Recorded Position Detection Velocity Time TIME Time Limit TIME Distance Limit LREAL Torque Limit LREAL Lag Limit LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options3 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block performs a search for a physical object that mechanically blocks the movement. To avoid mechanical damage, the movement is usually performed with reduced torque ("Torque Limit"). The condition for successful completion of the flow consists of 2 parts. First, the lag error must be above the specified "Lag Limit" and second, the actual velocity for the time "Detection Velocity Time" must be below the "Detection Velocity Limit". The "…Detection" version of this function block does not manipulate the current position of the axis at the end of the sequence, but instead returns the detected position to the user as "Recorded Position". Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Velocity : LREAL; Acceleration : LREAL; TE1000 Version: 1.7.6 33
## Page 34

Function blocks Deceleration : LREAL; Jerk : LREAL; Set Position : LREAL; Detection Velocity Limit : LREAL; Detection Velocity Time : TIME; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Lag Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options3; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Set Position LREAL Position value that the axis position will be set to. Detection Velocity Limit LREAL Limit velocity that must be adhered to (value must be below this) for the time Detection Velocity Time in order to detect driving against the fixed stop. Detection Velocity Time TIME Time for detecting the velocity undershoot when driving against the fixed stop. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value, in relation to the weight counterbalance that is potentially parameterized in the drive, in order to avoid mechanical damage. Lag Limit LREAL Position lag value which, if exceeded, leads to detection of driving against the fixed stop. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options3 [} 47] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Instant Lag Reduction: When referencing to a mechanical fixed stop, the sudden stop produces a lag error in the NC axis, which is dissipated with the parameterized dynamic values in the further course. This can lead to an assumed delay when observing the sequence, but it is useful with "soft" fixed stops in particular. The lag error is dissipated abruptly by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. 34 Version: 1.7.6 TE1000
## Page 35

Function blocks / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; Recorded Position : LREAL; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. When Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Recorded Position LREAL Axis position at which the event was recorded. 3.3.7 MC_Step Limit Switch MC_Step Limit Switch Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Limit Switch Mode MC_Switch_Mode BOOL Active Limit Switch Signal MC_Ref_Signal_Ref BOOL Command Aborted Velocity LREAL BOOL Error Acceleration LREAL UDINT Error ID Deceleration LREAL Jerk LREAL Set Position LREAL Time Limit TIME Distance Limit LREAL Torque Limit LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options4 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter TE1000 Version: 1.7.6 35
## Page 36

Function blocks The function block MC_Step Limit Switch performs the search for a hardware limit switch. Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Limit Switch Mode : MC_Switch_Mode; Limit Switch Signal : MC_Ref_Signal_Ref; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Set Position : LREAL; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options4; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction [} 45] Enumeration that defines the initial direction of movement for the search procedure. Limit Switch Mode MC_Switch_Mode [} 46] Enumeration that defines the final condition for the search procedure. Limit Switch Signal MC_Ref_Signal_Ref [} 46] This structure defines the source of the reference cam signal. Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Set Position LREAL Position value that the axis position will be set to. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value in order to avoid mechanical damage. Buffer Mode ST_Home_Options4 Not implemented. Options Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Enable Lag Error Detection: In the step functions, the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to 36 Version: 1.7.6 TE1000
## Page 37

Function blocks Name Type Description keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TE1000 Version: 1.7.6 37
## Page 38

Function blocks 3.3.8 MC_Step Limit Switch Detection MC_Step Limit Switch Detection Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Limit Switch Mode MC_Switch_Mode BOOL Active Limit Switch Signal MC_Ref_Signal_Ref BOOL Command Aborted Velocity LREAL BOOL Error Acceleration LREAL UDINT Error ID Deceleration LREAL LREAL Recorded Position Jerk LREAL Time Limit TIME Distance Limit LREAL Torque Limit LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options4 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter The function block MC_Step Limit Switch Detection performs the search for a hardware limit switch. The "…Detection" version of this function block does not manipulate the current position of the axis at the end of the sequence, but instead returns the detected position to the user as "Recorded Position". Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Limit Switch Mode : MC_Switch_Mode; Limit Switch Signal : MC_Ref_Signal_Ref; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options4; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Limit Switch Mode MC_Switch_Mode [} 46] Enumeration that defines the final condition for the search procedure. Limit Switch Signal MC_Ref_Signal_Ref [} 46] This structure defines the source of the reference cam signal. Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. 38 Version: 1.7.6 TE1000
## Page 39

Function blocks Name Type Description Torque Limit LREAL The motor torque is limited to this value in order to avoid mechanical damage. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options4 [} 48] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Enable Lag Error Detection: In the step functions, the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; Recorded Position : LREAL; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. When Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Recorded Position LREAL Axis position at which the event was recorded. TE1000 Version: 1.7.6 39
## Page 40

Function blocks 3.3.9 MC_Step Reference Pulse MC_Step Reference Pulse Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Reference Signal MC_Ref_Signal_Ref BOOL Active Velocity LREAL BOOL Command Aborted Acceleration LREAL BOOL Error Deceleration LREAL UDINT Error ID Jerk LREAL Set Position LREAL Time Limit TIME Distance Limit LREAL Torque Limit LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options4 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block performs the search for a zero pulse of an encoder. A zero pulse is not present in all encoders and occurs only once per encoder revolution. The advantage of using a zero pulse for referencing is the high accuracy of this signal compared to that of a standard sensor. Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Switch Mode : MC_Switch_Mode; Reference Signal : MC_Ref_Signal_Ref; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Set Position : LREAL; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options4; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Switch Mode MC_Switch_Mode [} 46] Enumeration that defines the final condition for the search procedure. Reference Signal MC_Ref_Signal_Ref [} 46] This structure defines the source of the reference cam signal. Velocity LREAL Maximum travel velocity (>0). Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Set Position LREAL Position value that the axis position will be set to. Time Limit TIME Exceeding this time leads to the search procedure being aborted. 40 Version: 1.7.6 TE1000
## Page 41

Function blocks Name Type Description Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value in order to avoid mechanical damage. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options4 [} 48] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Enable Lag Error Detection: In the step functions the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. TE1000 Version: 1.7.6 41
## Page 42

Function blocks Name Type Description Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 3.3.10 MC_Step Reference Pulse Detection MC_Step Reference Pulse Detection Execute BOOL BOOL Done Direction MC_Home_Direction BOOL Busy Reference Signal MC_Ref_Signal_Ref BOOL Active Velocity LREAL BOOL Command Aborted Acceleration LREAL BOOL Error Deceleration LREAL UDINT Error ID Jerk LREAL LREAL Recorded Position Time Limit TIME Distance Limit LREAL Torque Limit LREAL Buffer Mode MC_Buffer Mode Options ST_Home_Options4 ↔ Axis Reference To AXIS_REF ↔ Parameter Reference To MC_Homing Parameter This function block performs the search for a zero pulse of an encoder. A zero pulse is not present in all encoders and occurs only once per encoder revolution. The advantage of using a zero pulse for referencing is the high accuracy of this signal compared to that of a standard sensor. The "…Detection" version of this function block does not manipulate the current position of the axis at the end of the sequence, but instead returns the detected position to the user as "Recorded Position". Inputs VAR_INPUT Execute : BOOL; Direction : MC_Home_Direction; Switch Mode : MC_Switch_Mode; Reference Signal : MC_Ref_Signal_Ref; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Time Limit : TIME; Distance Limit : LREAL; Torque Limit : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Home_Options4; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at the Execute input. Direction MC_Home_Direction Enumeration that defines the initial direction of movement for the search procedure. [} 45] Switch Mode MC_Switch_Mode [} 46] Enumeration that defines the final condition for the search procedure. Reference Signal MC_Ref_Signal_Ref [} 46] This structure defines the source of the reference cam signal. Velocity LREAL Maximum travel velocity (>0). 42 Version: 1.7.6 TE1000
## Page 43

Function blocks Name Type Description Acceleration LREAL Acceleration (≥0). If the value is 0, the standard acceleration from the axis configuration applies. Deceleration LREAL Deceleration (≥0). If the value is 0, the standard deceleration from the axis configuration applies. Jerk LREAL Jerk (≥0). If the value is 0, the standard jerk from the axis configuration applies. Time Limit TIME Exceeding this time leads to the search procedure being aborted. Distance Limit LREAL Exceeding this distance in relation to the start position leads to the search procedure being aborted. Torque Limit LREAL The motor torque is limited to this value in order to avoid mechanical damage. Buffer Mode MC_Buffer Mode Not implemented. Options ST_Home_Options4 [} 48] Disable Drive Access: Set to FALSE for Beckhoff drives, usually to TRUE for third-party drives (see info). Enable Lag Error Detection: In the step functions, the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. / Inputs/Outputs VAR_IN_OUT Axis : AXIS_REF; Parameter : MC_Homing Parameter; END_VAR Name Type Description Axis AXIS_REF Axis data structure of the type AXIS_REF, which uniquely addresses an axis in the system. Among other parameters it contains the current axis status, including position, velocity or error state. Parameter MC_Homing Parameter Data structure of the type MC_Homing Parameter, which must be transferred from function block to function block over the entire homing sequence. Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; Recorded Position : LREAL; END_VAR Name Type Description Done BOOL Becomes TRUE, if the command was completed successfully. TE1000 Version: 1.7.6 43
## Page 44

Function blocks Name Type Description Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. When Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done, Command Aborted or Error, is set. Active BOOL Indicates that the command is executed. Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. Recorded Position LREAL Axis position at which the event was recorded. 44 Version: 1.7.6 TE1000
## Page 45

Data types 4 Data types 4.1 General 4.1.1 E_Homing Error Codes TYPE MC_Switch_Mode : ( MC_HOMINGERROR_DRIVETYPE := 16#4B90, MC_HOMINGERROR_DIRECTION := 16#4B91, MC_HOMINGERROR_SWITCHMODE := 16#4B92, MC_HOMINGERROR_MODE := 16#4B93, MC_HOMINGERROR_TORQUEPARAMETER := 16#4B94, MC_HOMINGERROR_LAGPARAMETER := 16#4B95, MC_HOMINGERROR_DISTANCELIMIT := 16#4B96, MC_HOMINGERROR_PARAMETER_ALREADYSTORED := 16#4B97, MC_HOMINGERROR_PARAMETER_NOTSTORED := 16#4B98 ) UDINT; END_TYPE Name Description MC_HOMINGERROR_DRIVETYPE The following drives are supported: • AX5xxx-xxxx-02xx (FW>=2.05) • EL7201-0000 /-0001 / -0010 / 0011 • AX8xxx-xxxx-xxxx (FW>=???) MC_HOMINGERROR_DIRECTION Parameterized direction is not permissible for this function block. MC_HOMINGERROR_SWITCHMODE Parameterized mode is not permissible for this function block. MC_HOMINGERROR_MODE MC_HOMINGERROR_TORQUEPARAMETER Parameterized torque presets are not permissible. MC_HOMINGERROR_LAGPARAMETER Parameterized lag error is not permissible (<0). MC_HOMINGERROR_DISTANCELIMIT Parameterized maximum distance is not permissible (<0). MC_HOMINGERROR_PARAMETER_ALREADYST The MC_Step Homing Parameter function block has ORED been called again with the HOMINGPARAMETERCTRLMODE_READ mode, although parameters have already been backed up. MC_HOMINGERROR_PARAMETER_NOTSTORED The MC_Step Homing Parameter function block has been called again with the HOMINGPARAMETERCTRLMODE_RESTORE mode, although no parameters have been backed up. 4.1.2 MC_Home_Direction TYPE MC_Home_Direction : ( mc Positive Direction := 1, mc Negative Direction := 3, mc Switch Positive := 5, mc Switch Negative := 7 ); END_TYPE Name Description mc Positive Direction Movement always starts in the logically positive direction of movement. The movement direction can be reversed on reaching a movement range limit sensor or on reaching the precondition and when using mc Rising Edge Inverse or mc Falling Edge Inverse for the input of the type MC_Switch_Mode existing in some function blocks. TE1000 Version: 1.7.6 45
## Page 46

Data types Name Description mc Negative Direction Movement always starts in the logically negative direction of movement. The movement direction can be reversed on reaching a movement range limit sensor or on reaching the precondition and when using mc Rising Edge Inverse or mc Falling Edge Inverse for the input of the type MC_Switch_Mode existing in some function blocks. mc Switch Positive The direction of movement at the start depends on the current switching state of the sensor. • If the switching state of the sensor is OFF, the movement starts in logical positive direction of movement • If the switching state of the sensor is ON, the movement starts in the logically negative direction. The movement direction can be reversed on reaching a movement range limit sensor or when the sensor switching state changes. mc Switch Negative The direction of movement at the start depends on the current switching state of the sensor. • If the switching state of the sensor is OFF, the movement starts in logical negative direction of movement. • If the switching state of the sensor is ON, the movement starts in the logically positive direction. The movement direction can be reversed on reaching a movement range limit sensor or when the sensor switching state changes. 4.1.3 MC_Ref_Signal_Ref TYPE MC_Ref_Signal_Ref : STRUCT Signal Source : E_Signal Source := Signal Source_Default; Touch Probe : E_Touch Probe := Plc Event; Level : BOOL; END_STRUCT END_TYPE Name Type Description Signal Source E_Signal Source Optionally defines the signal source, if it can be selected via the controller. In many cases the signal source is permanently configured in the drive and should then be set to the default value Signal Source_Default. (Cf. E_Signal Source Tc2_MC2 library documentation) Touch Probe E_Touch Probe Defines the latch unit (probe unit) within the encoder hardware used. (Cf. E_Touch Probe Tc2_MC2 library documentation) Level BOOL The current signal state of the sensor must be transferred here. 4.1.4 MC_Switch_Mode TYPE MC_Switch_Mode : ( mc On := 1, mc Off := 2, mc Rising Edge := 3, mc Falling Edge := 4, mc Edge Switch Positive := 5, mc Edge Switch Negative := 6, mc Rising Edge Inverse := 11, mc Falling Edge Inverse := 12 ) UDINT; END_TYPE Condition for the sensor signal to stop the step function. 46 Version: 1.7.6 TE1000
## Page 47

Data types Name Description mc On Sensor is ON. mc Off Sensor is OFF. mc Rising Edge Rising edge in resulting direction for sensor signal OFF. mc Falling Edge Falling edge in resulting direction for sensor signal OFF. mc Edge Switch Positive Edge depends on moving direction. Rising edge in positive moving direction. Falling edge in negative direction. mc Edge Switch Negative Edge depends on moving direction. Falling edge in positive moving direction. Rising edge in negative direction. mc Rising Edge Inverse Rising edge of sensor signal (OFF -> ON) in opposite resulting direction for sensor signal OFF. mc Falling Edge Inverse Falling edge of sensor signal (ON -> OFF) in opposite resulting direction for sensor signal OFF. 4.1.5 ST_Home_Options TYPE MC_Home_Options : STRUCT END_STRUCT END_TYPE 4.1.6 ST_Home_Options2 TYPE MC_Home_Options2 : STRUCT Disable Drive Access : BOOL; END_STRUCT END_TYPE Name Type Description Disable Drive Access BOOL Set to FALSE for Beckhoff drives, usually TRUE for third-party drives (see info). If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. 4.1.7 ST_Home_Options3 TYPE MC_Home_Options3 : STRUCT Disable Drive Access : BOOL; Instant Lag Reduction : BOOL; END_STRUCT END_TYPE Name Type Description Disable Drive Access BOOL Set to FALSE for Beckhoff drives, usually TRUE for third-party drives (see info). Instant Lag Reduction BOOL When referencing to a mechanical fixed stop, the sudden stop produces a lag error in the NC axis, which is dissipated with the parameterized dynamic values in the further course. This can lead to an assumed delay when observing the sequence, but it is purposeful in particular with "soft" fixed stops. The lag error is dissipated abruptly by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. TE1000 Version: 1.7.6 47
## Page 48

Data types 4.1.8 ST_Home_Options4 TYPE MC_Home_Options4 : STRUCT Disable Drive Access : BOOL; Enable Lag Error Detection : BOOL; END_STRUCT END_TYPE Name Type Description Disable Drive Access BOOL Set to FALSE for Beckhoff drives, usually TRUE for third-party drives (see info). Enable Lag Error Detection BOOL In the step functions the lag error detection is switched off in order to ensure a smooth referencing process. If it would be purposeful to keep the lag error detection active in an application, this can be achieved by setting this flag. If Disable Drive Access = TRUE, the user is responsible for modifying and reconstructing required drive parameters. The parameters required for the intended homing sequence must be agreed with the manufacturer of the third-party drive. 4.2 Parameter 4.2.1 MC_Homing Parameter TYPE MC_Homing Parameter : STRUCT Stored : BOOL; Nc : MC_Homing Parameter Nc General; Drive : MC_Homing Parameter Drive General; END_STRUCT END_TYPE Name Type Description Stored BOOL This flag signals that the required parameters that are to be modified have been successfully read and are available for reconstruction at the end of the procedure. Nc MC_Homing Parameter Nc General Structure that contains the stored and modified parameter values of the NC axis Drive MC_Homing Parameter Drive General Structure that contains the stored and modified parameter values of the hardware axis controller. This structure must be made available to and passed through all homing function blocks when programming your own homing sequence. Parameters are backed up in advance, modified by the function blocks and restored upon completion of the procedure. 4.2.2 MC_Homing Parameter Ctrl Mode TYPE MC_Homing Parameter Ctrl Mode : ( HOMINGPARAMETERCTRLMODE_READ, HOMINGPARAMETERCTRLMODE_PREPARE, HOMINGPARAMETERCTRLMODE_RESTORE ) UDINT; END_TYPE 48 Version: 1.7.6 TE1000
## Page 49

Data types Name Description HOMINGPARAMETERCTRLMO This function block reads all relevant parameters of the NC axis and the DE_READ hardware axis controller. HOMINGPARAMETERCTRLMO This function block modifies all relevant parameters of the NC axis and the DE_PREPARE hardware axis controller. The parameters to be modified must be written to the parameter structure beforehand. HOMINGPARAMETERCTRLMO This function block restores the backed-up parameters of the NC axis and DE_RESTORE the hardware axis controller. The requirement is that the parameters have been successfully read beforehand. 4.2.3 MC_Homing Parameter Drive TYPE MC_Homing Parameter Drive : STRUCT Torque Max Bipolar : LREAL; Torque Max Positive : LREAL; Torque Max Negative : LREAL; END_STRUCT END_TYPE Name Type Description Torque Max Bipolar LREAL Bipolar torque limit value Torque Max Positive LREAL Torque limit value in the logically positive direction of movement Torque Max Negative LREAL Torque limit value in the logically negative direction of movement 4.2.4 MC_Homing Parameter Drive General STRUCT Stored : MC_Homing Parameter Drive; Actual : MC_Homing Parameter Drive; END_STRUCT END_TYPE Name Type Description Stored MC_Homing Parameter Drive Stored parameters for the start of the homing procedure. Actual MC_Homing Parameter Drive Modified values that vary during the procedure. 4.2.5 MC_Homing Parameter Nc TYPE MC_Homing Parameter Nc : STRUCT Enable Soft End Min Control : BOOL; Enable Soft End Max Control : BOOL; Enable Pos Diff Control : BOOL; Enable Velo Diff Control : BOOL; END_STRUCT END_TYPE Name Type Description Enable Soft End Min Control BOOL Activation of the software limit position monitoring in the logically positive direction Enable Soft End Max Control BOOL Activation of the software limit position monitoring in the logically negative direction Enable Pos Diff Control BOOL Activation of the lag error detection Enable Velo Diff Control BOOL Activation of the motion monitoring TE1000 Version: 1.7.6 49
## Page 50

Data types 4.2.6 MC_Homing Parameter Nc General STRUCT Stored : MC_Homing Parameter Nc; Actual : MC_Homing Parameter Nc; END_STRUCT END_TYPE Name Type Description Stored MC_Homing Parameter Nc Stored NC parameters for the start of the homing procedure Actual MC_Homing Parameter Nc Modified NC parameters that vary during the procedure 50 Version: 1.7.6 TE1000
## Page 51

Appendix 5 Appendix 5.1 Samples "Home-On-Block" The sample performs a homing of an AX5000 axis against a fixed stop and can be modified very easily for other drive hardware. Download: https://infosys.beckhoff.com/content/1033/Tc Plc Lib_Tc3_MC2_Advanced Homing/Resources/ 12593057419.zip TE1000 Version: 1.7.6 51
## Page 52

Trademark statements Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Third-party trademark statements Microsoft, Microsoft Azure, Microsoft Edge, Power Shell, Visual Studio, Windows and Xbox are trademarks of the Microsoft group of companies.
## Page 53

More Information: www.beckhoff.com/te1000 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
