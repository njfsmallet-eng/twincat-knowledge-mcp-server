---
title: "TF8400 Twin CAT 3"
product: "TF8400"
category: "Process_Engineering"
tags: ["CAT", "TWIN"]
language: "EN"
document_type: "Manual"
version: "1.1.1"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF8400_TC3_MTP_Runtime_EN.pdf"
release_date: "2025-02-12"
---
Manual | EN TF8400 Twin CAT 3 | MTP Runtime 2025-02-12 | Version: 1.1.1
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 6 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 Installation................................................................................................................................................. 9 3.1 Licensing........................................................................................................................................... 9 4 Technical introduction............................................................................................................................ 12 5 PLC API.................................................................................................................................................... 13 5.1 Operation modes............................................................................................................................. 13 5.1.1 Operation Mode............................................................................................................... 13 5.1.2 Source Mode.................................................................................................................... 15 5.1.3 Service Mode................................................................................................................... 17 5.2 Properties........................................................................................................................................ 18 5.2.1 Name of the object........................................................................................................... 18 5.2.2 Object description............................................................................................................ 18 5.2.3 OSLevel........................................................................................................................... 18 5.2.4 WQC................................................................................................................................ 19 5.2.5 Value scaling.................................................................................................................... 19 5.2.6 Unit................................................................................................................................... 19 5.2.7 Value limitation................................................................................................................. 20 5.2.8 Feedback......................................................................................................................... 20 5.2.9 Read back........................................................................................................................ 20 5.2.10 Handshake procedure...................................................................................................... 20 5.2.11 Locking............................................................................................................................. 20 5.2.12 Feedback monitoring........................................................................................................ 21 5.2.13 Limit value monitoring...................................................................................................... 22 5.2.14 Reset................................................................................................................................ 23 5.3 Function blocks............................................................................................................................... 24 5.3.1 Active Elements................................................................................................................ 24 5.3.2 Diagnostic Elements......................................................................................................... 59 5.3.3 Indicator Elements............................................................................................................ 69 5.3.4 Input Elements.................................................................................................................. 76 5.3.5 Output Elements............................................................................................................... 80 5.3.6 Operation Elements.......................................................................................................... 80 5.3.7 Parameter Elements......................................................................................................... 87 5.3.8 Pea Elements.................................................................................................................. 101 5.3.9 Service Elements............................................................................................................ 102 5.3.10 Report Values................................................................................................................ 114 5.4 Data types..................................................................................................................................... 117 5.4.1 ST_MTP_Input Element Config....................................................................................... 117 6 Support and Service............................................................................................................................. 119 TF8400 Version: 1.1.1 3
## Page 4

Table of contents 4 Version: 1.1.1 TF8400
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. The documentation and the following notes and explanations must be complied with when installing and commissioning the components. The trained specialists must always use the current valid documentation. The trained specialists must ensure that the application and use of the products described is in line with all safety requirements, including all relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been compiled with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. Claims to modify products that have already been supplied may not be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS®, and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of the designations or trademarks contained in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Ether CAT® is a registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document, as well as the use and communication of its contents without express authorization, are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. Third-party trademarks Trademarks of third parties may be used in this documentation. You can find the trademark notices here: https://www.beckhoff.com/trademarks. TF8400 Version: 1.1.1 5
## Page 6

Foreword 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.1.1 TF8400
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF8400 Version: 1.1.1 7
## Page 8

Overview 2 Overview The TF8400 Twin CAT 3 MTP Runtime is an IEC 61131 library for implementing the MTP interface types. The MTP interface types are based on the requirements of the MTP guideline. The following documentation is based on the VDI/VDE/NAMUR 2658 guideline. 8 Version: 1.1.1 TF8400
## Page 9

Installation 3 Installation System requirements The following system requirements must be fulfilled for proper functioning of the TF8400 Twin CAT 3 MTP Runtime. Technical data Requirement Target platform IPC or CX, (x86, x64, Arm®) Minimum Twin CAT version 3.1.4026 Required Twin CAT setup level TC1200 Twin CAT 3 PLC Twin CAT Package Manager: Installation (Twin CAT 3.1 Build 4026) Detailed instructions on installing products can be found in the chapter Installing workloads in the Twin CAT 3.1 Build 4026 installation instructions. Install the following package on the command line to be able to use the product: • Twin CAT. XAE. PLC. Lib. Tc3_MTP 3.1 Licensing The Twin CAT 3 function can be activated as a full version or as a 7-day test version. Both license types can be activated via the Twin CAT 3 development environment (XAE). Licensing the full version of a Twin CAT 3 Function A description of the procedure to license a full version can be found in the Beckhoff Information System in the documentation "Twin CAT 3 Licensing". Licensing the 7-day test version of a Twin CAT 3 Function A 7-day test version cannot be enabled for a Twin CAT 3 license dongle. 1. Start the Twin CAT 3 development environment (XAE). 2. Open an existing Twin CAT 3 project or create a new project. 3. If you want to activate the license for a remote device, set the desired target system. To do this, select the target system from the Choose Target System drop-down list in the toolbar. ð The licensing settings always refer to the selected target system. When the project is activated on the target system, the corresponding Twin CAT 3 licenses are automatically copied to this system. TF8400 Version: 1.1.1 9
## Page 10

Installation 4. In the Solution Explorer, double-click License in the SYSTEM subtree. ð The Twin CAT 3 license manager opens. 5. Open the Manage Licenses tab. In the Add License column, check the check box for the license you want to add to your project (e.g. "TF4100 TC3 Controller Toolbox"). 6. Open the Order Information (Runtime) tab. ð In the tabular overview of licenses, the previously selected license is displayed with the status “missing”. 10 Version: 1.1.1 TF8400
## Page 11

Installation 7. Click 7-Day Trial License... to activate the 7-day trial license. ð A dialog box opens, prompting you to enter the security code displayed in the dialog. 8. Enter the code exactly as it is displayed and confirm the entry. 9. Confirm the subsequent dialog, which indicates the successful activation. ð In the tabular overview of licenses, the license status now indicates the expiry date of the license. 10. Restart the Twin CAT system. ð The 7-day trial version is enabled. TF8400 Version: 1.1.1 11
## Page 12

Technical introduction 4 Technical introduction The PLC library TF8400 Twin CAT 3 MTP Runtime represents objects (function blocks) for controlling and monitoring actuators and sensors in process technology. It is primarily designed for TF8401 Twin CAT 3 MTP Engineering, but can also be used independently. The objects of the PLC library are divided into the following areas: • Active Elements (drives, valves and PID controllers) • Diagnostic Elements (locking indicators) • Indicator Elements (sensors and displays) • Operation Elements (value specifications) • Input Elements (incoming process value signals) • Output Elements (outgoing process value signals) • Service Elements (services) • Parameter Elements (parameters for services) • Pea Elements (provision of vendor information) Access to the variables of these objects is controlled via the operation modes [} 13] and takes place via: • Inputs of the function block (for the internal logic) • External variables (access e.g. via OPC UA) 12 Version: 1.1.1 TF8400
## Page 13

PLC API 5 PLC API 5.1 Operation modes This chapter describes the state machines of the data objects and services. These are not used alone, but are called within the data objects and services. 5.1.1 Operation Mode In this library, a distinction is made between Operator and Automatic as sources for switching requests. The Operation Mode is a state machine for managing switching requests from these sources. Access routes Automatic switching requests are written by the internal PLC logic. The variable names are extended by the suffix *Aut. Operator switching requests are made manually (e.g. via OPC UA). They are declared as external variables and cannot be written via the internal PLC logic. Operator switching requests add the suffix *Op to the variable name. States The state machine has three states: Offline, Operator and Automatic. No new switching requests are processed in the Offline state. In the Operator state, *Op switching requests are processed and in the Automatic state, *Aut switching requests are processed. The current state is displayed via the outputs State Off Act, State Op Act and State Aut Act. State change A state change is carried out via switching requests from the internal PLC logic or via an operator (according to the Handshake procedure [} 20]). The input State Channel is set via the internal PLC logic and indicates which source can currently trigger a state change. States are prioritized as follows: Offline > Operator > Automatic. It follows that if all three states are requested at the same time, the state Offline is assumed. If Operator and Automatic are requested at the same time, the state Operator is assumed. TF8400 Version: 1.1.1 13
## Page 14

PLC API A direct transition from the state Offline to the state Automatic is not provided for in the MTP guideline, but is supported by the state machine. The Operation Mode is part of objects in this library and cannot be used alone. Inputs Name Type Description OPC UA access State Channel BOOL Selection of switching requests for the state machine: Read 1: Automatic switching requests are taken into account. 0: Operator switching requests are taken into account. State Off Aut BOOL Automatic switching request to transfer the Operation Read Mode to the Offline state. State Op Aut BOOL Automatic switching request to transfer the Operation Read Mode to the Operator state. State Aut Aut BOOL Automatic switching request to transfer the Operation Read Mode to the Automatic state Outputs Name Type Description OPC UA access State Off Act BOOL 1: Current state is Offline. Read State Op Act BOOL 1: Current state is Operator. Read State Aut Act BOOL 1: Current state is Automatic. Read External variables Name Type Description OPC UA access State Off Op BOOL Operator switching request to transfer the Operation Read/write Mode to the Offline state. 14 Version: 1.1.1 TF8400
## Page 15

PLC API Name Type Description OPC UA access 0→1: Operator request 1→0: Request has been processed. State Op Op BOOL Operator switching request to transfer the Operation Read/write Mode to the Operator state. 0→1: Operator request 1→0: Request has been processed. State Aut Op BOOL Operator switching request to transfer the Operation Read/write Mode to the Automatic state. 0→1: Operator request 1→0: Request has been processed. Methods Name Description Set Offline Sets the state machine Operation Mode of the interface to the state Offline. Set Operator Sets the state machine Operation Mode of the interface to the state Operator. Set Automatic Sets the state machine Operation Mode of the interface to the state Automatic. 5.1.2 Source Mode In this library, a distinction is made between Internal and Manual as sources for value specifications. The Source Mode is a state machine for managing value specifications from these sources. Access routes Internal value specifications are written by the internal PLC logic. The variable names are extended by the suffix *Int. Manual value specifications are written by a manual operation (e.g. via OPC UA). They are declared as external variables and cannot be written via the internal PLC logic. Manual value specifications add the suffix *Man to the variable name. States The state machine has two states: Internal and Manual. In the Internal state, *Int value specifications are processed and in the Manual state, *Man value specifications are processed. The current state is displayed via the outputs Src Man Act and Src Int Act. State change A state change is carried out via switching requests from the internal PLC logic *Aut or via an operator *Op (according to the Handshake procedure [} 20]). The input Src Channel is set via the internal PLC logic and indicates which source can currently trigger a state change. Internal is prioritized higher than Manual. Therefore, if both states are requested at the same time, the state Internal is assumed. TF8400 Version: 1.1.1 15
## Page 16

PLC API The Source Mode is part of objects and cannot be used alone. Inputs Name Type Description OPC UA access Src Channel BOOL Selection of switching requests for the state machine: Read 1: Automatic switching requests are taken into account. 0: Operator switching requests are taken into account. Src Int Aut BOOL Automtaic switching request to transfer the Read Source Mode to the Internal state Src Man Aut BOOL Automatic switching request to transfer the Read Source Mode to the Manual state Outputs Name Type Description OPC UA access Src Int Act BOOL Source Mode is in the state Internal. Read Src Man Act BOOL Source Mode is in the state Manual. Read External variables Name Type Description OPC UA access Src Int Op BOOL Operator switching request to transfer the Source Mode Read/write to the Internal state. 0→1: Operator request 1→0: Request has been processed. Src Man Op BOOL Operator switching request to transfer the Source Mode Read/write to the Manual state. 0→1: Operator request 1→0: Request has been processed. 16 Version: 1.1.1 TF8400
## Page 17

PLC API Methods Name Description Set Internal Sets the state machine Source Mode of the interface to the state Internal. Set Manual Sets the state machine Source Mode of the interface to the state Manual. 5.1.3 Service Mode Three sources for switching requests and value specifications are available for the services: • Manual operation (e.g. via OPC UA): Operator • Internal PLC logic: Automatic-Internal • Control system (e.g. via OPC UA): Automatic-External Operation mode control The operation mode control allows you to switch between the states Offline, Operator and Automatic. In the Offline state, no new switching requests and value specifications are taken into account. In the Operator state, *OP switching requests are processed and in the Automatic state, *Aut switching requests are processed. The current state is displayed via the outputs State Off Act, State Op Act and State Aut Act. The state change is carried out via the internal PLC logic or via the operator. The input State Channel is set via the internal PLC logic and specifies which source is taken into account during processing. The states are prioritized as follows: Offline > Operator > Automatic. This means that if all three states are requested at the same time, the state Offline is assumed. If Operator and Automatic are requested at the same time, the state Operator is assumed Source selection (Automatic) The source selection is used in the Automatic operation mode and allows you to switch between Automatic-Internal and Automatic-External. Automatic-Internal value specifications are written by the internal PLC logic. The variable names are extended by the suffix *Int. Automatic-External value specifications are written manually (e.g. via OPC UA). Operator switching requests are made manually (e.g. via OPC UA). They are declared as external variables and cannot be written via the internal PLC logic. Operator switching requests add the suffix *Op to the variable name. Service Mode is part of interfaces and cannot be used alone! Diagram of the state machines: The state machines work according to the following diagram: TF8400 Version: 1.1.1 17
## Page 18

PLC API 5.2 Properties This chapter describes the properties of the interfaces. These are not used alone, but according to the intended use of the interfaces. 5.2.1 Name of the object The name of the object is described by the variable Tag Name. It is the unique identifier of the object. The length is limited to 64 characters. Changing the value during runtime is possible, but not allowed according to the MTP guideline! Name Type Description OPC UA access Tag Name STRING Name of the interface - 5.2.2 Object description The object is described by the variable Tag Description. Changing the value during runtime is possible, but not permitted according to the MTP guideline! Name Type Description OPC UA access Tag Description STRING Description of the interface - 5.2.3 OSLevel The OSLevel is used to monitor operator levels. The use describes the following dependencies: 18 Version: 1.1.1 TF8400
## Page 19

PLC API OSLevel = 0: Operation only from local level (local HMI). OSLevel = 1 – 255: Operation takes place from the process control level (e.g. via OPC UA). If the interface is to be used in accordance with the MTP guideline, the OSLevel may only be set from the control level. The internal logic only allows this value to be manually set to 0 if the connection to the control level is lost. The implementation of the operator levels is carried out by the creator of the control level and is not part of this documentation. Name Type Description OPC UA access OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. 5.2.4 WQC The WQC (Worst Quality Code) describes the conditions under which the value of the interface was recorded and how trustworthy this value is. It is usually formed by the sensors or modules. The values are not defined in more detail in the current version of the MTP guideline. However, they can be derived from the NE 184, for example. Name Type Description OPC UA access WQC BYTE Worst Quality Code Read 5.2.5 Value scaling Values are displayed using value scaling. Variables with the suffixes *Scl Min and *Scl Max are available for this purpose. According to the MTP guideline, these limit values cannot be changed at runtime, but are supported by the object. Inputs Name Type Description OPC UA access *Scl Min REAL/ Lower limit of the value representation Read DINT *Scl Max REAL/ Upper limit of the value representation Read DINT 5.2.6 Unit The unit of a value is described by the Unit variable with the suffix *Unit . The possible units are listed in the file type E_MTP_Unit. Inputs Name Type Description OPC UA access *Unit INT Enumeration value of the unit list Read TF8400 Version: 1.1.1 19
## Page 20

PLC API 5.2.7 Value limitation Value specifications for objects in this library are limited by an upper and lower limit. The limit values for value specifications are described by variables with the suffixes *Min and *Max. Value specifications outside the limits are replaced accordingly by the lower or upper limit. Inputs Name Type Description OPC UA access *Min REAL/ Lower limit of the value specification Read DINT *Max REAL/ Upper limit of the value specification Read DINT 5.2.8 Feedback Feedback for switching requests or value specifications can be provided via the input variables with the suffix *Fbk. These feedback signals can come from field devices or be simulated. Examples: 1. Feedback contact of a contactor 2. Current speed of a motor from the encoder Inputs Name Type Description OPC UA access *Fbk REAL/ Return value Read DINT/ BOOL 5.2.9 Read back The default values are read back via the variables with the suffix *Rbk. The current, unmodified value specification is returned by these variables. 5.2.10 Handshake procedure The handshake procedure is used for some variables to transport information. A value, e.g. logical "1" (switching request), is written to a variable by the manual operation. This value is set back to a logical "0" after processing by the function block: 0 → 1: Switching request by manual operation 1 → 0: Switching request was read The reset only describes that the value has been read. It does not mean that this value has also had an influence. The state-describing variable is used to show whether a value has influenced an output of the function block. 5.2.11 Locking The locking system consists of a three-stage system that includes the states Permit, Interlock and Protect. Permit is a switching release for switching requests. If Permit = FALSE, the object can still be operated. If the object is transferred to a state that corresponds to the safety position, further switching requests are no longer taken into account - the switching release is withdrawn. 20 Version: 1.1.1 TF8400
## Page 21

PLC API Interlock is an interlock that withdraws the switching release and sets the object to the safety position. Protect has the same functionality as Interlock. Protect does not reset automatically, but must be acknowledged via Reset [} 23]. The respective locking options can be activated using Enable variables *En. Inputs Name Type Description OPC UA access Perm En BOOL Enable Permit: Read 1: Enabled 0: Disabled Permit BOOL Permit signal Read 1: Permit inactive 0: Permit active Intl En BOOL Enable Interlock: Read 1: Enabled 0: Disabled Interlock BOOL Interlock signal Read 1: Interlock inactive 0: Interlock active Prot En BOOL Enable Protect: Read 1: Enabled 0: Disabled Protect BOOL Protect signal Read 1: Protect inactive 0: Protect active, Reset required 5.2.12 Feedback monitoring Feedback monitoring compares the states of the switching request *Ctrl with the respective feedback contacts *Fbk. A distinction is made between static and dynamic errors during monitoring. The monitoring function is enabled by the variable Mon En by an operator (e. g. via OPC UA) or initially in the module. A static error Mon Stat Err is triggered by a change in the feedback contact if the switching request remains unchanged after the monitoring time Mon Stat Ti has elapsed. An example of this is a motor where the supply voltage fails. A dynamic fault Mon Dyn Err is triggered by a change in the switching request without a resulting change in the feedback contact after the monitoring time Mon Dyn Ti has elapsed. This can be triggered, for example, by a contactor that remains "stuck". The monitoring times in which the respective faults are triggered can be set by the internal PLC logic. The variable Mon Safe Pos is used to describe the behavior of the interface when an error occurs. Inputs Name Type Description OPC UA access Mon Stat Ti REAL Monitoring time for static errors [s] Read Mon Dyn Ti REAL Monitoring time for dynamic errors [s] Read Mon Safe Pos BOOL Behavior of the interface after an error occurs: Read 1: Safe position should be approached. TF8400 Version: 1.1.1 21
## Page 22

PLC API Name Type Description OPC UA access 0: The current state is retained. Outputs Name Type Description OPC UA access Mon Stat Err REAL Static error: Read 1: active 0: inactive Mon Dyn Err REAL Dynamic error: Read 1: active 0: inactive External variables Name Type Description OPC UA access Mon En BOOL Enable Feedback Monitoring: Read/write 1: Feeedback Monitoring active 0: Feedback Monitoring inactive 5.2.13 Limit value monitoring Limit value monitoring adds up to six monitorable limits to an interface. The limit value to be monitored is set via the *Lim variable by an operator (e. g. via OPC UA). Monitoring is enabled via the respective *En variable. If the upper limit values are exceeded or the lower limit values are not reached, the respective output *Act is set to TRUE. Inputs Name Type Description OPC UA access *AHEn BOOL Monitor limit Alarm High: Read 1: monitoring active 0: no monitoring *ALEn BOOL Monitor limit Alarm Low: Read 1: monitoring active 0: no monitoring *WHEn BOOL Monitor limit Warning High: Read 1: monitoring active 0: no monitoring *WLEn BOOL Monitor limit Warning Low: Read 1: monitoring active 0: no monitoring *THEn BOOL Monitor limit Tolerance High: Read 1: monitoring active 0: no monitoring *TLEn BOOL Monitor limit Tolerance Low: Read 1: monitoring active 0: no monitoring 22 Version: 1.1.1 TF8400
## Page 23

PLC API Outputs Name Type Description OPC UA access *AHAct BOOL Alarm High limit exceeded. Read *ALAct BOOL Alarm Low limit not reached. Read *WHAct BOOL Warning High limit exceeded. Read *WLAct BOOL Warning Low limit not reached. Read *THAct BOOL Tolerance High limit exceeded. Read *TLAct BOOL Tolerance Low limit not reached. Read External variables Name Type Description OPC UA access *AHLim REAL / Alarm High limit Read/write DINT *ALLim REAL / Alarm Low limit Read/write DINT *WHLim REAL / Warning High limit Read/write DINT *WLLim REAL / Warning Low limit Read/write DINT *THLim REAL / Tolerance High limit Read/write DINT *TLLim REAL / Tolerance Low limit Read/write DINT 5.2.14 Reset Reset resets pending *Err messages and the Protect-Verriegelung. Reset takes place via two equally prioritized inputs: Reset Op and Reset Aut. The reset by manual operation (e. g. via OPC UA) is carried out via a Handshake procedure [} 20]. Inputs Name Type Description OPC UA access Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. External variables Name Type Description OPC UA access Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. TF8400 Version: 1.1.1 23
## Page 24

PLC API 5.3 Function blocks 5.3.1 Active Elements Active Elements are objects that allow access to actuators from different sources. The sources can be the internal PLC logic or manual operation. The actuators include valves, electric drives or PID controllers. Access is controlled via state machines. 5.3.1.1 FB_MTP_Bin Drv The function block FB_MTP_Bin Drv is an object for controlling a binary drive from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests are managed via the state machine of Operation Mode [} 13]. The OPC UA access rights are described in the variable tables. Controlling the drive The direction of rotation of the drive is specified via the switching requests Fwd*, Rev* and Stop*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. With simultaneous requests from Fwd* and Rev*, both are prioritized equally and the drive remains in its state. Stop* is prioritized highest at Safe Pos = FALSE with simultaneous requests from Fwd*, Rev* and Stop*. If Safe Pos = TRUE, the switching requests Fwd*, Rev* and Stop* are prioritized equally and the drive remains in its current state in the event of simultaneous requests. When Locking [} 20] is active, it is no longer possible to control the drive, depending on the type of interlock. Safety position The safety position is defined via the variables Safe Pos, Safe Pos Dir En and Safe Pos Dir. The variable Safe Pos is used to specify whether the safety position of the drive is the de-energized state or an active state. The variables Safe Pos Dir En and Safe Pos Dir are not part of the MTP guideline. They have also been implemented and can be used to define a safety position in the active state. These variables are not listed in the MTP file and are not made available via OPC UA. Safety position: de-energized state 24 Version: 1.1.1 TF8400
## Page 25

PLC API In the de-energized state, the safety position of the drive is: Fwd Ctrl = FALSE and Rev Ctrl = FALSE. Safety position: active state For the active state, the default direction of rotation can be enabled (Safe Pos Dir En = TRUE) and the direction of rotation can be specified (Safe Pos Dir). If the specification of the direction of rotation is disabled Safe Pos Dir En = FALSE, the current movement state (forward, reverse or stop) is the safety position. If the default setting is enabled, the safety position Safe Pos Dir En = TRUE forward (Safe Pos Dir = FALSE) or reverse (Safe Pos Dir = TRUE). Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Feedback [} 20] Locking [} 20] Reset [} 23] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] Fwd En BOOL Enable forward movement: Read 1: Enabled 0: Disabled Rev En BOOL Enable reverse movement: Read 1: Enabled 0: Disabled Stop Aut BOOL Automatic switching request to set the drive to stop: Read (Relevant if State Aut Act) 1: Execute stop. 0: No stop Fwd Aut BOOL Automatic switching request to set the drive in forward Read motion: (Relevant if State Aut Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Aut BOOL Automatic switching request to set the drive in forward Read motion: (Relevant if State Aut Act & Rev En) TF8400 Version: 1.1.1 25
## Page 26

PLC API Name Type Description OPC UA access 1: Execute reverse movement. 0: Do not execute any reverse movement. Fwd Fbk Ca Ic BOOL Source of the feedback signal Forward movement: Read 1: Calculated 0: Sensor Fwd Fbk BOOL Feedback signal Forward movement: Read 1: Forward movement 0: No forward movement Rev Fbk Ca Ic BOOL Source of the feedback signal Reverse movement: Read 1: Calculated 0: Sensor Rev Fbk BOOL Feedback signal Reverse movement: Read 1: Reverse movement 0: No reverse movement Perm* See Locking [} 20] Int* Prot* Trip BOOL Signaling contact for motor protection: Read 1: No error 0: Motor protection tripped. Safe Pos BOOL 1: Retain current state. Read 0: Stop Safe Pos Dir En BOOL 1: Rotation direction specification for Safe Pos = TRUE – via the variable Safe Pos Dir 0: No rotation direction specified Safe Pos Dir BOOL Rotation direction specification for Safe Pos = TRUE and – Safe Pos Dir Rpm En = TRUE 1: reverse 0: forward Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Fwd Ctrl BOOL Forward movement: Read 1: active 0: inactive Rev Ctrl BOOL Reverse movement: Read 1: active 0: inactive Safe Pos Act BOOL Safety position enabled: Read 1: Safety position is active. 0: Safety position is not active. 26 Version: 1.1.1 TF8400
## Page 27

PLC API External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Stop Op BOOL Operator switching request to set the drive to stop: Read/write (Relevant if State Op Act) 1: Execute stop. 0: Do not execute a stop. Fwd Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Rev En) 1: Execute reverse movement. 0: Do not execute any reverse movement. Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic TF8400 Version: 1.1.1 27
## Page 28

PLC API 5.3.1.2 FB_MTP_Mon Bin Drv The function block FB_MTP_Mon Bin Drv is an object for controlling a binary drive from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests are managed via the state machine of Operation Mode [} 13]. It also includes the option of monitoring the output values with the respective feedback signals. The OPC UA access rights are described in the variable tables. Controlling the drive The direction of rotation of the drive is specified via the switching requests Fwd*, Rev* and Stop*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. With simultaneous requests from Fwd* and Rev*, both are prioritized equally and the drive remains in its state. Stop* is prioritized highest at Safe Pos = FALSE with simultaneous requests from Fwd*, Rev* and Stop*. If Safe Pos = TRUE, the switching requests Fwd*, Rev* and Stop* are prioritized equally and the drive remains in its current state in the event of simultaneous requests. When Locking [} 20] is active, it is no longer possible to control the drive, depending on the type of interlock. Safety position The safety position is defined via the variables Safe Pos, Safe Pos Dir En and Safe Pos Dir. The variable Safe Pos is used to specify whether the safety position of the drive is the de-energized state or an active state. The variables Safe Pos Dir En and Safe Pos Dir are not part of the MTP guideline. They have also been implemented and can be used to define a safety position in the active state. These variables are not listed in the MTP file and are not made available via OPC UA. Safety position: de-energized state In the de-energized state, the safety position of the drive is: Fwd Ctrl = FALSE and Rev Ctrl = FALSE. Safety position: active state For the active state, the default direction of rotation can be enabled (Safe Pos Dir En = TRUE) and the direction of rotation can be specified (Safe Pos Dir). 28 Version: 1.1.1 TF8400
## Page 29

PLC API If the specification of the direction of rotation is disabled Safe Pos Dir En = FALSE, the current movement state (forward, reverse or stop) is the safety position. If the default setting is enabled, the safety position Safe Pos Dir En = TRUE forward (Safe Pos Dir = FALSE) or reverse (Safe Pos Dir = TRUE). Monitoring The control and the respective Feedback [} 20] can be monitored via Feedback monitoring [} 21]. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Locking [} 20] Reset [} 23] Inheritance hierarchy FB_MTP_Bin Drv FB_MTP_Mon Bin Drv Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] Fwd En BOOL Enable forward movement: Read 1: Enabled 0: Disabled Rev En BOOL Enable reverse movement: Read 1: Enabled 0: Disabled Stop Aut BOOL Automatic switching request to set the drive to stop: Read (Relevant if State Aut Act) 1: Execute stop. 0: No stop Fwd Aut BOOL Automatic switching request to set the drive in forward Read motion: (Relevant if State Aut Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Aut BOOL Automatic switching request to set the drive in forward Read motion: TF8400 Version: 1.1.1 29
## Page 30

PLC API Name Type Description OPC UA access (Relevant if State Aut Act & Rev En) 1: Execute reverse movement. 0: Do not execute any reverse movement. Fwd Fbk Ca Ic BOOL Source of the feedback signal Forward movement: Read 1: Calculated 0: Sensor Fwd Fbk BOOL Feedback signal Forward movement: Read 1: Forward movement 0: No forward movement Rev Fbk Ca Ic BOOL Source of the feedback signal Reverse movement: Read 1: Calculated 0: Sensor Rev Fbk BOOL Feedback signal Reverse movement: Read 1: Reverse movement 0: No reverse movement Perm* See Locking [} 20] Int* Prot* Trip BOOL Signaling contact for motor protection: Read 1: No error 0: Motor protection tripped. Safe Pos BOOL 1: Retain current state. Read 0: Stop Safe Pos Dir En BOOL 1: Rotation direction specification for Safe Pos = TRUE – via the variable Safe Pos Dir 0: No rotation direction specified Safe Pos Dir BOOL Rotation direction specification for Safe Pos = TRUE and – Safe Pos Dir Rpm En = TRUE 1: reverse 0: forward Mon Stat Ti REAL Monitoring time for static errors [s] Read Mon Dyn Ti REAL Monitoring time for dynamic errors [s] Read Mon Safe Pos BOOL Behavior of the interface after an error occurs: Read 1: Safe position should be approached. 0: The current state is retained. Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Fwd Ctrl BOOL Forward movement: Read 1: active 0: inactive Rev Ctrl BOOL Reverse movement: Read 30 Version: 1.1.1 TF8400
## Page 31

PLC API Name Type Description OPC UA access 1: active 0: inactive Safe Pos Act BOOL Safety position enabled: Read 1: Safety position is active. 0: Safety position is not active. Mon Stat Err REAL Static error: Read 1: active 0: inactive Mon Dyn Err REAL Dynamic error: Read 1: active 0: inactive External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Stop Op BOOL Operator switching request to set the drive to stop: Read/write (Relevant if State Op Act) 1: Execute stop. 0: Do not execute a stop. Fwd Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Rev En) 1: Execute reverse movement. 0: Do not execute any reverse movement. Mon En BOOL Enable Feedback Monitoring: Read/write 1: Feeedback Monitoring active 0: Feedback Monitoring inactive Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic TF8400 Version: 1.1.1 31
## Page 32

PLC API 5.3.1.3 FB_MTP_Ana Drv The function block FB_MTP_Ana Drv is an object for controlling a drive with variable speed from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests and value specifications are managed independently of each other via the state machines of Operation Mode [} 13] and Source Mode [} 15]. The OPC UA access rights are described in the variable tables. Controlling the drive The direction of rotation of the drive is specified via the switching requests Fwd*, Rev* and Stop*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. With simultaneous requests from Fwd* and Rev*, both are prioritized equally and the drive remains in its state. Stop* is prioritized highest at Safe Pos = FALSE with simultaneous requests from Fwd*, Rev* and Stop*. If Safe Pos = TRUE, the switching requests Fwd*, Rev* and Stop* are prioritized equally and the drive remains in its current state in the event of simultaneous requests. When Locking [} 20] is active, it is no longer possible to control the drive, depending on the type of interlock. Setpoint specification The speed is set via Rpm* variables. The speed specification is managed by the state machine Source Mode [} 15] and is output according to the diagram below: 32 Version: 1.1.1 TF8400
## Page 33

PLC API Safety position The safety position is defined via the variables Safe Pos, Safe Pos Dir Rpm En, Safe Pos Dir and Safe Pos Rpm. The variable Safe Pos is used to specify whether the safety position of the drive is the de-energized state or an active state. The variables Safe Pos Dir Rpm En, Safe Pos Dir and Safe Pos Rpm are not part of the MTP guideline. They have also been implemented and can be used to define a safety position in the active state. These variables are not listed in the MTP file and are not made available via OPC UA. Safety position: de-energized state (Safe Pos = FALSE) In the de-energized state, the drive is stopped (Fwd Ctrl = FALSE, Rev Ctrl = FALSE and Rpm = 0) Safety position: active state (Safe Pos = TRUE) If the state is active, the default direction of rotation and speed can be activated (Safe Pos Dir Rpm En = TRUE) and the direction of rotation (Safe Pos Dir) or speed (Safe Pos Rpm) can be specified. If Safe Pos Dir Rpm En = FALSE, the current movement state (forward, reverse or stop) is the safety position. If the default setting (Safe Pos Dir Rpm En = TRUE) is activated, the safety position is forward (Safe Pos Dir = FALSE) or reverse (Safe Pos Dir = TRUE) with the defined safety speed (Safe Pos Rpm). The following table shows the operating options for the drive (Fwd*, Rev*, Stop* and Rpm*) when Permit is active, depending on the initial state of the drive (stop drive, set drive to forward movement and set drive to reverse movement) and the defined safety position: Safe Pos Safe Pos Safe Pos- Drive set to Drive set to Drive set to Dir Rpm En Dir Stop Forward Reverse FALSE - - Safe Pos Act = TRUE Safe Pos Act = Safe Pos Act = FALSE FALSE Rev* + Fwd*: x Rev* + Stop*: ✓ Fwd* + Stop*: ✓ Rpm*: x Rpm*: ✓ Rpm*: ✓ TRUE FALSE - Safe Pos Act = TRUE Safe Pos Act = TRUE Safe Pos Act = TRUE Rev* + Fwd*: x Rev* + Stop*: x Fwd* + Stop*: x Rpm*: x Rpm*: x Rpm*: x TRUE TRUE FALSE Safe Pos Act = Safe Pos Act = TRUE Safe Pos Act = FALSE FALSE (Fwd) Rev* + Stop*: x Rev* + Fwd*: ✓ Fwd* + Stop*: ✓ Rpm*: x (Safe Pos Rpm) Rpm*: ✓ Rpm*: ✓ TF8400 Version: 1.1.1 33
## Page 34

PLC API Safe Pos Safe Pos Safe Pos- Drive set to Drive set to Drive set to Dir Rpm En Dir Stop Forward Reverse TRUE TRUE TRUE Safe Pos Act = Safe Pos Act = Safe Pos Act = TRUE FALSE FALSE (Rev) Fwd* + Stop*: x Rev* + Fwd*: ✓ Rev* + Stop*: ✓ Rpm*: x (Safe Pos Rpm) Rpm*: ✓ Rpm*: ✓ x: Switching requests and/or value specifications are no longer taken into account ✓: Switching requests and/or value specifications are taken into account Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Unit [} 19] Feedback [} 20] Locking [} 20] Reset [} 23] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. Src* See Source Mode [} 15] Rpm Int REAL Internal Speed setpoint specification Read Rpm Unit INT Speed Unit Read Rpm Min REAL Upper limit of the speed setpoint Read Rpm Max REAL Lower limit of the speed setpoint Read Rpm Fbk Calc BOOL Source of the actual speed value: Read 1: Calculated 0: Sensor Rpm Fbk REAL Actual speed value Read Rpm Scl Min REAL Speed scale start Read Rpm Scl Max REAL Speed scale end Read Perm* See Locking [} 20] Int* Prot* Trip BOOL Signaling contact for motor protection: Read 1: No error 0: Motor protection tripped. 34 Version: 1.1.1 TF8400
## Page 35

PLC API Name Type Description OPC UA access Safe Pos BOOL 1: Retain current state. Read 0: Stop Safe Pos Dir Rpm E BOOL 1: Rotation direction specification for Safe Pos = TRUE – n via the variable Safe Pos Dir 0: No rotation direction specified Safe Pos Dir BOOL Rotation direction specification for Safe Pos = TRUE – and Safe Pos Dir Rpm En = TRUE 1: reverse 0: forward Safe Pos Rpm REAL Speed specification for safety position, if Safe Pos = – TRUE and Safe Pos Dir Rpm En = TRUE Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Fwd Ctrl BOOL Forward movement: Read 1: active 0: inactive Rev Ctrl BOOL Reverse movement: Read 1: active 0: inactive Src* See Source Mode [} 15] Rpm REAL Speed setpoint on drive Read Safe Pos Act BOOL Safety position enabled: Read 1: Safety position is active. 0: Safety position is not active. External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Stop Op BOOL Operator switching request to set the drive to stop: Read/write (Relevant if State Op Act) 1: Execute stop. 0: Do not execute a stop. Fwd Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Rev En) 1: Execute reverse movement. TF8400 Version: 1.1.1 35
## Page 36

PLC API Name Type Description OPC UA access 0: Do not execute any reverse movement. Src* See Source Mode [} 15] Rpm Man REAL Manual setpoint specification for the speed Read/write Rpm Rbk REAL Unprocessed value of the Operator speed value Read specification Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic Set Internal See Source Mode [} 15] Set Manual 36 Version: 1.1.1 TF8400
## Page 37

PLC API 5.3.1.4 FB_MTP_Mon Ana Drv The function block FB_MTP_Mon Ana Drv is an object for controlling a drive with variable speed from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests and value specifications are managed independently of each other via the state machines of Operation Mode [} 13] and Source Mode [} 15] . It also includes the option of monitoring the output values with the respective feedback signals. The OPC UA access rights are described in the variable tables. Controlling the drive The direction of rotation of the drive is specified via the switching requests Fwd*, Rev* and Stop*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. With simultaneous requests from Fwd* and Rev*, both are prioritized equally and the drive remains in its state. Stop* is prioritized highest at Safe Pos = FALSE with simultaneous requests from Fwd*, Rev* and Stop*. If Safe Pos = TRUE, the switching requests Fwd*, Rev* and Stop* are prioritized equally and the drive remains in its current state in the event of simultaneous requests. When Locking [} 20] is active, it is no longer possible to control the drive, depending on the type of interlock. Setpoint specification The speed is set via Rpm* variables. The speed specification is managed by the state machine Source Mode [} 15] and is output according to the diagram below: TF8400 Version: 1.1.1 37
## Page 38

PLC API Safety position The safety position is defined via the variables Safe Pos, Safe Pos Dir Rpm En, Safe Pos Dir and Safe Pos Rpm. The variable Safe Pos is used to specify whether the safety position of the drive is the de-energized state or an active state. The variables Safe Pos Dir Rpm En, Safe Pos Dir and Safe Pos Rpm are not part of the MTP guideline. They have also been implemented and can be used to define a safety position in the active state. These variables are not listed in the MTP file and are not made available via OPC UA. Safety position: de-energized state (Safe Pos = FALSE) In the de-energized state, the drive is stopped (Fwd Ctrl = FALSE, Rev Ctrl = FALSE and Rpm = 0) Safety position: active state (Safe Pos = TRUE) If the state is active, the default direction of rotation and speed can be activated (Safe Pos Dir Rpm En = TRUE) and the direction of rotation (Safe Pos Dir) or speed (Safe Pos Rpm) can be specified. If Safe Pos Dir Rpm En = FALSE, the current movement state (forward, reverse or stop) is the safety position. If the default setting (Safe Pos Dir Rpm En = TRUE) is activated, the safety position is forward (Safe Pos Dir = FALSE) or reverse (Safe Pos Dir = TRUE) with the defined safety speed (Safe Pos Rpm). The following table shows the operating options for the drive (Fwd*, Rev*, Stop* and Rpm*) when Permit is active, depending on the initial state of the drive (stop drive, set drive to forward movement and set drive to reverse movement) and the defined safety position: Safe Pos Safe Pos Safe Pos- Drive set to Drive set to Drive set to Dir Rpm En Dir Stop Forward Reverse FALSE - - Safe Pos Act = TRUE Safe Pos Act = Safe Pos Act = FALSE FALSE Rev* + Fwd*: x Rev* + Stop*: ✓ Fwd* + Stop*: ✓ Rpm*: x Rpm*: ✓ Rpm*: ✓ TRUE FALSE - Safe Pos Act = TRUE Safe Pos Act = TRUE Safe Pos Act = TRUE Rev* + Fwd*: x Rev* + Stop*: x Fwd* + Stop*: x Rpm*: x Rpm*: x Rpm*: x TRUE TRUE FALSE Safe Pos Act = Safe Pos Act = TRUE Safe Pos Act = FALSE FALSE (Fwd) Rev* + Stop*: x Rev* + Fwd*: ✓ Fwd* + Stop*: ✓ Rpm*: x (Safe Pos Rpm) Rpm*: ✓ Rpm*: ✓ 38 Version: 1.1.1 TF8400
## Page 39

PLC API Safe Pos Safe Pos Safe Pos- Drive set to Drive set to Drive set to Dir Rpm En Dir Stop Forward Reverse TRUE TRUE TRUE Safe Pos Act = Safe Pos Act = Safe Pos Act = TRUE FALSE FALSE (Rev) Fwd* + Stop*: x Rev* + Fwd*: ✓ Rev* + Stop*: ✓ Rpm*: x (Safe Pos Rpm) Rpm*: ✓ Rpm*: ✓ x: Switching requests and/or value specifications are no longer taken into account ✓: Switching requests and/or value specifications are taken into account Monitoring The control and the respective Feedback [} 20] can be monitored via Feedback monitoring [} 21]. The output Rpm Err indicates the current speed deviation Rpm Err = Rpm – Rpm Fbk. The speed deviation can be monitored for an upper and lower limit (Alarm High and Alarm Low) using the Limit value monitoring [} 22]. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Value scaling [} 19] Value limitation [} 20] Locking [} 20] Reset [} 23] Inheritance hierarchy FB_MTP_Ana Drv FB_MTP_Mon Ana Drv Inputs Name Type Description OPC UA access Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] Fwd En BOOL Enable forward movement: Read 1: Enabled 0: Disabled Rev En BOOL Enable reverse movement: Read 1: Enabled 0: Disabled Stop Aut BOOL Automatic switching request to set the drive to stop: Read TF8400 Version: 1.1.1 39
## Page 40

PLC API Name Type Description OPC UA access (Relevant if State Aut Act) 1: Execute stop. 0: No stop Fwd Aut BOOL Automatic switching request to set the drive in forward Read motion: (Relevant if State Aut Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Aut BOOL Automatic switching request to set the drive in forward Read motion: (Relevant if State Aut Act & Rev En) 1: Execute reverse movement. 0: Do not execute any reverse movement. Fwd Fbk Ca Ic BOOL Source of the feedback signal Forward movement: Read 1: Calculated 0: Sensor Fwd Fbk BOOL Feedback signal Forward movement: Read 1: Forward movement 0: No forward movement Rev Fbk Ca Ic BOOL Source of the feedback signal Reverse movement: Read 1: Calculated 0: Sensor Rev Fbk BOOL Feedback signal Reverse movement: Read 1: Reverse movement 0: No reverse movement Src* See Source Mode [} 15] Rpm Int REAL Internal Speed setpoint specification Read Rpm Unit INT Speed Unit Read Rpm Min REAL Upper limit of the speed setpoint Read Rpm Max REAL Lower limit of the speed setpoint Read Rpm Fbk Calc BOOL Source of the actual speed value: Read 1: Calculated 0: Sensor Rpm Fbk REAL Actual speed value Read Rpm Scl Min REAL Speed scale start Read Rpm Scl Max REAL Speed scale end Read Perm* See Locking [} 20] Int* Prot* Trip BOOL Signaling contact for motor protection: Read 1: No error 0: Motor protection tripped. Safe Pos BOOL 1: Retain current state. Read 0: Stop Safe Pos Dir Rpm E BOOL 1: Rotation direction specification for Safe Pos = TRUE – n via the variable Safe Pos Dir 0: No rotation direction specified 40 Version: 1.1.1 TF8400
## Page 41

PLC API Name Type Description OPC UA access Safe Pos Dir BOOL Rotation direction specification for Safe Pos = TRUE – and Safe Pos Dir Rpm En = TRUE 1: reverse 0: forward Safe Pos Rpm REAL Speed specification for safety position, if Safe Pos = – TRUE and Safe Pos Dir Rpm En = TRUE Mon Stat Ti REAL Monitoring time for static errors [s] Read Mon Dyn Ti REAL Monitoring time for dynamic errors [s] Read Mon Safe Pos BOOL Behavior of the interface after an error occurs: Read 1: Safe position should be approached. 0: The current state is retained. Rpm AHEn BOOL Monitor limit Alarm High: Read 1: monitoring active 0: No monitoring Rpm ALEn BOOL Monitor limit Alarm Low: Read 1: monitoring active 0: No monitoring Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Fwd Ctrl BOOL Forward movement: Read 1: active 0: inactive Rev Ctrl BOOL Reverse movement: Read 1: active 0: inactive Src* See Source Mode [} 15] Rpm REAL Speed setpoint on drive Read Mon Stat Err REAL Static error: Read 1: active 0: inactive Mon Dyn Err REAL Dynamic error: Read 1: active 0: inactive Rpm Err REAL Speed deviation: Rpm Err = Rpm - Rpm Fbk Rpm AHAct BOOL Alarm High limit exceeded. Read Rpm ALAct BOOL Alarm Low limit not reached. Read External variables Name Type Description OPC UA access State* See Operation Mode [} 13] TF8400 Version: 1.1.1 41
## Page 42

PLC API Name Type Description OPC UA access Stop Op BOOL Operator switching request to set the drive to stop: Read/write (Relevant if State Op Act) 1: Execute stop. 0: Do not execute a stop. Fwd Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Fwd En) 1: Execute forward movement. 0: Do not execute any forward movement. Rev Op BOOL Operator switching request to set the drive in forward Read/write movement: (Relevant if State Op Act & Rev En) 1: Execute reverse movement. 0: Do not execute any reverse movement. Src* See Source Mode [} 15] Rpm Man REAL Manual setpoint specification for the speed Read/write Rpm Rbk REAL Unprocessed value of the Operator speed value Read specification Mon En BOOL Enable Feedback Monitoring: Read/write 1: Feeedback Monitoring active 0: Feedback Monitoring inactive Rpm AHLim REAL Alarm High limit (>0) Read/write Rpm ALLim REAL Alarm Low limit (<0) Read/write Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic Set Internal See Source Mode [} 15] Set Manual 42 Version: 1.1.1 TF8400
## Page 43

PLC API 5.3.1.5 FB_MTP_Bin Vlv The function block FB_MTP_Bin Vlv is an object for controlling a binary valve from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests are managed via the state machine Operation Mode [} 13]. The OPC UA access rights are described in the variable tables. Controlling the valve The specification for opening and closing the valve is made via the switching requests Open* and Close*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. For simultaneous requests from Open* and Close*, Close* has the highest priority. If Locking [} 20] is active, control of the outputs via the switching requests is prevented or the safety position is assumed. Safety position The safety position is defined via the variables Safe Pos En and Safe Pos . The variable Safe Pos En is used to describe whether the valve has a fixed safety position (Safe Pos En = TRUE) or whether the current position should be maintained (Safe Pos En = FALSE). The safety position is described with Safe Pos: Safe Pos = FALSE: Safety position of the valve: closed Safe Pos = TRUE: Safety position of the valve: open Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Feedback [} 20] Locking [} 20] Reset [} 23] TF8400 Version: 1.1.1 43
## Page 44

PLC API Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] Open Aut BOOL Automatic switching request to move to the selected Read position of the valve. Close Aut BOOL Automatic switching request to close the valve. Read Open Fbk Ca Ic BOOL Source of the feedback signal Limit switch Valve open: Read 1: Calculated 0: Sensor Open Fbk BOOL Feedback signal Limit switch Valve open Read Close Fbk Ca Ic BOOL Source of the feedback signal Read Limit switch Valve closed: 1: Calculated 0: Sensor Close Fbk BOOL Feedback signal Limit switch Valve closed. Read Perm* See Locking [} 20] Int* Prot* Safe Pos En BOOL Use the safe position of the valve: Read 1: Use safe position. 0: Do not use safe position. Safe Pos BOOL Safe position of the valve: Read 1: Open 0: Closed Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Ctrl BOOL Valve switching command: Read 1: Open 0: Close Safe Pos Act BOOL Safe position: Read 1: Move to a safe position. 0: Normal operation 44 Version: 1.1.1 TF8400
## Page 45

PLC API External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Open Op BOOL Operator switching request to open the valve. Read/write Close Op BOOL Operator switching request to close the valve. Read/write Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic 5.3.1.6 FB_MTP_Mon Bin Vlv The function block FB_MTP_Mon Bin Vlv is an object for controlling a binary valve from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests are managed via the state machine Operation Mode [} 13]. It also includes the option of monitoring the output value with the respective feedback. The OPC UA access rights are described in the variable tables. Controlling the valve The specification for opening and closing the valve is made via the switching requests Open* and Close*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. For simultaneous requests from Open* and Close*, Close* has the highest priority. If Locking [} 20] is active, control of the outputs via the switching requests is prevented or the safety position is assumed. TF8400 Version: 1.1.1 45
## Page 46

PLC API Safety position The safety position is defined via the variables Safe Pos En and Safe Pos . The variable Safe Pos En is used to describe whether the valve has a fixed safety position (Safe Pos En = TRUE) or whether the current position should be maintained (Safe Pos En = FALSE). The safety position is described with Safe Pos: Safe Pos = FALSE: Safety position of the valve: closed Safe Pos = TRUE: Safety position of the valve: open Monitoring The control and the respective Feedback [} 20] can be monitored with the Feedback monitoring [} 21]. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Locking [} 20] Reset [} 23] Inheritance hierarchy FB_MTP_Bin Vlv FB_MTP_Mon Bin Vlv Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] Open Aut BOOL Automatic switching request to move to the selected Read position of the valve. Close Aut BOOL Automatic switching request to close the valve. Read Open Fbk Ca Ic BOOL Source of the feedback signal Limit switch Valve open: Read 1: Calculated 0: Sensor Open Fbk BOOL Feedback signal Limit switch Valve open Read Close Fbk Ca Ic BOOL Source of the feedback signal Read Limit switch Valve closed: 1: Calculated 0: Sensor 46 Version: 1.1.1 TF8400
## Page 47

PLC API Name Type Description OPC UA access Close Fbk BOOL Feedback signal Limit switch Valve closed. Read Perm* See Locking [} 20] Int* Prot* Safe Pos En BOOL Use the safe position of the valve: Read 1: Use safe position. 0: Do not use safe position. Safe Pos BOOL Safe position of the valve: Read 1: Open 0: Closed Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Mon Stat Ti REAL Monitoring time for static errors [s] Read Mon Dyn Ti REAL Monitoring time for dynamic errors [s] Read Mon Safe Pos BOOL Behavior of the interface after an error occurs: Read 1: Safe position should be approached. 0: The current state is retained. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Ctrl BOOL Valve switching command: Read 1: Open 0: Close Safe Pos Act BOOL Safe position: Read 1: Move to a safe position. 0: Normal operation External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Open Op BOOL Operator switching request to open the valve. Read/write Close Op BOOL Operator switching request to close the valve. Read/write Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Mon En BOOL Enable Feedback Monitoring: Read/write 1: Feeedback Monitoring active 0: Feedback Monitoring inactive Methods Name Description Set Offline See Operation Mode [} 13] TF8400 Version: 1.1.1 47
## Page 48

PLC API Name Description Set Operator Set Automatic 5.3.1.7 FB_MTP_Ana Vlv The function block FB_MTP_Ana Vlv serves as an interface for controlling an analog valve from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Switching requests and value specifications are managed independently of each other via the state machines of Operation Mode [} 13] and Source Mode [} 15]. The OPC UA access rights are described in the variable tables. Controlling the valve The specification for opening and closing the valve is made via the switching requests Open* and Close*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. For simultaneous requests from Open* and Close*, Close* has the highest priority. If Locking [} 20] is active, control of the outputs via the switching requests is prevented or the safety position is assumed. Setpoint specification The position is specified via Pos* variables. The position specification is managed by the state machine of the Source Mode [} 15] and output according to the diagram below: 48 Version: 1.1.1 TF8400
## Page 49

PLC API Safety position The safety position is defined via the variables Safe Pos En and Safe Pos . The variable Safe Pos En is used to describe whether the valve has a fixed safety position (Safe Pos En = TRUE) or whether the current position should be maintained (Safe Pos En = FALSE) The safety position is described with Safe Pos: Safe Pos = FALSE: Safety position of the valve: Pos Min Safe Pos = TRUE: Safety position of the valve: Pos Max Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Operation Mode [} 13] Source Mode [} 15] Feedback [} 20] Unit [} 19] Value scaling [} 19] Value limitation [} 20] Locking [} 20] Reset [} 23] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] TF8400 Version: 1.1.1 49
## Page 50

PLC API Name Type Description OPC UA access Open Aut BOOL Automatic switching request to move to the selected Read position of the valve. Close Aut BOOL Automatic switching request to close the valve. Read Open Fbk Ca Ic BOOL Source of the feedback signal Limit switch Valve open: Read 1: Calculated 0: Sensor Open Fbk BOOL Feedback signal Limit switch Valve open Read Close Fbk Ca Ic BOOL Source of the feedback signal Read Limit switch Valve closed: 1: Calculated 0: Sensor Close Fbk BOOL Feedback signal Limit switch Valve closed. Read Src* See Source Mode [} 15] Pos Int REAL Internal value specification for the position Read Pos Unit INT Unit of the position Read Pos Min REAL Lower limit of the value specification for the valve position Read Pos Max REAL Upper limit of the value specification for the valve position Read Pos Fbk Ca Ic BOOL Source of the position feedback value: Read 1: Calculated 0: Sensor Pos Fbk REAL Feedback value of the position Read Pos Sc IMin REAL Scale start of the position display Read Pos Sc IMax REAL Scale end of the position display Read Perm* See Locking [} 20] Int* Prot* Safe Pos En BOOL Use the safe position of the valve: Read 1: Use safe position. 0: Do not use safe position (Hold position). Safe Pos BOOL Safe position of the valve: Read 1: Pos Max 0: Pos Min Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Open Act BOOL Open valve switching command. Read Close Ad BOOL Close valve switching command. Read Src* See Source Mode [} 15] Pos REAL Position setpoint on valve Read Safe Pos Act BOOL Safe position: Read 1: Move to a safe position 0: Normal operation 50 Version: 1.1.1 TF8400
## Page 51

PLC API External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Open Op BOOL Operator switching request to move to the selected Read/write position of the valve. Close Op BOOL Operator switching request to close the valve. Read/write Src* See Source Mode [} 15] Pos Man BOOL Manual value specification for the position Read/write Pos Rbk REAL Unprocessed value of the Operator Value specification Read/write for the position Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic Set Internal See Source Mode [} 15] Set Manual TF8400 Version: 1.1.1 51
## Page 52

PLC API 5.3.1.8 FB_MTP_Mon Ana Vlv The function block FB_MTP_Mon Ana Vlv is an object for controlling an analog valve from different sources: internal PLC logic or manual operation (access via OPC UA). Switching requests and value specifications are managed independently of each other via the state machines Operation Mode [} 13] and Source Mode [} 15]. It also includes the option of monitoring the output values with the respective feedback signals. The OPC UA access rights are described in the variable tables. Controlling the valve The specification for opening and closing the valve is made via the switching requests Open* and Close*. The state machine of the Operation Mode [} 13] manages whether and from which source new switching requests are processed. For simultaneous requests from Open* and Close*, Close* has the highest priority. If Locking [} 20] is active, control of the outputs via the switching requests is prevented or the safety position is assumed. Setpoint specification The position is specified via Pos* variables. The position specification is managed by the state machine of the Source Mode [} 15] and output according to the diagram below: 52 Version: 1.1.1 TF8400
## Page 53

PLC API Safety position The safety position is defined via the variables Safe Pos En and Safe Pos . The variable Safe Pos En is used to describe whether the valve has a fixed safety position (Safe Pos En = TRUE) or whether the current position should be maintained (Safe Pos En = FALSE) The safety position is described with Safe Pos: Safe Pos = FALSE: Safety position of the valve: Pos Min Safe Pos = TRUE: Safety position of the valve: Pos Max Monitoring The control and the respective Feedback [} 20] can be monitored via Feedback monitoring [} 21]. The interface also has a position monitor, which extends the Feedback monitoring [} 21] with two additional outputs: The output Pos Reached Fbk indicates whether the set position has been reached: Pos Reached Fbk = (Pos Fbk - Pos) <= Pos Tolerance The time to reach the position is specified via the input Mon Pos Ti. If the time is exceeded, the output Mon Pos Err is set to TRUE. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Value scaling [} 19] Value limitation [} 20] Locking [} 20] Reset [} 23] Inheritance hierarchy FB_MTP_Ana Vlv FB_MTP_Mon Ana Vlv TF8400 Version: 1.1.1 53
## Page 54

PLC API Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] Open Aut BOOL Automatic switching request to move to the selected Read position of the valve. Close Aut BOOL Automatic switching request to close the valve. Read Open Fbk Ca Ic BOOL Source of the feedback signal Limit switch Valve open: Read 1: Calculated 0: Sensor Open Fbk BOOL Feedback signal Limit switch Valve open Read Close Fbk Ca Ic BOOL Source of the feedback signal Read Limit switch Valve closed: 1: Calculated 0: Sensor Close Fbk BOOL Feedback signal Limit switch Valve closed. Read Src* See Source Mode [} 15] Pos Int REAL Internal value specification for the position Read Pos Unit INT Unit of the position Read Pos Min REAL Lower limit of the value specification for the valve position Read Pos Max REAL Upper limit of the value specification for the valve position Read Pos Fbk Ca Ic BOOL Source of the position feedback value: Read 1: Calculated 0: Sensor Pos Fbk REAL Feedback value of the position Read Pos Sc IMin REAL Scale start of the position display Read Pos Sc IMax REAL Scale end of the position display Read Perm* See Locking [} 20] Int* Prot* Safe Pos En BOOL Use the safe position of the valve: Read 1: Use safe position. 0: Do not use safe position. Safe Pos BOOL Safe position of the valve: Read 1: Open 0: Closed Reset Aut BOOL Automatic reset switching request: Read 1: Reset requested. 0: No reset requested. 54 Version: 1.1.1 TF8400
## Page 55

PLC API Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] Open Act BOOL Open valve switching command. Read Close Ad BOOL Close valve switching command. Read Src* See Source Mode [} 15] Pos REAL Position setpoint on valve Read Safe Pos Act BOOL Safe position: Read 1: Move to a safe position 0: Normal operation External variables Name Type Description OPC UA access State* See Operation Mode [} 13] Open Op BOOL Operator switching request to move to the selected Read/write position of the valve. Close Op BOOL Operator switching request to close the valve. Read/write Src* See Source Mode [} 15] Pos Man BOOL Manual value specification for the position Read/write Pos Rbk REAL Unprocessed value of the Operator Value specification Read/write for the position Reset Op BOOL Operator reset switching request: Read/write 0→1: Operator request 1→0: Request has been processed. Mon En BOOL Enable Feedback Monitoring: Read/write 1: Feeedback Monitoring active 0: Feedback Monitoring inactive Methods Name Description Set Offline See Operation Mode [} 13] Set Operator Set Automatic Set Internal See Source Mode [} 15] Set Manual TF8400 Version: 1.1.1 55
## Page 56

PLC API 5.3.1.9 FB_MTP_PIDCtrl Base The function block FB_MTP_PIDCtrl Base serves as an interface for using a PID controller from different sources: internal PLC logic or manual operation (e. g. via OPC UA). Value specifications are managed independently of each other by the state machines of Operation Mode [} 13] and Source Mode [} 15]. The OPC UA access rights are described in the variable tables. The FB_MTP_PIDCtrl Base is an abstract function block. This cannot be instantiated, but must be derived (see syntax)! State machines The source of the setpoint SP* is managed via the state machine of the Source Mode [} 15]. The source of the output manipulated variable MV* is managed via the state machine of the Operation Mode [} 13]: Output value of the PID logic or specification by manual operation MVMan. PID controller The PID logic (PIDLogic()) can be freely selected. The PID logic is called via the method PIDLogic(). The parameters for the controller are described via the inputs P, Ti and Td. The output MV describes the current manipulated variable depending on the current states of the state machines. The output SP shows the currently used setpoint of the PID logic. The function block works according to the following scheme: 56 Version: 1.1.1 TF8400
## Page 57

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Value scaling [} 19] Value limitation [} 20] Unit [} 19] Syntax FUNCTION_BLOCK FB_MTP_PIDCtrl EXTENDS FB_MTP_PIDCtrl Base VAR ///Controller Toolbox (delete if you want to use own PID Logic) CTRL_PID: FB_CTRL_PID; PIDParams: ST_Ctrl_PID_PARAMS; END_VAR SUPER^(); Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Operation Mode [} 13] MVUnit INT Unit of manipulated variable Read MVScl Min REAL Minimum value of the manipulated variable display Read MVScl Max REAL Maximum value of the manipulated variable display Read MVMin REAL Minimum value of the manipulated variable Read MVMax REAL Maximum value of the manipulated variable Read Src* See Source Mode [} 15] SPInt REAL internal setpoint specification Read SPUnit INT Unit of the setpoint Read SPInt Min REAL Lower limit value of the internal setpoint specification Read TF8400 Version: 1.1.1 57
## Page 58

PLC API Name Type Description OPC UA access SPInt Max REAL Upper limit value of the PEA internal setpoint Read specification SPMan Min REAL Lower limit value of the manual setpoint specification Read SPMan Max REAL Upper limit value of the manual setpoint specification Read SPScl Min REAL Minimum value for the display of the setpoint Read specification SPScl Max REAL Maximum value for the display of the setpoint Read specification PV REAL Process value Read PVUnit INT Unit of the process value Read PVScl Min REAL Minimum value for displaying the process value Read PVScl Max REAL Maximum value for displaying the process value Read P REAL Proportional gain of the controller Read Ti REAL Integral action time of the controller [s] Read Td REAL Derivative action time of the controller [s] Read Outputs Name Type Description OPC UA access State* See Operation Mode [} 13] MV REAL Current manipulated variable of the controller Src* See Source Mode [} 15] SP REAL Setpoint currently used by the controller. External variables Name Type Description OPC UA access State* See Operation Mode [} 13] MVMan REAL Manual specification of the manipulated variable Read/write Src* See Source Mode [} 15] SPMan REAL Manual setpoint specification Read/write Methods Name Description PIDLogic Implementation of the logic for calling the PID controller Reset PID Resetting the PID controller 5.3.1.9.1 PIDLogic This method enables the implementation of the logic of the PID controller. Syntax METHOD PIDLogic : BOOL Call Beckhoff PID controller (Tc2_Controller Toolbox is required) //Set PID Params PIDParams.t Ctrl Cycle Time := LREAL_TO_TIME(f Cycle Time * 1000); PIDParams.t Task Cycle Time := LREAL_TO_TIME(f Cycle Time * 1000); 58 Version: 1.1.1 TF8400
## Page 59

PLC API PIDParams.f Kp := P; PIDParams.t Tn := REAL_TO_TIME(TI * 1000); PIDParams.t Tv := REAL_TO_TIME(TD * 1000); PIDParams.f Out Max Limit := MVMax; PIDParams.f Out Min Limit := MVMin; PIDParams.b ARWOn IPart Only := TRUE; //Call Controller Toolbox PID function block CTRL_PID( f Setpoint Value := SP, f Actual Value := PV, e Mode := e CTRL_MODE_ACTIVE, st Params := PIDParams); //Write resulting Manipulated Value to MTP function block MV:= LREAL_TO_REAL(CTRL_PID.f Out); Return value Name Type Description PIDLogic BOOL 5.3.1.9.2 Reset PID This method allows the implementation of a logic for resetting the PID logic. Syntax METHOD Reset PID : BOOL CTRL_PID( e Mode := e CTRL_MODE_Reset, st Params:= PIDParams ); //Write resulting Manipulated Value to MTP function block MV:= LREAL_TO_REAL(CTRL_PID.f Out); 5.3.2 Diagnostic Elements Locking views visualize the current state of a basic logical operation AND/OR. TF8400 Version: 1.1.1 59
## Page 60

PLC API 5.3.2.1 FB_MTP_Lock View4 The function block FB_MTP_Lock View4 is an object for visualizing a basic logical operation AND/OR with four inputs. This is made available via OPC UA. Each input can be enabled *En, inverted *Inv and described with a text *Txt. Each input also contains a quality code *QC. It describes the conditions under which the value of the interface was recorded and how trustworthy this value is. The inputs can be evaluated as AND-logic (Logic = TRUE) or as OR-logic (Logic = FALSE). The linking result from the inputs is output at Out . Only enabled inputs are taken into account for this. The result of the QC inputs is output at Out QC. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Inputs Name Type Description OPC UA access WQC BYTE Worst Quality Code Read Logic BOOL Logical operation: Read 0: OR 1: AND In1En BOOL Enable input 1: Read 0: Input not enabled. 1: Input enabled In1 BOOL Input 1 - value Read In1QC BYTE Input 1 – Qualitiy Code Read In1lnv BOOL Invert input 1: Read 0: Not inverted 1: Inverted 60 Version: 1.1.1 TF8400
## Page 61

PLC API Name Type Description OPC UA access In1Txt STRING Input 1 - description text Read In2En BOOL Enable input 2: Read 0: Input not enabled. 1: Input enabled. In2 BOOL Input 2 - value Read In2QC BYTE Input 2 – Qualitiy Code Read In2Inv BOOL Invert input 2: Read 0: Not inverted 1: Inverted In2Txt STRING Input 2 - description text Read In3En BOOL Enable input 3: Read 0: Input not enabled. 1: Input enabled. In3 BOOL Input 3 - value Read In3QC BYTE Input 3 – Qualitiy Code Read In3Inv BOOL Invert input 3: Read 0: Not inverted 1: Inverted In3Txt STRING Input 3 - description text Read In4En BOOL Enable input 4: Read 0: Input not enabled. 1: Input enabled. In4 BOOL Input 4 - value Read In4QC BYTE Input 4 – Qualitiy Code Read In4Inv BOOL Invert input 4: Read 0: Not inverted 1: Inverted In4Txt STRING Input 4 - description text Read Outputs Name Type Description OPC UA access Out BOOL Output of the link result Read Out QC BOOL QC of the link result Read TF8400 Version: 1.1.1 61
## Page 62

PLC API 5.3.2.2 FB_MTP_Lock View8 The function block FB_MTP_Lock View8 is an object for visualizing a basic logical operation AND/OR with eight inputs. This is made available via OPC UA. Each input can be enabled *En, inverted *Inv and described with a text *Txt. Each input also contains a quality code *QC. It describes the conditions under which the value of the interface was recorded and how trustworthy this value is. The inputs can be evaluated as AND-logic (Logic = TRUE) or as OR-logic (Logic = FALSE). The linking result from the inputs is output at Out . Only enabled inputs are taken into account for this. The result of the QC inputs is output at Out QC. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] 62 Version: 1.1.1 TF8400
## Page 63

PLC API Inputs Name Type Description OPC UA access WQC BYTE Worst Quality Code Read Logic BOOL Logical operation: Read 0: OR 1: AND In1En BOOL Enable input 1: Read 0: Input not enabled. 1: Input enabled In1 BOOL Input 1 - value Read In1QC BYTE Input 1 – Qualitiy Code Read In1lnv BOOL Invert input 1: Read 0: Not inverted 1: Inverted In1Txt STRING Input 1 - description text Read In2En BOOL Enable input 2: Read 0: Input not enabled. 1: Input enabled. In2 BOOL Input 2 - value Read In2QC BYTE Input 2 – Qualitiy Code Read In2Inv BOOL Invert input 2: Read 0: Not inverted 1: Inverted In2Txt STRING Input 2 - description text Read In3En BOOL Enable input 3: Read 0: Input not enabled. 1: Input enabled. In3 BOOL Input 3 - value Read In3QC BYTE Input 3 – Qualitiy Code Read In3Inv BOOL Invert input 3: Read 0: Not inverted 1: Inverted In3Txt STRING Input 3 - description text Read In4En BOOL Enable input 4: Read 0: Input not enabled. 1: Input enabled. In4 BOOL Input 4 - value Read In4QC BYTE Input 4 – Qualitiy Code Read In4Inv BOOL Invert input 4: Read 0: Not inverted 1: Inverted In4Txt STRING Input 4 - description text Read In5En BOOL Enable input 5: Read 0: Input not enabled. 1: Input enabled. In5 BOOL Input 5 - value Read In5QC BYTE Input 5 – Qualitiy Code Read TF8400 Version: 1.1.1 63
## Page 64

PLC API Name Type Description OPC UA access In5lnv BOOL Invert input 5: Read 0: Not inverted 1: Inverted In5Txt STRING Input 5 - description text Read In6En BOOL Enable input 6: Read 0: Input not enabled. 1: Input enabled. In6 BOOL Input 6 - value Read In6QC BYTE Input 6 – Qualitiy Code Read In6Inv BOOL Invert input 6: Read 0: Not inverted 1: Inverted In6Txt STRING Input 6 - description text Read In7En BOOL Enable input 7: Read 0: Input not enabled. 1: Input enabled. In7 BOOL Input 7 - value Read In7QC BYTE Input 7 – Qualitiy Code Read In7Inv BOOL Invert input 7: Read 0: Not inverted 1: Inverted In7Txt STRING Input 7 - description text Read In8En BOOL Enable input 8: Read 0: Input not enabled. 1: Input enabled. In8 BOOL Input 8 - value Read In8QC BYTE Input 8 – Qualitiy Code Read In8Inv BOOL Invert input 8: Read 0: Not inverted 1: Inverted In8Txt STRING Input 8 - description text Read Outputs Name Type Description OPC UA access Out BOOL Output of the link result Read Out QC BOOL QC of the link result Read 64 Version: 1.1.1 TF8400
## Page 65

PLC API 5.3.2.3 FB_MTP_Lock View16 The function block FB_MTP_Lock View16 is an object for visualizing a basic logical operation AND/OR with sixteen inputs. This is made available via OPC UA. Each input can be enabled *En, inverted *Inv and described with a text *Txt. Each input also contains a quality code *QC. It describes the conditions under which the value of the interface was recorded and how trustworthy this value is. The inputs can be evaluated as AND-logic (Logic = TRUE) or as OR-logic (Logic = FALSE). The linking result from the inputs is output at Out . Only enabled inputs are taken into account for this. The result of the QC inputs is output at Out QC. TF8400 Version: 1.1.1 65
## Page 66

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Inputs Name Type Description OPC UA access WQC BYTE Worst Quality Code Read Logic BOOL Logical operation: Read 0: OR 1: AND In1En BOOL Enable input 1: Read 0: Input not enabled. 1: Input enabled In1 BOOL Input 1 - value Read In1QC BYTE Input 1 – Qualitiy Code Read In1lnv BOOL Invert input 1: Read 0: Not inverted 1: Inverted In1Txt STRING Input 1 - description text Read In2En BOOL Enable input 2: Read 0: Input not enabled. 1: Input enabled. In2 BOOL Input 2 - value Read In2QC BYTE Input 2 – Qualitiy Code Read In2Inv BOOL Invert input 2: Read 0: Not inverted 1: Inverted In2Txt STRING Input 2 - description text Read In3En BOOL Enable input 3: Read 0: Input not enabled. 1: Input enabled. In3 BOOL Input 3 - value Read In3QC BYTE Input 3 – Qualitiy Code Read In3Inv BOOL Invert input 3: Read 0: Not inverted 1: Inverted In3Txt STRING Input 3 - description text Read In4En BOOL Enable input 4: Read 0: Input not enabled. 1: Input enabled. In4 BOOL Input 4 - value Read In4QC BYTE Input 4 – Qualitiy Code Read In4Inv BOOL Invert input 4: Read 0: Not inverted 1: Inverted 66 Version: 1.1.1 TF8400
## Page 67

PLC API Name Type Description OPC UA access In4Txt STRING Input 4 - description text Read In5En BOOL Enable input 5: Read 0: Input not enabled. 1: Input enabled. In5 BOOL Input 5 - value Read In5QC BYTE Input 5 – Qualitiy Code Read In5lnv BOOL Invert input 5: Read 0: Not inverted 1: Inverted In5Txt STRING Input 5 - description text Read In6En BOOL Enable input 6: Read 0: Input not enabled. 1: Input enabled. In6 BOOL Input 6 - value Read In6QC BYTE Input 6 – Qualitiy Code Read In6Inv BOOL Invert input 6: Read 0: Not inverted 1: Inverted In6Txt STRING Input 6 - description text Read In7En BOOL Enable input 7: Read 0: Input not enabled. 1: Input enabled. In7 BOOL Input 7 - value Read In7QC BYTE Input 7 – Qualitiy Code Read In7Inv BOOL Invert input 7: Read 0: Not inverted 1: Inverted In7Txt STRING Input 7 - description text Read In8En BOOL Enable input 8: Read 0: Input not enabled. 1: Input enabled. In8 BOOL Input 8 - value Read In8QC BYTE Input 8 – Qualitiy Code Read In8Inv BOOL Invert input 8: Read 0: Not inverted 1: Inverted In8Txt STRING Input 8 - description text Read In9En BOOL Enable input 9: Read 0: Input not enabled. 1: Input enabled. In9 BOOL Input 9 - value Read In9QC BYTE Input 9 – Qualitiy Code Read In9lnv BOOL Invert input 9: Read 0: Not inverted 1: Inverted In9Txt STRING Input 9 - description text Read In10En BOOL Enable input 10: Read TF8400 Version: 1.1.1 67
## Page 68

PLC API Name Type Description OPC UA access 0: Input not enabled. 1: Input enabled. In10 BOOL Input 10 - value Read In10QC BYTE Input 10 – Qualitiy Code Read In10Inv BOOL Invert input 10: Read 0: Not inverted 1: Inverted In10Txt STRING Input 10 - description text Read In11En BOOL Enable input 11: Read 0: Input not enabled. 1: Input enabled. In11 BOOL Input 11 - value Read In11QC BYTE Input 11 – Qualitiy Code Read In11Inv BOOL Invert input 11: Read 0: Not inverted 1: Inverted In11Txt STRING Input 11 - description text Read In12En BOOL Enable input 12: Read 0: Input not enabled. 1: Input enabled. In12 BOOL Input 12 - value Read In12QC BYTE Input 12 – Qualitiy Code Read In12Inv BOOL Invert input 12: Read 0: Not inverted 1: Inverted In12Txt STRING Input 12 - description text Read In13En BOOL Enable input 13: Read 0: Input not enabled. 1: Input enabled. In13 BOOL Input 13 - value Read In13QC BYTE Input 13 – Qualitiy Code Read In13lnv BOOL Invert input 13: Read 0: Not inverted 1: Inverted In13Txt STRING Input 13 - description text Read In14En BOOL Enable input 14: Read 0: Input not enabled. 1: Input enabled. In14 BOOL Input 14 - value Read In14QC BYTE Input 14 – Qualitiy Code Read In14Inv BOOL Invert input 14: Read 0: Not inverted 1: Inverted In14Txt STRING Input 14 - description text Read In15En BOOL Enable input 15: Read 0: Input not enabled. 1: Input enabled. 68 Version: 1.1.1 TF8400
## Page 69

PLC API Name Type Description OPC UA access In15 BOOL Input 15 - value Read In15QC BYTE Input 15 – Qualitiy Code Read In15Inv BOOL Invert input 15: Read 0: Not inverted 1: Inverted In15Txt STRING Input 15 - description text Read In16En BOOL Enable input 16: Read 0: Input not enabled. 1: Input enabled. In16 BOOL Input 16 - value Read In16QC BYTE Input 16 – Qualitiy Code Read In16Inv BOOL Invert input 16: Read 0: Not inverted 1: Inverted In16Txt STRING Input 16 - description text Read Outputs Name Type Description OPC UA access Out BOOL Output of the link result Read Out QC BOOL QC of the link result Read 5.3.3 Indicator Elements 5.3.3.1 FB_MTP_Ana View The function block FB_MTP_Ana View provides the analog input value V together with scale values and unit via OPC UA. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - TF8400 Version: 1.1.1 69
## Page 70

PLC API Name Type Description OPC UA access WQC BYTE Worst Quality Code Read V REAL Value Read VUnit INT Unit of value Read VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read 5.3.3.2 FB_MTP_Ana Mon The function block FB_MTP_Ana Mon makes the analog input value V available for manual operation (e.g. via OPC UA). This value V can be monitored for up to six limits. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Value scaling [} 19] Unit [} 19] Limit value monitoring [} 22] Inheritance hierarchy FB_MTP_Ana View FB_MTP_Ana Mon Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. V REAL Value Read VUnit INT Unit of value Read 70 Version: 1.1.1 TF8400
## Page 71

PLC API Name Type Description OPC UA access VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read VAHEn BOOL Monitor limit Alarm High: Read 1: Monitoring active 0: No monitoring VALEn BOOL Monitor limit Alarm Low: Read 1: Monitoring active 0: No monitoring VWHEn BOOL Monitor limit Warning High: Read 1: Monitoring active 0: No monitoring VWLEn BOOL Monitor limit Warning Low: Read 1: Monitoring active 0: No monitoring VTHEn BOOL Monitor limit Tolerance High: Read 1: Monitoring active 0: No monitoring VTLEn BOOL Monitor limit Tolerance Low: Read 1: Monitoring active 0: No monitoring Outputs Name Type Description OPC UA access VAHAct BOOL Alarm High limit exceeded. Read VALAct BOOL Alarm Low limit not reached. Read VWHAct BOOL Warning High limit exceeded. Read VWLAct BOOL Warning Low limit not reached. Read VTHAct BOOL Tolerance High limit exceeded. Read VTLAct BOOL Tolerance Low limit not reached. Read External variables Name Type Description OPC UA access VAHLim REAL Alarm High limit Read/write VALLim REAL Alarm Low limit Read/write VWHLim REAL Warning High limit Read/write VWLLim REAL Warning Low limit Read/write VTHLim REAL Tolerance High limit Read/write VTLLim REAL Tolerance Low limit Read/write 5.3.3.3 FB_MTP_DInt View TF8400 Version: 1.1.1 71
## Page 72

PLC API The function block FB_MTP_DInt View provides the integer input value V via OPC UA. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read V DINT Value Read VUnit INT Unit of value Read VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read 5.3.3.4 FB_MTP_DInt Mon The function block FB_MTP_DInt Mon provides the integer input value V for manual operation (e. g. via OPC UA). This value V can be monitored for up to six limits. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Value scaling [} 19] Limit value monitoring [} 22] Inheritance hierarchy FB_MTP_DInt View 72 Version: 1.1.1 TF8400
## Page 73

PLC API FB_MTP_DInt Mon Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. V DINT Value Read VUnit INT Unit of value Read VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read VAHEn BOOL Monitor limit Alarm High: Read 1: Monitoring active 0: No monitoring VALEn BOOL Monitor limit Alarm Low: Read 1: Monitoring active 0: No monitoring VWHEn BOOL Monitor limit Warning High: Read 1: Monitoring active 0: No monitoring VWLEn BOOL Monitor limit Warning Low: Read 1: Monitoring active 0: No monitoring VTHEn BOOL Monitor limit Tolerance High: Read 1: Monitoring active 0: No monitoring VTLEn BOOL Monitor limit Tolerance Low: Read 1: Monitoring active 0: No monitoring Outputs Name Type Description OPC UA access VAHAct BOOL Alarm High limit exceeded. Read VALAct BOOL Alarm Low limit not reached. Read VWHAct BOOL Warning High limit exceeded. Read VWLAct BOOL Warning Low limit not reached. Read VTHAct BOOL Tolerance High limit exceeded. Read VTLAct BOOL Tolerance Low limit not reached. Read External variables Name Type Description OPC UA access VAHLim DINT Alarm High limit Read/write VALLim DINT Alarm Low limit Read/write VWHLim DINT Warning High limit Read/write TF8400 Version: 1.1.1 73
## Page 74

PLC API Name Type Description OPC UA access VWLLim DINT Warning Low limit Read/write VTHLim DINT Tolerance High limit Read/write VTLLim DINT Tolerance Low limit Read/write 5.3.3.5 FB_MTP_Bin View The function block FB_MTP_Bin View provides the binary input value V via OPC UA. A text can be assigned to the states TRUE and FALSE of the input value via the inputs VState0 and VState1. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read V BOOL Value Read VState0 STRING Text for value FALSE Read VState1 STRING Text for value TRUE Read 5.3.3.6 FB_MTP_Bin Mon The function block FB_MTP_Bin Mon provides the binary input value V for manual operation (e. g. via OPC UA). A text can be assigned to the states TRUE and FALSE of the input value via the inputs VState0 and VState1. Monitoring The binary input value V can be monitored for flutter (change of input signal). The output VFlut Act goes TRUE if the change in the input signal per time interval VFlut Ti exceeds the maximum value VFlut Cnt . The output signal VOut corresponds to the debounced input value V . VOut and follows a change in the input signal V after VFlut Len. The input signal V must retain its value for this time. 74 Version: 1.1.1 TF8400
## Page 75

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Inheritance hierarchy FB_MTP_Bin View FB_MTP_Bin Mon Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. V BOOL Value Read VState0 STRING Text for value FALSE Read VState1 STRING Text for value TRUE Read VFlut En BOOL Enable flutter monitoring: Read 1: Enabled 0: Disabled VFIut Len REAL Bounce time Read Outputs Name Type Description OPC UA access VOut BOOL Output value Read VFlut Act BOOL Input value flutters Read Vout BOOL Debounced input value Read External variables Name Type Description OPC UA access VFlut Ti REAL Duration of the time interval Read/write VFlut Cnt INT Maximum input signal changes per time interval Read/write 5.3.3.7 FB_MTP_String View The function block FB_MTP_String View makes the input variable Text available via OPC UA. Further characteristics Name of the object [} 18] TF8400 Version: 1.1.1 75
## Page 76

PLC API Object description [} 18] WQC [} 19] Inputs Name Type Description OPC UA access WQC BYTE Worst Quality Code Read Text STRING Dynamic text Read 5.3.4 Input Elements Input Elements are process-related input values that can be written as input values via OPC UA, for example. It is possible to adjust the value range (unit with value scaling) to ensure that the values are displayed correctly. 5.3.4.1 FB_MTP_Ana Process Value In The function block FB_MTP_Ana Process Value In provides an analog process value V with the associated Value Quality Code VQC from a higher-level system (e.g. via OPC UA). The variables Unit Cur, Scl Min Cur and Scl Max Cur are used to display the current unit and the current value scaling. Applying a new configuration A new configuration is specified via the variables Unit Ext, Scl Min Ext and Scl Max Ext. To change the configuration (unit and value scaling), an array of the type ST_MTP_Input Element Config [} 117] with a list of supported configurations is transferred on the PLC side via the input variable Configs. The value scaling for the respective units is stored in this array. Enabling the application of the configuration is signaled on the PLC side by the variable Apply En = TRUE. The application can then be requested via the variable Apply = TRUE. During the application, Unit Ext is compared with the stored possible limit values in Configs. If the limit is exceeded or not reached, the stored upper or lower limit value is used. 76 Version: 1.1.1 TF8400
## Page 77

PLC API Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read Configs ARRAY [*] Possible configurations - OF ST_MT P_Input E lements C onfig Apply En BOOL Enable for request: Read Apply configuration. Outputs Name Type Description OPC UA access VQC BYTE Quality Code for the value Read/write OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. V REAL Incoming process value via OPC UA Read/write Unit Cur INT Current unit Read Scl Min Cur REAL Current scale start Read Sc IMax Cur REAL Current scale end Read Unit Ext INT Configuration input for the unit Read/write Scl Min Ext REAL Configuration input for the scale start Read/write Scl Max Ext REAL Configuration input for the scale end Read/write Apply BOOL Requirement: Read/write Apply configuration (Unit* and Scl*). TF8400 Version: 1.1.1 77
## Page 78

PLC API 5.3.4.2 FB_MTP_DInt Process Value In The function block FB_MTP_DInt Process Value In provides an integer process value V with the associated Value Quality Code VQC from a higher-level system (e.g. via OPC UA). The variables Unit Cur, Scl Min Cur and Scl Max Cur are used to display the current unit and the current value scaling. Applying a new configuration A new configuration is specified via the variables Unit Ext, Scl Min Ext and Scl Max Ext. To change the configuration (unit and value scaling), an array of the type ST_MTP_Input Element Config [} 117] with a list of supported configurations is transferred on the PLC side via the input variable Configs. The value scaling for the respective units is stored in this array. Enabling the application of the configuration is signaled on the PLC side by the variable Apply En = TRUE. The application can then be requested via the variable Apply = TRUE. During the application, Unit Ext is compared with the stored possible limit values in Configs. If the limit is exceeded or not reached, the stored upper or lower limit value is used. Inputs Name Type Description OPC UA access WQC BYTE Worst Quality Code Read 78 Version: 1.1.1 TF8400
## Page 79

PLC API Name Type Description OPC UA access Configs ARRAY [*] Possible configurations - OF ST_MT P_Input E lements C onfig Apply En BOOL Enable for request: Read Apply configuration. Outputs Name Type Description OPC UA access VQC BYTE Quality Code for the value Read/write OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. V DINT Incoming process value via OPC UA Read/write Unit Cur INT Current unit of the process value Read Scl Min Cur DINT Current scale start Read Sc IMax Cur DINT Current scale end Read Unit Ext INT Configuration input for the unit Read/write Scl Min Ext DINT Configuration input for the scale start Read/write Scl Max Ext DINT Configuration input for the scale end Read/write Apply BOOL Requirement: Read/write Apply configuration (Scl* and Unit*). 5.3.4.3 FB_MTP_Bin Process Value In The function block FB_MTP_Bin Process Value In provides the binary value V from a higher-level system (e.g. via OPC UA). A text can be assigned to the TRUE and FALSE states of the value via the inputs VState0 and VState1. Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read VState0 String Text for value = FALSE Read VState1 String Text for value = TRUE Read Outputs Name Type Description OPC UA access VQC BYTE Quality Code for the value Read/write V BOOL Value Read/write TF8400 Version: 1.1.1 79
## Page 80

PLC API 5.3.4.4 FB_MTP_String Process Value In The function block FB_MTP_String Process Value In provides a process value V from a higher-level system (e.g. via OPC UA). Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read Outputs Name Type Description OPC UA access VQC BYTE Quality Code for the value Read/write V STRING Incoming process value via OPC UA Read/write 5.3.5 Output Elements Output Elements are instances of Indicator Elements [} 69], which are defined in the MTP file as Output Elements. They can contain information for other plant areas and are made available to a control system via OPC UA, for example. To use Output Elements, MTP Engineering and the MTP export contained in it need to be implemented! 5.3.6 Operation Elements 5.3.6.1 FB_MTP_Ana Man The function block FB_MTP_Ana Man is an object for an analog value specification of a manual operation VMan (e. g. via OPC UA). The output value VOut corresponds to the value limited by Value limitation [} 20]. Further characteristics Name of the object [} 18] Object description [} 18] OSLevel [} 18] Feedback [} 20] 80 Version: 1.1.1 TF8400
## Page 81

PLC API Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. VUnit INT Unit of value Read VMin REAL Upper limit of the value specification Read VMax REAL Lower limit of the value specification Read VFbk REAL Feedback value Read VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read Outputs Name Type Description OPC UA access VOut REAL Output value of the current value specification taking into Read account the limit values External variables Name Type Description OPC UA access VMan BOOL Manual value specification Read/write 5.3.6.2 FB_MTP_Ana Man Int The function block FB_MTP_Ana Man Int is an object for an analog value specification from different sources: internal PLC logic VInt or manual operation VMan (e. g. via OPC UA). The values are managed via the state machine of the Source Mode [} 15]. The output value VOut corresponds to the value limited by Value limitation [} 20]. TF8400 Version: 1.1.1 81
## Page 82

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Feedback [} 20] Value scaling [} 19] Unit [} 19] Inheritance hierarchy FB_MTP_Ana Man FB_MTP_Ana Man Int Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. Src* See Source Mode [} 15] VInt REAL Internal value specification. (Relevant if Src Int Act Read = TRUE) VUnit INT Unit of value Read VMin REAL Upper limit of the value specification Read VMax REAL Lower limit of the value specification Read VFbk REAL Feedback value Read VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read 82 Version: 1.1.1 TF8400
## Page 83

PLC API Outputs Name Type Description OPC UA access Src* See Source Mode [} 15] VOut REAL Output value of the current value specification taking into Read account the limit values External variables Name Type Description OPC UA access VMan REAL Manual value specification (Relevant if Src Man Act = Read TRUE) Src* See Source Mode [} 15] Methods Name Description Set Internal See Source Mode [} 15] Set Manual 5.3.6.3 FB_MTP_DInt Man The function block FB_MTP_DInt Man is an object for an integer value specification of a manual operation VMan (e. g. via OPC UA). The output value VOut corresponds to the value limited by Value limitation [} 20]. Further characteristics Name of the object [} 18] Object description [} 18] OSLevel [} 18] Feedback [} 20] Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. VUnit INT Unit of value Read TF8400 Version: 1.1.1 83
## Page 84

PLC API Name Type Description OPC UA access VMin DINT Upper limit of the value specification Read VMax DINT Lower limit of the value specification Read VFbk DINT Feedback value Read VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read Outputs Name Type Description OPC UA access VOut DINT Output value of the current value specification taking into Read account the limit values External variables Name Type Description OPC UA access VMan REAL Manual value specification Read/write 5.3.6.4 FB_MTP_DInt Man Int The function block FB_MTP_DInt Man Int is an object for an integer value specification from different sources: internal PLC logic VInt or manual operation VMan (e. g. via OPC UA). The values are managed via the state machine of the Source Mode [} 15]. The output value VOut corresponds to the value limited by Value limitation [} 20]. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Feedback [} 20] Value scaling [} 19] Unit [} 19] Inheritance hierarchy FB_MTP_DInt Man FB_MTP_DInt Man Int 84 Version: 1.1.1 TF8400
## Page 85

PLC API Inputs Name Type Description OPC UA access WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. Src* See Source Mode [} 15] VInt DINt Internal value specification. (Relevant if Src Int Act Read = TRUE) VUnit INT Unit of value Read VMin DINT Upper limit of the value specification Read VMax DINT Lower limit of the value specification Read VFbk DINT Feedback value Read VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read Outputs Name Type Description OPC UA access Src* See Source Mode [} 15] VOut DINT Output value of the current value specification taking into Read account the limit values External variables Name Type Description OPC UA access Src* See Source Mode [} 15] VMan REAL Manual value specification (Relevant if Src Man Act = Read TRUE) Methods Name Description Set Internal See Source Mode [} 15] Set Manual 5.3.6.5 FB_MTP_Bin Man The function block FB_MTP_Bin Man is an object for a binary value specification of a manual operation VMan (e. g. via OPC UA). The states TRUE and FALSE of the value specification are assigned state texts via the input variables VState0 and VState1. Further characteristics Name of the object [} 18] TF8400 Version: 1.1.1 85
## Page 86

PLC API Object description [} 18] OSLevel [} 18] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. VState0 STRING Text for value VOut = FALSE Read VState1 STRING Text for value VOut = TRUE Read VFbk BOOL Feedback value Read Outputs Name Type Description OPC UA access VOut REAL Output value of the current value specification Read External variables Name Type Description OPC UA access VMan BOOL Manual value specification Read 5.3.6.6 FB_MTP_Bin Man Int The function block FB_MTP_Bin Man Int is an object for a binary value specification from different sources: internal PLC logic VInt or manual operation VMan (e. g. via OPC UA). The values are managed via the state machine of the Source Mode [} 15]. The states TRUE and FALSE of the value specification are assigned state texts via the input variables VState0 and VState1. Further characteristics Name of the object [} 18] Object description [} 18] OSLevel [} 18] Inheritance hierarchy FB_MTP_Bin Man FB_MTP_Bin Man Int 86 Version: 1.1.1 TF8400
## Page 87

PLC API Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. VUnit INT Unit of value Read VMin DINT Upper limit of the value specification Read VMax DINT Lower limit of the value specification Read VFbk DINT Feedback value Read VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read Src* See Source Mode [} 15] VInt BOOL Internal value specification (Relevant if Src Int Act = Read True) Outputs Name Type Description OPC UA access Src* See Source Mode [} 15] VOut DINT Output value of the current value specification taking into Read account the limit values External variables Name Type Description OPC UA access Src* See Source Mode [} 15] VMan BOOL Manual value specification (Relevant if Src Man Act = Read True) Methods Name Description Set Internal See Source Mode [} 15] Set Manual 5.3.7 Parameter Elements Parameter Elements are objects for value specifications by parameters from different sources: internal PLC logic and manual operation (e.g. via OPC UA). The values are managed via the state machine Service Mode [} 17]. The parameters can be divided into configuration parameters and procedure parameters. Configuration parameters are assigned to a service and can be used by all procedures. Procedure parameters are assigned to one or more procedures within a service. Parameter instances that are transferred to the input Conf Parameters of a service are considered configuration parameters. Parameter instances that are transferred to one or more procedures of the service at the input Proc Parameters are considered procedure parameters. TF8400 Version: 1.1.1 87
## Page 88

PLC API The sum of all procedure parameters of the procedures of a service must also be transferred collectively at the input Proc Parameters of the higher-level service. For the use of parameters, the use of MTP engineering and its automatic code generation is recommended! 5.3.7.1 FB_MTP_Ana Serv Param The function block FB_MTP_Ana Serv Param is an object for analog parameter value specifications from different sources: internal PLC logic or manual operation (e.g. via OPC UA). The values are managed via the state machine Service Mode [} 17]. The output value VOut corresponds to the current value specification limited to limit values and can be used within a service (see Parameter Elements [} 87]). Applying values Each parameter follows the same procedure when applying values. The values are applied in two steps: 1. Preparing the value 2. Applying of the value The preparation of the value begins with the value specification via the variables VOp, VInt, VExt. Depending on the state of the Service Mode [} 17], a value is selected and limited via the value limit. The resulting requested value is displayed via the variable VReq. To apply the value, the enabling is signaled on the PLC side via the variable Apply En = TRUE. The application can then be confirmed via variables Apply Op, Apply Int or Apply Ext, depending on the state of Service Mode [} 17]. After successful application, the value of the variable VOut corresponds to the value of VReq. 88 Version: 1.1.1 TF8400
## Page 89

PLC API Values can also be applied at service level using the same procedure. See the Parameters section at FB_MTP_Service Control [} 106]. Operation mode synchronization with higher-level service The Service Mode of the parameter can be synchronized with the higher-level service via the variable Sync. The input variables for controlling the state machine are ignored and the state machine of the parameter automatically assumes the state of the Service Mode [} 17] of the service. TF8400 Version: 1.1.1 89
## Page 90

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Service Mode [} 17] Value scaling [} 19] Unit [} 19] Value limitation [} 20] Read back [} 20] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Service Mode [} 17] Src* Apply En BOOL Enable Apply parameter: Read 1: Parameters can be applied. 0: Parameters cannot be applied. Applylnt BOOL Internal switching request to apply requested Read parameters (relevant if State Aut Act = TRUE and Src Int Act = TRUE): 1: Apply value. 0: Do not apply value sync BOOL Operation mode synchronization: Read/write 1: Synchronize with service. 0: Independent operation VInt REAL Internal value specification (relevant if State Aut Act Read = TRUE and Src Int Act = TRUE) VUnit INT Unit of value Read VMin REAL Upper limit of the value specification Read VMax REAL Lower limit of the value specification Read VFbk REAL Feedback value Read VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read Outputs Name Type Description OPC UA access State* See Service Mode [} 17] 90 Version: 1.1.1 TF8400
## Page 91

PLC API Name Type Description OPC UA access Src* VOut REAL Current parameter value Read External variables Name Type Description OPC UA access State* See Service Mode [} 17] Src* Apply Op BOOL Operator switching request to apply currently requested Read/write parameters (relevant if State Op Act = TRUE): 1: Apply value. 0: Do not apply value Apply Ext BOOL External switching request to apply currently requested Read/write parameters (relevant if Src Ext Act = TRUE and State Aut Act = TRUE): 1: Apply value. 0: Do not apply value VOp REAL Operator value specification (relevant if State Op Act Read/write = TRUE) VExt REAL External value specification (relevant if Src Ext Act = Read/write TRUE and State Aut Act = TRUE) 5.3.7.2 FB_MTP_DInt Serv Param The function block FB_MTP_DInt Serv Param is an object for integer parameter value specifications from different sources: internal PLC logic and manual operation (e.g. via OPC UA). The values are managed via the state machine Service Mode [} 17]. The output value VOut corresponds to the current value specification limited to limit values and can be used within a service (see Parameter Elements [} 87]). Applying values Each parameter follows the same procedure when applying values. The values are applied in two steps: 1. Preparing the value 2. Applying of the value TF8400 Version: 1.1.1 91
## Page 92

PLC API The preparation of the value begins with the value specification via the variables VOp, VInt, VExt. Depending on the state of the Service Mode [} 17], a value is selected and limited via the value limit. The resulting requested value is displayed via the variable VReq. To apply the value, the enabling is signaled on the PLC side via the variable Apply En = TRUE. The application can then be confirmed via variables Apply Op, Apply Int or Apply Ext, depending on the state of Service Mode [} 17]. After successful application, the value of the variable VOut corresponds to the value of VReq. Values can also be applied at service level using the same procedure. See the Parameters section at FB_MTP_Service Control [} 106]. Operation mode synchronization with higher-level service The Service Mode of the parameter can be synchronized with the higher-level service via the variable Sync. The input variables for controlling the state machine are ignored and the state machine of the parameter automatically assumes the state of the Service Mode [} 17] of the service. 92 Version: 1.1.1 TF8400
## Page 93

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Service Mode [} 17] Value scaling [} 19] Unit [} 19] Value limitation [} 20] Read back [} 20] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Service Mode [} 17] Src* Apply En BOOL Enable Apply parameter: Read 1: Parameters can be applied. 0: Parameters cannot be applied. TF8400 Version: 1.1.1 93
## Page 94

PLC API Name Type Description OPC UA access Applylnt BOOL Internal switching request to apply requested Read parameters (relevant if State Aut Act = TRUE and Src Int Act = TRUE): 1: Apply value. 0: Do not apply value sync BOOL Operation mode synchronization: Read/write 1: Synchronize with service. 0: Independent operation VInt DINT Internal value specification (relevant if State Aut Act Read = TRUE and Src Int Act = TRUE) VUnit INT Unit of value Read VMin DINT Upper limit of the value specification Read VMax DINT Lower limit of the value specification Read VFbk DINT Feedback value Read VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read Outputs Name Type Description OPC UA access State* See Service Mode [} 17] Src* Vout DINT Current parameter value Read External variables Name Type Description OPC UA access State* See Service Mode [} 17] Src* Apply Op BOOL Operator switching request to apply currently requested Read/write parameters (relevant if State Op Act = TRUE): 1: Apply value. 0: Do not apply value Apply Ext BOOL External switching request to apply currently requested Read/write parameters (relevant if Src Ext Act = TRUE and State Aut Act = TRUE): 1: Apply value. 0: Do not apply value VOp DINT Operator value specification (relevant if State Op Act Read/write = TRUE) VExt DINT External value specification (relevant if Src Ext Act = Read/write TRUE and State Aut Act = TRUE) 94 Version: 1.1.1 TF8400
## Page 95

PLC API 5.3.7.3 FB_MTP_Bin Serv Param The function block FB_MTP_Bin Serv Param is an object for binary parameter value specifications from different sources: internal PLC logic and manual operation (e.g. via OPC UA). The values are managed via the state machine Service Mode [} 17]. The output value VOut corresponds to the current value specification limited to limit values and can be used within a service (see Parameter Elements [} 87]). Applying values Each parameter follows the same procedure when applying values. The values are applied in two steps: 1. Preparing the value 2. Applying of the value The preparation of the value begins with the value specification via the variables VOp, VInt, VExt. Depending on the state of the Service Mode [} 17], a value is selected and limited via the value limit. The resulting requested value is displayed via the variable VReq. To apply the value, the enabling is signaled on the PLC side via the variable Apply En = TRUE. The application can then be confirmed via variables Apply Op, Apply Int or Apply Ext, depending on the state of Service Mode [} 17]. After successful application, the value of the variable VOut corresponds to the value of VReq. TF8400 Version: 1.1.1 95
## Page 96

PLC API Values can also be applied at service level using the same procedure. See the Parameters section at FB_MTP_Service Control [} 106]. Operation mode synchronization with higher-level service The Service Mode of the parameter can be synchronized with the higher-level service via the variable Sync. The input variables for controlling the state machine are ignored and the state machine of the parameter automatically assumes the state of the Service Mode [} 17] of the service. 96 Version: 1.1.1 TF8400
## Page 97

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Service Mode [} 17] Read back [} 20] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. State* See Service Mode [} 17] Src* Apply En BOOL Enable Apply parameter: Read 1: Parameters can be applied. 0: Parameters cannot be applied. Applylnt BOOL Internal switching request to apply requested Read parameters (relevant if State Aut Act = TRUE and Src Int Act = TRUE): 1: Apply value. 0: Do not apply value sync BOOL Operation mode synchronization: Read/write 1: Synchronize with service. 0: Independent operation VInt BOOL Internal value specification (relevant if State Aut Act Read = TRUE and Src Int Act = TRUE) VState0 STRING Text for value VOut = FALSE Read VState1 STRING Text for value VOut = TRUE Read VFbk BOOL Feedback value Read Outputs Name Type Description OPC UA access State* See Src* Vout BOOL Current parameter value Read External variables Name Type Description OPC UA access State* See Service Mode [} 17] Src* TF8400 Version: 1.1.1 97
## Page 98

PLC API Name Type Description OPC UA access Apply Op BOOL Operator switching request to apply currently requested Read/write parameters (relevant if State Op Act = TRUE): 1: Apply value. 0: Do not apply value Apply Ext BOOL External switching request to apply currently requested Read/write parameters (relevant if Src Ext Act = TRUE and State Aut Act = TRUE): 1: Apply value. 0: Do not apply value VOp REAL Operator value specification (relevant if State Op Act Read/write = TRUE) VExt REAL External value specification (relevant if Src Ext Act = Read/write TRUE and State Aut Act = TRUE) 5.3.7.4 FB_MTP_String Serv Param The function block FB_MTP_String Serv Param is an object for string parameter value specifications from different sources: internal PLC logic and manual operation (e.g. via OPC UA). The values are managed via the state machines Service Mode [} 17]. The output value VOut corresponds to the current value specification limited to limit values and can be used within a service (see Parameter Elements [} 87]). Applying values Each parameter follows the same procedure when applying values. The values are applied in two steps: 1. Preparing the value 2. Applying of the value The preparation of the value begins with the value specification via the variables VOp, VInt, VExt. Depending on the state of the Service Mode [} 17], a value is selected and limited via the value limit. The resulting requested value is displayed via the variable VReq. To apply the value, the enabling is signaled on the PLC side via the variable Apply En = TRUE. The application can then be confirmed via variables Apply Op, Apply Int or Apply Ext, depending on the state of Service Mode [} 17]. After successful application, the value of the variable VOut corresponds to the value of VReq. 98 Version: 1.1.1 TF8400
## Page 99

PLC API Values can also be applied at service level using the same procedure. See the Parameters section at FB_MTP_Service Control [} 106]. Operation mode synchronization with higher-level service The Service Mode of the parameter can be synchronized with the higher-level service via the variable Sync. The input variables for controlling the state machine are ignored and the state machine of the parameter automatically assumes the state of the Service Mode [} 17] of the service. TF8400 Version: 1.1.1 99
## Page 100

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Service Mode [} 17] Read back [} 20] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. VInt STRING Internal value specification (relevant if State Aut Act Read = TRUE and Src Int Act = TRUE) VUnit INT Unit of value Read VMin REAL Upper limit of the value specification Read VMax REAL Lower limit of the value specification Read VFbk REAL Feedback value Read VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read Outputs Name Type Description OPC UA access State* See Service Mode [} 17] Src* Vout STRING Current parameter value Read External variables Name Type Description OPC UA access State* See Service Mode [} 17] Src* Apply Op BOOL Operator switching request to apply currently requested Read/write parameters (relevant if State Op Act = TRUE): 1: Apply value. 0: Do not apply value Apply Ext BOOL External switching request to apply currently requested Read/write parameters (relevant if Src Ext Act = TRUE and State Aut Act = TRUE): 1: Apply value. 0: Do not apply value VOp STRING Operator value specification (relevant if State Op Act Read/write = TRUE) 100 Version: 1.1.1 TF8400
## Page 101

PLC API Name Type Description OPC UA access VExt STRING External value specification (relevant if Src Ext Act = Read/write TRUE and State Aut Act = TRUE) 5.3.8 Pea Elements 5.3.8.1 FB_MTP_Pea Information Label The function block FB_MTP_Pea Information Label is an object that provides information about a PEA during runtime (e.g. via OPC UA). PEA stands for Process Equipment Assembly and is a process technology module. One instance of this object is created per module. The information at the output of this FB is initialized when the FB is instantiated. These values can be read and changed during runtime by a manual operation (e.g. via OPC UA) (see access rights in the variable tables). The variables Asset Id, Component Name and Device Class are declared as persistent. Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - Device Hea Ith BYTE Summarized WQC at module level (see also WQC [} 19]) Read Outputs Name Type Description OPC UA access Assetld STRING Unique ID within a system. This can be specified by the Read/write system operator. Component Name STRING Module name within a system. This can be specified by Read/write the system operator. Device CIass STRING The device class can be predefined by the PEA Read/write manufacturer. This value can be overwritten by the system operator. Device Manua I STRING Reference to module-related documents (e.g. web Read pages) Device Revision STRING Version information of the interface. This is executed as a Read Major. Minor. Patch notation (e.g. 1.2.3). Hardware Revision STRING Version information of the structure of a PEA. This is Read executed as a Major. Minor. Patch notation (e.g. 1.2.3). Manufacturer STRING Name of the module manufacturer Read Manufacturer Uri STRING Address of the manufacturer's web pages (e.g. Read www. Beckhoff.de) TF8400 Version: 1.1.1 101
## Page 102

PLC API Name Type Description OPC UA access Model STRING Name of the PEA. This value is identical to the name of Read the MTP. Product Code STRING Unique product name of the PEA Read Product Instance U STRING Unique identifier (URI) of the PEA (according to DIN Read ri SPEC 91406) Revision Counter STRING Revision counter Read Serial Number STRING Serial number of the PEA (Assigned by the PEA Read manufacturer.) Software Revision STRING Version information of the PLC software. This is executed Read as a Major. Minor. Patch notation (e.g. 1.2.3). 5.3.8.2 FB_MTP_Web Server Url Info The function block FB_MTP_Web Server Url Info is an object for providing an endpoint of an existing web server. If a web server is to be specified, the endpoint of the web server can be instantiated via the variable Url when the object is initialized. Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - Outputs Name Type Description OPC UA access Url STRING Endpoint of the web server Read 5.3.9 Service Elements System functions can be executed in encapsulated services FB_MTP_Service Control [} 106]. The service bundles various procedures, parameters and report values. The execution takes place in procedures. Procedures are different execution variants of a service. One example would be filling a tank: the service could be called Filling. The procedures of this service could be called Volume_Filling and Duration_Filling with different parameters to fill a certain volume or for a certain time. Services describe the function and execute it in procedures, so a service must always have at least one procedure FB_MTP_Procedure [} 103]. The following parameters can be transferred to the procedures for execution: 102 Version: 1.1.1 TF8400
## Page 103

PLC API Configuration parameters Configuration parameters are assigned to all procedures of a service. They are typically set during commissioning. Procedure parameters Unlike configuration parameters, procedure parameters can be assigned to one or more procedures of a service. They are typically set before a service is started. Report values Report Values are assigned to one or more procedures of a service. They can be used, for example, to document important process values. 5.3.9.1 FB_MTP_Procedure The function block FB_MTP_Procedure contains all attributes and methods for describing a procedure. A procedure is an execution variant of a service and can therefore only be assigned to one service. All procedures receive a unique Procedure ID in the service. This must be described by a natural number, whereby the number 0 may not be used! The variable Is Self Completing is used to specify whether the process function(s) of the procedure complete(s) themselves (e.g. after a time has elapsed). The outputs Is Self Completing and Procedure ID are initialized when this function block is instantiated. Command Info is coded according to and is updated separately for each procedure that is in the state Automatic or Operator, regardless of the state of the service. It indicates which control commands are currently enabled. The variable Command Adapt is coded according to . It can be used to further restrict the enabling of control commands in Command Info. The variable Command Adapt is not part of the MTP guideline. It has been implemented additionally. This variable is not listed in the MTP file and is not made available via OPC UA. The FB_MTP_Procedure is an abstract function block. This cannot be instantiated, but must be derived (see Syntax section)! For the use of procedures, the use of MTP engineering and its automatic code generation is recommended! Required parameters and equipment The function block receives the process parameters Proc Parameters required for execution as Array[*] OF POINTER TO FB_MTP_Parameter Element. The required equipment Required Equipment is transferred as Array[*] OF POINTER TO I_MTP_Req Eq. If no Proc Parameter or Required Equipment is required, you must transfer an empty array! TF8400 Version: 1.1.1 103
## Page 104

PLC API Services state machine The states of the service state machine are executed in the methods of the same name in this function block. The methods are called by the service state machine. Calling the procedure The procedures can be called by the higher-level service. A possible call is described in the function block FB_MTP_Service Control [} 106]. Further characteristics WQC [} 19] Syntax FUNCTION_BLOCK FB_MTP_Procedure_1_Service EXTENDS FB_MTP_Procedure Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read Command Info DWORD Currently enabled control commands Read Proc Parameters ARRAY [*] Required procedure parameters - OF POINTER TO POINTER TO FB_MTP_ Parameter Element Required Equipme ARRAY [*] Required equipment - nt OF POINTER TO I_MTP_Re q Eq Command Adapt DWORD Variable for blocking state transitions - Outputs Name Type Description OPC UA access Is Se If Comp Ieting BOOL 1: Procedure is self-completing. Read 0: Procedure is completed via the control command. Procedure ID DWORD Unique identification of the procedure within the service Read Methods Name Type Description Aborted BOOL Implementation of the logic for the Aborted state of the service state machine. Aborting BOOL Implementation of the logic for the Aborting state of the service state machine. Completed BOOL Implementation of the logic for the Completed state of the service state machine. 104 Version: 1.1.1 TF8400
## Page 105

PLC API Name Type Description Completing BOOL Implementation of the logic for the Completing state of the service state machine. Execute BOOL Implementation of the logic for the Execute state of the service state machine. Held BOOL Implementation of the logic for the Held state of the service state machine. Holding BOOL Implementation of the logic for the Holding state of the service state machine. Paused BOOL Implementation of the logic for the Paused state of the service state machine. Pausing BOOL Implementation of the logic for the Pausing state of the service state machine Resetting BOOL Implementation of the logic for the Resetting state of the service state machine. Resuming BOOL Implementation of the logic for the Resuming state of the service state machine. Starting BOOL Implementation of the logic for the Starting state of the service state machine. Stopping BOOL Implementation of the logic for the Stopping state of the service state machine. Stopped BOOL Implementation of the logic for the Stopped state of the service state machine. Unholding BOOL Implementation of the logic for the Unholding state of the service state machine. Is Actuators I BOOL 1: All actuators assigned to the procedure are in the state Internal. nternal Is Actuators BOOL 1: All actuators assigned to the procedure are in the state Manual. Manual Is Actuators BOOL 1: All actuators assigned to the procedure are in the state Offline. Offline Is Actuators BOOL 1: All actuators assigned to the procedure are in the state Operator. Operator Is Actuators BOOL 1: All actuators assigned to the procedure are in the state Automatic. Automatic Is Req Eq Int BOOL 1: PID logic and all actuators assigned to the procedure are in the state ernal Internal Is Req Eq Ma BOOL 1: PID logic and all actuators assigned to the procedure are in the state nual Manual Is Req Eq Off BOOL 1: PID logic and all actuators assigned to the procedure are in the state line Offline Is Req Eq Op BOOL 1: PID logic and all actuators assigned to the procedure are in the state erator Operator Is Req Eq Au BOOL 1: PID logic and all actuators assigned to the procedure are in the state tomatic Automatic Set Actuator BOOL All actuators assigned to the procedure are transferred to the state Internal. s Internal Set Actuator BOOL All actuators assigned to the procedure are transferred to the state Manual. s Manual Set Actuator BOOL All actuators assigned to the procedure are transferred to the state Offline. s Offline Set Actuator BOOL All actuators assigned to the procedure are transferred to the state Operator. s Operator Set Actuator BOOL All actuators assigned to the procedure are transferred to the state s Automatic Automatic. Set Req Eq I BOOL PID logic and all actuators assigned to the procedure are transferred to the nternal state Internal. Set Req Eq BOOL PID logic and all actuators assigned to the procedure are transferred to the Manual state Manual. TF8400 Version: 1.1.1 105
## Page 106

PLC API Name Type Description Set Req Eq BOOL PID logic and all actuators assigned to the procedure are transferred to the Offline state Offline. Set Req Eq BOOL PID logic and all actuators assigned to the procedure are transferred to the Operator state Operator. Set Req Eq A BOOL PID logic and all actuators assigned to the procedure are transferred to the utomatic state Automatic. 5.3.9.2 FB_MTP_Service Control The function block FB_MTP_Service Control enables the execution of procedures from different sources: internal PLC logic, manual operation (e.g. via OPC UA) or control system (e.g. via OPC UA). Switching requests and value specifications are managed via Service Mode [} 17]. The FB_MTP_Service Control is an abstract function block. This cannot be instantiated, but must be derived (see Syntax section)! The use of MTP engineering and its automatic code generation is recommended for the use of services! Procedures All procedures associated with the service are transferred as ARRAY[*] OF POINTER TO FB_MTP_Procedure at the input Procedures. A service requires at least one procedure. A procedure is selected via the variables Procedure Int, Procedure Op, Procedur Ext depending on the state of the Service Mode [} 17] of the service. The currently preselected procedure ID, which is used when the service is started, is displayed via Procedure Req. If the procedure ID is invalid, a 0 is output here. Procedure Cur shows the procedure currently started. Only one procedure can be executed at a time. Parameter At the input Conf Parameters, all configuration parameters associated with the service are transferred as ARRAY[*] OF POINTER TO FB_MTP_Parameter Element. 106 Version: 1.1.1 TF8400
## Page 107

PLC API At the input Proc Parameter, all procedure parameters associated with the service are transferred as ARRAY[*] OF POINTER TO FB_MTP_Parameter Element. The service-wide transfer of new values for the parameters follows the same principle as described in the sub-chapters of Parameter Elements [} 87]. The values of all parameters assigned to the service are applied at once. The values to be applied can be checked in advance using the variable VReq of the parameters. The application is enabled via the variable Proc Parameter Apply En for procedure parameters or via the variable Config Parameter Apply En for configuration parameters. A service-wide enable is only possible if all procedure parameters or configuration parameters are enabled Apply En = TRUE. Depending on the state of Service Mode, the values are applied service-wide via the variables Proc Parameter Apply Int, Proc Parameter Apply Op or Proc Parameter Apply Ext for procedure parameters or via the variables Config Parameter Apply Int, Config Parameter Apply Op or Config Parameter Apply Ext for the configuration parameters if Apply = TRUE is set. Report values All report values associated with the service are applied at the input Report Values as ARRAY[*] OF POINTER TO FB_MTP_Report Value. All report values V of the service can be frozen via the input Report Value Freeze. If the value of the input value VIn changes more than once during this time, this is displayed at the output Missed Value = TRUE of the parameter. The figure below shows an overview of the arrays to be applied: If no Conf Parameter, Proc Parameter or Required Equipment are required, apply an empty array. Service state machine The service state machine has 16 states on five levels. The states are divided into transient and non- transient states. The transient states are reached via control commands of the control word. Non-transient states are reached after the transient states (SC) have been successfully processed. One exception is the state Execute. This can be both transient and non-transient. This is defined via the variable Is Self Completing in the procedure [} 103]. The service state machine is structured according to the scheme below: TF8400 Version: 1.1.1 107
## Page 108

PLC API The service state machine can be viewed in different loops: Main loop The main loop for executing the main process function(s) of the machine contains the following states: Idle→Starting→Execute→Completing→Completed→Resetting→Idle The following loops can also be considered: Pause loop The pause loop can only be started from the state Execute. It is terminated by the command Resume or by a command that leads to a higher-level state. Sample: Execute→Pausing→Paused→Resuming→Execute Hold loop The hold loop can be started from the states from level 2 or lower. It is terminated by the command Unhold or by a command that leads to a higher-level state. Sample: Execute→Holding→Held→Unholding→Execute In the MTP guideline, the hold loop is used for the implementation of the logic to be executed in the event of an error. Stop loop The stop loop can be started from the states from level 3 or lower. It is terminated with the command Reset or Abort. Execute→Stopping→Stopped→Resetting→Idle 108 Version: 1.1.1 TF8400
## Page 109

PLC API In the MTP guideline, the stop loop is used for the implementation of the logic to stop the service. Abort loop The abort loop can be started from the states from level 4 or lower. It is terminated with the command Reset. Execute→Aborting→Aborted→Resetting→Idle In the MTP guideline, the abort loop is used for the implementation of the logic to stop the service quickly. Control of the service state machine The variable Command En enables the individual control commands of the control word. The variables Command Int, Command Op and Command Ext can be used to specify the control word (see ) for the service state machine depending on the state of the Service Mode [} 17]. All states can be transferred to a higher level state with a control command, provided this is enabled: e.g. all states of levels 1 and 2 can be transferred to the state Holding with the command Hold. Execution of procedures If the command Start is issued, the selected procedure is transferred to the state Starting. All other procedures assigned to the service are blocked. The states, with the exception of Idle, are executed in the methods of the selected procedure with the same name. When executing transient states, the state transition (SC) occurs when the respective method returns TRUE. After successful execution, they enter their subsequent state. Another procedure can only be selected and started once the service state machine is back in the state Idle. The current state of the service state machine is displayed via the variable State Cur (see ). Dependencies with Service Mode If the Service Mode is transferred from the Offline state to one of the other two states Operator or Automatic*, the service state machine is always in the Idle state. It is only possible to return the Service Mode to the Offline state if the service state machine is in the basic state Idle. Switching between Operator and Automatic* is possible regardless of the state of the service state machine and does not change its current state. Position description A text list can be created to describe the current state of the service in more detail. This can be used to describe the individual work steps in more detail. The variable Pos Text ID can be used to refer to the individual work steps in the text list. The use of MTP engineering and its MTP export is recommended for the position description, as the text list is not made available via OPC UA, but is described in the MTP file! Service operator interaction Interaction between the service and the operator can take place during runtime. Text lists with questions and corresponding answers are created for this purpose. The service uses the variable Question ID to refer to a question in the text list. You will be shown possible answers to the question. When a response is selected, it is written to the service via the variable Interact Question ID. The variable Additional Info makes it possible to provide further information in text form. TF8400 Version: 1.1.1 109
## Page 110

PLC API The use of MTP engineering and its MTP export is recommended for service operator interaction, as the text lists are not made available via OPC UA, but are described in the MTP file! In the sample below, the procedures, configuration parameters and report values are declared in the declaration part of a derivation of FB_MTP_Service Control and summarized in arrays. These are then called up in the body of the FB_MTP_Service Control. This means that all service-relevant procedures, parameters and report values are combined in one place. Only one procedure can be executed at a time. A procedure can only be started if the service is in the Idle state. Syntax FUNCTION_BLOCK FB_MTP_Service EXTENDS FB_MTP_Service Control VAR ///Procedures – Parameters and Required Equipment ///Procedure 1 <Proc Parameters Array1> : ARRAY[0..<n>] OF POINTER TO FB_MTP_Parameter Element := [ADR(<Proc Param_0>), ADR(<Proc Param_1>)]; <Required Equipment Array1> : ARRAY[0..<n>] OF I_MTP_Req Eq := [ADR(<Req Eq_0>), ADR(<Req Eq_1>)]; ///Procedure 2 <Proc Parameters Array2> : ARRAY[0..<n>] OF POINTER TO FB_MTP_Parameter Element := [ADR(<Proc Para m_1>), ADR(<Proc Param_2>)]; <Required Equipment Array2> : ARRAY[0..<n>] OF I_MTP_Req Eq := [ADR(<Req Eq_0>), ADR(<Req Eq_1>)]; ///Procedures Procedure Array : ARRAY[1..<n>] OF POINTER TO FB_MTP_Procedure := [ADR(<Procedure_1>), ADR(<Procedure_1>)]; ///Configuration Parameters Conf Parameter Array : ARRAY[0..<n>] OF POINTER TO FB_MTP_Parameter Element := [ADR(<Conf Parame ter_0>)] ///Procedure Parameters Proc Parameter Array : ARRAY[0..<z>] OF POINTER TO FB_MTP_Parameter Element := [ADR(<Proc Parame ter_0>), ADR(<Proc Parameter_1>), ADR(<Proc Parameter_2>)]; ///Report Values Report Value Array : ARRAY[0..<n>] OF POINTER TO FB_MTP_Report Value [ADR(<Report Value_0>)] END_VAR VAR_INPUT ///Procedures <Procedure_1> : FB_Procedure := (<initial values>); <Procedure_2> : FB_Procedure := (<initial values>); ///Configuration Parameters < Conf Parameter_0> : FB_MTP_Ana Serv Param := (<initial values>); ///Procedure Parameters (<Proc Parameter_0> : FB_MTP_Ana Serv Param := (<initial values>); (<Proc Parameter_1> : FB_MTP_Ana Serv Param := (<initial values>); (<Proc Parameter_2> : FB_MTP_Ana Serv Param := (<initial values>); ///Report Values (<Report Value_0>: FB_MTP_Ana Report Value := ((<initial values>); END_VAR <Procedure_1>( Proc Parameters := <Proc Parameters Array_1>, Required Equipment := <Required Equipment Array_1>); <Procedure_2>( Proc Parameters := <Proc Parameters Array_2>, Required Equipment := <Required Equipment Array_2>); SUPER^( Procedures := Procedure Array, Conf Parameters := Conf Parameter Array, Proc Parameters := Proc Parameter Array, Report Values := Report Value Array); 110 Version: 1.1.1 TF8400
## Page 111

PLC API Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] OSLevel [} 18] Service Mode [} 17] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read OSLevel BYTE Level must be defined for system. Value 0 is reserved for Read/write local operation. Procedures ARRAY [*] Array with all procedures belonging to the service - OF POIN TER TO F B_MTP_P rocedure Conf Parameters ARRAY [*] Array with all configuration parameters belonging to the - OF POIN service TER TO F B_MTP_P arameter E lement Proc Parameters ARRAY [*] Array with all procedure parameters belonging to the - OF POIN service TER TO F B_MTP_P arameter E lement Report Va Iues ARRAY [*] Array with all Report Values belonging to the service - OF POIN TER TO F B_MTP_R eport Valu e Commandlnt DWORD Internal control word (relevant if State Aut Act = Read TRUE and Src Int Act = TRUE) Procedurelnt DWORD Internal procedure preselection (relevant if Read State Aut Act = TRUE and Src Int Act = TRUE) Command En DWORD Enabling control commands of the control word Read State* See Service Mode [} 17] Src* Pos Text ID DWORD ID variable for the position text Read Interact Question I DWORD ID variable for the question text Read D Interact Add Info STRING Additional information on the current Interact Question ID Read Proc Param App Iy I BOOL Apply all Internal process parameter values VInt Read nt belonging to the service. (Relevant, if State Aut Act = TRUE and Src Int Act = TRUE) TF8400 Version: 1.1.1 111
## Page 112

PLC API Name Type Description OPC UA access Config Param App I BOOL Apply all Internal configuration parameter values Read y Int VInt belonging to the service. (Relevant, if State Aut Act = TRUE and Src Int Act = TRUE) Report Va Iue Freez BOOL 1: Freeze all report values of the service Read/write e 0: Do not freeze the report values of the service Outputs Name Type Description OPC UA access State Cur DWORD Current state of the service state machine Read Procedure Cur DWORD Procedure currently used Read Procedure Req DWORD Currently preselected procedure, which is executed at Read start. State* See Service Mode [} 17] Src* Proc Param App Iy BOOL Enable Apply procedure parameters: Read En 1: Parameters can be applied. 0: Parameters cannot be applied. Config Param App I BOOL Enable Apply configuration parameters: Read y En 1: Parameters can be applied. 0: Parameters cannot be applied. External variables Name Type Description OPC UA access State* BOOL See Service Mode [} 17] Src* Command Op DWORD Operator control word (relevant if State Op Act = Read/write TRUE) Command Ext DWORD External control word (relevant if State Aut Act = Read/write TRUE and Src Ext Act = TRUE) Procedur Op DWORD Operator procedure preselection (relevant if Read/write State Op Act = TRUE) Procedure Ext DWORD External procedure preselection (relevant if Read/write State Aut Act = TRUE and Src Ext Act = TRUE) Interact Answer ID DWORD ID variable for the answer text Read/write Proc Param App Iy BOOL Apply all Operator process parameter values VOp Read/write Op belonging to the service. (Relevant if State Op Act = TRUE) Proc Param App Iy BOOL Apply all External process parameter values VExt Read/write Ext belonging to the service. (Relevant, if State Aut Act = TRUE and Src Ext Act = TRUE) Config Param App I BOOL Apply all Operator configuration parameter values VOp Read/write y Op belonging to the service. (Relevant if State Op Act = TRUE) 112 Version: 1.1.1 TF8400
## Page 113

PLC API Name Type Description OPC UA access Config Param App I BOOL Apply all External configuration parameter values VExt Read/write y Ext belonging to the service. (Relevant, if State Aut Act = TRUE and Src Ext Act = TRUE) Methods Name Type Description Idle Non-transient initial state. No process function is executed. Is Actuators I BOOL 1: All actuators assigned to the service are in the state Internal. nternal Is Actuators BOOL 1: All actuators assigned to the service are in the state Manual. Manual Is Actuators BOOL 1: All actuators assigned to the service are in the state Offline. Offline Is Actuators BOOL 1: All actuators assigned to the service are in the state Operator. Operator Is Actuators BOOL 1: All actuators assigned to the service are in the state Automatic. Automatic Is Req Eq Int BOOL 1: PID logic and all actuators assigned to the service are in the state Internal ernal Is Req Eq Ma BOOL 1: PID logic and all actuators assigned to the service are in the state Manual nual Is Req Eq Off BOOL 1: PID logic and all actuators assigned to the service are in the state Offline line Is Req Eq Op BOOL 1: PID logic and all actuators assigned to the service are in the state Operator erator Is Req Eq Au BOOL 1: PID logic and all actuators assigned to the service are in the state tomatic Automatic Set Actuator BOOL All actuators assigned to the service are transferred to the state Internal. s Internal Set Actuator BOOL All actuators assigned to the service are transferred to the state Manual. s Manual Set Actuator BOOL All actuators assigned to the service are transferred to the state Offline. s Offline Set Actuator BOOL All actuators assigned to the service are transferred to the state Operator. s Operator Set Actuator BOOL All actuators assigned to the service are transferred to the state Automatic. s Automatic Set Req Eq I BOOL PID logic and all actuators assigned to the service are transferred to the state nternal Internal. Set Req Eq BOOL PID logic and all actuators assigned to the service are transferred to the state Manual Manual. Set Req Eq BOOL PID logic and all actuators assigned to the service are transferred to the state Offline Offline. Set Req Eq BOOL PID logic and all actuators assigned to the service are transferred to the state Operator Operator. Set Req Eq A BOOL PID logic and all actuators assigned to the service are transferred to the state utomatic Automatic. Set Offline BOOL Transfer the service to the state Offline. Set Operato BOOL Transfer the service to the state Operator. r Set Automat BOOL Transfer the service to the state Automatic Intern. ic Intern TF8400 Version: 1.1.1 113
## Page 114

PLC API Name Type Description Set Automat BOOL Transfer the service to the state Automatic Extern. ic Extern Set Proc Par BOOL Value specification (input variable of the method Apply En) for input variable am App Iy Apply En of the procedure parameters: En All service parameters assigned to the service (if Sync Only = FALSE) All service parameters assigned to the service with input variable Sync = TRUE (if input variable of the method Sync Only = TRUE) Set Config P BOOL Value specification (input variable method Apply En) for configuration aram App Iy parameters: En All service parameters assigned to the service (if Sync Only = FALSE) All service parameters assigned to the service with input variable Sync = TRUE (if input variable of the method Sync Only = TRUE) To Online BOOL Implementation of logic when leaving the Offline state. To Offline BOOL Implementation of logic when entering the Offline state. 5.3.10 Report Values Report values are assigned to a service. To update the report values, new values must be transferred to the function block and the function block must be called manually. 5.3.10.1 FB_MTP_Ana Report Value The function block FB_MTP_Ana Report Value provides an analog input value VIn of a manual operation (e.g. via OPC UA) for the documentation (output V). This value is assigned to exactly one service. Within this service, it can be assigned to one or more procedures. Freezing the value The value V can be frozen via the higher-level service (see FB_MTP_Service Control [} 106]). If the input value VIn changes more than once during this time, it is signaled at output Missed Value = TRUE. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read 114 Version: 1.1.1 TF8400
## Page 115

PLC API Name Type Description OPC UA access VIn REAL Input value - VScl Min REAL Scale start for value display Read VScl Max REAL Scale end for value display Read VUnit INT Unit of value Read Outputs Name Type Description OPC UA access Missed Value BOOL Change of the input value VIn during the freezing of V: Read 1: The input value VIn has changed at least twice since freezing. 0: The input value VIn has not changed more than once since freezing. V REAL Value that is made available via OPC UA. Read 5.3.10.2 FB_MTP_DInt Report Value The function block FB_MTP_DInt Report Value provides an integer input value VIn of a manual operation (e.g. via OPC UA) for the documentation (output V). This value is assigned to exactly one service. Within this service, it can be assigned to one or more procedures. Freezing the value The value V can be frozen via the higher-level service (see FB_MTP_Service Control [} 106]). If the input value VIn changes more than once during this time, it is signaled at output Missed Value = TRUE. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Value scaling [} 19] Unit [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read VIn DINT Input value - VScl Min DINT Scale start for value display Read VScl Max DINT Scale end for value display Read VUnit INT Unit of value Read TF8400 Version: 1.1.1 115
## Page 116

PLC API Outputs Name Type Description OPC UA access Missed Value BOOL Change of the input value VIn during the freezing of V: Read 1: The input value VIn has changed at least twice since freezing. 0: The input value VIn has not changed more than once since freezing. V DINT Value that is made available via OPC UA. Read 5.3.10.3 FB_MTP_Bin Report Value The function block FB_MTP_Bin Report Value provides a binary input value VIn of a manual operation (e.g. via OPC UA) for the documentation (output V). This value is assigned to exactly one service. Within this service, it can be assigned to one or more procedures. Freezing the value The value V can be frozen via the higher-level service (see FB_MTP_Service Control [} 106]). If the input value VIn changes more than once during this time, it is signaled at output Missed Value = TRUE. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read VIn BOOL Input value - VState0 STRING Text for VIn = FALSE Read VState1 STRING Text for VIn = TRUE Read Outputs Name Type Description OPC UA access Missed Value BOOL Change of the input value VIn during the freezing of V: Read 1: The input value VIn has changed at least twice since freezing. 0: The input value VIn has not changed more than once since freezing. V BOOL Value that is made available via OPC UA. Read 116 Version: 1.1.1 TF8400
## Page 117

PLC API 5.3.10.4 FB_MTP_String Report Value The function block FB_MTP_String Report Value makes the input variable Text In of a manual operation (e.g. via OPC UA) available for documentation (output Text). This value is assigned to exactly one service. Within this service, it can be assigned to one or more procedures. Freezing the value The value Text can be frozen via the higher-level service (see FB_MTP_Service Control [} 106]). If the input value Text In changes more than once during this time, it is signaled at output Missed Value = TRUE. Further characteristics Name of the object [} 18] Object description [} 18] WQC [} 19] Inputs Name Type Description OPC UA access Tag Name STRING Name of the interface - Tag Description STRING Description of the interface - WQC BYTE Worst Quality Code Read Text In STRING Input text - Outputs Name Type Description OPC UA access Missed Value BOOL Change of the input value Text In during the freezing of Read Text: 1: The input value Text In has changed at least twice since freezing. 0: The input value Text In has not changed more than once since freezing. Text STRING Value that is made available via OPC UA. Read 5.4 Data types 5.4.1 ST_MTP_Input Element Config ST_MTP_Input Element Config is a configuration for Input Elements. It contains units with associated value representations and is transferred as an array. When transferring to DInt Process Value In, the variables Scl Min Ext and Scl Max Ext are converted into the data types DInt. Values Name Type Description Unit Ext E_MTP_Unit Unit TF8400 Version: 1.1.1 117
## Page 118

PLC API Name Type Description Scl Min Ext REAL Lower limit of the value representation Scl Max Ext REAL Upper limit of the value representation 118 Version: 1.1.1 TF8400
## Page 119

Support and Service 6 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF8400 Version: 1.1.1 119
## Page 120

Trademark statements Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H.
## Page 121

More Information: www.beckhoff.com/tf8400 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
