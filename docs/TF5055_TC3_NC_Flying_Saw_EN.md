---
title: "TF5055 Twin CAT 3"
product: "TF5055"
category: "Motion_Control"
tags: ["CAT", "NC", "TWIN"]
language: "EN"
document_type: "Manual"
version: "1.5.3"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5055_TC3_NC_Flying_Saw_EN.pdf"
release_date: "2024-04-08"
---
Manual | EN TF5055 Twin CAT 3 | NC Flying Saw 2024-04-08 | Version: 1.5.3
## Page 3

Table of contents Table of contents 1 Foreword.................................................................................................................................................... 5 1.1 Notes on the documentation............................................................................................................. 5 1.2 For your safety.................................................................................................................................. 5 1.3 Notes on information security............................................................................................................ 7 2 Overview.................................................................................................................................................... 8 3 PLC Library Overview............................................................................................................................... 9 4 Flying saw................................................................................................................................................ 10 4.1 MC_Gear In Velo.............................................................................................................................. 10 4.2 MC_Gear In Pos............................................................................................................................... 12 4.3 MC_Read Flying Saw Characteristics................................................................................................ 14 5 Data types................................................................................................................................................ 16 5.1 ST_Sync Mode................................................................................................................................. 16 5.2 E_Gear In Sync Mode........................................................................................................................ 19 5.3 MC_Flying Saw Charac Values......................................................................................................... 19 5.4 ST_Gear In Pos Options.................................................................................................................... 20 5.5 ST_Gear In Velo Options................................................................................................................... 20 6 Sample program...................................................................................................................................... 22 7 Support and Service............................................................................................................................... 23 8 Appendix.................................................................................................................................................. 24 8.1 Error Codes..................................................................................................................................... 24 8.2 Reversal of the master axis movement / backstop......................................................................... 33 8.3 Calculating the synchronisation phase............................................................................................ 36 TF5055 Version: 1.5.3 3
## Page 4

Table of contents 4 Version: 1.5.3 TF5055
## Page 5

Foreword 1 Foreword 1.1 Notes on the documentation This description is intended exclusively for trained specialists in control and automation technology who are familiar with the applicable national standards. For installation and commissioning of the components, it is absolutely necessary to observe the documentation and the following notes and explanations. The qualified personnel is obliged to always use the currently valid documentation. The responsible staff must ensure that the application or use of the products described satisfies all requirements for safety, including all the relevant laws, regulations, guidelines, and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without notice. No claims to modify products that have already been supplied may be made on the basis of the data, diagrams, and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered and licensed trademarks of Beckhoff Automation Gmb H. If third parties make use of designations or trademarks used in this publication for their own purposes, this could infringe upon the rights of the owners of the said designations. Patents The Ether CAT Technology is covered, including but not limited to the following patent applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 and similar applications and registrations in several other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The distribution and reproduction of this document as well as the use and communication of its contents without express authorization are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event that a patent, utility model, or design are registered. 1.2 For your safety Safety regulations Read the following explanations for your safety. Always observe and follow product-specific safety instructions, which you may find at the appropriate places in this document. TF5055 Version: 1.5.3 5
## Page 6

Foreword Exclusion of liability All the components are supplied in particular hardware and software configurations which are appropriate for the application. Modifications to hardware or software configurations other than those described in the documentation are not permitted, and nullify the liability of Beckhoff Automation Gmb H & Co. KG. Personnel qualification This description is only intended for trained specialists in control, automation, and drive technology who are familiar with the applicable national standards. Signal words The signal words used in the documentation are classified below. In order to prevent injury and damage to persons and property, read and follow the safety and warning notices. Personal injury warnings DANGER Hazard with high risk of death or serious injury. WARNING Hazard with medium risk of death or serious injury. CAUTION There is a low-risk hazard that could result in medium or minor injury. Warning of damage to property or environment NOTICE The environment, equipment, or data may be damaged. Information on handling the product This information includes, for example: recommendations for action, assistance or further information on the product. 6 Version: 1.5.3 TF5055
## Page 7

Foreword 1.3 Notes on information security The products of Beckhoff Automation Gmb H & Co. KG (Beckhoff), insofar as they can be accessed online, are equipped with security functions that support the secure operation of plants, systems, machines and networks. Despite the security functions, the creation, implementation and constant updating of a holistic security concept for the operation are necessary to protect the respective plant, system, machine and networks against cyber threats. The products sold by Beckhoff are only part of the overall security concept. The customer is responsible for preventing unauthorized access by third parties to its equipment, systems, machines and networks. The latter should be connected to the corporate network or the Internet only if appropriate protective measures have been set up. In addition, the recommendations from Beckhoff regarding appropriate protective measures should be observed. Further information regarding information security and industrial security can be found in our https://www.beckhoff.com/secguide. Beckhoff products and solutions undergo continuous further development. This also applies to security functions. In light of this continuous further development, Beckhoff expressly recommends that the products are kept up to date at all times and that updates are installed for the products once they have been made available. Using outdated or unsupported product versions can increase the risk of cyber threats. To stay informed about information security for Beckhoff products, subscribe to the RSS feed at https:// www.beckhoff.com/secinfo. TF5055 Version: 1.5.3 7
## Page 8

Overview 2 Overview In many plants workpieces undergo machining operations while being transported. For this purpose it is necessary to synchronise the position and the speed of tool and workpiece, so that the tool can then be applied as if to a stationary workpiece. One example of such an application is a saw that during the transport process cuts through the material that is being transported (flying saw). In order to implement this kind of application, Twin CAT provides the flying saw. The Twin CAT PLC library Tc2_MC2_Flying Saw, available as an additional product, provides easy management of the flying saw. An example program using the flying saw makes use of this library. 8 Version: 1.5.3 TF5055
## Page 9

PLC Library Overview 3 PLC Library Overview Below there is an overview of the TF5055 TC3 MC Flying Saw PLC Library. Flying Saw Function Block Description MC_Gear In Velo [} 10] Activates a linear master-slave coupling. MC_Gear In Pos [} 12] Synchronizes a slave axis precisely with a master axis (flying saw). MC_Read Flying Saw Characteristics [} 14] Allows the characteristic figures for the synchronization phase of the Universal Flying Saw to be read. Data Types Data Type Description ST_Sync Mode [} 16] Operation of the individual bits. MC_Flying Saw Charac Values [} 19] Type definition for the characteristic parameters of a flying saw synchronization. TF5055 Version: 1.5.3 9
## Page 10

Flying saw 4 Flying saw 4.1 MC_Gear In Velo MC_Gear In Velo Execute BOOL BOOL Start Sync Ratio Numerator LREAL BOOL In Sync Ratio Denominator UINT BOOL Busy Sync Mode ST_Sync Mode BOOL Active Velocity LREAL BOOL Command Aborted Acceleration LREAL BOOL Error Deceleration LREAL UDINT Error ID Jerk LREAL Buffer Mode MC_Buffer Mode Options ST_Gear In Velo Options ↔ Master Reference To AXIS_REF ↔ Slave Reference To AXIS_REF The function block MC_Gear In Velo activates a linear master-slave coupling (gear coupling). If the master axis is already moving, the slave axis synchronizes to the master velocity. The function block accepts a fixed gear ratio in numerator/denominator format. The slave axis can be uncoupled with the function block MC_Gear Out. If the slave is decoupled while it is moving, then it retains its velocity and can be halted using MC_Stop or MC_Halt. Inputs VAR_INPUT Execute : BOOL; Ratio Numerator : LREAL; Ratio Denominator : UINT; Sync Mode : ST_Sync Mode; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Gear In Velo Options; END_VAR Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Ratio Numerator LREAL Gear ratio numerator. Alternatively, the gear ratio can be specified in the enumerator as a floating point value, if the denominator is 1. Ratio Denominator UINT Gear ratio denominator Sync Mode ST_Sync Mode In the data structure Sync Mode [} 16] boundary conditions for the synchronization process are specified via individual flags. Velocity LREAL Maximum slave velocity in the synchronization phase. If no velocity is specified, the default velocity of the axis from the System Manager data is used. Info: the velocity specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Acceleration LREAL Maximum slave acceleration in the synchronization phase. If no acceleration is specified, the default acceleration of the axis from the System Manager data is 10 Version: 1.5.3 TF5055
## Page 11

Flying saw Name Type Description used. Info: the acceleration specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Deceleration LREAL Maximum slave deceleration in the synchronization phase. If no deceleration is specified, the default deceleration of the axis from the System Manager data is used. Info: the deceleration specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Jerk LREAL Maximum slave jerk in the synchronization phase. If no jerk is specified, the default jerk of the axis from the System Manager data is used. Info: the jerk specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Buffer Mode MC_Buffer Mode Currently not implemented Options ST_Gear In Velo Options The ST_Gear In Velo Options [} 20] contains two position values as limits. The check for these position limits can be activated. To do this, two flags (Gear In Sync_Check Mask_Optional Min Pos, Gear In Sync_Check Mask_Optional Max Pos) have to be set in the Sync Mode [} 16] structure. The Ratio Numerator must be 1 and the Ratio Denominator must be 4 for a 1:4 ratio. Alternatively, the Ratio Denominator may be 1, and the gear ratio can be specified as floating point number 0.25 at Ratio Numerator. The Ratio Numerator may be negative. Inputs/outputs The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR Name Type Description Master AXIS_REF Axis data structure of the master Slave AXIS_REF Axis data structure of the slave Outputs VAR_OUTPUT Start Sync : BOOL; In Sync : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Start Sync BOOL Becomes TRUE when the synchronization with the master axis was started. In Sync BOOL Becomes TRUE, if the coupling was successfully completed and the slave axis is synchronized with the master axis. TF5055 Version: 1.5.3 11
## Page 12

Flying saw Name Type Description Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, In Sync, Command Aborted or Error, is set. Active BOOL Active indicates that the command is executed. (currently Active=Busy, see Buffer Mode) Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 4.2 MC_Gear In Pos MC_Gear In Pos Execute BOOL BOOL Start Sync Ratio Numerator LREAL BOOL In Sync Ratio Denominator UINT BOOL Busy Master Sync Position LREAL BOOL Active Slave Sync Position LREAL BOOL Command Aborted Sync Mode ST_Sync Mode BOOL Error Master Start Distance LREAL UDINT Error ID Velocity LREAL Acceleration LREAL Deceleration LREAL Jerk LREAL Buffer Mode MC_Buffer Mode Options ST_Gear In Pos Options ↔ Master Reference To AXIS_REF ↔ Slave Reference To AXIS_REF The function block MC_Gear In Pos synchronizes a slave axis precisely with a master axis (flying saw). The synchronous velocity is achieved exactly at the synchronous point of the master and slave. The master axis must already be moving, otherwise synchronization is not possible. The slave axis can be uncoupled with the function block MC_Gear Out. If the slave is decoupled while it is moving, then it retains its velocity and can be halted using MC_Stop or MC_Halt. Inputs VAR_INPUT Execute : BOOL; Ratio Numerator : LREAL; Ratio Denominator : UINT; Master Sync Position : LREAL; Slave Sync Position : LREAL; Sync Mode : ST_Sync Mode; Master Start Distance : LREAL; Velocity : LREAL; Acceleration : LREAL; Deceleration : LREAL; Jerk : LREAL; Buffer Mode : MC_Buffer Mode; Options : ST_Gear In Pos Options; END_VAR 12 Version: 1.5.3 TF5055
## Page 13

Flying saw Name Type Description Execute BOOL The command is executed with a rising edge at Execute input. Ratio Numerator LREAL Gear ratio numerator. Alternatively, the gear ratio can be specified in the enumerator as a floating point value, if the denominator is 1. Ratio Denominator UINT Gear ratio denominator Master Sync Position LREAL The master's synchronous position Slave Sync Position LREAL The slave's synchronous position Sync Mode ST_Sync Mode In the data structure Sync Mode [} 16] boundary conditions for the synchronization process are specified via individual flags. Master Start Distance LREAL Currently not implemented. Velocity LREAL Maximum slave velocity in the synchronization phase. If no velocity is specified, the default velocity of the axis from the System Manager data is used. Info: the velocity specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Acceleration LREAL Maximum slave acceleration in the synchronization phase. If no acceleration is specified, the default acceleration of the axis from the System Manager data is used. Info: the acceleration specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Deceleration LREAL Maximum slave deceleration in the synchronization phase. If no deceleration is specified, the default deceleration of the axis from the System Manager data is used. Info: the deceleration specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Jerk LREAL Maximum slave jerk in the synchronization phase. If no jerk is specified, the default jerk of the axis from the System Manager data is used. Info: the jerk specified here is only checked if this check is activated through the Sync Mode [} 16] variable. Buffer Mode MC_Buffer Mode Currently not implemented Options ST_Gear In Pos Options The ST_Gear In Pos Options [} 20] contains two position values as limits. The check for these position limits can be activated. To do this, two flags (Gear In Sync_Check Mask_Optional Min Pos, Gear In Sync_Check Mask_Optional Max Pos) have to be set in the Sync Mode [} 16] structure. The Ratio Numerator must be 1 and the Ratio Denominator must be 4 for a 1:4 ratio. Alternatively, the Ratio Denominator may be 1, and the gear ratio can be specified as floating point number 0.25 at Ratio Numerator. The Ratio Numerator may be negative. Inputs/outputs The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters, it contains the current axis status, including position, velocity or error state. VAR_IN_OUT Master : AXIS_REF; Slave : AXIS_REF; END_VAR TF5055 Version: 1.5.3 13
## Page 14

Flying saw Name Type Description Master AXIS_REF Axis data structure of the master Slave AXIS_REF Axis data structure of the slave Outputs VAR_OUTPUT Start Sync : BOOL; In Sync : BOOL; Busy : BOOL; Active : BOOL; Command Aborted : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Start Sync BOOL Becomes TRUE when the synchronization with the master axis was started. In Sync BOOL Becomes TRUE, if the coupling was successfully completed and the slave axis is synchronized with the master axis. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE for as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, In Sync, Command Aborted or Error, is set. Active BOOL Active indicates that the command is executed. (currently Active=Busy, see Buffer Mode) Command Aborted BOOL Becomes TRUE, if the command could not be fully executed. The axis may have become decoupled during the coupling process (simultaneous command execution). Error BOOL Becomes TRUE as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. 4.3 MC_Read Flying Saw Characteristics MC_Read Flying Saw Characteristics Execute BOOL BOOL Done ↔ Slave Reference To AXIS_REF BOOL Busy ↔ Cam Table Charac Reference To MC_Flying Saw Charac Values BOOL Error UDINT Error ID The function block MC_Read Flying Saw Characteristics allows the characteristic values for the synchronization phase of the Universal Flying Saw to be read. Inputs VAR_INPUT Execute : BOOL; END_VAR Name Type Description Execute BOOL A rising edge initiates reading the characteristic values from the Twin CAT NC. 14 Version: 1.5.3 TF5055
## Page 15

Flying saw The data calculated is not available until the Universal Flying Saw starts. Inputs/outputs The axis data structure of type AXIS_REF addresses an axis unambiguously within the system. Among other parameters it contains the current axis status, including position, velocity or error state. VAR_IN_OUT Slave : AXIS_REF; Cam Table Charac : MC_Flying Saw Charac Values; END_VAR Name Type Description Slave AXIS_REF Axis data structure of the slave Cam Table Charac MC_Flying Saw Charac Values Structure containing the characteristic values. [} 19] Outputs VAR_OUTPUT Done : BOOL; Busy : BOOL; Error : BOOL; Error ID : UDINT; END_VAR Name Type Description Done BOOL Is set to TRUE when the data set has been successfully read. Busy BOOL The Busy output becomes TRUE when the command is started with Execute and remains TRUE as long as the command is processed. If Busy becomes FALSE again, the function block is ready for a new order. At the same time one of the outputs, Done or Error, is set. Error BOOL Becomes TRUE, as soon as an error occurs. Error ID UDINT If the error output is set, this parameter supplies the error number. TF5055 Version: 1.5.3 15
## Page 16

Data types 5 Data types 5.1 ST_Sync Mode TYPE ST_Sync Mode : STRUCT (* mode *) Gear In Sync Mode : E_Gear In Sync Mode; (* 32 bit check mask ... *) Gear In Sync_Check Mask_Min Pos : BOOL; Gear In Sync_Check Mask_Max Pos : BOOL; Gear In Sync_Check Mask_Max Velo : BOOL; Gear In Sync_Check Mask_Max Acc : BOOL; Gear In Sync_Check Mask_Max Dec : BOOL; Gear In Sync_Check Mask_Max Jerk : BOOL; Gear In Sync_Check Mask_Optional Min Pos : BOOL; Gear In Sync_Check Mask_Optional Max Pos : BOOL; Gear In Sync_Check Mask_Overshoot Pos : BOOL; Gear In Sync_Check Mask_Undershoot Pos : BOOL; Gear In Sync_Check Mask_Overshoot Velo : BOOL; Gear In Sync_Check Mask_Undershoot Velo : BOOL; Gear In Sync_Check Mask_Overshoot Velo Zero : BOOL; Gear In Sync_Check Mask_Undershoot Velo Zero : BOOL; (* operation masks ... *) Gear In Sync_Op Mask_Rollback Lock : BOOL; Gear In Sync_Op Mask_Instant Stop On Rollback : BOOL; Gear In Sync_Op Mask_Prefer Const Velo : BOOL; Gear In Sync_Op Mask_Ignore Master Acc : BOOL; Gear In Sync_Op Mask_Ignore Slave Acc : BOOL; Gear In Sync_Op Mask_Detailed Error Codes : BOOL; END_STRUCT END_TYPE Parameterisable boundary conditions, specifying the mode of operation It is possible to specify a wide variety of boundary conditions for the slave movement in the synchronization phase of the Universal Flying Saw. These boundary conditions make it possible to specify limit values for the slave magnitudes listed in the table below. The Sync Mode bit mask can be used to check whether the individual limit values are being observed. The boundary conditions specified for the synchronization phase also affect the set value profile for the synchronization. Whether, and in what way, the conditions affect the profile can be seen in the diagram [} 36] in the attachment. Name Description Gear In Sync Mode See E_Gear In Sync Mode [} 19] Bit masks for the Sync Mode Name Value Value Description Boundary con- (dec) (hex) dition Gear In Sync_Check Mask_Min Pos 1 0x0000 Checks whether the slave axis pos ≥ Slave 0001 has passed below its software pos Slave Min minimum end position (machine data). See also ST_Gear In Pos Options [} 20] Gear In Sync_Check Mask_Max Pos 2 0x0000 Checks whether the software pos ≤ Slave 0002 maximum end position pos Slave Max (machine data) of the slave axis has been exceeded. See also ST_Gear In Pos Options [} 20] 16 Version: 1.5.3 TF5055
## Page 17

Data types Name Value Value Description Boundary con- (dec) (hex) dition Gear In Sync_Check Mask_Max Velo 4 0x0000 Checks whether the maximum | v | ≤ v Slave Slave Max 0004 permitted slave velocity (machine data) has been exceeded. See also ST_Gear In Velo Options [} 20] Gear In Sync_Check Mask_Max Acc 8 0x0000 Checks whether the maximum acc ≤ Slave 0008 slave acceleration (machine acc Slave Max data) has been exceeded Gear In Sync_Check Mask_Max Dec 16 0x0000 Checks whether the maximum dec ≤ Slave 0010 slave deceleration (machine dec Slave Max data) has been exceeded Gear In Sync_Check Mask_Max Jerk 32 0x0000 Checks whether the maximum j ≤ j Slave Slave Max 0020 slave jerk (machine data) has been exceeded. Gear In Sync_Check Mask_Optional Mi Check is also carried out to n Pos see if Gear In Sync_Check Mask_Opti onal Min Pos is set to TRUE. See also ST_Gear In Velo Options [} 20] Gear In Sync_Check Mask_Optional M Check is also carried out if ax Pos Gear In Sync_Check Mask_Opti onal Max Pos is set to TRUE. See also ST_Gear In Velo Options [} 20] Gear In Sync_Check Mask_Overshoot 256 0x0000 Checks for overshooting of Pos 0100 slave position. Gear In Sync_Check Mask_Undershoo 512 0x0000 Checks for undershooting of t Pos 0200 slave position.´ Gear In Sync_Check Mask_Overshoot 1024 0x0000 Checks for overshooting of Velo 0400 slave acceleration. Gear In Sync_Check Mask_Undershoo 2048 0x0000 Checks for undershooting of t Velo 0800 slave acceleration. Gear In Sync_Check Mask_Overshoot 4096 0x0000 Checks whether the slave Velo Zero 1000 velocity has exceeded 0.0. Gear In Sync_Check Mask_Undershoo 8192 0x0000 Checks whether the slave t Velo Zero 2000 velocity is below 0.0 Gear In Sync_Opt Mask_Detailed Error Enable detailed error codes Codes for the checks. Bit masks for operation modes Name Value Value Description (dec) (hex) Gear In Sync_Op Mask_Rollback Lock 65536 0x0001 Bit = 0: (default) 0000 When the slave has achieved the synchronous phase, synchronous coupling of all the following master movements is maintained until the coupling is removed. This also applies if the master changes direction and moves backwards over the coupling position, see Reversal of the master axis movement / backstop [} 33]. Bit = 1: TF5055 Version: 1.5.3 17
## Page 18

Data types Name Value Value Description (dec) (hex) Setting this bit activates the backstop, which causes the slave to stop when the master moves backwards beyond the coupling position after a motion reversal, see reversal of the master axis movement / backstop. Gear In Sync_Op Mask_Instant Stop On 131072 0x0002 Bit = 0: (default) Rollback 0000 On reaching the coupling position, the slave velocity is reduced smoothly following a 5th order polynomial. The polynomial is optimized to halt the slave as quickly as possible, see reversal of the master axis movement / backstop. Bit = 1: In terms of the set value, the slave is halted within one NC tick of reaching the coupling position. The slave velocity is set to 0.0 and the position is maintained. This abrupt stop can trigger the following error monitoring system! See reversal of the master axis movement / backstop Gear In Sync_Op Mask_Prefer Const V 1048576 0x0010 Bit = 0: (default) elo 0000 Default setting Bit = 1: The system will try to use a phase with constant velocity, instead of just one 5th order polynomial. This can result in a combination of a 5th-order polynomial, a synchronous phase and another 5th-order polynomial (P5-P1-P5), see reversal of the master axis movement / backstop. The maximum given acceleration and deceleration is used. To control and limit the jerk it is recommended to set MAXJERK in the bit mask. Gear In Sync_Op Mask_Ignore Slave A 2097152 0x0020 Bit = 0: (default) cc 0000 Default setting Bit = 1: When calculating the coupling, the acceleration of the master is ignored, i.e. set to zero. This causes the use of internal optimizations. At moderate acceleration, this specification leads to tolerable following errors. After the following error has been reduced, the relative position accuracy is independent of this setting. The checks listed above apply only to the synchronization phase (GEARINSYNCSTATE_SYNCHRONIZING), not to the phase of synchronized movement. These calculations and checks are also only possible when the assumption is made that the master continues to move with constant velocity after the coupling time, i.e. that it is not subject to acceleration. Making other assumptions for the master makes no sense, since at the time of coupling it is generally not known how the master will move in the future. See also: • Error Codes [} 24] 18 Version: 1.5.3 TF5055
## Page 19

Data types 5.2 E_Gear In Sync Mode TYPE E_Gear In Sync Mode : ( GEARINSYNCMODE_POSITIONBASED, GEARINSYNCMODE_TIMEBASED ); END_TYPE Parameter Description GEARINSYNCMODE_POSITIONBASED In this mode of the universal flying saw, a profile dependent on the master position is generated to synchronize the slave axis to the master axis. GEARINSYNCMODE_TIMEBASED In this mode of the universal flying saw, a time- dependent motion profile is generated for synchronizing the slave axis to the master axis, which ensures compliance with all dynamic limit values of the slave axis. This mode is currently only available with coupling on velocity. The time-based motion profile (GEARINSYNCMODE_TIMEBASED) is currently only implemented for the function block MC_Gear In Velo. 5.3 MC_Flying Saw Charac Values TYPE MC_Flying Saw Charac Values : STRUCT (* Master Velocity*) f Master Velo Nom : LREAL; (* 1. master nominal velocity (normed:=> 1.0) *) (* characteristic slave data *) (*===========================*) (* Start of cam table *) f Master Pos Start : LREAL; (* 2. master start position*) f Slave Pos Start : LREAL; (* 3. slave start position *) f Slave Velo Start : LREAL; (* 4. slave start velocity *) f Slave Acc Start : LREAL; (* 5. slave start acceleration *) f Slave Jerk Start : LREAL; (* 6. slave start jerk *) (* End of cam table*) f Master Pos End : LREAL; (* 7. master end position *) f Slave Pos End : LREAL; (* 8. slave end position *) f Slave Velo End : LREAL; (* 9. slave end velocity *) f Slave Acc End : LREAL; (* 10. slave end acceleration *) f Slave Jerk End : LREAL; (* 11. slave end jerk *) (* minimum slave position *) f MPos At SPos Min : LREAL; (* 12. master position AT slave minimum position *) f Slave Pos Min : LREAL; (* 13. slave minimum position *) (* minimum Slave velocity *) f MPos At SVelo Min : LREAL; (* 14. master position AT slave minimum velocity *) f Slave Velo Min : LREAL; (* 15. slave minimum velocity *) (* minimum slave acceleration *) f MPos At SAcc Min : LREAL; (* 16. master position AT slave minimum acceleration *) f Slave Acc Min : LREAL; (* 17. slave minimum acceleration *) f SVelo At SAcc Min : LREAL; (* 18. slave velocity AT slave minimum acceleration *) (* minimum slave jerk and dynamic momentum *) f Slave Jerk Min : LREAL; (* 19. slave minimum jerk *) f Slave Dyn Mom Min : LREAL; (* 20. slave minimum dynamic momentum (NOT SUPPORTED YET !) *) (* maximum slave position *) f MPos At SPos Max : LREAL; (* 21. master position AT slave maximum position *) f Slave Pos Max : LREAL; (* 22. slave maximum position *) (* maximum Slave velocity *) f MPos At SVelo Max : LREAL; (* 23. master position AT slave maximum velocity *) TF5055 Version: 1.5.3 19
## Page 20

Data types f Slave Velo Max : LREAL; (* 24. slave maximum velocity *) (* maximum slave acceleration *) f MPos At SAcc Max : LREAL; (* 25. master position AT slave maximum acceleration *) f Slave Acc Max : LREAL; (* 26. slave maximum acceleration *) f SVelo At SAcc Max : LREAL; (* 27. slave velocity AT slave maximum acceleration *) (* maximum Slave slave jerk and dynamic momentum *) f Slave Jerk Max : LREAL; (* 28. slave maximum jerk *) f Slave Dyn Mom Max : LREAL; (* 29. slave maximum dynamic momentum (NOT SUPPORTED YET !) *) (* mean and effective values *) f Slave Velo Mean : LREAL; (* 30. slave mean absolute velocity (NOT SUPPORTED YET !) *) f Slave Acc Eff : LREAL; (* 31. slave effective acceleration (NOT SUPPORTED YET !) *) (* reserved space for future extension *) reserved : ARRAY[32..47] OF LREAL; (* organization structure of the cam table *) Cam Table ID : UDINT; Number Of Rows : UDINT; (* number of cam table entries, e.g. number of points *) Number Of Columns : UDINT; (* number of table columns, typically 1 or 2 *) Table Type : UINT; (* MC_Table Type *) Periodic : BOOL; reserved2 : ARRAY[1..121] OF BYTE; END_STRUCT END_TYPE Type definition for the characteristic parameters of a flying saw synchronization. 5.4 ST_Gear In Pos Options TYPE ST_Gear In Pos Options : STRUCT Position Limit Min: LREAL ; Position Limit Max: LREAL ; END_STRUCT END_TYPE Parameter Description Position Limit Min Check is also carried out to see if Gear In Sync_Check Mask_Optional Min Pos is set to TRUE. Position Limit Max Check is also carried out if Gear In Sync_Check Mask_Optional Max Pos is set to TRUE. See also: • ST_Sync Mode [} 16] 5.5 ST_Gear In Velo Options TYPE ST_Gear In Velo Options : STRUCT Position Limit Min: LREAL ; Position Limit Max: LREAL ; END_STRUCT END_TYPE Parameter Description Position Limit Min Check is also carried out to see if Gear In Sync_Check Mask_Optional Min Pos is set to TRUE. Position Limit Max Check is also carried out if Gear In Sync_Check Mask_Optional Max Pos is set to TRUE. See also: 20 Version: 1.5.3 TF5055
## Page 21

Data types • ST_Sync Mode [} 16] TF5055 Version: 1.5.3 21
## Page 22

Sample program 6 Sample program Documents about this 2 Sample Flying Saw.zip (Resources/zip/9007201828535435.zip) 22 Version: 1.5.3 TF5055
## Page 23

Support and Service 7 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5055 Version: 1.5.3 23
## Page 24

Appendix 8 Appendix 8.1 Error Codes If you have set Gear In Pos. Sync Mode. Gear In Sync_Op Mask_Detailed Error Codes := TRUE, the flying saw checks return the detailed messages described below. Otherwise the error number 42DF is output in all checking cases. Checks for position limits Error (hex) Error (Dec) Description 4372 17266 The synchronization profile would violate the lower end position of the slave. Check when Gear In Sync_Check Mask_Min Pos is active. 4373 17267 The synchronization profile would violate the upper end position of the slave. Check when Gear In Sync_Check Mask_Max Pos is active. 4374 17268 The synchronization profile would violate the user limit position Options. Position Limit Min. 24 Version: 1.5.3 TF5055
## Page 25

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Optional Min Pos is active. 4375 17269 The synchronization profile would violate the user limit position Options. Position Limit Max. Check when Gear In Sync_Check Mask_Optional Max Pos is active. Checks for position overshoots/undershoots Error (hex) Error (Dec) Description 4376 17270 The synchronization point lies under the starting point. As a result, the profile swings under both the start position and the synchronous position. Check when Gear In Sync_Check Mask_Undershoot Pos is active. 4377 17271 The synchronization profile would swing back under the slave start position of the flying saw. TF5055 Version: 1.5.3 25
## Page 26

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Undershoot Pos is active. 4378 17272 The synchronization point lies under the starting point. The synchronization profile would swing beyond the slave start position of the flying saw. Check when Gear In Sync_Check Mask_Overshoot Pos is active. 4379 17273 The synchronization profile would swing beyond the slave synchronous position of the flying saw. Check when Gear In Sync_Check Mask_Overshoot Pos is active. Checks for maximum velocity Error (hex) Error (Dec) Description 437A 17274 The maximum velocity of the synchronization profile is higher than the maximum velocity of the slave axis. 26 Version: 1.5.3 TF5055
## Page 27

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Max Velo is active. 437B 17275 The maximum velocity of the synchronization profile is higher than the maximum velocity of the slave axis. Check when Gear In Sync_Check Mask_Max Velo is active. Checks for velocity overshoots Error (hex) Error (Dec) Description 437C 17276 The maximum velocity of the synchronization profile would be higher than the synchronous velocity. (Positive direction of travel and starting velocity lower than synchronous velocity) TF5055 Version: 1.5.3 27
## Page 28

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Overshoot Velo is active. 437D 17277 The maximum velocity of the synchronization profile would be higher than the starting velocity and synchronous velocity. (Positive direction of travel and starting velocity higher than synchronous velocity) Check when Gear In Sync_Check Mask_Overshoot Velo is active. 437E 17278 The maximum velocity of the synchronization profile would be higher than the synchronous velocity. (Negative direction of travel and starting velocity lower than synchronous velocity) 28 Version: 1.5.3 TF5055
## Page 29

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Overshoot Velo is active 437F 17279 The maximum velocity of the synchronization profile would be higher than the starting velocity and synchronous velocity. (Negative direction of travel and starting velocity higher than synchronous velocity) Check when Gear In Sync_Check Mask_Overshoot Velo is active. Checks for velocity undershoots Error (hex) Error (Dec) Description 4380 17280 The minimum velocity of the synchronization profile lies below the synchronous velocity. (Positive direction of travel and starting velocity higher than synchronous velocity) Check when Gear In Sync_Check Mask_Undershoot Velo is active. 4381 17281 The minimum velocity of the synchronization profile lies below the starting velocity. (Positive direction of travel and starting velocity lower than synchronous velocity) TF5055 Version: 1.5.3 29
## Page 30

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Undershoot Velo is active. 4382 17282 The minimum velocity of the synchronization profile lies below the synchronous velocity. (Negative direction of travel and starting velocity higher than synchronous velocity) Check when Gear In Sync_Check Mask_Undershoot Velo is active. 4383 17283 The minimum velocity of the synchronization profile lies below the starting velocity. (Negative direction of travel and starting velocity lower than synchronous velocity) Check when Gear In Sync_Check Mask_Undershoot Velo is active. 30 Version: 1.5.3 TF5055
## Page 31

Appendix Checks for reversal of the direction of travel Error (hex) Error (Dec) Description 4386 17286 The velocity of the flying saw swings below zero; the motion is reversed. If the slave is already moving in the opposite direction at the beginning, it is not regarded as Undershoot Velo Zero. (Master moves in the positive direction) Check when Gear In Sync_Check Mask_Undershoot Velo Zero is active. 4387 17287 The velocity of the flying saw swings below zero; the motion is reversed. If the slave is already moving in the opposite direction at the beginning, it is not regarded as Undershoot Velo Zero. (Master moves in the negative direction) TF5055 Version: 1.5.3 31
## Page 32

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Undershoot Velo Zero is active. Checks for maximum acceleration Error (hex) Error (Dec) Description 4388 17288 The maximum acceleration of the synchronization profile would be higher than the maximum acceleration of the slave axis. Check when Gear In Sync_Check Mask_Max Acc is active. 4389 17289 The maximum deceleration of the synchronization profile would be higher than the maximum deceleration of the slave axis. Check when Gear In Sync_Check Mask_Max Dec is active. Checks for the maximum jerk Error (hex) Error (Dec) Description 438A 17290 The maximum jerk of the synchronization profile would be higher than the maximum jerk of the slave axis. Check when Gear In Sync_Check Mask_Max Jerk is active (check the Slave Jerk Max). 438B 17291 The maximum jerk of the synchronization profile would be higher than the maximum jerk of the slave axis. 32 Version: 1.5.3 TF5055
## Page 33

Appendix Error (hex) Error (Dec) Description Check when Gear In Sync_Check Mask_Max Jerk is active (check the Slave Jerk Min). 8.2 Reversal of the master axis movement / backstop The behavior of the Universal Flying Saw in the event of a motion reversal of the master can be defined via 2 bits of the Sync Mode. The GEARINSYNC_OPMASK_ROLLBACKLOCK bit activates the backstop, which immobilizes the slave if the master moves backwards beyond the coupling position (the position where the Universal Flying Saw was started) after a motion reversal. The second bit, GEARINSYNC_OPMASK_INSTANTSTOPONROLLBACK, governs dynamic aspects of how the slave comes to a halt. NOTICE The effect of these two bits must be differentiated according to whether the synchronous phase is reached before the motion reversal, or whether the motion reversal already occurs in the synchronization phase. The following overview explains the effect of the GEARINSYNC_OPMASK_ROLLBACKLOCK and GEARINSYNC_OPMASK_INSTANTSTOPONROLLBACK bits in detail. ROLL INSTANT Synchro- Description BACK STOP nous LOCK ON phase ROLLBACK reached? 0 0 yes Case 1: With the bit combination specified on the left, synchronous coupling is maintained for all master movements once the Universal Flying Saw is in the synchronous phase. In the figure below, a motion reversal of the master axis occurs in the synchronous phase, so that it moves backwards beyond the coupling position. The synchronous coupling is maintained here, so that the slave also moves backwards beyond the coupling position. 0 0 no Case 2: Before reaching the synchronous phase, the motion of the master axis is reversed in the synchronization phase so that it moves backwards beyond the coupling position. Since the synchronous phase has not been TF5055 Version: 1.5.3 33
## Page 34

Appendix ROLL INSTANT Synchro- Description BACK STOP nous LOCK ON phase ROLLBACK reached? reached in this case, the velocity of the slave axis is reduced with a 5th order polynomial when the coupling position is reached and the axis is brought to a standstill. 0 1 no Case 3: As in case 2, except that the velocity of the slave axis is reduced to zero within one tick after reaching the coupling position. The velocity reduction in one tick can trigger the following error monitoring of the axis. 0 1 yes Case 4: Behavior is identical to case 1. 1 0 no Case 5: 34 Version: 1.5.3 TF5055
## Page 35

Appendix ROLL INSTANT Synchro- Description BACK STOP nous LOCK ON phase ROLLBACK reached? Behavior is identical to case 2. 1 0 yes Case 6: The bit combination indicated on the left is used to activate the backstop of the Universal Flying Saw. In the figure below, a motion reversal of the master axis occurs in the synchronous phase, so that it moves backwards beyond the coupling position. With this backward movement of the master axis, the velocity of the slave axis is reduced to zero with a 5th order polynomial as soon as the coupling position is reached. Reverse movement of the slave axis is therefore prevented in that the slave velocity is continuously reduced as soon as the coupling position is reached. 1 1 no Case 7: Behavior is identical to case 3. 1 1 yes Case 8: The bit combination indicated on the left is used to activate the backstop of the Universal Flying Saw. In the figure below, a motion reversal of the master axis occurs in the synchronous phase, so that it moves backwards beyond the coupling position. During this backward movement of the master axis, the velocity of the slave axis is reduced to zero in one tick as soon as the coupling position is reached. Reverse movement of the slave axis is therefore prevented in that the slave velocity is reduced as soon as the coupling position is reached. The velocity reduction in one tick can trigger the following error monitoring of the axis. TF5055 Version: 1.5.3 35
## Page 36

Appendix ROLL INSTANT Synchro- Description BACK STOP nous LOCK ON phase ROLLBACK reached? 8.3 Calculating the synchronisation phase An attempt is made when calculating the synchronisation phase to find an optimum solution while observing the boundary conditions specified by the user. If it is not possible to observe the specified boundary conditions, the coupling is declined and an appropriate error message is issued. Optimizations As can be seen in the flow chart below, the individual bit masks partly influence the internal optimization steps of the profile calculation, since an optimum is searched for depending on predefined rules (see Parameterizable boundary conditions). Essentially, a 5th order polynomial or a combination of a 5th order polynomial with a 1st order polynomial is used. A 5th order polynomial is generally not free from overshoot, but the accelerations are more moderate than when combining a 5th order polynomial with a 1st order polynomial. The combination of the 1st and 5th order polynomials is calculated in such a way that it is always free from overshoot. However, higher accelerations and decelerations occur with it. If, for example, the actual velocity matches the synchronous velocity, but a certain position difference must be compensated. Then the optimum velocity is calculated internally as a function of the maximum acceleration. Result is a 5th power polynomial a 1st order polynomial with the calculated velocity and a 5th power polynomial. At least one of the two 5th power polynomials exploits the maximum acceleration. To avoid extreme jerk values, the jerk check should be switched on. The optimizations shown can only be carried out if both the master and slave axes are free of acceleration at the time of coupling. For accelerated axes, a 5th order polynomial is used for synchronization, which is checked for compliance with the specified boundary conditions, but cannot be optimized. NOTICE If the master axis is an encoder axis (an "external encoder system"), something which as a rule is never mathematically free from acceleration, particular care must be taken to filter the actual acceleration. Alternatively the determination of the actual acceleration can be deselected in the encoder, i.e. set to zero. The NC also has an internal algorithm for this combination (master encoder axis with the Universal Flying Saw as a slave). This algorithm sets master accelerations whose magnitudes are less than (2.0 • scaling factor / cycle time2) to zero at the coupling time. 36 Version: 1.5.3 TF5055
## Page 37

Appendix Optimisation step 1: Aim: "Velocity profile free from undershoot or overshoot" An attempt is first made to calculate a profile that synchronises the velocity without overshoot or undershoot (a combination of a first order polynomial and a 5th order polynomial or vice versa: in abbreviated form, polynomial1+polynomial5 or polynomial5+polynomial1). If the acceleration check is active at this stage, and if one or more of these limit values (acc, dec) is exceeded, then another profile, which in general is not free from overshoot (polynomial5) is calculated. If one of the active limit values (acc, dec) is still exceeded with his profile, then the synchronisation command is finally declined with an error code. Optimisation step 2: Aim: "Limitation to maximum permitted velocity" If the first optimization step is not possible, the second optimization step checks whether the maximum permitted velocity for the slave axis is exceeded by a general standard profile (polynomial5). If this is the case, an attempt is made to generate a profile in which the maximum profile velocity is precisely the maximum velocity permitted to the slave axis (machine data) (polynomial5+polynomial1+polynomial5). It should be noted that this optimization attempt usually results in larger values of acceleration or deceleration. If the acceleration check is active at this stage, and if one or more of these limit values is exceeded, then this second optimization step is rejected, and finally a profile, which is not in general free from overshoot (polynomial5), is calculated. If one of the active limit values (acc, dec) is still exceeded with his profile, then the synchronization command is finally declined with an error code. Optimisation flow diagram: The optimizations carried out internally are illustrated in the following flow diagram. Essentially, the slave set value profile is calculated as a 5th order polynomial. This 5th order polynomial can be combined with a first order polynomial in order to maintain the parameterized boundary conditions. The way in which the individual boundary conditions influence the selection of the polynomials, and therefore the form of the set value profile, can be seen from the flow diagram illustrated below. The label "polynomial n and polynomial m" expresses the fact that polynomial n is first used in the synchronization phase, followed by polynomial m. TF5055 Version: 1.5.3 37
## Page 38

Appendix 38 Version: 1.5.3 TF5055
## Page 40

More Information: www.beckhoff.com/tf5055 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
