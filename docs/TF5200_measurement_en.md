---
title: "TF5200_measurement_en"
product: "TF5200"
category: "Motion_Control"
tags: ["NC"]
language: "EN"
document_type: "Manual"
version: "1.09"
source_pdf: "https://download.beckhoff.com/download/Document/automation/twincat3/TF5200_measurement_en.pdf"
release_date: "2025-06-10"
---
Functional description | EN TF5200 | Twin CAT 3 CNC Measurement 6/10/2025 | Version: 1.09
## Page 3

Notes on the documentation Notes on the documentation This description is only intended for the use of trained specialists in control and automation engineering who are familiar with the applicable national standards. It is essential that the documentation and the following notes and explanations are followed when installing and commissioning the components. It is the duty of the technical personnel to use the documentation published at the respective time of each installation and commissioning. The responsible staff must ensure that the application or use of the products described satisfy all the requirements for safety, including all the relevant laws, regulations, guidelines and standards. Disclaimer The documentation has been prepared with care. The products described are, however, constantly under development. We reserve the right to revise and change the documentation at any time and without prior announcement. No claims for the modification of products that have already been supplied may be made on the basis of the data, diagrams and descriptions in this documentation. Trademarks Beckhoff®, Twin CAT®, Twin CAT/BSD®, TC/BSD®, Ether CAT®, Ether CAT G®, Ether CAT G10®, Ether CAT P®, Safety over Ether CAT®, Twin SAFE®, XFC®, XTS® and XPlanar® are registered trademarks of and licensed by Beckhoff Automation Gmb H. Other designations used in this publication may be trademarks whose use by third parties for their own purposes could violate the rights of the owners. Patent Pending The Ether CAT technology is patent protected, in particular by the following applications and patents: EP1590927, EP1789857, EP1456722, EP2137893, DE102015105702 with corresponding applications or registrations in various other countries. Ether CAT® is registered trademark and patented technology, licensed by Beckhoff Automation Gmb H, Germany Copyright © Beckhoff Automation Gmb H & Co. KG, Germany. The reproduction, distribution and utilisation of this document as well as the communication of its contents to others without express authorisation are prohibited. Offenders will be held liable for the payment of damages. All rights reserved in the event of the grant of a patent, utility model or design. TF5200 | Twin CAT 3 CNC Version: 1.09 3 Measurement
## Page 4

General and safety instructions General and safety instructions Icons used and their meanings This documentation uses the following icons next to the safety instruction and the associated text. Please read the (safety) instructions carefully and comply with them at all times. Icons in explanatory text 1. Indicates an action. ð Indicates an action statement. DANGER Acute danger to life! If you fail to comply with the safety instruction next to this icon, there is immediate danger to human life and health. CAUTION Personal injury and damage to machines! If you fail to comply with the safety instruction next to this icon, it may result in personal injury or damage to machines. NOTICE Restriction or error This icon describes restrictions or warns of errors. Tips and other notes This icon indicates information to assist in general understanding or to provide additional informa- tion. General example Example that clarifies the text. NC programming example Programming example (complete NC program or program sequence) of the described function or NC com- mand. Specific version information Optional or restricted function. The availability of this function depends on the configuration and the scope of the version. 4 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 5

Table of contents Table of contents Notes on the documentation.................................................................................................................... 3 General and safety instructions.............................................................................................................. 4 1 Overview.................................................................................................................................................... 8 2 Description................................................................................................................................................ 9 2.1 Dynamics of measurement run....................................................................................................... 10 3 Basic settings.......................................................................................................................................... 14 4 Measure with one / several axes............................................................................................................ 16 5 Programming........................................................................................................................................... 18 6 Measured value detected in the drive hardware.................................................................................. 27 6.1 SERCOS......................................................................................................................................... 27 6.2 Lightbus........................................................................................................................................... 32 6.3 Terminal drives................................................................................................................................ 33 6.4 CANopen......................................................................................................................................... 34 6.5 PROFIDRIVE.................................................................................................................................. 37 7 Measured value detection in the CNC................................................................................................... 38 7.1 Measuring probe signal via PLC interface...................................................................................... 38 7.2 Probing with switchable probe and measured value detection in the drive..................................... 39 7.3 Measurement run to fixed stop........................................................................................................ 41 7.3.1 Example for SERVOS drive............................................................................................. 44 7.3.2 Example for CANopen drive............................................................................................. 46 7.4 Measure with external measuring hardware................................................................................... 47 7.5 Measuring with Distributed Clocks Timestamp............................................................................... 49 8 Parameter................................................................................................................................................. 51 8.1 Overview......................................................................................................................................... 51 8.2 Description...................................................................................................................................... 53 8.2.1 Channel parameters......................................................................................................... 53 8.2.2 Axis parameters............................................................................................................... 55 8.2.3 PLC parameters............................................................................................................... 61 8.2.4 Old probing signal parameters (up to version V2.11.2019.14)......................................... 62 9 Support and Service............................................................................................................................... 65 Index......................................................................................................................................................... 66 TF5200 | Twin CAT 3 CNC Version: 5 Measurement
## Page 6

Table of contents 6 Version: TF5200 | Twin CAT 3 CNC Measurement
## Page 7

List of figures List of figures Fig. 1 Resulting path of the measurement run....................................................................................... 9 Fig. 2 Resulting axis movements of the independent measurement run............................................... 10 Fig. 3 Active dynamic for measurement run........................................................................................... 10 Fig. 4 Programmed path........................................................................................................................ 16 Fig. 5 Programmed path 2..................................................................................................................... 17 Fig. 6 Measuring with a measuring probe tool of 2mm radius............................................................... 19 Fig. 7 Measurement offset..................................................................................................................... 20 Fig. 8 Measure without offsets............................................................................................................... 22 Fig. 9 Measure with reference point offset............................................................................................. 23 Fig. 10 Measure with CS, offset only....................................................................................................... 24 Fig. 11 Measure with CS, offset and rotation........................................................................................... 26 Fig. 12 Configuration of SERCOS measurement real-time bit no. 1........................................................ 28 Fig. 13 Configuration of SERCOS measurement real-time bit no. 2........................................................ 29 Fig. 14 Configuration of Ident. S-0-0130.................................................................................................. 30 Fig. 15 Real-time bits in the Editor........................................................................................................... 31 Fig. 16 Probe control word with value 1................................................................................................... 31 Fig. 17 Configure digital input 2 as probing input..................................................................................... 32 Fig. 18 Cyclic command/actual value telegram for probing..................................................................... 35 Fig. 19 Signal profile of the radio measuring button................................................................................. 40 Fig. 20 Time sequence of a measurement run with the external measuring interface............................. 48 Fig. 21 Linking the input and Latch Pos2.................................................................................................. 50 TF5200 | Twin CAT 3 CNC Version: 1.09 7 Measurement
## Page 8

Overview 1 Overview Task The Measurement function permits the precise measurement of a workpiece using a measuring probe. Therefore, after the probe is triggered, the current axis position is saved. In special cases, saving axis positions can also be triggered by other events, such as a PLC signal or the detection of a fixed stop. Effectiveness The measuring function is initialised and activated for the axes programmed in the measurement block. Programming • G100 and G310 are used to measure a workpiece. • G101 and G102 include measuring offsets caused by a previous measurement as an additional offset. Parameterisation The axis and channel parameter lists must be parameterised accordingly in order to use the measuring function. The drive type must be included. For more information on this function, see the chapter Parameters [} 51]. Mandatory note on references to other documents For the sake of clarity, links to other documents and parameters are abbreviated, e.g. [PROG] for the Programming Manual or P-AXIS-00001 for an axis parameter. For technical reasons, these links only function in the Online Help (HTML5, CHM) but not in pdf files since pdfs do not support cross-linking. 8 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 9

Description 2 Description Measuring with G100, G310 When measurement is executed using the NC command G100/G310, an axis position is saved (latched) after a measurement event occurs and the measuring travel may then be terminated. By default the current position is latched in the drive hardware; alternatively the state of the measuring probe can be transferred to the CNC over the PLC interface. See [HLI//Control commands of an axis]. The measured results can be queried or included in the calculation in the NC program by means of appropriate variables. The measurement movement may not be smoothed. If polynomial smoothing is selected, it must be deactivated before the measurement block G100. Measuring with independent axes When measurement types 1, 2 or 7 are used, a measurement run can also be executed with independent axes (see [PROG//Independent axes]). The measuring point is latched for each axis involved. An independent measurement run is also possible in parallel to a path motion of a G100 measurement run. Measurement with G100 %Meas_run N10 G00 X0 Y0 Z0 N20 X5 N30 G100 X10 Y10 F500 N40 G01 X7 N50 M30 The figure shows a representation of the resulting path: y 10 Measurement signal 5 7 10 x Fig. 1: Resulting path of the measurement run TF5200 | Twin CAT 3 CNC Version: 1.09 9 Measurement
## Page 10

Description %Independent_measurement_path N10 G0 X0 Y0 N20 X[INDP_SYN G100 G90 POS100 FEED500] \ Y[INDP_SYN G100 G90 POS100 FEED1000] N30 M30 Fig. 2: Resulting axis movements of the independent measurement run 2.1 Dynamics of measurement run For a measurement run with G100 or G310, the dynamic parameters for a rapid traverse block G00 are used by default. However, the effective dynamics (accelerations and ramp times) in a measuring block can be influenced by several channel parameters. The following two tables provide an overview of these parameters and their effectiveness for • linear and • non-linear (jerk-limited) acceleration profile. v 1 1 2 t Fig. 3: Active dynamic for measurement run Overview of parameters used Parameter number Name Overview P-CHAN-00097 [} 53] use_drive_curr_limit Valid deceleration ramp at FEEDHOLD P-CHAN-00214 [} 54] meas_deceleration_mode Active delay with measuring signal P-CHAN-00296 [} 54] meas_use_std_dynamic Active dynamic for measurement run P-AXIS-00001 getriebe[i].slope_profil.a_beschl Acceleration at machining feed (non-linear slope) 10 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 11

Description P-AXIS-00002 getriebe[i].slope_profil.a_brems Deceleration at machining feed (non-linear slope) P-AXIS-00004 getriebe[i].slope_profil.a_grenz Acceleration at rapid movement P-AXIS-00005 getriebe[i].lslope_profil.a_grenz_stufe_ Acceleration step 1 in rapid mode 1 P-AXIS-00006 getriebe[i].lslope_profil.a_grenz_stufe_ Acceleration step 2 in rapid mode 2 P-AXIS-00011 getriebe[i].lslope_profil.a_stufe_1 Acceleration of step 1 (linear slope) P-AXIS-00012 getriebe[i].lslope_profil.a_stufe_2 Acceleration of step 2 (linear slope) P-AXIS-00024 getriebe[i].lslope_profil.a_feedh Deceleration for feedhold (linear slope) P-AXIS-00053 getriebe[i].slope_profil.a_feedh Deceleration at feedhold (non-linear slope) P-AXIS-00280 getriebe[i].lslope_profil.d_grenz_stufe_ Deceleration of step 1 in rapid mode 1 (linear slope) P-AXIS-00281 getriebe[i].lslope_profil.d_grenz_stufe_ Deceleration of step 2 in rapid mode 2 (linear slope) P-AXIS-00282 getriebe[i].lslope_profil.d_stufe_1 Deceleration of step 1 (linear slope) P-AXIS-00283 getriebe[i].lslope_profil.d_stufe_2 Deceleration of step 2 (linear slope) TF5200 | Twin CAT 3 CNC Version: 1.09 11 Measurement
## Page 12

Description Dynamics for measurement travel with non-linear slops Active dynamic for Active delay with Valid deceleration Profile dynamic (1) Deceleration ramp measurement run measuring signal ramp at FEED- (limiting algorithm) (2) (limiting al- HOLD measurement signal gorithm) measure- P-CHAN-00296 P-CHAN-00214 inactive ment signal active [} 54] [} 54] P-CHAN-00097 [} 53] 0 0 0 Acceleration in rapid Acceleration in rapid traverse traverse P-AXIS-00004 P-AXIS-00004 0 0 1 Acceleration in rapid Deceleration at feed- traverse hold P-AXIS-00004 P-AXIS-00053 0 1 X Acceleration in rapid Acceleration in rapid traverse traverse P-AXIS-00004 P-AXIS-00004 1 X X Acceleration at ma- Deceleration at feed- chining hold feedrate P-AXIS-00053 P-AXIS-00001 or delay at machining feedrate P-AXIS-00002 12 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 13

Description Dynamics for measurement travel with non-linear slops Active dynamic for Active delay with Valid deceleration Profile dynamic (1) Deceleration ramp measurement run measuring signal ramp at FEED- measurement signal (2) measurement sig- HOLD inactive nal active P-CHAN-00296 P-CHAN-00214 [} 54] [} 54] P-CHAN-00097 [} 53] 0 0 0 Acceleration in rapid Acceleration in rapid traverse traverse P-AXIS-00005/ P- P-AXIS-00005/ P- AXIS-00006 AXIS-00006 or delay at machining or delay at machining feedrate feedrate P-AXIS-00280/ P- P-AXIS-00280/ P- AXIS-00281 AXIS-00281 0 0 1 Acceleration in rapid Deceleration at feed- traverse hold P-AXIS-00005/ P- P-AXIS-00024 AXIS-00006 or delay at machining feedrate P-AXIS-00280/ P- AXIS-00281 0 1 X Acceleration in rapid Acceleration in rapid traverse traverse P-AXIS-00005/ P- P-AXIS-00004 AXIS-00006 or delay at machining feedrate P-AXIS-00280/ P- AXIS-00281 1 X X Acceleration at ma- Deceleration at feed- chining hold feedrate P-AXIS-00024 P-AXIS-00011/ P- AXIS-00012 or delay at machining feedrate P-AXIS-00282/ P- AXIS-00283 TF5200 | Twin CAT 3 CNC Version: 1.09 13 Measurement
## Page 14

Basic settings 3 Basic settings Channel parameters, setting the default measurement type After controller start-up, the default measurement type is valid; this is specified in the channel parameters via P-CHAN-00057 (measurement type). For example, assign the value 1 in the channel parameter list P-CHAN-00057 (measurement type) to execute a measurement run in an NC channel with several axes where the measurement feedrate is programmed via the F word. The following measurement types are available: Value Meaning 1* Measurement run (G100) with at least one axis, Measurement feed programmable by F word. 2* Measurement run (G100) with precisely one axis. Measurement feed is specified in the axis data list. An error message is output if the probing signal is missing. 3 Measurement run (G100) with at least one axis, Measurement feed programmable by F word, optionally continue motion up to the target point. 4 Measurement run (G100) only with maximum 3 main axes, Measurement feed programmable by F word. 5 Interruptible measurement run (G210) with at least one axis, Skip GOTO Measurement feed programmable by F word. 6 Interruptible measurement run (G310) with at least one SERCOS axis, jump via GOTO Measurement feed programmable by F word. 7* Measurement run (G100) by moving to a fixed stop with at least one axis, Measurement feed programmable by F word. * Measurement run also possible with independent axes. NC program, switching over the measurement type In the NC program, use Syntax: #MEAS MODE [ [<expr>] ] modal At any time to select a new measurement type. When #MEAS MODE is programmed without parameters, the default measurement type specified in the channel parameter list is selected. Axis parameters The following parameters must be assigned in the axis parameters: P-AXIS-00118 Axis can be used as measurement axis. P-AXIS-00086 Measuring probe stroke. Defines the maximum permitted deceleration distance for measurement. P-AXIS-00215 Measurement feedrate for measuring (only with measurement type 2) P-AXIS-00467 Permissible distance to target point if measuring probe was not confirmed. (as of CNC Build V2.11.2010.09, old parameter P-AXIS-00114) 14 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 15

Basic settings P-AXIS-00516 Measuring methods used (as of CNC Build V2.11.2019.15, old parameters P-AXIS-00117, P-AXIS-00116, P- AXIS-00115, P-AXIS-00257, P-AXIS-00269, P-AXIS-00330) P-AXIS-00517 Number of probing input (as of CNC Build V2.11.2019.15, old parameter P-AXIS-00430) P-AXIS-00518 Relevant measuring edge (as of CNC Build V2.11.2019.15, old parameter P-AXIS-00113) Parameterisation example kenngr.messachse 1 kenngr.hub_messtaster 100000 kenngr.vb_messen 10000 kenngr.probing_offset 0 kenngr.measure.signal PLC kenngr.measure.input 1 kenngr.measure.edge POS TF5200 | Twin CAT 3 CNC Version: 1.09 15 Measurement
## Page 16

Measure with one / several axes 4 Measure with one / several axes Enabling axes All axes in which measurement is to take place or which might be moved by a measurement run, must be enabled for this operation in the axis parameter list by P-AXIS-00118 and the probing signal must be looped to all measurement axes. Wait for probing signal of moved and released axes 2.5D mode All axes which are moved and released during the measurement run must send a probing signal (probing position latch). If the axis is not moved by G100, no probing signal is required in this axis. Waiting for the probing signal in 2.5D mode kopf.achs_nr 1 kopf.log_achs_name X kenngr.messachse 1 kopf.achs_nr 2 kopf.log_achs_name Y kenngr.messachse 1 %Measurement run standard N10 G00 X0 Y1 Z0 N20 X5 N30 G100 X10 F500 ;Wait for probing signal from X N40 G01 Y3 N50 G100 Y10 F500 ;Wait for probing signal from Y N60 G01 X10 Y5 N70 G100 X15 Y10 F500 ;Wait for probing signal from X & Y N100 M30 Y 10 measure X&Y 5 measure Y 3 X 0 5 measure 10 15 X Fig. 4: Programmed path Cartesian transformation (#CS) All 3 main axes must be released as measurement axes for measuring while a Cartesian transformation is active. The probing signal must be looped in all measurement axes, irrespective of whether the axis was actually moved or not. Measured values are latched in all Cartesian transformation axes and mapped in corresponding ACS or PCS values. Waiting for the probing signal with Cartesian transformation (#CS) 16 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 17

Measure with one / several axes #Konfiguration kopf.achs_nr 1 kopf.log_achs_name X kenngr.messachse 1 kopf.achs_nr 2 kopf.log_achs_name Y kenngr.messachse 1 kopf.achs_nr 3 kopf.log_achs_name Z kenngr.messachse 1 %Measurement run CS N10 G00 X0 Y1 Z0 N20 #CS ON[0,0,0,0,0,45] N30 G100 X10 F500 ;Wait for probing signal from X & Y & Z N40 #CS OFF N50 #CS ON[0,0,0,0,0,90] N60 G100 X10 F500 ;Wait for probing signal from X & Y & Z N70 #CS OFF N100 M30 Y X'' = 10 10 measure Y X' = 10 measure X&Y 5 X 0 5 10 Fig. 5: Programmed path 2 Kinematic transformation (#TRAFO) All kinematic axes must be released as measurement axes for measuring while a Cartesian transformation is active. The probing signal must be looped in all measurement axes, irrespective of whether the axis was actually moved or not. Measured values are latched in all Cartesian transformation axes and mapped in corresponding ACS or PCS values. TF5200 | Twin CAT 3 CNC Version: 1.09 17 Measurement
## Page 18

Programming 5 Programming Measurement results, V. A. MESS.<axis> V. A. MERF.<axis> V. A. MOFFS.<axis> V. A. MEIN.<axis> When a measurement is executed by the NC command G100/G310, an axis position is stored after a measuring probe is triggered. After the measurement interrupt is triggered, the current position is stored (latched) and the measurement run may then be ended. The positions recorded by the measurement process can be used in the NC program by G101/G102 (calculation of the measurement offset) and special axis-specific variables. Examples: V. A. MESS. X Measured value of axis X in the coordinate system in which the measurement took place, including all offsets. V. A. MERF. X Measurement terminated (TRUE/FALSE). Indicates whether the measurement interrupt is received before the target position is reached. V. A. MOFFS. X Distance between probing position and programmed target position. V. A. MEIN. X The current measurement offset of the X axis including the calculation by G101. This acts as an additive offset of the programmed position: PCS’ = PCS + measurement offset G101 V. G. MEAS_TYPE Value of currently active measuring type [as of V2.11.2022.03] For further information on the measurement function, refer to the program manual [PROG// section Measurement functions]. V. A. MEAS. ACS. VALU As of Build V2.11.2020.07, the axis-specific variables V. A. MEAS. ACS. VALUE and E.<axis> V. A. MEAS. PCS. VALUE supplement the variable V. A. MESS. The additional variables supply the measured value both in the axis coordinate system including all V. A. MEAS. PCS. VALU offsets as well as the measured value in the programming coordinate system. E.<axis> Examples: V. A. MEAS. ACS. VALU Measured value of axis X in the axis coordinate system (ACS). The value contains E. X all offsets. V. A. MEAS. PCS. VALU Measured value of axis X in the program coordinate system (PCS). E. X The value does not contain any offsets. The ball radius of the measuring probe includes the tool radius specification in the calculation of the PCS value (see example below). The inclusion of the ball radius in the calculation is controlled in the channel parameter P-CHAN-00311. 18 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 19

Programming Measuring with a measuring probe tool of 2mm radius %meas_example : ;Measuring probe tool ;with radius 2 mm D1 : G0 X150 Z200 G100 Z20 : M30 Z Programmed Start position path of Radius of measurement probe tip 2 mm 102 (V. A. MEAS. ACS. VALUE) 100 (V. A. MEAS. PCS. VALUE) Workpiece End position O X Fig. 6: Measuring with a measuring probe tool of 2mm radius TF5200 | Twin CAT 3 CNC Version: 1.09 19 Measurement
## Page 20

Programming Include the measurement offset in calculations with G101, G102 In the NC program, use Syntax: G101 <axis_name><fact> { <axis_name><fact> } non-modal may include an offset. The measurement offset is the distance between the recorded probing position and the programmed target position. It is calculated as follows: Measurement offset = measuring point – target point For the programmed coordinates, the measuring offset determined from the measured values is included in the calculation of an additional offset between programmed and absolute coordinates. An error message is output if no measured values were detected beforehand. The numeral after the axis designation represents the inclusion factor. The offset caused by the measurement offset is valid until it is deselected by G102. Syntax: G102 { <axis_name><dummy_expr> } non-modal Fig. 7: Measurement offset If several measurement runs are programmed in sequence, the axis-specific variable V. A. MERF when used considers that the values from the previous measurement are retained for non-pro- grammed axes. 20 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 21

Programming The following relationships apply to the calculation of V. A. MESS.*, V. A. MEAS.* and V. A. MOFFS.* (example for X axis): V. A. Without With Cartesian With kinematic transformation transformation transformation (2.5D) #CS ON #TRAFO ON MESS. X ACS position Conversion of Conversion of ACS position into active ACS position into active (includes all coordinate system (PCS) coordinate system (PCS) offsets) including offsets including offsets MEAS. ACS. VALUE. X ACS position ACS position ACS position (includes all (includes all (includes all offsets) offsets) offsets) MEAS. PCS. VALUE. X ACS position Conversion of Conversion of ACS position into active ACS position into active (without coordinate system (PCS) coordinate system (PCS) offsets) without offsets without offsets MOFFS. X = V. A. MESS. X = V. A. MESS. X = V. A. MESS. X – V. A. PROG. X – V. A. PROG. X – V. A. PROG. X – Zero Shifts – Zero Shifts – Zero Shifts – Tool Offset – Tool Offset TF5200 | Twin CAT 3 CNC Version: 1.09 21 Measurement
## Page 22

Programming Measure in ACS without offsets. The programming examples below assume an ideal measuring probe with a ball radius of 0 mm. Assuming: Measuring probe is triggered at ACS position Z=100. %meas1 N05 #MEAS MODE[1] N10 G01 G90 Z200 F2000 N20 G100 Z20 F2000 N30 #MSG SYN["V. A. MESS. Z=%f", V. A. MESS. Z] -> V. A. MESS. Z = 100.0 N31 #MSG SYN["V. A. MEAS. ACS. VALUE. Z=%f", V. A. MEAS. ACS. VALUE. Z] -> V. A. MEAS. ACS. VALUE. Z = 100.0 N32 #MSG SYN["V. A. MEAS. PCS. VALUE. Z=%f", V. A. MEAS. PCS. VALUE. Z] -> V. A. MEAS. PCS. VALUE. Z = 100.0 N40 #MSG SYN["V. A. MOFFS. Z=%f", V. A. MOFFS. Z] -> V. A. MOFFS. Z = 80.0 N50 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N60 G101 Z1 N70 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 80.0 N80 G01 Z100 F1000 N90 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 180.0 N100 G102 Z1 N110 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N120 G01 Z100 F1000 N130 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 100.0 N140 M30 Z 200 Start position Programmed path of measurement Probe 100 Surface of workpiece (V. A. MESS) 80 Workpiece (V. A. OFFS) 20 End position O X Fig. 8: Measure without offsets 22 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 23

Programming Measure in the ACS with reference point offset Measure with reference point offset, G92Assuming: Measuring probe is triggered at ACS position Z=100. %meas2 N05 #MEAS MODE[1] N10 G92 Z33 N20 G01 G90 Z200 F2000 N30 G100 Z20 F2000 N40 #MSG SYN["V. A. MESS. Z=%f", V. A. MESS. Z] -> V. A. MESS. Z = 100.0 N41 #MSG SYN["V. A. MEAS. ACS. VALUE. Z=%f", V. A. MEAS. ACS. VALUE. Z] -> V. A. MEAS. ACS. VALUE. Z = 100.0 N42 #MSG SYN["V. A. MEAS. PCS. VALUE. Z=%f", V. A. MEAS. PCS. VALUE. Z] -> V. A. MEAS. PCS. VALUE. Z = 67.0 N50 #MSG SYN["V. A. MOFFS. Z=%f", V. A. MOFFS. Z] -> V. A. MOFFS. Z = 47.0 N60 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N70 G101 Z1 N80 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 47.0 N90 G01 Z100 F1000 N100 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 180.0 N110 G102 Z1 N120 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N130 G01 Z100 F1000 N140 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 133.0 N150 M30 Z 233 (200+33) Start position Programmed path of measurement Probe 100 Surface of workpiece (V. A. MESS) 47 (V. A. OFFS) 53 End position (20+33) Workpiece O X Fig. 9: Measure with reference point offset TF5200 | Twin CAT 3 CNC Version: 1.09 23 Measurement
## Page 24

Programming Measure with CS, offset only Measure with machining coordinate system CS, offset. Assuming: Measuring probe is triggered at ACS posi- tion Z=100. %meas3 N05 #MEAS MODE[1] N10 #CS ON[0,0,33,0,0,0] N20 G01 G90 Z200 F2000 N30 G100 Z20 F2000 N40 #MSG SYN["V. A. MESS. Z=%f", V. A. MESS. Z] -> V. A. MESS. Z = 67.0 N41 #MSG SYN["V. A. MEAS. ACS. VALUE. Z=%f", V. A. MEAS. ACS. VALUE. Z] -> V. A. MEAS. ACS. VALUE. Z = 100.0 N42 #MSG SYN["V. A. MEAS. PCS. VALUE. Z=%f", V. A. MEAS. PCS. VALUE. Z] -> V. A. MEAS. PCS. VALUE. Z = 67.0 N50 #MSG SYN["V. A. MOFFS. Z=%f", V. A. MOFFS. Z] -> V. A. MOFFS. Z = 47.0 N60 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N70 G101 Z1 N80 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 47.0 N90 G01 Z100 F1000 N100 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 147.0 N110 G102 Z1 N120 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N130 G01 Z100 F1000 N140 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 100.0 N150 #CS OFF N160 M30 Z, Z CS 200 Start position CS Programmed path of measurement Probe Surface of workpiece 67 CS (V. A. MESS) 47 (V. A. OFFS) 20 End position CS O X CS 33 Workpiece O X Fig. 10: Measure with CS, offset only 24 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 25

Programming Measure with CS, offset and rotation Measure with machining coordinate system CS, offset and rotation. Assuming: Measuring probe is triggered at Z ACS position 55.5mm. %meas4 N05 #MEAS MODE[1] N10 #CS ON[0,0,75,0,15,0] N20 G01 G90 X150 Z100 F2000 N30 G100 Z-10 F1000 N40 #MSG SYN["V. A. MESS. Z=%f", V. A. MESS. Z] -> V. A. MESS. Z = 20.0 N41 #MSG SYN["V. A. MEAS. ACS. VALUE. Z=%f", V. A. MEAS. ACS. VALUE. Z] -> V. A. MEAS. ACS. VALUE. Z = 55.5 N42 #MSG SYN["V. A. MEAS. PCS. VALUE. Z=%f", V. A. MEAS. PCS. VALUE. Z] -> V. A. MEAS. PCS. VALUE. Z = 20.0 N50 #MSG SYN["V. A. MOFFS. Z=%f", V. A. MOFFS. Z] -> V. A. MOFFS. Z = 30.0 N60 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N70 G101 Z1 N80 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 30.0 N90 G01 Z50 F1000 N100 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 80.0 N110 G102 Z1 N120 #MSG SYN["V. A. MEIN. Z=%f", V. A. MEIN. Z] -> V. A. MEIN. Z = 0.0 N130 G01 Z50 F1000 N140 #MSG SYN["V. A. ABS. Z=%f", V. A. ABS. Z] -> V. A. ABS. Z = 50.0 N150 #CS OFF N160 M30 TF5200 | Twin CAT 3 CNC Version: 1.09 25 Measurement
## Page 26

Programming Z Z CS 100 CS Start position p P a r t o h g o ra f mmed (V. A. ME 2 S 0 S C ) S measurement -10 CS O (V. A. 3 O 0 F CS FS) Surface of workpiece Probe 75 X CS Workpiece End position X O Fig. 11: Measure with CS, offset and rotation 26 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 27

Measured value detected in the drive hardware 6 Measured value detected in the drive hardware 6.1 SERCOS Drive parameters The following parameters must be set in the drive in order to use the measurement function: • Real-time control and status bits used • Measuring probe to be used • Measuring probe control parameters • Measured value in the cyclic telegram Refer to the drive documentation for details of the parameters supported by the relevant drive. In addition, a digital input of the drive amplifier may have to be parameterised as a measurement input. For details, refer to the drive amplifier documentation. Real-time bits The two real-time status bits and one real-time control bit are required for the measurement. The real-time status bits transfer the following information from the drive to the NC kernel: • Edge occurred at measurement input (measurement completed) • Measuring probe operated In addition, a real-time control bit is required to activate the edge evaluation of the measurement input in the drive (enable measurement). Assignment of the control and status bits used by the NC kernel is set in the NC kernel by the parameter P- AXIS-00060. In addition, parameters must be set accordingly in the drive amplifier. The table below shows the assignment of P-AXIS-00060 in the NC kernel to the status and control bits used. P-AXIS-00060 Control bits Status bits Measurement measurement Measuring probe Enable done activated 0, no entry Real-time control bit P-AXIS-00106 Real-time status bit 1 2 1 Real-time control bit Real-time status bit Real-time status bit 1 1 2 2 Real-time control bit Real-time status bit Real-time status bit 2 2 1 We recommend setting P-AXIS-00060 either to value 1 or 2. Value 0 is only present for reasons of backwards compatibility and requires additional settings in P-AXIS-00106. Measuring probe control parameters The measuring probe control parameter (S-0-0169) is used to configure which measuring probe and which edge of the probing signal is to be used in the drive. This parameter determines where the positions detected are stored in the various SEROS IDs. The SERCOS IDs must then be transferred in the cyclic actual value telegram of the drive. Measuring probe/ Measuring probe control parameters Measured value identification edge S-0-0169 TF5200 | Twin CAT 3 CNC Version: 1.09 27 Measurement
## Page 28

Measured value detected in the drive hardware Measuring probe 1, S-0-0169 = 1 S-0-0130 positive edge Measuring probe 1, S-0-0169 = 2 S-0-0131 negative edge Measuring probe 2, S-0-0169 = 4 S-0-0132 positive edge Measuring probe 2, S-0-0169 = 8 S-0-0133 negative edge Parameterisation of the cyclic telegram The measured value ID specified in the table above must be configured in the cyclic actual value telegram depending on the value of the measuring probe control parameter. Axis parameter For SERCOS drives, the following entries must be assigned in the axis parameter lists: P-AXIS-00516 Measuring by drive: kenngr.measure.signal DRIVE (old:P-AXIS-00116) P-AXIS-00518 Latch at positive or negative probing signal edge: kenngr.measure.edge POS / NEG (old: P-AXIS-00113) Parameterise a SERCOS drive The steps required to parameterise a SERCOS drive are presented in a flowchart on the following pages. Configuration of SERCOS-Measurement Start Real time bit 1 Axis parameter: kenngr.messachse 1 kenngr.vb_messen 10000 kenngr.measure.signal DRIVE kenngr.mess_offset 0 1 2 Real time bits Axis parameter: kenngr.echtzeit_bit_nr = 1 1 Measuring 2 sensor Assignment of real time control bit 1: Assignment of real time bit 1: S-0-0301 = 405 (Release of sensor 1) S-0-0301 = 406 (Release of Sensor 2) Assignment of real time status bit 2 Assignment of real time status bit 2 S-0-0307 = 401 (State of sensor 1) S-0-0307 = 402 (State of sensor 2) Yes Measurement of No Measurement pos. edge Yes of pos. edge No S-0-0169 = 1 (Sensor 1, pos. edge) S-0-0169 = 2 (Sensor 1, neg. edge) S-0-0169 = 4 (Sensor 2, pos. edge) S-0-0169 = 8 (Sensor 2, neg. edge) Assingment of realt time status bit 1: Assingment of realt time status bit 1: Assingment of realt time status bit 1: Assingment of realt time status bit 1: S-0-0305= 409 (Measuring value 1, S-0-0305= 410 (Measuring value 1, S-0-0305= 411 (Measuring value 2, S-0-0305= 412 (Measuring value 2, positive acquisition) negative acquisition) positive acquisition) negative acquisition) Cycl. actual value: Configuration of Cycl. actual value: Configuration of Cycl. actual value: Configuration of Cycl. actual value: Configuration of S-0-0130 (Measuring value 1 pos.) S-0-0131 (Measuring value 1 neg.) S-0-0132 (Measuring value 2 pos.) S-0-0133 (Measuring value 2 neg.) Axis parameter: Axis parameter: Axis parameter: Axis parameter: kenngr.mess_neg_flanke = 0 kenngr.mess_neg_flanke = 1 kenngr.mess_neg_flanke = 0 kenngr.mess_neg_flanke = 1 End Fig. 12: Configuration of SERCOS measurement real-time bit no. 1 28 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 29

Measured value detected in the drive hardware Configuration of SERCOS-Measurement Real time bit 2 Axis parameter: kenngr.echtzeit_bit_nr =2 1 Measuring 2 sensor Assignment of real time control bit 2: Assignment of real time bit 2: S-0-0303 = 405 (Release of sensor 1) S-0-0303 = 406 (Release of Sensor 2) Assignment of real time status bit 1 Assignment of real time status bit 1 S-0-0305 = 401 (State of sensor 1) S-0-0305 = 401 (State of sensor 1) Yes Measurement of No Yes Measurement No pos. edge of pos. edge S-0-0169 = 1 (Sensor 1, pos. edge) S-0-0169 = 2 (Sensor 1, neg. edge) S-0-0169 = 4 (Sensor 2, pos. edge) S-0-0169 = 8 (Sensor 2, neg. Assignment of real time status bit 2: Assignment of real time status bit 2: Assignment of real time status bit 2: edge)Assignment of real time status bit 2: S-0-0307= 409 (Measuring value 1, S-0-0307= 410 (Measuring value 1, S-0-0307= 411 (Measuring value 2, S-0-0307= 412 (Measuring value 2, positive acquisition) negative acquisition) positive acquisition) negative acquisition) Cycl. actual value: Configuration of Cycl. actual value: Configuration of Cycl. actual value: Configuration of Cycl. actual value: Configuration of S-0- S-0-0130 (Measuring value 1 pos.) S-0-0131 (Measuring value 1 neg.) S-0-0132 (Measuring value 2 pos.) 0133 (Measuring value 2 neg.) Axis parameter: Axis parameter: Axis parameter: Axis parameter: kenngr.mess_neg_flanke = 0 kenngr.mess_neg_flanke = 1 kenngr.mess_neg_flanke = 0 kenngr.mess_neg_flanke = 1 End Fig. 13: Configuration of SERCOS measurement real-time bit no. 2 Axis parameter The following parameters are necessary in the drive and in the NC kernel to configure the measurement function of a SERCOS drive on the rising edge of measuring probe 1 using the real time and status bits 1. kenngr.hub_messtaster 2000 kenngr.vb_messen 2000 kenngr.messachse 1 kenngr.measure.signal DRIVE kenngr.echtzeit_bit_nr 1 TF5200 | Twin CAT 3 CNC Version: 1.09 29 Measurement
## Page 30

Measured value detected in the drive hardware Cyclic telegram Identification S-0-0130 must also be configured when a cyclic telegram is configured: Fig. 14: Configuration of Ident. S-0-0130 Drive The real time bits 1 and measuring probe 1 are used: • S-0-0301= 405 (real-time control bit 1 = measuring probe 1 enabled) • S-0-0305 = 409 (real-time status bit 1 = measuring probe 1, positive detected) • S-0-0307 = 401 (real-time status bit 2 = measuring probe 1) 30 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 31

Measured value detected in the drive hardware Fig. 15: Real-time bits in the Editor Measuring probe control word The value 1 must be entered in the measuring probe control word: S-0-0169 = 1 (measuring probe 1 positive edge) Fig. 16: Probe control word with value 1 TF5200 | Twin CAT 3 CNC Version: 1.09 31 Measurement
## Page 32

Measured value detected in the drive hardware 6.2 Lightbus Drive parameters Digital input 2 in the drive must be programmed as the probing input in order to use the measurement function. The value 26 must then be assigned to the drive parameter IN2MODE. Connect the measuring probe to the digital input 2 (X3 terminal 12). Fig. 17: Configure digital input 2 as probing input Axis parameters For Lightbus drives, the following entries must be assigned in the axis parameter lists: P-AXIS-00518 Latch at positive or negative probing signal edge: kenngr.measure.edge POS / NEG (old: P-AXIS-00113) 32 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 33

Measured value detected in the drive hardware 6.3 Terminal drives Drive parameter / measuring probe terminal Connect the measuring probe to terminal 4 of the incremental encoder interface KL5101. Axis parameters For terminal drives, assign the following entries in the axis parameter lists: P-AXIS-00518 Latch at positive probing signal edge (measurement at negative edge is not supported by the Encoder Interface): kenngr.measure.edge POS (old P-AXIS-00113) TF5200 | Twin CAT 3 CNC Version: 1.09 33 Measurement
## Page 34

Measured value detected in the drive hardware 6.4 CANopen Drive parameters Parameters in the drive Depending on the drive hardware used, a digital input may have to be parameterised as a latch input in the drive. The procedure for this depends on the drive and its manufacturer and must be carried out based on the drive documentation and possibly using commissioning and parameterisation software provided by the drive manufacturer. The configuration corresponding to the object numbers defined in Ci A DS402 or IEC 61800-7-200 is described below. Parameterisation of the cyclic telegram Parameterisation of the actual value telegram When the measurement function is used in the cyclic actual value telegram, a telegram type must be configured containing the following data for transfer: • Latch status word (‘touch probe status’, object number 0x60B9) • Different process data must be configured here for latch position depending on the probing input used and the polarity of the probing signal edge; see table below. Measuring hardware used Name Object number Probing input 1, positive edge Touch probe pos1 pos value 0x60BA Probing input 1, negative edge Touch probe pos1 neg value 0x60BB Probing input 2, positive edge Touch probe pos2 pos value 0x60BC Probing input 2, negative edge Touch probe pos2 neg value 0x60BD If measurements need to be taken with different probing inputs or different edges, several of the process data listed above may have to be configured. Parameterising the command value telegram A telegram type must be configured in the cyclic command value telegram to transmit the latch control word. Latch control word (‘touch probe status’ object number 0x60B8 34 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 35

Measured value detected in the drive hardware Fig. 18: Cyclic command/actual value telegram for probing Special features when using the drive object 0x60D0 Some drives also offer the option of setting the trigger source for the latch event in the drive by means of drive object 0x60D0 subindex 1 or 2. This offers the option of using manufacturer- or drive-specific latch methods. Using the drive object 0x60D0 requires a change in the control of the latch control word and a different evaluation of the latch status word. To activate this special feature, assign the value “DRIVE_DEFINED” to the axis parameter P-AXIS-00702. The latched values are transmitted in this case via the objects 0x60BA to 0x60BD in the cyclic process data. TF5200 | Twin CAT 3 CNC Version: 1.09 35 Measurement
## Page 36

Measured value detected in the drive hardware Axis parameter Assign the following entries in the axis parameter lists for Ether CAT drives: • Select probing signal edge by P-AXIS-00518 • Select probing input used on the drive (Digital Input 1 or 2) by the parameter P-AXIS-00517 • When the drive object 0x60D0 is used to define the trigger source, set P-AXIS-00702 to “DRIVE_DEFINED“. P-AXIS-00518 Latch at positive or negative kenngr.measure.edge POS / NEG probing signal edge: (old P-AXIS-00113) P-AXIS-00517 Select the number of the kenngr.measure.input 1 / 2 digital probing input in the (old P-AXIS-00295) drive (1/2): P-AXIS-00702 Define the trigger source in antr.canopen.probing_trigge “DEFAULT” the drive using the drive r_source | object 0x60D0 “CNC_DEFINED” | “DRIVE_DEFINED” 36 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 37

Measured value detected in the drive hardware 6.5 PROFIDRIVE Drive parameters In order to use the measurement function, the rapid digital input I0.0, or I0. X for a double-axis module, must be programmed. 1. The value 80 must then be assigned to the drive parameter P0660. 2. Connect the measuring probe to the digital input I0.0 or I0. X. Axis parameters For PROFIBUS drives, the following entries must be assigned in the axis parameter lists: P-AXIS-00518 Latch at positive or negative probing signal edge: (old P-AXIS-00113) kenngr.measure.edge POS / NEG TF5200 | Twin CAT 3 CNC Version: 1.09 37 Measurement
## Page 38

Measured value detection in the CNC 7 Measured value detection in the CNC For special applications or if the drive hardware used provides no latch function, the measured value can be detected in the CNC. 7.1 Measuring probe signal via PLC interface CNC – PLC The status of the measuring probe signal is then transmitted to the CNC via the PLC interface; the CNC assumes edge evaluation and measured value detection. The task of the PLC is to read in the measuring probe signal and supply the signal to the PLC interface. See also [Axis control commands]. The measured value is the actual value at the time of occurrence of the probing signal. Axis parameters To activate this function, assign the value PLC to the axis parameter Measurement methods (P- AXIS-00516). Therefore, this parameter permits switchover only between probing signal detection modes via the drive or via probing signal detection via the PLC. The accuracy of the measured values detected is dependent on the cycle time of the CNC and the PLC: The accuracy of the measured values detected in the drive is generally more precise since the position controller or the speed controller cycle time in the drive are used to evaluate the measured values. 38 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 39

Measured value detection in the CNC 7.2 Probing with switchable probe and measured value detection in the drive Function available as of V3.1.3080.05. Basics If a measuring probe is used that can be activated/deactivated when no measurement run is executed, the external measuring interface between the CNC and the PLC is used. (see Measure with external measuring hardware [} 47]). The CNC informs the PLC of the start and end of a measurement run so that the PLC can activate or deactivate the measuring hardware accordingly. A possible application is the use of radio probes to save power. Since it may take a few seconds to enable the probe, it is recommended to prepare a measurement run using #MEAS PREPARE [AXNR = ..]. This allows the user to actuate the probe early so that there is no stopping at the start of the measurement run. The user is responsible for programming the #MEAS PREPARE command in good time. If a reset is executed between preparation and the actual measuring block, the probe is enabled as normal at the start of the measuring block. If homing is executed with one of the prepared axes before a measurement run is started, the pre- paration of all axes is reset. The same occurs when an axis prepared for a measurement run is ex- changed from the channel. At the end of the program, all axes prepared for a measurement run are also reset. CNC – PLC The workflow from the CNC’s point of view is as follows: The interface between the CNC and the PLC is used to signal the initialisation, the start and the end of a measurement run. The probe can then be prepared, enabled or disabled. The CNC writes each task (HLI_EXT_LATCH_PREPARE_PROBE, HLI_EXT_LATCH_ENABLE_PROBE, HLI_EXT_LATCH_DISABLE_PROBE) with the required parameter number of the probing input and the relevant edge to the interface and sets please_rw = TRUE. The interpolator does not move to the measuring block until the PLC acknowledges that probe preparation is completed. The workflow from the PLC’s point of view is as follows: After the task “HLI_EXT_LATCH_PREPARE_PROBE“ is received, please_rw is set to FALSE. When the probe is enabled, the PLC signals this to the CNC with done_w = TRUE. Please note that the SPS must always acknowledge these tasks. At the start of the measuring block the task “HLI_EXT_LATCH_ENABLE_PROBE“ must be acknowledged. After the measurement run is completed, the CNC again informs the PLC with the task "HLI_EXT_LATCH_DISABLE_PROBE"; this task must again be acknowledged by the PLC. TF5200 | Twin CAT 3 CNC Version: 1.09 39 Measurement
## Page 40

Measured value detection in the CNC Fig. 19: Signal profile of the radio measuring button Before a new measurement run starts, the system waits until the PLC acknowledges the task “HLI_EXT_LATCH_DISABLE_PROBE“. For more information on the interface structure, refer to the HLI documentation. (see Measure with external measuring hardware [} 47]). CNC – DRIVE Depending on the drive type, the drive must be configured in the drive hardware as described in “Section: Measured value detection”. Depending on the drive, the measured position is transmitted via the drive interface to the CNC. Axis parameter The following axis parameters are required for measuring with the CNC-PLC interface: P-AXIS-00516 [} 55] Select measurement method: kenngr.measure.signal EXT_PROBE_WITH_DRIVE P-AXIS-00517 [} 56] Number of the probing input used kenngr.measure.input 1 or 2 P-AXIS-00518 [} 56] Relevant measuring edge: kenngr.measure.edge POS or NEG Alternatively, the measuring interface can also be enabled in the NC program by the #MEAS command (see [PROG//Extended programming]). 40 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 41

Measured value detection in the CNC 7.3 Measurement run to fixed stop Detection of fixed stop When measuring by motion to a fixed stop, the measuring event used is the detection of a mechanical stop against which the measuring axis moves. Several criteria, also combined, can be used to detect the fixed stop: • Overshooting a predefined position lag during the measuring movement. • Undershooting a minimum actual speed of the axis during the measurement movement. Default setting When a measurement run is executed with Moving to a fixed stop, torque limitation must be activated in all drives involved and any drive-based position lag error monitor must be disabled. Measurement on the path The measurement run ends as soon as the fixed stop is detected in one of the axes involved in the measurement run. Process When measuring by Moving to a fixed stop, an axis movement is automatically generated after the fixed stop is detected, during which the axes involved in the measurement run are moved to the latched measuring position in each case. This relieves mechanical stresses accumulated when the axis is pressed against the fixed stop. Measurement with gantry axes With gantry systems (soft and hard gantry), the master axis is always used for measuring. During the measurement run, the slave axes also move. For this reason, torque limitation must also be activated and position lag monitoring disabled for motions to a fixed stop in slave axis drives. On Twin CAT systems, torque limitation or position lag monitoring disable in the drives can be al- ternatively enabled in the PLC (via ADS) instead of the NC program (#IDENT...). TF5200 | Twin CAT 3 CNC Version: 1.09 41 Measurement
## Page 42

Measured value detection in the CNC Channel parameters The following entries must be assigned in the channel parameter list: P-CHAN-00057 Measurement type 7 for measurement by moving to a fixed stop: messtyp 7 P-CHAN-00266 Error response with measurement type 7 meas_fixed_stop_no_error e.g. with value 1 Select measurement type in the NC program Alternatively, the measurement type can be changed in the NC program by the command #MEAS MODE[7]. 42 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 43

Measured value detection in the CNC Parameterisation of fixed stop detection Several criteria, also combined, can be used to detect the fixed stop: • Overshooting a predefined position lag during the measuring movement. • Undershooting a minimum actual speed of the axis during the measurement movement. The active criteria in each case must be fulfilled for a certain period before the fixed stop is considered to be detected. In addition, a minimum path distance can be specified until fixed stop detection is activated in the measurement motion block. This can be specified as an absolute value or as a percentage based on the length of the measurement motion block. If the minimum path distance is specified both as an absolute value and as a percentage, the smaller of the two values is used to activate fixed stop detection. The minimum value of all axes is used for activation in the case of a measurement run with several axes. By default, fixed stop detection is activated immediately at the beginning of the block. Axis parameters The following entries must be assigned in the axis parameter lists: P-AXIS-00516 Select the Fixed Stop probing signal source: (Previous P- kenngr.measure.signal FIXED_STOP AXIS-00330) P-AXIS-00774 [} 59] Position lag limit for fixed stop detection with Measuring travel on fixed stop (Previous P- AXIS-00331 [} 61]) P-AXIS-00775 [} 59] Minimum time for fixed stop detection with Measuring travel to fixed stop (Previous P- AXIS-00332 [} 61]) P-AXIS-00776 [} 59] Minimum path to activate fixed stop detection with Measuring travel to fixed stop ID 51026 [} 60] Minimum distance to activate fixed stop detection with Measuring travel to fixed stop, specified in per mil of block length P-AXIS-00778 [} 60] Maximum permitted position change during fixed stop detection with Measuring travel to fixed stop Sequence of measurement run Measurement by Moving to a fixed stop can be represented by the example of SERCOS drives as shown in the process below [} 44] . TF5200 | Twin CAT 3 CNC Version: 1.09 43 Measurement
## Page 44

Measured value detection in the CNC 7.3.1 Example for SERVOS drive NC program (user): 1. Reduce bipolar torque limit S-0-0092 for all drives involved in the measurement run (e.g. by the NC command #IDENT WR SYN). 2. Disable position lag monitoring in the drives: Ident S-0-0159 = 0 3. Start measurement run (G100). CNC: 1. Disable position lag monitoring in the position controller for all axes involved in the measurement run. 2. Start of measurement run 3. Adoption of the actual position as a measured value as soon as the parameterised conditions for fixed stop detection are fulfilled. On gantry systems, only the master axis is monitored. 4. Reduce interpolation to measured value by axis position lag. 5. Enable position lag monitoring in the position controller. 44 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 45

Measured value detection in the CNC NC program (user): 1. Move away from fixed stop (e.g. G01). 2. Enable position lag monitoring in the drives (set S-0-0159 to original value). 3. NC program: Disable torque limiting in the drives (set S-0-0092 to original value). Measurement run to fixed stop with a gantry system (Soft Gantry): %Meas_fixed_stop ; enable Soft Gantry N010 G0 X100 X2=0 N020 #SET AX LINK[1,[X2=X,G,15,20]] N030 #ENABLE AX LINK[1] ; read values from drives N040 #IDENT RD [AXNR 1 ID S-0-0092 P=P1092 TYP 2 DEC 0 SERC] N050 #IDENT RD [AXNR 1 ID S-0-0159 P=P1159 TYP 4 DEC 0 SERC] N060 #IDENT RD [AXNR 4 ID S-0-0092 P=P2092 TYP 2 DEC 0 SERC] N070 #IDENT RD [AXNR 4 ID S-0-0159 P=P2159 TYP 4 DEC 0 SERC] ; enable torque limiting N080 #IDENT WR SYN [AXNR 1 ID S-0-0092 VAL=100 TYP 2 DEC 0 SERC] N090 #IDENT WR SYN [AXNR 4 ID S-0-0092 VAL=100 TYP 2 DEC 0 SERC] ; disable position lag monitoring in drives N100 #IDENT WR SYN [AXNR 1 ID S-0-0159 VAL=0 TYP 4 DEC 0 SERC] N110 #IDENT WR SYN [AXNR 4 ID S-0-0159 VAL=0 TYP 4 DEC 0 SERC] ; start measurement run N120 G100 X1000 Y1000 Z1000 Z2=1000 F1000 ; move away from fixed stop N130 G01 X100 F1000 ; re-enable position lag monitoring N140 #IDENT WR SYN [AXNR 1 ID S-0-0159 VAL=P1159 TYP 4 DEC 0 SERC] N150 #IDENT WR SYN [AXNR 4 ID S-0-0159 VAL=P2159 TYP 4 DEC 0 SERC] ; disable torque limiting N160 #IDENT WR SYN [AXNR 1 ID S-0-0092 VAL=P1092 TYP 2 DEC 0 SERC] N170 #IDENT WR SYN [AXNR 4 ID S-0-0092 VAL=P2092 TYP 2 DEC 0 SERC] N180 M30 TF5200 | Twin CAT 3 CNC Version: 1.09 45 Measurement
## Page 46

Measured value detection in the CNC 7.3.2 Example for CANopen drive The following axis parameters are required in order to use #DRIVE commands: antr.function[0].id MON_WINDOW antr.function[0].wr_ident[0] 6065_00 antr.function[0].commu ACYCLIC antr.function[0].data_type UNS32 antr.function[0].mask NOT_USED antr.function[0].scaling_type UNSCALED antr.function[0].scaling_factor 1.0 antr.function[0].min_limit 0.0 antr.function[0].max_limit 4294967295 antr.function[1].id TORQUE_LIMIT antr.function[1].wr_ident[0] 6072_00 antr.function[1].commu ACYCLIC antr.function[1].data_type UNS16 antr.function[1].mask NOT_USED antr.function[1].scaling_type LINEAR antr.function[1].scaling_factor 10.0 For more details on how to use the #DRIVE command, see [FCT-A10// Parameterising the DRIVE command]. Measurement run with CANopen drive %Meas_fixed_stop N010 #MEAS MODE [7] ; N020 G0 Z100 ; enable torque limiting N030 #DRIVE WR SYN [AX=Z KEY=TORQUE_LIMIT VAL=10 WAIT] ; disable position lag monitoring in drive N040 #DRIVE WR SYN [AX=Z KEY=MON_WINDOW VAL=4294967295 WAIT] ; start measurement run N050 G100 Z1000 F100 ; move away from fixed stop N060 G01 Z100 F1000 ; re-enable position lag monitoring N070 #DRIVE WR SYN [AX=Z KEY=MON_WINDOW VAL=1048575 WAIT] ; disable torque limiting N080 #DRIVE WR SYN [AX=Z KEY=TORQUE_LIMIT VAL=5000 WAIT] ; N090 M30 46 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 47

Measured value detection in the CNC 7.4 Measure with external measuring hardware Basics If the control of an external measuring hardware required for the measurement run, the external measurement interface between the CNC and the PLC can be used. The CNC informs the PLC of the start and end of a measurement run so that the PLC can enable and disable the measuring hardware accordingly. CNC – PLC At the start of a measurement run, the CNC writes the task ‘Enable probe” containing the required parameter number of the probing input and the relevant edge in the interface and ‘Enable probe” and sets please_rw = TRUE. After reading (please_rw = FALSE) and enabling the measuring hardware, the PLC acknowledges the task with done_w = TRUE). Accordingly, if the position latch is successful or aborted, the CNC signals the end of the measurement run with a CNC reset. Please note that the PLC must always acknowledge these tasks. For more information on the interface structure, refer to the HLI documentation ([HLI]). After the probing event occurs, the PLC writes the detected probing position to the probing_position control unit and then signals the probing event to the control unit probing_signal (see [HLI//Control commands of an axis]). When the external measuring interface is used, the measurement signal of the probing_signal [} 61] control unit is not dependent on the relevant measuring edge P-AXIS-00518. A positive edge always signals the successful detection of a measured value in the external measuring hard- ware. If the probing_signal [} 61] control unit is not enabled when the probing event occurs, the actual value at the time the probing signal occurs is used. Axis parameter The following axis parameters are required for measuring with the CNC-PLC interface: P-AXIS-00516 Select the external measurement interface: kenngr.measure.signal PLC_EXT_LATCH_CONTROL P-AXIS-00517 Number of the probing input used kenngr.measure.input 4 P-AXIS-00518 Relevant measuring edge: kenngr.measure.edge NEG TF5200 | Twin CAT 3 CNC Version: 1.09 47 Measurement
## Page 48

Measured value detection in the CNC Alternatively, the measuring interface can also be enabled in the NC program by the #MEAS command (see [PROG//Extended programming]). CNC sets command CNC sets command "enable probe" "disable probe" ext_latch_control.please_rw PLC acknowledges execution PLC acknowledges execution ext_latch_control.done_w PLC signals "position Measuring event latched" Measuring signal probing_signal.command_w PLC provides measured position Measured value probing_position.command_w CNC-measuring traverse G100 X... Fig. 20: Time sequence of a measurement run with the external measuring interface 48 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 49

Measured value detection in the CNC 7.5 Measuring with Distributed Clocks Timestamp The function Measuring with Distributed Clocks Timestamp is available as of Build V3.01.3079.28. For example, the function can be used if a drive itself does not have a fast measuring input. The function uses the technology of distributed clocks to calculate back the exact position of the drive when a measurement event occurs via the timestamp of a digital input terminal. The measuring signal is evaluated in the digital input terminal. The state and timestamp of the terminal are transferred to the CNC via the PLC interface. The following steps must be carried out besides the basic settings [} 14] to use the function: Set the probing signal source: Use the parameter P-AXIS-00516 [} 55] kenngr.measure.signal PLC_TIMESTAMP Or the NC command #MEAS [ AXNR=xx SIGNAL=PLC_TIMESTAMP] TF5200 | Twin CAT 3 CNC Version: 1.09 49 Measurement
## Page 50

Measured value detection in the CNC Linking the digital input terminal to the PLC: The state and the latched timestamp must be transferred via the PLC interface to the CNC using appropriate control units. The state of the digital input terminal is transferred via the measuring signal control unit [} 61] to the CNC. Transfers the latched timestamp to the CNC is transferred via the timestamp time stamp [} 62]. The parameters of the digital input terminal must be linked to the control units accordingly. Example using an EL1252 terminal The probe is connected to Channel 2 of the EL1252 terminal. Axis 2 performs the measurements. When the measuring signal is received, a rising edge is registered in the "Input" parameter of the EL1252. This must be forwarded to the CNC via the measuring signal control unit [} 61]. The latched timestamp is stored in “Latch Pos2” and must be notified to the CNC by the timestamp control unit [} 62]. Fig. 21: Linking the input and Latch Pos2 50 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 51

Parameter 8 Parameter 8.1 Overview ID Parameter Description P-CHAN-00057 messtyp Setting the default measurement type P-CHAN-00097 use_drive_curr_limit Valid deceleration ramp at feedhold P-CHAN-00176 meas_error_no_signal Error reaction with measurement type 1 P-CHAN-00214 meas_deceleration_mo Active delay with measuring signal de P-CHAN-00266 meas_fixed_stop_no_e Error response with measurement type 7 rror P-CHAN-00296 meas_use_std_dynami Active dynamic for measurement run c ID Parameter Description P-AXIS-00060 echtzeit_bit_nr Number of real-time bit used for SERCOS drives P-AXIS-00086 hub_messtaster Measuring probe stroke P-AXIS-00118 messachse Axis can be used as measurement axis. P-AXIS-00215 vb_messen Measurement feed rate in accordance with measurement type 2 P-AXIS-00467 probing_offset Permitted path after target point P-AXIS-00516 measure.signal Measurement methods P-AXIS-00517 measure.input Number of probing input P-AXIS-00518 measure.edge Relevant measuring edge P-AXIS-00774 kenngr.measure. Position lag limit for fixed stop detection with Measuring travel to fixed_stop_detect. fixed stop pos_lag_limit P-AXIS-00775 kenngr.measure. Minimum time in µs for fixed stop detection with Measuring travel fixed_stop_detect. to fixed stop min_time P-AXIS-00776 kenngr.measure. Minimum path to activate fixed stop detection with Measuring fixed_stop_detect. travel to fixed stop start_distance P-AXIS-00777 kenngr.measure. Minimum distance to activate fixed stop detection with Measuring fixed_stop_detect. travel to fixed stop, specified in per mil of block length start_distance_per_mill e P-AXIS-00778 kenngr.measure. Maximum permitted position change during fixed stop detection fixed_stop_detect. with Measuring travel to fixed stop max_delta_position_wi ndow Old parameter up to CNC Build V.2.11.28XX. YY (available for downward compatibility) P-AXIS-00331 fixed_stop_pos_lag_li Position lag limit mit P-AXIS-00332 fixed_stop_nbr_cycles Number of position control cycles Old parameter up to CNC Build V.2.11.2019.14 (available for downward compatibility) P-AXIS-00113 mess_neg_flanke Probing signal edge P-AXIS-00115 mess_signal_achs_ste Consider external probing signals uer P-AXIS-00116 mess_signal_sercos Read in the probing signal with SERCOS P-AXIS-00117 mess_signal_taster Measuring probe signal via hardware interface P-AXIS-00257 probing_signal_via_plc Measured value detection in the CNC TF5200 | Twin CAT 3 CNC Version: 1.09 51 Measurement
## Page 52

Parameter P-AXIS-00330 meas_signal_fixed_sto Measurement with motion to a fixed stop p 52 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 53

Parameter 8.2 Description 8.2.1 Channel parameters P-CHAN-00057 Predefine measurement type Description Seven different measurement types are available. This element sets the required measurement type. Parameter messtyp Data type UNS16 Data range 1*: Measurement travel with at least one axis, Measurement feed programmable by F word. 2*: Measurement travel with exactly one axis. Measurement feed is specified in the axis data list. 3: Measurement travel with at least one axis, Measurement feed programmable by F word, optionally continue motion up to the target point. 4: Measurement travel only with the maximum of 3 main axes, Measurement feed programmable by F word. 5: Interruptible measurement travel with at least one axis, Measurement feed programmable by F word. 6: Interruptible measurement travel with at least one SERCOS axis, Measurement feed programmable by F word. 7*: Measurement travel (G100) by moving to a fixed stop with at least one axis, Measurement feed programmable by F word. Dimension ---- Default value 1 Remarks * for these measurement types a measurement travel is also possible with independent axes. This measurement type can be changed at any time in the NC program with #MEAS MODE or #MEAS [TYPE..]. Further information is described in detail in [PROG]. Parameterisation example: Select measurement type 3 for a measurement travel with two axes and then continue motion up to the programmed target point. Measurement type 3 P-CHAN-00097 Valid deceleration ramp at FEEDHOLD Description This parameter defines the deceleration ramp used when FEEDHOLD is active. When P-CHAN-00097 is set, the parameterised delay is dependent on the slope used. With a linear slope, the delay is defined by P-AXIS-00024; if the slop is non-linear, it is defined by P-AXIS-00053 and P-AXIS-00081. Parameter use_drive_curr_limit Data type BOOLEAN Data range 0: When FEEDHOLD is set, deceleration takes place using the currently valid deceleration rate. 1: When FEEDHOLD is set, deceleration takes place using the parameterised delay depending on the slope used. If these two parameters are not set, deceleration takes place at the currently valid deceleration rate (P-AXIS-00004). Dimension ---- Default value 0 TF5200 | Twin CAT 3 CNC Version: 1.09 53 Measurement
## Page 54

Parameter Remarks P-CHAN-00176 Error reaction with measurement type 1 Description With measurement type 1, this parameter can influence the error reaction when the measurement signal is missing from the measurement block. Parameter meas_error_no_signal Data type BOOLEAN Data range 0: No output of an error message if no measurement signal is received (default). 1: Output of an error message if no measurement signal is received. Dimension ---- Default value 0 Remarks Parameterisation example: meas_error_no_signal 1 P-CHAN-00214 Active delay with measurement signal Description In general, the effective feedhold deceleration is selected in all motion blocks by the channel parameter P-CHAN-00097 . The controller uses this deceleration to brake motion by default, even after the measurement signal is activated (e.g. measuring probe). Set the parameter to 1 if braking is required on activation of the measurement signal with rapid traverse deceleration. Parameter meas_deceleration_mode Data type UNS16 Data range 0: When the measurement signal is received, the motion is braked with feedhold deceleration (P-AXIS-00053 for non-linear slope) (default). 1: When the measurement signal is received, the motion is braked with rapid traverse deceleration (P-AXIS-00004 for non-linear slope). Dimension ---- Default value 0 Remarks Parameterisation example: meas_deceleration_mode 1 P-CHAN-00266 Error reaction with measurement type 7 Description With measurement type 7 (measuring with motion to fixed stop), this parameter influences the error response when the fixed stop is not detected in the measurement block. If no error message is output when the fixed stop is not found, the CNC still goes to the position of the current axis actual value at the end of the measurement travel in order to eliminate a possible position lag (e.g. if the specified position lag is not reached completely). Parameter meas_fixed_stop_no_error Data type BOOLEAN Data range 0: Output of an error message if the fixed stop is not detected (default). 1: No output of an error message if the fixed stop is not detected. Dimension ---- Default value 0 Remarks Parameterisation example: meas_fixed_stop_no_error 1 P-CHAN-00296 Active dynamic for measurement run 54 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 55

Parameter Description The measurement travel profile planning is executed based on G00 dynamic parameters. In general, this ensures that the system can stop the motion in good time if the probe deflection is limited. If the measurement travel profile planning must be executed with G01 values, set the parameter to 1. The deceleration ramp used when the measuring signal is received is always dependent on P-CHAN-00097 [} 53] and P-CHAN-00214 [} 54]. Parameter meas_use_std_dynamic Data type BOOLEAN Data range 0: The measurement travel profile planning is executed based on rapid traverse acceleration values (G00) dependent on P-CHAN-00097 [} 53] and P-CHAN-00214 [} 54] . The CNC functions for acceleration and ramp time weighting are not effective here. 1: The dynamics of the measurement travel is dependent on P-CHAN-00097 [} 53] and P-CHAN-00214 [} 54] and is executed based on the dynamics of feed blocks (G01). CNC functions for acceleration and ramp time weighting can be used here. The deceleration ramp used when the measurement signal is received is always a_feedh. Dimension ---- Default value 0 Remarks Parameterisation example: meas_use_std_dynamic 1 The effective dynamics dependent on the parameters P-CHAN-00097 [} 53] and P- CHAN-00214 [} 54] are shown in the table below. v 1 1 2 t 8.2.2 Axis parameters P-AXIS-00516 Measurement methods Description The parameter defines the source of the probing signal during a measuring travel, e.g. the probing position can be latched in the drive or the probing signal can be provided by the PLC. This setting can also be changed in the NC program by the #MEAS command (see [PROG//Extended programming]. This parameter replaces the following old configuration parameters: • kenngr.mess_signal_taster (P-AXIS-00117) • kenngr.mess_signal_sercos (P-AXIS-00116) • kenngr.mess_signal_achs_steuer (P-AXIS-00115) • kenngr.probing_signal_via_plc (P-AXIS-00257) • kenngr.meas_signal_drive (P-AXIS-00269) • kenngr.meas_signal_fixed_stop (P-AXIS-00330) Parameter kenngr.measure.signal Data type STRING TF5200 | Twin CAT 3 CNC Version: 1.09 55 Measurement
## Page 56

Parameter Data range DRIVE_TYPE_DEFAULT PLC FIXED_STOP DRIVE PLC_EXT_LATCH_CONTROL PLC_FIRST_EVENT PLC_TIMESTAMP EXT_PROBE_WITH_DRIVE (as of V3.1.3080.05) Axis types T, R, S Dimension T: ---- R,S: ---- Default value * Drive types ---- Remarks If the parameter P-AXIS-00516 is not defined, the measurement method resulting from previous parameters is used for backward compatibility reasons. * Note: The default value of variables is a blank string. P-AXIS-00517 Number of probing input Description The parameter defines the measuring channel which is used during a measurement travel. When the DRIVE measuring signal is set (see P-AXIS-00516) the selected measuring channel must also be parametrised in the drive (see FCT-C4 [} 8]]). This parameter replaces the old setting antr.probing_input_nbr (P-AXIS-00430). Parameter kenngr.measure.input Data type UNS08 Data range Valid probing inputs dependent on drive type and probing signal source (see table below): Measurement methods Drive type Probing inputs P-AXIS-00516 P-AXIS-00020 PLC_EXT_LATCH_CONTROL all 1 to 255 EXT_PROBE_WITH_DRIVE all 1 to 2 DRIVE SERCOS 1 to 2 CANopen PROFIDRIVE MC Conventional 1 Beckhoff Lightbus +-10V via Fieldbus Real-time (RT)-Ethernet CAN-Bus Axis types T, R, S Dimension T: ---- R,S: ---- Default value 0 ** Drive types ---- Remarks *All probing signals which are not listed in the table above do not use the parameter 'Input' for the probing input. **If the parameter P-AXIS-00517 is not specified, the setting in P-AXIS-00430 is used for reasons of backward compatibility. P-AXIS-00518 Probing signal edge 56 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 57

Parameter Description The axis parameter defines the edge of the probing signal which is used to latch the position value. The parameter replaces the setting kenngr.mess_neg_flanke (P-AXIS-00113). Parameter kenngr.measure.edge Data type STRING Data range POS: Latching if positive measured signal edge NEG: Latching if negative measured signal edge Axis types T, R, S Dimension T: ---- R,S: ---- Default value * Drive types ---- Remarks If the parameter P-AXIS-00518 is not specified, the setting in P-AXIS-00113is output. * Note: The default value of variables is a blank string. P-AXIS-00086 Probe stroke for measurement types 2 and 4 Description Some types of mechanical measuring probes have a limited stroke. After activating the probe, the axis continues to travel by the braking distance which is dependent on the axis speed and the allowed axis deceleration. In order to avoid damage to the probe, the maximum permitted stroke can be parametrised. This parameter is only effective for measurement types 2 and 4 (see P-CHAN-00057). When using these types, the measurement speed is limited in such a way that the braking distance is less than the probe stroke. If measurement speed correction is executed, a warning is output. Parameter kenngr.hub_messtaster Data type UNS32 Data range 0 ≤ hub_messtaster ≤ MAX(UNS32) Axis types T, R Dimension T: 0.1 µm R: 0.0001° Default value 50000 Drive types ---- Remarks A buffer exists between the interpolator and the position controller to calculate the parameters for feedforward control of axes. This results in a dead time between calculating a command value by the interpolator and its execution in the position controller. In the worst case, an error may occur during measurement travel because the interpolator, which monitors the stroke of the measuring probe, ignores the distance components in the buffer. This can be prevented by enlarging the actual measurement probe stroke. P-AXIS-00467 Measurement travel offset for all measurement types Description The measurement travel offset defines how much further the axis is allowed to move past the programmed target position if the probe was not yet actuated and the target point is already reached. The parameter is not effective in measurement type 3 (see P-CHAN-00057with optional continue to the target point! Parameter kenngr.probing_offset Data type UNS32 Data range 0 ≤ probing_offset ≤ MAX(UNS32) Axis types T, R Dimension T: 0.1 µm R: 0.0001° Default value 0 Drive types ---- TF5200 | Twin CAT 3 CNC Version: 1.09 57 Measurement
## Page 58

Parameter Remarks As of CNC Build V2.11.2010.09 P-AXIS-00467 replaces the parameter P- AXIS-00114. For compatibility reasons, the parameter continues to be available, but it should not be used in new applications because it only has an influence on measurement travels with measurement type 2 (see P-CHAN-00057). The function of P-AXIS-00467 is more extensive; it can be used for all measurement types P-CHAN-00057 with the exception of measurement type 3 (optional continue motion up to the target point). P-AXIS-00118 Define axis as measurement axis Description The parameter must be assigned to TRUE for all axes that participate in a measurement traverse. Parameter kenngr.messachse Data type BOOLEAN Data range 0/1 Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types ---- Remarks P-AXIS-00215 Measurement speed for measurement type 2 Description Depending on the application, measurement travel does not take place with the programmed feed, but with the feed defined by this parameter. Parameter kenngr.vb_messen Data type UNS32 Data range 1 ≤ vb_messen ≤ P-AXIS-00212 Axis types T, R Dimension T: µm/s R,S: 0.001°/s Default value 16666 Drive types ---- Remarks This parameter is only used for measurement type 2 [PROG], [[CHAN]. P-AXIS-00060 SERCOS status/define control bit for measurement Description This entry defines the real time state/control bits used for probing. Parameter kenngr.echtzeit_bit_nr Data type UNS08 Data range 0 ≤ echtzeit_bit_nr ≤ 2 The real-time status and control bits are assigned according to the table below: P-AXIS-00060 Control bits Status bits Measurement measurement Measuring probe Enable done activated 0, 1 P-AXIS-00106 2 no entry 1 1 1 2 2 2 2 1 Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types SERCOS 58 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 59

Parameter Remarks It is recommended to set P-AXIS-00060 to either 1 or 2. The value 0 is only for backward compatibility with older version and requires additional settings (P- AXIS-00106). If P-AXIS-00060 is assigned 1 or 2, the entry in P-AXIS-00106 is not used. P-AXIS-00774 Position lag limit for fixed stop detection when measuring travel on fixed stop Description This parameter defines the position lag that must be exceeded to detect a fixed stop when measuring on a fixed stop. When set to the value 0, the system check of the position lag to detect a fixed stop is deactivated. If this parameter has the value < 0 (default assignment), a check is made whether P- AXIS-00769 has the value > 0 and this is used if necessary. If P-AXIS-00769 is also < 0, the value of P-AXIS-00331 is used to detect the fixed stop. Parameter kenngr.measure.fixed_stop_detect.pos_lag_limit Data type SGN32 Data range MIN(SGN32) < P-AXIS-00774 < MAX(SGN32) Axis types <T, R> Dimension T: 0.1 µm R: .1* 10- 4 ° Default value -1 Drive types SERCOS, Terminal, Lightbus, Profidrive, CANopen* Remarks *Delete axis types that do not apply! Parameter available as of CNC Build V2.11.2810.01 and higher P-AXIS-00775 Minimum time for fixed stop detection when measuring travel to fixed stop Description This parameter defines the length of time that the test conditions for detection of the fixed stop must be fulfilled when measuring to fixed stop so that the fixed stop is considered to be detected. If this parameter has the value zero (default), the system checks whether P- AXIS-00770 has a value > 0 and, if so, this is used. If P-AXIS-00770 is also 0, the value of P-AXIS-00332 is used as the time limit for fixed stop detection. Parameter kenngr.measure.fixed_stop_detect.min_time Data type UNS32 Data range 0 < P-AXIS-00775 < MAX(UNS32) Axis types <T, R> Dimension T: µs R: µs Default value 0 Drive types ---- Remarks Parameter available as of CNC Build V2.11.2810.01 and higher P-AXIS-00776 Minimum path to activate fixed stop detection with Measuring travel on fixed stop TF5200 | Twin CAT 3 CNC Version: 1.09 59 Measurement
## Page 60

Parameter Description This parameter defines how far to travel in the measuring block before fixed stop detection is activated. The value specified is a distance within the measuring block. If the value is less than zero, a check is made to see whether the parameter P- AXIS-00771 has a value greater than or equal to zero and, if necessary, this is used; otherwise, the value zero is used for this parameter. A value of zero activates fixed stop detection immediately at the start of the block. If P-AXIS-00777 is parameterised at the same time, the smaller block motion path defined by the two parameters is used as the minimum path. When measuring with several axes, the smallest block motion path of all axes involved in the measurement is used as the minimum path. Parameter kenngr.measure.fixed_stop_detect.start_distance Data type SGN32 Data range MIN(SGN32) < P-AXIS-00776 < MAX(UNS32) Axis types <T, R> Dimension T: 0.1 µm R: 10-4 ° Default value 0 Drive types ---- Remarks Parameter available as of CNC Build V2.11.2810.01 P-AXIS-00777 Minimum path to activate fixed stop detection when measuring travel to fixed stop, specified in per mill of block length Description This parameter defines the distance per mill of the measuring block that must be travelled before fixed stop detection is activated. If the value is less than 0, the system checks whether P-AXIS-00772 has a value greater than or equal to zero and, if necessary, this is used; otherwise, fixed stop detection is activated at the start of the block. A value of zero activates fixed stop detection immediately at the start of the block. If P-AXIS-00776 is parameterised at the same time, the smaller block motion path defined by the two parameters is used as the minimum path. When measuring with several axes, the smallest block motion path of all axes involved in the measurement is used as the minimum path. The permitted maximum value is 1000. If this value is exceeded at controller start, the warning ID 110757 is output but the value is not automatically corrected. If the parameter is still greater than 1000 at the start of a measuring travel, the error message ID 51026 is output and the program is aborted. Parameter kenngr.measure.fixed_stop_detect.start_distance_per_mille Data type SGN16 Data range MIN(SGN16) < P-AXIS-00777 ≤ 1000 Axis types <T, R> Dimension T: 0.1 % R: 0.1 % Default value -1 Drive types ---- Remarks If the error message ID 51026 is output at the start of a measuring travel and this parameter has a value less than 0, the value of the parameter P-AXIS-00772 must be checked. Parameter available as of CNC Build V2.11.2810.xx ?? P-AXIS-00778 Maximum permitted position change during fixed stop detection when measuring travel to fixed stop 60 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 61

Parameter Description This parameter defines the maximum path which may be travelled in the time defined by P-AXIS-00775 to detect the fixed stop. Together with P-AXIS-00775 , an average velocity is defined but this may not be exceeded to detect the fixed stop. If the value is less than 0, the system checks whether P-AXIS-00773 has a value greater than or equal to zero and, if necessary, this is used; otherwise, velocity monitoring for fixed stop detection is deactivated. Parameter kenngr.measure.fixed_stop_detect.max_delta_position_window Data type SGN32 Data range MIN(SGN32) < P-AXIS-00778 ≤ MAX(UNS32) Axis types <T, R> Dimension T: 0.1 µ R: 10e-4 ° Default value -1 Drive types ---- Remarks Parameter available as of CNC Build V2.11.2810.xx ?? Old probing signal parameters (up to version V2.11.2810.01) P-AXIS-00331 Limit for position lag during movement to a fixed stop Description This parameter specifies the limit for the position lag. After exceeding this limit, the fixed stop is detected and the measuring position is taken over. Parameter kenngr.fixed_stop_pos_lag_limit Data type UNS32 Data range 0 ≤ fixed_stop_pos_lag_limit ≤ MAX(UNS32) Axis types T, R Dimension T: 0.1 µm R: 0.0001° Default value 0 Drive types Conventional, SERCOS, Terminal, Lightbus, Profidrive, CANopen Remarks P-AXIS-00332 Number of position control cycles during movement to a fixed stop Description This parameter defines the number of position control cycles for the waiting time after exceeding the specified position lag limit P-AXIS-00331 before the measured value is determined. If the limit is again exceeded after this time, counting starts from the beginning. Parameter kenngr.fixed_stop_nbr_cycles Data type UNS16 Data range 0 < fixed_stop_nbr_cycles < MAX(UNS16) Axis types T, R Dimension T: Number of interpolation cycles R: Number of interpolation cycles Default value 0 Drive types Conventional, SERCOS, Terminal, Lightbus, Profidrive, CANopen Remarks 8.2.3 PLC parameters Probing signal Description This control unit can transfer the probing signal. When this control unit is used, set the entry kenngr.measure.signal (P-AXIS-00516 [} 55]) to “PLC” or “PLC_TIMESTAMP” in the parameter list of the associated axis. Data type MC_CONTROL_BOOL_UNIT, see description of Control unit TF5200 | Twin CAT 3 CNC Version: 1.09 61 Measurement
## Page 62

Parameter Special features Edge evaluation: Use the edge parameterised in the axis parameter list in the entry kenngr.mess_neg_flanke (P-AXIS-00518) [} 56] to accept the measured value. Access PLC reads request_r + state_r and writes command_w + enable_w ST path gp Ax[axis_idx]^.lr_mc_control.probing_signal Commanded, requested and return values ST element .command_w .request_r .state_r Data type BOOL Value range [TRUE, FALSE] Redirection ST element .enable_w Timestamp Description This control unit transfers the timestamp of a digital input terminal to the CNC via the HLI. Data type MC_CONTROL_SGN64_UNIT, see description of Control unit Access PLC reads request_r + state_r and writes command_w + enable_w ST path gp Ax[axis_idx]^.lr_mc_control.timestamp Commanded, requested and return values ST element .command_w .request_r .state_r Data type LINT Unit [ns] Value range [MIN_SGN64, MAX_SGN64] Redirection ST element .enable_w Special features If the timestamp is used for the function “Measure with distributed clocks timestamp”, the probing_signal control unit [} 61] must also be enabled. Available as of CNC Build V3.01.3079.28 8.2.4 Old probing signal parameters (up to version V2.11.2019.14) P-AXIS-00113 Pulse edge Description This parameter defines the measurement signal edge at which the actual value counter executes the latch point. Parameter kenngr.mess_neg_flanke Data type BOOLEAN Data range 0: Latch at positive edge of pulse 1: Latch at negative edge of pulse Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types ---- Remarks P-AXIS-00115 Measurement signal via axis specific control bit mask 62 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 63

Parameter Description To allow external measurement signals to be taken into account as well, one bit in the axis-specific control bit mask is treated as the measurement signal. This possibility is defined by this parameter. Parameter kenngr.mess_signal_achs_steuer Data type BOOLEAN Data range 0/1 Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types ---- Remarks Measurement method P-AXIS-00117 P-AXIS-00116 P-AXIS-00115 (mess_signal_taster) (mess_signal_ser- (mess_sig- cos) nal_achs_steuer) Drive X - X simulation Conventional X - X drive interface SERCOS X X X drive interface P-AXIS-00116 Measurement with SERCOS drives Description Measurement with SERCOS drives can be performed with two different methods. The flag defines the measurement signal to be read in via the SERCOS interface. Parameter kenngr.mess_signal_sercos Data type BOOLEAN Data range 0: Request from a measurement probe 1: Usage of measurement function supplied by the drive (SERCOS measurement) Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types SERCOS Remarks For the measurement with SERCOS drives, the parameters P-AXIS-00060 or P- AXIS-00106 are also required. P-AXIS-00117 Measurement signal from hardware interface Description This parameter selects the use of the NC kernel hardware interface. Parameter kenngr.mess_signal_taster Data type BOOLEAN Data range 0/1 Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types ---- Remarks P-AXIS-00257 Measurement signal via HLI Control Unit Description This parameter can determine that the probing signal is read from the HLI via the control unit PLC parameters [} 61] and not via the cyclical drive interface. The probing value is the actual value at the moment of the occurrence of the probing signal. Parameter kenngr.probing_signal_via_plc TF5200 | Twin CAT 3 CNC Version: 1.09 63 Measurement
## Page 64

Parameter Data type BOOLEAN Data range 0/1 Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types ---- Remarks Due to the scanning of the probing signal in the cycle time of the PLC, the accuracy of the probed value is less than the accuracy achieved by using drive-internal probing latches. P-AXIS-00330 Measurement with movement to a fixed stop Description This parameter enables the measurement signal source 'Fixed stop'. Parameter kenngr.meas_signal_fixed_stop Data type BOOLEAN Data range 0/1 Axis types T, R Dimension T: ---- R: ---- Default value 0 Drive types Conventional, SERCOS, Terminal, Lightbus, Profidrive, CANopen Remarks The user must ensure that, during movement to a fixed stop in the drives affected, a torque limitation is active and the velocity is low enough. All other measurement signal sources (e.g. P-AXIS-00116) must be deselected. For measurement with movement to a fixed stop, the parameters P-AXIS-00331 or P-AXIS-00332 are also required. 64 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 65

Support and Service 9 Support and Service Beckhoff and their partners around the world offer comprehensive support and service, making available fast and competent assistance with all questions related to Beckhoff products and system solutions. Download finder Our download finder contains all the files that we offer you for downloading. You will find application reports, technical documentation, technical drawings, configuration files and much more. The downloads are available in various formats. Beckhoff's branch offices and representatives Please contact your Beckhoff branch office or representative for local support and service on Beckhoff products! The addresses of Beckhoff's branch offices and representatives round the world can be found on our internet page: www.beckhoff.com You will also find further documentation for Beckhoff components there. Beckhoff Support Support offers you comprehensive technical assistance, helping you not only with the application of individual Beckhoff products, but also with other, wide-ranging services: • support • design, programming and commissioning of complex automation systems • and extensive training program for Beckhoff system components Hotline: +49 5246 963-157 e-mail: support@beckhoff.com Beckhoff Service The Beckhoff Service Center supports you in all matters of after-sales service: • on-site service • repair service • spare parts service • hotline service Hotline: +49 5246 963-460 e-mail: service@beckhoff.com Beckhoff Headquarters Beckhoff Automation Gmb H & Co. KG Huelshorstweg 20 33415 Verl Germany Phone: +49 5246 963-0 e-mail: info@beckhoff.com web: www.beckhoff.com TF5200 | Twin CAT 3 CNC Version: 1.09 65 Measurement
## Page 66

Index Index A axis feed rate enable 62 F feed rate enable axis 62 P P-AXIS-00060 58 P-AXIS-00086 57 P-AXIS-00113 62 P-AXIS-00115 62 P-AXIS-00116 63 P-AXIS-00117 63 P-AXIS-00118 58 P-AXIS-00215 58 P-AXIS-00257 63 P-AXIS-00330 64 P-AXIS-00331 61 P-AXIS-00332 61 P-AXIS-00467 57 P-AXIS-00516 55 P-AXIS-00517 56 P-AXIS-00518 56 P-AXIS-00774 59 P-AXIS-00775 59 P-AXIS-00776 59 P-AXIS00777 60 P-AXIS-00778 60 P-CHAN-00057 53 P-CHAN-00097 53 P-CHAN-00176 54 P-CHAN-00214 54 P-CHAN-00266 54 P-CHAN-00296 54 probing signal 61 66 Version: 1.09 TF5200 | Twin CAT 3 CNC Measurement
## Page 68

More Information: www.beckhoff.com/TF5200 Beckhoff Automation Gmb H & Co. KG Hülshorstweg 20 33415 Verl Germany Phone: +49 5246 9630 info@beckhoff.com www.beckhoff.com
